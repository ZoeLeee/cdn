{"version":3,"file":"js/vender~2bacedc3.0087db59.js","mappings":"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","sources":["webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTile.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTileOptimizationHint.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTileOptimizations.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilePass.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilePassState.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilePointFeature.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTileRefine.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTileStyle.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTileStyleEngine.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTileset.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilesetCache.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilesetHeatmap.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilesetMetadata.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilesetMostDetailedTraversal.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilesetStatistics.js","webpack:///../../../node_modules/cesium/Source/Scene/Cesium3DTilesetTraversal.js","webpack:///../../../node_modules/cesium/Source/Scene/CircleEmitter.js","webpack:///../../../node_modules/cesium/Source/Scene/ClassificationModel.js","webpack:///../../../node_modules/cesium/Source/Scene/ClassificationPrimitive.js","webpack:///../../../node_modules/cesium/Source/Scene/ClassificationType.js","webpack:///../../../node_modules/cesium/Source/Scene/ClippingPlane.js","webpack:///../../../node_modules/cesium/Source/Scene/ClippingPlaneCollection.js","webpack:///../../../node_modules/cesium/Source/Scene/CloudCollection.js","webpack:///../../../node_modules/cesium/Source/Scene/CloudType.js","webpack:///../../../node_modules/cesium/Source/Scene/ColorBlendMode.js","webpack:///../../../node_modules/cesium/Source/Scene/Composite3DTileContent.js","webpack:///../../../node_modules/cesium/Source/Scene/ConditionsExpression.js","webpack:///../../../node_modules/cesium/Source/Scene/ConeEmitter.js","webpack:///../../../node_modules/cesium/Source/Scene/ContentMetadata.js","webpack:///../../../node_modules/cesium/Source/Scene/CreditDisplay.js","webpack:///../../../node_modules/cesium/Source/Scene/CullFace.js","webpack:///../../../node_modules/cesium/Source/Scene/CumulusCloud.js","webpack:///../../../node_modules/cesium/Source/Scene/DebugAppearance.js","webpack:///../../../node_modules/cesium/Source/Scene/DebugCameraPrimitive.js","webpack:///../../../node_modules/cesium/Source/Scene/DebugInspector.js","webpack:///../../../node_modules/cesium/Source/Scene/DebugModelMatrixPrimitive.js","webpack:///../../../node_modules/cesium/Source/Scene/DepthFunction.js","webpack:///../../../node_modules/cesium/Source/Scene/DepthPlane.js","webpack:///../../../node_modules/cesium/Source/Scene/DerivedCommand.js","webpack:///../../../node_modules/cesium/Source/Scene/DeviceOrientationCameraController.js","webpack:///../../../node_modules/cesium/Source/Scene/DirectionalLight.js","webpack:///../../../node_modules/cesium/Source/Scene/DiscardEmptyTileImagePolicy.js","webpack:///../../../node_modules/cesium/Source/Scene/DiscardMissingTileImagePolicy.js","webpack:///../../../node_modules/cesium/Source/Scene/DracoLoader.js","webpack:///../../../node_modules/cesium/Source/Scene/EllipsoidPrimitive.js","webpack:///../../../node_modules/cesium/Source/Scene/EllipsoidSurfaceAppearance.js","webpack:///../../../node_modules/cesium/Source/Scene/Empty3DTileContent.js","webpack:///../../../node_modules/cesium/Source/Scene/Expression.js","webpack:///../../../node_modules/cesium/Source/Scene/ExpressionNodeType.js"],"sourcesContent":["import BoundingSphere from \"../Core/BoundingSphere.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Color from \"../Core/Color.js\";\nimport ColorGeometryInstanceAttribute from \"../Core/ColorGeometryInstanceAttribute.js\";\nimport CullingVolume from \"../Core/CullingVolume.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport deprecationWarning from \"../Core/deprecationWarning.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Intersect from \"../Core/Intersect.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Matrix3 from \"../Core/Matrix3.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport OrientedBoundingBox from \"../Core/OrientedBoundingBox.js\";\nimport OrthographicFrustum from \"../Core/OrthographicFrustum.js\";\nimport Rectangle from \"../Core/Rectangle.js\";\nimport Request from \"../Core/Request.js\";\nimport RequestScheduler from \"../Core/RequestScheduler.js\";\nimport RequestState from \"../Core/RequestState.js\";\nimport RequestType from \"../Core/RequestType.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Cesium3DContentGroup from \"./Cesium3DContentGroup.js\";\nimport Cesium3DTileContentFactory from \"./Cesium3DTileContentFactory.js\";\nimport Cesium3DTileContentState from \"./Cesium3DTileContentState.js\";\nimport Cesium3DTileContentType from \"./Cesium3DTileContentType.js\";\nimport Cesium3DTileOptimizationHint from \"./Cesium3DTileOptimizationHint.js\";\nimport Cesium3DTilePass from \"./Cesium3DTilePass.js\";\nimport Cesium3DTileRefine from \"./Cesium3DTileRefine.js\";\nimport Empty3DTileContent from \"./Empty3DTileContent.js\";\nimport findContentMetadata from \"./findContentMetadata.js\";\nimport findGroupMetadata from \"./findGroupMetadata.js\";\nimport findTileMetadata from \"./findTileMetadata.js\";\nimport hasExtension from \"./hasExtension.js\";\nimport Multiple3DTileContent from \"./Multiple3DTileContent.js\";\nimport preprocess3DTileContent from \"./preprocess3DTileContent.js\";\nimport SceneMode from \"./SceneMode.js\";\nimport TileBoundingRegion from \"./TileBoundingRegion.js\";\nimport TileBoundingS2Cell from \"./TileBoundingS2Cell.js\";\nimport TileBoundingSphere from \"./TileBoundingSphere.js\";\nimport TileOrientedBoundingBox from \"./TileOrientedBoundingBox.js\";\nimport Pass from \"../Renderer/Pass.js\";\n\n/**\n * A tile in a {@link Cesium3DTileset}.  When a tile is first created, its content is not loaded;\n * the content is loaded on-demand when needed based on the view.\n * <p>\n * Do not construct this directly, instead access tiles through {@link Cesium3DTileset#tileVisible}.\n * </p>\n *\n * @alias Cesium3DTile\n * @constructor\n */\nfunction Cesium3DTile(tileset, baseResource, header, parent) {\n  this._tileset = tileset;\n  this._header = header;\n\n  const hasContentsArray = defined(header.contents);\n  const hasMultipleContents =\n    (hasContentsArray && header.contents.length > 1) ||\n    hasExtension(header, \"3DTILES_multiple_contents\");\n\n  // In the 1.0 schema, content is stored in tile.content instead of tile.contents\n  const contentHeader =\n    hasContentsArray && !hasMultipleContents\n      ? header.contents[0]\n      : header.content;\n\n  this._contentHeader = contentHeader;\n\n  /**\n   * The local transform of this tile.\n   * @type {Matrix4}\n   */\n  this.transform = defined(header.transform)\n    ? Matrix4.unpack(header.transform)\n    : Matrix4.clone(Matrix4.IDENTITY);\n\n  const parentTransform = defined(parent)\n    ? parent.computedTransform\n    : tileset.modelMatrix;\n  const computedTransform = Matrix4.multiply(\n    parentTransform,\n    this.transform,\n    new Matrix4()\n  );\n\n  const parentInitialTransform = defined(parent)\n    ? parent._initialTransform\n    : Matrix4.IDENTITY;\n  this._initialTransform = Matrix4.multiply(\n    parentInitialTransform,\n    this.transform,\n    new Matrix4()\n  );\n\n  /**\n   * The final computed transform of this tile.\n   * @type {Matrix4}\n   * @readonly\n   */\n  this.computedTransform = computedTransform;\n\n  this._boundingVolume = this.createBoundingVolume(\n    header.boundingVolume,\n    computedTransform\n  );\n  this._boundingVolume2D = undefined;\n\n  let contentBoundingVolume;\n\n  if (defined(contentHeader) && defined(contentHeader.boundingVolume)) {\n    // Non-leaf tiles may have a content bounding-volume, which is a tight-fit bounding volume\n    // around only the features in the tile.  This box is useful for culling for rendering,\n    // but not for culling for traversing the tree since it does not guarantee spatial coherence, i.e.,\n    // since it only bounds features in the tile, not the entire tile, children may be\n    // outside of this box.\n    contentBoundingVolume = this.createBoundingVolume(\n      contentHeader.boundingVolume,\n      computedTransform\n    );\n  }\n  this._contentBoundingVolume = contentBoundingVolume;\n  this._contentBoundingVolume2D = undefined;\n\n  let viewerRequestVolume;\n  if (defined(header.viewerRequestVolume)) {\n    viewerRequestVolume = this.createBoundingVolume(\n      header.viewerRequestVolume,\n      computedTransform\n    );\n  }\n  this._viewerRequestVolume = viewerRequestVolume;\n\n  /**\n   * The error, in meters, introduced if this tile is rendered and its children are not.\n   * This is used to compute screen space error, i.e., the error measured in pixels.\n   *\n   * @type {Number}\n   * @readonly\n   */\n  this.geometricError = header.geometricError;\n  this._geometricError = header.geometricError;\n\n  if (!defined(this._geometricError)) {\n    this._geometricError = defined(parent)\n      ? parent.geometricError\n      : tileset._geometricError;\n    Cesium3DTile._deprecationWarning(\n      \"geometricErrorUndefined\",\n      \"Required property geometricError is undefined for this tile. Using parent's geometric error instead.\"\n    );\n  }\n\n  this.updateGeometricErrorScale();\n\n  let refine;\n  if (defined(header.refine)) {\n    if (header.refine === \"replace\" || header.refine === \"add\") {\n      Cesium3DTile._deprecationWarning(\n        \"lowercase-refine\",\n        `This tile uses a lowercase refine \"${\n          header.refine\n        }\". Instead use \"${header.refine.toUpperCase()}\".`\n      );\n    }\n    refine =\n      header.refine.toUpperCase() === \"REPLACE\"\n        ? Cesium3DTileRefine.REPLACE\n        : Cesium3DTileRefine.ADD;\n  } else if (defined(parent)) {\n    // Inherit from parent tile if omitted.\n    refine = parent.refine;\n  } else {\n    refine = Cesium3DTileRefine.REPLACE;\n  }\n\n  /**\n   * Specifies the type of refinement that is used when traversing this tile for rendering.\n   *\n   * @type {Cesium3DTileRefine}\n   * @readonly\n   * @private\n   */\n  this.refine = refine;\n\n  /**\n   * Gets the tile's children.\n   *\n   * @type {Cesium3DTile[]}\n   * @readonly\n   */\n  this.children = [];\n\n  /**\n   * This tile's parent or <code>undefined</code> if this tile is the root.\n   * <p>\n   * When a tile's content points to an external tileset JSON file, the external tileset's\n   * root tile's parent is not <code>undefined</code>; instead, the parent references\n   * the tile (with its content pointing to an external tileset JSON file) as if the two tilesets were merged.\n   * </p>\n   *\n   * @type {Cesium3DTile}\n   * @readonly\n   */\n  this.parent = parent;\n\n  let content;\n  let hasEmptyContent = false;\n  let contentState;\n  let contentResource;\n  let serverKey;\n\n  baseResource = Resource.createIfNeeded(baseResource);\n\n  if (hasMultipleContents) {\n    contentState = Cesium3DTileContentState.UNLOADED;\n    // Each content may have its own URI, but they all need to be resolved\n    // relative to the tileset, so the base resource is used.\n    contentResource = baseResource.clone();\n  } else if (defined(contentHeader)) {\n    let contentHeaderUri = contentHeader.uri;\n    if (defined(contentHeader.url)) {\n      Cesium3DTile._deprecationWarning(\n        \"contentUrl\",\n        'This tileset JSON uses the \"content.url\" property which has been deprecated. Use \"content.uri\" instead.'\n      );\n      contentHeaderUri = contentHeader.url;\n    }\n    contentState = Cesium3DTileContentState.UNLOADED;\n    contentResource = baseResource.getDerivedResource({\n      url: contentHeaderUri,\n    });\n    serverKey = RequestScheduler.getServerKey(\n      contentResource.getUrlComponent()\n    );\n  } else {\n    content = new Empty3DTileContent(tileset, this);\n    hasEmptyContent = true;\n    contentState = Cesium3DTileContentState.READY;\n  }\n\n  this._content = content;\n  this._contentResource = contentResource;\n  this._contentState = contentState;\n  this._contentReadyToProcessPromise = undefined;\n  this._contentReadyPromise = undefined;\n  this._expiredContent = undefined;\n\n  this._serverKey = serverKey;\n\n  /**\n   * When <code>true</code>, the tile has no content.\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  this.hasEmptyContent = hasEmptyContent;\n\n  /**\n   * When <code>true</code>, the tile's content points to an external tileset.\n   * <p>\n   * This is <code>false</code> until the tile's content is loaded.\n   * </p>\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  this.hasTilesetContent = false;\n\n  /**\n   * When <code>true</code>, the tile's content is an implicit tileset.\n   * <p>\n   * This is <code>false</code> until the tile's implicit content is loaded.\n   * </p>\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.hasImplicitContent = false;\n\n  /**\n   * When <code>true</code>, the tile contains content metadata from implicit tiling. This flag is set\n   * for tiles transcoded by <code>Implicit3DTileContent</code>.\n   * <p>\n   * This is <code>false</code> until the tile's content is loaded.\n   * </p>\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.hasImplicitContentMetadata = false;\n\n  /**\n   * When <code>true</code>, the tile has multiple contents, either in the tile JSON (3D Tiles 1.1)\n   * or via the <code>3DTILES_multiple_contents</code> extension.\n   *\n   * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/extensions/3DTILES_multiple_contents|3DTILES_multiple_contents extension}\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  this.hasMultipleContents = hasMultipleContents;\n\n  /**\n   * When tile metadata is present (3D Tiles 1.1) or the <code>3DTILES_metadata</code> extension is used,\n   * this stores a {@link TileMetadata} object for accessing tile metadata.\n   *\n   * @type {TileMetadata}\n   * @readonly\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.metadata = findTileMetadata(tileset, header);\n\n  /**\n   * The node in the tileset's LRU cache, used to determine when to unload a tile's content.\n   *\n   * See {@link Cesium3DTilesetCache}\n   *\n   * @type {DoublyLinkedListNode}\n   * @readonly\n   *\n   * @private\n   */\n  this.cacheNode = undefined;\n\n  const expire = header.expire;\n  let expireDuration;\n  let expireDate;\n  if (defined(expire)) {\n    expireDuration = expire.duration;\n    if (defined(expire.date)) {\n      expireDate = JulianDate.fromIso8601(expire.date);\n    }\n  }\n\n  /**\n   * The time in seconds after the tile's content is ready when the content expires and new content is requested.\n   *\n   * @type {Number}\n   */\n  this.expireDuration = expireDuration;\n\n  /**\n   * The date when the content expires and new content is requested.\n   *\n   * @type {JulianDate}\n   */\n  this.expireDate = expireDate;\n\n  /**\n   * The time when a style was last applied to this tile.\n   *\n   * @type {Number}\n   *\n   * @private\n   */\n  this.lastStyleTime = 0.0;\n\n  /**\n   * Marks whether the tile's children bounds are fully contained within the tile's bounds\n   *\n   * @type {Cesium3DTileOptimizationHint}\n   *\n   * @private\n   */\n  this._optimChildrenWithinParent = Cesium3DTileOptimizationHint.NOT_COMPUTED;\n\n  /**\n   * Tracks if the tile's relationship with a ClippingPlaneCollection has changed with regards\n   * to the ClippingPlaneCollection's state.\n   *\n   * @type {Boolean}\n   *\n   * @private\n   */\n  this.clippingPlanesDirty = false;\n\n  /**\n   * Tracks if the tile's request should be deferred until all non-deferred\n   * tiles load.\n   *\n   * @type {Boolean}\n   *\n   * @private\n   */\n  this.priorityDeferred = false;\n\n  /**\n   * For implicit tiling, an ImplicitTileset object will be attached to a\n   * placeholder tile with either implicit tiling in the JSON (3D Tiles 1.1)\n   * or the <code>3DTILES_implicit_tiling</code> extension.\n   * This way the {@link Implicit3DTileContent} can access the tile later once the content is fetched.\n   *\n   * @type {ImplicitTileset|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.implicitTileset = undefined;\n\n  /**\n   * For implicit tiling, the (level, x, y, [z]) coordinates within the\n   * implicit tileset are stored in the tile.\n   *\n   * @type {ImplicitTileCoordinates|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.implicitCoordinates = undefined;\n\n  /**\n   * For implicit tiling, each transcoded tile will hold a weak reference to\n   * the {@link ImplicitSubtree}.\n   *\n   * @type {ImplicitSubtree|undefined}\n   *\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.implicitSubtree = undefined;\n\n  // Members that are updated every frame for tree traversal and rendering optimizations:\n  this._distanceToCamera = 0.0;\n  this._centerZDepth = 0.0;\n  this._screenSpaceError = 0.0;\n  this._screenSpaceErrorProgressiveResolution = 0.0; // The screen space error at a given screen height of tileset.progressiveResolutionHeightFraction * screenHeight\n  this._visibilityPlaneMask = 0;\n  this._visible = false;\n  this._inRequestVolume = false;\n\n  this._finalResolution = true;\n  this._depth = 0;\n  this._stackLength = 0;\n  this._selectionDepth = 0;\n\n  this._updatedVisibilityFrame = 0;\n  this._touchedFrame = 0;\n  this._visitedFrame = 0;\n  this._selectedFrame = 0;\n  this._requestedFrame = 0;\n  this._ancestorWithContent = undefined;\n  this._ancestorWithContentAvailable = undefined;\n  this._refines = false;\n  this._shouldSelect = false;\n  this._isClipped = true;\n  this._clippingPlanesState = 0; // encapsulates (_isClipped, clippingPlanes.enabled) and number/function\n  this._debugBoundingVolume = undefined;\n  this._debugContentBoundingVolume = undefined;\n  this._debugViewerRequestVolume = undefined;\n  this._debugColor = Color.fromRandom({ alpha: 1.0 });\n  this._debugColorizeTiles = false;\n\n  this._priority = 0.0; // The priority used for request sorting\n  this._priorityHolder = this; // Reference to the ancestor up the tree that holds the _foveatedFactor and _distanceToCamera for all tiles in the refinement chain.\n  this._priorityProgressiveResolution = false;\n  this._priorityProgressiveResolutionScreenSpaceErrorLeaf = false;\n  this._priorityReverseScreenSpaceError = 0.0;\n  this._foveatedFactor = 0.0;\n  this._wasMinPriorityChild = false; // Needed for knowing when to continue a refinement chain. Gets reset in updateTile in traversal and gets set in updateAndPushChildren in traversal.\n\n  this._loadTimestamp = new JulianDate();\n\n  this._commandsLength = 0;\n\n  this._color = undefined;\n  this._colorDirty = false;\n\n  this._request = undefined;\n}\n\n// This can be overridden for testing purposes\nCesium3DTile._deprecationWarning = deprecationWarning;\n\nObject.defineProperties(Cesium3DTile.prototype, {\n  /**\n   * The tileset containing this tile.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Cesium3DTileset}\n   * @readonly\n   */\n  tileset: {\n    get: function () {\n      return this._tileset;\n    },\n  },\n\n  /**\n   * The tile's content.  This represents the actual tile's payload,\n   * not the content's metadata in the tileset JSON file.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Cesium3DTileContent}\n   * @readonly\n   */\n  content: {\n    get: function () {\n      return this._content;\n    },\n  },\n\n  /**\n   * Get the tile's bounding volume.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {TileBoundingVolume}\n   * @readonly\n   * @private\n   */\n  boundingVolume: {\n    get: function () {\n      return this._boundingVolume;\n    },\n  },\n\n  /**\n   * Get the bounding volume of the tile's contents.  This defaults to the\n   * tile's bounding volume when the content's bounding volume is\n   * <code>undefined</code>.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {TileBoundingVolume}\n   * @readonly\n   * @private\n   */\n  contentBoundingVolume: {\n    get: function () {\n      return defaultValue(this._contentBoundingVolume, this._boundingVolume);\n    },\n  },\n\n  /**\n   * Get the bounding sphere derived from the tile's bounding volume.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {BoundingSphere}\n   * @readonly\n   */\n  boundingSphere: {\n    get: function () {\n      return this._boundingVolume.boundingSphere;\n    },\n  },\n\n  /**\n   * Returns the <code>extras</code> property in the tileset JSON for this tile, which contains application specific metadata.\n   * Returns <code>undefined</code> if <code>extras</code> does not exist.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {*}\n   * @readonly\n   * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification#specifying-extensions-and-application-specific-extras|Extras in the 3D Tiles specification.}\n   */\n  extras: {\n    get: function () {\n      return this._header.extras;\n    },\n  },\n\n  /**\n   * Gets or sets the tile's highlight color.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Color}\n   *\n   * @default {@link Color.WHITE}\n   *\n   * @private\n   */\n  color: {\n    get: function () {\n      if (!defined(this._color)) {\n        this._color = new Color();\n      }\n      return Color.clone(this._color);\n    },\n    set: function (value) {\n      this._color = Color.clone(value, this._color);\n      this._colorDirty = true;\n    },\n  },\n\n  /**\n   * Determines if the tile has available content to render.  <code>true</code> if the tile's\n   * content is ready or if it has expired content that renders while new content loads; otherwise,\n   * <code>false</code>.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  contentAvailable: {\n    get: function () {\n      return (\n        (this.contentReady &&\n          !this.hasEmptyContent &&\n          !this.hasTilesetContent &&\n          !this.hasImplicitContent) ||\n        (defined(this._expiredContent) && !this.contentFailed)\n      );\n    },\n  },\n\n  /**\n   * Determines if the tile's content is ready. This is automatically <code>true</code> for\n   * tile's with empty content.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  contentReady: {\n    get: function () {\n      return this._contentState === Cesium3DTileContentState.READY;\n    },\n  },\n\n  /**\n   * Determines if the tile's content has not be requested. <code>true</code> if tile's\n   * content has not be requested; otherwise, <code>false</code>.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  contentUnloaded: {\n    get: function () {\n      return this._contentState === Cesium3DTileContentState.UNLOADED;\n    },\n  },\n\n  /**\n   * Determines if the tile's content is expired. <code>true</code> if tile's\n   * content is expired; otherwise, <code>false</code>.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  contentExpired: {\n    get: function () {\n      return this._contentState === Cesium3DTileContentState.EXPIRED;\n    },\n  },\n\n  /**\n   * Determines if the tile's content failed to load.  <code>true</code> if the tile's\n   * content failed to load; otherwise, <code>false</code>.\n   *\n   * @memberof Cesium3DTile.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  contentFailed: {\n    get: function () {\n      return this._contentState === Cesium3DTileContentState.FAILED;\n    },\n  },\n\n  /**\n   * Gets the promise that will be resolved when the tile's content is ready to process.\n   * This happens after the content is downloaded but before the content is ready\n   * to render.\n   * <p>\n   * The promise remains <code>undefined</code> until the tile's content is requested.\n   * </p>\n   *\n   * @type {Promise.<Cesium3DTileContent>}\n   * @readonly\n   *\n   * @private\n   */\n  contentReadyToProcessPromise: {\n    get: function () {\n      return this._contentReadyToProcessPromise;\n    },\n  },\n\n  /**\n   * Gets the promise that will be resolved when the tile's content is ready to render.\n   * <p>\n   * The promise remains <code>undefined</code> until the tile's content is requested.\n   * </p>\n   *\n   * @type {Promise.<Cesium3DTileContent>}\n   * @readonly\n   *\n   * @private\n   */\n  contentReadyPromise: {\n    get: function () {\n      return this._contentReadyPromise;\n    },\n  },\n\n  /**\n   * Returns the number of draw commands used by this tile.\n   *\n   * @readonly\n   *\n   * @private\n   */\n  commandsLength: {\n    get: function () {\n      return this._commandsLength;\n    },\n  },\n});\n\nconst scratchCartesian = new Cartesian3();\nfunction isPriorityDeferred(tile, frameState) {\n  const tileset = tile._tileset;\n\n  // If closest point on line is inside the sphere then set foveatedFactor to 0. Otherwise, the dot product is with the line from camera to the point on the sphere that is closest to the line.\n  const camera = frameState.camera;\n  const boundingSphere = tile.boundingSphere;\n  const radius = boundingSphere.radius;\n  const scaledCameraDirection = Cartesian3.multiplyByScalar(\n    camera.directionWC,\n    tile._centerZDepth,\n    scratchCartesian\n  );\n  const closestPointOnLine = Cartesian3.add(\n    camera.positionWC,\n    scaledCameraDirection,\n    scratchCartesian\n  );\n  // The distance from the camera's view direction to the tile.\n  const toLine = Cartesian3.subtract(\n    closestPointOnLine,\n    boundingSphere.center,\n    scratchCartesian\n  );\n  const distanceToCenterLine = Cartesian3.magnitude(toLine);\n  const notTouchingSphere = distanceToCenterLine > radius;\n\n  // If camera's direction vector is inside the bounding sphere then consider\n  // this tile right along the line of sight and set _foveatedFactor to 0.\n  // Otherwise,_foveatedFactor is one minus the dot product of the camera's direction\n  // and the vector between the camera and the point on the bounding sphere closest to the view line.\n  if (notTouchingSphere) {\n    const toLineNormalized = Cartesian3.normalize(toLine, scratchCartesian);\n    const scaledToLine = Cartesian3.multiplyByScalar(\n      toLineNormalized,\n      radius,\n      scratchCartesian\n    );\n    const closestOnSphere = Cartesian3.add(\n      boundingSphere.center,\n      scaledToLine,\n      scratchCartesian\n    );\n    const toClosestOnSphere = Cartesian3.subtract(\n      closestOnSphere,\n      camera.positionWC,\n      scratchCartesian\n    );\n    const toClosestOnSphereNormalize = Cartesian3.normalize(\n      toClosestOnSphere,\n      scratchCartesian\n    );\n    tile._foveatedFactor =\n      1.0 -\n      Math.abs(Cartesian3.dot(camera.directionWC, toClosestOnSphereNormalize));\n  } else {\n    tile._foveatedFactor = 0.0;\n  }\n\n  // Skip this feature if: non-skipLevelOfDetail and replace refine, if the foveated settings are turned off, if tile is progressive resolution and replace refine and skipLevelOfDetail (will help get rid of ancestor artifacts faster)\n  // Or if the tile is a preload of any kind\n  const replace = tile.refine === Cesium3DTileRefine.REPLACE;\n  const skipLevelOfDetail = tileset._skipLevelOfDetail;\n  if (\n    (replace && !skipLevelOfDetail) ||\n    !tileset.foveatedScreenSpaceError ||\n    tileset.foveatedConeSize === 1.0 ||\n    (tile._priorityProgressiveResolution && replace && skipLevelOfDetail) ||\n    tileset._pass === Cesium3DTilePass.PRELOAD_FLIGHT ||\n    tileset._pass === Cesium3DTilePass.PRELOAD\n  ) {\n    return false;\n  }\n\n  const maximumFovatedFactor = 1.0 - Math.cos(camera.frustum.fov * 0.5); // 0.14 for fov = 60. NOTE very hard to defer vertically foveated tiles since max is based on fovy (which is fov). Lowering the 0.5 to a smaller fraction of the screen height will start to defer vertically foveated tiles.\n  const foveatedConeFactor = tileset.foveatedConeSize * maximumFovatedFactor;\n\n  // If it's inside the user-defined view cone, then it should not be deferred.\n  if (tile._foveatedFactor <= foveatedConeFactor) {\n    return false;\n  }\n\n  // Relax SSE based on how big the angle is between the tile and the edge of the foveated cone.\n  const range = maximumFovatedFactor - foveatedConeFactor;\n  const normalizedFoveatedFactor = CesiumMath.clamp(\n    (tile._foveatedFactor - foveatedConeFactor) / range,\n    0.0,\n    1.0\n  );\n  const sseRelaxation = tileset.foveatedInterpolationCallback(\n    tileset.foveatedMinimumScreenSpaceErrorRelaxation,\n    tileset.maximumScreenSpaceError,\n    normalizedFoveatedFactor\n  );\n  const sse =\n    tile._screenSpaceError === 0.0 && defined(tile.parent)\n      ? tile.parent._screenSpaceError * 0.5\n      : tile._screenSpaceError;\n\n  return tileset.maximumScreenSpaceError - sseRelaxation <= sse;\n}\n\nconst scratchJulianDate = new JulianDate();\n\n/**\n * Get the tile's screen space error.\n *\n * @private\n */\nCesium3DTile.prototype.getScreenSpaceError = function (\n  frameState,\n  useParentGeometricError,\n  progressiveResolutionHeightFraction\n) {\n  const tileset = this._tileset;\n  const heightFraction = defaultValue(progressiveResolutionHeightFraction, 1.0);\n  const parentGeometricError = defined(this.parent)\n    ? this.parent.geometricError\n    : tileset._geometricError;\n  const geometricError = useParentGeometricError\n    ? parentGeometricError\n    : this.geometricError;\n  if (geometricError === 0.0) {\n    // Leaf tiles do not have any error so save the computation\n    return 0.0;\n  }\n  const camera = frameState.camera;\n  let frustum = camera.frustum;\n  const context = frameState.context;\n  const width = context.drawingBufferWidth;\n  const height = context.drawingBufferHeight * heightFraction;\n  let error;\n  if (\n    frameState.mode === SceneMode.SCENE2D ||\n    frustum instanceof OrthographicFrustum\n  ) {\n    if (defined(frustum._offCenterFrustum)) {\n      frustum = frustum._offCenterFrustum;\n    }\n    const pixelSize =\n      Math.max(frustum.top - frustum.bottom, frustum.right - frustum.left) /\n      Math.max(width, height);\n    error = geometricError / pixelSize;\n  } else {\n    // Avoid divide by zero when viewer is inside the tile\n    const distance = Math.max(this._distanceToCamera, CesiumMath.EPSILON7);\n    const sseDenominator = camera.frustum.sseDenominator;\n    error = (geometricError * height) / (distance * sseDenominator);\n    if (tileset.dynamicScreenSpaceError) {\n      const density = tileset._dynamicScreenSpaceErrorComputedDensity;\n      const factor = tileset.dynamicScreenSpaceErrorFactor;\n      const dynamicError = CesiumMath.fog(distance, density) * factor;\n      error -= dynamicError;\n    }\n  }\n\n  error /= frameState.pixelRatio;\n\n  return error;\n};\n\nfunction isPriorityProgressiveResolution(tileset, tile) {\n  if (\n    tileset.progressiveResolutionHeightFraction <= 0.0 ||\n    tileset.progressiveResolutionHeightFraction > 0.5\n  ) {\n    return false;\n  }\n\n  let isProgressiveResolutionTile =\n    tile._screenSpaceErrorProgressiveResolution >\n    tileset._maximumScreenSpaceError; // Mark non-SSE leaves\n  tile._priorityProgressiveResolutionScreenSpaceErrorLeaf = false; // Needed for skipLOD\n  const parent = tile.parent;\n  const maximumScreenSpaceError = tileset._maximumScreenSpaceError;\n  const tilePasses =\n    tile._screenSpaceErrorProgressiveResolution <= maximumScreenSpaceError;\n  const parentFails =\n    defined(parent) &&\n    parent._screenSpaceErrorProgressiveResolution > maximumScreenSpaceError;\n  if (tilePasses && parentFails) {\n    // A progressive resolution SSE leaf, promote its priority as well\n    tile._priorityProgressiveResolutionScreenSpaceErrorLeaf = true;\n    isProgressiveResolutionTile = true;\n  }\n  return isProgressiveResolutionTile;\n}\n\nfunction getPriorityReverseScreenSpaceError(tileset, tile) {\n  const parent = tile.parent;\n  const useParentScreenSpaceError =\n    defined(parent) &&\n    (!tileset._skipLevelOfDetail ||\n      tile._screenSpaceError === 0.0 ||\n      parent.hasTilesetContent ||\n      parent.hasImplicitContent);\n  const screenSpaceError = useParentScreenSpaceError\n    ? parent._screenSpaceError\n    : tile._screenSpaceError;\n  return tileset.root._screenSpaceError - screenSpaceError;\n}\n\n/**\n * Update the tile's visibility.\n *\n * @private\n */\nCesium3DTile.prototype.updateVisibility = function (frameState) {\n  const parent = this.parent;\n  const tileset = this._tileset;\n  const parentTransform = defined(parent)\n    ? parent.computedTransform\n    : tileset.modelMatrix;\n  const parentVisibilityPlaneMask = defined(parent)\n    ? parent._visibilityPlaneMask\n    : CullingVolume.MASK_INDETERMINATE;\n  this.updateTransform(parentTransform);\n  this._distanceToCamera = this.distanceToTile(frameState);\n  this._centerZDepth = this.distanceToTileCenter(frameState);\n  this._screenSpaceError = this.getScreenSpaceError(frameState, false);\n  this._screenSpaceErrorProgressiveResolution = this.getScreenSpaceError(\n    frameState,\n    false,\n    tileset.progressiveResolutionHeightFraction\n  );\n  this._visibilityPlaneMask = this.visibility(\n    frameState,\n    parentVisibilityPlaneMask\n  ); // Use parent's plane mask to speed up visibility test\n  this._visible = this._visibilityPlaneMask !== CullingVolume.MASK_OUTSIDE;\n  this._inRequestVolume = this.insideViewerRequestVolume(frameState);\n  this._priorityReverseScreenSpaceError = getPriorityReverseScreenSpaceError(\n    tileset,\n    this\n  );\n  this._priorityProgressiveResolution = isPriorityProgressiveResolution(\n    tileset,\n    this\n  );\n  this.priorityDeferred = isPriorityDeferred(this, frameState);\n};\n\n/**\n * Update whether the tile has expired.\n *\n * @private\n */\nCesium3DTile.prototype.updateExpiration = function () {\n  if (\n    defined(this.expireDate) &&\n    this.contentReady &&\n    !this.hasEmptyContent &&\n    !this.hasMultipleContents\n  ) {\n    const now = JulianDate.now(scratchJulianDate);\n    if (JulianDate.lessThan(this.expireDate, now)) {\n      this._contentState = Cesium3DTileContentState.EXPIRED;\n      this._expiredContent = this._content;\n    }\n  }\n};\n\nfunction updateExpireDate(tile) {\n  if (defined(tile.expireDuration)) {\n    const expireDurationDate = JulianDate.now(scratchJulianDate);\n    JulianDate.addSeconds(\n      expireDurationDate,\n      tile.expireDuration,\n      expireDurationDate\n    );\n\n    if (defined(tile.expireDate)) {\n      if (JulianDate.lessThan(tile.expireDate, expireDurationDate)) {\n        JulianDate.clone(expireDurationDate, tile.expireDate);\n      }\n    } else {\n      tile.expireDate = JulianDate.clone(expireDurationDate);\n    }\n  }\n}\n\nfunction createPriorityFunction(tile) {\n  return function () {\n    return tile._priority;\n  };\n}\n\n/**\n * Requests the tile's content.\n * <p>\n * The request may not be made if the Cesium Request Scheduler can't prioritize it.\n * </p>\n *\n * @return {Number} The number of requests that were attempted but not scheduled.\n * @private\n */\nCesium3DTile.prototype.requestContent = function () {\n  // empty contents don't require any HTTP requests\n  if (this.hasEmptyContent) {\n    return 0;\n  }\n\n  if (this.hasMultipleContents) {\n    return requestMultipleContents(this);\n  }\n\n  return requestSingleContent(this);\n};\n\n/**\n * Multiple {@link Cesium3DTileContent}s are allowed within a single tile either through\n * the tile JSON (3D Tiles 1.1) or the <code>3DTILES_multiple_contents</code> extension.\n * Due to differences in request scheduling, this is handled separately.\n * <p>\n * This implementation of multiple contents does not\n * support tile expiry like requestSingleContent does. If this changes,\n * note that the resource.setQueryParameters() details must go inside {@link Multiple3DTileContent} since that is per-request.\n * </p>\n *\n * @private\n */\nfunction requestMultipleContents(tile) {\n  let multipleContents = tile._content;\n  const tileset = tile._tileset;\n\n  if (!defined(multipleContents)) {\n    // Create the content object immediately, it will handle scheduling\n    // requests for inner contents.\n    const contentsJson = hasExtension(tile._header, \"3DTILES_multiple_contents\")\n      ? tile._header.extensions[\"3DTILES_multiple_contents\"]\n      : tile._header;\n\n    multipleContents = new Multiple3DTileContent(\n      tileset,\n      tile,\n      tile._contentResource.clone(),\n      contentsJson\n    );\n    tile._content = multipleContents;\n  }\n\n  const backloggedRequestCount = multipleContents.requestInnerContents();\n  if (backloggedRequestCount > 0) {\n    return backloggedRequestCount;\n  }\n\n  tile._contentState = Cesium3DTileContentState.LOADING;\n  const contentReadyToProcessPromise = multipleContents.contentsFetchedPromise.then(\n    function () {\n      if (tile._contentState !== Cesium3DTileContentState.LOADING) {\n        // tile was canceled, short circuit.\n        return;\n      }\n\n      if (tile.isDestroyed()) {\n        multipleContentFailed(\n          tile,\n          tileset,\n          \"Tile was unloaded while content was loading\"\n        );\n        return;\n      }\n\n      tile._contentState = Cesium3DTileContentState.PROCESSING;\n      return multipleContents;\n    }\n  );\n  tile._contentReadyToProcessPromise = contentReadyToProcessPromise;\n  tile._contentReadyPromise = contentReadyToProcessPromise\n    .then(function (content) {\n      if (!defined(content)) {\n        // request was canceled, short circuit.\n        return;\n      }\n\n      return multipleContents.readyPromise;\n    })\n    .then(function (content) {\n      if (!defined(content)) {\n        // tile was canceled, short circuit.\n        return;\n      }\n\n      if (tile.isDestroyed()) {\n        multipleContentFailed(\n          tile,\n          tileset,\n          \"Tile was unloaded while content was processing\"\n        );\n        return;\n      }\n\n      // Refresh style for expired content\n      tile._selectedFrame = 0;\n      tile.lastStyleTime = 0.0;\n\n      JulianDate.now(tile._loadTimestamp);\n      tile._contentState = Cesium3DTileContentState.READY;\n      return content;\n    })\n    .catch(function (error) {\n      multipleContentFailed(tile, tileset, error);\n    });\n\n  return 0;\n}\n\nfunction multipleContentFailed(tile, tileset, error) {\n  // note: The Multiple3DTileContent handles decrementing the number of pending\n  // requests if the state is LOADING.\n  if (tile._contentState === Cesium3DTileContentState.PROCESSING) {\n    --tileset.statistics.numberOfTilesProcessing;\n  }\n\n  tile._contentState = Cesium3DTileContentState.FAILED;\n}\n\nfunction requestSingleContent(tile) {\n  // it is important to clone here. The fetchArrayBuffer() below uses\n  // throttling, but other uses of the resources do not.\n  const resource = tile._contentResource.clone();\n  const expired = tile.contentExpired;\n  if (expired) {\n    // Append a query parameter of the tile expiration date to prevent caching\n    resource.setQueryParameters({\n      expired: tile.expireDate.toString(),\n    });\n  }\n\n  const request = new Request({\n    throttle: true,\n    throttleByServer: true,\n    type: RequestType.TILES3D,\n    priorityFunction: createPriorityFunction(tile),\n    serverKey: tile._serverKey,\n  });\n\n  tile._request = request;\n  resource.request = request;\n\n  const promise = resource.fetchArrayBuffer();\n  if (!defined(promise)) {\n    return 1;\n  }\n\n  const previousState = tile._contentState;\n  const tileset = tile._tileset;\n  tile._contentState = Cesium3DTileContentState.LOADING;\n  ++tileset.statistics.numberOfPendingRequests;\n  const contentReadyToProcessPromise = promise.then(function (arrayBuffer) {\n    if (tile.isDestroyed()) {\n      // Tile is unloaded before the content finishes loading\n      singleContentFailed(tile, tileset);\n      return;\n    }\n\n    const content = makeContent(tile, arrayBuffer);\n\n    if (expired) {\n      tile.expireDate = undefined;\n    }\n\n    tile._content = content;\n    tile._contentState = Cesium3DTileContentState.PROCESSING;\n    return content;\n  });\n  tile._contentReadyToProcessPromise = contentReadyToProcessPromise;\n  tile._contentReadyPromise = contentReadyToProcessPromise\n    .then(function (content) {\n      if (!defined(content)) {\n        return;\n      }\n\n      --tileset.statistics.numberOfPendingRequests;\n      return content.readyPromise;\n    })\n    .then(function (content) {\n      if (!defined(content)) {\n        return;\n      }\n\n      if (tile.isDestroyed()) {\n        // Tile is unloaded before the content finishes processing\n        singleContentFailed(tile, tileset);\n        return;\n      }\n      updateExpireDate(tile);\n\n      // Refresh style for expired content\n      tile._selectedFrame = 0;\n      tile.lastStyleTime = 0.0;\n\n      JulianDate.now(tile._loadTimestamp);\n      tile._contentState = Cesium3DTileContentState.READY;\n      return content;\n    })\n    .catch(function (error) {\n      if (request.state === RequestState.CANCELLED) {\n        // Cancelled due to low priority - try again later.\n        tile._contentState = previousState;\n        --tileset.statistics.numberOfPendingRequests;\n        ++tileset.statistics.numberOfAttemptedRequests;\n        return Promise.reject(\"Cancelled\");\n      }\n      singleContentFailed(tile, tileset);\n      return Promise.reject(error);\n    });\n\n  return 0;\n}\n\nfunction singleContentFailed(tile, tileset) {\n  if (tile._contentState === Cesium3DTileContentState.PROCESSING) {\n    --tileset.statistics.numberOfTilesProcessing;\n  } else {\n    --tileset.statistics.numberOfPendingRequests;\n  }\n  tile._contentState = Cesium3DTileContentState.FAILED;\n}\n\n/**\n * Given a downloaded content payload, construct a {@link Cesium3DTileContent}.\n * <p>\n * This is only used for single contents.\n * </p>\n *\n * @param {Cesium3DTile} tile The tile\n * @param {ArrayBuffer} arrayBuffer The downloaded payload containing data for the content\n * @return {Cesium3DTileContent} A content object\n * @private\n */\nfunction makeContent(tile, arrayBuffer) {\n  const preprocessed = preprocess3DTileContent(arrayBuffer);\n\n  // Vector and Geometry tile rendering do not support the skip LOD optimization.\n  const tileset = tile._tileset;\n  tileset._disableSkipLevelOfDetail =\n    tileset._disableSkipLevelOfDetail ||\n    preprocessed.contentType === Cesium3DTileContentType.GEOMETRY ||\n    preprocessed.contentType === Cesium3DTileContentType.VECTOR;\n\n  if (\n    preprocessed.contentType === Cesium3DTileContentType.IMPLICIT_SUBTREE ||\n    preprocessed.contentType === Cesium3DTileContentType.IMPLICIT_SUBTREE_JSON\n  ) {\n    tile.hasImplicitContent = true;\n  }\n\n  if (preprocessed.contentType === Cesium3DTileContentType.EXTERNAL_TILESET) {\n    tile.hasTilesetContent = true;\n  }\n\n  let content;\n  const contentFactory = Cesium3DTileContentFactory[preprocessed.contentType];\n  if (defined(preprocessed.binaryPayload)) {\n    content = contentFactory(\n      tileset,\n      tile,\n      tile._contentResource,\n      preprocessed.binaryPayload.buffer,\n      0\n    );\n  } else {\n    // JSON formats\n    content = contentFactory(\n      tileset,\n      tile,\n      tile._contentResource,\n      preprocessed.jsonPayload\n    );\n  }\n\n  const contentHeader = tile._contentHeader;\n\n  if (tile.hasImplicitContentMetadata) {\n    const subtree = tile.implicitSubtree;\n    const coordinates = tile.implicitCoordinates;\n    content.metadata = subtree.getContentMetadataView(coordinates, 0);\n  } else if (!tile.hasImplicitContent) {\n    content.metadata = findContentMetadata(tileset, contentHeader);\n  }\n\n  const groupMetadata = findGroupMetadata(tileset, contentHeader);\n  if (defined(groupMetadata)) {\n    content.group = new Cesium3DContentGroup({\n      metadata: groupMetadata,\n    });\n  }\n\n  return content;\n}\n\n/**\n * Cancel requests for the tile's contents. This is called when the tile\n * goes out of view.\n *\n * @private\n */\nCesium3DTile.prototype.cancelRequests = function () {\n  if (this.hasMultipleContents) {\n    this._content.cancelRequests();\n  } else {\n    this._request.cancel();\n  }\n};\n\n/**\n * Unloads the tile's content.\n *\n * @private\n */\nCesium3DTile.prototype.unloadContent = function () {\n  if (\n    this.hasEmptyContent ||\n    this.hasTilesetContent ||\n    this.hasImplicitContent\n  ) {\n    return;\n  }\n\n  this._content = this._content && this._content.destroy();\n  this._contentState = Cesium3DTileContentState.UNLOADED;\n  this._contentReadyToProcessPromise = undefined;\n  this._contentReadyPromise = undefined;\n\n  this.lastStyleTime = 0.0;\n  this.clippingPlanesDirty = this._clippingPlanesState === 0;\n  this._clippingPlanesState = 0;\n\n  this._debugColorizeTiles = false;\n\n  this._debugBoundingVolume =\n    this._debugBoundingVolume && this._debugBoundingVolume.destroy();\n  this._debugContentBoundingVolume =\n    this._debugContentBoundingVolume &&\n    this._debugContentBoundingVolume.destroy();\n  this._debugViewerRequestVolume =\n    this._debugViewerRequestVolume && this._debugViewerRequestVolume.destroy();\n};\n\nconst scratchProjectedBoundingSphere = new BoundingSphere();\n\nfunction getBoundingVolume(tile, frameState) {\n  if (\n    frameState.mode !== SceneMode.SCENE3D &&\n    !defined(tile._boundingVolume2D)\n  ) {\n    const boundingSphere = tile._boundingVolume.boundingSphere;\n    const sphere = BoundingSphere.projectTo2D(\n      boundingSphere,\n      frameState.mapProjection,\n      scratchProjectedBoundingSphere\n    );\n    tile._boundingVolume2D = new TileBoundingSphere(\n      sphere.center,\n      sphere.radius\n    );\n  }\n\n  return frameState.mode !== SceneMode.SCENE3D\n    ? tile._boundingVolume2D\n    : tile._boundingVolume;\n}\n\nfunction getContentBoundingVolume(tile, frameState) {\n  if (\n    frameState.mode !== SceneMode.SCENE3D &&\n    !defined(tile._contentBoundingVolume2D)\n  ) {\n    const boundingSphere = tile._contentBoundingVolume.boundingSphere;\n    const sphere = BoundingSphere.projectTo2D(\n      boundingSphere,\n      frameState.mapProjection,\n      scratchProjectedBoundingSphere\n    );\n    tile._contentBoundingVolume2D = new TileBoundingSphere(\n      sphere.center,\n      sphere.radius\n    );\n  }\n  return frameState.mode !== SceneMode.SCENE3D\n    ? tile._contentBoundingVolume2D\n    : tile._contentBoundingVolume;\n}\n\n/**\n * Determines whether the tile's bounding volume intersects the culling volume.\n *\n * @param {FrameState} frameState The frame state.\n * @param {Number} parentVisibilityPlaneMask The parent's plane mask to speed up the visibility check.\n * @returns {Number} A plane mask as described above in {@link CullingVolume#computeVisibilityWithPlaneMask}.\n *\n * @private\n */\nCesium3DTile.prototype.visibility = function (\n  frameState,\n  parentVisibilityPlaneMask\n) {\n  const cullingVolume = frameState.cullingVolume;\n  const boundingVolume = getBoundingVolume(this, frameState);\n\n  const tileset = this._tileset;\n  const clippingPlanes = tileset.clippingPlanes;\n  if (defined(clippingPlanes) && clippingPlanes.enabled) {\n    const intersection = clippingPlanes.computeIntersectionWithBoundingVolume(\n      boundingVolume,\n      tileset.clippingPlanesOriginMatrix\n    );\n    this._isClipped = intersection !== Intersect.INSIDE;\n    if (intersection === Intersect.OUTSIDE) {\n      return CullingVolume.MASK_OUTSIDE;\n    }\n  }\n\n  return cullingVolume.computeVisibilityWithPlaneMask(\n    boundingVolume,\n    parentVisibilityPlaneMask\n  );\n};\n\n/**\n * Assuming the tile's bounding volume intersects the culling volume, determines\n * whether the tile's content's bounding volume intersects the culling volume.\n *\n * @param {FrameState} frameState The frame state.\n * @returns {Intersect} The result of the intersection: the tile's content is completely outside, completely inside, or intersecting the culling volume.\n *\n * @private\n */\nCesium3DTile.prototype.contentVisibility = function (frameState) {\n  // Assumes the tile's bounding volume intersects the culling volume already, so\n  // just return Intersect.INSIDE if there is no content bounding volume.\n  if (!defined(this._contentBoundingVolume)) {\n    return Intersect.INSIDE;\n  }\n\n  if (this._visibilityPlaneMask === CullingVolume.MASK_INSIDE) {\n    // The tile's bounding volume is completely inside the culling volume so\n    // the content bounding volume must also be inside.\n    return Intersect.INSIDE;\n  }\n\n  // PERFORMANCE_IDEA: is it possible to burn less CPU on this test since we know the\n  // tile's (not the content's) bounding volume intersects the culling volume?\n  const cullingVolume = frameState.cullingVolume;\n  const boundingVolume = getContentBoundingVolume(this, frameState);\n\n  const tileset = this._tileset;\n  const clippingPlanes = tileset.clippingPlanes;\n  if (defined(clippingPlanes) && clippingPlanes.enabled) {\n    const intersection = clippingPlanes.computeIntersectionWithBoundingVolume(\n      boundingVolume,\n      tileset.clippingPlanesOriginMatrix\n    );\n    this._isClipped = intersection !== Intersect.INSIDE;\n    if (intersection === Intersect.OUTSIDE) {\n      return Intersect.OUTSIDE;\n    }\n  }\n\n  return cullingVolume.computeVisibility(boundingVolume);\n};\n\n/**\n * Computes the (potentially approximate) distance from the closest point of the tile's bounding volume to the camera.\n *\n * @param {FrameState} frameState The frame state.\n * @returns {Number} The distance, in meters, or zero if the camera is inside the bounding volume.\n *\n * @private\n */\nCesium3DTile.prototype.distanceToTile = function (frameState) {\n  const boundingVolume = getBoundingVolume(this, frameState);\n  return boundingVolume.distanceToCamera(frameState);\n};\n\nconst scratchToTileCenter = new Cartesian3();\n\n/**\n * Computes the distance from the center of the tile's bounding volume to the camera's plane defined by its position and view direction.\n *\n * @param {FrameState} frameState The frame state.\n * @returns {Number} The distance, in meters.\n *\n * @private\n */\nCesium3DTile.prototype.distanceToTileCenter = function (frameState) {\n  const tileBoundingVolume = getBoundingVolume(this, frameState);\n  const boundingVolume = tileBoundingVolume.boundingVolume; // Gets the underlying OrientedBoundingBox or BoundingSphere\n  const toCenter = Cartesian3.subtract(\n    boundingVolume.center,\n    frameState.camera.positionWC,\n    scratchToTileCenter\n  );\n  return Cartesian3.dot(frameState.camera.directionWC, toCenter);\n};\n\n/**\n * Checks if the camera is inside the viewer request volume.\n *\n * @param {FrameState} frameState The frame state.\n * @returns {Boolean} Whether the camera is inside the volume.\n *\n * @private\n */\nCesium3DTile.prototype.insideViewerRequestVolume = function (frameState) {\n  const viewerRequestVolume = this._viewerRequestVolume;\n  return (\n    !defined(viewerRequestVolume) ||\n    viewerRequestVolume.distanceToCamera(frameState) === 0.0\n  );\n};\n\nconst scratchMatrix = new Matrix3();\nconst scratchScale = new Cartesian3();\nconst scratchHalfAxes = new Matrix3();\nconst scratchCenter = new Cartesian3();\nconst scratchRectangle = new Rectangle();\nconst scratchOrientedBoundingBox = new OrientedBoundingBox();\nconst scratchTransform = new Matrix4();\n\nfunction createBox(box, transform, result) {\n  let center = Cartesian3.fromElements(box[0], box[1], box[2], scratchCenter);\n  let halfAxes = Matrix3.fromArray(box, 3, scratchHalfAxes);\n\n  // Find the transformed center and halfAxes\n  center = Matrix4.multiplyByPoint(transform, center, center);\n  const rotationScale = Matrix4.getMatrix3(transform, scratchMatrix);\n  halfAxes = Matrix3.multiply(rotationScale, halfAxes, halfAxes);\n\n  if (defined(result)) {\n    result.update(center, halfAxes);\n    return result;\n  }\n  return new TileOrientedBoundingBox(center, halfAxes);\n}\n\nfunction createBoxFromTransformedRegion(\n  region,\n  transform,\n  initialTransform,\n  result\n) {\n  const rectangle = Rectangle.unpack(region, 0, scratchRectangle);\n  const minimumHeight = region[4];\n  const maximumHeight = region[5];\n\n  const orientedBoundingBox = OrientedBoundingBox.fromRectangle(\n    rectangle,\n    minimumHeight,\n    maximumHeight,\n    Ellipsoid.WGS84,\n    scratchOrientedBoundingBox\n  );\n  let center = orientedBoundingBox.center;\n  let halfAxes = orientedBoundingBox.halfAxes;\n\n  // A region bounding volume is not transformed by the transform in the tileset JSON,\n  // but may be transformed by additional transforms applied in Cesium.\n  // This is why the transform is calculated as the difference between the initial transform and the current transform.\n  transform = Matrix4.multiplyTransformation(\n    transform,\n    Matrix4.inverseTransformation(initialTransform, scratchTransform),\n    scratchTransform\n  );\n  center = Matrix4.multiplyByPoint(transform, center, center);\n  const rotationScale = Matrix4.getMatrix3(transform, scratchMatrix);\n  halfAxes = Matrix3.multiply(rotationScale, halfAxes, halfAxes);\n\n  if (defined(result) && result instanceof TileOrientedBoundingBox) {\n    result.update(center, halfAxes);\n    return result;\n  }\n\n  return new TileOrientedBoundingBox(center, halfAxes);\n}\n\nfunction createRegion(region, transform, initialTransform, result) {\n  if (\n    !Matrix4.equalsEpsilon(transform, initialTransform, CesiumMath.EPSILON8)\n  ) {\n    return createBoxFromTransformedRegion(\n      region,\n      transform,\n      initialTransform,\n      result\n    );\n  }\n\n  if (defined(result)) {\n    return result;\n  }\n\n  const rectangleRegion = Rectangle.unpack(region, 0, scratchRectangle);\n\n  return new TileBoundingRegion({\n    rectangle: rectangleRegion,\n    minimumHeight: region[4],\n    maximumHeight: region[5],\n  });\n}\n\nfunction createSphere(sphere, transform, result) {\n  let center = Cartesian3.fromElements(\n    sphere[0],\n    sphere[1],\n    sphere[2],\n    scratchCenter\n  );\n  let radius = sphere[3];\n\n  // Find the transformed center and radius\n  center = Matrix4.multiplyByPoint(transform, center, center);\n  const scale = Matrix4.getScale(transform, scratchScale);\n  const uniformScale = Cartesian3.maximumComponent(scale);\n  radius *= uniformScale;\n\n  if (defined(result)) {\n    result.update(center, radius);\n    return result;\n  }\n  return new TileBoundingSphere(center, radius);\n}\n\n/**\n * Create a bounding volume from the tile's bounding volume header.\n *\n * @param {Object} boundingVolumeHeader The tile's bounding volume header.\n * @param {Matrix4} transform The transform to apply to the bounding volume.\n * @param {TileBoundingVolume} [result] The object onto which to store the result.\n *\n * @returns {TileBoundingVolume} The modified result parameter or a new TileBoundingVolume instance if none was provided.\n *\n * @private\n */\nCesium3DTile.prototype.createBoundingVolume = function (\n  boundingVolumeHeader,\n  transform,\n  result\n) {\n  if (!defined(boundingVolumeHeader)) {\n    throw new RuntimeError(\"boundingVolume must be defined\");\n  }\n\n  if (hasExtension(boundingVolumeHeader, \"3DTILES_bounding_volume_S2\")) {\n    return new TileBoundingS2Cell(\n      boundingVolumeHeader.extensions[\"3DTILES_bounding_volume_S2\"]\n    );\n  }\n\n  if (defined(boundingVolumeHeader.box)) {\n    return createBox(boundingVolumeHeader.box, transform, result);\n  }\n  if (defined(boundingVolumeHeader.region)) {\n    return createRegion(\n      boundingVolumeHeader.region,\n      transform,\n      this._initialTransform,\n      result\n    );\n  }\n  if (defined(boundingVolumeHeader.sphere)) {\n    return createSphere(boundingVolumeHeader.sphere, transform, result);\n  }\n  throw new RuntimeError(\n    \"boundingVolume must contain a sphere, region, or box\"\n  );\n};\n\n/**\n * Update the tile's transform. The transform is applied to the tile's bounding volumes.\n *\n * @private\n */\nCesium3DTile.prototype.updateTransform = function (parentTransform) {\n  parentTransform = defaultValue(parentTransform, Matrix4.IDENTITY);\n  const computedTransform = Matrix4.multiply(\n    parentTransform,\n    this.transform,\n    scratchTransform\n  );\n  const transformChanged = !Matrix4.equals(\n    computedTransform,\n    this.computedTransform\n  );\n\n  if (!transformChanged) {\n    return;\n  }\n\n  Matrix4.clone(computedTransform, this.computedTransform);\n\n  // Update the bounding volumes\n  const header = this._header;\n  const contentHeader = this._contentHeader;\n  this._boundingVolume = this.createBoundingVolume(\n    header.boundingVolume,\n    this.computedTransform,\n    this._boundingVolume\n  );\n  if (defined(this._contentBoundingVolume)) {\n    this._contentBoundingVolume = this.createBoundingVolume(\n      contentHeader.boundingVolume,\n      this.computedTransform,\n      this._contentBoundingVolume\n    );\n  }\n  if (defined(this._viewerRequestVolume)) {\n    this._viewerRequestVolume = this.createBoundingVolume(\n      header.viewerRequestVolume,\n      this.computedTransform,\n      this._viewerRequestVolume\n    );\n  }\n\n  this.updateGeometricErrorScale();\n\n  // Destroy the debug bounding volumes. They will be generated fresh.\n  this._debugBoundingVolume =\n    this._debugBoundingVolume && this._debugBoundingVolume.destroy();\n  this._debugContentBoundingVolume =\n    this._debugContentBoundingVolume &&\n    this._debugContentBoundingVolume.destroy();\n  this._debugViewerRequestVolume =\n    this._debugViewerRequestVolume && this._debugViewerRequestVolume.destroy();\n};\n\nCesium3DTile.prototype.updateGeometricErrorScale = function () {\n  const scale = Matrix4.getScale(this.computedTransform, scratchScale);\n  const uniformScale = Cartesian3.maximumComponent(scale);\n  this.geometricError = this._geometricError * uniformScale;\n};\n\nfunction applyDebugSettings(tile, tileset, frameState, passOptions) {\n  if (!passOptions.isRender) {\n    return;\n  }\n\n  const hasContentBoundingVolume =\n    defined(tile._contentHeader) && defined(tile._contentHeader.boundingVolume);\n  const empty =\n    tile.hasEmptyContent || tile.hasTilesetContent || tile.hasImplicitContent;\n\n  const showVolume =\n    tileset.debugShowBoundingVolume ||\n    (tileset.debugShowContentBoundingVolume && !hasContentBoundingVolume);\n  if (showVolume) {\n    let color;\n    if (!tile._finalResolution) {\n      color = Color.YELLOW;\n    } else if (empty) {\n      color = Color.DARKGRAY;\n    } else {\n      color = Color.WHITE;\n    }\n    if (!defined(tile._debugBoundingVolume)) {\n      tile._debugBoundingVolume = tile._boundingVolume.createDebugVolume(color);\n    }\n    tile._debugBoundingVolume.update(frameState);\n    const attributes = tile._debugBoundingVolume.getGeometryInstanceAttributes(\n      \"outline\"\n    );\n    attributes.color = ColorGeometryInstanceAttribute.toValue(\n      color,\n      attributes.color\n    );\n  } else if (!showVolume && defined(tile._debugBoundingVolume)) {\n    tile._debugBoundingVolume = tile._debugBoundingVolume.destroy();\n  }\n\n  if (tileset.debugShowContentBoundingVolume && hasContentBoundingVolume) {\n    if (!defined(tile._debugContentBoundingVolume)) {\n      tile._debugContentBoundingVolume = tile._contentBoundingVolume.createDebugVolume(\n        Color.BLUE\n      );\n    }\n    tile._debugContentBoundingVolume.update(frameState);\n  } else if (\n    !tileset.debugShowContentBoundingVolume &&\n    defined(tile._debugContentBoundingVolume)\n  ) {\n    tile._debugContentBoundingVolume = tile._debugContentBoundingVolume.destroy();\n  }\n\n  if (\n    tileset.debugShowViewerRequestVolume &&\n    defined(tile._viewerRequestVolume)\n  ) {\n    if (!defined(tile._debugViewerRequestVolume)) {\n      tile._debugViewerRequestVolume = tile._viewerRequestVolume.createDebugVolume(\n        Color.YELLOW\n      );\n    }\n    tile._debugViewerRequestVolume.update(frameState);\n  } else if (\n    !tileset.debugShowViewerRequestVolume &&\n    defined(tile._debugViewerRequestVolume)\n  ) {\n    tile._debugViewerRequestVolume = tile._debugViewerRequestVolume.destroy();\n  }\n\n  const debugColorizeTilesOn =\n    (tileset.debugColorizeTiles && !tile._debugColorizeTiles) ||\n    defined(tileset._heatmap.tilePropertyName);\n  const debugColorizeTilesOff =\n    !tileset.debugColorizeTiles && tile._debugColorizeTiles;\n\n  if (debugColorizeTilesOn) {\n    tileset._heatmap.colorize(tile, frameState); // Skipped if tileset._heatmap.tilePropertyName is undefined\n    tile._debugColorizeTiles = true;\n    tile.color = tile._debugColor;\n  } else if (debugColorizeTilesOff) {\n    tile._debugColorizeTiles = false;\n    tile.color = Color.WHITE;\n  }\n\n  if (tile._colorDirty) {\n    tile._colorDirty = false;\n    tile._content.applyDebugSettings(true, tile._color);\n  }\n\n  if (debugColorizeTilesOff) {\n    tileset.makeStyleDirty(); // Re-apply style now that colorize is switched off\n  }\n}\n\nfunction updateContent(tile, tileset, frameState) {\n  const content = tile._content;\n  const expiredContent = tile._expiredContent;\n\n  // expired content is not supported for multiple contents\n  if (!tile.hasMultipleContents && defined(expiredContent)) {\n    if (!tile.contentReady) {\n      // Render the expired content while the content loads\n      expiredContent.update(tileset, frameState);\n      return;\n    }\n\n    // New content is ready, destroy expired content\n    tile._expiredContent.destroy();\n    tile._expiredContent = undefined;\n  }\n\n  content.update(tileset, frameState);\n}\n\nfunction updateClippingPlanes(tile, tileset) {\n  // Compute and compare ClippingPlanes state:\n  // - enabled-ness - are clipping planes enabled? is this tile clipped?\n  // - clipping plane count\n  // - clipping function (union v. intersection)\n  const clippingPlanes = tileset.clippingPlanes;\n  let currentClippingPlanesState = 0;\n  if (defined(clippingPlanes) && tile._isClipped && clippingPlanes.enabled) {\n    currentClippingPlanesState = clippingPlanes.clippingPlanesState;\n  }\n  // If clippingPlaneState for tile changed, mark clippingPlanesDirty so content can update\n  if (currentClippingPlanesState !== tile._clippingPlanesState) {\n    tile._clippingPlanesState = currentClippingPlanesState;\n    tile.clippingPlanesDirty = true;\n  }\n}\n\n/**\n * Get the draw commands needed to render this tile.\n *\n * @private\n */\nCesium3DTile.prototype.update = function (tileset, frameState, passOptions) {\n  const commandStart = frameState.commandList.length;\n\n  updateClippingPlanes(this, tileset);\n  applyDebugSettings(this, tileset, frameState, passOptions);\n  updateContent(this, tileset, frameState);\n\n  const commandEnd = frameState.commandList.length;\n  const commandsLength = commandEnd - commandStart;\n  this._commandsLength = commandsLength;\n\n  for (let i = 0; i < commandsLength; ++i) {\n    const command = frameState.commandList[commandStart + i];\n    const translucent = command.pass === Pass.TRANSLUCENT;\n    command.depthForTranslucentClassification = translucent;\n  }\n\n  this.clippingPlanesDirty = false; // reset after content update\n};\n\nconst scratchCommandList = [];\n\n/**\n * Processes the tile's content, e.g., create WebGL resources, to move from the PROCESSING to READY state.\n *\n * @param {Cesium3DTileset} tileset The tileset containing this tile.\n * @param {FrameState} frameState The frame state.\n *\n * @private\n */\nCesium3DTile.prototype.process = function (tileset, frameState) {\n  const savedCommandList = frameState.commandList;\n  frameState.commandList = scratchCommandList;\n\n  this._content.update(tileset, frameState);\n\n  scratchCommandList.length = 0;\n  frameState.commandList = savedCommandList;\n};\n\nfunction isolateDigits(normalizedValue, numberOfDigits, leftShift) {\n  const scaled = normalizedValue * Math.pow(10, numberOfDigits);\n  const integer = parseInt(scaled);\n  return integer * Math.pow(10, leftShift);\n}\n\nfunction priorityNormalizeAndClamp(value, minimum, maximum) {\n  return Math.max(\n    CesiumMath.normalize(value, minimum, maximum) - CesiumMath.EPSILON7,\n    0.0\n  ); // Subtract epsilon since we only want decimal digits present in the output.\n}\n\n/**\n * Sets the priority of the tile based on distance and depth\n * @private\n */\nCesium3DTile.prototype.updatePriority = function () {\n  const tileset = this.tileset;\n  const preferLeaves = tileset.preferLeaves;\n  const minimumPriority = tileset._minimumPriority;\n  const maximumPriority = tileset._maximumPriority;\n\n  // Combine priority systems together by mapping them into a base 10 number where each priority controls a specific set of digits in the number.\n  // For number priorities, map them to a 0.xxxxx number then left shift it up into a set number of digits before the decimal point. Chop of the fractional part then left shift again into the position it needs to go.\n  // For blending number priorities, normalize them to 0-1 and interpolate to get a combined 0-1 number, then proceed as normal.\n  // Booleans can just be 0 or 10^leftshift.\n  // Think of digits as penalties since smaller numbers are higher priority. If a tile has some large quantity or has a flag raised it's (usually) penalized for it, expressed as a higher number for the digit.\n  // Priority number format: preloadFlightDigits(1) | foveatedDeferDigits(1) | foveatedDigits(4) | preloadProgressiveResolutionDigits(1) | preferredSortingDigits(4) . depthDigits(the decimal digits)\n  // Certain flags like preferLeaves will flip / turn off certain digits to get desired load order.\n\n  // Setup leftShifts, digit counts, and scales (for booleans)\n  const digitsForANumber = 4;\n  const digitsForABoolean = 1;\n\n  const preferredSortingLeftShift = 0;\n  const preferredSortingDigitsCount = digitsForANumber;\n\n  const foveatedLeftShift =\n    preferredSortingLeftShift + preferredSortingDigitsCount;\n  const foveatedDigitsCount = digitsForANumber;\n\n  const preloadProgressiveResolutionLeftShift =\n    foveatedLeftShift + foveatedDigitsCount;\n  const preloadProgressiveResolutionDigitsCount = digitsForABoolean;\n  const preloadProgressiveResolutionScale = Math.pow(\n    10,\n    preloadProgressiveResolutionLeftShift\n  );\n\n  const foveatedDeferLeftShift =\n    preloadProgressiveResolutionLeftShift +\n    preloadProgressiveResolutionDigitsCount;\n  const foveatedDeferDigitsCount = digitsForABoolean;\n  const foveatedDeferScale = Math.pow(10, foveatedDeferLeftShift);\n\n  const preloadFlightLeftShift =\n    foveatedDeferLeftShift + foveatedDeferDigitsCount;\n  const preloadFlightScale = Math.pow(10, preloadFlightLeftShift);\n\n  // Compute the digits for each priority\n  let depthDigits = priorityNormalizeAndClamp(\n    this._depth,\n    minimumPriority.depth,\n    maximumPriority.depth\n  );\n  depthDigits = preferLeaves ? 1.0 - depthDigits : depthDigits;\n\n  // Map 0-1 then convert to digit. Include a distance sort when doing non-skipLOD and replacement refinement, helps things like non-skipLOD photogrammetry\n  const useDistance =\n    !tileset._skipLevelOfDetail && this.refine === Cesium3DTileRefine.REPLACE;\n  const normalizedPreferredSorting = useDistance\n    ? priorityNormalizeAndClamp(\n        this._priorityHolder._distanceToCamera,\n        minimumPriority.distance,\n        maximumPriority.distance\n      )\n    : priorityNormalizeAndClamp(\n        this._priorityReverseScreenSpaceError,\n        minimumPriority.reverseScreenSpaceError,\n        maximumPriority.reverseScreenSpaceError\n      );\n  const preferredSortingDigits = isolateDigits(\n    normalizedPreferredSorting,\n    preferredSortingDigitsCount,\n    preferredSortingLeftShift\n  );\n\n  const preloadProgressiveResolutionDigits = this._priorityProgressiveResolution\n    ? 0\n    : preloadProgressiveResolutionScale;\n\n  const normalizedFoveatedFactor = priorityNormalizeAndClamp(\n    this._priorityHolder._foveatedFactor,\n    minimumPriority.foveatedFactor,\n    maximumPriority.foveatedFactor\n  );\n  const foveatedDigits = isolateDigits(\n    normalizedFoveatedFactor,\n    foveatedDigitsCount,\n    foveatedLeftShift\n  );\n\n  const foveatedDeferDigits = this.priorityDeferred ? foveatedDeferScale : 0;\n\n  const preloadFlightDigits =\n    tileset._pass === Cesium3DTilePass.PRELOAD_FLIGHT ? 0 : preloadFlightScale;\n\n  // Get the final base 10 number\n  this._priority =\n    depthDigits +\n    preferredSortingDigits +\n    preloadProgressiveResolutionDigits +\n    foveatedDigits +\n    foveatedDeferDigits +\n    preloadFlightDigits;\n};\n\n/**\n * @private\n */\nCesium3DTile.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * @private\n */\nCesium3DTile.prototype.destroy = function () {\n  // For the interval between new content being requested and downloaded, expiredContent === content, so don't destroy twice\n  this._content = this._content && this._content.destroy();\n  this._expiredContent =\n    this._expiredContent &&\n    !this._expiredContent.isDestroyed() &&\n    this._expiredContent.destroy();\n  this._debugBoundingVolume =\n    this._debugBoundingVolume && this._debugBoundingVolume.destroy();\n  this._debugContentBoundingVolume =\n    this._debugContentBoundingVolume &&\n    this._debugContentBoundingVolume.destroy();\n  this._debugViewerRequestVolume =\n    this._debugViewerRequestVolume && this._debugViewerRequestVolume.destroy();\n  return destroyObject(this);\n};\nexport default Cesium3DTile;\n","/**\n * Hint defining optimization support for a 3D tile\n *\n * @enum {Number}\n *\n * @private\n */\nconst Cesium3DTileOptimizationHint = {\n  NOT_COMPUTED: -1,\n  USE_OPTIMIZATION: 1,\n  SKIP_OPTIMIZATION: 0,\n};\nexport default Object.freeze(Cesium3DTileOptimizationHint);\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport Cesium3DTileOptimizationHint from \"./Cesium3DTileOptimizationHint.js\";\nimport TileBoundingRegion from \"./TileBoundingRegion.js\";\nimport TileOrientedBoundingBox from \"./TileOrientedBoundingBox.js\";\n\n/**\n * Utility functions for computing optimization hints for a {@link Cesium3DTileset}.\n *\n * @namespace Cesium3DTileOptimizations\n *\n * @private\n */\nconst Cesium3DTileOptimizations = {};\n\nconst scratchAxis = new Cartesian3();\n\n/**\n * Evaluates support for the childrenWithinParent optimization. This is used to more tightly cull tilesets if\n * children bounds are fully contained within the parent. Currently, support for the optimization only works for\n * oriented bounding boxes, so both the child and parent tile must be either a {@link TileOrientedBoundingBox} or\n * {@link TileBoundingRegion}. The purpose of this check is to prevent use of a culling optimization when the child\n * bounds exceed those of the parent. If the child bounds are greater, it is more likely that the optimization will\n * waste CPU cycles. Bounding spheres are not supported for the reason that the child bounds can very often be\n * partially outside of the parent bounds.\n *\n * @param {Cesium3DTile} tile The tile to check.\n * @returns {Boolean} Whether the childrenWithinParent optimization is supported.\n */\nCesium3DTileOptimizations.checkChildrenWithinParent = function (tile) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"tile\", tile);\n  //>>includeEnd('debug');\n\n  const children = tile.children;\n  const length = children.length;\n\n  // Check if the parent has an oriented bounding box.\n  const boundingVolume = tile.boundingVolume;\n  if (\n    boundingVolume instanceof TileOrientedBoundingBox ||\n    boundingVolume instanceof TileBoundingRegion\n  ) {\n    const orientedBoundingBox = boundingVolume._orientedBoundingBox;\n    tile._optimChildrenWithinParent =\n      Cesium3DTileOptimizationHint.USE_OPTIMIZATION;\n    for (let i = 0; i < length; ++i) {\n      const child = children[i];\n\n      // Check if the child has an oriented bounding box.\n      const childBoundingVolume = child.boundingVolume;\n      if (\n        !(\n          childBoundingVolume instanceof TileOrientedBoundingBox ||\n          childBoundingVolume instanceof TileBoundingRegion\n        )\n      ) {\n        // Do not support if the parent and child both do not have oriented bounding boxes.\n        tile._optimChildrenWithinParent =\n          Cesium3DTileOptimizationHint.SKIP_OPTIMIZATION;\n        break;\n      }\n\n      const childOrientedBoundingBox = childBoundingVolume._orientedBoundingBox;\n\n      // Compute the axis from the parent to the child.\n      const axis = Cartesian3.subtract(\n        childOrientedBoundingBox.center,\n        orientedBoundingBox.center,\n        scratchAxis\n      );\n      const axisLength = Cartesian3.magnitude(axis);\n      Cartesian3.divideByScalar(axis, axisLength, axis);\n\n      // Project the bounding box of the parent onto the axis. Because the axis is a ray from the parent\n      // to the child, the projection parameterized along the ray will be (+/- proj1).\n      const proj1 =\n        Math.abs(orientedBoundingBox.halfAxes[0] * axis.x) +\n        Math.abs(orientedBoundingBox.halfAxes[1] * axis.y) +\n        Math.abs(orientedBoundingBox.halfAxes[2] * axis.z) +\n        Math.abs(orientedBoundingBox.halfAxes[3] * axis.x) +\n        Math.abs(orientedBoundingBox.halfAxes[4] * axis.y) +\n        Math.abs(orientedBoundingBox.halfAxes[5] * axis.z) +\n        Math.abs(orientedBoundingBox.halfAxes[6] * axis.x) +\n        Math.abs(orientedBoundingBox.halfAxes[7] * axis.y) +\n        Math.abs(orientedBoundingBox.halfAxes[8] * axis.z);\n\n      // Project the bounding box of the child onto the axis. Because the axis is a ray from the parent\n      // to the child, the projection parameterized along the ray will be (+/- proj2) + axis.length.\n      const proj2 =\n        Math.abs(childOrientedBoundingBox.halfAxes[0] * axis.x) +\n        Math.abs(childOrientedBoundingBox.halfAxes[1] * axis.y) +\n        Math.abs(childOrientedBoundingBox.halfAxes[2] * axis.z) +\n        Math.abs(childOrientedBoundingBox.halfAxes[3] * axis.x) +\n        Math.abs(childOrientedBoundingBox.halfAxes[4] * axis.y) +\n        Math.abs(childOrientedBoundingBox.halfAxes[5] * axis.z) +\n        Math.abs(childOrientedBoundingBox.halfAxes[6] * axis.x) +\n        Math.abs(childOrientedBoundingBox.halfAxes[7] * axis.y) +\n        Math.abs(childOrientedBoundingBox.halfAxes[8] * axis.z);\n\n      // If the child extends the parent's bounds, the optimization is not valid and we skip it.\n      if (proj1 <= proj2 + axisLength) {\n        tile._optimChildrenWithinParent =\n          Cesium3DTileOptimizationHint.SKIP_OPTIMIZATION;\n        break;\n      }\n    }\n  }\n\n  return (\n    tile._optimChildrenWithinParent ===\n    Cesium3DTileOptimizationHint.USE_OPTIMIZATION\n  );\n};\nexport default Cesium3DTileOptimizations;\n","import Cesium3DTilesetMostDetailedTraversal from \"./Cesium3DTilesetMostDetailedTraversal.js\";\nimport Cesium3DTilesetTraversal from \"./Cesium3DTilesetTraversal.js\";\n\n/**\n * The pass in which a 3D Tileset is updated.\n *\n * @private\n */\nconst Cesium3DTilePass = {\n  RENDER: 0,\n  PICK: 1,\n  SHADOW: 2,\n  PRELOAD: 3,\n  PRELOAD_FLIGHT: 4,\n  REQUEST_RENDER_MODE_DEFER_CHECK: 5,\n  MOST_DETAILED_PRELOAD: 6,\n  MOST_DETAILED_PICK: 7,\n  NUMBER_OF_PASSES: 8,\n};\n\nconst passOptions = new Array(Cesium3DTilePass.NUMBER_OF_PASSES);\n\npassOptions[Cesium3DTilePass.RENDER] = Object.freeze({\n  traversal: Cesium3DTilesetTraversal,\n  isRender: true,\n  requestTiles: true,\n  ignoreCommands: false,\n});\n\npassOptions[Cesium3DTilePass.PICK] = Object.freeze({\n  traversal: Cesium3DTilesetTraversal,\n  isRender: false,\n  requestTiles: false,\n  ignoreCommands: false,\n});\n\npassOptions[Cesium3DTilePass.SHADOW] = Object.freeze({\n  traversal: Cesium3DTilesetTraversal,\n  isRender: false,\n  requestTiles: true,\n  ignoreCommands: false,\n});\n\npassOptions[Cesium3DTilePass.PRELOAD] = Object.freeze({\n  traversal: Cesium3DTilesetTraversal,\n  isRender: false,\n  requestTiles: true,\n  ignoreCommands: true,\n});\n\npassOptions[Cesium3DTilePass.PRELOAD_FLIGHT] = Object.freeze({\n  traversal: Cesium3DTilesetTraversal,\n  isRender: false,\n  requestTiles: true,\n  ignoreCommands: true,\n});\n\npassOptions[Cesium3DTilePass.REQUEST_RENDER_MODE_DEFER_CHECK] = Object.freeze({\n  traversal: Cesium3DTilesetTraversal,\n  isRender: false,\n  requestTiles: true,\n  ignoreCommands: true,\n});\n\npassOptions[Cesium3DTilePass.MOST_DETAILED_PRELOAD] = Object.freeze({\n  traversal: Cesium3DTilesetMostDetailedTraversal,\n  isRender: false,\n  requestTiles: true,\n  ignoreCommands: true,\n});\n\npassOptions[Cesium3DTilePass.MOST_DETAILED_PICK] = Object.freeze({\n  traversal: Cesium3DTilesetMostDetailedTraversal,\n  isRender: false,\n  requestTiles: false,\n  ignoreCommands: false,\n});\n\nCesium3DTilePass.getPassOptions = function (pass) {\n  return passOptions[pass];\n};\nexport default Object.freeze(Cesium3DTilePass);\n","import Check from \"../Core/Check.js\";\n\n/**\n * The state for a 3D Tiles update pass.\n *\n * @private\n * @constructor\n */\nfunction Cesium3DTilePassState(options) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"options\", options);\n  Check.typeOf.number(\"options.pass\", options.pass);\n  //>>includeEnd('debug');\n\n  /**\n   * The pass.\n   *\n   * @type {Cesium3DTilePass}\n   */\n  this.pass = options.pass;\n\n  /**\n   * An array of rendering commands to use instead of {@link FrameState.commandList} for the current pass.\n   *\n   * @type {DrawCommand[]}\n   */\n  this.commandList = options.commandList;\n\n  /**\n   * A camera to use instead of {@link FrameState.camera} for the current pass.\n   *\n   * @type {Camera}\n   */\n  this.camera = options.camera;\n\n  /**\n   * A culling volume to use instead of {@link FrameState.cullingVolume} for the current pass.\n   *\n   * @type {CullingVolume}\n   */\n  this.cullingVolume = options.cullingVolume;\n\n  /**\n   * A read-only property that indicates whether the pass is ready, i.e. all tiles needed by the pass are loaded.\n   *\n   * @type {Boolean}\n   * @readonly\n   * @default false\n   */\n  this.ready = false;\n}\nexport default Cesium3DTilePassState;\n","import Cartographic from \"../Core/Cartographic.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport Cesium3DTileFeature from \"./Cesium3DTileFeature.js\";\nimport createBillboardPointCallback from \"./createBillboardPointCallback.js\";\n\n/**\n * A point feature of a {@link Cesium3DTileset}.\n * <p>\n * Provides access to a feature's properties stored in the tile's batch table, as well\n * as the ability to show/hide a feature and change its point properties\n * </p>\n * <p>\n * Modifications to a <code>Cesium3DTilePointFeature</code> object have the lifetime of the tile's\n * content.  If the tile's content is unloaded, e.g., due to it going out of view and needing\n * to free space in the cache for visible tiles, listen to the {@link Cesium3DTileset#tileUnload} event to save any\n * modifications. Also listen to the {@link Cesium3DTileset#tileVisible} event to reapply any modifications.\n * </p>\n * <p>\n * Do not construct this directly.  Access it through {@link Cesium3DTileContent#getFeature}\n * or picking using {@link Scene#pick} and {@link Scene#pickPosition}.\n * </p>\n *\n * @alias Cesium3DTilePointFeature\n * @constructor\n *\n * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n *\n * @example\n * // On mouse over, display all the properties for a feature in the console log.\n * handler.setInputAction(function(movement) {\n *     const feature = scene.pick(movement.endPosition);\n *     if (feature instanceof Cesium.Cesium3DTilePointFeature) {\n *         const propertyNames = feature.getPropertyNames();\n *         const length = propertyNames.length;\n *         for (let i = 0; i < length; ++i) {\n *             const propertyName = propertyNames[i];\n *             console.log(propertyName + ': ' + feature.getProperty(propertyName));\n *         }\n *     }\n * }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\n */\nfunction Cesium3DTilePointFeature(\n  content,\n  batchId,\n  billboard,\n  label,\n  polyline\n) {\n  this._content = content;\n  this._billboard = billboard;\n  this._label = label;\n  this._polyline = polyline;\n\n  this._batchId = batchId;\n  this._billboardImage = undefined;\n  this._billboardColor = undefined;\n  this._billboardOutlineColor = undefined;\n  this._billboardOutlineWidth = undefined;\n  this._billboardSize = undefined;\n  this._pointSize = undefined;\n  this._color = undefined;\n  this._pointSize = undefined;\n  this._pointOutlineColor = undefined;\n  this._pointOutlineWidth = undefined;\n  this._heightOffset = undefined;\n\n  this._pickIds = new Array(3);\n\n  setBillboardImage(this);\n}\n\nconst scratchCartographic = new Cartographic();\n\nObject.defineProperties(Cesium3DTilePointFeature.prototype, {\n  /**\n   * Gets or sets if the feature will be shown. This is set for all features\n   * when a style's show is evaluated.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  show: {\n    get: function () {\n      return this._label.show;\n    },\n    set: function (value) {\n      this._label.show = value;\n      this._billboard.show = value;\n      this._polyline.show = value;\n    },\n  },\n\n  /**\n   * Gets or sets the color of the point of this feature.\n   * <p>\n   * Only applied when <code>image</code> is <code>undefined</code>.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Color}\n   */\n  color: {\n    get: function () {\n      return this._color;\n    },\n    set: function (value) {\n      this._color = Color.clone(value, this._color);\n      setBillboardImage(this);\n    },\n  },\n\n  /**\n   * Gets or sets the point size of this feature.\n   * <p>\n   * Only applied when <code>image</code> is <code>undefined</code>.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Number}\n   */\n  pointSize: {\n    get: function () {\n      return this._pointSize;\n    },\n    set: function (value) {\n      this._pointSize = value;\n      setBillboardImage(this);\n    },\n  },\n\n  /**\n   * Gets or sets the point outline color of this feature.\n   * <p>\n   * Only applied when <code>image</code> is <code>undefined</code>.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Color}\n   */\n  pointOutlineColor: {\n    get: function () {\n      return this._pointOutlineColor;\n    },\n    set: function (value) {\n      this._pointOutlineColor = Color.clone(value, this._pointOutlineColor);\n      setBillboardImage(this);\n    },\n  },\n\n  /**\n   * Gets or sets the point outline width in pixels of this feature.\n   * <p>\n   * Only applied when <code>image</code> is <code>undefined</code>.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Number}\n   */\n  pointOutlineWidth: {\n    get: function () {\n      return this._pointOutlineWidth;\n    },\n    set: function (value) {\n      this._pointOutlineWidth = value;\n      setBillboardImage(this);\n    },\n  },\n\n  /**\n   * Gets or sets the label color of this feature.\n   * <p>\n   * The color will be applied to the label if <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Color}\n   */\n  labelColor: {\n    get: function () {\n      return this._label.fillColor;\n    },\n    set: function (value) {\n      this._label.fillColor = value;\n      this._polyline.show = this._label.show && value.alpha > 0.0;\n    },\n  },\n\n  /**\n   * Gets or sets the label outline color of this feature.\n   * <p>\n   * The outline color will be applied to the label if <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Color}\n   */\n  labelOutlineColor: {\n    get: function () {\n      return this._label.outlineColor;\n    },\n    set: function (value) {\n      this._label.outlineColor = value;\n    },\n  },\n\n  /**\n   * Gets or sets the outline width in pixels of this feature.\n   * <p>\n   * The outline width will be applied to the point if <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Number}\n   */\n  labelOutlineWidth: {\n    get: function () {\n      return this._label.outlineWidth;\n    },\n    set: function (value) {\n      this._label.outlineWidth = value;\n    },\n  },\n\n  /**\n   * Gets or sets the font of this feature.\n   * <p>\n   * Only applied when the <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {String}\n   */\n  font: {\n    get: function () {\n      return this._label.font;\n    },\n    set: function (value) {\n      this._label.font = value;\n    },\n  },\n\n  /**\n   * Gets or sets the fill and outline style of this feature.\n   * <p>\n   * Only applied when <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {LabelStyle}\n   */\n  labelStyle: {\n    get: function () {\n      return this._label.style;\n    },\n    set: function (value) {\n      this._label.style = value;\n    },\n  },\n\n  /**\n   * Gets or sets the text for this feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {String}\n   */\n  labelText: {\n    get: function () {\n      return this._label.text;\n    },\n    set: function (value) {\n      if (!defined(value)) {\n        value = \"\";\n      }\n      this._label.text = value;\n    },\n  },\n\n  /**\n   * Gets or sets the background color of the text for this feature.\n   * <p>\n   * Only applied when <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Color}\n   */\n  backgroundColor: {\n    get: function () {\n      return this._label.backgroundColor;\n    },\n    set: function (value) {\n      this._label.backgroundColor = value;\n    },\n  },\n\n  /**\n   * Gets or sets the background padding of the text for this feature.\n   * <p>\n   * Only applied when <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Cartesian2}\n   */\n  backgroundPadding: {\n    get: function () {\n      return this._label.backgroundPadding;\n    },\n    set: function (value) {\n      this._label.backgroundPadding = value;\n    },\n  },\n\n  /**\n   * Gets or sets whether to display the background of the text for this feature.\n   * <p>\n   * Only applied when <code>labelText</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Boolean}\n   */\n  backgroundEnabled: {\n    get: function () {\n      return this._label.showBackground;\n    },\n    set: function (value) {\n      this._label.showBackground = value;\n    },\n  },\n\n  /**\n   * Gets or sets the near and far scaling properties for this feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {NearFarScalar}\n   */\n  scaleByDistance: {\n    get: function () {\n      return this._label.scaleByDistance;\n    },\n    set: function (value) {\n      this._label.scaleByDistance = value;\n      this._billboard.scaleByDistance = value;\n    },\n  },\n\n  /**\n   * Gets or sets the near and far translucency properties for this feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {NearFarScalar}\n   */\n  translucencyByDistance: {\n    get: function () {\n      return this._label.translucencyByDistance;\n    },\n    set: function (value) {\n      this._label.translucencyByDistance = value;\n      this._billboard.translucencyByDistance = value;\n    },\n  },\n\n  /**\n   * Gets or sets the condition specifying at what distance from the camera that this feature will be displayed.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {DistanceDisplayCondition}\n   */\n  distanceDisplayCondition: {\n    get: function () {\n      return this._label.distanceDisplayCondition;\n    },\n    set: function (value) {\n      this._label.distanceDisplayCondition = value;\n      this._polyline.distanceDisplayCondition = value;\n      this._billboard.distanceDisplayCondition = value;\n    },\n  },\n\n  /**\n   * Gets or sets the height offset in meters of this feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Number}\n   */\n  heightOffset: {\n    get: function () {\n      return this._heightOffset;\n    },\n    set: function (value) {\n      const offset = defaultValue(this._heightOffset, 0.0);\n\n      const ellipsoid = this._content.tileset.ellipsoid;\n      const cart = ellipsoid.cartesianToCartographic(\n        this._billboard.position,\n        scratchCartographic\n      );\n      cart.height = cart.height - offset + value;\n      const newPosition = ellipsoid.cartographicToCartesian(cart);\n\n      this._billboard.position = newPosition;\n      this._label.position = this._billboard.position;\n      this._polyline.positions = [this._polyline.positions[0], newPosition];\n\n      this._heightOffset = value;\n    },\n  },\n\n  /**\n   * Gets or sets whether the anchor line is displayed.\n   * <p>\n   * Only applied when <code>heightOffset</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Boolean}\n   */\n  anchorLineEnabled: {\n    get: function () {\n      return this._polyline.show;\n    },\n    set: function (value) {\n      this._polyline.show = value;\n    },\n  },\n\n  /**\n   * Gets or sets the color for the anchor line.\n   * <p>\n   * Only applied when <code>heightOffset</code> is defined.\n   * </p>\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Color}\n   */\n  anchorLineColor: {\n    get: function () {\n      return this._polyline.material.uniforms.color;\n    },\n    set: function (value) {\n      this._polyline.material.uniforms.color = Color.clone(\n        value,\n        this._polyline.material.uniforms.color\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the image of this feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {String}\n   */\n  image: {\n    get: function () {\n      return this._billboardImage;\n    },\n    set: function (value) {\n      const imageChanged = this._billboardImage !== value;\n      this._billboardImage = value;\n      if (imageChanged) {\n        setBillboardImage(this);\n      }\n    },\n  },\n\n  /**\n   * Gets or sets the distance where depth testing will be disabled.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Number}\n   */\n  disableDepthTestDistance: {\n    get: function () {\n      return this._label.disableDepthTestDistance;\n    },\n    set: function (value) {\n      this._label.disableDepthTestDistance = value;\n      this._billboard.disableDepthTestDistance = value;\n    },\n  },\n\n  /**\n   * Gets or sets the horizontal origin of this point, which determines if the point is\n   * to the left, center, or right of its anchor position.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {HorizontalOrigin}\n   */\n  horizontalOrigin: {\n    get: function () {\n      return this._billboard.horizontalOrigin;\n    },\n    set: function (value) {\n      this._billboard.horizontalOrigin = value;\n    },\n  },\n\n  /**\n   * Gets or sets the vertical origin of this point, which determines if the point is\n   * to the bottom, center, or top of its anchor position.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {VerticalOrigin}\n   */\n  verticalOrigin: {\n    get: function () {\n      return this._billboard.verticalOrigin;\n    },\n    set: function (value) {\n      this._billboard.verticalOrigin = value;\n    },\n  },\n\n  /**\n   * Gets or sets the horizontal origin of this point's text, which determines if the point's text is\n   * to the left, center, or right of its anchor position.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {HorizontalOrigin}\n   */\n  labelHorizontalOrigin: {\n    get: function () {\n      return this._label.horizontalOrigin;\n    },\n    set: function (value) {\n      this._label.horizontalOrigin = value;\n    },\n  },\n\n  /**\n   * Get or sets the vertical origin of this point's text, which determines if the point's text is\n   * to the bottom, center, top, or baseline of it's anchor point.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {VerticalOrigin}\n   */\n  labelVerticalOrigin: {\n    get: function () {\n      return this._label.verticalOrigin;\n    },\n    set: function (value) {\n      this._label.verticalOrigin = value;\n    },\n  },\n\n  /**\n   * Gets the content of the tile containing the feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Cesium3DTileContent}\n   *\n   * @readonly\n   * @private\n   */\n  content: {\n    get: function () {\n      return this._content;\n    },\n  },\n\n  /**\n   * Gets the tileset containing the feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Cesium3DTileset}\n   *\n   * @readonly\n   */\n  tileset: {\n    get: function () {\n      return this._content.tileset;\n    },\n  },\n\n  /**\n   * All objects returned by {@link Scene#pick} have a <code>primitive</code> property. This returns\n   * the tileset containing the feature.\n   *\n   * @memberof Cesium3DTilePointFeature.prototype\n   *\n   * @type {Cesium3DTileset}\n   *\n   * @readonly\n   */\n  primitive: {\n    get: function () {\n      return this._content.tileset;\n    },\n  },\n\n  /**\n   * @private\n   */\n  pickIds: {\n    get: function () {\n      const ids = this._pickIds;\n      ids[0] = this._billboard.pickId;\n      ids[1] = this._label.pickId;\n      ids[2] = this._polyline.pickId;\n      return ids;\n    },\n  },\n});\n\nCesium3DTilePointFeature.defaultColor = Color.WHITE;\nCesium3DTilePointFeature.defaultPointOutlineColor = Color.BLACK;\nCesium3DTilePointFeature.defaultPointOutlineWidth = 0.0;\nCesium3DTilePointFeature.defaultPointSize = 8.0;\n\nfunction setBillboardImage(feature) {\n  const b = feature._billboard;\n  if (defined(feature._billboardImage) && feature._billboardImage !== b.image) {\n    b.image = feature._billboardImage;\n    return;\n  }\n\n  if (defined(feature._billboardImage)) {\n    return;\n  }\n\n  const newColor = defaultValue(\n    feature._color,\n    Cesium3DTilePointFeature.defaultColor\n  );\n  const newOutlineColor = defaultValue(\n    feature._pointOutlineColor,\n    Cesium3DTilePointFeature.defaultPointOutlineColor\n  );\n  const newOutlineWidth = defaultValue(\n    feature._pointOutlineWidth,\n    Cesium3DTilePointFeature.defaultPointOutlineWidth\n  );\n  const newPointSize = defaultValue(\n    feature._pointSize,\n    Cesium3DTilePointFeature.defaultPointSize\n  );\n\n  const currentColor = feature._billboardColor;\n  const currentOutlineColor = feature._billboardOutlineColor;\n  const currentOutlineWidth = feature._billboardOutlineWidth;\n  const currentPointSize = feature._billboardSize;\n\n  if (\n    Color.equals(newColor, currentColor) &&\n    Color.equals(newOutlineColor, currentOutlineColor) &&\n    newOutlineWidth === currentOutlineWidth &&\n    newPointSize === currentPointSize\n  ) {\n    return;\n  }\n\n  feature._billboardColor = Color.clone(newColor, feature._billboardColor);\n  feature._billboardOutlineColor = Color.clone(\n    newOutlineColor,\n    feature._billboardOutlineColor\n  );\n  feature._billboardOutlineWidth = newOutlineWidth;\n  feature._billboardSize = newPointSize;\n\n  const centerAlpha = newColor.alpha;\n  const cssColor = newColor.toCssColorString();\n  const cssOutlineColor = newOutlineColor.toCssColorString();\n  const textureId = JSON.stringify([\n    cssColor,\n    newPointSize,\n    cssOutlineColor,\n    newOutlineWidth,\n  ]);\n\n  b.setImage(\n    textureId,\n    createBillboardPointCallback(\n      centerAlpha,\n      cssColor,\n      cssOutlineColor,\n      newOutlineWidth,\n      newPointSize\n    )\n  );\n}\n\n/**\n * Returns whether the feature contains this property. This includes properties from this feature's\n * class and inherited classes when using a batch table hierarchy.\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/extensions/3DTILES_batch_table_hierarchy}\n *\n * @param {String} name The case-sensitive name of the property.\n * @returns {Boolean} Whether the feature contains this property.\n */\nCesium3DTilePointFeature.prototype.hasProperty = function (name) {\n  return this._content.batchTable.hasProperty(this._batchId, name);\n};\n\n/**\n * Returns an array of property names for the feature. This includes properties from this feature's\n * class and inherited classes when using a batch table hierarchy.\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/extensions/3DTILES_batch_table_hierarchy}\n *\n * @param {String[]} [results] An array into which to store the results.\n * @returns {String[]} The names of the feature's properties.\n */\nCesium3DTilePointFeature.prototype.getPropertyNames = function (results) {\n  return this._content.batchTable.getPropertyNames(this._batchId, results);\n};\n\n/**\n * Returns a copy of the value of the feature's property with the given name. This includes properties from this feature's\n * class and inherited classes when using a batch table hierarchy.\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/extensions/3DTILES_batch_table_hierarchy}\n *\n * @param {String} name The case-sensitive name of the property.\n * @returns {*} The value of the property or <code>undefined</code> if the feature does not have this property.\n *\n * @example\n * // Display all the properties for a feature in the console log.\n * const propertyNames = feature.getPropertyNames();\n * const length = propertyNames.length;\n * for (let i = 0; i < length; ++i) {\n *     const propertyName = propertyNames[i];\n *     console.log(propertyName + ': ' + feature.getProperty(propertyName));\n * }\n */\nCesium3DTilePointFeature.prototype.getProperty = function (name) {\n  return this._content.batchTable.getProperty(this._batchId, name);\n};\n\n/**\n * Returns a copy of the value of the feature's property with the given name.\n * If the feature is contained within a tileset that has metadata (3D Tiles 1.1)\n * or uses the <code>3DTILES_metadata</code> extension, tileset, group and tile metadata is\n * inherited.\n * <p>\n * To resolve name conflicts, this method resolves names from most specific to\n * least specific by metadata granularity in the order: feature, tile, group,\n * tileset. Within each granularity, semantics are resolved first, then other\n * properties.\n * </p>\n * @param {String} name The case-sensitive name of the property.\n * @returns {*} The value of the property or <code>undefined</code> if the feature does not have this property.\n * @private\n * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n */\nCesium3DTilePointFeature.prototype.getPropertyInherited = function (name) {\n  return Cesium3DTileFeature.getPropertyInherited(\n    this._content,\n    this._batchId,\n    name\n  );\n};\n\n/**\n * Sets the value of the feature's property with the given name.\n * <p>\n * If a property with the given name doesn't exist, it is created.\n * </p>\n *\n * @param {String} name The case-sensitive name of the property.\n * @param {*} value The value of the property that will be copied.\n *\n * @exception {DeveloperError} Inherited batch table hierarchy property is read only.\n *\n * @example\n * const height = feature.getProperty('Height'); // e.g., the height of a building\n *\n * @example\n * const name = 'clicked';\n * if (feature.getProperty(name)) {\n *     console.log('already clicked');\n * } else {\n *     feature.setProperty(name, true);\n *     console.log('first click');\n * }\n */\nCesium3DTilePointFeature.prototype.setProperty = function (name, value) {\n  this._content.batchTable.setProperty(this._batchId, name, value);\n\n  // PERFORMANCE_IDEA: Probably overkill, but maybe only mark the tile dirty if the\n  // property is in one of the style's expressions or - if it can be done quickly -\n  // if the new property value changed the result of an expression.\n  this._content.featurePropertiesDirty = true;\n};\n\n/**\n * Returns whether the feature's class name equals <code>className</code>. Unlike {@link Cesium3DTilePointFeature#isClass}\n * this function only checks the feature's exact class and not inherited classes.\n * <p>\n * This function returns <code>false</code> if no batch table hierarchy is present.\n * </p>\n *\n * @param {String} className The name to check against.\n * @returns {Boolean} Whether the feature's class name equals <code>className</code>\n *\n * @private\n */\nCesium3DTilePointFeature.prototype.isExactClass = function (className) {\n  return this._content.batchTable.isExactClass(this._batchId, className);\n};\n\n/**\n * Returns whether the feature's class or any inherited classes are named <code>className</code>.\n * <p>\n * This function returns <code>false</code> if no batch table hierarchy is present.\n * </p>\n *\n * @param {String} className The name to check against.\n * @returns {Boolean} Whether the feature's class or inherited classes are named <code>className</code>\n *\n * @private\n */\nCesium3DTilePointFeature.prototype.isClass = function (className) {\n  return this._content.batchTable.isClass(this._batchId, className);\n};\n\n/**\n * Returns the feature's class name.\n * <p>\n * This function returns <code>undefined</code> if no batch table hierarchy is present.\n * </p>\n *\n * @returns {String} The feature's class name.\n *\n * @private\n */\nCesium3DTilePointFeature.prototype.getExactClassName = function () {\n  return this._content.batchTable.getExactClassName(this._batchId);\n};\nexport default Cesium3DTilePointFeature;\n","/**\n * The refinement approach for a tile.\n * <p>\n * See the {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification#refinement|Refinement}\n * in the 3D Tiles spec.\n * </p>\n *\n * @enum {Number}\n *\n * @private\n */\nconst Cesium3DTileRefine = {\n  /**\n   * Render this tile and, if it doesn't meet the screen space error, also refine to its children.\n   *\n   * @type {Number}\n   * @constant\n   */\n  ADD: 0,\n\n  /**\n   * Render this tile or, if it doesn't meet the screen space error, refine to its descendants instead.\n   *\n   * @type {Number}\n   * @constant\n   */\n  REPLACE: 1,\n};\nexport default Object.freeze(Cesium3DTileRefine);\n","import clone from \"../Core/clone.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport deprecationWarning from \"../Core/deprecationWarning.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Resource from \"../Core/Resource.js\";\nimport ConditionsExpression from \"./ConditionsExpression.js\";\nimport Expression from \"./Expression.js\";\n\n/**\n * A style that is applied to a {@link Cesium3DTileset}.\n * <p>\n * Evaluates an expression defined using the\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}.\n * </p>\n *\n * @alias Cesium3DTileStyle\n * @constructor\n *\n * @param {Object} [style] An object defining a style.\n *\n * @example\n * tileset.style = new Cesium.Cesium3DTileStyle({\n *     color : {\n *         conditions : [\n *             ['${Height} >= 100', 'color(\"purple\", 0.5)'],\n *             ['${Height} >= 50', 'color(\"red\")'],\n *             ['true', 'color(\"blue\")']\n *         ]\n *     },\n *     show : '${Height} > 0',\n *     meta : {\n *         description : '\"Building id ${id} has height ${Height}.\"'\n *     }\n * });\n *\n * @example\n * tileset.style = new Cesium.Cesium3DTileStyle({\n *     color : 'vec4(${Temperature})',\n *     pointSize : '${Temperature} * 2.0'\n * });\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}\n */\nfunction Cesium3DTileStyle(style) {\n  this._style = {};\n  this._ready = false;\n\n  this._show = undefined;\n  this._color = undefined;\n  this._pointSize = undefined;\n  this._pointOutlineColor = undefined;\n  this._pointOutlineWidth = undefined;\n  this._labelColor = undefined;\n  this._labelOutlineColor = undefined;\n  this._labelOutlineWidth = undefined;\n  this._font = undefined;\n  this._labelStyle = undefined;\n  this._labelText = undefined;\n  this._backgroundColor = undefined;\n  this._backgroundPadding = undefined;\n  this._backgroundEnabled = undefined;\n  this._scaleByDistance = undefined;\n  this._translucencyByDistance = undefined;\n  this._distanceDisplayCondition = undefined;\n  this._heightOffset = undefined;\n  this._anchorLineEnabled = undefined;\n  this._anchorLineColor = undefined;\n  this._image = undefined;\n  this._disableDepthTestDistance = undefined;\n  this._horizontalOrigin = undefined;\n  this._verticalOrigin = undefined;\n  this._labelHorizontalOrigin = undefined;\n  this._labelVerticalOrigin = undefined;\n  this._meta = undefined;\n\n  this._colorShaderFunction = undefined;\n  this._showShaderFunction = undefined;\n  this._pointSizeShaderFunction = undefined;\n  this._colorShaderFunctionReady = false;\n  this._showShaderFunctionReady = false;\n  this._pointSizeShaderFunctionReady = false;\n\n  this._colorShaderTranslucent = false;\n\n  if (typeof style === \"string\" || style instanceof Resource) {\n    //>>includeStart('debug', pragmas.debug);\n    deprecationWarning(\n      \"Cesium3DTileStyle constructor\",\n      \"string or Resource style parameter in the Cesium3DTileStyle constructor was deprecated in CesiumJS 1.94.  If loading a style from a url, use Cesium3DTileStyle.fromUrl instead.\"\n    );\n    //>>includeEnd('debug');\n\n    const resource = Resource.createIfNeeded(style);\n    const that = this;\n    this._readyPromise = resource.fetchJson(style).then(function (styleJson) {\n      setup(that, styleJson);\n      return that;\n    });\n  } else {\n    setup(this, style);\n    this._readyPromise = Promise.resolve(this);\n  }\n}\n\nfunction setup(that, styleJson) {\n  styleJson = defaultValue(clone(styleJson, true), that._style);\n  that._style = styleJson;\n\n  that.show = styleJson.show;\n  that.color = styleJson.color;\n  that.pointSize = styleJson.pointSize;\n  that.pointOutlineColor = styleJson.pointOutlineColor;\n  that.pointOutlineWidth = styleJson.pointOutlineWidth;\n  that.labelColor = styleJson.labelColor;\n  that.labelOutlineColor = styleJson.labelOutlineColor;\n  that.labelOutlineWidth = styleJson.labelOutlineWidth;\n  that.labelStyle = styleJson.labelStyle;\n  that.font = styleJson.font;\n  that.labelText = styleJson.labelText;\n  that.backgroundColor = styleJson.backgroundColor;\n  that.backgroundPadding = styleJson.backgroundPadding;\n  that.backgroundEnabled = styleJson.backgroundEnabled;\n  that.scaleByDistance = styleJson.scaleByDistance;\n  that.translucencyByDistance = styleJson.translucencyByDistance;\n  that.distanceDisplayCondition = styleJson.distanceDisplayCondition;\n  that.heightOffset = styleJson.heightOffset;\n  that.anchorLineEnabled = styleJson.anchorLineEnabled;\n  that.anchorLineColor = styleJson.anchorLineColor;\n  that.image = styleJson.image;\n  that.disableDepthTestDistance = styleJson.disableDepthTestDistance;\n  that.horizontalOrigin = styleJson.horizontalOrigin;\n  that.verticalOrigin = styleJson.verticalOrigin;\n  that.labelHorizontalOrigin = styleJson.labelHorizontalOrigin;\n  that.labelVerticalOrigin = styleJson.labelVerticalOrigin;\n\n  const meta = {};\n  if (defined(styleJson.meta)) {\n    const defines = styleJson.defines;\n    const metaJson = defaultValue(styleJson.meta, defaultValue.EMPTY_OBJECT);\n    for (const property in metaJson) {\n      if (metaJson.hasOwnProperty(property)) {\n        meta[property] = new Expression(metaJson[property], defines);\n      }\n    }\n  }\n\n  that._meta = meta;\n\n  that._ready = true;\n}\n\nfunction getExpression(tileStyle, value) {\n  const defines = defaultValue(tileStyle._style, defaultValue.EMPTY_OBJECT)\n    .defines;\n\n  if (!defined(value)) {\n    return undefined;\n  } else if (typeof value === \"boolean\" || typeof value === \"number\") {\n    return new Expression(String(value));\n  } else if (typeof value === \"string\") {\n    return new Expression(value, defines);\n  } else if (defined(value.conditions)) {\n    return new ConditionsExpression(value, defines);\n  }\n  return value;\n}\n\nfunction getJsonFromExpression(expression) {\n  if (!defined(expression)) {\n    return undefined;\n  } else if (defined(expression.expression)) {\n    return expression.expression;\n  } else if (defined(expression.conditionsExpression)) {\n    return clone(expression.conditionsExpression, true);\n  }\n  return expression;\n}\n\nObject.defineProperties(Cesium3DTileStyle.prototype, {\n  /**\n   * Gets the object defining the style using the\n   * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}.\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @default {}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\n   */\n  style: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._style;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the style is ready and its expressions can be evaluated.  When\n   * a style is constructed with an object, as opposed to a url, this is <code>true</code> immediately.\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   * @deprecated\n   *\n   * @default false\n   */\n  ready: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      deprecationWarning(\n        \"ready\",\n        \"ready was deprecated in CesiumJS 1.94.  It will be removed in 1.96.  If loading a style from a url, use Cesium3DTileStyle.fromUrl instead.\"\n      );\n      //>>includeEnd('debug');\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets the promise that will be resolved when the the style is ready and its expressions can be evaluated.\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {Promise.<Cesium3DTileStyle>}\n   * @readonly\n   * @deprecated\n   */\n  readyPromise: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      deprecationWarning(\n        \"readyPromise\",\n        \"readyPromise was deprecated in CesiumJS 1.94.  It will be removed in 1.96.  If loading a style from a url, use Cesium3DTileStyle.fromUrl instead.\"\n      );\n      //>>includeEnd('debug');\n      return this._readyPromise;\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>show</code> property. Alternatively a boolean, string, or object defining a show style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return or convert to a <code>Boolean</code>.\n   * </p>\n   * <p>\n   * This expression is applicable to all tile formats.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     show : '(regExp(\"^Chest\").test(${County})) && (${YearBuilt} >= 1970)'\n   * });\n   * style.show.evaluate(feature); // returns true or false depending on the feature's properties\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override show expression with a custom function\n   * style.show = {\n   *     evaluate : function(feature) {\n   *         return true;\n   *     }\n   * };\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override show expression with a boolean\n   * style.show = true;\n   * };\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override show expression with a string\n   * style.show = '${Height} > 0';\n   * };\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override show expression with a condition\n   * style.show = {\n   *     conditions: [\n   *         ['${height} > 2', 'false'],\n   *         ['true', 'true']\n   *     ];\n   * };\n   */\n  show: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._show;\n    },\n    set: function (value) {\n      this._show = getExpression(this, value);\n      this._style.show = getJsonFromExpression(this._show);\n      this._showShaderFunctionReady = false;\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>color</code> property. Alternatively a string or object defining a color style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Color</code>.\n   * </p>\n   * <p>\n   * This expression is applicable to all tile formats.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     color : '(${Temperature} > 90) ? color(\"red\") : color(\"white\")'\n   * });\n   * style.color.evaluateColor(feature, result); // returns a Cesium.Color object\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override color expression with a custom function\n   * style.color = {\n   *     evaluateColor : function(feature, result) {\n   *         return Cesium.Color.clone(Cesium.Color.WHITE, result);\n   *     }\n   * };\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override color expression with a string\n   * style.color = 'color(\"blue\")';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override color expression with a condition\n   * style.color = {\n   *     conditions : [\n   *         ['${height} > 2', 'color(\"cyan\")'],\n   *         ['true', 'color(\"blue\")']\n   *     ]\n   * };\n   */\n  color: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._color;\n    },\n    set: function (value) {\n      this._color = getExpression(this, value);\n      this._style.color = getJsonFromExpression(this._color);\n      this._colorShaderFunctionReady = false;\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>pointSize</code> property. Alternatively a string or object defining a point size style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Number</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile or a Point Cloud tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     pointSize : '(${Temperature} > 90) ? 2.0 : 1.0'\n   * });\n   * style.pointSize.evaluate(feature); // returns a Number\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointSize expression with a custom function\n   * style.pointSize = {\n   *     evaluate : function(feature) {\n   *         return 1.0;\n   *     }\n   * };\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointSize expression with a number\n   * style.pointSize = 1.0;\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointSize expression with a string\n   * style.pointSize = '${height} / 10';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointSize expression with a condition\n   * style.pointSize =  {\n   *     conditions : [\n   *         ['${height} > 2', '1.0'],\n   *         ['true', '2.0']\n   *     ]\n   * };\n   */\n  pointSize: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._pointSize;\n    },\n    set: function (value) {\n      this._pointSize = getExpression(this, value);\n      this._style.pointSize = getJsonFromExpression(this._pointSize);\n      this._pointSizeShaderFunctionReady = false;\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>pointOutlineColor</code> property. Alternatively a string or object defining a color style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Color</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointOutlineColor expression with a string\n   * style.pointOutlineColor = 'color(\"blue\")';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointOutlineColor expression with a condition\n   * style.pointOutlineColor = {\n   *     conditions : [\n   *         ['${height} > 2', 'color(\"cyan\")'],\n   *         ['true', 'color(\"blue\")']\n   *     ]\n   * };\n   */\n  pointOutlineColor: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._pointOutlineColor;\n    },\n    set: function (value) {\n      this._pointOutlineColor = getExpression(this, value);\n      this._style.pointOutlineColor = getJsonFromExpression(\n        this._pointOutlineColor\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>pointOutlineWidth</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Number</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointOutlineWidth expression with a string\n   * style.pointOutlineWidth = '5';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override pointOutlineWidth expression with a condition\n   * style.pointOutlineWidth = {\n   *     conditions : [\n   *         ['${height} > 2', '5'],\n   *         ['true', '0']\n   *     ]\n   * };\n   */\n  pointOutlineWidth: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._pointOutlineWidth;\n    },\n    set: function (value) {\n      this._pointOutlineWidth = getExpression(this, value);\n      this._style.pointOutlineWidth = getJsonFromExpression(\n        this._pointOutlineWidth\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>labelColor</code> property. Alternatively a string or object defining a color style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Color</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelColor expression with a string\n   * style.labelColor = 'color(\"blue\")';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelColor expression with a condition\n   * style.labelColor = {\n   *     conditions : [\n   *         ['${height} > 2', 'color(\"cyan\")'],\n   *         ['true', 'color(\"blue\")']\n   *     ]\n   * };\n   */\n  labelColor: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelColor;\n    },\n    set: function (value) {\n      this._labelColor = getExpression(this, value);\n      this._style.labelColor = getJsonFromExpression(this._labelColor);\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>labelOutlineColor</code> property. Alternatively a string or object defining a color style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Color</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelOutlineColor expression with a string\n   * style.labelOutlineColor = 'color(\"blue\")';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelOutlineColor expression with a condition\n   * style.labelOutlineColor = {\n   *     conditions : [\n   *         ['${height} > 2', 'color(\"cyan\")'],\n   *         ['true', 'color(\"blue\")']\n   *     ]\n   * };\n   */\n  labelOutlineColor: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelOutlineColor;\n    },\n    set: function (value) {\n      this._labelOutlineColor = getExpression(this, value);\n      this._style.labelOutlineColor = getJsonFromExpression(\n        this._labelOutlineColor\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>labelOutlineWidth</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Number</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelOutlineWidth expression with a string\n   * style.labelOutlineWidth = '5';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelOutlineWidth expression with a condition\n   * style.labelOutlineWidth = {\n   *     conditions : [\n   *         ['${height} > 2', '5'],\n   *         ['true', '0']\n   *     ]\n   * };\n   */\n  labelOutlineWidth: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelOutlineWidth;\n    },\n    set: function (value) {\n      this._labelOutlineWidth = getExpression(this, value);\n      this._style.labelOutlineWidth = getJsonFromExpression(\n        this._labelOutlineWidth\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>font</code> property. Alternatively a string or object defining a string style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>String</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     font : '(${Temperature} > 90) ? \"30px Helvetica\" : \"24px Helvetica\"'\n   * });\n   * style.font.evaluate(feature); // returns a String\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override font expression with a custom function\n   * style.font = {\n   *     evaluate : function(feature) {\n   *         return '24px Helvetica';\n   *     }\n   * };\n   */\n  font: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._font;\n    },\n    set: function (value) {\n      this._font = getExpression(this, value);\n      this._style.font = getJsonFromExpression(this._font);\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>label style</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>LabelStyle</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     labelStyle : '(${Temperature} > 90) ? ' + LabelStyle.FILL_AND_OUTLINE + ' : ' + LabelStyle.FILL\n   * });\n   * style.labelStyle.evaluate(feature); // returns a LabelStyle\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelStyle expression with a custom function\n   * style.labelStyle = {\n   *     evaluate : function(feature) {\n   *         return LabelStyle.FILL;\n   *     }\n   * };\n   */\n  labelStyle: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelStyle;\n    },\n    set: function (value) {\n      this._labelStyle = getExpression(this, value);\n      this._style.labelStyle = getJsonFromExpression(this._labelStyle);\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>labelText</code> property. Alternatively a string or object defining a string style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>String</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     labelText : '(${Temperature} > 90) ? \">90\" : \"<=90\"'\n   * });\n   * style.labelText.evaluate(feature); // returns a String\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelText expression with a custom function\n   * style.labelText = {\n   *     evaluate : function(feature) {\n   *         return 'Example label text';\n   *     }\n   * };\n   */\n  labelText: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelText;\n    },\n    set: function (value) {\n      this._labelText = getExpression(this, value);\n      this._style.labelText = getJsonFromExpression(this._labelText);\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>backgroundColor</code> property. Alternatively a string or object defining a color style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Color</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override backgroundColor expression with a string\n   * style.backgroundColor = 'color(\"blue\")';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override backgroundColor expression with a condition\n   * style.backgroundColor = {\n   *     conditions : [\n   *         ['${height} > 2', 'color(\"cyan\")'],\n   *         ['true', 'color(\"blue\")']\n   *     ]\n   * };\n   */\n  backgroundColor: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._backgroundColor;\n    },\n    set: function (value) {\n      this._backgroundColor = getExpression(this, value);\n      this._style.backgroundColor = getJsonFromExpression(\n        this._backgroundColor\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>backgroundPadding</code> property. Alternatively a string or object defining a vec2 style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Cartesian2</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override backgroundPadding expression with a string\n   * style.backgroundPadding = 'vec2(5.0, 7.0)';\n   * style.backgroundPadding.evaluate(feature); // returns a Cartesian2\n   */\n  backgroundPadding: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._backgroundPadding;\n    },\n    set: function (value) {\n      this._backgroundPadding = getExpression(this, value);\n      this._style.backgroundPadding = getJsonFromExpression(\n        this._backgroundPadding\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>backgroundEnabled</code> property. Alternatively a string or object defining a boolean style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Boolean</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override backgroundEnabled expression with a string\n   * style.backgroundEnabled = 'true';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override backgroundEnabled expression with a condition\n   * style.backgroundEnabled = {\n   *     conditions : [\n   *         ['${height} > 2', 'true'],\n   *         ['true', 'false']\n   *     ]\n   * };\n   */\n  backgroundEnabled: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._backgroundEnabled;\n    },\n    set: function (value) {\n      this._backgroundEnabled = getExpression(this, value);\n      this._style.backgroundEnabled = getJsonFromExpression(\n        this._backgroundEnabled\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>scaleByDistance</code> property. Alternatively a string or object defining a vec4 style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Cartesian4</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override scaleByDistance expression with a string\n   * style.scaleByDistance = 'vec4(1.5e2, 2.0, 1.5e7, 0.5)';\n   * style.scaleByDistance.evaluate(feature); // returns a Cartesian4\n   */\n  scaleByDistance: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._scaleByDistance;\n    },\n    set: function (value) {\n      this._scaleByDistance = getExpression(this, value);\n      this._style.scaleByDistance = getJsonFromExpression(\n        this._scaleByDistance\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>translucencyByDistance</code> property. Alternatively a string or object defining a vec4 style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Cartesian4</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override translucencyByDistance expression with a string\n   * style.translucencyByDistance = 'vec4(1.5e2, 1.0, 1.5e7, 0.2)';\n   * style.translucencyByDistance.evaluate(feature); // returns a Cartesian4\n   */\n  translucencyByDistance: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._translucencyByDistance;\n    },\n    set: function (value) {\n      this._translucencyByDistance = getExpression(this, value);\n      this._style.translucencyByDistance = getJsonFromExpression(\n        this._translucencyByDistance\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>distanceDisplayCondition</code> property. Alternatively a string or object defining a vec2 style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Cartesian2</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override distanceDisplayCondition expression with a string\n   * style.distanceDisplayCondition = 'vec2(0.0, 5.5e6)';\n   * style.distanceDisplayCondition.evaluate(feature); // returns a Cartesian2\n   */\n  distanceDisplayCondition: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._distanceDisplayCondition;\n    },\n    set: function (value) {\n      this._distanceDisplayCondition = getExpression(this, value);\n      this._style.distanceDisplayCondition = getJsonFromExpression(\n        this._distanceDisplayCondition\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>heightOffset</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Number</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override heightOffset expression with a string\n   * style.heightOffset = '2.0';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override heightOffset expression with a condition\n   * style.heightOffset = {\n   *     conditions : [\n   *         ['${height} > 2', '4.0'],\n   *         ['true', '2.0']\n   *     ]\n   * };\n   */\n  heightOffset: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._heightOffset;\n    },\n    set: function (value) {\n      this._heightOffset = getExpression(this, value);\n      this._style.heightOffset = getJsonFromExpression(this._heightOffset);\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>anchorLineEnabled</code> property. Alternatively a string or object defining a boolean style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Boolean</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override anchorLineEnabled expression with a string\n   * style.anchorLineEnabled = 'true';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override anchorLineEnabled expression with a condition\n   * style.anchorLineEnabled = {\n   *     conditions : [\n   *         ['${height} > 2', 'true'],\n   *         ['true', 'false']\n   *     ]\n   * };\n   */\n  anchorLineEnabled: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._anchorLineEnabled;\n    },\n    set: function (value) {\n      this._anchorLineEnabled = getExpression(this, value);\n      this._style.anchorLineEnabled = getJsonFromExpression(\n        this._anchorLineEnabled\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>anchorLineColor</code> property. Alternatively a string or object defining a color style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Color</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override anchorLineColor expression with a string\n   * style.anchorLineColor = 'color(\"blue\")';\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override anchorLineColor expression with a condition\n   * style.anchorLineColor = {\n   *     conditions : [\n   *         ['${height} > 2', 'color(\"cyan\")'],\n   *         ['true', 'color(\"blue\")']\n   *     ]\n   * };\n   */\n  anchorLineColor: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._anchorLineColor;\n    },\n    set: function (value) {\n      this._anchorLineColor = getExpression(this, value);\n      this._style.anchorLineColor = getJsonFromExpression(\n        this._anchorLineColor\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>image</code> property. Alternatively a string or object defining a string style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>String</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     image : '(${Temperature} > 90) ? \"/url/to/image1\" : \"/url/to/image2\"'\n   * });\n   * style.image.evaluate(feature); // returns a String\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override image expression with a custom function\n   * style.image = {\n   *     evaluate : function(feature) {\n   *         return '/url/to/image';\n   *     }\n   * };\n   */\n  image: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._image;\n    },\n    set: function (value) {\n      this._image = getExpression(this, value);\n      this._style.image = getJsonFromExpression(this._image);\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>disableDepthTestDistance</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>Number</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override disableDepthTestDistance expression with a string\n   * style.disableDepthTestDistance = '1000.0';\n   * style.disableDepthTestDistance.evaluate(feature); // returns a Number\n   */\n  disableDepthTestDistance: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._disableDepthTestDistance;\n    },\n    set: function (value) {\n      this._disableDepthTestDistance = getExpression(this, value);\n      this._style.disableDepthTestDistance = getJsonFromExpression(\n        this._disableDepthTestDistance\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>horizontalOrigin</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>HorizontalOrigin</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     horizontalOrigin : HorizontalOrigin.LEFT\n   * });\n   * style.horizontalOrigin.evaluate(feature); // returns a HorizontalOrigin\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override horizontalOrigin expression with a custom function\n   * style.horizontalOrigin = {\n   *     evaluate : function(feature) {\n   *         return HorizontalOrigin.CENTER;\n   *     }\n   * };\n   */\n  horizontalOrigin: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._horizontalOrigin;\n    },\n    set: function (value) {\n      this._horizontalOrigin = getExpression(this, value);\n      this._style.horizontalOrigin = getJsonFromExpression(\n        this._horizontalOrigin\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>verticalOrigin</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>VerticalOrigin</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     verticalOrigin : VerticalOrigin.TOP\n   * });\n   * style.verticalOrigin.evaluate(feature); // returns a VerticalOrigin\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override verticalOrigin expression with a custom function\n   * style.verticalOrigin = {\n   *     evaluate : function(feature) {\n   *         return VerticalOrigin.CENTER;\n   *     }\n   * };\n   */\n  verticalOrigin: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._verticalOrigin;\n    },\n    set: function (value) {\n      this._verticalOrigin = getExpression(this, value);\n      this._style.verticalOrigin = getJsonFromExpression(this._verticalOrigin);\n    },\n  },\n\n  /**\n         Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>labelHorizontalOrigin</code> property. Alternatively a string or object defining a number style can be used.\n         * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n         * <p>\n         * The expression must return a <code>HorizontalOrigin</code>.\n         * </p>\n         * <p>\n         * This expression is only applicable to point features in a Vector tile.\n         * </p>\n         *\n         * @memberof Cesium3DTileStyle.prototype\n         *\n         * @type {StyleExpression}\n         *\n         * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n         *\n         * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n         *\n         * @example\n         * const style = new Cesium3DTileStyle({\n         *     labelHorizontalOrigin : HorizontalOrigin.LEFT\n         * });\n         * style.labelHorizontalOrigin.evaluate(feature); // returns a HorizontalOrigin\n         *\n         * @example\n         * const style = new Cesium.Cesium3DTileStyle();\n         * // Override labelHorizontalOrigin expression with a custom function\n         * style.labelHorizontalOrigin = {\n         *     evaluate : function(feature) {\n         *         return HorizontalOrigin.CENTER;\n         *     }\n         * };\n         */\n  labelHorizontalOrigin: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelHorizontalOrigin;\n    },\n    set: function (value) {\n      this._labelHorizontalOrigin = getExpression(this, value);\n      this._style.labelHorizontalOrigin = getJsonFromExpression(\n        this._labelHorizontalOrigin\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the {@link StyleExpression} object used to evaluate the style's <code>labelVerticalOrigin</code> property. Alternatively a string or object defining a number style can be used.\n   * The getter will return the internal {@link Expression} or {@link ConditionsExpression}, which may differ from the value provided to the setter.\n   * <p>\n   * The expression must return a <code>VerticalOrigin</code>.\n   * </p>\n   * <p>\n   * This expression is only applicable to point features in a Vector tile.\n   * </p>\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     labelVerticalOrigin : VerticalOrigin.TOP\n   * });\n   * style.labelVerticalOrigin.evaluate(feature); // returns a VerticalOrigin\n   *\n   * @example\n   * const style = new Cesium.Cesium3DTileStyle();\n   * // Override labelVerticalOrigin expression with a custom function\n   * style.labelVerticalOrigin = {\n   *     evaluate : function(feature) {\n   *         return VerticalOrigin.CENTER;\n   *     }\n   * };\n   */\n  labelVerticalOrigin: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._labelVerticalOrigin;\n    },\n    set: function (value) {\n      this._labelVerticalOrigin = getExpression(this, value);\n      this._style.labelVerticalOrigin = getJsonFromExpression(\n        this._labelVerticalOrigin\n      );\n    },\n  },\n\n  /**\n   * Gets or sets the object containing application-specific expression that can be explicitly\n   * evaluated, e.g., for display in a UI.\n   *\n   * @memberof Cesium3DTileStyle.prototype\n   *\n   * @type {StyleExpression}\n   *\n   * @exception {DeveloperError} The style is not loaded.  Use {@link Cesium3DTileStyle#readyPromise} or wait for {@link Cesium3DTileStyle#ready} to be true.\n   *\n   * @example\n   * const style = new Cesium3DTileStyle({\n   *     meta : {\n   *         description : '\"Building id ${id} has height ${Height}.\"'\n   *     }\n   * });\n   * style.meta.description.evaluate(feature); // returns a String with the substituted variables\n   */\n  meta: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this._ready) {\n        throw new DeveloperError(\n          \"The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._meta;\n    },\n    set: function (value) {\n      this._meta = value;\n    },\n  },\n});\n\n/**\n * Asynchronously creates a Cesium3DTileStyle from a url.\n *\n * @param {Resource|String} url The url of the style to be loaded.\n *\n * @returns {Promise.<Cesium3DTileStyle>} A promise which resolves to the created style\n *\n * @private\n */\nCesium3DTileStyle.fromUrl = function (url) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(url)) {\n    throw new DeveloperError(\"url is required\");\n  }\n  //>>includeEnd('debug');\n\n  const resource = Resource.createIfNeeded(url);\n  return resource.fetchJson(url).then(function (styleJson) {\n    return new Cesium3DTileStyle(styleJson);\n  });\n};\n\n/**\n * Gets the color shader function for this style.\n *\n * @param {String} functionSignature Signature of the generated function.\n * @param {Object} variableSubstitutionMap Maps variable names to shader variable names.\n * @param {Object} shaderState Stores information about the generated shader function, including whether it is translucent.\n *\n * @returns {String} The shader function.\n *\n * @private\n */\nCesium3DTileStyle.prototype.getColorShaderFunction = function (\n  functionSignature,\n  variableSubstitutionMap,\n  shaderState\n) {\n  if (this._colorShaderFunctionReady) {\n    shaderState.translucent = this._colorShaderTranslucent;\n    // Return the cached result, may be undefined\n    return this._colorShaderFunction;\n  }\n\n  this._colorShaderFunctionReady = true;\n  if (defined(this.color) && defined(this.color.getShaderFunction)) {\n    this._colorShaderFunction = this.color.getShaderFunction(\n      functionSignature,\n      variableSubstitutionMap,\n      shaderState,\n      \"vec4\"\n    );\n  } else {\n    this._colorShaderFunction = undefined;\n  }\n\n  this._colorShaderTranslucent = shaderState.translucent;\n  return this._colorShaderFunction;\n};\n\n/**\n * Gets the show shader function for this style.\n *\n * @param {String} functionSignature Signature of the generated function.\n * @param {Object} variableSubstitutionMap Maps variable names to shader variable names.\n * @param {Object} shaderState Stores information about the generated shader function, including whether it is translucent.\n *\n * @returns {String} The shader function.\n *\n * @private\n */\nCesium3DTileStyle.prototype.getShowShaderFunction = function (\n  functionSignature,\n  variableSubstitutionMap,\n  shaderState\n) {\n  if (this._showShaderFunctionReady) {\n    // Return the cached result, may be undefined\n    return this._showShaderFunction;\n  }\n\n  this._showShaderFunctionReady = true;\n\n  if (defined(this.show) && defined(this.show.getShaderFunction)) {\n    this._showShaderFunction = this.show.getShaderFunction(\n      functionSignature,\n      variableSubstitutionMap,\n      shaderState,\n      \"bool\"\n    );\n  } else {\n    this._showShaderFunction = undefined;\n  }\n  return this._showShaderFunction;\n};\n\n/**\n * Gets the pointSize shader function for this style.\n *\n * @param {String} functionSignature Signature of the generated function.\n * @param {Object} variableSubstitutionMap Maps variable names to shader variable names.\n * @param {Object} shaderState Stores information about the generated shader function, including whether it is translucent.\n *\n * @returns {String} The shader function.\n *\n * @private\n */\nCesium3DTileStyle.prototype.getPointSizeShaderFunction = function (\n  functionSignature,\n  variableSubstitutionMap,\n  shaderState\n) {\n  if (this._pointSizeShaderFunctionReady) {\n    // Return the cached result, may be undefined\n    return this._pointSizeShaderFunction;\n  }\n\n  this._pointSizeShaderFunctionReady = true;\n  if (defined(this.pointSize) && defined(this.pointSize.getShaderFunction)) {\n    this._pointSizeShaderFunction = this.pointSize.getShaderFunction(\n      functionSignature,\n      variableSubstitutionMap,\n      shaderState,\n      \"float\"\n    );\n  } else {\n    this._pointSizeShaderFunction = undefined;\n  }\n\n  return this._pointSizeShaderFunction;\n};\n\n/**\n * Gets the variables used by the style.\n *\n * @returns {String[]} The variables used by the style.\n *\n * @private\n */\nCesium3DTileStyle.prototype.getVariables = function () {\n  let variables = [];\n\n  if (defined(this.color) && defined(this.color.getVariables)) {\n    variables.push.apply(variables, this.color.getVariables());\n  }\n\n  if (defined(this.show) && defined(this.show.getVariables)) {\n    variables.push.apply(variables, this.show.getVariables());\n  }\n\n  if (defined(this.pointSize) && defined(this.pointSize.getVariables)) {\n    variables.push.apply(variables, this.pointSize.getVariables());\n  }\n\n  // Remove duplicates\n  variables = variables.filter(function (variable, index, variables) {\n    return variables.indexOf(variable) === index;\n  });\n\n  return variables;\n};\n\nexport default Cesium3DTileStyle;\n","import defined from \"../Core/defined.js\";\n\n/**\n * @private\n */\nfunction Cesium3DTileStyleEngine() {\n  this._style = undefined; // The style provided by the user\n  this._styleDirty = false; // true when the style is reassigned\n  this._lastStyleTime = 0; // The \"time\" when the last style was assigned\n}\n\nObject.defineProperties(Cesium3DTileStyleEngine.prototype, {\n  style: {\n    get: function () {\n      return this._style;\n    },\n    set: function (value) {\n      if (value === this._style) {\n        return;\n      }\n      this._style = value;\n      this._styleDirty = true;\n    },\n  },\n});\n\nCesium3DTileStyleEngine.prototype.makeDirty = function () {\n  this._styleDirty = true;\n};\n\nCesium3DTileStyleEngine.prototype.resetDirty = function () {\n  this._styleDirty = false;\n};\n\nCesium3DTileStyleEngine.prototype.applyStyle = function (tileset) {\n  if (!tileset.ready) {\n    return;\n  }\n\n  if (defined(this._style) && !this._style._ready) {\n    return;\n  }\n\n  const styleDirty = this._styleDirty;\n\n  if (styleDirty) {\n    // Increase \"time\", so the style is applied to all visible tiles\n    ++this._lastStyleTime;\n  }\n\n  const lastStyleTime = this._lastStyleTime;\n  const statistics = tileset._statistics;\n\n  // If a new style was assigned, loop through all the visible tiles; otherwise, loop through\n  // only the tiles that are newly visible, i.e., they are visible this frame, but were not\n  // visible last frame.  In many cases, the newly selected tiles list will be short or empty.\n  const tiles = styleDirty\n    ? tileset._selectedTiles\n    : tileset._selectedTilesToStyle;\n  // PERFORMANCE_IDEA: does mouse-over picking basically trash this?  We need to style on\n  // pick, for example, because a feature's show may be false.\n\n  const length = tiles.length;\n  for (let i = 0; i < length; ++i) {\n    const tile = tiles[i];\n    if (tile.lastStyleTime !== lastStyleTime) {\n      // Apply the style to this tile if it wasn't already applied because:\n      //   1) the user assigned a new style to the tileset\n      //   2) this tile is now visible, but it wasn't visible when the style was first assigned\n      const content = tile.content;\n      tile.lastStyleTime = lastStyleTime;\n      content.applyStyle(this._style);\n      statistics.numberOfFeaturesStyled += content.featuresLength;\n      ++statistics.numberOfTilesStyled;\n    }\n  }\n};\nexport default Cesium3DTileStyleEngine;\n","import ApproximateTerrainHeights from \"../Core/ApproximateTerrainHeights.js\";\nimport Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartographic from \"../Core/Cartographic.js\";\nimport Check from \"../Core/Check.js\";\nimport clone from \"../Core/clone.js\";\nimport Credit from \"../Core/Credit.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport deprecationWarning from \"../Core/deprecationWarning.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\nimport Event from \"../Core/Event.js\";\nimport ExperimentalFeatures from \"../Core/ExperimentalFeatures.js\";\nimport ImageBasedLighting from \"./ImageBasedLighting.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport ManagedArray from \"../Core/ManagedArray.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport Resource from \"../Core/Resource.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Transforms from \"../Core/Transforms.js\";\nimport ClearCommand from \"../Renderer/ClearCommand.js\";\nimport Pass from \"../Renderer/Pass.js\";\nimport RenderState from \"../Renderer/RenderState.js\";\nimport Axis from \"./Axis.js\";\nimport Cesium3DTile from \"./Cesium3DTile.js\";\nimport Cesium3DTileColorBlendMode from \"./Cesium3DTileColorBlendMode.js\";\nimport Cesium3DTileContentState from \"./Cesium3DTileContentState.js\";\nimport Cesium3DTilesetMetadata from \"./Cesium3DTilesetMetadata.js\";\nimport Cesium3DTileOptimizations from \"./Cesium3DTileOptimizations.js\";\nimport Cesium3DTilePass from \"./Cesium3DTilePass.js\";\nimport Cesium3DTileRefine from \"./Cesium3DTileRefine.js\";\nimport Cesium3DTilesetCache from \"./Cesium3DTilesetCache.js\";\nimport Cesium3DTilesetHeatmap from \"./Cesium3DTilesetHeatmap.js\";\nimport Cesium3DTilesetStatistics from \"./Cesium3DTilesetStatistics.js\";\nimport Cesium3DTileStyleEngine from \"./Cesium3DTileStyleEngine.js\";\nimport ClippingPlaneCollection from \"./ClippingPlaneCollection.js\";\nimport hasExtension from \"./hasExtension.js\";\nimport ImplicitTileset from \"./ImplicitTileset.js\";\nimport ImplicitTileCoordinates from \"./ImplicitTileCoordinates.js\";\nimport LabelCollection from \"./LabelCollection.js\";\nimport PointCloudEyeDomeLighting from \"./PointCloudEyeDomeLighting.js\";\nimport PointCloudShading from \"./PointCloudShading.js\";\nimport ResourceCache from \"./ResourceCache.js\";\nimport SceneMode from \"./SceneMode.js\";\nimport ShadowMode from \"./ShadowMode.js\";\nimport SplitDirection from \"./SplitDirection.js\";\nimport StencilConstants from \"./StencilConstants.js\";\nimport TileBoundingRegion from \"./TileBoundingRegion.js\";\nimport TileBoundingSphere from \"./TileBoundingSphere.js\";\nimport TileOrientedBoundingBox from \"./TileOrientedBoundingBox.js\";\n\n/**\n * A {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification|3D Tiles tileset},\n * used for streaming massive heterogeneous 3D geospatial datasets.\n *\n * @alias Cesium3DTileset\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {Resource|String|Promise<Resource>|Promise<String>} options.url The url to a tileset JSON file.\n * @param {Boolean} [options.show=true] Determines if the tileset will be shown.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] A 4x4 transformation matrix that transforms the tileset's root tile.\n * @param {ShadowMode} [options.shadows=ShadowMode.ENABLED] Determines whether the tileset casts or receives shadows from light sources.\n * @param {Number} [options.maximumScreenSpaceError=16] The maximum screen space error used to drive level of detail refinement.\n * @param {Number} [options.maximumMemoryUsage=512] The maximum amount of memory in MB that can be used by the tileset.\n * @param {Boolean} [options.cullWithChildrenBounds=true] Optimization option. Whether to cull tiles using the union of their children bounding volumes.\n * @param {Boolean} [options.cullRequestsWhileMoving=true] Optimization option. Don't request tiles that will likely be unused when they come back because of the camera's movement. This optimization only applies to stationary tilesets.\n * @param {Number} [options.cullRequestsWhileMovingMultiplier=60.0] Optimization option. Multiplier used in culling requests while moving. Larger is more aggressive culling, smaller less aggressive culling.\n * @param {Boolean} [options.preloadWhenHidden=false] Preload tiles when <code>tileset.show</code> is <code>false</code>. Loads tiles as if the tileset is visible but does not render them.\n * @param {Boolean} [options.preloadFlightDestinations=true] Optimization option. Preload tiles at the camera's flight destination while the camera is in flight.\n * @param {Boolean} [options.preferLeaves=false] Optimization option. Prefer loading of leaves first.\n * @param {Boolean} [options.dynamicScreenSpaceError=false] Optimization option. Reduce the screen space error for tiles that are further away from the camera.\n * @param {Number} [options.dynamicScreenSpaceErrorDensity=0.00278] Density used to adjust the dynamic screen space error, similar to fog density.\n * @param {Number} [options.dynamicScreenSpaceErrorFactor=4.0] A factor used to increase the computed dynamic screen space error.\n * @param {Number} [options.dynamicScreenSpaceErrorHeightFalloff=0.25] A ratio of the tileset's height at which the density starts to falloff.\n * @param {Number} [options.progressiveResolutionHeightFraction=0.3] Optimization option. If between (0.0, 0.5], tiles at or above the screen space error for the reduced screen resolution of <code>progressiveResolutionHeightFraction*screenHeight</code> will be prioritized first. This can help get a quick layer of tiles down while full resolution tiles continue to load.\n * @param {Boolean} [options.foveatedScreenSpaceError=true] Optimization option. Prioritize loading tiles in the center of the screen by temporarily raising the screen space error for tiles around the edge of the screen. Screen space error returns to normal once all the tiles in the center of the screen as determined by the {@link Cesium3DTileset#foveatedConeSize} are loaded.\n * @param {Number} [options.foveatedConeSize=0.1] Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control the cone size that determines which tiles are deferred. Tiles that are inside this cone are loaded immediately. Tiles outside the cone are potentially deferred based on how far outside the cone they are and their screen space error. This is controlled by {@link Cesium3DTileset#foveatedInterpolationCallback} and {@link Cesium3DTileset#foveatedMinimumScreenSpaceErrorRelaxation}. Setting this to 0.0 means the cone will be the line formed by the camera position and its view direction. Setting this to 1.0 means the cone encompasses the entire field of view of the camera, disabling the effect.\n * @param {Number} [options.foveatedMinimumScreenSpaceErrorRelaxation=0.0] Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control the starting screen space error relaxation for tiles outside the foveated cone. The screen space error will be raised starting with tileset value up to {@link Cesium3DTileset#maximumScreenSpaceError} based on the provided {@link Cesium3DTileset#foveatedInterpolationCallback}.\n * @param {Cesium3DTileset.foveatedInterpolationCallback} [options.foveatedInterpolationCallback=Math.lerp] Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control how much to raise the screen space error for tiles outside the foveated cone, interpolating between {@link Cesium3DTileset#foveatedMinimumScreenSpaceErrorRelaxation} and {@link Cesium3DTileset#maximumScreenSpaceError}\n * @param {Number} [options.foveatedTimeDelay=0.2] Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control how long in seconds to wait after the camera stops moving before deferred tiles start loading in. This time delay prevents requesting tiles around the edges of the screen when the camera is moving. Setting this to 0.0 will immediately request all tiles in any given view.\n * @param {Boolean} [options.skipLevelOfDetail=false] Optimization option. Determines if level of detail skipping should be applied during the traversal.\n * @param {Number} [options.baseScreenSpaceError=1024] When <code>skipLevelOfDetail</code> is <code>true</code>, the screen space error that must be reached before skipping levels of detail.\n * @param {Number} [options.skipScreenSpaceErrorFactor=16] When <code>skipLevelOfDetail</code> is <code>true</code>, a multiplier defining the minimum screen space error to skip. Used in conjunction with <code>skipLevels</code> to determine which tiles to load.\n * @param {Number} [options.skipLevels=1] When <code>skipLevelOfDetail</code> is <code>true</code>, a constant defining the minimum number of levels to skip when loading tiles. When it is 0, no levels are skipped. Used in conjunction with <code>skipScreenSpaceErrorFactor</code> to determine which tiles to load.\n * @param {Boolean} [options.immediatelyLoadDesiredLevelOfDetail=false] When <code>skipLevelOfDetail</code> is <code>true</code>, only tiles that meet the maximum screen space error will ever be downloaded. Skipping factors are ignored and just the desired tiles are loaded.\n * @param {Boolean} [options.loadSiblings=false] When <code>skipLevelOfDetail</code> is <code>true</code>, determines whether siblings of visible tiles are always downloaded during traversal.\n * @param {ClippingPlaneCollection} [options.clippingPlanes] The {@link ClippingPlaneCollection} used to selectively disable rendering the tileset.\n * @param {ClassificationType} [options.classificationType] Determines whether terrain, 3D Tiles or both will be classified by this tileset. See {@link Cesium3DTileset#classificationType} for details about restrictions and limitations.\n * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The ellipsoid determining the size and shape of the globe.\n * @param {Object} [options.pointCloudShading] Options for constructing a {@link PointCloudShading} object to control point attenuation based on geometric error and lighting.\n * @param {Cartesian3} [options.lightColor] The light color when shading models. When <code>undefined</code> the scene's light color is used instead.\n * @param {ImageBasedLighting} [options.imageBasedLighting] The properties for managing image-based lighting for this tileset.\n * @param {Boolean} [options.backFaceCulling=true] Whether to cull back-facing geometry. When true, back face culling is determined by the glTF material's doubleSided property; when false, back face culling is disabled.\n * @param {Boolean} [options.showOutline=true] Whether to display the outline for models using the {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/CESIUM_primitive_outline|CESIUM_primitive_outline} extension. When true, outlines are displayed. When false, outlines are not displayed.\n * @param {Boolean} [options.vectorClassificationOnly=false] Indicates that only the tileset's vector tiles should be used for classification.\n * @param {Boolean} [options.vectorKeepDecodedPositions=false] Whether vector tiles should keep decoded positions in memory. This is used with {@link Cesium3DTileFeature.getPolylinePositions}.\n * @param {String|Number} [options.featureIdLabel=\"featureId_0\"] Label of the feature ID set to use for picking and styling. For EXT_mesh_features, this is the feature ID's label property, or \"featureId_N\" (where N is the index in the featureIds array) when not specified. EXT_feature_metadata did not have a label field, so such feature ID sets are always labeled \"featureId_N\" where N is the index in the list of all feature Ids, where feature ID attributes are listed before feature ID textures. If featureIdLabel is an integer N, it is converted to the string \"featureId_N\" automatically. If both per-primitive and per-instance feature IDs are present, the instance feature IDs take priority.\n * @param {String|Number} [options.instanceFeatureIdLabel=\"instanceFeatureId_0\"] Label of the instance feature ID set used for picking and styling. If instanceFeatureIdLabel is set to an integer N, it is converted to the string \"instanceFeatureId_N\" automatically. If both per-primitive and per-instance feature IDs are present, the instance feature IDs take priority.\n * @param {Boolean} [options.showCreditsOnScreen=false] Whether to display the credits of this tileset on screen.\n * @param {SplitDirection} [options.splitDirection=SplitDirection.NONE] The {@link SplitDirection} split to apply to this tileset.\n * @param {String} [options.debugHeatmapTilePropertyName] The tile variable to colorize as a heatmap. All rendered tiles will be colorized relative to each other's specified variable value.\n * @param {Boolean} [options.debugFreezeFrame=false] For debugging only. Determines if only the tiles from last frame should be used for rendering.\n * @param {Boolean} [options.debugColorizeTiles=false] For debugging only. When true, assigns a random color to each tile.\n * @param {Boolean} [options.enableDebugWireframe] For debugging only. This must be true for debugWireframe to work for ModelExperimental in WebGL1. This cannot be set after the tileset has loaded.\n * @param {Boolean} [options.debugWireframe=false] For debugging only. When true, render's each tile's content as a wireframe.\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. When true, renders the bounding volume for each tile.\n * @param {Boolean} [options.debugShowContentBoundingVolume=false] For debugging only. When true, renders the bounding volume for each tile's content.\n * @param {Boolean} [options.debugShowViewerRequestVolume=false] For debugging only. When true, renders the viewer request volume for each tile.\n * @param {Boolean} [options.debugShowGeometricError=false] For debugging only. When true, draws labels to indicate the geometric error of each tile.\n * @param {Boolean} [options.debugShowRenderingStatistics=false] For debugging only. When true, draws labels to indicate the number of commands, points, triangles and features for each tile.\n * @param {Boolean} [options.debugShowMemoryUsage=false] For debugging only. When true, draws labels to indicate the texture and geometry memory in megabytes used by each tile.\n * @param {Boolean} [options.debugShowUrl=false] For debugging only. When true, draws labels to indicate the url of each tile.\n *\n * @exception {DeveloperError} The tileset must be 3D Tiles version 0.0 or 1.0.\n *\n * @example\n * const tileset = scene.primitives.add(new Cesium.Cesium3DTileset({\n *      url : 'http://localhost:8002/tilesets/Seattle/tileset.json'\n * }));\n *\n * @example\n * // Common setting for the skipLevelOfDetail optimization\n * const tileset = scene.primitives.add(new Cesium.Cesium3DTileset({\n *      url : 'http://localhost:8002/tilesets/Seattle/tileset.json',\n *      skipLevelOfDetail : true,\n *      baseScreenSpaceError : 1024,\n *      skipScreenSpaceErrorFactor : 16,\n *      skipLevels : 1,\n *      immediatelyLoadDesiredLevelOfDetail : false,\n *      loadSiblings : false,\n *      cullWithChildrenBounds : true\n * }));\n *\n * @example\n * // Common settings for the dynamicScreenSpaceError optimization\n * const tileset = scene.primitives.add(new Cesium.Cesium3DTileset({\n *      url : 'http://localhost:8002/tilesets/Seattle/tileset.json',\n *      dynamicScreenSpaceError : true,\n *      dynamicScreenSpaceErrorDensity : 0.00278,\n *      dynamicScreenSpaceErrorFactor : 4.0,\n *      dynamicScreenSpaceErrorHeightFalloff : 0.25\n * }));\n *\n * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification|3D Tiles specification}\n */\nfunction Cesium3DTileset(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"options.url\", options.url);\n  //>>includeEnd('debug');\n\n  this._url = undefined;\n  this._basePath = undefined;\n  this._root = undefined;\n  this._resource = undefined;\n  this._asset = undefined; // Metadata for the entire tileset\n  this._properties = undefined; // Metadata for per-model/point/etc properties\n  this._geometricError = undefined; // Geometric error when the tree is not rendered at all\n  this._extensionsUsed = undefined;\n  this._extensions = undefined;\n  this._gltfUpAxis = undefined;\n  this._cache = new Cesium3DTilesetCache();\n  this._processingQueue = [];\n  this._selectedTiles = [];\n  this._emptyTiles = [];\n  this._requestedTiles = [];\n  this._selectedTilesToStyle = [];\n  this._loadTimestamp = undefined;\n  this._timeSinceLoad = 0.0;\n  this._updatedVisibilityFrame = 0;\n  this._updatedModelMatrixFrame = 0;\n  this._modelMatrixChanged = false;\n  this._previousModelMatrix = undefined;\n  this._extras = undefined;\n  this._credits = undefined;\n\n  this._showCreditsOnScreen = defaultValue(options.showCreditsOnScreen, false);\n\n  this._cullWithChildrenBounds = defaultValue(\n    options.cullWithChildrenBounds,\n    true\n  );\n  this._allTilesAdditive = true;\n\n  this._hasMixedContent = false;\n\n  this._stencilClearCommand = undefined;\n  this._backfaceCommands = new ManagedArray();\n\n  this._maximumScreenSpaceError = defaultValue(\n    options.maximumScreenSpaceError,\n    16\n  );\n  this._maximumMemoryUsage = defaultValue(options.maximumMemoryUsage, 512);\n\n  this._styleEngine = new Cesium3DTileStyleEngine();\n\n  this._modelMatrix = defined(options.modelMatrix)\n    ? Matrix4.clone(options.modelMatrix)\n    : Matrix4.clone(Matrix4.IDENTITY);\n\n  this._statistics = new Cesium3DTilesetStatistics();\n  this._statisticsLast = new Cesium3DTilesetStatistics();\n  this._statisticsPerPass = new Array(Cesium3DTilePass.NUMBER_OF_PASSES);\n\n  for (let i = 0; i < Cesium3DTilePass.NUMBER_OF_PASSES; ++i) {\n    this._statisticsPerPass[i] = new Cesium3DTilesetStatistics();\n  }\n\n  this._requestedTilesInFlight = [];\n\n  this._maximumPriority = {\n    foveatedFactor: -Number.MAX_VALUE,\n    depth: -Number.MAX_VALUE,\n    distance: -Number.MAX_VALUE,\n    reverseScreenSpaceError: -Number.MAX_VALUE,\n  };\n  this._minimumPriority = {\n    foveatedFactor: Number.MAX_VALUE,\n    depth: Number.MAX_VALUE,\n    distance: Number.MAX_VALUE,\n    reverseScreenSpaceError: Number.MAX_VALUE,\n  };\n  this._heatmap = new Cesium3DTilesetHeatmap(\n    options.debugHeatmapTilePropertyName\n  );\n\n  /**\n   * Optimization option. Don't request tiles that will likely be unused when they come back because of the camera's movement. This optimization only applies to stationary tilesets.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.cullRequestsWhileMoving = defaultValue(\n    options.cullRequestsWhileMoving,\n    true\n  );\n  this._cullRequestsWhileMoving = false;\n\n  /**\n   * Optimization option. Multiplier used in culling requests while moving. Larger is more aggressive culling, smaller less aggressive culling.\n   *\n   * @type {Number}\n   * @default 60.0\n   */\n  this.cullRequestsWhileMovingMultiplier = defaultValue(\n    options.cullRequestsWhileMovingMultiplier,\n    60.0\n  );\n\n  /**\n   * Optimization option. If between (0.0, 0.5], tiles at or above the screen space error for the reduced screen resolution of <code>progressiveResolutionHeightFraction*screenHeight</code> will be prioritized first. This can help get a quick layer of tiles down while full resolution tiles continue to load.\n   *\n   * @type {Number}\n   * @default 0.3\n   */\n  this.progressiveResolutionHeightFraction = CesiumMath.clamp(\n    defaultValue(options.progressiveResolutionHeightFraction, 0.3),\n    0.0,\n    0.5\n  );\n\n  /**\n   * Optimization option. Prefer loading of leaves first.\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.preferLeaves = defaultValue(options.preferLeaves, false);\n\n  this._tilesLoaded = false;\n  this._initialTilesLoaded = false;\n\n  this._tileDebugLabels = undefined;\n\n  this._classificationType = options.classificationType;\n\n  this._ellipsoid = defaultValue(options.ellipsoid, Ellipsoid.WGS84);\n\n  this._initialClippingPlanesOriginMatrix = Matrix4.IDENTITY; // Computed from the tileset JSON.\n  this._clippingPlanesOriginMatrix = undefined; // Combines the above with any run-time transforms.\n  this._clippingPlanesOriginMatrixDirty = true;\n\n  this._vectorClassificationOnly = defaultValue(\n    options.vectorClassificationOnly,\n    false\n  );\n\n  this._vectorKeepDecodedPositions = defaultValue(\n    options.vectorKeepDecodedPositions,\n    false\n  );\n\n  /**\n   * Preload tiles when <code>tileset.show</code> is <code>false</code>. Loads tiles as if the tileset is visible but does not render them.\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.preloadWhenHidden = defaultValue(options.preloadWhenHidden, false);\n\n  /**\n   * Optimization option. Fetch tiles at the camera's flight destination while the camera is in flight.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.preloadFlightDestinations = defaultValue(\n    options.preloadFlightDestinations,\n    true\n  );\n  this._pass = undefined; // Cesium3DTilePass\n\n  /**\n   * Optimization option. Whether the tileset should refine based on a dynamic screen space error. Tiles that are further\n   * away will be rendered with lower detail than closer tiles. This improves performance by rendering fewer\n   * tiles and making less requests, but may result in a slight drop in visual quality for tiles in the distance.\n   * The algorithm is biased towards \"street views\" where the camera is close to the ground plane of the tileset and looking\n   * at the horizon. In addition results are more accurate for tightly fitting bounding volumes like box and region.\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.dynamicScreenSpaceError = defaultValue(\n    options.dynamicScreenSpaceError,\n    false\n  );\n\n  /**\n   * Optimization option. Prioritize loading tiles in the center of the screen by temporarily raising the\n   * screen space error for tiles around the edge of the screen. Screen space error returns to normal once all\n   * the tiles in the center of the screen as determined by the {@link Cesium3DTileset#foveatedConeSize} are loaded.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.foveatedScreenSpaceError = defaultValue(\n    options.foveatedScreenSpaceError,\n    true\n  );\n  this._foveatedConeSize = defaultValue(options.foveatedConeSize, 0.1);\n  this._foveatedMinimumScreenSpaceErrorRelaxation = defaultValue(\n    options.foveatedMinimumScreenSpaceErrorRelaxation,\n    0.0\n  );\n\n  /**\n   * Gets or sets a callback to control how much to raise the screen space error for tiles outside the foveated cone,\n   * interpolating between {@link Cesium3DTileset#foveatedMinimumScreenSpaceErrorRelaxation} and {@link Cesium3DTileset#maximumScreenSpaceError}.\n   *\n   * @type {Cesium3DTileset.foveatedInterpolationCallback}\n   */\n  this.foveatedInterpolationCallback = defaultValue(\n    options.foveatedInterpolationCallback,\n    CesiumMath.lerp\n  );\n\n  /**\n   * Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control\n   * how long in seconds to wait after the camera stops moving before deferred tiles start loading in.\n   * This time delay prevents requesting tiles around the edges of the screen when the camera is moving.\n   * Setting this to 0.0 will immediately request all tiles in any given view.\n   *\n   * @type {Number}\n   * @default 0.2\n   */\n  this.foveatedTimeDelay = defaultValue(options.foveatedTimeDelay, 0.2);\n\n  /**\n   * A scalar that determines the density used to adjust the dynamic screen space error, similar to {@link Fog}. Increasing this\n   * value has the effect of increasing the maximum screen space error for all tiles, but in a non-linear fashion.\n   * The error starts at 0.0 and increases exponentially until a midpoint is reached, and then approaches 1.0 asymptotically.\n   * This has the effect of keeping high detail in the closer tiles and lower detail in the further tiles, with all tiles\n   * beyond a certain distance all roughly having an error of 1.0.\n   * <p>\n   * The dynamic error is in the range [0.0, 1.0) and is multiplied by <code>dynamicScreenSpaceErrorFactor</code> to produce the\n   * final dynamic error. This dynamic error is then subtracted from the tile's actual screen space error.\n   * </p>\n   * <p>\n   * Increasing <code>dynamicScreenSpaceErrorDensity</code> has the effect of moving the error midpoint closer to the camera.\n   * It is analogous to moving fog closer to the camera.\n   * </p>\n   *\n   * @type {Number}\n   * @default 0.00278\n   */\n  this.dynamicScreenSpaceErrorDensity = 0.00278;\n\n  /**\n   * A factor used to increase the screen space error of tiles for dynamic screen space error. As this value increases less tiles\n   * are requested for rendering and tiles in the distance will have lower detail. If set to zero, the feature will be disabled.\n   *\n   * @type {Number}\n   * @default 4.0\n   */\n  this.dynamicScreenSpaceErrorFactor = 4.0;\n\n  /**\n   * A ratio of the tileset's height at which the density starts to falloff. If the camera is below this height the\n   * full computed density is applied, otherwise the density falls off. This has the effect of higher density at\n   * street level views.\n   * <p>\n   * Valid values are between 0.0 and 1.0.\n   * </p>\n   *\n   * @type {Number}\n   * @default 0.25\n   */\n  this.dynamicScreenSpaceErrorHeightFalloff = 0.25;\n\n  this._dynamicScreenSpaceErrorComputedDensity = 0.0; // Updated based on the camera position and direction\n\n  /**\n   * Determines whether the tileset casts or receives shadows from light sources.\n   * <p>\n   * Enabling shadows has a performance impact. A tileset that casts shadows must be rendered twice, once from the camera and again from the light's point of view.\n   * </p>\n   * <p>\n   * Shadows are rendered only when {@link Viewer#shadows} is <code>true</code>.\n   * </p>\n   *\n   * @type {ShadowMode}\n   * @default ShadowMode.ENABLED\n   */\n  this.shadows = defaultValue(options.shadows, ShadowMode.ENABLED);\n\n  /**\n   * Determines if the tileset will be shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n\n  /**\n   * Defines how per-feature colors set from the Cesium API or declarative styling blend with the source colors from\n   * the original feature, e.g. glTF material or per-point color in the tile.\n   *\n   * @type {Cesium3DTileColorBlendMode}\n   * @default Cesium3DTileColorBlendMode.HIGHLIGHT\n   */\n  this.colorBlendMode = Cesium3DTileColorBlendMode.HIGHLIGHT;\n\n  /**\n   * Defines the value used to linearly interpolate between the source color and feature color when the {@link Cesium3DTileset#colorBlendMode} is <code>MIX</code>.\n   * A value of 0.0 results in the source color while a value of 1.0 results in the feature color, with any value in-between\n   * resulting in a mix of the source color and feature color.\n   *\n   * @type {Number}\n   * @default 0.5\n   */\n  this.colorBlendAmount = 0.5;\n\n  this._pointCloudShading = new PointCloudShading(options.pointCloudShading);\n  this._pointCloudEyeDomeLighting = new PointCloudEyeDomeLighting();\n\n  /**\n   * The event fired to indicate progress of loading new tiles.  This event is fired when a new tile\n   * is requested, when a requested tile is finished downloading, and when a downloaded tile has been\n   * processed and is ready to render.\n   * <p>\n   * The number of pending tile requests, <code>numberOfPendingRequests</code>, and number of tiles\n   * processing, <code>numberOfTilesProcessing</code> are passed to the event listener.\n   * </p>\n   * <p>\n   * This event is fired at the end of the frame after the scene is rendered.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.loadProgress.addEventListener(function(numberOfPendingRequests, numberOfTilesProcessing) {\n   *     if ((numberOfPendingRequests === 0) && (numberOfTilesProcessing === 0)) {\n   *         console.log('Stopped loading');\n   *         return;\n   *     }\n   *\n   *     console.log('Loading: requests: ' + numberOfPendingRequests + ', processing: ' + numberOfTilesProcessing);\n   * });\n   */\n  this.loadProgress = new Event();\n\n  /**\n   * The event fired to indicate that all tiles that meet the screen space error this frame are loaded. The tileset\n   * is completely loaded for this view.\n   * <p>\n   * This event is fired at the end of the frame after the scene is rendered.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.allTilesLoaded.addEventListener(function() {\n   *     console.log('All tiles are loaded');\n   * });\n   *\n   * @see Cesium3DTileset#tilesLoaded\n   */\n  this.allTilesLoaded = new Event();\n\n  /**\n   * The event fired to indicate that all tiles that meet the screen space error this frame are loaded. This event\n   * is fired once when all tiles in the initial view are loaded.\n   * <p>\n   * This event is fired at the end of the frame after the scene is rendered.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.initialTilesLoaded.addEventListener(function() {\n   *     console.log('Initial tiles are loaded');\n   * });\n   *\n   * @see Cesium3DTileset#allTilesLoaded\n   */\n  this.initialTilesLoaded = new Event();\n\n  /**\n   * The event fired to indicate that a tile's content was loaded.\n   * <p>\n   * The loaded {@link Cesium3DTile} is passed to the event listener.\n   * </p>\n   * <p>\n   * This event is fired during the tileset traversal while the frame is being rendered\n   * so that updates to the tile take effect in the same frame.  Do not create or modify\n   * Cesium entities or primitives during the event listener.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.tileLoad.addEventListener(function(tile) {\n   *     console.log('A tile was loaded.');\n   * });\n   */\n  this.tileLoad = new Event();\n\n  /**\n   * The event fired to indicate that a tile's content was unloaded.\n   * <p>\n   * The unloaded {@link Cesium3DTile} is passed to the event listener.\n   * </p>\n   * <p>\n   * This event is fired immediately before the tile's content is unloaded while the frame is being\n   * rendered so that the event listener has access to the tile's content.  Do not create\n   * or modify Cesium entities or primitives during the event listener.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.tileUnload.addEventListener(function(tile) {\n   *     console.log('A tile was unloaded from the cache.');\n   * });\n   *\n   * @see Cesium3DTileset#maximumMemoryUsage\n   * @see Cesium3DTileset#trimLoadedTiles\n   */\n  this.tileUnload = new Event();\n\n  /**\n   * The event fired to indicate that a tile's content failed to load.\n   * <p>\n   * If there are no event listeners, error messages will be logged to the console.\n   * </p>\n   * <p>\n   * The error object passed to the listener contains two properties:\n   * <ul>\n   * <li><code>url</code>: the url of the failed tile.</li>\n   * <li><code>message</code>: the error message.</li>\n   * </ul>\n   * <p>\n   * If multiple contents are present, this event is raised once per inner content with errors.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.tileFailed.addEventListener(function(error) {\n   *     console.log('An error occurred loading tile: ' + error.url);\n   *     console.log('Error: ' + error.message);\n   * });\n   */\n  this.tileFailed = new Event();\n\n  /**\n   * This event fires once for each visible tile in a frame.  This can be used to manually\n   * style a tileset.\n   * <p>\n   * The visible {@link Cesium3DTile} is passed to the event listener.\n   * </p>\n   * <p>\n   * This event is fired during the tileset traversal while the frame is being rendered\n   * so that updates to the tile take effect in the same frame.  Do not create or modify\n   * Cesium entities or primitives during the event listener.\n   * </p>\n   *\n   * @type {Event}\n   * @default new Event()\n   *\n   * @example\n   * tileset.tileVisible.addEventListener(function(tile) {\n   *     if (tile.content instanceof Cesium.Batched3DModel3DTileContent) {\n   *         console.log('A Batched 3D Model tile is visible.');\n   *     }\n   * });\n   *\n   * @example\n   * // Apply a red style and then manually set random colors for every other feature when the tile becomes visible.\n   * tileset.style = new Cesium.Cesium3DTileStyle({\n   *     color : 'color(\"red\")'\n   * });\n   * tileset.tileVisible.addEventListener(function(tile) {\n   *     const content = tile.content;\n   *     const featuresLength = content.featuresLength;\n   *     for (let i = 0; i < featuresLength; i+=2) {\n   *         content.getFeature(i).color = Cesium.Color.fromRandom();\n   *     }\n   * });\n   */\n  this.tileVisible = new Event();\n\n  /**\n   * Optimization option. Determines if level of detail skipping should be applied during the traversal.\n   * <p>\n   * The common strategy for replacement-refinement traversal is to store all levels of the tree in memory and require\n   * all children to be loaded before the parent can refine. With this optimization levels of the tree can be skipped\n   * entirely and children can be rendered alongside their parents. The tileset requires significantly less memory when\n   * using this optimization.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.skipLevelOfDetail = defaultValue(options.skipLevelOfDetail, false);\n  this._skipLevelOfDetail = this.skipLevelOfDetail;\n  this._disableSkipLevelOfDetail = false;\n\n  /**\n   * The screen space error that must be reached before skipping levels of detail.\n   * <p>\n   * Only used when {@link Cesium3DTileset#skipLevelOfDetail} is <code>true</code>.\n   * </p>\n   *\n   * @type {Number}\n   * @default 1024\n   */\n  this.baseScreenSpaceError = defaultValue(options.baseScreenSpaceError, 1024);\n\n  /**\n   * Multiplier defining the minimum screen space error to skip.\n   * For example, if a tile has screen space error of 100, no tiles will be loaded unless they\n   * are leaves or have a screen space error <code><= 100 / skipScreenSpaceErrorFactor</code>.\n   * <p>\n   * Only used when {@link Cesium3DTileset#skipLevelOfDetail} is <code>true</code>.\n   * </p>\n   *\n   * @type {Number}\n   * @default 16\n   */\n  this.skipScreenSpaceErrorFactor = defaultValue(\n    options.skipScreenSpaceErrorFactor,\n    16\n  );\n\n  /**\n   * Constant defining the minimum number of levels to skip when loading tiles. When it is 0, no levels are skipped.\n   * For example, if a tile is level 1, no tiles will be loaded unless they are at level greater than 2.\n   * <p>\n   * Only used when {@link Cesium3DTileset#skipLevelOfDetail} is <code>true</code>.\n   * </p>\n   *\n   * @type {Number}\n   * @default 1\n   */\n  this.skipLevels = defaultValue(options.skipLevels, 1);\n\n  /**\n   * When true, only tiles that meet the maximum screen space error will ever be downloaded.\n   * Skipping factors are ignored and just the desired tiles are loaded.\n   * <p>\n   * Only used when {@link Cesium3DTileset#skipLevelOfDetail} is <code>true</code>.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.immediatelyLoadDesiredLevelOfDetail = defaultValue(\n    options.immediatelyLoadDesiredLevelOfDetail,\n    false\n  );\n\n  /**\n   * Determines whether siblings of visible tiles are always downloaded during traversal.\n   * This may be useful for ensuring that tiles are already available when the viewer turns left/right.\n   * <p>\n   * Only used when {@link Cesium3DTileset#skipLevelOfDetail} is <code>true</code>.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.loadSiblings = defaultValue(options.loadSiblings, false);\n\n  this._clippingPlanes = undefined;\n  this.clippingPlanes = options.clippingPlanes;\n\n  if (defined(options.imageBasedLighting)) {\n    this._imageBasedLighting = options.imageBasedLighting;\n    this._shouldDestroyImageBasedLighting = false;\n  } else {\n    this._imageBasedLighting = new ImageBasedLighting();\n    this._shouldDestroyImageBasedLighting = true;\n  }\n\n  /**\n   * The light color when shading models. When <code>undefined</code> the scene's light color is used instead.\n   * <p>\n   * For example, disabling additional light sources by setting\n   * <code>tileset.imageBasedLighting.imageBasedLightingFactor = new Cartesian2(0.0, 0.0)</code>\n   * will make the tileset much darker. Here, increasing the intensity of the light source will make the tileset brighter.\n   * </p>\n   *\n   * @type {Cartesian3}\n   * @default undefined\n   */\n  this.lightColor = options.lightColor;\n\n  /**\n   * Whether to cull back-facing geometry. When true, back face culling is determined\n   * by the glTF material's doubleSided property; when false, back face culling is disabled.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.backFaceCulling = defaultValue(options.backFaceCulling, true);\n\n  /**\n   * Whether to display the outline for models using the\n   * {@link https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/CESIUM_primitive_outline|CESIUM_primitive_outline} extension.\n   * When true, outlines are displayed. When false, outlines are not displayed.\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  this.showOutline = defaultValue(options.showOutline, true);\n\n  /**\n   * The {@link SplitDirection} to apply to this tileset.\n   *\n   * @type {SplitDirection}\n   * @default {@link SplitDirection.NONE}\n   */\n  this.splitDirection = defaultValue(\n    options.splitDirection,\n    SplitDirection.NONE\n  );\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * Determines if only the tiles from last frame should be used for rendering.  This\n   * effectively \"freezes\" the tileset to the previous frame so it is possible to zoom\n   * out and see what was rendered.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugFreezeFrame = defaultValue(options.debugFreezeFrame, false);\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, assigns a random color to each tile.  This is useful for visualizing\n   * what features belong to what tiles, especially with additive refinement where features\n   * from parent tiles may be interleaved with features from child tiles.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugColorizeTiles = defaultValue(options.debugColorizeTiles, false);\n\n  this._enableDebugWireframe = defaultValue(\n    options.enableDebugWireframe,\n    false\n  );\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, renders each tile's content as a wireframe.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugWireframe = defaultValue(options.debugWireframe, false);\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, renders the bounding volume for each visible tile.  The bounding volume is\n   * white if the tile has a content bounding volume or is empty; otherwise, it is red.  Tiles that don't meet the\n   * screen space error and are still refining to their descendants are yellow.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowBoundingVolume = defaultValue(\n    options.debugShowBoundingVolume,\n    false\n  );\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, renders the bounding volume for each visible tile's content. The bounding volume is\n   * blue if the tile has a content bounding volume; otherwise it is red.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowContentBoundingVolume = defaultValue(\n    options.debugShowContentBoundingVolume,\n    false\n  );\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, renders the viewer request volume for each tile.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowViewerRequestVolume = defaultValue(\n    options.debugShowViewerRequestVolume,\n    false\n  );\n\n  this._tileDebugLabels = undefined;\n  this.debugPickedTileLabelOnly = false;\n  this.debugPickedTile = undefined;\n  this.debugPickPosition = undefined;\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, draws labels to indicate the geometric error of each tile.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowGeometricError = defaultValue(\n    options.debugShowGeometricError,\n    false\n  );\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, draws labels to indicate the number of commands, points, triangles and features of each tile.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowRenderingStatistics = defaultValue(\n    options.debugShowRenderingStatistics,\n    false\n  );\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, draws labels to indicate the geometry and texture memory usage of each tile.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowMemoryUsage = defaultValue(options.debugShowMemoryUsage, false);\n\n  /**\n   * This property is for debugging only; it is not optimized for production use.\n   * <p>\n   * When true, draws labels to indicate the url of each tile.\n   * </p>\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  this.debugShowUrl = defaultValue(options.debugShowUrl, false);\n\n  /**\n   * Function for examining vector lines as they are being streamed.\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @type {Function}\n   */\n  this.examineVectorLinesFunction = undefined;\n\n  // this is the underlying Cesium3DTileMetadata object, whether it came from\n  // the 3DTILES_metadata extension or a 3D Tiles 1.1 tileset JSON. Getters\n  // like tileset.metadata and tileset.schema will delegate to this object.\n  this._metadataExtension = undefined;\n\n  this._customShader = options.customShader;\n\n  /**\n   * If true, {@link ModelExperimental} will be used instead of {@link Model}\n   * for each tile with a glTF or 3D Tiles 1.0 content (where applicable).\n   * <p>\n   * The value defaults to {@link ExperimentalFeatures.enableModelExperimental}.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   * @type {Boolean}\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  this.enableModelExperimental = defaultValue(\n    options.enableModelExperimental,\n    ExperimentalFeatures.enableModelExperimental\n  );\n\n  let featureIdLabel = defaultValue(options.featureIdLabel, \"featureId_0\");\n  if (typeof featureIdLabel === \"number\") {\n    featureIdLabel = `featureId_${featureIdLabel}`;\n  }\n  this._featureIdLabel = featureIdLabel;\n\n  let instanceFeatureIdLabel = defaultValue(\n    options.instanceFeatureIdLabel,\n    \"instanceFeatureId_0\"\n  );\n  if (typeof instanceFeatureIdLabel === \"number\") {\n    instanceFeatureIdLabel = `instanceFeatureId_${instanceFeatureIdLabel}`;\n  }\n  this._instanceFeatureIdLabel = instanceFeatureIdLabel;\n\n  this._schemaLoader = undefined;\n\n  const that = this;\n  let resource;\n  this._readyPromise = Promise.resolve(options.url)\n    .then(function (url) {\n      let basePath;\n      resource = Resource.createIfNeeded(url);\n      that._resource = resource;\n\n      // ion resources have a credits property we can use for additional attribution.\n      that._credits = resource.credits;\n\n      if (resource.extension === \"json\") {\n        basePath = resource.getBaseUri(true);\n      } else if (resource.isDataUri) {\n        basePath = \"\";\n      }\n\n      that._url = resource.url;\n      that._basePath = basePath;\n\n      return Cesium3DTileset.loadJson(resource);\n    })\n    .then(function (tilesetJson) {\n      if (that.isDestroyed()) {\n        return;\n      }\n\n      // This needs to be called before loadTileset() so tile metadata\n      // can be initialized synchronously in the Cesium3DTile constructor\n      return processMetadataExtension(that, tilesetJson);\n    })\n    .then(function (tilesetJson) {\n      if (that.isDestroyed()) {\n        return;\n      }\n\n      that._root = that.loadTileset(resource, tilesetJson);\n      const gltfUpAxis = defined(tilesetJson.asset.gltfUpAxis)\n        ? Axis.fromName(tilesetJson.asset.gltfUpAxis)\n        : Axis.Y;\n      const asset = tilesetJson.asset;\n      that._asset = asset;\n      that._properties = tilesetJson.properties;\n      that._geometricError = tilesetJson.geometricError;\n      that._extensionsUsed = tilesetJson.extensionsUsed;\n      that._extensions = tilesetJson.extensions;\n      that._gltfUpAxis = gltfUpAxis;\n      that._extras = tilesetJson.extras;\n\n      const extras = asset.extras;\n      if (\n        defined(extras) &&\n        defined(extras.cesium) &&\n        defined(extras.cesium.credits)\n      ) {\n        const extraCredits = extras.cesium.credits;\n        let credits = that._credits;\n        if (!defined(credits)) {\n          credits = [];\n          that._credits = credits;\n        }\n        for (let i = 0; i < extraCredits.length; ++i) {\n          const credit = extraCredits[i];\n          credits.push(new Credit(credit.html, that._showCreditsOnScreen));\n        }\n      }\n\n      // Save the original, untransformed bounding volume position so we can apply\n      // the tile transform and model matrix at run time\n      const boundingVolume = that._root.createBoundingVolume(\n        tilesetJson.root.boundingVolume,\n        Matrix4.IDENTITY\n      );\n      const clippingPlanesOrigin = boundingVolume.boundingSphere.center;\n      // If this origin is above the surface of the earth\n      // we want to apply an ENU orientation as our best guess of orientation.\n      // Otherwise, we assume it gets its position/orientation completely from the\n      // root tile transform and the tileset's model matrix\n      const originCartographic = that._ellipsoid.cartesianToCartographic(\n        clippingPlanesOrigin\n      );\n      if (\n        defined(originCartographic) &&\n        originCartographic.height >\n          ApproximateTerrainHeights._defaultMinTerrainHeight\n      ) {\n        that._initialClippingPlanesOriginMatrix = Transforms.eastNorthUpToFixedFrame(\n          clippingPlanesOrigin\n        );\n      }\n      that._clippingPlanesOriginMatrix = Matrix4.clone(\n        that._initialClippingPlanesOriginMatrix\n      );\n\n      return that;\n    });\n}\n\nObject.defineProperties(Cesium3DTileset.prototype, {\n  /**\n   * NOTE: This getter exists so that `Picking.js` can differentiate between\n   *       PrimitiveCollection and Cesium3DTileset objects without inflating\n   *       the size of the module via `instanceof Cesium3DTileset`\n   * @private\n   */\n  isCesium3DTileset: {\n    get: function () {\n      return true;\n    },\n  },\n\n  /**\n   * Gets the tileset's asset object property, which contains metadata about the tileset.\n   * <p>\n   * See the {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification#reference-asset|asset schema reference}\n   * in the 3D Tiles spec for the full set of properties.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @exception {DeveloperError} The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\n   */\n  asset: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this.ready) {\n        throw new DeveloperError(\n          \"The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._asset;\n    },\n  },\n\n  /**\n   * Gets the tileset's extensions object property.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @exception {DeveloperError} The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\n   */\n  extensions: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this.ready) {\n        throw new DeveloperError(\n          \"The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._extensions;\n    },\n  },\n\n  /**\n   * The {@link ClippingPlaneCollection} used to selectively disable rendering the tileset.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {ClippingPlaneCollection}\n   */\n  clippingPlanes: {\n    get: function () {\n      return this._clippingPlanes;\n    },\n    set: function (value) {\n      ClippingPlaneCollection.setOwner(value, this, \"_clippingPlanes\");\n    },\n  },\n\n  /**\n   * Gets the tileset's properties dictionary object, which contains metadata about per-feature properties.\n   * <p>\n   * See the {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification#reference-properties|properties schema reference}\n   * in the 3D Tiles spec for the full set of properties.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @exception {DeveloperError} The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\n   *\n   * @example\n   * console.log('Maximum building height: ' + tileset.properties.height.maximum);\n   * console.log('Minimum building height: ' + tileset.properties.height.minimum);\n   *\n   * @see Cesium3DTileFeature#getProperty\n   * @see Cesium3DTileFeature#setProperty\n   */\n  properties: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this.ready) {\n        throw new DeveloperError(\n          \"The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._properties;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the tileset's root tile is loaded and the tileset is ready to render.\n   * This is set to <code>true</code> right before {@link Cesium3DTileset#readyPromise} is resolved.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  ready: {\n    get: function () {\n      return defined(this._root);\n    },\n  },\n\n  /**\n   * Gets the promise that will be resolved when the tileset's root tile is loaded and the tileset is ready to render.\n   * <p>\n   * This promise is resolved at the end of the frame before the first frame the tileset is rendered in.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Promise.<Cesium3DTileset>}\n   * @readonly\n   *\n   * @example\n   * tileset.readyPromise.then(function(tileset) {\n   *     // tile.properties is not defined until readyPromise resolves.\n   *     const properties = tileset.properties;\n   *     if (Cesium.defined(properties)) {\n   *         for (const name in properties) {\n   *             console.log(properties[name]);\n   *         }\n   *     }\n   * });\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise;\n    },\n  },\n\n  /**\n   * When <code>true</code>, all tiles that meet the screen space error this frame are loaded. The tileset is\n   * completely loaded for this view.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   *\n   * @see Cesium3DTileset#allTilesLoaded\n   */\n  tilesLoaded: {\n    get: function () {\n      return this._tilesLoaded;\n    },\n  },\n\n  /**\n   * The resource used to fetch the tileset JSON file\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Resource}\n   * @readonly\n   */\n  resource: {\n    get: function () {\n      return this._resource;\n    },\n  },\n\n  /**\n   * The base path that non-absolute paths in tileset JSON file are relative to.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {String}\n   * @readonly\n   * @deprecated\n   */\n  basePath: {\n    get: function () {\n      deprecationWarning(\n        \"Cesium3DTileset.basePath\",\n        \"Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead.\"\n      );\n      return this._basePath;\n    },\n  },\n\n  /**\n   * The style, defined using the\n   * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language},\n   * applied to each feature in the tileset.\n   * <p>\n   * Assign <code>undefined</code> to remove the style, which will restore the visual\n   * appearance of the tileset to its default when no style was applied.\n   * </p>\n   * <p>\n   * The style is applied to a tile before the {@link Cesium3DTileset#tileVisible}\n   * event is raised, so code in <code>tileVisible</code> can manually set a feature's\n   * properties (e.g. color and show) after the style is applied. When\n   * a new style is assigned any manually set properties are overwritten.\n   * </p>\n   * <p>\n   * Use an always \"true\" condition to specify the Color for all objects that are not\n   * overridden by pre-existing conditions. Otherwise, the default color Cesium.Color.White\n   * will be used. Similarly, use an always \"true\" condition to specify the show property\n   * for all objects that are not overridden by pre-existing conditions. Otherwise, the\n   * default show value true will be used.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Cesium3DTileStyle|undefined}\n   *\n   * @default undefined\n   *\n   * @example\n   * tileset.style = new Cesium.Cesium3DTileStyle({\n   *    color : {\n   *        conditions : [\n   *            ['${Height} >= 100', 'color(\"purple\", 0.5)'],\n   *            ['${Height} >= 50', 'color(\"red\")'],\n   *            ['true', 'color(\"blue\")']\n   *        ]\n   *    },\n   *    show : '${Height} > 0',\n   *    meta : {\n   *        description : '\"Building id ${id} has height ${Height}.\"'\n   *    }\n   * });\n   *\n   * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}\n   */\n  style: {\n    get: function () {\n      return this._styleEngine.style;\n    },\n    set: function (value) {\n      this._styleEngine.style = value;\n    },\n  },\n\n  /**\n   * A custom shader to apply to all tiles in the tileset. Only used for\n   * contents that use {@link ModelExperimental}. Using custom shaders with a\n   * {@link Cesium3DTileStyle} may lead to undefined behavior.\n   * <p>\n   * To enable {@link ModelExperimental}, set {@link ExperimentalFeatures.enableModelExperimental} or tileset.enableModelExperimental to <code>true</code>.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {CustomShader|undefined}\n   *\n   * @default undefined\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  customShader: {\n    get: function () {\n      return this._customShader;\n    },\n    set: function (value) {\n      this._customShader = value;\n    },\n  },\n\n  /**\n   * The tileset's schema, groups, tileset metadata and other details from the\n   * 3DTILES_metadata extension or a 3D Tiles 1.1 tileset JSON. This getter is\n   * for internal use by other classes.\n   *\n   * @memberof Cesium3DTileset.prototype\n   * @type {Cesium3DTilesetMetadata}\n   * @private\n   * @readonly\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  metadataExtension: {\n    get: function () {\n      return this._metadataExtension;\n    },\n  },\n\n  /**\n   * The metadata properties attached to the tileset as a whole.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {TilesetMetadata}\n   * @private\n   * @readonly\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  metadata: {\n    get: function () {\n      if (defined(this._metadataExtension)) {\n        return this._metadataExtension.tileset;\n      }\n\n      return undefined;\n    },\n  },\n\n  /**\n   * The metadata schema used in this tileset. Shorthand for\n   * <code>tileset.metadataExtension.schema</code>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {MetadataSchema}\n   * @private\n   * @readonly\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  schema: {\n    get: function () {\n      if (defined(this._metadataExtension)) {\n        return this._metadataExtension.schema;\n      }\n\n      return undefined;\n    },\n  },\n\n  /**\n   * The maximum screen space error used to drive level of detail refinement.  This value helps determine when a tile\n   * refines to its descendants, and therefore plays a major role in balancing performance with visual quality.\n   * <p>\n   * A tile's screen space error is roughly equivalent to the number of pixels wide that would be drawn if a sphere with a\n   * radius equal to the tile's <b>geometric error</b> were rendered at the tile's position. If this value exceeds\n   * <code>maximumScreenSpaceError</code> the tile refines to its descendants.\n   * </p>\n   * <p>\n   * Depending on the tileset, <code>maximumScreenSpaceError</code> may need to be tweaked to achieve the right balance.\n   * Higher values provide better performance but lower visual quality.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Number}\n   * @default 16\n   *\n   * @exception {DeveloperError} <code>maximumScreenSpaceError</code> must be greater than or equal to zero.\n   */\n  maximumScreenSpaceError: {\n    get: function () {\n      return this._maximumScreenSpaceError;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number.greaterThanOrEquals(\n        \"maximumScreenSpaceError\",\n        value,\n        0\n      );\n      //>>includeEnd('debug');\n\n      this._maximumScreenSpaceError = value;\n    },\n  },\n\n  /**\n   * The maximum amount of GPU memory (in MB) that may be used to cache tiles. This value is estimated from\n   * geometry, textures, and batch table textures of loaded tiles. For point clouds, this value also\n   * includes per-point metadata.\n   * <p>\n   * Tiles not in view are unloaded to enforce this.\n   * </p>\n   * <p>\n   * If decreasing this value results in unloading tiles, the tiles are unloaded the next frame.\n   * </p>\n   * <p>\n   * If tiles sized more than <code>maximumMemoryUsage</code> are needed\n   * to meet the desired screen space error, determined by {@link Cesium3DTileset#maximumScreenSpaceError},\n   * for the current view, then the memory usage of the tiles loaded will exceed\n   * <code>maximumMemoryUsage</code>.  For example, if the maximum is 256 MB, but\n   * 300 MB of tiles are needed to meet the screen space error, then 300 MB of tiles may be loaded.  When\n   * these tiles go out of view, they will be unloaded.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Number}\n   * @default 512\n   *\n   * @exception {DeveloperError} <code>maximumMemoryUsage</code> must be greater than or equal to zero.\n   * @see Cesium3DTileset#totalMemoryUsageInBytes\n   */\n  maximumMemoryUsage: {\n    get: function () {\n      return this._maximumMemoryUsage;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number.greaterThanOrEquals(\"value\", value, 0);\n      //>>includeEnd('debug');\n\n      this._maximumMemoryUsage = value;\n    },\n  },\n\n  /**\n   * Options for controlling point size based on geometric error and eye dome lighting.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {PointCloudShading}\n   */\n  pointCloudShading: {\n    get: function () {\n      return this._pointCloudShading;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.defined(\"pointCloudShading\", value);\n      //>>includeEnd('debug');\n      this._pointCloudShading = value;\n    },\n  },\n\n  /**\n   * The root tile.\n   *\n   * @memberOf Cesium3DTileset.prototype\n   *\n   * @type {Cesium3DTile}\n   * @readonly\n   *\n   * @exception {DeveloperError} The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\n   */\n  root: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this.ready) {\n        throw new DeveloperError(\n          \"The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._root;\n    },\n  },\n\n  /**\n   * The tileset's bounding sphere.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {BoundingSphere}\n   * @readonly\n   *\n   * @exception {DeveloperError} The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\n   *\n   * @example\n   * const tileset = viewer.scene.primitives.add(new Cesium.Cesium3DTileset({\n   *     url : 'http://localhost:8002/tilesets/Seattle/tileset.json'\n   * }));\n   *\n   * tileset.readyPromise.then(function(tileset) {\n   *     // Set the camera to view the newly added tileset\n   *     viewer.camera.viewBoundingSphere(tileset.boundingSphere, new Cesium.HeadingPitchRange(0, -0.5, 0));\n   * });\n   */\n  boundingSphere: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this.ready) {\n        throw new DeveloperError(\n          \"The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      this._root.updateTransform(this._modelMatrix);\n      return this._root.boundingSphere;\n    },\n  },\n\n  /**\n   * A 4x4 transformation matrix that transforms the entire tileset.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Matrix4}\n   * @default Matrix4.IDENTITY\n   *\n   * @example\n   * // Adjust a tileset's height from the globe's surface.\n   * const heightOffset = 20.0;\n   * const boundingSphere = tileset.boundingSphere;\n   * const cartographic = Cesium.Cartographic.fromCartesian(boundingSphere.center);\n   * const surface = Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, 0.0);\n   * const offset = Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, heightOffset);\n   * const translation = Cesium.Cartesian3.subtract(offset, surface, new Cesium.Cartesian3());\n   * tileset.modelMatrix = Cesium.Matrix4.fromTranslation(translation);\n   */\n  modelMatrix: {\n    get: function () {\n      return this._modelMatrix;\n    },\n    set: function (value) {\n      this._modelMatrix = Matrix4.clone(value, this._modelMatrix);\n    },\n  },\n\n  /**\n   * Returns the time, in milliseconds, since the tileset was loaded and first updated.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Number}\n   * @readonly\n   */\n  timeSinceLoad: {\n    get: function () {\n      return this._timeSinceLoad;\n    },\n  },\n\n  /**\n   * The total amount of GPU memory in bytes used by the tileset. This value is estimated from\n   * geometry, texture, and batch table textures of loaded tiles. For point clouds, this value also\n   * includes per-point metadata.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Number}\n   * @readonly\n   *\n   * @see Cesium3DTileset#maximumMemoryUsage\n   */\n  totalMemoryUsageInBytes: {\n    get: function () {\n      const statistics = this._statistics;\n      return (\n        statistics.texturesByteLength +\n        statistics.geometryByteLength +\n        statistics.batchTableByteLength\n      );\n    },\n  },\n\n  /**\n   * @private\n   */\n  clippingPlanesOriginMatrix: {\n    get: function () {\n      if (!defined(this._clippingPlanesOriginMatrix)) {\n        return Matrix4.IDENTITY;\n      }\n\n      if (this._clippingPlanesOriginMatrixDirty) {\n        Matrix4.multiply(\n          this.root.computedTransform,\n          this._initialClippingPlanesOriginMatrix,\n          this._clippingPlanesOriginMatrix\n        );\n        this._clippingPlanesOriginMatrixDirty = false;\n      }\n\n      return this._clippingPlanesOriginMatrix;\n    },\n  },\n\n  /**\n   * @private\n   */\n  styleEngine: {\n    get: function () {\n      return this._styleEngine;\n    },\n  },\n\n  /**\n   * @private\n   */\n  statistics: {\n    get: function () {\n      return this._statistics;\n    },\n  },\n\n  /**\n   * Determines whether terrain, 3D Tiles or both will be classified by this tileset.\n   * <p>\n   * This option is only applied to tilesets containing batched 3D models, geometry data, or vector data. Even when undefined, vector data and geometry data\n   * must render as classifications and will default to rendering on both terrain and other 3D Tiles tilesets.\n   * </p>\n   * <p>\n   * When enabled for batched 3D model tilesets, there are a few requirements/limitations on the glTF:\n   * <ul>\n   *     <li>POSITION and _BATCHID semantics are required.</li>\n   *     <li>All indices with the same batch id must occupy contiguous sections of the index buffer.</li>\n   *     <li>All shaders and techniques are ignored. The generated shader simply multiplies the position by the model-view-projection matrix.</li>\n   *     <li>The only supported extensions are CESIUM_RTC and WEB3D_quantized_attributes.</li>\n   *     <li>Only one node is supported.</li>\n   *     <li>Only one mesh per node is supported.</li>\n   *     <li>Only one primitive per mesh is supported.</li>\n   * </ul>\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {ClassificationType}\n   * @default undefined\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   * @readonly\n   */\n  classificationType: {\n    get: function () {\n      return this._classificationType;\n    },\n  },\n\n  /**\n   * Gets an ellipsoid describing the shape of the globe.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Ellipsoid}\n   * @readonly\n   */\n  ellipsoid: {\n    get: function () {\n      return this._ellipsoid;\n    },\n  },\n\n  /**\n   * Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control the cone size that determines which tiles are deferred.\n   * Tiles that are inside this cone are loaded immediately. Tiles outside the cone are potentially deferred based on how far outside the cone they are and {@link Cesium3DTileset#foveatedInterpolationCallback} and {@link Cesium3DTileset#foveatedMinimumScreenSpaceErrorRelaxation}.\n   * Setting this to 0.0 means the cone will be the line formed by the camera position and its view direction. Setting this to 1.0 means the cone encompasses the entire field of view of the camera, essentially disabling the effect.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Number}\n   * @default 0.3\n   */\n  foveatedConeSize: {\n    get: function () {\n      return this._foveatedConeSize;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number.greaterThanOrEquals(\"foveatedConeSize\", value, 0.0);\n      Check.typeOf.number.lessThanOrEquals(\"foveatedConeSize\", value, 1.0);\n      //>>includeEnd('debug');\n\n      this._foveatedConeSize = value;\n    },\n  },\n\n  /**\n   * Optimization option. Used when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control the starting screen space error relaxation for tiles outside the foveated cone.\n   * The screen space error will be raised starting with this value up to {@link Cesium3DTileset#maximumScreenSpaceError} based on the provided {@link Cesium3DTileset#foveatedInterpolationCallback}.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  foveatedMinimumScreenSpaceErrorRelaxation: {\n    get: function () {\n      return this._foveatedMinimumScreenSpaceErrorRelaxation;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number.greaterThanOrEquals(\n        \"foveatedMinimumScreenSpaceErrorRelaxation\",\n        value,\n        0.0\n      );\n      Check.typeOf.number.lessThanOrEquals(\n        \"foveatedMinimumScreenSpaceErrorRelaxation\",\n        value,\n        this.maximumScreenSpaceError\n      );\n      //>>includeEnd('debug');\n\n      this._foveatedMinimumScreenSpaceErrorRelaxation = value;\n    },\n  },\n\n  /**\n   * Returns the <code>extras</code> property at the top-level of the tileset JSON, which contains application specific metadata.\n   * Returns <code>undefined</code> if <code>extras</code> does not exist.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @exception {DeveloperError} The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\n   *\n   * @type {*}\n   * @readonly\n   *\n   * @see {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification#specifying-extensions-and-application-specific-extras|Extras in the 3D Tiles specification.}\n   */\n  extras: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (!this.ready) {\n        throw new DeveloperError(\n          \"The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      return this._extras;\n    },\n  },\n\n  /**\n   * The properties for managing image-based lighting on this tileset.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {ImageBasedLighting}\n   */\n  imageBasedLighting: {\n    get: function () {\n      return this._imageBasedLighting;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.object(\"imageBasedLighting\", this._imageBasedLighting);\n      //>>includeEnd('debug');\n      if (value !== this._imageBasedLighting) {\n        if (\n          this._shouldDestroyImageBasedLighting &&\n          !this._imageBasedLighting.isDestroyed()\n        ) {\n          this._imageBasedLighting.destroy();\n        }\n        this._imageBasedLighting = value;\n        this._shouldDestroyImageBasedLighting = false;\n      }\n    },\n  },\n\n  /**\n   * Indicates that only the tileset's vector tiles should be used for classification.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  vectorClassificationOnly: {\n    get: function () {\n      return this._vectorClassificationOnly;\n    },\n  },\n\n  /**\n   * Whether vector tiles should keep decoded positions in memory.\n   * This is used with {@link Cesium3DTileFeature.getPolylinePositions}.\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  vectorKeepDecodedPositions: {\n    get: function () {\n      return this._vectorKeepDecodedPositions;\n    },\n  },\n\n  /**\n   * Determines whether the credits of the tileset will be displayed on the screen\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {Boolean}\n   * @default false\n   */\n  showCreditsOnScreen: {\n    get: function () {\n      return this._showCreditsOnScreen;\n    },\n    set: function (value) {\n      this._showCreditsOnScreen = value;\n    },\n  },\n\n  /**\n   * Label of the feature ID set to use for picking and styling.\n   * <p>\n   * For EXT_mesh_features, this is the feature ID's label property, or\n   * \"featureId_N\" (where N is the index in the featureIds array) when not\n   * specified. EXT_feature_metadata did not have a label field, so such\n   * feature ID sets are always labeled \"featureId_N\" where N is the index in\n   * the list of all feature Ids, where feature ID attributes are listed before\n   * feature ID textures.\n   * </p>\n   * <p>\n   * If featureIdLabel is set to an integer N, it is converted to\n   * the string \"featureId_N\" automatically. If both per-primitive and\n   * per-instance feature IDs are present, the instance feature IDs take\n   * priority.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {String}\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  featureIdLabel: {\n    get: function () {\n      return this._featureIdLabel;\n    },\n    set: function (value) {\n      // indices get converted into featureId_N\n      if (typeof value === \"number\") {\n        value = `featureId_${value}`;\n      }\n\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.string(\"value\", value);\n      //>>includeEnd('debug');\n\n      this._featureIdLabel = value;\n    },\n  },\n\n  /**\n   * Label of the instance feature ID set used for picking and styling.\n   * <p>\n   * If instanceFeatureIdLabel is set to an integer N, it is converted to\n   * the string \"instanceFeatureId_N\" automatically.\n   * If both per-primitive and per-instance feature IDs are present, the\n   * instance feature IDs take priority.\n   * </p>\n   *\n   * @memberof Cesium3DTileset.prototype\n   *\n   * @type {String}\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  instanceFeatureIdLabel: {\n    get: function () {\n      return this._instanceFeatureIdLabel;\n    },\n    set: function (value) {\n      // indices get converted into instanceFeatureId_N\n      if (typeof value === \"number\") {\n        value = `instanceFeatureId_${value}`;\n      }\n\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.string(\"value\", value);\n      //>>includeEnd('debug');\n\n      this._instanceFeatureIdLabel = value;\n    },\n  },\n});\n\n/**\n * Provides a hook to override the method used to request the tileset json\n * useful when fetching tilesets from remote servers\n * @param {Resource|String} tilesetUrl The url of the json file to be fetched\n * @returns {Promise.<Object>} A promise that resolves with the fetched json data\n */\nCesium3DTileset.loadJson = function (tilesetUrl) {\n  const resource = Resource.createIfNeeded(tilesetUrl);\n  return resource.fetchJson();\n};\n\n/**\n * Marks the tileset's {@link Cesium3DTileset#style} as dirty, which forces all\n * features to re-evaluate the style in the next frame each is visible.\n */\nCesium3DTileset.prototype.makeStyleDirty = function () {\n  this._styleEngine.makeDirty();\n};\n\n/**\n * Loads the main tileset JSON file or a tileset JSON file referenced from a tile.\n *\n * @private\n */\nCesium3DTileset.prototype.loadTileset = function (\n  resource,\n  tilesetJson,\n  parentTile\n) {\n  const asset = tilesetJson.asset;\n  if (!defined(asset)) {\n    throw new RuntimeError(\"Tileset must have an asset property.\");\n  }\n  if (\n    asset.version !== \"0.0\" &&\n    asset.version !== \"1.0\" &&\n    asset.version !== \"1.1\"\n  ) {\n    throw new RuntimeError(\n      \"The tileset must be 3D Tiles version 0.0, 1.0, or 1.1\"\n    );\n  }\n\n  if (defined(tilesetJson.extensionsRequired)) {\n    Cesium3DTileset.checkSupportedExtensions(tilesetJson.extensionsRequired);\n  }\n\n  const statistics = this._statistics;\n\n  const tilesetVersion = asset.tilesetVersion;\n  if (defined(tilesetVersion)) {\n    // Append the tileset version to the resource\n    this._basePath += `?v=${tilesetVersion}`;\n    resource = resource.clone();\n    resource.setQueryParameters({ v: tilesetVersion });\n  }\n\n  // A tileset JSON file referenced from a tile may exist in a different directory than the root tileset.\n  // Get the basePath relative to the external tileset.\n  const rootTile = makeTile(this, resource, tilesetJson.root, parentTile);\n\n  // If there is a parentTile, add the root of the currently loading tileset\n  // to parentTile's children, and update its _depth.\n  if (defined(parentTile)) {\n    parentTile.children.push(rootTile);\n    rootTile._depth = parentTile._depth + 1;\n  }\n\n  const stack = [];\n  stack.push(rootTile);\n\n  while (stack.length > 0) {\n    const tile = stack.pop();\n    ++statistics.numberOfTilesTotal;\n    this._allTilesAdditive =\n      this._allTilesAdditive && tile.refine === Cesium3DTileRefine.ADD;\n    const children = tile._header.children;\n    if (defined(children)) {\n      const length = children.length;\n      for (let i = 0; i < length; ++i) {\n        const childHeader = children[i];\n        const childTile = makeTile(this, resource, childHeader, tile);\n        tile.children.push(childTile);\n        childTile._depth = tile._depth + 1;\n        stack.push(childTile);\n      }\n    }\n\n    if (this._cullWithChildrenBounds) {\n      Cesium3DTileOptimizations.checkChildrenWithinParent(tile);\n    }\n  }\n\n  return rootTile;\n};\n\n/**\n * Make a {@link Cesium3DTile} for a specific tile. If the tile's header has implicit\n * tiling (3D Tiles 1.1) or uses the <code>3DTILES_implicit_tiling</code> extension,\n * it creates a placeholder tile instead for lazy evaluation of the implicit tileset.\n *\n * @param {Cesium3DTileset} tileset The tileset\n * @param {Resource} baseResource The base resource for the tileset\n * @param {Object} tileHeader The JSON header for the tile\n * @param {Cesium3DTile} [parentTile] The parent tile of the new tile\n * @returns {Cesium3DTile} The newly created tile\n *\n * @private\n */\nfunction makeTile(tileset, baseResource, tileHeader, parentTile) {\n  const hasImplicitTiling =\n    defined(tileHeader.implicitTiling) ||\n    hasExtension(tileHeader, \"3DTILES_implicit_tiling\");\n\n  if (hasImplicitTiling) {\n    const metadataSchema = tileset.schema;\n\n    const implicitTileset = new ImplicitTileset(\n      baseResource,\n      tileHeader,\n      metadataSchema\n    );\n    const rootCoordinates = new ImplicitTileCoordinates({\n      subdivisionScheme: implicitTileset.subdivisionScheme,\n      subtreeLevels: implicitTileset.subtreeLevels,\n      level: 0,\n      x: 0,\n      y: 0,\n      // The constructor will only use this for octrees.\n      z: 0,\n    });\n\n    // Create a placeholder Cesium3DTile that has an ImplicitTileset\n    // object and whose content will resolve to an Implicit3DTileContent\n    const contentUri = implicitTileset.subtreeUriTemplate.getDerivedResource({\n      templateValues: rootCoordinates.getTemplateValues(),\n    }).url;\n\n    const deepCopy = true;\n    const tileJson = clone(tileHeader, deepCopy);\n    // Replace contents with the subtree\n    tileJson.contents = [\n      {\n        uri: contentUri,\n      },\n    ];\n\n    delete tileJson.content;\n\n    // The placeholder tile does not have any extensions. If there are any\n    // extensions beyond 3DTILES_implicit_tiling, Implicit3DTileContent will\n    // copy them to the transcoded tiles.\n    delete tileJson.extensions;\n\n    const tile = new Cesium3DTile(tileset, baseResource, tileJson, parentTile);\n    tile.implicitTileset = implicitTileset;\n    tile.implicitCoordinates = rootCoordinates;\n    return tile;\n  }\n\n  return new Cesium3DTile(tileset, baseResource, tileHeader, parentTile);\n}\n\n/**\n * If tileset metadata is present, initialize the {@link Cesium3DTilesetMetadata}\n * instance. This is asynchronous since metadata schemas may be external.\n *\n * @param {Cesium3DTileset} tileset The tileset\n * @param {Object} tilesetJson The tileset JSON\n * @return {Promise<Object>} A promise that resolves to tilesetJson for chaining.\n * @private\n */\nfunction processMetadataExtension(tileset, tilesetJson) {\n  const metadataJson = hasExtension(tilesetJson, \"3DTILES_metadata\")\n    ? tilesetJson.extensions[\"3DTILES_metadata\"]\n    : tilesetJson;\n\n  let schemaLoader;\n  if (defined(metadataJson.schemaUri)) {\n    const resource = tileset._resource.getDerivedResource({\n      url: metadataJson.schemaUri,\n    });\n    schemaLoader = ResourceCache.loadSchema({\n      resource: resource,\n    });\n  } else if (defined(metadataJson.schema)) {\n    schemaLoader = ResourceCache.loadSchema({\n      schema: metadataJson.schema,\n    });\n  } else {\n    return Promise.resolve(tilesetJson);\n  }\n\n  tileset._schemaLoader = schemaLoader;\n\n  return schemaLoader.promise.then(function (schemaLoader) {\n    tileset._metadataExtension = new Cesium3DTilesetMetadata({\n      schema: schemaLoader.schema,\n      metadataJson: metadataJson,\n    });\n\n    return tilesetJson;\n  });\n}\n\nconst scratchPositionNormal = new Cartesian3();\nconst scratchCartographic = new Cartographic();\nconst scratchMatrix = new Matrix4();\nconst scratchCenter = new Cartesian3();\nconst scratchPosition = new Cartesian3();\nconst scratchDirection = new Cartesian3();\n\nfunction updateDynamicScreenSpaceError(tileset, frameState) {\n  let up;\n  let direction;\n  let height;\n  let minimumHeight;\n  let maximumHeight;\n\n  const camera = frameState.camera;\n  const root = tileset._root;\n  const tileBoundingVolume = root.contentBoundingVolume;\n\n  if (tileBoundingVolume instanceof TileBoundingRegion) {\n    up = Cartesian3.normalize(camera.positionWC, scratchPositionNormal);\n    direction = camera.directionWC;\n    height = camera.positionCartographic.height;\n    minimumHeight = tileBoundingVolume.minimumHeight;\n    maximumHeight = tileBoundingVolume.maximumHeight;\n  } else {\n    // Transform camera position and direction into the local coordinate system of the tileset\n    const transformLocal = Matrix4.inverseTransformation(\n      root.computedTransform,\n      scratchMatrix\n    );\n    const ellipsoid = frameState.mapProjection.ellipsoid;\n    const boundingVolume = tileBoundingVolume.boundingVolume;\n    const centerLocal = Matrix4.multiplyByPoint(\n      transformLocal,\n      boundingVolume.center,\n      scratchCenter\n    );\n    if (Cartesian3.magnitude(centerLocal) > ellipsoid.minimumRadius) {\n      // The tileset is defined in WGS84. Approximate the minimum and maximum height.\n      const centerCartographic = Cartographic.fromCartesian(\n        centerLocal,\n        ellipsoid,\n        scratchCartographic\n      );\n      up = Cartesian3.normalize(camera.positionWC, scratchPositionNormal);\n      direction = camera.directionWC;\n      height = camera.positionCartographic.height;\n      minimumHeight = 0.0;\n      maximumHeight = centerCartographic.height * 2.0;\n    } else {\n      // The tileset is defined in local coordinates (z-up)\n      const positionLocal = Matrix4.multiplyByPoint(\n        transformLocal,\n        camera.positionWC,\n        scratchPosition\n      );\n      up = Cartesian3.UNIT_Z;\n      direction = Matrix4.multiplyByPointAsVector(\n        transformLocal,\n        camera.directionWC,\n        scratchDirection\n      );\n      direction = Cartesian3.normalize(direction, direction);\n      height = positionLocal.z;\n      if (tileBoundingVolume instanceof TileOrientedBoundingBox) {\n        // Assuming z-up, the last component stores the half-height of the box\n        const boxHeight = root._header.boundingVolume.box[11];\n        minimumHeight = centerLocal.z - boxHeight;\n        maximumHeight = centerLocal.z + boxHeight;\n      } else if (tileBoundingVolume instanceof TileBoundingSphere) {\n        const radius = boundingVolume.radius;\n        minimumHeight = centerLocal.z - radius;\n        maximumHeight = centerLocal.z + radius;\n      }\n    }\n  }\n\n  // The range where the density starts to lessen. Start at the quarter height of the tileset.\n  const heightFalloff = tileset.dynamicScreenSpaceErrorHeightFalloff;\n  const heightClose =\n    minimumHeight + (maximumHeight - minimumHeight) * heightFalloff;\n  const heightFar = maximumHeight;\n\n  const t = CesiumMath.clamp(\n    (height - heightClose) / (heightFar - heightClose),\n    0.0,\n    1.0\n  );\n\n  // Increase density as the camera tilts towards the horizon\n  const dot = Math.abs(Cartesian3.dot(direction, up));\n  let horizonFactor = 1.0 - dot;\n\n  // Weaken the horizon factor as the camera height increases, implying the camera is further away from the tileset.\n  // The goal is to increase density for the \"street view\", not when viewing the tileset from a distance.\n  horizonFactor = horizonFactor * (1.0 - t);\n\n  let density = tileset.dynamicScreenSpaceErrorDensity;\n  density *= horizonFactor;\n\n  tileset._dynamicScreenSpaceErrorComputedDensity = density;\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction requestContent(tileset, tile) {\n  if (tile.hasEmptyContent) {\n    return;\n  }\n\n  const statistics = tileset._statistics;\n  const expired = tile.contentExpired;\n  const attemptedRequests = tile.requestContent();\n\n  if (attemptedRequests > 0) {\n    statistics.numberOfAttemptedRequests += attemptedRequests;\n    return;\n  }\n\n  if (expired) {\n    if (tile.hasTilesetContent || tile.hasImplicitContent) {\n      destroySubtree(tileset, tile);\n    } else {\n      statistics.decrementLoadCounts(tile.content);\n      --statistics.numberOfTilesWithContentReady;\n    }\n  }\n\n  tileset._requestedTilesInFlight.push(tile);\n\n  tile.contentReadyToProcessPromise\n    .then(addToProcessingQueue(tileset, tile))\n    .catch(function (e) {\n      // Any error will propagate through contentReadyPromise and will be handled below\n    });\n  tile.contentReadyPromise\n    .then(handleTileSuccess(tileset, tile))\n    .catch(handleTileFailure(tileset, tile));\n}\n\nfunction sortRequestByPriority(a, b) {\n  return a._priority - b._priority;\n}\n\n/**\n * Perform any pass invariant tasks here. Called after the render pass.\n * @private\n */\nCesium3DTileset.prototype.postPassesUpdate = function (frameState) {\n  if (!this.ready) {\n    return;\n  }\n\n  cancelOutOfViewRequests(this, frameState);\n  raiseLoadProgressEvent(this, frameState);\n  this._cache.unloadTiles(this, unloadTile);\n  this._styleEngine.resetDirty();\n};\n\n/**\n * Perform any pass invariant tasks here. Called before any passes are executed.\n * @private\n */\nCesium3DTileset.prototype.prePassesUpdate = function (frameState) {\n  if (!this.ready) {\n    return;\n  }\n\n  processTiles(this, frameState);\n\n  // Update clipping planes\n  const clippingPlanes = this._clippingPlanes;\n  this._clippingPlanesOriginMatrixDirty = true;\n  if (defined(clippingPlanes) && clippingPlanes.enabled) {\n    clippingPlanes.update(frameState);\n  }\n\n  if (!defined(this._loadTimestamp)) {\n    this._loadTimestamp = JulianDate.clone(frameState.time);\n  }\n  this._timeSinceLoad = Math.max(\n    JulianDate.secondsDifference(frameState.time, this._loadTimestamp) * 1000,\n    0.0\n  );\n\n  this._skipLevelOfDetail =\n    this.skipLevelOfDetail &&\n    !defined(this._classificationType) &&\n    !this._disableSkipLevelOfDetail &&\n    !this._allTilesAdditive;\n\n  if (this.dynamicScreenSpaceError) {\n    updateDynamicScreenSpaceError(this, frameState);\n  }\n\n  if (frameState.newFrame) {\n    this._cache.reset();\n  }\n};\n\nfunction cancelOutOfViewRequests(tileset, frameState) {\n  const requestedTilesInFlight = tileset._requestedTilesInFlight;\n  let removeCount = 0;\n  const length = requestedTilesInFlight.length;\n  for (let i = 0; i < length; ++i) {\n    const tile = requestedTilesInFlight[i];\n\n    // NOTE: This is framerate dependant so make sure the threshold check is small\n    const outOfView = frameState.frameNumber - tile._touchedFrame >= 1;\n    if (tile._contentState !== Cesium3DTileContentState.LOADING) {\n      // No longer fetching from host, don't need to track it anymore. Gets marked as LOADING in Cesium3DTile::requestContent().\n      ++removeCount;\n      continue;\n    } else if (outOfView) {\n      // RequestScheduler will take care of cancelling it\n      tile.cancelRequests();\n      ++removeCount;\n      continue;\n    }\n\n    if (removeCount > 0) {\n      requestedTilesInFlight[i - removeCount] = tile;\n    }\n  }\n\n  requestedTilesInFlight.length -= removeCount;\n}\n\nfunction requestTiles(tileset, isAsync) {\n  // Sort requests by priority before making any requests.\n  // This makes it less likely that requests will be cancelled after being issued.\n  const requestedTiles = tileset._requestedTiles;\n  const length = requestedTiles.length;\n  requestedTiles.sort(sortRequestByPriority);\n  for (let i = 0; i < length; ++i) {\n    requestContent(tileset, requestedTiles[i]);\n  }\n}\n\nfunction addToProcessingQueue(tileset, tile) {\n  return function () {\n    tileset._processingQueue.push(tile);\n\n    ++tileset._statistics.numberOfTilesProcessing;\n  };\n}\n\nfunction handleTileFailure(tileset, tile) {\n  return function (error) {\n    if (tile._contentState !== Cesium3DTileContentState.FAILED) {\n      // If the tile has not failed, the request has been rejected this frame, but will be retried. Do not bubble up the error.\n      return;\n    }\n\n    const url = tile._contentResource.url;\n    const message = defined(error.message) ? error.message : error.toString();\n    if (tileset.tileFailed.numberOfListeners > 0) {\n      tileset.tileFailed.raiseEvent({\n        url: url,\n        message: message,\n      });\n    } else {\n      console.log(`A 3D tile failed to load: ${url}`);\n      console.log(`Error: ${message}`);\n    }\n  };\n}\n\nfunction handleTileSuccess(tileset, tile) {\n  return function (content) {\n    --tileset._statistics.numberOfTilesProcessing;\n\n    if (!defined(content)) {\n      // A request was cancelled. Do not update successful statistics. The request will be retried.\n      return;\n    }\n\n    if (!tile.hasTilesetContent && !tile.hasImplicitContent) {\n      // RESEARCH_IDEA: ability to unload tiles (without content) for an\n      // external tileset when all the tiles are unloaded.\n      tileset._statistics.incrementLoadCounts(tile.content);\n      ++tileset._statistics.numberOfTilesWithContentReady;\n      ++tileset._statistics.numberOfLoadedTilesTotal;\n\n      // Add to the tile cache. Previously expired tiles are already in the cache and won't get re-added.\n      tileset._cache.add(tile);\n    }\n\n    tileset.tileLoad.raiseEvent(tile);\n  };\n}\n\nfunction filterProcessingQueue(tileset) {\n  const tiles = tileset._processingQueue;\n  const length = tiles.length;\n\n  let removeCount = 0;\n  for (let i = 0; i < length; ++i) {\n    const tile = tiles[i];\n    if (tile._contentState !== Cesium3DTileContentState.PROCESSING) {\n      ++removeCount;\n      continue;\n    }\n    if (removeCount > 0) {\n      tiles[i - removeCount] = tile;\n    }\n  }\n  tiles.length -= removeCount;\n}\n\nfunction processTiles(tileset, frameState) {\n  filterProcessingQueue(tileset);\n  const tiles = tileset._processingQueue;\n  const length = tiles.length;\n  // Process tiles in the PROCESSING state so they will eventually move to the READY state.\n  for (let i = 0; i < length; ++i) {\n    tiles[i].process(tileset, frameState);\n  }\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nconst scratchCartesian = new Cartesian3();\n\nconst stringOptions = {\n  maximumFractionDigits: 3,\n};\n\nfunction formatMemoryString(memorySizeInBytes) {\n  const memoryInMegabytes = memorySizeInBytes / 1048576;\n  if (memoryInMegabytes < 1.0) {\n    return memoryInMegabytes.toLocaleString(undefined, stringOptions);\n  }\n  return Math.round(memoryInMegabytes).toLocaleString();\n}\n\nfunction computeTileLabelPosition(tile) {\n  const boundingVolume = tile.boundingVolume.boundingVolume;\n  const halfAxes = boundingVolume.halfAxes;\n  const radius = boundingVolume.radius;\n\n  let position = Cartesian3.clone(boundingVolume.center, scratchCartesian);\n  if (defined(halfAxes)) {\n    position.x += 0.75 * (halfAxes[0] + halfAxes[3] + halfAxes[6]);\n    position.y += 0.75 * (halfAxes[1] + halfAxes[4] + halfAxes[7]);\n    position.z += 0.75 * (halfAxes[2] + halfAxes[5] + halfAxes[8]);\n  } else if (defined(radius)) {\n    let normal = Cartesian3.normalize(boundingVolume.center, scratchCartesian);\n    normal = Cartesian3.multiplyByScalar(\n      normal,\n      0.75 * radius,\n      scratchCartesian\n    );\n    position = Cartesian3.add(normal, boundingVolume.center, scratchCartesian);\n  }\n  return position;\n}\n\nfunction addTileDebugLabel(tile, tileset, position) {\n  let labelString = \"\";\n  let attributes = 0;\n\n  if (tileset.debugShowGeometricError) {\n    labelString += `\\nGeometric error: ${tile.geometricError}`;\n    attributes++;\n  }\n\n  if (tileset.debugShowRenderingStatistics) {\n    labelString += `\\nCommands: ${tile.commandsLength}`;\n    attributes++;\n\n    // Don't display number of points or triangles if 0.\n    const numberOfPoints = tile.content.pointsLength;\n    if (numberOfPoints > 0) {\n      labelString += `\\nPoints: ${tile.content.pointsLength}`;\n      attributes++;\n    }\n\n    const numberOfTriangles = tile.content.trianglesLength;\n    if (numberOfTriangles > 0) {\n      labelString += `\\nTriangles: ${tile.content.trianglesLength}`;\n      attributes++;\n    }\n\n    labelString += `\\nFeatures: ${tile.content.featuresLength}`;\n    attributes++;\n  }\n\n  if (tileset.debugShowMemoryUsage) {\n    labelString += `\\nTexture Memory: ${formatMemoryString(\n      tile.content.texturesByteLength\n    )}`;\n    labelString += `\\nGeometry Memory: ${formatMemoryString(\n      tile.content.geometryByteLength\n    )}`;\n    attributes += 2;\n  }\n\n  if (tileset.debugShowUrl) {\n    if (tile.hasMultipleContents) {\n      labelString += \"\\nUrls:\";\n      const urls = tile.content.innerContentUrls;\n      for (let i = 0; i < urls.length; i++) {\n        labelString += `\\n- ${urls[i]}`;\n      }\n      attributes += urls.length;\n    } else {\n      labelString += `\\nUrl: ${tile._contentHeader.uri}`;\n      attributes++;\n    }\n  }\n\n  const newLabel = {\n    text: labelString.substring(1),\n    position: position,\n    font: `${19 - attributes}px sans-serif`,\n    showBackground: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  };\n\n  return tileset._tileDebugLabels.add(newLabel);\n}\n\nfunction updateTileDebugLabels(tileset, frameState) {\n  let i;\n  let tile;\n  const selectedTiles = tileset._selectedTiles;\n  const selectedLength = selectedTiles.length;\n  const emptyTiles = tileset._emptyTiles;\n  const emptyLength = emptyTiles.length;\n  tileset._tileDebugLabels.removeAll();\n\n  if (tileset.debugPickedTileLabelOnly) {\n    if (defined(tileset.debugPickedTile)) {\n      const position = defined(tileset.debugPickPosition)\n        ? tileset.debugPickPosition\n        : computeTileLabelPosition(tileset.debugPickedTile);\n      const label = addTileDebugLabel(\n        tileset.debugPickedTile,\n        tileset,\n        position\n      );\n      label.pixelOffset = new Cartesian2(15, -15); // Offset to avoid picking the label.\n    }\n  } else {\n    for (i = 0; i < selectedLength; ++i) {\n      tile = selectedTiles[i];\n      addTileDebugLabel(tile, tileset, computeTileLabelPosition(tile));\n    }\n    for (i = 0; i < emptyLength; ++i) {\n      tile = emptyTiles[i];\n      if (tile.hasTilesetContent || tile.hasImplicitContent) {\n        addTileDebugLabel(tile, tileset, computeTileLabelPosition(tile));\n      }\n    }\n  }\n  tileset._tileDebugLabels.update(frameState);\n}\n\nfunction updateTiles(tileset, frameState, passOptions) {\n  tileset._styleEngine.applyStyle(tileset);\n\n  const isRender = passOptions.isRender;\n  const statistics = tileset._statistics;\n  const commandList = frameState.commandList;\n  const numberOfInitialCommands = commandList.length;\n  const selectedTiles = tileset._selectedTiles;\n  const selectedLength = selectedTiles.length;\n  const emptyTiles = tileset._emptyTiles;\n  const emptyLength = emptyTiles.length;\n  const tileVisible = tileset.tileVisible;\n  let i;\n  let tile;\n\n  const bivariateVisibilityTest =\n    tileset._skipLevelOfDetail &&\n    tileset._hasMixedContent &&\n    frameState.context.stencilBuffer &&\n    selectedLength > 0;\n\n  tileset._backfaceCommands.length = 0;\n\n  if (bivariateVisibilityTest) {\n    if (!defined(tileset._stencilClearCommand)) {\n      tileset._stencilClearCommand = new ClearCommand({\n        stencil: 0,\n        pass: Pass.CESIUM_3D_TILE,\n        renderState: RenderState.fromCache({\n          stencilMask: StencilConstants.SKIP_LOD_MASK,\n        }),\n      });\n    }\n    commandList.push(tileset._stencilClearCommand);\n  }\n\n  const lengthBeforeUpdate = commandList.length;\n  for (i = 0; i < selectedLength; ++i) {\n    tile = selectedTiles[i];\n    // Raise the tileVisible event before update in case the tileVisible event\n    // handler makes changes that update needs to apply to WebGL resources\n    if (isRender) {\n      tileVisible.raiseEvent(tile);\n    }\n    tile.update(tileset, frameState, passOptions);\n    statistics.incrementSelectionCounts(tile.content);\n    ++statistics.selected;\n  }\n  for (i = 0; i < emptyLength; ++i) {\n    tile = emptyTiles[i];\n    tile.update(tileset, frameState, passOptions);\n  }\n\n  let addedCommandsLength = commandList.length - lengthBeforeUpdate;\n\n  tileset._backfaceCommands.trim();\n\n  if (bivariateVisibilityTest) {\n    /*\n     * Consider 'effective leaf' tiles as selected tiles that have no selected descendants. They may have children,\n     * but they are currently our effective leaves because they do not have selected descendants. These tiles\n     * are those where with tile._finalResolution === true.\n     * Let 'unresolved' tiles be those with tile._finalResolution === false.\n     *\n     * 1. Render just the backfaces of unresolved tiles in order to lay down z\n     * 2. Render all frontfaces wherever tile._selectionDepth > stencilBuffer.\n     *    Replace stencilBuffer with tile._selectionDepth, when passing the z test.\n     *    Because children are always drawn before ancestors {@link Cesium3DTilesetTraversal#traverseAndSelect},\n     *    this effectively draws children first and does not draw ancestors if a descendant has already\n     *    been drawn at that pixel.\n     *    Step 1 prevents child tiles from appearing on top when they are truly behind ancestor content.\n     *    If they are behind the backfaces of the ancestor, then they will not be drawn.\n     *\n     * NOTE: Step 2 sometimes causes visual artifacts when backfacing child content has some faces that\n     * partially face the camera and are inside of the ancestor content. Because they are inside, they will\n     * not be culled by the depth writes in Step 1, and because they partially face the camera, the stencil tests\n     * will draw them on top of the ancestor content.\n     *\n     * NOTE: Because we always render backfaces of unresolved tiles, if the camera is looking at the backfaces\n     * of an object, they will always be drawn while loading, even if backface culling is enabled.\n     */\n\n    const backfaceCommands = tileset._backfaceCommands.values;\n    const backfaceCommandsLength = backfaceCommands.length;\n\n    commandList.length += backfaceCommandsLength;\n\n    // copy commands to the back of the commandList\n    for (i = addedCommandsLength - 1; i >= 0; --i) {\n      commandList[lengthBeforeUpdate + backfaceCommandsLength + i] =\n        commandList[lengthBeforeUpdate + i];\n    }\n\n    // move backface commands to the front of the commandList\n    for (i = 0; i < backfaceCommandsLength; ++i) {\n      commandList[lengthBeforeUpdate + i] = backfaceCommands[i];\n    }\n  }\n\n  // Number of commands added by each update above\n  addedCommandsLength = commandList.length - numberOfInitialCommands;\n  statistics.numberOfCommands = addedCommandsLength;\n\n  // Only run EDL if simple attenuation is on\n  if (\n    isRender &&\n    tileset.pointCloudShading.attenuation &&\n    tileset.pointCloudShading.eyeDomeLighting &&\n    addedCommandsLength > 0\n  ) {\n    tileset._pointCloudEyeDomeLighting.update(\n      frameState,\n      numberOfInitialCommands,\n      tileset.pointCloudShading,\n      tileset.boundingSphere\n    );\n  }\n\n  if (isRender) {\n    if (\n      tileset.debugShowGeometricError ||\n      tileset.debugShowRenderingStatistics ||\n      tileset.debugShowMemoryUsage ||\n      tileset.debugShowUrl\n    ) {\n      if (!defined(tileset._tileDebugLabels)) {\n        tileset._tileDebugLabels = new LabelCollection();\n      }\n      updateTileDebugLabels(tileset, frameState);\n    } else {\n      tileset._tileDebugLabels =\n        tileset._tileDebugLabels && tileset._tileDebugLabels.destroy();\n    }\n  }\n}\n\nconst scratchStack = [];\n\nfunction destroySubtree(tileset, tile) {\n  const root = tile;\n  const stack = scratchStack;\n  stack.push(tile);\n  while (stack.length > 0) {\n    tile = stack.pop();\n    const children = tile.children;\n    const length = children.length;\n    for (let i = 0; i < length; ++i) {\n      stack.push(children[i]);\n    }\n    if (tile !== root) {\n      destroyTile(tileset, tile);\n      --tileset._statistics.numberOfTilesTotal;\n    }\n  }\n  root.children = [];\n}\n\nfunction unloadTile(tileset, tile) {\n  tileset.tileUnload.raiseEvent(tile);\n  tileset._statistics.decrementLoadCounts(tile.content);\n  --tileset._statistics.numberOfTilesWithContentReady;\n  tile.unloadContent();\n}\n\nfunction destroyTile(tileset, tile) {\n  tileset._cache.unloadTile(tileset, tile, unloadTile);\n  tile.destroy();\n}\n\n/**\n * Unloads all tiles that weren't selected the previous frame.  This can be used to\n * explicitly manage the tile cache and reduce the total number of tiles loaded below\n * {@link Cesium3DTileset#maximumMemoryUsage}.\n * <p>\n * Tile unloads occur at the next frame to keep all the WebGL delete calls\n * within the render loop.\n * </p>\n */\nCesium3DTileset.prototype.trimLoadedTiles = function () {\n  this._cache.trim();\n};\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction raiseLoadProgressEvent(tileset, frameState) {\n  const statistics = tileset._statistics;\n  const statisticsLast = tileset._statisticsLast;\n\n  const numberOfPendingRequests = statistics.numberOfPendingRequests;\n  const numberOfTilesProcessing = statistics.numberOfTilesProcessing;\n  const lastNumberOfPendingRequest = statisticsLast.numberOfPendingRequests;\n  const lastNumberOfTilesProcessing = statisticsLast.numberOfTilesProcessing;\n\n  Cesium3DTilesetStatistics.clone(statistics, statisticsLast);\n\n  const progressChanged =\n    numberOfPendingRequests !== lastNumberOfPendingRequest ||\n    numberOfTilesProcessing !== lastNumberOfTilesProcessing;\n\n  if (progressChanged) {\n    frameState.afterRender.push(function () {\n      tileset.loadProgress.raiseEvent(\n        numberOfPendingRequests,\n        numberOfTilesProcessing\n      );\n    });\n  }\n\n  tileset._tilesLoaded =\n    statistics.numberOfPendingRequests === 0 &&\n    statistics.numberOfTilesProcessing === 0 &&\n    statistics.numberOfAttemptedRequests === 0;\n\n  // Events are raised (added to the afterRender queue) here since promises\n  // may resolve outside of the update loop that then raise events, e.g.,\n  // model's readyPromise.\n  if (progressChanged && tileset._tilesLoaded) {\n    frameState.afterRender.push(function () {\n      tileset.allTilesLoaded.raiseEvent();\n    });\n    if (!tileset._initialTilesLoaded) {\n      tileset._initialTilesLoaded = true;\n      frameState.afterRender.push(function () {\n        tileset.initialTilesLoaded.raiseEvent();\n      });\n    }\n  }\n}\n\nfunction resetMinimumMaximum(tileset) {\n  tileset._heatmap.resetMinimumMaximum();\n  tileset._minimumPriority.depth = Number.MAX_VALUE;\n  tileset._maximumPriority.depth = -Number.MAX_VALUE;\n  tileset._minimumPriority.foveatedFactor = Number.MAX_VALUE;\n  tileset._maximumPriority.foveatedFactor = -Number.MAX_VALUE;\n  tileset._minimumPriority.distance = Number.MAX_VALUE;\n  tileset._maximumPriority.distance = -Number.MAX_VALUE;\n  tileset._minimumPriority.reverseScreenSpaceError = Number.MAX_VALUE;\n  tileset._maximumPriority.reverseScreenSpaceError = -Number.MAX_VALUE;\n}\n\nfunction detectModelMatrixChanged(tileset, frameState) {\n  if (\n    frameState.frameNumber !== tileset._updatedModelMatrixFrame ||\n    !defined(tileset._previousModelMatrix)\n  ) {\n    tileset._updatedModelMatrixFrame = frameState.frameNumber;\n    tileset._modelMatrixChanged = !Matrix4.equals(\n      tileset.modelMatrix,\n      tileset._previousModelMatrix\n    );\n    if (tileset._modelMatrixChanged) {\n      tileset._previousModelMatrix = Matrix4.clone(\n        tileset.modelMatrix,\n        tileset._previousModelMatrix\n      );\n    }\n  }\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction update(tileset, frameState, passStatistics, passOptions) {\n  if (frameState.mode === SceneMode.MORPHING) {\n    return false;\n  }\n\n  if (!tileset.ready) {\n    return false;\n  }\n\n  const statistics = tileset._statistics;\n  statistics.clear();\n\n  const isRender = passOptions.isRender;\n\n  // Resets the visibility check for each pass\n  ++tileset._updatedVisibilityFrame;\n\n  // Update any tracked min max values\n  resetMinimumMaximum(tileset);\n\n  detectModelMatrixChanged(tileset, frameState);\n  tileset._cullRequestsWhileMoving =\n    tileset.cullRequestsWhileMoving && !tileset._modelMatrixChanged;\n\n  const ready = passOptions.traversal.selectTiles(tileset, frameState);\n\n  if (passOptions.requestTiles) {\n    requestTiles(tileset);\n  }\n\n  updateTiles(tileset, frameState, passOptions);\n\n  // Update pass statistics\n  Cesium3DTilesetStatistics.clone(statistics, passStatistics);\n\n  if (isRender) {\n    const credits = tileset._credits;\n    if (defined(credits) && statistics.selected !== 0) {\n      const length = credits.length;\n      for (let i = 0; i < length; ++i) {\n        const credit = credits[i];\n        credit.showOnScreen = tileset._showCreditsOnScreen;\n        frameState.creditDisplay.addCredit(credit);\n      }\n    }\n  }\n\n  return ready;\n}\n\n/**\n * @private\n */\nCesium3DTileset.prototype.update = function (frameState) {\n  this.updateForPass(frameState, frameState.tilesetPassState);\n};\n\n/**\n * @private\n */\nCesium3DTileset.prototype.updateForPass = function (\n  frameState,\n  tilesetPassState\n) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"frameState\", frameState);\n  Check.typeOf.object(\"tilesetPassState\", tilesetPassState);\n  //>>includeEnd('debug');\n\n  const pass = tilesetPassState.pass;\n  if (\n    (pass === Cesium3DTilePass.PRELOAD &&\n      (!this.preloadWhenHidden || this.show)) ||\n    (pass === Cesium3DTilePass.PRELOAD_FLIGHT &&\n      (!this.preloadFlightDestinations ||\n        (!this.show && !this.preloadWhenHidden))) ||\n    (pass === Cesium3DTilePass.REQUEST_RENDER_MODE_DEFER_CHECK &&\n      ((!this._cullRequestsWhileMoving && this.foveatedTimeDelay <= 0) ||\n        !this.show))\n  ) {\n    return;\n  }\n\n  const originalCommandList = frameState.commandList;\n  const originalCamera = frameState.camera;\n  const originalCullingVolume = frameState.cullingVolume;\n\n  tilesetPassState.ready = false;\n\n  const passOptions = Cesium3DTilePass.getPassOptions(pass);\n  const ignoreCommands = passOptions.ignoreCommands;\n\n  const commandList = defaultValue(\n    tilesetPassState.commandList,\n    originalCommandList\n  );\n  const commandStart = commandList.length;\n\n  frameState.commandList = commandList;\n  frameState.camera = defaultValue(tilesetPassState.camera, originalCamera);\n  frameState.cullingVolume = defaultValue(\n    tilesetPassState.cullingVolume,\n    originalCullingVolume\n  );\n\n  const passStatistics = this._statisticsPerPass[pass];\n\n  if (this.show || ignoreCommands) {\n    this._pass = pass;\n    tilesetPassState.ready = update(\n      this,\n      frameState,\n      passStatistics,\n      passOptions\n    );\n  }\n\n  if (ignoreCommands) {\n    commandList.length = commandStart;\n  }\n\n  frameState.commandList = originalCommandList;\n  frameState.camera = originalCamera;\n  frameState.cullingVolume = originalCullingVolume;\n};\n\n/**\n * <code>true</code> if the tileset JSON file lists the extension in extensionsUsed; otherwise, <code>false</code>.\n * @param {String} extensionName The name of the extension to check.\n *\n * @returns {Boolean} <code>true</code> if the tileset JSON file lists the extension in extensionsUsed; otherwise, <code>false</code>.\n */\nCesium3DTileset.prototype.hasExtension = function (extensionName) {\n  if (!defined(this._extensionsUsed)) {\n    return false;\n  }\n\n  return this._extensionsUsed.indexOf(extensionName) > -1;\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see Cesium3DTileset#destroy\n */\nCesium3DTileset.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @example\n * tileset = tileset && tileset.destroy();\n *\n * @see Cesium3DTileset#isDestroyed\n */\nCesium3DTileset.prototype.destroy = function () {\n  this._tileDebugLabels =\n    this._tileDebugLabels && this._tileDebugLabels.destroy();\n  this._clippingPlanes = this._clippingPlanes && this._clippingPlanes.destroy();\n\n  if (defined(this._schemaLoader)) {\n    ResourceCache.unload(this._schemaLoader);\n  }\n\n  // Traverse the tree and destroy all tiles\n  if (defined(this._root)) {\n    const stack = scratchStack;\n    stack.push(this._root);\n\n    while (stack.length > 0) {\n      const tile = stack.pop();\n      tile.destroy();\n\n      const children = tile.children;\n      const length = children.length;\n      for (let i = 0; i < length; ++i) {\n        stack.push(children[i]);\n      }\n    }\n  }\n  this._root = undefined;\n\n  if (\n    this._shouldDestroyImageBasedLighting &&\n    !this._imageBasedLighting.isDestroyed()\n  ) {\n    this._imageBasedLighting.destroy();\n  }\n  this._imageBasedLighting = undefined;\n\n  return destroyObject(this);\n};\n\nCesium3DTileset.supportedExtensions = {\n  \"3DTILES_metadata\": true,\n  \"3DTILES_implicit_tiling\": true,\n  \"3DTILES_content_gltf\": true,\n  \"3DTILES_multiple_contents\": true,\n  \"3DTILES_bounding_volume_S2\": true,\n  \"3DTILES_batch_table_hierarchy\": true,\n  \"3DTILES_draco_point_compression\": true,\n  MAXAR_content_geojson: true,\n};\n\n/**\n * Checks to see if a given extension is supported by Cesium3DTileset. If\n * the extension is not supported by Cesium3DTileset, it throws a RuntimeError.\n *\n * @param {Object} extensionsRequired The extensions we wish to check\n *\n * @private\n */\nCesium3DTileset.checkSupportedExtensions = function (extensionsRequired) {\n  for (let i = 0; i < extensionsRequired.length; i++) {\n    if (!Cesium3DTileset.supportedExtensions[extensionsRequired[i]]) {\n      throw new RuntimeError(\n        `Unsupported 3D Tiles Extension: ${extensionsRequired[i]}`\n      );\n    }\n  }\n};\n\n/**\n * Optimization option. Used as a callback when {@link Cesium3DTileset#foveatedScreenSpaceError} is true to control how much to raise the screen space error for tiles outside the foveated cone,\n * interpolating between {@link Cesium3DTileset#foveatedMinimumScreenSpaceErrorRelaxation} and {@link Cesium3DTileset#maximumScreenSpaceError}.\n *\n * @callback Cesium3DTileset.foveatedInterpolationCallback\n * @default Math.lerp\n *\n * @param {Number} p The start value to interpolate.\n * @param {Number} q The end value to interpolate.\n * @param {Number} time The time of interpolation generally in the range <code>[0.0, 1.0]</code>.\n * @returns {Number} The interpolated value.\n */\nexport default Cesium3DTileset;\n","import defined from \"../Core/defined.js\";\nimport DoublyLinkedList from \"../Core/DoublyLinkedList.js\";\n\n/**\n * Stores tiles with content loaded.\n *\n * @private\n */\nfunction Cesium3DTilesetCache() {\n  // [head, sentinel) -> tiles that weren't selected this frame and may be removed from the cache\n  // (sentinel, tail] -> tiles that were selected this frame\n  this._list = new DoublyLinkedList();\n  this._sentinel = this._list.add();\n  this._trimTiles = false;\n}\n\nCesium3DTilesetCache.prototype.reset = function () {\n  // Move sentinel node to the tail so, at the start of the frame, all tiles\n  // may be potentially replaced.  Tiles are moved to the right of the sentinel\n  // when they are selected so they will not be replaced.\n  this._list.splice(this._list.tail, this._sentinel);\n};\n\nCesium3DTilesetCache.prototype.touch = function (tile) {\n  const node = tile.cacheNode;\n  if (defined(node)) {\n    this._list.splice(this._sentinel, node);\n  }\n};\n\nCesium3DTilesetCache.prototype.add = function (tile) {\n  if (!defined(tile.cacheNode)) {\n    tile.cacheNode = this._list.add(tile);\n  }\n};\n\nCesium3DTilesetCache.prototype.unloadTile = function (\n  tileset,\n  tile,\n  unloadCallback\n) {\n  const node = tile.cacheNode;\n  if (!defined(node)) {\n    return;\n  }\n\n  this._list.remove(node);\n  tile.cacheNode = undefined;\n  unloadCallback(tileset, tile);\n};\n\nCesium3DTilesetCache.prototype.unloadTiles = function (\n  tileset,\n  unloadCallback\n) {\n  const trimTiles = this._trimTiles;\n  this._trimTiles = false;\n\n  const list = this._list;\n\n  const maximumMemoryUsageInBytes = tileset.maximumMemoryUsage * 1024 * 1024;\n\n  // Traverse the list only to the sentinel since tiles/nodes to the\n  // right of the sentinel were used this frame.\n  //\n  // The sub-list to the left of the sentinel is ordered from LRU to MRU.\n  const sentinel = this._sentinel;\n  let node = list.head;\n  while (\n    node !== sentinel &&\n    (tileset.totalMemoryUsageInBytes > maximumMemoryUsageInBytes || trimTiles)\n  ) {\n    const tile = node.item;\n    node = node.next;\n    this.unloadTile(tileset, tile, unloadCallback);\n  }\n};\n\nCesium3DTilesetCache.prototype.trim = function () {\n  this._trimTiles = true;\n};\nexport default Cesium3DTilesetCache;\n","import Color from \"../Core/Color.js\";\nimport defined from \"../Core/defined.js\";\nimport JulianDate from \"../Core/JulianDate.js\";\nimport CesiumMath from \"../Core/Math.js\";\n\n/**\n * A heatmap colorizer in a {@link Cesium3DTileset}. A tileset can colorize its visible tiles in a heatmap style.\n *\n * @alias Cesium3DTilesetHeatmap\n * @constructor\n * @private\n */\nfunction Cesium3DTilesetHeatmap(tilePropertyName) {\n  /**\n   * The tile variable to track for heatmap colorization.\n   * Tile's will be colorized relative to the other visible tile's values for this variable.\n   *\n   * @type {String}\n   */\n  this.tilePropertyName = tilePropertyName;\n\n  // Members that are updated every time a tile is colorized\n  this._minimum = Number.MAX_VALUE;\n  this._maximum = -Number.MAX_VALUE;\n\n  // Members that are updated once every frame\n  this._previousMinimum = Number.MAX_VALUE;\n  this._previousMaximum = -Number.MAX_VALUE;\n\n  // If defined uses a reference minimum maximum to colorize by instead of using last frames minimum maximum of rendered tiles.\n  // For example, the _loadTimestamp can get a better colorization using setReferenceMinimumMaximum in order to take accurate colored timing diffs of various scenes.\n  this._referenceMinimum = {};\n  this._referenceMaximum = {};\n}\n\n/**\n * Convert to a usable heatmap value (i.e. a number). Ensures that tile values that aren't stored as numbers can be used for colorization.\n * @private\n */\nfunction getHeatmapValue(tileValue, tilePropertyName) {\n  let value;\n  if (tilePropertyName === \"_loadTimestamp\") {\n    value = JulianDate.toDate(tileValue).getTime();\n  } else {\n    value = tileValue;\n  }\n  return value;\n}\n\n/**\n * Sets the reference minimum and maximum for the variable name. Converted to numbers before they are stored.\n *\n * @param {Object} minimum The minimum reference value.\n * @param {Object} maximum The maximum reference value.\n * @param {String} tilePropertyName The tile variable that will use these reference values when it is colorized.\n */\nCesium3DTilesetHeatmap.prototype.setReferenceMinimumMaximum = function (\n  minimum,\n  maximum,\n  tilePropertyName\n) {\n  this._referenceMinimum[tilePropertyName] = getHeatmapValue(\n    minimum,\n    tilePropertyName\n  );\n  this._referenceMaximum[tilePropertyName] = getHeatmapValue(\n    maximum,\n    tilePropertyName\n  );\n};\n\nfunction getHeatmapValueAndUpdateMinimumMaximum(heatmap, tile) {\n  const tilePropertyName = heatmap.tilePropertyName;\n  if (defined(tilePropertyName)) {\n    const heatmapValue = getHeatmapValue(\n      tile[tilePropertyName],\n      tilePropertyName\n    );\n    if (!defined(heatmapValue)) {\n      heatmap.tilePropertyName = undefined;\n      return heatmapValue;\n    }\n    heatmap._maximum = Math.max(heatmapValue, heatmap._maximum);\n    heatmap._minimum = Math.min(heatmapValue, heatmap._minimum);\n    return heatmapValue;\n  }\n}\n\nconst heatmapColors = [\n  new Color(0.1, 0.1, 0.1, 1), // Dark Gray\n  new Color(0.153, 0.278, 0.878, 1), // Blue\n  new Color(0.827, 0.231, 0.49, 1), // Pink\n  new Color(0.827, 0.188, 0.22, 1), // Red\n  new Color(1.0, 0.592, 0.259, 1), // Orange\n  new Color(1.0, 0.843, 0.0, 1),\n]; // Yellow\n/**\n * Colorize the tile in heat map style based on where it lies within the minimum maximum window.\n * Heatmap colors are black, blue, pink, red, orange, yellow. 'Cold' or low numbers will be black and blue, 'Hot' or high numbers will be orange and yellow,\n * @param {Cesium3DTile} tile The tile to colorize relative to last frame's minimum and maximum values of all visible tiles.\n * @param {FrameState} frameState The frame state.\n */\nCesium3DTilesetHeatmap.prototype.colorize = function (tile, frameState) {\n  const tilePropertyName = this.tilePropertyName;\n  if (\n    !defined(tilePropertyName) ||\n    !tile.contentAvailable ||\n    tile._selectedFrame !== frameState.frameNumber\n  ) {\n    return;\n  }\n\n  const heatmapValue = getHeatmapValueAndUpdateMinimumMaximum(this, tile);\n  const minimum = this._previousMinimum;\n  const maximum = this._previousMaximum;\n\n  if (minimum === Number.MAX_VALUE || maximum === -Number.MAX_VALUE) {\n    return;\n  }\n\n  // Shift the minimum maximum window down to 0\n  const shiftedMax = maximum - minimum + CesiumMath.EPSILON7; // Prevent divide by 0\n  const shiftedValue = CesiumMath.clamp(\n    heatmapValue - minimum,\n    0.0,\n    shiftedMax\n  );\n\n  // Get position between minimum and maximum and convert that to a position in the color array\n  const zeroToOne = shiftedValue / shiftedMax;\n  const lastIndex = heatmapColors.length - 1.0;\n  const colorPosition = zeroToOne * lastIndex;\n\n  // Take floor and ceil of the value to get the two colors to lerp between, lerp using the fractional portion\n  const colorPositionFloor = Math.floor(colorPosition);\n  const colorPositionCeil = Math.ceil(colorPosition);\n  const t = colorPosition - colorPositionFloor;\n  const colorZero = heatmapColors[colorPositionFloor];\n  const colorOne = heatmapColors[colorPositionCeil];\n\n  // Perform the lerp\n  const finalColor = Color.clone(Color.WHITE);\n  finalColor.red = CesiumMath.lerp(colorZero.red, colorOne.red, t);\n  finalColor.green = CesiumMath.lerp(colorZero.green, colorOne.green, t);\n  finalColor.blue = CesiumMath.lerp(colorZero.blue, colorOne.blue, t);\n  tile._debugColor = finalColor;\n};\n\n/**\n * Resets the tracked minimum maximum values for heatmap colorization. Happens right before tileset traversal.\n */\nCesium3DTilesetHeatmap.prototype.resetMinimumMaximum = function () {\n  // For heat map colorization\n  const tilePropertyName = this.tilePropertyName;\n  if (defined(tilePropertyName)) {\n    const referenceMinimum = this._referenceMinimum[tilePropertyName];\n    const referenceMaximum = this._referenceMaximum[tilePropertyName];\n    const useReference = defined(referenceMinimum) && defined(referenceMaximum);\n    this._previousMinimum = useReference ? referenceMinimum : this._minimum;\n    this._previousMaximum = useReference ? referenceMaximum : this._maximum;\n    this._minimum = Number.MAX_VALUE;\n    this._maximum = -Number.MAX_VALUE;\n  }\n};\nexport default Cesium3DTilesetHeatmap;\n","import Check from \"../Core/Check.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport GroupMetadata from \"./GroupMetadata.js\";\nimport TilesetMetadata from \"./TilesetMetadata.js\";\n\n/**\n * An object containing metadata about a 3D Tileset.\n * <p>\n * See the {@link https://github.com/CesiumGS/3d-tiles/tree/main/extensions/3DTILES_metadata|3DTILES_metadata Extension} for 3D Tiles.\n * </p>\n * <p>\n * This object represents the tileset JSON (3D Tiles 1.1) or the <code>3DTILES_metadata</code> object that contains\n * the schema ({@link MetadataSchema}), tileset metadata ({@link TilesetMetadata}), group metadata (dictionary of {@link GroupMetadata}), and metadata statistics (dictionary)\n * </p>\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} options.metadataJson Either the tileset JSON (3D Tiles 1.1) or the <code>3DTILES_metadata</code> extension object that contains the tileset metadata.\n * @param {MetadataSchema} options.schema The parsed schema.\n *\n * @alias Cesium3DTilesetMetadata\n * @constructor\n * @private\n * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n */\nfunction Cesium3DTilesetMetadata(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  const metadataJson = options.metadataJson;\n\n  // The calling code is responsible for loading the schema.\n  // This keeps metadata parsing synchronous.\n  const schema = options.schema;\n\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"options.metadataJson\", metadataJson);\n  Check.typeOf.object(\"options.schema\", schema);\n  //>>includeEnd('debug');\n\n  // An older schema stored the tileset metadata in the \"tileset\" property.\n  const metadata = defaultValue(metadataJson.metadata, metadataJson.tileset);\n\n  let tileset;\n  if (defined(metadata)) {\n    tileset = new TilesetMetadata({\n      tileset: metadata,\n      class: schema.classes[metadata.class],\n    });\n  }\n\n  let groupIds = [];\n  const groups = [];\n  const groupsJson = metadataJson.groups;\n  if (Array.isArray(groupsJson)) {\n    const length = groupsJson.length;\n    for (let i = 0; i < length; i++) {\n      const group = groupsJson[i];\n      groups.push(\n        new GroupMetadata({\n          group: group,\n          class: schema.classes[group.class],\n        })\n      );\n    }\n  } else if (defined(groupsJson)) {\n    // An older version of group metadata stored groups in a dictionary\n    // instead of an array.\n    groupIds = Object.keys(groupsJson).sort();\n    const length = groupIds.length;\n    for (let i = 0; i < length; i++) {\n      const groupId = groupIds[i];\n      if (groupsJson.hasOwnProperty(groupId)) {\n        const group = groupsJson[groupId];\n        groups.push(\n          new GroupMetadata({\n            id: groupId,\n            group: groupsJson[groupId],\n            class: schema.classes[group.class],\n          })\n        );\n      }\n    }\n  }\n\n  this._schema = schema;\n  this._groups = groups;\n  this._groupIds = groupIds;\n  this._tileset = tileset;\n\n  this._statistics = metadataJson.statistics;\n  this._extras = metadataJson.extras;\n  this._extensions = metadataJson.extensions;\n}\n\nObject.defineProperties(Cesium3DTilesetMetadata.prototype, {\n  /**\n   * Schema containing classes and enums.\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {MetadataSchema}\n   * @readonly\n   * @private\n   */\n  schema: {\n    get: function () {\n      return this._schema;\n    },\n  },\n\n  /**\n   * Metadata about groups of content.\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {GroupMetadata[]}\n   * @readonly\n   * @private\n   */\n  groups: {\n    get: function () {\n      return this._groups;\n    },\n  },\n\n  /**\n   * The IDs of the group metadata in the corresponding groups dictionary.\n   * Only populated if using the legacy schema.\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {String[]}\n   * @readonly\n   * @private\n   */\n  groupIds: {\n    get: function () {\n      return this._groupIds;\n    },\n  },\n\n  /**\n   * Metadata about the tileset as a whole.\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {TilesetMetadata}\n   * @readonly\n   * @private\n   */\n  tileset: {\n    get: function () {\n      return this._tileset;\n    },\n  },\n\n  /**\n   * Statistics about the metadata.\n   * <p>\n   * See the {@link https://github.com/CesiumGS/3d-tiles/blob/main/extensions/3DTILES_metadata/schema/statistics.schema.json|statistics schema reference}\n   * in the 3D Tiles spec for the full set of properties.\n   * </p>\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {Object}\n   * @readonly\n   * @private\n   */\n  statistics: {\n    get: function () {\n      return this._statistics;\n    },\n  },\n\n  /**\n   * Extras in the JSON object.\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {*}\n   * @readonly\n   * @private\n   */\n  extras: {\n    get: function () {\n      return this._extras;\n    },\n  },\n\n  /**\n   * Extensions in the JSON object.\n   *\n   * @memberof Cesium3DTilesetMetadata.prototype\n   * @type {Object}\n   * @readonly\n   * @private\n   */\n  extensions: {\n    get: function () {\n      return this._extensions;\n    },\n  },\n});\n\nexport default Cesium3DTilesetMetadata;\n","import Intersect from \"../Core/Intersect.js\";\nimport ManagedArray from \"../Core/ManagedArray.js\";\nimport Cesium3DTileRefine from \"./Cesium3DTileRefine.js\";\n\n/**\n * Traversal that loads all leaves that intersect the camera frustum.\n * Used to determine ray-tileset intersections during a pickFromRayMostDetailed call.\n *\n * @private\n */\nfunction Cesium3DTilesetMostDetailedTraversal() {}\n\nconst traversal = {\n  stack: new ManagedArray(),\n  stackMaximumLength: 0,\n};\n\nCesium3DTilesetMostDetailedTraversal.selectTiles = function (\n  tileset,\n  frameState\n) {\n  tileset._selectedTiles.length = 0;\n  tileset._requestedTiles.length = 0;\n  tileset._hasMixedContent = false;\n\n  let ready = true;\n\n  const root = tileset.root;\n  root.updateVisibility(frameState);\n\n  if (!isVisible(root)) {\n    return ready;\n  }\n\n  const stack = traversal.stack;\n  stack.push(tileset.root);\n\n  while (stack.length > 0) {\n    traversal.stackMaximumLength = Math.max(\n      traversal.stackMaximumLength,\n      stack.length\n    );\n\n    const tile = stack.pop();\n    const add = tile.refine === Cesium3DTileRefine.ADD;\n    const replace = tile.refine === Cesium3DTileRefine.REPLACE;\n    const traverse = canTraverse(tileset, tile);\n\n    if (traverse) {\n      updateAndPushChildren(tileset, tile, stack, frameState);\n    }\n\n    if (add || (replace && !traverse)) {\n      loadTile(tileset, tile);\n      touchTile(tileset, tile, frameState);\n      selectDesiredTile(tileset, tile, frameState);\n\n      if (!hasEmptyContent(tile) && !tile.contentAvailable) {\n        ready = false;\n      }\n    }\n\n    visitTile(tileset);\n  }\n\n  traversal.stack.trim(traversal.stackMaximumLength);\n\n  return ready;\n};\n\nfunction isVisible(tile) {\n  return tile._visible && tile._inRequestVolume;\n}\n\nfunction hasEmptyContent(tile) {\n  return (\n    tile.hasEmptyContent || tile.hasTilesetContent || tile.hasImplicitContent\n  );\n}\n\nfunction hasUnloadedContent(tile) {\n  return !hasEmptyContent(tile) && tile.contentUnloaded;\n}\n\nfunction canTraverse(tileset, tile) {\n  if (tile.children.length === 0) {\n    return false;\n  }\n\n  if (tile.hasTilesetContent || tile.hasImplicitContent) {\n    // Traverse external tileset to visit its root tile\n    // Don't traverse if the subtree is expired because it will be destroyed\n    return !tile.contentExpired;\n  }\n\n  if (tile.hasEmptyContent) {\n    return true;\n  }\n\n  return true; // Keep traversing until a leave is hit\n}\n\nfunction updateAndPushChildren(tileset, tile, stack, frameState) {\n  const children = tile.children;\n  const length = children.length;\n\n  for (let i = 0; i < length; ++i) {\n    const child = children[i];\n    child.updateVisibility(frameState);\n    if (isVisible(child)) {\n      stack.push(child);\n    }\n  }\n}\n\nfunction loadTile(tileset, tile) {\n  if (hasUnloadedContent(tile) || tile.contentExpired) {\n    tile._priority = 0.0; // Highest priority\n    tileset._requestedTiles.push(tile);\n  }\n}\n\nfunction touchTile(tileset, tile, frameState) {\n  if (tile._touchedFrame === frameState.frameNumber) {\n    // Prevents another pass from touching the frame again\n    return;\n  }\n  tileset._cache.touch(tile);\n  tile._touchedFrame = frameState.frameNumber;\n}\n\nfunction visitTile(tileset) {\n  ++tileset.statistics.visited;\n}\n\nfunction selectDesiredTile(tileset, tile, frameState) {\n  if (\n    tile.contentAvailable &&\n    tile.contentVisibility(frameState) !== Intersect.OUTSIDE\n  ) {\n    tileset._selectedTiles.push(tile);\n  }\n}\nexport default Cesium3DTilesetMostDetailedTraversal;\n","import defined from \"../Core/defined.js\";\n\n/**\n * @private\n */\nfunction Cesium3DTilesetStatistics() {\n  // Rendering statistics\n  this.selected = 0;\n  this.visited = 0;\n  // Loading statistics\n  this.numberOfCommands = 0;\n  this.numberOfAttemptedRequests = 0;\n  this.numberOfPendingRequests = 0;\n  this.numberOfTilesProcessing = 0;\n  this.numberOfTilesWithContentReady = 0; // Number of tiles with content loaded, does not include empty tiles\n  this.numberOfTilesTotal = 0; // Number of tiles in tileset JSON (and other tileset JSON files as they are loaded)\n  this.numberOfLoadedTilesTotal = 0; // Running total of loaded tiles for the lifetime of the session\n  // Features statistics\n  this.numberOfFeaturesSelected = 0; // Number of features rendered\n  this.numberOfFeaturesLoaded = 0; // Number of features in memory\n  this.numberOfPointsSelected = 0;\n  this.numberOfPointsLoaded = 0;\n  this.numberOfTrianglesSelected = 0;\n  // Styling statistics\n  this.numberOfTilesStyled = 0;\n  this.numberOfFeaturesStyled = 0;\n  // Optimization statistics\n  this.numberOfTilesCulledWithChildrenUnion = 0;\n  // Memory statistics\n  this.geometryByteLength = 0;\n  this.texturesByteLength = 0;\n  this.batchTableByteLength = 0;\n}\n\nCesium3DTilesetStatistics.prototype.clear = function () {\n  this.selected = 0;\n  this.visited = 0;\n  this.numberOfCommands = 0;\n  this.numberOfAttemptedRequests = 0;\n  this.numberOfFeaturesSelected = 0;\n  this.numberOfPointsSelected = 0;\n  this.numberOfTrianglesSelected = 0;\n  this.numberOfTilesStyled = 0;\n  this.numberOfFeaturesStyled = 0;\n  this.numberOfTilesCulledWithChildrenUnion = 0;\n};\n\nfunction updatePointAndFeatureCounts(statistics, content, decrement, load) {\n  const contents = content.innerContents;\n  const pointsLength = content.pointsLength;\n  const trianglesLength = content.trianglesLength;\n  const featuresLength = content.featuresLength;\n  const geometryByteLength = content.geometryByteLength;\n  const texturesByteLength = content.texturesByteLength;\n  const batchTableByteLength = content.batchTableByteLength;\n\n  if (load) {\n    statistics.numberOfFeaturesLoaded += decrement\n      ? -featuresLength\n      : featuresLength;\n    statistics.numberOfPointsLoaded += decrement ? -pointsLength : pointsLength;\n    statistics.geometryByteLength += decrement\n      ? -geometryByteLength\n      : geometryByteLength;\n    statistics.texturesByteLength += decrement\n      ? -texturesByteLength\n      : texturesByteLength;\n    statistics.batchTableByteLength += decrement\n      ? -batchTableByteLength\n      : batchTableByteLength;\n  } else {\n    statistics.numberOfFeaturesSelected += decrement\n      ? -featuresLength\n      : featuresLength;\n    statistics.numberOfPointsSelected += decrement\n      ? -pointsLength\n      : pointsLength;\n    statistics.numberOfTrianglesSelected += decrement\n      ? -trianglesLength\n      : trianglesLength;\n  }\n\n  if (defined(contents)) {\n    const length = contents.length;\n    for (let i = 0; i < length; ++i) {\n      updatePointAndFeatureCounts(statistics, contents[i], decrement, load);\n    }\n  }\n}\n\nCesium3DTilesetStatistics.prototype.incrementSelectionCounts = function (\n  content\n) {\n  updatePointAndFeatureCounts(this, content, false, false);\n};\n\nCesium3DTilesetStatistics.prototype.incrementLoadCounts = function (content) {\n  updatePointAndFeatureCounts(this, content, false, true);\n};\n\nCesium3DTilesetStatistics.prototype.decrementLoadCounts = function (content) {\n  updatePointAndFeatureCounts(this, content, true, true);\n};\n\nCesium3DTilesetStatistics.clone = function (statistics, result) {\n  result.selected = statistics.selected;\n  result.visited = statistics.visited;\n  result.numberOfCommands = statistics.numberOfCommands;\n  result.selected = statistics.selected;\n  result.numberOfAttemptedRequests = statistics.numberOfAttemptedRequests;\n  result.numberOfPendingRequests = statistics.numberOfPendingRequests;\n  result.numberOfTilesProcessing = statistics.numberOfTilesProcessing;\n  result.numberOfTilesWithContentReady =\n    statistics.numberOfTilesWithContentReady;\n  result.numberOfTilesTotal = statistics.numberOfTilesTotal;\n  result.numberOfFeaturesSelected = statistics.numberOfFeaturesSelected;\n  result.numberOfFeaturesLoaded = statistics.numberOfFeaturesLoaded;\n  result.numberOfPointsSelected = statistics.numberOfPointsSelected;\n  result.numberOfPointsLoaded = statistics.numberOfPointsLoaded;\n  result.numberOfTrianglesSelected = statistics.numberOfTrianglesSelected;\n  result.numberOfTilesStyled = statistics.numberOfTilesStyled;\n  result.numberOfFeaturesStyled = statistics.numberOfFeaturesStyled;\n  result.numberOfTilesCulledWithChildrenUnion =\n    statistics.numberOfTilesCulledWithChildrenUnion;\n  result.geometryByteLength = statistics.geometryByteLength;\n  result.texturesByteLength = statistics.texturesByteLength;\n  result.batchTableByteLength = statistics.batchTableByteLength;\n};\nexport default Cesium3DTilesetStatistics;\n","import defined from \"../Core/defined.js\";\nimport Intersect from \"../Core/Intersect.js\";\nimport ManagedArray from \"../Core/ManagedArray.js\";\nimport Cesium3DTileOptimizationHint from \"./Cesium3DTileOptimizationHint.js\";\nimport Cesium3DTileRefine from \"./Cesium3DTileRefine.js\";\n\n/**\n * @private\n */\nfunction Cesium3DTilesetTraversal() {}\n\nfunction isVisible(tile) {\n  return tile._visible && tile._inRequestVolume;\n}\n\nconst traversal = {\n  stack: new ManagedArray(),\n  stackMaximumLength: 0,\n};\n\nconst emptyTraversal = {\n  stack: new ManagedArray(),\n  stackMaximumLength: 0,\n};\n\nconst descendantTraversal = {\n  stack: new ManagedArray(),\n  stackMaximumLength: 0,\n};\n\nconst selectionTraversal = {\n  stack: new ManagedArray(),\n  stackMaximumLength: 0,\n  ancestorStack: new ManagedArray(),\n  ancestorStackMaximumLength: 0,\n};\n\nconst descendantSelectionDepth = 2;\n\nCesium3DTilesetTraversal.selectTiles = function (tileset, frameState) {\n  tileset._requestedTiles.length = 0;\n\n  if (tileset.debugFreezeFrame) {\n    return;\n  }\n\n  tileset._selectedTiles.length = 0;\n  tileset._selectedTilesToStyle.length = 0;\n  tileset._emptyTiles.length = 0;\n  tileset._hasMixedContent = false;\n\n  const root = tileset.root;\n  updateTile(tileset, root, frameState);\n\n  // The root tile is not visible\n  if (!isVisible(root)) {\n    return;\n  }\n\n  // The tileset doesn't meet the SSE requirement, therefore the tree does not need to be rendered\n  if (\n    root.getScreenSpaceError(frameState, true) <=\n    tileset._maximumScreenSpaceError\n  ) {\n    return;\n  }\n\n  if (!skipLevelOfDetail(tileset)) {\n    executeBaseTraversal(tileset, root, frameState);\n  } else if (tileset.immediatelyLoadDesiredLevelOfDetail) {\n    executeSkipTraversal(tileset, root, frameState);\n  } else {\n    executeBaseAndSkipTraversal(tileset, root, frameState);\n  }\n\n  traversal.stack.trim(traversal.stackMaximumLength);\n  emptyTraversal.stack.trim(emptyTraversal.stackMaximumLength);\n  descendantTraversal.stack.trim(descendantTraversal.stackMaximumLength);\n  selectionTraversal.stack.trim(selectionTraversal.stackMaximumLength);\n  selectionTraversal.ancestorStack.trim(\n    selectionTraversal.ancestorStackMaximumLength\n  );\n\n  // Update the priority for any requests found during traversal\n  // Update after traversal so that min and max values can be used to normalize priority values\n  const requestedTiles = tileset._requestedTiles;\n  const length = requestedTiles.length;\n  for (let i = 0; i < length; ++i) {\n    requestedTiles[i].updatePriority();\n  }\n};\n\nfunction executeBaseTraversal(tileset, root, frameState) {\n  const baseScreenSpaceError = tileset._maximumScreenSpaceError;\n  const maximumScreenSpaceError = tileset._maximumScreenSpaceError;\n  executeTraversal(\n    tileset,\n    root,\n    baseScreenSpaceError,\n    maximumScreenSpaceError,\n    frameState\n  );\n}\n\nfunction executeSkipTraversal(tileset, root, frameState) {\n  const baseScreenSpaceError = Number.MAX_VALUE;\n  const maximumScreenSpaceError = tileset._maximumScreenSpaceError;\n  executeTraversal(\n    tileset,\n    root,\n    baseScreenSpaceError,\n    maximumScreenSpaceError,\n    frameState\n  );\n  traverseAndSelect(tileset, root, frameState);\n}\n\nfunction executeBaseAndSkipTraversal(tileset, root, frameState) {\n  const baseScreenSpaceError = Math.max(\n    tileset.baseScreenSpaceError,\n    tileset.maximumScreenSpaceError\n  );\n  const maximumScreenSpaceError = tileset.maximumScreenSpaceError;\n  executeTraversal(\n    tileset,\n    root,\n    baseScreenSpaceError,\n    maximumScreenSpaceError,\n    frameState\n  );\n  traverseAndSelect(tileset, root, frameState);\n}\n\nfunction skipLevelOfDetail(tileset) {\n  return tileset._skipLevelOfDetail;\n}\n\nfunction addEmptyTile(tileset, tile) {\n  tileset._emptyTiles.push(tile);\n}\n\nfunction selectTile(tileset, tile, frameState) {\n  if (tile.contentVisibility(frameState) !== Intersect.OUTSIDE) {\n    const tileContent = tile.content;\n    if (tileContent.featurePropertiesDirty) {\n      // A feature's property in this tile changed, the tile needs to be re-styled.\n      tileContent.featurePropertiesDirty = false;\n      tile.lastStyleTime = 0; // Force applying the style to this tile\n      tileset._selectedTilesToStyle.push(tile);\n    } else if (tile._selectedFrame < frameState.frameNumber - 1) {\n      // Tile is newly selected; it is selected this frame, but was not selected last frame.\n      tileset._selectedTilesToStyle.push(tile);\n    }\n    tile._selectedFrame = frameState.frameNumber;\n    tileset._selectedTiles.push(tile);\n  }\n}\n\nfunction selectDescendants(tileset, root, frameState) {\n  const stack = descendantTraversal.stack;\n  stack.push(root);\n  while (stack.length > 0) {\n    descendantTraversal.stackMaximumLength = Math.max(\n      descendantTraversal.stackMaximumLength,\n      stack.length\n    );\n    const tile = stack.pop();\n    const children = tile.children;\n    const childrenLength = children.length;\n    for (let i = 0; i < childrenLength; ++i) {\n      const child = children[i];\n      if (isVisible(child)) {\n        if (child.contentAvailable) {\n          updateTile(tileset, child, frameState);\n          touchTile(tileset, child, frameState);\n          selectTile(tileset, child, frameState);\n        } else if (child._depth - root._depth < descendantSelectionDepth) {\n          // Continue traversing, but not too far\n          stack.push(child);\n        }\n      }\n    }\n  }\n}\n\nfunction selectDesiredTile(tileset, tile, frameState) {\n  if (!skipLevelOfDetail(tileset)) {\n    if (tile.contentAvailable) {\n      // The tile can be selected right away and does not require traverseAndSelect\n      selectTile(tileset, tile, frameState);\n    }\n    return;\n  }\n\n  // If this tile is not loaded attempt to select its ancestor instead\n  const loadedTile = tile.contentAvailable\n    ? tile\n    : tile._ancestorWithContentAvailable;\n  if (defined(loadedTile)) {\n    // Tiles will actually be selected in traverseAndSelect\n    loadedTile._shouldSelect = true;\n  } else {\n    // If no ancestors are ready traverse down and select tiles to minimize empty regions.\n    // This happens often for immediatelyLoadDesiredLevelOfDetail where parent tiles are not necessarily loaded before zooming out.\n    selectDescendants(tileset, tile, frameState);\n  }\n}\n\nfunction visitTile(tileset, tile, frameState) {\n  ++tileset._statistics.visited;\n  tile._visitedFrame = frameState.frameNumber;\n}\n\nfunction touchTile(tileset, tile, frameState) {\n  if (tile._touchedFrame === frameState.frameNumber) {\n    // Prevents another pass from touching the frame again\n    return;\n  }\n  tileset._cache.touch(tile);\n  tile._touchedFrame = frameState.frameNumber;\n}\n\nfunction updateMinimumMaximumPriority(tileset, tile) {\n  tileset._maximumPriority.distance = Math.max(\n    tile._priorityHolder._distanceToCamera,\n    tileset._maximumPriority.distance\n  );\n  tileset._minimumPriority.distance = Math.min(\n    tile._priorityHolder._distanceToCamera,\n    tileset._minimumPriority.distance\n  );\n  tileset._maximumPriority.depth = Math.max(\n    tile._depth,\n    tileset._maximumPriority.depth\n  );\n  tileset._minimumPriority.depth = Math.min(\n    tile._depth,\n    tileset._minimumPriority.depth\n  );\n  tileset._maximumPriority.foveatedFactor = Math.max(\n    tile._priorityHolder._foveatedFactor,\n    tileset._maximumPriority.foveatedFactor\n  );\n  tileset._minimumPriority.foveatedFactor = Math.min(\n    tile._priorityHolder._foveatedFactor,\n    tileset._minimumPriority.foveatedFactor\n  );\n  tileset._maximumPriority.reverseScreenSpaceError = Math.max(\n    tile._priorityReverseScreenSpaceError,\n    tileset._maximumPriority.reverseScreenSpaceError\n  );\n  tileset._minimumPriority.reverseScreenSpaceError = Math.min(\n    tile._priorityReverseScreenSpaceError,\n    tileset._minimumPriority.reverseScreenSpaceError\n  );\n}\n\nfunction isOnScreenLongEnough(tileset, tile, frameState) {\n  // Prevent unnecessary loads while camera is moving by getting the ratio of travel distance to tile size.\n  if (!tileset._cullRequestsWhileMoving) {\n    return true;\n  }\n\n  const sphere = tile.boundingSphere;\n  const diameter = Math.max(sphere.radius * 2.0, 1.0);\n\n  const camera = frameState.camera;\n  const deltaMagnitude =\n    camera.positionWCDeltaMagnitude !== 0.0\n      ? camera.positionWCDeltaMagnitude\n      : camera.positionWCDeltaMagnitudeLastFrame;\n  const movementRatio =\n    (tileset.cullRequestsWhileMovingMultiplier * deltaMagnitude) / diameter; // How do n frames of this movement compare to the tile's physical size.\n  return movementRatio < 1.0;\n}\n\nfunction loadTile(tileset, tile, frameState) {\n  if (\n    tile._requestedFrame === frameState.frameNumber ||\n    (!hasUnloadedContent(tile) && !tile.contentExpired)\n  ) {\n    return;\n  }\n\n  if (!isOnScreenLongEnough(tileset, tile, frameState)) {\n    return;\n  }\n\n  const cameraHasNotStoppedMovingLongEnough =\n    frameState.camera.timeSinceMoved < tileset.foveatedTimeDelay;\n  if (tile.priorityDeferred && cameraHasNotStoppedMovingLongEnough) {\n    return;\n  }\n\n  tile._requestedFrame = frameState.frameNumber;\n  tileset._requestedTiles.push(tile);\n}\n\nfunction updateVisibility(tileset, tile, frameState) {\n  if (tile._updatedVisibilityFrame === tileset._updatedVisibilityFrame) {\n    // Return early if visibility has already been checked during the traversal.\n    // The visibility may have already been checked if the cullWithChildrenBounds optimization is used.\n    return;\n  }\n\n  tile.updateVisibility(frameState);\n  tile._updatedVisibilityFrame = tileset._updatedVisibilityFrame;\n}\n\nfunction anyChildrenVisible(tileset, tile, frameState) {\n  let anyVisible = false;\n  const children = tile.children;\n  const length = children.length;\n  for (let i = 0; i < length; ++i) {\n    const child = children[i];\n    updateVisibility(tileset, child, frameState);\n    anyVisible = anyVisible || isVisible(child);\n  }\n  return anyVisible;\n}\n\nfunction meetsScreenSpaceErrorEarly(tileset, tile, frameState) {\n  const parent = tile.parent;\n  if (\n    !defined(parent) ||\n    parent.hasTilesetContent ||\n    parent.hasImplicitContent ||\n    parent.refine !== Cesium3DTileRefine.ADD\n  ) {\n    return false;\n  }\n\n  // Use parent's geometric error with child's box to see if the tile already meet the SSE\n  return (\n    tile.getScreenSpaceError(frameState, true) <=\n    tileset._maximumScreenSpaceError\n  );\n}\n\nfunction updateTileVisibility(tileset, tile, frameState) {\n  updateVisibility(tileset, tile, frameState);\n\n  if (!isVisible(tile)) {\n    return;\n  }\n\n  const hasChildren = tile.children.length > 0;\n  if ((tile.hasTilesetContent || tile.hasImplicitContent) && hasChildren) {\n    // Use the root tile's visibility instead of this tile's visibility.\n    // The root tile may be culled by the children bounds optimization in which\n    // case this tile should also be culled.\n    const child = tile.children[0];\n    updateTileVisibility(tileset, child, frameState);\n    tile._visible = child._visible;\n    return;\n  }\n\n  if (meetsScreenSpaceErrorEarly(tileset, tile, frameState)) {\n    tile._visible = false;\n    return;\n  }\n\n  // Optimization - if none of the tile's children are visible then this tile isn't visible\n  const replace = tile.refine === Cesium3DTileRefine.REPLACE;\n  const useOptimization =\n    tile._optimChildrenWithinParent ===\n    Cesium3DTileOptimizationHint.USE_OPTIMIZATION;\n  if (replace && useOptimization && hasChildren) {\n    if (!anyChildrenVisible(tileset, tile, frameState)) {\n      ++tileset._statistics.numberOfTilesCulledWithChildrenUnion;\n      tile._visible = false;\n      return;\n    }\n  }\n}\n\nfunction updateTile(tileset, tile, frameState) {\n  // Reset some of the tile's flags and re-evaluate visibility\n  updateTileVisibility(tileset, tile, frameState);\n  tile.updateExpiration();\n\n  // Request priority\n  tile._wasMinPriorityChild = false;\n  tile._priorityHolder = tile;\n  updateMinimumMaximumPriority(tileset, tile);\n\n  // SkipLOD\n  tile._shouldSelect = false;\n  tile._finalResolution = true;\n}\n\nfunction updateTileAncestorContentLinks(tile, frameState) {\n  tile._ancestorWithContent = undefined;\n  tile._ancestorWithContentAvailable = undefined;\n\n  const parent = tile.parent;\n  if (defined(parent)) {\n    // ancestorWithContent is an ancestor that has content or has the potential to have\n    // content. Used in conjunction with tileset.skipLevels to know when to skip a tile.\n    // ancestorWithContentAvailable is an ancestor that is rendered if a desired tile is not loaded.\n    const hasContent =\n      !hasUnloadedContent(parent) ||\n      parent._requestedFrame === frameState.frameNumber;\n    tile._ancestorWithContent = hasContent\n      ? parent\n      : parent._ancestorWithContent;\n    tile._ancestorWithContentAvailable = parent.contentAvailable\n      ? parent\n      : parent._ancestorWithContentAvailable; // Links a descendant up to its contentAvailable ancestor as the traversal progresses.\n  }\n}\n\nfunction hasEmptyContent(tile) {\n  return (\n    tile.hasEmptyContent || tile.hasTilesetContent || tile.hasImplicitContent\n  );\n}\n\nfunction hasUnloadedContent(tile) {\n  return !hasEmptyContent(tile) && tile.contentUnloaded;\n}\n\nfunction reachedSkippingThreshold(tileset, tile) {\n  const ancestor = tile._ancestorWithContent;\n  return (\n    !tileset.immediatelyLoadDesiredLevelOfDetail &&\n    (tile._priorityProgressiveResolutionScreenSpaceErrorLeaf ||\n      (defined(ancestor) &&\n        tile._screenSpaceError <\n          ancestor._screenSpaceError / tileset.skipScreenSpaceErrorFactor &&\n        tile._depth > ancestor._depth + tileset.skipLevels))\n  );\n}\n\nfunction sortChildrenByDistanceToCamera(a, b) {\n  // Sort by farthest child first since this is going on a stack\n  if (b._distanceToCamera === 0 && a._distanceToCamera === 0) {\n    return b._centerZDepth - a._centerZDepth;\n  }\n\n  return b._distanceToCamera - a._distanceToCamera;\n}\n\nfunction updateAndPushChildren(tileset, tile, stack, frameState) {\n  let i;\n  const replace = tile.refine === Cesium3DTileRefine.REPLACE;\n  const children = tile.children;\n  const length = children.length;\n\n  for (i = 0; i < length; ++i) {\n    updateTile(tileset, children[i], frameState);\n  }\n\n  // Sort by distance to take advantage of early Z and reduce artifacts for skipLevelOfDetail\n  children.sort(sortChildrenByDistanceToCamera);\n\n  // For traditional replacement refinement only refine if all children are loaded.\n  // Empty tiles are exempt since it looks better if children stream in as they are loaded to fill the empty space.\n  const checkRefines =\n    !skipLevelOfDetail(tileset) && replace && !hasEmptyContent(tile);\n  let refines = true;\n\n  let anyChildrenVisible = false;\n\n  // Determining min child\n  let minIndex = -1;\n  let minimumPriority = Number.MAX_VALUE;\n\n  let child;\n  for (i = 0; i < length; ++i) {\n    child = children[i];\n    if (isVisible(child)) {\n      stack.push(child);\n      if (child._foveatedFactor < minimumPriority) {\n        minIndex = i;\n        minimumPriority = child._foveatedFactor;\n      }\n      anyChildrenVisible = true;\n    } else if (checkRefines || tileset.loadSiblings) {\n      // Keep non-visible children loaded since they are still needed before the parent can refine.\n      // Or loadSiblings is true so always load tiles regardless of visibility.\n      if (child._foveatedFactor < minimumPriority) {\n        minIndex = i;\n        minimumPriority = child._foveatedFactor;\n      }\n      loadTile(tileset, child, frameState);\n      touchTile(tileset, child, frameState);\n    }\n    if (checkRefines) {\n      let childRefines;\n      if (!child._inRequestVolume) {\n        childRefines = false;\n      } else if (hasEmptyContent(child)) {\n        childRefines = executeEmptyTraversal(tileset, child, frameState);\n      } else {\n        childRefines = child.contentAvailable;\n      }\n      refines = refines && childRefines;\n    }\n  }\n\n  if (!anyChildrenVisible) {\n    refines = false;\n  }\n\n  if (minIndex !== -1 && !skipLevelOfDetail(tileset) && replace) {\n    // An ancestor will hold the _foveatedFactor and _distanceToCamera for descendants between itself and its highest priority descendant. Siblings of a min children along the way use this ancestor as their priority holder as well.\n    // Priority of all tiles that refer to the _foveatedFactor and _distanceToCamera stored in the common ancestor will be differentiated based on their _depth.\n    const minPriorityChild = children[minIndex];\n    minPriorityChild._wasMinPriorityChild = true;\n    const priorityHolder =\n      (tile._wasMinPriorityChild || tile === tileset.root) &&\n      minimumPriority <= tile._priorityHolder._foveatedFactor\n        ? tile._priorityHolder\n        : tile; // This is where priority dependency chains are wired up or started anew.\n    priorityHolder._foveatedFactor = Math.min(\n      minPriorityChild._foveatedFactor,\n      priorityHolder._foveatedFactor\n    );\n    priorityHolder._distanceToCamera = Math.min(\n      minPriorityChild._distanceToCamera,\n      priorityHolder._distanceToCamera\n    );\n\n    for (i = 0; i < length; ++i) {\n      child = children[i];\n      child._priorityHolder = priorityHolder;\n    }\n  }\n\n  return refines;\n}\n\nfunction inBaseTraversal(tileset, tile, baseScreenSpaceError) {\n  if (!skipLevelOfDetail(tileset)) {\n    return true;\n  }\n  if (tileset.immediatelyLoadDesiredLevelOfDetail) {\n    return false;\n  }\n  if (!defined(tile._ancestorWithContent)) {\n    // Include root or near-root tiles in the base traversal so there is something to select up to\n    return true;\n  }\n  if (tile._screenSpaceError === 0.0) {\n    // If a leaf, use parent's SSE\n    return tile.parent._screenSpaceError > baseScreenSpaceError;\n  }\n  return tile._screenSpaceError > baseScreenSpaceError;\n}\n\nfunction canTraverse(tileset, tile) {\n  if (tile.children.length === 0) {\n    return false;\n  }\n  if (tile.hasTilesetContent || tile.hasImplicitContent) {\n    // Traverse external tileset to visit its root tile\n    // Don't traverse if the subtree is expired because it will be destroyed\n    return !tile.contentExpired;\n  }\n  return tile._screenSpaceError > tileset._maximumScreenSpaceError;\n}\n\nfunction executeTraversal(\n  tileset,\n  root,\n  baseScreenSpaceError,\n  maximumScreenSpaceError,\n  frameState\n) {\n  // Depth-first traversal that traverses all visible tiles and marks tiles for selection.\n  // If skipLevelOfDetail is off then a tile does not refine until all children are loaded.\n  // This is the traditional replacement refinement approach and is called the base traversal.\n  // Tiles that have a greater screen space error than the base screen space error are part of the base traversal,\n  // all other tiles are part of the skip traversal. The skip traversal allows for skipping levels of the tree\n  // and rendering children and parent tiles simultaneously.\n  const stack = traversal.stack;\n  stack.push(root);\n\n  while (stack.length > 0) {\n    traversal.stackMaximumLength = Math.max(\n      traversal.stackMaximumLength,\n      stack.length\n    );\n\n    const tile = stack.pop();\n\n    updateTileAncestorContentLinks(tile, frameState);\n    const baseTraversal = inBaseTraversal(tileset, tile, baseScreenSpaceError);\n    const add = tile.refine === Cesium3DTileRefine.ADD;\n    const replace = tile.refine === Cesium3DTileRefine.REPLACE;\n    const parent = tile.parent;\n    const parentRefines = !defined(parent) || parent._refines;\n    let refines = false;\n\n    if (canTraverse(tileset, tile)) {\n      refines =\n        updateAndPushChildren(tileset, tile, stack, frameState) &&\n        parentRefines;\n    }\n\n    const stoppedRefining = !refines && parentRefines;\n\n    if (hasEmptyContent(tile)) {\n      // Add empty tile just to show its debug bounding volume\n      // If the tile has tileset content load the external tileset\n      // If the tile cannot refine further select its nearest loaded ancestor\n      addEmptyTile(tileset, tile, frameState);\n      loadTile(tileset, tile, frameState);\n      if (stoppedRefining) {\n        selectDesiredTile(tileset, tile, frameState);\n      }\n    } else if (add) {\n      // Additive tiles are always loaded and selected\n      selectDesiredTile(tileset, tile, frameState);\n      loadTile(tileset, tile, frameState);\n    } else if (replace) {\n      if (baseTraversal) {\n        // Always load tiles in the base traversal\n        // Select tiles that can't refine further\n        loadTile(tileset, tile, frameState);\n        if (stoppedRefining) {\n          selectDesiredTile(tileset, tile, frameState);\n        }\n      } else if (stoppedRefining) {\n        // In skip traversal, load and select tiles that can't refine further\n        selectDesiredTile(tileset, tile, frameState);\n        loadTile(tileset, tile, frameState);\n      } else if (reachedSkippingThreshold(tileset, tile)) {\n        // In skip traversal, load tiles that aren't skipped. In practice roughly half the tiles stay unloaded.\n        loadTile(tileset, tile, frameState);\n      }\n    }\n\n    visitTile(tileset, tile, frameState);\n    touchTile(tileset, tile, frameState);\n    tile._refines = refines;\n  }\n}\n\nfunction executeEmptyTraversal(tileset, root, frameState) {\n  // Depth-first traversal that checks if all nearest descendants with content are loaded. Ignores visibility.\n  let allDescendantsLoaded = true;\n  const stack = emptyTraversal.stack;\n  stack.push(root);\n\n  while (stack.length > 0) {\n    emptyTraversal.stackMaximumLength = Math.max(\n      emptyTraversal.stackMaximumLength,\n      stack.length\n    );\n\n    const tile = stack.pop();\n    const children = tile.children;\n    const childrenLength = children.length;\n\n    // Only traverse if the tile is empty - traversal stop at descendants with content\n    const emptyContent = hasEmptyContent(tile);\n    const traverse = emptyContent && canTraverse(tileset, tile);\n    const emptyLeaf = emptyContent && tile.children.length === 0;\n\n    // Traversal stops but the tile does not have content yet\n    // There will be holes if the parent tries to refine to its children, so don't refine\n    // One exception: a parent may refine even if one of its descendants is an empty leaf\n    if (!traverse && !tile.contentAvailable && !emptyLeaf) {\n      allDescendantsLoaded = false;\n    }\n\n    updateTile(tileset, tile, frameState);\n    if (!isVisible(tile)) {\n      // Load tiles that aren't visible since they are still needed for the parent to refine\n      loadTile(tileset, tile, frameState);\n      touchTile(tileset, tile, frameState);\n    }\n\n    if (traverse) {\n      for (let i = 0; i < childrenLength; ++i) {\n        const child = children[i];\n        stack.push(child);\n      }\n    }\n  }\n\n  return allDescendantsLoaded;\n}\n\n/**\n * Traverse the tree and check if their selected frame is the current frame. If so, add it to a selection queue.\n * This is a preorder traversal so children tiles are selected before ancestor tiles.\n *\n * The reason for the preorder traversal is so that tiles can easily be marked with their\n * selection depth. A tile's _selectionDepth is its depth in the tree where all non-selected tiles are removed.\n * This property is important for use in the stencil test because we want to render deeper tiles on top of their\n * ancestors. If a tileset is very deep, the depth is unlikely to fit into the stencil buffer.\n *\n * We want to select children before their ancestors because there is no guarantee on the relationship between\n * the children's z-depth and the ancestor's z-depth. We cannot rely on Z because we want the child to appear on top\n * of ancestor regardless of true depth. The stencil tests used require children to be drawn first.\n *\n * NOTE: 3D Tiles uses 3 bits from the stencil buffer meaning this will not work when there is a chain of\n * selected tiles that is deeper than 7. This is not very likely.\n * @private\n */\nfunction traverseAndSelect(tileset, root, frameState) {\n  const stack = selectionTraversal.stack;\n  const ancestorStack = selectionTraversal.ancestorStack;\n  let lastAncestor;\n\n  stack.push(root);\n\n  while (stack.length > 0 || ancestorStack.length > 0) {\n    selectionTraversal.stackMaximumLength = Math.max(\n      selectionTraversal.stackMaximumLength,\n      stack.length\n    );\n    selectionTraversal.ancestorStackMaximumLength = Math.max(\n      selectionTraversal.ancestorStackMaximumLength,\n      ancestorStack.length\n    );\n\n    if (ancestorStack.length > 0) {\n      const waitingTile = ancestorStack.peek();\n      if (waitingTile._stackLength === stack.length) {\n        ancestorStack.pop();\n        if (waitingTile !== lastAncestor) {\n          waitingTile._finalResolution = false;\n        }\n        selectTile(tileset, waitingTile, frameState);\n        continue;\n      }\n    }\n\n    const tile = stack.pop();\n    if (!defined(tile)) {\n      // stack is empty but ancestorStack isn't\n      continue;\n    }\n\n    const add = tile.refine === Cesium3DTileRefine.ADD;\n    const shouldSelect = tile._shouldSelect;\n    const children = tile.children;\n    const childrenLength = children.length;\n    const traverse = canTraverse(tileset, tile);\n\n    if (shouldSelect) {\n      if (add) {\n        selectTile(tileset, tile, frameState);\n      } else {\n        tile._selectionDepth = ancestorStack.length;\n        if (tile._selectionDepth > 0) {\n          tileset._hasMixedContent = true;\n        }\n        lastAncestor = tile;\n        if (!traverse) {\n          selectTile(tileset, tile, frameState);\n          continue;\n        }\n        ancestorStack.push(tile);\n        tile._stackLength = stack.length;\n      }\n    }\n\n    if (traverse) {\n      for (let i = 0; i < childrenLength; ++i) {\n        const child = children[i];\n        if (isVisible(child)) {\n          stack.push(child);\n        }\n      }\n    }\n  }\n}\nexport default Cesium3DTilesetTraversal;\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport CesiumMath from \"../Core/Math.js\";\n\n/**\n * A ParticleEmitter that emits particles from a circle.\n * Particles will be positioned within a circle and have initial velocities going along the z vector.\n *\n * @alias CircleEmitter\n * @constructor\n *\n * @param {Number} [radius=1.0] The radius of the circle in meters.\n */\nfunction CircleEmitter(radius) {\n  radius = defaultValue(radius, 1.0);\n\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.number.greaterThan(\"radius\", radius, 0.0);\n  //>>includeEnd('debug');\n\n  this._radius = defaultValue(radius, 1.0);\n}\n\nObject.defineProperties(CircleEmitter.prototype, {\n  /**\n   * The radius of the circle in meters.\n   * @memberof CircleEmitter.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  radius: {\n    get: function () {\n      return this._radius;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number.greaterThan(\"value\", value, 0.0);\n      //>>includeEnd('debug');\n      this._radius = value;\n    },\n  },\n});\n\n/**\n * Initializes the given {@link Particle} by setting it's position and velocity.\n *\n * @private\n * @param {Particle} particle The particle to initialize.\n */\nCircleEmitter.prototype.emit = function (particle) {\n  const theta = CesiumMath.randomBetween(0.0, CesiumMath.TWO_PI);\n  const rad = CesiumMath.randomBetween(0.0, this._radius);\n\n  const x = rad * Math.cos(theta);\n  const y = rad * Math.sin(theta);\n  const z = 0.0;\n\n  particle.position = Cartesian3.fromElements(x, y, z, particle.position);\n  particle.velocity = Cartesian3.clone(Cartesian3.UNIT_Z, particle.velocity);\n};\nexport default CircleEmitter;\n","import arraySlice from \"../Core/arraySlice.js\";\nimport BoundingSphere from \"../Core/BoundingSphere.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartesian4 from \"../Core/Cartesian4.js\";\nimport Color from \"../Core/Color.js\";\nimport combine from \"../Core/combine.js\";\nimport ComponentDatatype from \"../Core/ComponentDatatype.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defer from \"../Core/defer.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport FeatureDetection from \"../Core/FeatureDetection.js\";\nimport IndexDatatype from \"../Core/IndexDatatype.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport PrimitiveType from \"../Core/PrimitiveType.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport Transforms from \"../Core/Transforms.js\";\nimport WebGLConstants from \"../Core/WebGLConstants.js\";\nimport addDefaults from \"./GltfPipeline/addDefaults.js\";\nimport ForEach from \"./GltfPipeline/ForEach.js\";\nimport getAccessorByteStride from \"./GltfPipeline/getAccessorByteStride.js\";\nimport numberOfComponentsForType from \"./GltfPipeline/numberOfComponentsForType.js\";\nimport parseGlb from \"./GltfPipeline/parseGlb.js\";\nimport updateVersion from \"./GltfPipeline/updateVersion.js\";\nimport Axis from \"./Axis.js\";\nimport ModelLoadResources from \"./ModelLoadResources.js\";\nimport ModelUtility from \"./ModelUtility.js\";\nimport processModelMaterialsCommon from \"./processModelMaterialsCommon.js\";\nimport processPbrMaterials from \"./processPbrMaterials.js\";\nimport SceneMode from \"./SceneMode.js\";\nimport Vector3DTileBatch from \"./Vector3DTileBatch.js\";\nimport Vector3DTilePrimitive from \"./Vector3DTilePrimitive.js\";\n\nconst boundingSphereCartesian3Scratch = new Cartesian3();\n\nconst ModelState = ModelUtility.ModelState;\n\n///////////////////////////////////////////////////////////////////////////\n\n/**\n * A 3D model for classifying other 3D assets based on glTF, the runtime 3D asset format.\n * This is a special case when a model of a 3D tileset becomes a classifier when setting {@link Cesium3DTileset#classificationType}.\n *\n * @alias ClassificationModel\n * @constructor\n *\n * @private\n *\n * @param {Object} options Object with the following properties:\n * @param {ArrayBuffer|Uint8Array} options.gltf A binary glTF buffer.\n * @param {Boolean} [options.show=true] Determines if the model primitive will be shown.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the model from model to world coordinates.\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. Draws the bounding sphere for each draw command in the model.\n * @param {Boolean} [options.debugWireframe=false] For debugging only. Draws the model in wireframe.\n * @param {ClassificationType} [options.classificationType] What this model will classify.\n *\n * @exception {RuntimeError} Only binary glTF is supported.\n * @exception {RuntimeError} Buffer data must be embedded in the binary glTF.\n * @exception {RuntimeError} Only one node is supported for classification and it must have a mesh.\n * @exception {RuntimeError} Only one mesh is supported when using b3dm for classification.\n * @exception {RuntimeError} Only one primitive per mesh is supported when using b3dm for classification.\n * @exception {RuntimeError} The mesh must have a position attribute.\n * @exception {RuntimeError} The mesh must have a batch id attribute.\n */\nfunction ClassificationModel(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  let gltf = options.gltf;\n  if (gltf instanceof ArrayBuffer) {\n    gltf = new Uint8Array(gltf);\n  }\n\n  if (gltf instanceof Uint8Array) {\n    // Parse and update binary glTF\n    gltf = parseGlb(gltf);\n    updateVersion(gltf);\n    addDefaults(gltf);\n    processModelMaterialsCommon(gltf);\n    processPbrMaterials(gltf);\n  } else {\n    throw new RuntimeError(\"Only binary glTF is supported as a classifier.\");\n  }\n\n  ForEach.buffer(gltf, function (buffer) {\n    if (!defined(buffer.extras._pipeline.source)) {\n      throw new RuntimeError(\n        \"Buffer data must be embedded in the binary gltf.\"\n      );\n    }\n  });\n\n  const gltfNodes = gltf.nodes;\n  const gltfMeshes = gltf.meshes;\n\n  const gltfNode = gltfNodes[0];\n  const meshId = gltfNode.mesh;\n  if (gltfNodes.length !== 1 || !defined(meshId)) {\n    throw new RuntimeError(\n      \"Only one node is supported for classification and it must have a mesh.\"\n    );\n  }\n\n  if (gltfMeshes.length !== 1) {\n    throw new RuntimeError(\n      \"Only one mesh is supported when using b3dm for classification.\"\n    );\n  }\n\n  const gltfPrimitives = gltfMeshes[0].primitives;\n  if (gltfPrimitives.length !== 1) {\n    throw new RuntimeError(\n      \"Only one primitive per mesh is supported when using b3dm for classification.\"\n    );\n  }\n\n  const gltfPositionAttribute = gltfPrimitives[0].attributes.POSITION;\n  if (!defined(gltfPositionAttribute)) {\n    throw new RuntimeError(\"The mesh must have a position attribute.\");\n  }\n\n  const gltfBatchIdAttribute = gltfPrimitives[0].attributes._BATCHID;\n  if (!defined(gltfBatchIdAttribute)) {\n    throw new RuntimeError(\"The mesh must have a batch id attribute.\");\n  }\n\n  this._gltf = gltf;\n\n  /**\n   * Determines if the model primitive will be shown.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n\n  /**\n   * The 4x4 transformation matrix that transforms the model from model to world coordinates.\n   * When this is the identity matrix, the model is drawn in world coordinates, i.e., Earth's WGS84 coordinates.\n   * Local reference frames can be used by providing a different transformation matrix, like that returned\n   * by {@link Transforms.eastNorthUpToFixedFrame}.\n   *\n   * @type {Matrix4}\n   *\n   * @default {@link Matrix4.IDENTITY}\n   *\n   * @example\n   * const origin = Cesium.Cartesian3.fromDegrees(-95.0, 40.0, 200000.0);\n   * m.modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(origin);\n   */\n  this.modelMatrix = Matrix4.clone(\n    defaultValue(options.modelMatrix, Matrix4.IDENTITY)\n  );\n  this._modelMatrix = Matrix4.clone(this.modelMatrix);\n\n  this._ready = false;\n  this._readyPromise = defer();\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the bounding sphere for each draw command in the model.  A glTF primitive corresponds\n   * to one draw command.  A glTF mesh has an array of primitives, often of length one.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugShowBoundingVolume = defaultValue(\n    options.debugShowBoundingVolume,\n    false\n  );\n  this._debugShowBoundingVolume = false;\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the model in wireframe.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugWireframe = defaultValue(options.debugWireframe, false);\n  this._debugWireframe = false;\n\n  this._classificationType = options.classificationType;\n\n  // Undocumented options\n  this._vertexShaderLoaded = options.vertexShaderLoaded;\n  this._classificationShaderLoaded = options.classificationShaderLoaded;\n  this._uniformMapLoaded = options.uniformMapLoaded;\n  this._pickIdLoaded = options.pickIdLoaded;\n  this._ignoreCommands = defaultValue(options.ignoreCommands, false);\n  this._upAxis = defaultValue(options.upAxis, Axis.Y);\n  this._batchTable = options.batchTable;\n\n  this._computedModelMatrix = new Matrix4(); // Derived from modelMatrix and axis\n  this._initialRadius = undefined; // Radius without model's scale property, model-matrix scale, animations, or skins\n  this._boundingSphere = undefined;\n  this._scaledBoundingSphere = new BoundingSphere();\n  this._state = ModelState.NEEDS_LOAD;\n  this._loadResources = undefined;\n\n  this._mode = undefined;\n  this._dirty = false; // true when the model was transformed this frame\n\n  this._nodeMatrix = new Matrix4();\n  this._primitive = undefined;\n\n  this._extensionsUsed = undefined; // Cached used glTF extensions\n  this._extensionsRequired = undefined; // Cached required glTF extensions\n  this._quantizedUniforms = undefined; // Quantized uniforms for WEB3D_quantized_attributes\n\n  this._buffers = {};\n  this._vertexArray = undefined;\n  this._shaderProgram = undefined;\n  this._uniformMap = undefined;\n\n  this._geometryByteLength = 0;\n  this._trianglesLength = 0;\n\n  // CESIUM_RTC extension\n  this._rtcCenter = undefined; // reference to either 3D or 2D\n  this._rtcCenterEye = undefined; // in eye coordinates\n  this._rtcCenter3D = undefined; // in world coordinates\n  this._rtcCenter2D = undefined; // in projected world coordinates\n}\n\nObject.defineProperties(ClassificationModel.prototype, {\n  /**\n   * The object for the glTF JSON, including properties with default values omitted\n   * from the JSON provided to this model.\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @default undefined\n   */\n  gltf: {\n    get: function () {\n      return this._gltf;\n    },\n  },\n\n  /**\n   * For compatibility with Model which now uses gltfInternal to avoid\n   * deprecation noise.\n   *\n   * @private\n   */\n  gltfInternal: {\n    get: function () {\n      return this._gltf;\n    },\n  },\n\n  /**\n   * The model's bounding sphere in its local coordinate system.\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {BoundingSphere}\n   * @readonly\n   *\n   * @default undefined\n   *\n   * @exception {DeveloperError} The model is not loaded.  Use ClassificationModel.readyPromise or wait for ClassificationModel.ready to be true.\n   *\n   * @example\n   * // Center in WGS84 coordinates\n   * const center = Cesium.Matrix4.multiplyByPoint(model.modelMatrix, model.boundingSphere.center, new Cesium.Cartesian3());\n   */\n  boundingSphere: {\n    get: function () {\n      //>>includeStart('debug', pragmas.debug);\n      if (this._state !== ModelState.LOADED) {\n        throw new DeveloperError(\n          \"The model is not loaded.  Use ClassificationModel.readyPromise or wait for ClassificationModel.ready to be true.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      const modelMatrix = this.modelMatrix;\n      const nonUniformScale = Matrix4.getScale(\n        modelMatrix,\n        boundingSphereCartesian3Scratch\n      );\n\n      const scaledBoundingSphere = this._scaledBoundingSphere;\n      scaledBoundingSphere.center = Cartesian3.multiplyComponents(\n        this._boundingSphere.center,\n        nonUniformScale,\n        scaledBoundingSphere.center\n      );\n      scaledBoundingSphere.radius =\n        Cartesian3.maximumComponent(nonUniformScale) * this._initialRadius;\n\n      if (defined(this._rtcCenter)) {\n        Cartesian3.add(\n          this._rtcCenter,\n          scaledBoundingSphere.center,\n          scaledBoundingSphere.center\n        );\n      }\n\n      return scaledBoundingSphere;\n    },\n  },\n\n  /**\n   * When <code>true</code>, this model is ready to render, i.e., the external binary, image,\n   * and shader files were downloaded and the WebGL resources were created.  This is set to\n   * <code>true</code> right before {@link ClassificationModel#readyPromise} is resolved.\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets the promise that will be resolved when this model is ready to render, i.e., when the external binary, image,\n   * and shader files were downloaded and the WebGL resources were created.\n   * <p>\n   * This promise is resolved at the end of the frame before the first frame the model is rendered in.\n   * </p>\n   *\n   * @memberof ClassificationModel.prototype\n   * @type {Promise.<ClassificationModel>}\n   * @readonly\n   *\n   * @see ClassificationModel#ready\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n\n  /**\n   * Returns true if the model was transformed this frame\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @private\n   */\n  dirty: {\n    get: function () {\n      return this._dirty;\n    },\n  },\n\n  /**\n   * Returns an object with all of the glTF extensions used.\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {Object}\n   * @readonly\n   */\n  extensionsUsed: {\n    get: function () {\n      if (!defined(this._extensionsUsed)) {\n        this._extensionsUsed = ModelUtility.getUsedExtensions(this.gltf);\n      }\n      return this._extensionsUsed;\n    },\n  },\n\n  /**\n   * Returns an object with all of the glTF extensions required.\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {Object}\n   * @readonly\n   */\n  extensionsRequired: {\n    get: function () {\n      if (!defined(this._extensionsRequired)) {\n        this._extensionsRequired = ModelUtility.getRequiredExtensions(\n          this.gltf\n        );\n      }\n      return this._extensionsRequired;\n    },\n  },\n\n  /**\n   * Gets the model's up-axis.\n   * By default models are y-up according to the glTF spec, however geo-referenced models will typically be z-up.\n   *\n   * @memberof ClassificationModel.prototype\n   *\n   * @type {Number}\n   * @default Axis.Y\n   * @readonly\n   *\n   * @private\n   */\n  upAxis: {\n    get: function () {\n      return this._upAxis;\n    },\n  },\n\n  /**\n   * Gets the model's triangle count.\n   *\n   * @private\n   */\n  trianglesLength: {\n    get: function () {\n      return this._trianglesLength;\n    },\n  },\n\n  /**\n   * Gets the model's geometry memory in bytes. This includes all vertex and index buffers.\n   *\n   * @private\n   */\n  geometryByteLength: {\n    get: function () {\n      return this._geometryByteLength;\n    },\n  },\n\n  /**\n   * Gets the model's texture memory in bytes.\n   *\n   * @private\n   */\n  texturesByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Gets the model's classification type.\n   * @memberof ClassificationModel.prototype\n   * @type {ClassificationType}\n   */\n  classificationType: {\n    get: function () {\n      return this._classificationType;\n    },\n  },\n});\n\n///////////////////////////////////////////////////////////////////////////\n\nfunction addBuffersToLoadResources(model) {\n  const gltf = model.gltf;\n  const loadResources = model._loadResources;\n  ForEach.buffer(gltf, function (buffer, id) {\n    loadResources.buffers[id] = buffer.extras._pipeline.source;\n  });\n}\n\nfunction parseBufferViews(model) {\n  const bufferViews = model.gltf.bufferViews;\n\n  const vertexBuffersToCreate = model._loadResources.vertexBuffersToCreate;\n\n  // Only ARRAY_BUFFER here.  ELEMENT_ARRAY_BUFFER created below.\n  ForEach.bufferView(model.gltf, function (bufferView, id) {\n    if (bufferView.target === WebGLConstants.ARRAY_BUFFER) {\n      vertexBuffersToCreate.enqueue(id);\n    }\n  });\n\n  const indexBuffersToCreate = model._loadResources.indexBuffersToCreate;\n  const indexBufferIds = {};\n\n  // The Cesium Renderer requires knowing the datatype for an index buffer\n  // at creation type, which is not part of the glTF bufferview so loop\n  // through glTF accessors to create the bufferview's index buffer.\n  ForEach.accessor(model.gltf, function (accessor) {\n    const bufferViewId = accessor.bufferView;\n    const bufferView = bufferViews[bufferViewId];\n\n    if (\n      bufferView.target === WebGLConstants.ELEMENT_ARRAY_BUFFER &&\n      !defined(indexBufferIds[bufferViewId])\n    ) {\n      indexBufferIds[bufferViewId] = true;\n      indexBuffersToCreate.enqueue({\n        id: bufferViewId,\n        componentType: accessor.componentType,\n      });\n    }\n  });\n}\n\nfunction createVertexBuffer(bufferViewId, model) {\n  const loadResources = model._loadResources;\n  const bufferViews = model.gltf.bufferViews;\n  const bufferView = bufferViews[bufferViewId];\n  const vertexBuffer = loadResources.getBuffer(bufferView);\n  model._buffers[bufferViewId] = vertexBuffer;\n  model._geometryByteLength += vertexBuffer.byteLength;\n}\n\nfunction createIndexBuffer(bufferViewId, componentType, model) {\n  const loadResources = model._loadResources;\n  const bufferViews = model.gltf.bufferViews;\n  const bufferView = bufferViews[bufferViewId];\n  const indexBuffer = {\n    typedArray: loadResources.getBuffer(bufferView),\n    indexDatatype: componentType,\n  };\n  model._buffers[bufferViewId] = indexBuffer;\n  model._geometryByteLength += indexBuffer.typedArray.byteLength;\n}\n\nfunction createBuffers(model) {\n  const loadResources = model._loadResources;\n\n  if (loadResources.pendingBufferLoads !== 0) {\n    return;\n  }\n\n  const vertexBuffersToCreate = loadResources.vertexBuffersToCreate;\n  const indexBuffersToCreate = loadResources.indexBuffersToCreate;\n\n  while (vertexBuffersToCreate.length > 0) {\n    createVertexBuffer(vertexBuffersToCreate.dequeue(), model);\n  }\n\n  while (indexBuffersToCreate.length > 0) {\n    const i = indexBuffersToCreate.dequeue();\n    createIndexBuffer(i.id, i.componentType, model);\n  }\n}\n\nfunction modifyShaderForQuantizedAttributes(shader, model) {\n  const primitive = model.gltf.meshes[0].primitives[0];\n  const result = ModelUtility.modifyShaderForQuantizedAttributes(\n    model.gltf,\n    primitive,\n    shader\n  );\n  model._quantizedUniforms = result.uniforms;\n  return result.shader;\n}\n\nfunction modifyShader(shader, callback) {\n  if (defined(callback)) {\n    shader = callback(shader);\n  }\n  return shader;\n}\n\nfunction createProgram(model) {\n  const gltf = model.gltf;\n\n  const positionName = ModelUtility.getAttributeOrUniformBySemantic(\n    gltf,\n    \"POSITION\"\n  );\n  const batchIdName = ModelUtility.getAttributeOrUniformBySemantic(\n    gltf,\n    \"_BATCHID\"\n  );\n\n  const attributeLocations = {};\n  attributeLocations[positionName] = 0;\n  attributeLocations[batchIdName] = 1;\n\n  const modelViewProjectionName = ModelUtility.getAttributeOrUniformBySemantic(\n    gltf,\n    \"MODELVIEWPROJECTION\"\n  );\n\n  let uniformDecl;\n  let toClip;\n\n  if (!defined(modelViewProjectionName)) {\n    const projectionName = ModelUtility.getAttributeOrUniformBySemantic(\n      gltf,\n      \"PROJECTION\"\n    );\n    let modelViewName = ModelUtility.getAttributeOrUniformBySemantic(\n      gltf,\n      \"MODELVIEW\"\n    );\n    if (!defined(modelViewName)) {\n      modelViewName = ModelUtility.getAttributeOrUniformBySemantic(\n        gltf,\n        \"CESIUM_RTC_MODELVIEW\"\n      );\n    }\n\n    uniformDecl =\n      `uniform mat4 ${modelViewName};\\n` + `uniform mat4 ${projectionName};\\n`;\n    toClip = `${projectionName} * ${modelViewName} * vec4(${positionName}, 1.0)`;\n  } else {\n    uniformDecl = `uniform mat4 ${modelViewProjectionName};\\n`;\n    toClip = `${modelViewProjectionName} * vec4(${positionName}, 1.0)`;\n  }\n\n  const computePosition = `    vec4 positionInClipCoords = ${toClip};\\n`;\n\n  let vs =\n    `attribute vec3 ${positionName};\\n` +\n    `attribute float ${batchIdName};\\n${uniformDecl}void main() {\\n${computePosition}    gl_Position = czm_depthClamp(positionInClipCoords);\\n` +\n    `}\\n`;\n  const fs =\n    \"#ifdef GL_EXT_frag_depth\\n\" +\n    \"#extension GL_EXT_frag_depth : enable\\n\" +\n    \"#endif\\n\" +\n    \"void main() \\n\" +\n    \"{ \\n\" +\n    \"    gl_FragColor = vec4(1.0); \\n\" +\n    \"    czm_writeDepthClamp();\\n\" +\n    \"}\\n\";\n\n  if (model.extensionsUsed.WEB3D_quantized_attributes) {\n    vs = modifyShaderForQuantizedAttributes(vs, model);\n  }\n\n  const drawVS = modifyShader(vs, model._vertexShaderLoaded);\n  const drawFS = modifyShader(fs, model._classificationShaderLoaded);\n\n  model._shaderProgram = {\n    vertexShaderSource: drawVS,\n    fragmentShaderSource: drawFS,\n    attributeLocations: attributeLocations,\n  };\n}\n\nfunction getAttributeLocations() {\n  return {\n    POSITION: 0,\n    _BATCHID: 1,\n  };\n}\n\nfunction createVertexArray(model) {\n  const loadResources = model._loadResources;\n  if (!loadResources.finishedBuffersCreation() || defined(model._vertexArray)) {\n    return;\n  }\n\n  const rendererBuffers = model._buffers;\n  const gltf = model.gltf;\n  const accessors = gltf.accessors;\n  const meshes = gltf.meshes;\n  const primitives = meshes[0].primitives;\n\n  const primitive = primitives[0];\n  const attributeLocations = getAttributeLocations();\n  const attributes = {};\n  ForEach.meshPrimitiveAttribute(primitive, function (\n    accessorId,\n    attributeName\n  ) {\n    // Skip if the attribute is not used by the material, e.g., because the asset\n    // was exported with an attribute that wasn't used and the asset wasn't optimized.\n    const attributeLocation = attributeLocations[attributeName];\n    if (defined(attributeLocation)) {\n      const a = accessors[accessorId];\n      attributes[attributeName] = {\n        index: attributeLocation,\n        vertexBuffer: rendererBuffers[a.bufferView],\n        componentsPerAttribute: numberOfComponentsForType(a.type),\n        componentDatatype: a.componentType,\n        offsetInBytes: a.byteOffset,\n        strideInBytes: getAccessorByteStride(gltf, a),\n      };\n    }\n  });\n\n  let indexBuffer;\n  if (defined(primitive.indices)) {\n    const accessor = accessors[primitive.indices];\n    indexBuffer = rendererBuffers[accessor.bufferView];\n  }\n  model._vertexArray = {\n    attributes: attributes,\n    indexBuffer: indexBuffer,\n  };\n}\n\nconst gltfSemanticUniforms = {\n  PROJECTION: function (uniformState, model) {\n    return ModelUtility.getGltfSemanticUniforms().PROJECTION(\n      uniformState,\n      model\n    );\n  },\n  MODELVIEW: function (uniformState, model) {\n    return ModelUtility.getGltfSemanticUniforms().MODELVIEW(\n      uniformState,\n      model\n    );\n  },\n  CESIUM_RTC_MODELVIEW: function (uniformState, model) {\n    return ModelUtility.getGltfSemanticUniforms().CESIUM_RTC_MODELVIEW(\n      uniformState,\n      model\n    );\n  },\n  MODELVIEWPROJECTION: function (uniformState, model) {\n    return ModelUtility.getGltfSemanticUniforms().MODELVIEWPROJECTION(\n      uniformState,\n      model\n    );\n  },\n};\n\nfunction createUniformMap(model, context) {\n  if (defined(model._uniformMap)) {\n    return;\n  }\n\n  const uniformMap = {};\n  ForEach.technique(model.gltf, function (technique) {\n    ForEach.techniqueUniform(technique, function (uniform, uniformName) {\n      if (\n        !defined(uniform.semantic) ||\n        !defined(gltfSemanticUniforms[uniform.semantic])\n      ) {\n        return;\n      }\n\n      uniformMap[uniformName] = gltfSemanticUniforms[uniform.semantic](\n        context.uniformState,\n        model\n      );\n    });\n  });\n\n  model._uniformMap = uniformMap;\n}\n\nfunction createUniformsForQuantizedAttributes(model, primitive) {\n  return ModelUtility.createUniformsForQuantizedAttributes(\n    model.gltf,\n    primitive,\n    model._quantizedUniforms\n  );\n}\n\nfunction triangleCountFromPrimitiveIndices(primitive, indicesCount) {\n  switch (primitive.mode) {\n    case PrimitiveType.TRIANGLES:\n      return indicesCount / 3;\n    case PrimitiveType.TRIANGLE_STRIP:\n    case PrimitiveType.TRIANGLE_FAN:\n      return Math.max(indicesCount - 2, 0);\n    default:\n      return 0;\n  }\n}\n\nfunction createPrimitive(model) {\n  const batchTable = model._batchTable;\n\n  let uniformMap = model._uniformMap;\n  const vertexArray = model._vertexArray;\n\n  const gltf = model.gltf;\n  const accessors = gltf.accessors;\n  const gltfMeshes = gltf.meshes;\n  const primitive = gltfMeshes[0].primitives[0];\n  const ix = accessors[primitive.indices];\n\n  const positionAccessor = primitive.attributes.POSITION;\n  const minMax = ModelUtility.getAccessorMinMax(gltf, positionAccessor);\n  const boundingSphere = BoundingSphere.fromCornerPoints(\n    Cartesian3.fromArray(minMax.min),\n    Cartesian3.fromArray(minMax.max)\n  );\n\n  let offset;\n  let count;\n  if (defined(ix)) {\n    count = ix.count;\n    offset = ix.byteOffset / IndexDatatype.getSizeInBytes(ix.componentType); // glTF has offset in bytes.  Cesium has offsets in indices\n  } else {\n    const positions = accessors[primitive.attributes.POSITION];\n    count = positions.count;\n    offset = 0;\n  }\n\n  // Update model triangle count using number of indices\n  model._trianglesLength += triangleCountFromPrimitiveIndices(primitive, count);\n\n  // Allow callback to modify the uniformMap\n  if (defined(model._uniformMapLoaded)) {\n    uniformMap = model._uniformMapLoaded(uniformMap);\n  }\n\n  // Add uniforms for decoding quantized attributes if used\n  if (model.extensionsUsed.WEB3D_quantized_attributes) {\n    const quantizedUniformMap = createUniformsForQuantizedAttributes(\n      model,\n      primitive\n    );\n    uniformMap = combine(uniformMap, quantizedUniformMap);\n  }\n\n  let attribute = vertexArray.attributes.POSITION;\n  let componentDatatype = attribute.componentDatatype;\n  let typedArray = attribute.vertexBuffer;\n  let byteOffset = typedArray.byteOffset;\n  let bufferLength =\n    typedArray.byteLength / ComponentDatatype.getSizeInBytes(componentDatatype);\n  let positionsBuffer = ComponentDatatype.createArrayBufferView(\n    componentDatatype,\n    typedArray.buffer,\n    byteOffset,\n    bufferLength\n  );\n\n  attribute = vertexArray.attributes._BATCHID;\n  componentDatatype = attribute.componentDatatype;\n  typedArray = attribute.vertexBuffer;\n  byteOffset = typedArray.byteOffset;\n  bufferLength =\n    typedArray.byteLength / ComponentDatatype.getSizeInBytes(componentDatatype);\n  let vertexBatchIds = ComponentDatatype.createArrayBufferView(\n    componentDatatype,\n    typedArray.buffer,\n    byteOffset,\n    bufferLength\n  );\n\n  const buffer = vertexArray.indexBuffer.typedArray;\n  let indices;\n  if (vertexArray.indexBuffer.indexDatatype === IndexDatatype.UNSIGNED_SHORT) {\n    indices = new Uint16Array(\n      buffer.buffer,\n      buffer.byteOffset,\n      buffer.byteLength / Uint16Array.BYTES_PER_ELEMENT\n    );\n  } else {\n    indices = new Uint32Array(\n      buffer.buffer,\n      buffer.byteOffset,\n      buffer.byteLength / Uint32Array.BYTES_PER_ELEMENT\n    );\n  }\n\n  positionsBuffer = arraySlice(positionsBuffer);\n  vertexBatchIds = arraySlice(vertexBatchIds);\n  indices = arraySlice(indices, offset, offset + count);\n\n  const batchIds = [];\n  const indexCounts = [];\n  const indexOffsets = [];\n  const batchedIndices = [];\n\n  let currentId = vertexBatchIds[indices[0]];\n  batchIds.push(currentId);\n  indexOffsets.push(0);\n\n  let batchId;\n  let indexOffset;\n  let indexCount;\n  const indicesLength = indices.length;\n  for (let j = 1; j < indicesLength; ++j) {\n    batchId = vertexBatchIds[indices[j]];\n    if (batchId !== currentId) {\n      indexOffset = indexOffsets[indexOffsets.length - 1];\n      indexCount = j - indexOffset;\n\n      batchIds.push(batchId);\n      indexCounts.push(indexCount);\n      indexOffsets.push(j);\n\n      batchedIndices.push(\n        new Vector3DTileBatch({\n          offset: indexOffset,\n          count: indexCount,\n          batchIds: [currentId],\n          color: Color.WHITE,\n        })\n      );\n\n      currentId = batchId;\n    }\n  }\n\n  indexOffset = indexOffsets[indexOffsets.length - 1];\n  indexCount = indicesLength - indexOffset;\n\n  indexCounts.push(indexCount);\n  batchedIndices.push(\n    new Vector3DTileBatch({\n      offset: indexOffset,\n      count: indexCount,\n      batchIds: [currentId],\n      color: Color.WHITE,\n    })\n  );\n\n  const shader = model._shaderProgram;\n  const vertexShaderSource = shader.vertexShaderSource;\n  const fragmentShaderSource = shader.fragmentShaderSource;\n  const attributeLocations = shader.attributeLocations;\n  const pickId = defined(model._pickIdLoaded)\n    ? model._pickIdLoaded()\n    : undefined;\n\n  model._primitive = new Vector3DTilePrimitive({\n    classificationType: model._classificationType,\n    positions: positionsBuffer,\n    indices: indices,\n    indexOffsets: indexOffsets,\n    indexCounts: indexCounts,\n    batchIds: batchIds,\n    vertexBatchIds: vertexBatchIds,\n    batchedIndices: batchedIndices,\n    batchTable: batchTable,\n    boundingVolume: new BoundingSphere(), // updated in update()\n    _vertexShaderSource: vertexShaderSource,\n    _fragmentShaderSource: fragmentShaderSource,\n    _attributeLocations: attributeLocations,\n    _uniformMap: uniformMap,\n    _pickId: pickId,\n    _modelMatrix: new Matrix4(), // updated in update()\n    _boundingSphere: boundingSphere, // used to update boundingVolume\n  });\n\n  // Release CPU resources\n  model._buffers = undefined;\n  model._vertexArray = undefined;\n  model._shaderProgram = undefined;\n  model._uniformMap = undefined;\n}\n\nfunction createRuntimeNodes(model) {\n  const loadResources = model._loadResources;\n  if (!loadResources.finished()) {\n    return;\n  }\n\n  if (defined(model._primitive)) {\n    return;\n  }\n\n  const gltf = model.gltf;\n  const nodes = gltf.nodes;\n  const gltfNode = nodes[0];\n  model._nodeMatrix = ModelUtility.getTransform(gltfNode, model._nodeMatrix);\n\n  createPrimitive(model);\n}\n\nfunction createResources(model, frameState) {\n  const context = frameState.context;\n\n  ModelUtility.checkSupportedGlExtensions(model.gltf.glExtensionsUsed, context);\n  createBuffers(model); // using glTF bufferViews\n  createProgram(model);\n  createVertexArray(model); // using glTF meshes\n  createUniformMap(model, context); // using glTF materials/techniques\n  createRuntimeNodes(model); // using glTF scene\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nconst scratchComputedTranslation = new Cartesian4();\nconst scratchComputedMatrixIn2D = new Matrix4();\n\nfunction updateNodeModelMatrix(\n  model,\n  modelTransformChanged,\n  justLoaded,\n  projection\n) {\n  let computedModelMatrix = model._computedModelMatrix;\n\n  if (model._mode !== SceneMode.SCENE3D && !model._ignoreCommands) {\n    const translation = Matrix4.getColumn(\n      computedModelMatrix,\n      3,\n      scratchComputedTranslation\n    );\n    if (!Cartesian4.equals(translation, Cartesian4.UNIT_W)) {\n      computedModelMatrix = Transforms.basisTo2D(\n        projection,\n        computedModelMatrix,\n        scratchComputedMatrixIn2D\n      );\n      model._rtcCenter = model._rtcCenter3D;\n    } else {\n      const center = model.boundingSphereInternal.center;\n      const to2D = Transforms.wgs84To2DModelMatrix(\n        projection,\n        center,\n        scratchComputedMatrixIn2D\n      );\n      computedModelMatrix = Matrix4.multiply(\n        to2D,\n        computedModelMatrix,\n        scratchComputedMatrixIn2D\n      );\n\n      if (defined(model._rtcCenter)) {\n        Matrix4.setTranslation(\n          computedModelMatrix,\n          Cartesian4.UNIT_W,\n          computedModelMatrix\n        );\n        model._rtcCenter = model._rtcCenter2D;\n      }\n    }\n  }\n\n  const primitive = model._primitive;\n\n  if (modelTransformChanged || justLoaded) {\n    Matrix4.multiplyTransformation(\n      computedModelMatrix,\n      model._nodeMatrix,\n      primitive._modelMatrix\n    );\n    BoundingSphere.transform(\n      primitive._boundingSphere,\n      primitive._modelMatrix,\n      primitive._boundingVolume\n    );\n\n    if (defined(model._rtcCenter)) {\n      Cartesian3.add(\n        model._rtcCenter,\n        primitive._boundingVolume.center,\n        primitive._boundingVolume.center\n      );\n    }\n  }\n}\n\n///////////////////////////////////////////////////////////////////////////\n\nClassificationModel.prototype.updateCommands = function (batchId, color) {\n  this._primitive.updateCommands(batchId, color);\n};\n\nClassificationModel.prototype.update = function (frameState) {\n  if (frameState.mode === SceneMode.MORPHING) {\n    return;\n  }\n\n  if (!FeatureDetection.supportsWebP.initialized) {\n    FeatureDetection.supportsWebP.initialize();\n    return;\n  }\n  const supportsWebP = FeatureDetection.supportsWebP();\n\n  if (this._state === ModelState.NEEDS_LOAD && defined(this.gltf)) {\n    this._state = ModelState.LOADING;\n    if (this._state !== ModelState.FAILED) {\n      const extensions = this.gltf.extensions;\n      if (defined(extensions) && defined(extensions.CESIUM_RTC)) {\n        const center = Cartesian3.fromArray(extensions.CESIUM_RTC.center);\n        if (!Cartesian3.equals(center, Cartesian3.ZERO)) {\n          this._rtcCenter3D = center;\n\n          const projection = frameState.mapProjection;\n          const ellipsoid = projection.ellipsoid;\n          const cartographic = ellipsoid.cartesianToCartographic(\n            this._rtcCenter3D\n          );\n          const projectedCart = projection.project(cartographic);\n          Cartesian3.fromElements(\n            projectedCart.z,\n            projectedCart.x,\n            projectedCart.y,\n            projectedCart\n          );\n          this._rtcCenter2D = projectedCart;\n\n          this._rtcCenterEye = new Cartesian3();\n          this._rtcCenter = this._rtcCenter3D;\n        }\n      }\n\n      this._loadResources = new ModelLoadResources();\n      ModelUtility.parseBuffers(this);\n    }\n  }\n\n  const loadResources = this._loadResources;\n  let justLoaded = false;\n\n  if (this._state === ModelState.LOADING) {\n    // Transition from LOADING -> LOADED once resources are downloaded and created.\n    // Textures may continue to stream in while in the LOADED state.\n    if (loadResources.pendingBufferLoads === 0) {\n      ModelUtility.checkSupportedExtensions(\n        this.extensionsRequired,\n        supportsWebP\n      );\n\n      addBuffersToLoadResources(this);\n      parseBufferViews(this);\n\n      this._boundingSphere = ModelUtility.computeBoundingSphere(this);\n      this._initialRadius = this._boundingSphere.radius;\n      createResources(this, frameState);\n    }\n    if (loadResources.finished()) {\n      this._state = ModelState.LOADED;\n      justLoaded = true;\n    }\n  }\n\n  if (defined(loadResources) && this._state === ModelState.LOADED) {\n    if (!justLoaded) {\n      createResources(this, frameState);\n    }\n\n    if (loadResources.finished()) {\n      this._loadResources = undefined; // Clear CPU memory since WebGL resources were created.\n    }\n  }\n\n  const show = this.show;\n\n  if ((show && this._state === ModelState.LOADED) || justLoaded) {\n    this._dirty = false;\n    const modelMatrix = this.modelMatrix;\n\n    const modeChanged = frameState.mode !== this._mode;\n    this._mode = frameState.mode;\n\n    // ClassificationModel's model matrix needs to be updated\n    const modelTransformChanged =\n      !Matrix4.equals(this._modelMatrix, modelMatrix) || modeChanged;\n\n    if (modelTransformChanged || justLoaded) {\n      Matrix4.clone(modelMatrix, this._modelMatrix);\n\n      const computedModelMatrix = this._computedModelMatrix;\n      Matrix4.clone(modelMatrix, computedModelMatrix);\n      if (this._upAxis === Axis.Y) {\n        Matrix4.multiplyTransformation(\n          computedModelMatrix,\n          Axis.Y_UP_TO_Z_UP,\n          computedModelMatrix\n        );\n      } else if (this._upAxis === Axis.X) {\n        Matrix4.multiplyTransformation(\n          computedModelMatrix,\n          Axis.X_UP_TO_Z_UP,\n          computedModelMatrix\n        );\n      }\n    }\n\n    // Update modelMatrix throughout the graph as needed\n    if (modelTransformChanged || justLoaded) {\n      updateNodeModelMatrix(\n        this,\n        modelTransformChanged,\n        justLoaded,\n        frameState.mapProjection\n      );\n      this._dirty = true;\n    }\n  }\n\n  if (justLoaded) {\n    // Called after modelMatrix update.\n    const model = this;\n    frameState.afterRender.push(function () {\n      model._ready = true;\n      model._readyPromise.resolve(model);\n    });\n    return;\n  }\n\n  if (show && !this._ignoreCommands) {\n    this._primitive.debugShowBoundingVolume = this.debugShowBoundingVolume;\n    this._primitive.debugWireframe = this.debugWireframe;\n    this._primitive.update(frameState);\n  }\n};\n\nClassificationModel.prototype.isDestroyed = function () {\n  return false;\n};\n\nClassificationModel.prototype.destroy = function () {\n  this._primitive = this._primitive && this._primitive.destroy();\n  return destroyObject(this);\n};\nexport default ClassificationModel;\n","import ColorGeometryInstanceAttribute from \"../Core/ColorGeometryInstanceAttribute.js\";\nimport combine from \"../Core/combine.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defer from \"../Core/defer.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport GeometryInstance from \"../Core/GeometryInstance.js\";\nimport DrawCommand from \"../Renderer/DrawCommand.js\";\nimport Pass from \"../Renderer/Pass.js\";\nimport RenderState from \"../Renderer/RenderState.js\";\nimport ShaderProgram from \"../Renderer/ShaderProgram.js\";\nimport ShaderSource from \"../Renderer/ShaderSource.js\";\nimport ShadowVolumeAppearanceVS from \"../Shaders/ShadowVolumeAppearanceVS.js\";\nimport ShadowVolumeFS from \"../Shaders/ShadowVolumeFS.js\";\nimport BlendingState from \"./BlendingState.js\";\nimport ClassificationType from \"./ClassificationType.js\";\nimport DepthFunction from \"./DepthFunction.js\";\nimport PerInstanceColorAppearance from \"./PerInstanceColorAppearance.js\";\nimport Primitive from \"./Primitive.js\";\nimport SceneMode from \"./SceneMode.js\";\nimport ShadowVolumeAppearance from \"./ShadowVolumeAppearance.js\";\nimport StencilConstants from \"./StencilConstants.js\";\nimport StencilFunction from \"./StencilFunction.js\";\nimport StencilOperation from \"./StencilOperation.js\";\n\n/**\n * A classification primitive represents a volume enclosing geometry in the {@link Scene} to be highlighted.\n * <p>\n * A primitive combines geometry instances with an {@link Appearance} that describes the full shading, including\n * {@link Material} and {@link RenderState}.  Roughly, the geometry instance defines the structure and placement,\n * and the appearance defines the visual characteristics.  Decoupling geometry and appearance allows us to mix\n * and match most of them and add a new geometry or appearance independently of each other.\n * Only {@link PerInstanceColorAppearance} with the same color across all instances is supported at this time when using\n * ClassificationPrimitive directly.\n * For full {@link Appearance} support when classifying terrain or 3D Tiles use {@link GroundPrimitive} instead.\n * </p>\n * <p>\n * For correct rendering, this feature requires the EXT_frag_depth WebGL extension. For hardware that do not support this extension, there\n * will be rendering artifacts for some viewing angles.\n * </p>\n * <p>\n * Valid geometries are {@link BoxGeometry}, {@link CylinderGeometry}, {@link EllipsoidGeometry}, {@link PolylineVolumeGeometry}, and {@link SphereGeometry}.\n * </p>\n * <p>\n * Geometries that follow the surface of the ellipsoid, such as {@link CircleGeometry}, {@link CorridorGeometry}, {@link EllipseGeometry}, {@link PolygonGeometry}, and {@link RectangleGeometry},\n * are also valid if they are extruded volumes; otherwise, they will not be rendered.\n * </p>\n *\n * @alias ClassificationPrimitive\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Array|GeometryInstance} [options.geometryInstances] The geometry instances to render. This can either be a single instance or an array of length one.\n * @param {Appearance} [options.appearance] The appearance used to render the primitive. Defaults to PerInstanceColorAppearance when GeometryInstances have a color attribute.\n * @param {Boolean} [options.show=true] Determines if this primitive will be shown.\n * @param {Boolean} [options.vertexCacheOptimize=false] When <code>true</code>, geometry vertices are optimized for the pre and post-vertex-shader caches.\n * @param {Boolean} [options.interleave=false] When <code>true</code>, geometry vertex attributes are interleaved, which can slightly improve rendering performance but increases load time.\n * @param {Boolean} [options.compressVertices=true] When <code>true</code>, the geometry vertices are compressed, which will save memory.\n * @param {Boolean} [options.releaseGeometryInstances=true] When <code>true</code>, the primitive does not keep a reference to the input <code>geometryInstances</code> to save memory.\n * @param {Boolean} [options.allowPicking=true] When <code>true</code>, each geometry instance will only be pickable with {@link Scene#pick}.  When <code>false</code>, GPU memory is saved.\n * @param {Boolean} [options.asynchronous=true] Determines if the primitive will be created asynchronously or block until ready. If false initializeTerrainHeights() must be called first.\n * @param {ClassificationType} [options.classificationType=ClassificationType.BOTH] Determines whether terrain, 3D Tiles or both will be classified.\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. Determines if this primitive's commands' bounding spheres are shown.\n * @param {Boolean} [options.debugShowShadowVolume=false] For debugging only. Determines if the shadow volume for each geometry in the primitive is drawn. Must be <code>true</code> on\n *                  creation for the volumes to be created before the geometry is released or options.releaseGeometryInstance must be <code>false</code>.\n *\n * @see Primitive\n * @see GroundPrimitive\n * @see GeometryInstance\n * @see Appearance\n */\nfunction ClassificationPrimitive(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  const geometryInstances = options.geometryInstances;\n\n  /**\n   * The geometry instance rendered with this primitive.  This may\n   * be <code>undefined</code> if <code>options.releaseGeometryInstances</code>\n   * is <code>true</code> when the primitive is constructed.\n   * <p>\n   * Changing this property after the primitive is rendered has no effect.\n   * </p>\n   * <p>\n   * Because of the rendering technique used, all geometry instances must be the same color.\n   * If there is an instance with a differing color, a <code>DeveloperError</code> will be thrown\n   * on the first attempt to render.\n   * </p>\n   *\n   * @readonly\n   * @type {Array|GeometryInstance}\n   *\n   * @default undefined\n   */\n  this.geometryInstances = geometryInstances;\n  /**\n   * Determines if the primitive will be shown.  This affects all geometry\n   * instances in the primitive.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n  /**\n   * Determines whether terrain, 3D Tiles or both will be classified.\n   *\n   * @type {ClassificationType}\n   *\n   * @default ClassificationType.BOTH\n   */\n  this.classificationType = defaultValue(\n    options.classificationType,\n    ClassificationType.BOTH\n  );\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the bounding sphere for each draw command in the primitive.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugShowBoundingVolume = defaultValue(\n    options.debugShowBoundingVolume,\n    false\n  );\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the shadow volume for each geometry in the primitive.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugShowShadowVolume = defaultValue(\n    options.debugShowShadowVolume,\n    false\n  );\n  this._debugShowShadowVolume = false;\n\n  // These are used by GroundPrimitive to augment the shader and uniform map.\n  this._extruded = defaultValue(options._extruded, false);\n  this._uniformMap = options._uniformMap;\n\n  this._sp = undefined;\n  this._spStencil = undefined;\n  this._spPick = undefined;\n  this._spColor = undefined;\n\n  this._spPick2D = undefined; // only derived if necessary\n  this._spColor2D = undefined; // only derived if necessary\n\n  this._rsStencilDepthPass = undefined;\n  this._rsStencilDepthPass3DTiles = undefined;\n  this._rsColorPass = undefined;\n  this._rsPickPass = undefined;\n\n  this._commandsIgnoreShow = [];\n\n  this._ready = false;\n  this._readyPromise = defer();\n\n  this._primitive = undefined;\n  this._pickPrimitive = options._pickPrimitive;\n\n  // Set in update\n  this._hasSphericalExtentsAttribute = false;\n  this._hasPlanarExtentsAttributes = false;\n  this._hasPerColorAttribute = false;\n\n  this.appearance = options.appearance;\n\n  this._createBoundingVolumeFunction = options._createBoundingVolumeFunction;\n  this._updateAndQueueCommandsFunction =\n    options._updateAndQueueCommandsFunction;\n\n  this._usePickOffsets = false;\n\n  this._primitiveOptions = {\n    geometryInstances: undefined,\n    appearance: undefined,\n    vertexCacheOptimize: defaultValue(options.vertexCacheOptimize, false),\n    interleave: defaultValue(options.interleave, false),\n    releaseGeometryInstances: defaultValue(\n      options.releaseGeometryInstances,\n      true\n    ),\n    allowPicking: defaultValue(options.allowPicking, true),\n    asynchronous: defaultValue(options.asynchronous, true),\n    compressVertices: defaultValue(options.compressVertices, true),\n    _createBoundingVolumeFunction: undefined,\n    _createRenderStatesFunction: undefined,\n    _createShaderProgramFunction: undefined,\n    _createCommandsFunction: undefined,\n    _updateAndQueueCommandsFunction: undefined,\n    _createPickOffsets: true,\n  };\n}\n\nObject.defineProperties(ClassificationPrimitive.prototype, {\n  /**\n   * When <code>true</code>, geometry vertices are optimized for the pre and post-vertex-shader caches.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  vertexCacheOptimize: {\n    get: function () {\n      return this._primitiveOptions.vertexCacheOptimize;\n    },\n  },\n\n  /**\n   * Determines if geometry vertex attributes are interleaved, which can slightly improve rendering performance.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  interleave: {\n    get: function () {\n      return this._primitiveOptions.interleave;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the primitive does not keep a reference to the input <code>geometryInstances</code> to save memory.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  releaseGeometryInstances: {\n    get: function () {\n      return this._primitiveOptions.releaseGeometryInstances;\n    },\n  },\n\n  /**\n   * When <code>true</code>, each geometry instance will only be pickable with {@link Scene#pick}.  When <code>false</code>, GPU memory is saved.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  allowPicking: {\n    get: function () {\n      return this._primitiveOptions.allowPicking;\n    },\n  },\n\n  /**\n   * Determines if the geometry instances will be created and batched on a web worker.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  asynchronous: {\n    get: function () {\n      return this._primitiveOptions.asynchronous;\n    },\n  },\n\n  /**\n   * When <code>true</code>, geometry vertices are compressed, which will save memory.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  compressVertices: {\n    get: function () {\n      return this._primitiveOptions.compressVertices;\n    },\n  },\n\n  /**\n   * Determines if the primitive is complete and ready to render.  If this property is\n   * true, the primitive will be rendered the next time that {@link ClassificationPrimitive#update}\n   * is called.\n   *\n   * @memberof ClassificationPrimitive.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   */\n  ready: {\n    get: function () {\n      return this._ready;\n    },\n  },\n\n  /**\n   * Gets a promise that resolves when the primitive is ready to render.\n   * @memberof ClassificationPrimitive.prototype\n   * @type {Promise.<ClassificationPrimitive>}\n   * @readonly\n   */\n  readyPromise: {\n    get: function () {\n      return this._readyPromise.promise;\n    },\n  },\n\n  /**\n   * Returns true if the ClassificationPrimitive needs a separate shader and commands for 2D.\n   * This is because texture coordinates on ClassificationPrimitives are computed differently,\n   * and are used for culling when multiple GeometryInstances are batched in one ClassificationPrimitive.\n   * @memberof ClassificationPrimitive.prototype\n   * @type {Boolean}\n   * @readonly\n   * @private\n   */\n  _needs2DShader: {\n    get: function () {\n      return (\n        this._hasPlanarExtentsAttributes || this._hasSphericalExtentsAttribute\n      );\n    },\n  },\n});\n\n/**\n * Determines if ClassificationPrimitive rendering is supported.\n *\n * @param {Scene} scene The scene.\n * @returns {Boolean} <code>true</code> if ClassificationPrimitives are supported; otherwise, returns <code>false</code>\n */\nClassificationPrimitive.isSupported = function (scene) {\n  return scene.context.stencilBuffer;\n};\n\nfunction getStencilDepthRenderState(enableStencil, mask3DTiles) {\n  const stencilFunction = mask3DTiles\n    ? StencilFunction.EQUAL\n    : StencilFunction.ALWAYS;\n  return {\n    colorMask: {\n      red: false,\n      green: false,\n      blue: false,\n      alpha: false,\n    },\n    stencilTest: {\n      enabled: enableStencil,\n      frontFunction: stencilFunction,\n      frontOperation: {\n        fail: StencilOperation.KEEP,\n        zFail: StencilOperation.DECREMENT_WRAP,\n        zPass: StencilOperation.KEEP,\n      },\n      backFunction: stencilFunction,\n      backOperation: {\n        fail: StencilOperation.KEEP,\n        zFail: StencilOperation.INCREMENT_WRAP,\n        zPass: StencilOperation.KEEP,\n      },\n      reference: StencilConstants.CESIUM_3D_TILE_MASK,\n      mask: StencilConstants.CESIUM_3D_TILE_MASK,\n    },\n    stencilMask: StencilConstants.CLASSIFICATION_MASK,\n    depthTest: {\n      enabled: true,\n      func: DepthFunction.LESS_OR_EQUAL,\n    },\n    depthMask: false,\n  };\n}\n\nfunction getColorRenderState(enableStencil) {\n  return {\n    stencilTest: {\n      enabled: enableStencil,\n      frontFunction: StencilFunction.NOT_EQUAL,\n      frontOperation: {\n        fail: StencilOperation.ZERO,\n        zFail: StencilOperation.ZERO,\n        zPass: StencilOperation.ZERO,\n      },\n      backFunction: StencilFunction.NOT_EQUAL,\n      backOperation: {\n        fail: StencilOperation.ZERO,\n        zFail: StencilOperation.ZERO,\n        zPass: StencilOperation.ZERO,\n      },\n      reference: 0,\n      mask: StencilConstants.CLASSIFICATION_MASK,\n    },\n    stencilMask: StencilConstants.CLASSIFICATION_MASK,\n    depthTest: {\n      enabled: false,\n    },\n    depthMask: false,\n    blending: BlendingState.PRE_MULTIPLIED_ALPHA_BLEND,\n  };\n}\n\nconst pickRenderState = {\n  stencilTest: {\n    enabled: true,\n    frontFunction: StencilFunction.NOT_EQUAL,\n    frontOperation: {\n      fail: StencilOperation.ZERO,\n      zFail: StencilOperation.ZERO,\n      zPass: StencilOperation.ZERO,\n    },\n    backFunction: StencilFunction.NOT_EQUAL,\n    backOperation: {\n      fail: StencilOperation.ZERO,\n      zFail: StencilOperation.ZERO,\n      zPass: StencilOperation.ZERO,\n    },\n    reference: 0,\n    mask: StencilConstants.CLASSIFICATION_MASK,\n  },\n  stencilMask: StencilConstants.CLASSIFICATION_MASK,\n  depthTest: {\n    enabled: false,\n  },\n  depthMask: false,\n};\n\nfunction createRenderStates(\n  classificationPrimitive,\n  context,\n  appearance,\n  twoPasses\n) {\n  if (defined(classificationPrimitive._rsStencilDepthPass)) {\n    return;\n  }\n  const stencilEnabled = !classificationPrimitive.debugShowShadowVolume;\n\n  classificationPrimitive._rsStencilDepthPass = RenderState.fromCache(\n    getStencilDepthRenderState(stencilEnabled, false)\n  );\n  classificationPrimitive._rsStencilDepthPass3DTiles = RenderState.fromCache(\n    getStencilDepthRenderState(stencilEnabled, true)\n  );\n  classificationPrimitive._rsColorPass = RenderState.fromCache(\n    getColorRenderState(stencilEnabled, false)\n  );\n  classificationPrimitive._rsPickPass = RenderState.fromCache(pickRenderState);\n}\n\nfunction modifyForEncodedNormals(primitive, vertexShaderSource) {\n  if (!primitive.compressVertices) {\n    return vertexShaderSource;\n  }\n\n  if (\n    vertexShaderSource.search(/attribute\\s+vec3\\s+extrudeDirection;/g) !== -1\n  ) {\n    const attributeName = \"compressedAttributes\";\n\n    //only shadow volumes use extrudeDirection, and shadow volumes use vertexFormat: POSITION_ONLY so we don't need to check other attributes\n    const attributeDecl = `attribute vec2 ${attributeName};`;\n\n    const globalDecl = \"vec3 extrudeDirection;\\n\";\n    const decode = `    extrudeDirection = czm_octDecode(${attributeName}, 65535.0);\\n`;\n\n    let modifiedVS = vertexShaderSource;\n    modifiedVS = modifiedVS.replace(\n      /attribute\\s+vec3\\s+extrudeDirection;/g,\n      \"\"\n    );\n    modifiedVS = ShaderSource.replaceMain(\n      modifiedVS,\n      \"czm_non_compressed_main\"\n    );\n    const compressedMain =\n      `${\"void main() \\n\" + \"{ \\n\"}${decode}    czm_non_compressed_main(); \\n` +\n      `}`;\n\n    return [attributeDecl, globalDecl, modifiedVS, compressedMain].join(\"\\n\");\n  }\n}\n\nfunction createShaderProgram(classificationPrimitive, frameState) {\n  const context = frameState.context;\n  const primitive = classificationPrimitive._primitive;\n  let vs = ShadowVolumeAppearanceVS;\n  vs = classificationPrimitive._primitive._batchTable.getVertexShaderCallback()(\n    vs\n  );\n  vs = Primitive._appendDistanceDisplayConditionToShader(primitive, vs);\n  vs = Primitive._modifyShaderPosition(\n    classificationPrimitive,\n    vs,\n    frameState.scene3DOnly\n  );\n  vs = Primitive._updateColorAttribute(primitive, vs);\n\n  const planarExtents = classificationPrimitive._hasPlanarExtentsAttributes;\n  const cullFragmentsUsingExtents =\n    planarExtents || classificationPrimitive._hasSphericalExtentsAttribute;\n\n  if (classificationPrimitive._extruded) {\n    vs = modifyForEncodedNormals(primitive, vs);\n  }\n\n  const extrudedDefine = classificationPrimitive._extruded\n    ? \"EXTRUDED_GEOMETRY\"\n    : \"\";\n\n  let vsSource = new ShaderSource({\n    defines: [extrudedDefine],\n    sources: [vs],\n  });\n  const fsSource = new ShaderSource({\n    sources: [ShadowVolumeFS],\n  });\n  const attributeLocations =\n    classificationPrimitive._primitive._attributeLocations;\n\n  const shadowVolumeAppearance = new ShadowVolumeAppearance(\n    cullFragmentsUsingExtents,\n    planarExtents,\n    classificationPrimitive.appearance\n  );\n\n  classificationPrimitive._spStencil = ShaderProgram.replaceCache({\n    context: context,\n    shaderProgram: classificationPrimitive._spStencil,\n    vertexShaderSource: vsSource,\n    fragmentShaderSource: fsSource,\n    attributeLocations: attributeLocations,\n  });\n\n  if (classificationPrimitive._primitive.allowPicking) {\n    let vsPick = ShaderSource.createPickVertexShaderSource(vs);\n    vsPick = Primitive._appendShowToShader(primitive, vsPick);\n    vsPick = Primitive._updatePickColorAttribute(vsPick);\n\n    const pickFS3D = shadowVolumeAppearance.createPickFragmentShader(false);\n    const pickVS3D = shadowVolumeAppearance.createPickVertexShader(\n      [extrudedDefine],\n      vsPick,\n      false,\n      frameState.mapProjection\n    );\n\n    classificationPrimitive._spPick = ShaderProgram.replaceCache({\n      context: context,\n      shaderProgram: classificationPrimitive._spPick,\n      vertexShaderSource: pickVS3D,\n      fragmentShaderSource: pickFS3D,\n      attributeLocations: attributeLocations,\n    });\n\n    // Derive a 2D pick shader if the primitive uses texture coordinate-based fragment culling,\n    // since texture coordinates are computed differently in 2D.\n    if (cullFragmentsUsingExtents) {\n      let pickProgram2D = context.shaderCache.getDerivedShaderProgram(\n        classificationPrimitive._spPick,\n        \"2dPick\"\n      );\n      if (!defined(pickProgram2D)) {\n        const pickFS2D = shadowVolumeAppearance.createPickFragmentShader(true);\n        const pickVS2D = shadowVolumeAppearance.createPickVertexShader(\n          [extrudedDefine],\n          vsPick,\n          true,\n          frameState.mapProjection\n        );\n\n        pickProgram2D = context.shaderCache.createDerivedShaderProgram(\n          classificationPrimitive._spPick,\n          \"2dPick\",\n          {\n            vertexShaderSource: pickVS2D,\n            fragmentShaderSource: pickFS2D,\n            attributeLocations: attributeLocations,\n          }\n        );\n      }\n      classificationPrimitive._spPick2D = pickProgram2D;\n    }\n  } else {\n    classificationPrimitive._spPick = ShaderProgram.fromCache({\n      context: context,\n      vertexShaderSource: vsSource,\n      fragmentShaderSource: fsSource,\n      attributeLocations: attributeLocations,\n    });\n  }\n\n  vs = Primitive._appendShowToShader(primitive, vs);\n  vsSource = new ShaderSource({\n    defines: [extrudedDefine],\n    sources: [vs],\n  });\n\n  classificationPrimitive._sp = ShaderProgram.replaceCache({\n    context: context,\n    shaderProgram: classificationPrimitive._sp,\n    vertexShaderSource: vsSource,\n    fragmentShaderSource: fsSource,\n    attributeLocations: attributeLocations,\n  });\n\n  // Create a fragment shader that computes only required material hookups using screen space techniques\n  const fsColorSource = shadowVolumeAppearance.createFragmentShader(false);\n  const vsColorSource = shadowVolumeAppearance.createVertexShader(\n    [extrudedDefine],\n    vs,\n    false,\n    frameState.mapProjection\n  );\n\n  classificationPrimitive._spColor = ShaderProgram.replaceCache({\n    context: context,\n    shaderProgram: classificationPrimitive._spColor,\n    vertexShaderSource: vsColorSource,\n    fragmentShaderSource: fsColorSource,\n    attributeLocations: attributeLocations,\n  });\n\n  // Derive a 2D shader if the primitive uses texture coordinate-based fragment culling,\n  // since texture coordinates are computed differently in 2D.\n  // Any material that uses texture coordinates will also equip texture coordinate-based fragment culling.\n  if (cullFragmentsUsingExtents) {\n    let colorProgram2D = context.shaderCache.getDerivedShaderProgram(\n      classificationPrimitive._spColor,\n      \"2dColor\"\n    );\n    if (!defined(colorProgram2D)) {\n      const fsColorSource2D = shadowVolumeAppearance.createFragmentShader(true);\n      const vsColorSource2D = shadowVolumeAppearance.createVertexShader(\n        [extrudedDefine],\n        vs,\n        true,\n        frameState.mapProjection\n      );\n\n      colorProgram2D = context.shaderCache.createDerivedShaderProgram(\n        classificationPrimitive._spColor,\n        \"2dColor\",\n        {\n          vertexShaderSource: vsColorSource2D,\n          fragmentShaderSource: fsColorSource2D,\n          attributeLocations: attributeLocations,\n        }\n      );\n    }\n    classificationPrimitive._spColor2D = colorProgram2D;\n  }\n}\n\nfunction createColorCommands(classificationPrimitive, colorCommands) {\n  const primitive = classificationPrimitive._primitive;\n  let length = primitive._va.length * 2; // each geometry (pack of vertex attributes) needs 2 commands: front/back stencils and fill\n  colorCommands.length = length;\n\n  let i;\n  let command;\n  let derivedCommand;\n  let vaIndex = 0;\n  let uniformMap = primitive._batchTable.getUniformMapCallback()(\n    classificationPrimitive._uniformMap\n  );\n\n  const needs2DShader = classificationPrimitive._needs2DShader;\n\n  for (i = 0; i < length; i += 2) {\n    const vertexArray = primitive._va[vaIndex++];\n\n    // Stencil depth command\n    command = colorCommands[i];\n    if (!defined(command)) {\n      command = colorCommands[i] = new DrawCommand({\n        owner: classificationPrimitive,\n        primitiveType: primitive._primitiveType,\n      });\n    }\n\n    command.vertexArray = vertexArray;\n    command.renderState = classificationPrimitive._rsStencilDepthPass;\n    command.shaderProgram = classificationPrimitive._sp;\n    command.uniformMap = uniformMap;\n    command.pass = Pass.TERRAIN_CLASSIFICATION;\n\n    derivedCommand = DrawCommand.shallowClone(\n      command,\n      command.derivedCommands.tileset\n    );\n    derivedCommand.renderState =\n      classificationPrimitive._rsStencilDepthPass3DTiles;\n    derivedCommand.pass = Pass.CESIUM_3D_TILE_CLASSIFICATION;\n    command.derivedCommands.tileset = derivedCommand;\n\n    // Color command\n    command = colorCommands[i + 1];\n    if (!defined(command)) {\n      command = colorCommands[i + 1] = new DrawCommand({\n        owner: classificationPrimitive,\n        primitiveType: primitive._primitiveType,\n      });\n    }\n\n    command.vertexArray = vertexArray;\n    command.renderState = classificationPrimitive._rsColorPass;\n    command.shaderProgram = classificationPrimitive._spColor;\n    command.pass = Pass.TERRAIN_CLASSIFICATION;\n\n    const appearance = classificationPrimitive.appearance;\n    const material = appearance.material;\n    if (defined(material)) {\n      uniformMap = combine(uniformMap, material._uniforms);\n    }\n\n    command.uniformMap = uniformMap;\n\n    derivedCommand = DrawCommand.shallowClone(\n      command,\n      command.derivedCommands.tileset\n    );\n    derivedCommand.pass = Pass.CESIUM_3D_TILE_CLASSIFICATION;\n    command.derivedCommands.tileset = derivedCommand;\n\n    // Derive for 2D if texture coordinates are ever computed\n    if (needs2DShader) {\n      // First derive from the terrain command\n      let derived2DCommand = DrawCommand.shallowClone(\n        command,\n        command.derivedCommands.appearance2D\n      );\n      derived2DCommand.shaderProgram = classificationPrimitive._spColor2D;\n      command.derivedCommands.appearance2D = derived2DCommand;\n\n      // Then derive from the 3D Tiles command\n      derived2DCommand = DrawCommand.shallowClone(\n        derivedCommand,\n        derivedCommand.derivedCommands.appearance2D\n      );\n      derived2DCommand.shaderProgram = classificationPrimitive._spColor2D;\n      derivedCommand.derivedCommands.appearance2D = derived2DCommand;\n    }\n  }\n\n  const commandsIgnoreShow = classificationPrimitive._commandsIgnoreShow;\n  const spStencil = classificationPrimitive._spStencil;\n\n  let commandIndex = 0;\n  length = commandsIgnoreShow.length = length / 2;\n\n  for (let j = 0; j < length; ++j) {\n    const commandIgnoreShow = (commandsIgnoreShow[j] = DrawCommand.shallowClone(\n      colorCommands[commandIndex],\n      commandsIgnoreShow[j]\n    ));\n    commandIgnoreShow.shaderProgram = spStencil;\n    commandIgnoreShow.pass = Pass.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW;\n\n    commandIndex += 2;\n  }\n}\n\nfunction createPickCommands(classificationPrimitive, pickCommands) {\n  const usePickOffsets = classificationPrimitive._usePickOffsets;\n\n  const primitive = classificationPrimitive._primitive;\n  let length = primitive._va.length * 2; // each geometry (pack of vertex attributes) needs 2 commands: front/back stencils and fill\n\n  // Fallback for batching same-color geometry instances\n  let pickOffsets;\n  let pickIndex = 0;\n  let pickOffset;\n  if (usePickOffsets) {\n    pickOffsets = primitive._pickOffsets;\n    length = pickOffsets.length * 2;\n  }\n\n  pickCommands.length = length;\n\n  let j;\n  let command;\n  let derivedCommand;\n  let vaIndex = 0;\n  const uniformMap = primitive._batchTable.getUniformMapCallback()(\n    classificationPrimitive._uniformMap\n  );\n\n  const needs2DShader = classificationPrimitive._needs2DShader;\n\n  for (j = 0; j < length; j += 2) {\n    let vertexArray = primitive._va[vaIndex++];\n    if (usePickOffsets) {\n      pickOffset = pickOffsets[pickIndex++];\n      vertexArray = primitive._va[pickOffset.index];\n    }\n\n    // Stencil depth command\n    command = pickCommands[j];\n    if (!defined(command)) {\n      command = pickCommands[j] = new DrawCommand({\n        owner: classificationPrimitive,\n        primitiveType: primitive._primitiveType,\n        pickOnly: true,\n      });\n    }\n\n    command.vertexArray = vertexArray;\n    command.renderState = classificationPrimitive._rsStencilDepthPass;\n    command.shaderProgram = classificationPrimitive._sp;\n    command.uniformMap = uniformMap;\n    command.pass = Pass.TERRAIN_CLASSIFICATION;\n    if (usePickOffsets) {\n      command.offset = pickOffset.offset;\n      command.count = pickOffset.count;\n    }\n\n    // Derive for 3D Tiles classification\n    derivedCommand = DrawCommand.shallowClone(\n      command,\n      command.derivedCommands.tileset\n    );\n    derivedCommand.renderState =\n      classificationPrimitive._rsStencilDepthPass3DTiles;\n    derivedCommand.pass = Pass.CESIUM_3D_TILE_CLASSIFICATION;\n    command.derivedCommands.tileset = derivedCommand;\n\n    // Pick color command\n    command = pickCommands[j + 1];\n    if (!defined(command)) {\n      command = pickCommands[j + 1] = new DrawCommand({\n        owner: classificationPrimitive,\n        primitiveType: primitive._primitiveType,\n        pickOnly: true,\n      });\n    }\n\n    command.vertexArray = vertexArray;\n    command.renderState = classificationPrimitive._rsPickPass;\n    command.shaderProgram = classificationPrimitive._spPick;\n    command.uniformMap = uniformMap;\n    command.pass = Pass.TERRAIN_CLASSIFICATION;\n    if (usePickOffsets) {\n      command.offset = pickOffset.offset;\n      command.count = pickOffset.count;\n    }\n\n    derivedCommand = DrawCommand.shallowClone(\n      command,\n      command.derivedCommands.tileset\n    );\n    derivedCommand.pass = Pass.CESIUM_3D_TILE_CLASSIFICATION;\n    command.derivedCommands.tileset = derivedCommand;\n\n    // Derive for 2D if texture coordinates are ever computed\n    if (needs2DShader) {\n      // First derive from the terrain command\n      let derived2DCommand = DrawCommand.shallowClone(\n        command,\n        command.derivedCommands.pick2D\n      );\n      derived2DCommand.shaderProgram = classificationPrimitive._spPick2D;\n      command.derivedCommands.pick2D = derived2DCommand;\n\n      // Then derive from the 3D Tiles command\n      derived2DCommand = DrawCommand.shallowClone(\n        derivedCommand,\n        derivedCommand.derivedCommands.pick2D\n      );\n      derived2DCommand.shaderProgram = classificationPrimitive._spPick2D;\n      derivedCommand.derivedCommands.pick2D = derived2DCommand;\n    }\n  }\n}\n\nfunction createCommands(\n  classificationPrimitive,\n  appearance,\n  material,\n  translucent,\n  twoPasses,\n  colorCommands,\n  pickCommands\n) {\n  createColorCommands(classificationPrimitive, colorCommands);\n  createPickCommands(classificationPrimitive, pickCommands);\n}\n\nfunction boundingVolumeIndex(commandIndex, length) {\n  return Math.floor((commandIndex % length) / 2);\n}\n\nfunction updateAndQueueRenderCommand(\n  command,\n  frameState,\n  modelMatrix,\n  cull,\n  boundingVolume,\n  debugShowBoundingVolume\n) {\n  command.modelMatrix = modelMatrix;\n  command.boundingVolume = boundingVolume;\n  command.cull = cull;\n  command.debugShowBoundingVolume = debugShowBoundingVolume;\n\n  frameState.commandList.push(command);\n}\n\nfunction updateAndQueuePickCommand(\n  command,\n  frameState,\n  modelMatrix,\n  cull,\n  boundingVolume\n) {\n  command.modelMatrix = modelMatrix;\n  command.boundingVolume = boundingVolume;\n  command.cull = cull;\n\n  frameState.commandList.push(command);\n}\n\nfunction updateAndQueueCommands(\n  classificationPrimitive,\n  frameState,\n  colorCommands,\n  pickCommands,\n  modelMatrix,\n  cull,\n  debugShowBoundingVolume,\n  twoPasses\n) {\n  const primitive = classificationPrimitive._primitive;\n  Primitive._updateBoundingVolumes(primitive, frameState, modelMatrix);\n\n  let boundingVolumes;\n  if (frameState.mode === SceneMode.SCENE3D) {\n    boundingVolumes = primitive._boundingSphereWC;\n  } else if (frameState.mode === SceneMode.COLUMBUS_VIEW) {\n    boundingVolumes = primitive._boundingSphereCV;\n  } else if (\n    frameState.mode === SceneMode.SCENE2D &&\n    defined(primitive._boundingSphere2D)\n  ) {\n    boundingVolumes = primitive._boundingSphere2D;\n  } else if (defined(primitive._boundingSphereMorph)) {\n    boundingVolumes = primitive._boundingSphereMorph;\n  }\n\n  const classificationType = classificationPrimitive.classificationType;\n  const queueTerrainCommands =\n    classificationType !== ClassificationType.CESIUM_3D_TILE;\n  const queue3DTilesCommands =\n    classificationType !== ClassificationType.TERRAIN;\n\n  const passes = frameState.passes;\n\n  let i;\n  let boundingVolume;\n  let command;\n\n  if (passes.render) {\n    const colorLength = colorCommands.length;\n    for (i = 0; i < colorLength; ++i) {\n      boundingVolume = boundingVolumes[boundingVolumeIndex(i, colorLength)];\n      if (queueTerrainCommands) {\n        command = colorCommands[i];\n        updateAndQueueRenderCommand(\n          command,\n          frameState,\n          modelMatrix,\n          cull,\n          boundingVolume,\n          debugShowBoundingVolume\n        );\n      }\n      if (queue3DTilesCommands) {\n        command = colorCommands[i].derivedCommands.tileset;\n        updateAndQueueRenderCommand(\n          command,\n          frameState,\n          modelMatrix,\n          cull,\n          boundingVolume,\n          debugShowBoundingVolume\n        );\n      }\n    }\n\n    if (frameState.invertClassification) {\n      const ignoreShowCommands = classificationPrimitive._commandsIgnoreShow;\n      const ignoreShowCommandsLength = ignoreShowCommands.length;\n      for (i = 0; i < ignoreShowCommandsLength; ++i) {\n        boundingVolume = boundingVolumes[i];\n        command = ignoreShowCommands[i];\n        updateAndQueueRenderCommand(\n          command,\n          frameState,\n          modelMatrix,\n          cull,\n          boundingVolume,\n          debugShowBoundingVolume\n        );\n      }\n    }\n  }\n\n  if (passes.pick) {\n    const pickLength = pickCommands.length;\n    const pickOffsets = primitive._pickOffsets;\n    for (i = 0; i < pickLength; ++i) {\n      const pickOffset = pickOffsets[boundingVolumeIndex(i, pickLength)];\n      boundingVolume = boundingVolumes[pickOffset.index];\n      if (queueTerrainCommands) {\n        command = pickCommands[i];\n        updateAndQueuePickCommand(\n          command,\n          frameState,\n          modelMatrix,\n          cull,\n          boundingVolume\n        );\n      }\n      if (queue3DTilesCommands) {\n        command = pickCommands[i].derivedCommands.tileset;\n        updateAndQueuePickCommand(\n          command,\n          frameState,\n          modelMatrix,\n          cull,\n          boundingVolume\n        );\n      }\n    }\n  }\n}\n\n/**\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\n * get the draw commands needed to render this primitive.\n * <p>\n * Do not call this function directly.  This is documented just to\n * list the exceptions that may be propagated when the scene is rendered:\n * </p>\n *\n * @exception {DeveloperError} All instance geometries must have the same primitiveType.\n * @exception {DeveloperError} Appearance and material have a uniform with the same name.\n * @exception {DeveloperError} Not all of the geometry instances have the same color attribute.\n */\nClassificationPrimitive.prototype.update = function (frameState) {\n  if (!defined(this._primitive) && !defined(this.geometryInstances)) {\n    return;\n  }\n\n  let appearance = this.appearance;\n  if (defined(appearance) && defined(appearance.material)) {\n    appearance.material.update(frameState.context);\n  }\n\n  const that = this;\n  const primitiveOptions = this._primitiveOptions;\n\n  if (!defined(this._primitive)) {\n    const instances = Array.isArray(this.geometryInstances)\n      ? this.geometryInstances\n      : [this.geometryInstances];\n    const length = instances.length;\n\n    let i;\n    let instance;\n    let attributes;\n\n    let hasPerColorAttribute = false;\n    let allColorsSame = true;\n    let firstColor;\n    let hasSphericalExtentsAttribute = false;\n    let hasPlanarExtentsAttributes = false;\n\n    if (length > 0) {\n      attributes = instances[0].attributes;\n      // Not expecting these to be set by users, should only be set via GroundPrimitive.\n      // So don't check for mismatch.\n      hasSphericalExtentsAttribute = ShadowVolumeAppearance.hasAttributesForSphericalExtents(\n        attributes\n      );\n      hasPlanarExtentsAttributes = ShadowVolumeAppearance.hasAttributesForTextureCoordinatePlanes(\n        attributes\n      );\n      firstColor = attributes.color;\n    }\n\n    for (i = 0; i < length; i++) {\n      instance = instances[i];\n      const color = instance.attributes.color;\n      if (defined(color)) {\n        hasPerColorAttribute = true;\n      }\n      //>>includeStart('debug', pragmas.debug);\n      else if (hasPerColorAttribute) {\n        throw new DeveloperError(\n          \"All GeometryInstances must have color attributes to use per-instance color.\"\n        );\n      }\n      //>>includeEnd('debug');\n\n      allColorsSame =\n        allColorsSame &&\n        defined(color) &&\n        ColorGeometryInstanceAttribute.equals(firstColor, color);\n    }\n\n    // If no attributes exist for computing spherical extents or fragment culling,\n    // throw if the colors aren't all the same.\n    if (\n      !allColorsSame &&\n      !hasSphericalExtentsAttribute &&\n      !hasPlanarExtentsAttributes\n    ) {\n      throw new DeveloperError(\n        \"All GeometryInstances must have the same color attribute except via GroundPrimitives\"\n      );\n    }\n\n    // default to a color appearance\n    if (hasPerColorAttribute && !defined(appearance)) {\n      appearance = new PerInstanceColorAppearance({\n        flat: true,\n      });\n      this.appearance = appearance;\n    }\n\n    //>>includeStart('debug', pragmas.debug);\n    if (\n      !hasPerColorAttribute &&\n      appearance instanceof PerInstanceColorAppearance\n    ) {\n      throw new DeveloperError(\n        \"PerInstanceColorAppearance requires color GeometryInstanceAttributes on all GeometryInstances\"\n      );\n    }\n    if (\n      defined(appearance.material) &&\n      !hasSphericalExtentsAttribute &&\n      !hasPlanarExtentsAttributes\n    ) {\n      throw new DeveloperError(\n        \"Materials on ClassificationPrimitives are not supported except via GroundPrimitives\"\n      );\n    }\n    //>>includeEnd('debug');\n\n    this._usePickOffsets =\n      !hasSphericalExtentsAttribute && !hasPlanarExtentsAttributes;\n    this._hasSphericalExtentsAttribute = hasSphericalExtentsAttribute;\n    this._hasPlanarExtentsAttributes = hasPlanarExtentsAttributes;\n    this._hasPerColorAttribute = hasPerColorAttribute;\n\n    const geometryInstances = new Array(length);\n    for (i = 0; i < length; ++i) {\n      instance = instances[i];\n      geometryInstances[i] = new GeometryInstance({\n        geometry: instance.geometry,\n        attributes: instance.attributes,\n        modelMatrix: instance.modelMatrix,\n        id: instance.id,\n        pickPrimitive: defaultValue(this._pickPrimitive, that),\n      });\n    }\n\n    primitiveOptions.appearance = appearance;\n    primitiveOptions.geometryInstances = geometryInstances;\n\n    if (defined(this._createBoundingVolumeFunction)) {\n      primitiveOptions._createBoundingVolumeFunction = function (\n        frameState,\n        geometry\n      ) {\n        that._createBoundingVolumeFunction(frameState, geometry);\n      };\n    }\n\n    primitiveOptions._createRenderStatesFunction = function (\n      primitive,\n      context,\n      appearance,\n      twoPasses\n    ) {\n      createRenderStates(that, context);\n    };\n    primitiveOptions._createShaderProgramFunction = function (\n      primitive,\n      frameState,\n      appearance\n    ) {\n      createShaderProgram(that, frameState);\n    };\n    primitiveOptions._createCommandsFunction = function (\n      primitive,\n      appearance,\n      material,\n      translucent,\n      twoPasses,\n      colorCommands,\n      pickCommands\n    ) {\n      createCommands(\n        that,\n        undefined,\n        undefined,\n        true,\n        false,\n        colorCommands,\n        pickCommands\n      );\n    };\n\n    if (defined(this._updateAndQueueCommandsFunction)) {\n      primitiveOptions._updateAndQueueCommandsFunction = function (\n        primitive,\n        frameState,\n        colorCommands,\n        pickCommands,\n        modelMatrix,\n        cull,\n        debugShowBoundingVolume,\n        twoPasses\n      ) {\n        that._updateAndQueueCommandsFunction(\n          primitive,\n          frameState,\n          colorCommands,\n          pickCommands,\n          modelMatrix,\n          cull,\n          debugShowBoundingVolume,\n          twoPasses\n        );\n      };\n    } else {\n      primitiveOptions._updateAndQueueCommandsFunction = function (\n        primitive,\n        frameState,\n        colorCommands,\n        pickCommands,\n        modelMatrix,\n        cull,\n        debugShowBoundingVolume,\n        twoPasses\n      ) {\n        updateAndQueueCommands(\n          that,\n          frameState,\n          colorCommands,\n          pickCommands,\n          modelMatrix,\n          cull,\n          debugShowBoundingVolume,\n          twoPasses\n        );\n      };\n    }\n\n    this._primitive = new Primitive(primitiveOptions);\n    this._primitive.readyPromise.then(function (primitive) {\n      that._ready = true;\n\n      if (that.releaseGeometryInstances) {\n        that.geometryInstances = undefined;\n      }\n\n      const error = primitive._error;\n      if (!defined(error)) {\n        that._readyPromise.resolve(that);\n      } else {\n        that._readyPromise.reject(error);\n      }\n    });\n  }\n\n  if (\n    this.debugShowShadowVolume &&\n    !this._debugShowShadowVolume &&\n    this._ready\n  ) {\n    this._debugShowShadowVolume = true;\n    this._rsStencilDepthPass = RenderState.fromCache(\n      getStencilDepthRenderState(false, false)\n    );\n    this._rsStencilDepthPass3DTiles = RenderState.fromCache(\n      getStencilDepthRenderState(false, true)\n    );\n    this._rsColorPass = RenderState.fromCache(getColorRenderState(false));\n  } else if (!this.debugShowShadowVolume && this._debugShowShadowVolume) {\n    this._debugShowShadowVolume = false;\n    this._rsStencilDepthPass = RenderState.fromCache(\n      getStencilDepthRenderState(true, false)\n    );\n    this._rsStencilDepthPass3DTiles = RenderState.fromCache(\n      getStencilDepthRenderState(true, true)\n    );\n    this._rsColorPass = RenderState.fromCache(getColorRenderState(true));\n  }\n  // Update primitive appearance\n  if (this._primitive.appearance !== appearance) {\n    //>>includeStart('debug', pragmas.debug);\n    // Check if the appearance is supported by the geometry attributes\n    if (\n      !this._hasSphericalExtentsAttribute &&\n      !this._hasPlanarExtentsAttributes &&\n      defined(appearance.material)\n    ) {\n      throw new DeveloperError(\n        \"Materials on ClassificationPrimitives are not supported except via GroundPrimitive\"\n      );\n    }\n    if (\n      !this._hasPerColorAttribute &&\n      appearance instanceof PerInstanceColorAppearance\n    ) {\n      throw new DeveloperError(\n        \"PerInstanceColorAppearance requires color GeometryInstanceAttribute\"\n      );\n    }\n    //>>includeEnd('debug');\n    this._primitive.appearance = appearance;\n  }\n\n  this._primitive.show = this.show;\n  this._primitive.debugShowBoundingVolume = this.debugShowBoundingVolume;\n  this._primitive.update(frameState);\n};\n\n/**\n * Returns the modifiable per-instance attributes for a {@link GeometryInstance}.\n *\n * @param {*} id The id of the {@link GeometryInstance}.\n * @returns {Object} The typed array in the attribute's format or undefined if the is no instance with id.\n *\n * @exception {DeveloperError} must call update before calling getGeometryInstanceAttributes.\n *\n * @example\n * const attributes = primitive.getGeometryInstanceAttributes('an id');\n * attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.AQUA);\n * attributes.show = Cesium.ShowGeometryInstanceAttribute.toValue(true);\n */\nClassificationPrimitive.prototype.getGeometryInstanceAttributes = function (\n  id\n) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(this._primitive)) {\n    throw new DeveloperError(\n      \"must call update before calling getGeometryInstanceAttributes\"\n    );\n  }\n  //>>includeEnd('debug');\n  return this._primitive.getGeometryInstanceAttributes(id);\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <p>\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * </p>\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see ClassificationPrimitive#destroy\n */\nClassificationPrimitive.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <p>\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n * </p>\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @example\n * e = e && e.destroy();\n *\n * @see ClassificationPrimitive#isDestroyed\n */\nClassificationPrimitive.prototype.destroy = function () {\n  this._primitive = this._primitive && this._primitive.destroy();\n  this._sp = this._sp && this._sp.destroy();\n  this._spPick = this._spPick && this._spPick.destroy();\n  this._spColor = this._spColor && this._spColor.destroy();\n\n  // Derived programs, destroyed above if they existed.\n  this._spPick2D = undefined;\n  this._spColor2D = undefined;\n  return destroyObject(this);\n};\nexport default ClassificationPrimitive;\n","/**\n * Whether a classification affects terrain, 3D Tiles or both.\n *\n * @enum {Number}\n */\nconst ClassificationType = {\n  /**\n   * Only terrain will be classified.\n   *\n   * @type {Number}\n   * @constant\n   */\n  TERRAIN: 0,\n  /**\n   * Only 3D Tiles will be classified.\n   *\n   * @type {Number}\n   * @constant\n   */\n  CESIUM_3D_TILE: 1,\n  /**\n   * Both terrain and 3D Tiles will be classified.\n   *\n   * @type {Number}\n   * @constant\n   */\n  BOTH: 2,\n};\n\n/**\n * @private\n */\nClassificationType.NUMBER_OF_CLASSIFICATION_TYPES = 3;\n\nexport default Object.freeze(ClassificationType);\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport defined from \"../Core/defined.js\";\n\n/**\n * A Plane in Hessian Normal form to be used with {@link ClippingPlaneCollection}.\n * Compatible with mathematics functions in {@link Plane}\n *\n * @alias ClippingPlane\n * @constructor\n *\n * @param {Cartesian3} normal The plane's normal (normalized).\n * @param {Number} distance The shortest distance from the origin to the plane.  The sign of\n * <code>distance</code> determines which side of the plane the origin\n * is on.  If <code>distance</code> is positive, the origin is in the half-space\n * in the direction of the normal; if negative, the origin is in the half-space\n * opposite to the normal; if zero, the plane passes through the origin.\n */\nfunction ClippingPlane(normal, distance) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"normal\", normal);\n  Check.typeOf.number(\"distance\", distance);\n  //>>includeEnd('debug');\n\n  this._distance = distance;\n  this._normal = new UpdateChangedCartesian3(normal, this);\n  this.onChangeCallback = undefined;\n  this.index = -1; // to be set by ClippingPlaneCollection\n}\n\nObject.defineProperties(ClippingPlane.prototype, {\n  /**\n   * The shortest distance from the origin to the plane.  The sign of\n   * <code>distance</code> determines which side of the plane the origin\n   * is on.  If <code>distance</code> is positive, the origin is in the half-space\n   * in the direction of the normal; if negative, the origin is in the half-space\n   * opposite to the normal; if zero, the plane passes through the origin.\n   *\n   * @type {Number}\n   * @memberof ClippingPlane.prototype\n   */\n  distance: {\n    get: function () {\n      return this._distance;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n      if (defined(this.onChangeCallback) && value !== this._distance) {\n        this.onChangeCallback(this.index);\n      }\n      this._distance = value;\n    },\n  },\n  /**\n   * The plane's normal.\n   *\n   * @type {Cartesian3}\n   * @memberof ClippingPlane.prototype\n   */\n  normal: {\n    get: function () {\n      return this._normal;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.object(\"value\", value);\n      //>>includeEnd('debug');\n      if (\n        defined(this.onChangeCallback) &&\n        !Cartesian3.equals(this._normal._cartesian3, value)\n      ) {\n        this.onChangeCallback(this.index);\n      }\n      // Set without firing callback again\n      Cartesian3.clone(value, this._normal._cartesian3);\n    },\n  },\n});\n\n/**\n * Create a ClippingPlane from a Plane object.\n *\n * @param {Plane} plane The plane containing parameters to copy\n * @param {ClippingPlane} [result] The object on which to store the result\n * @returns {ClippingPlane} The ClippingPlane generated from the plane's parameters.\n */\nClippingPlane.fromPlane = function (plane, result) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"plane\", plane);\n  //>>includeEnd('debug');\n\n  if (!defined(result)) {\n    result = new ClippingPlane(plane.normal, plane.distance);\n  } else {\n    result.normal = plane.normal;\n    result.distance = plane.distance;\n  }\n  return result;\n};\n\n/**\n * Clones the ClippingPlane without setting its ownership.\n * @param {ClippingPlane} clippingPlane The ClippingPlane to be cloned\n * @param {ClippingPlane} [result] The object on which to store the cloned parameters.\n * @returns {ClippingPlane} a clone of the input ClippingPlane\n */\nClippingPlane.clone = function (clippingPlane, result) {\n  if (!defined(result)) {\n    return new ClippingPlane(clippingPlane.normal, clippingPlane.distance);\n  }\n  result.normal = clippingPlane.normal;\n  result.distance = clippingPlane.distance;\n  return result;\n};\n\n/**\n * Wrapper on Cartesian3 that allows detection of Plane changes from \"members of members,\" for example:\n *\n * const clippingPlane = new ClippingPlane(...);\n * clippingPlane.normal.z = -1.0;\n *\n * @private\n */\nfunction UpdateChangedCartesian3(normal, clippingPlane) {\n  this._clippingPlane = clippingPlane;\n  this._cartesian3 = Cartesian3.clone(normal);\n}\n\nObject.defineProperties(UpdateChangedCartesian3.prototype, {\n  x: {\n    get: function () {\n      return this._cartesian3.x;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n      if (\n        defined(this._clippingPlane.onChangeCallback) &&\n        value !== this._cartesian3.x\n      ) {\n        this._clippingPlane.onChangeCallback(this._clippingPlane.index);\n      }\n      this._cartesian3.x = value;\n    },\n  },\n  y: {\n    get: function () {\n      return this._cartesian3.y;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n      if (\n        defined(this._clippingPlane.onChangeCallback) &&\n        value !== this._cartesian3.y\n      ) {\n        this._clippingPlane.onChangeCallback(this._clippingPlane.index);\n      }\n      this._cartesian3.y = value;\n    },\n  },\n  z: {\n    get: function () {\n      return this._cartesian3.z;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n      if (\n        defined(this._clippingPlane.onChangeCallback) &&\n        value !== this._cartesian3.z\n      ) {\n        this._clippingPlane.onChangeCallback(this._clippingPlane.index);\n      }\n      this._cartesian3.z = value;\n    },\n  },\n});\nexport default ClippingPlane;\n","import AttributeCompression from \"../Core/AttributeCompression.js\";\nimport Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartesian4 from \"../Core/Cartesian4.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Event from \"../Core/Event.js\";\nimport Intersect from \"../Core/Intersect.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport PixelFormat from \"../Core/PixelFormat.js\";\nimport Plane from \"../Core/Plane.js\";\nimport ContextLimits from \"../Renderer/ContextLimits.js\";\nimport PixelDatatype from \"../Renderer/PixelDatatype.js\";\nimport Sampler from \"../Renderer/Sampler.js\";\nimport Texture from \"../Renderer/Texture.js\";\nimport ClippingPlane from \"./ClippingPlane.js\";\n\n/**\n * Specifies a set of clipping planes. Clipping planes selectively disable rendering in a region on the\n * outside of the specified list of {@link ClippingPlane} objects for a single gltf model, 3D Tileset, or the globe.\n * <p>\n * In general the clipping planes' coordinates are relative to the object they're attached to, so a plane with distance set to 0 will clip\n * through the center of the object.\n * </p>\n * <p>\n * For 3D Tiles, the root tile's transform is used to position the clipping planes. If a transform is not defined, the root tile's {@link Cesium3DTile#boundingSphere} is used instead.\n * </p>\n *\n * @alias ClippingPlaneCollection\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {ClippingPlane[]} [options.planes=[]] An array of {@link ClippingPlane} objects used to selectively disable rendering on the outside of each plane.\n * @param {Boolean} [options.enabled=true] Determines whether the clipping planes are active.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix specifying an additional transform relative to the clipping planes original coordinate system.\n * @param {Boolean} [options.unionClippingRegions=false] If true, a region will be clipped if it is on the outside of any plane in the collection. Otherwise, a region will only be clipped if it is on the outside of every plane.\n * @param {Color} [options.edgeColor=Color.WHITE] The color applied to highlight the edge along which an object is clipped.\n * @param {Number} [options.edgeWidth=0.0] The width, in pixels, of the highlight applied to the edge along which an object is clipped.\n *\n * @demo {@link https://sandcastle.cesium.com/?src=3D%20Tiles%20Clipping%20Planes.html|Clipping 3D Tiles and glTF models.}\n * @demo {@link https://sandcastle.cesium.com/?src=Terrain%20Clipping%20Planes.html|Clipping the Globe.}\n *\n * @example\n * // This clipping plane's distance is positive, which means its normal\n * // is facing the origin. This will clip everything that is behind\n * // the plane, which is anything with y coordinate < -5.\n * const clippingPlanes = new Cesium.ClippingPlaneCollection({\n *     planes : [\n *         new Cesium.ClippingPlane(new Cesium.Cartesian3(0.0, 1.0, 0.0), 5.0)\n *     ],\n * });\n * // Create an entity and attach the ClippingPlaneCollection to the model.\n * const entity = viewer.entities.add({\n *     position : Cesium.Cartesian3.fromDegrees(-123.0744619, 44.0503706, 10000),\n *     model : {\n *         uri : 'model.gltf',\n *         minimumPixelSize : 128,\n *         maximumScale : 20000,\n *         clippingPlanes : clippingPlanes\n *     }\n * });\n * viewer.zoomTo(entity);\n */\nfunction ClippingPlaneCollection(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._planes = [];\n\n  // Do partial texture updates if just one plane is dirty.\n  // If many planes are dirty, refresh the entire texture.\n  this._dirtyIndex = -1;\n  this._multipleDirtyPlanes = false;\n\n  this._enabled = defaultValue(options.enabled, true);\n\n  /**\n   * The 4x4 transformation matrix specifying an additional transform relative to the clipping planes\n   * original coordinate system.\n   *\n   * @type {Matrix4}\n   * @default Matrix4.IDENTITY\n   */\n  this.modelMatrix = Matrix4.clone(\n    defaultValue(options.modelMatrix, Matrix4.IDENTITY)\n  );\n\n  /**\n   * The color applied to highlight the edge along which an object is clipped.\n   *\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  this.edgeColor = Color.clone(defaultValue(options.edgeColor, Color.WHITE));\n\n  /**\n   * The width, in pixels, of the highlight applied to the edge along which an object is clipped.\n   *\n   * @type {Number}\n   * @default 0.0\n   */\n  this.edgeWidth = defaultValue(options.edgeWidth, 0.0);\n\n  /**\n   * An event triggered when a new clipping plane is added to the collection.  Event handlers\n   * are passed the new plane and the index at which it was added.\n   * @type {Event}\n   * @default Event()\n   */\n  this.planeAdded = new Event();\n\n  /**\n   * An event triggered when a new clipping plane is removed from the collection.  Event handlers\n   * are passed the new plane and the index from which it was removed.\n   * @type {Event}\n   * @default Event()\n   */\n  this.planeRemoved = new Event();\n\n  // If this ClippingPlaneCollection has an owner, only its owner should update or destroy it.\n  // This is because in a Cesium3DTileset multiple models may reference the tileset's ClippingPlaneCollection.\n  this._owner = undefined;\n\n  const unionClippingRegions = defaultValue(\n    options.unionClippingRegions,\n    false\n  );\n  this._unionClippingRegions = unionClippingRegions;\n  this._testIntersection = unionClippingRegions\n    ? unionIntersectFunction\n    : defaultIntersectFunction;\n\n  this._uint8View = undefined;\n  this._float32View = undefined;\n\n  this._clippingPlanesTexture = undefined;\n\n  // Add each ClippingPlane object.\n  const planes = options.planes;\n  if (defined(planes)) {\n    const planesLength = planes.length;\n    for (let i = 0; i < planesLength; ++i) {\n      this.add(planes[i]);\n    }\n  }\n}\n\nfunction unionIntersectFunction(value) {\n  return value === Intersect.OUTSIDE;\n}\n\nfunction defaultIntersectFunction(value) {\n  return value === Intersect.INSIDE;\n}\n\nObject.defineProperties(ClippingPlaneCollection.prototype, {\n  /**\n   * Returns the number of planes in this collection.  This is commonly used with\n   * {@link ClippingPlaneCollection#get} to iterate over all the planes\n   * in the collection.\n   *\n   * @memberof ClippingPlaneCollection.prototype\n   * @type {Number}\n   * @readonly\n   */\n  length: {\n    get: function () {\n      return this._planes.length;\n    },\n  },\n\n  /**\n   * If true, a region will be clipped if it is on the outside of any plane in the\n   * collection. Otherwise, a region will only be clipped if it is on the\n   * outside of every plane.\n   *\n   * @memberof ClippingPlaneCollection.prototype\n   * @type {Boolean}\n   * @default false\n   */\n  unionClippingRegions: {\n    get: function () {\n      return this._unionClippingRegions;\n    },\n    set: function (value) {\n      if (this._unionClippingRegions === value) {\n        return;\n      }\n      this._unionClippingRegions = value;\n      this._testIntersection = value\n        ? unionIntersectFunction\n        : defaultIntersectFunction;\n    },\n  },\n\n  /**\n   * If true, clipping will be enabled.\n   *\n   * @memberof ClippingPlaneCollection.prototype\n   * @type {Boolean}\n   * @default true\n   */\n  enabled: {\n    get: function () {\n      return this._enabled;\n    },\n    set: function (value) {\n      if (this._enabled === value) {\n        return;\n      }\n      this._enabled = value;\n    },\n  },\n\n  /**\n   * Returns a texture containing packed, untransformed clipping planes.\n   *\n   * @memberof ClippingPlaneCollection.prototype\n   * @type {Texture}\n   * @readonly\n   * @private\n   */\n  texture: {\n    get: function () {\n      return this._clippingPlanesTexture;\n    },\n  },\n\n  /**\n   * A reference to the ClippingPlaneCollection's owner, if any.\n   *\n   * @memberof ClippingPlaneCollection.prototype\n   * @readonly\n   * @private\n   */\n  owner: {\n    get: function () {\n      return this._owner;\n    },\n  },\n\n  /**\n   * Returns a Number encapsulating the state for this ClippingPlaneCollection.\n   *\n   * Clipping mode is encoded in the sign of the number, which is just the plane count.\n   * If this value changes, then shader regeneration is necessary.\n   *\n   * @memberof ClippingPlaneCollection.prototype\n   * @returns {Number} A Number that describes the ClippingPlaneCollection's state.\n   * @readonly\n   * @private\n   */\n  clippingPlanesState: {\n    get: function () {\n      return this._unionClippingRegions\n        ? this._planes.length\n        : -this._planes.length;\n    },\n  },\n});\n\nfunction setIndexDirty(collection, index) {\n  // If there's already a different _dirtyIndex set, more than one plane has changed since update.\n  // Entire texture must be reloaded\n  collection._multipleDirtyPlanes =\n    collection._multipleDirtyPlanes ||\n    (collection._dirtyIndex !== -1 && collection._dirtyIndex !== index);\n  collection._dirtyIndex = index;\n}\n\n/**\n * Adds the specified {@link ClippingPlane} to the collection to be used to selectively disable rendering\n * on the outside of each plane. Use {@link ClippingPlaneCollection#unionClippingRegions} to modify\n * how modify the clipping behavior of multiple planes.\n *\n * @param {ClippingPlane} plane The ClippingPlane to add to the collection.\n *\n * @see ClippingPlaneCollection#unionClippingRegions\n * @see ClippingPlaneCollection#remove\n * @see ClippingPlaneCollection#removeAll\n */\nClippingPlaneCollection.prototype.add = function (plane) {\n  const newPlaneIndex = this._planes.length;\n\n  const that = this;\n  plane.onChangeCallback = function (index) {\n    setIndexDirty(that, index);\n  };\n  plane.index = newPlaneIndex;\n\n  setIndexDirty(this, newPlaneIndex);\n  this._planes.push(plane);\n  this.planeAdded.raiseEvent(plane, newPlaneIndex);\n};\n\n/**\n * Returns the plane in the collection at the specified index.  Indices are zero-based\n * and increase as planes are added.  Removing a plane shifts all planes after\n * it to the left, changing their indices.  This function is commonly used with\n * {@link ClippingPlaneCollection#length} to iterate over all the planes\n * in the collection.\n *\n * @param {Number} index The zero-based index of the plane.\n * @returns {ClippingPlane} The ClippingPlane at the specified index.\n *\n * @see ClippingPlaneCollection#length\n */\nClippingPlaneCollection.prototype.get = function (index) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.number(\"index\", index);\n  //>>includeEnd('debug');\n\n  return this._planes[index];\n};\n\nfunction indexOf(planes, plane) {\n  const length = planes.length;\n  for (let i = 0; i < length; ++i) {\n    if (Plane.equals(planes[i], plane)) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\n/**\n * Checks whether this collection contains a ClippingPlane equal to the given ClippingPlane.\n *\n * @param {ClippingPlane} [clippingPlane] The ClippingPlane to check for.\n * @returns {Boolean} true if this collection contains the ClippingPlane, false otherwise.\n *\n * @see ClippingPlaneCollection#get\n */\nClippingPlaneCollection.prototype.contains = function (clippingPlane) {\n  return indexOf(this._planes, clippingPlane) !== -1;\n};\n\n/**\n * Removes the first occurrence of the given ClippingPlane from the collection.\n *\n * @param {ClippingPlane} clippingPlane\n * @returns {Boolean} <code>true</code> if the plane was removed; <code>false</code> if the plane was not found in the collection.\n *\n * @see ClippingPlaneCollection#add\n * @see ClippingPlaneCollection#contains\n * @see ClippingPlaneCollection#removeAll\n */\nClippingPlaneCollection.prototype.remove = function (clippingPlane) {\n  const planes = this._planes;\n  const index = indexOf(planes, clippingPlane);\n\n  if (index === -1) {\n    return false;\n  }\n\n  // Unlink this ClippingPlaneCollection from the ClippingPlane\n  if (clippingPlane instanceof ClippingPlane) {\n    clippingPlane.onChangeCallback = undefined;\n    clippingPlane.index = -1;\n  }\n\n  // Shift and update indices\n  const length = planes.length - 1;\n  for (let i = index; i < length; ++i) {\n    const planeToKeep = planes[i + 1];\n    planes[i] = planeToKeep;\n    if (planeToKeep instanceof ClippingPlane) {\n      planeToKeep.index = i;\n    }\n  }\n\n  // Indicate planes texture is dirty\n  this._multipleDirtyPlanes = true;\n  planes.length = length;\n\n  this.planeRemoved.raiseEvent(clippingPlane, index);\n\n  return true;\n};\n\n/**\n * Removes all planes from the collection.\n *\n * @see ClippingPlaneCollection#add\n * @see ClippingPlaneCollection#remove\n */\nClippingPlaneCollection.prototype.removeAll = function () {\n  // Dereference this ClippingPlaneCollection from all ClippingPlanes\n  const planes = this._planes;\n  const planesCount = planes.length;\n  for (let i = 0; i < planesCount; ++i) {\n    const plane = planes[i];\n    if (plane instanceof ClippingPlane) {\n      plane.onChangeCallback = undefined;\n      plane.index = -1;\n    }\n    this.planeRemoved.raiseEvent(plane, i);\n  }\n  this._multipleDirtyPlanes = true;\n  this._planes = [];\n};\n\nconst distanceEncodeScratch = new Cartesian4();\nconst oct32EncodeScratch = new Cartesian4();\nfunction packPlanesAsUint8(clippingPlaneCollection, startIndex, endIndex) {\n  const uint8View = clippingPlaneCollection._uint8View;\n  const planes = clippingPlaneCollection._planes;\n  let byteIndex = 0;\n  for (let i = startIndex; i < endIndex; ++i) {\n    const plane = planes[i];\n\n    const oct32Normal = AttributeCompression.octEncodeToCartesian4(\n      plane.normal,\n      oct32EncodeScratch\n    );\n    uint8View[byteIndex] = oct32Normal.x;\n    uint8View[byteIndex + 1] = oct32Normal.y;\n    uint8View[byteIndex + 2] = oct32Normal.z;\n    uint8View[byteIndex + 3] = oct32Normal.w;\n\n    const encodedDistance = Cartesian4.packFloat(\n      plane.distance,\n      distanceEncodeScratch\n    );\n    uint8View[byteIndex + 4] = encodedDistance.x;\n    uint8View[byteIndex + 5] = encodedDistance.y;\n    uint8View[byteIndex + 6] = encodedDistance.z;\n    uint8View[byteIndex + 7] = encodedDistance.w;\n\n    byteIndex += 8;\n  }\n}\n\n// Pack starting at the beginning of the buffer to allow partial update\nfunction packPlanesAsFloats(clippingPlaneCollection, startIndex, endIndex) {\n  const float32View = clippingPlaneCollection._float32View;\n  const planes = clippingPlaneCollection._planes;\n\n  let floatIndex = 0;\n  for (let i = startIndex; i < endIndex; ++i) {\n    const plane = planes[i];\n    const normal = plane.normal;\n\n    float32View[floatIndex] = normal.x;\n    float32View[floatIndex + 1] = normal.y;\n    float32View[floatIndex + 2] = normal.z;\n    float32View[floatIndex + 3] = plane.distance;\n\n    floatIndex += 4; // each plane is 4 floats\n  }\n}\n\nfunction computeTextureResolution(pixelsNeeded, result) {\n  const maxSize = ContextLimits.maximumTextureSize;\n  result.x = Math.min(pixelsNeeded, maxSize);\n  result.y = Math.ceil(pixelsNeeded / result.x);\n  return result;\n}\n\nconst textureResolutionScratch = new Cartesian2();\n/**\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\n * build the resources for clipping planes.\n * <p>\n * Do not call this function directly.\n * </p>\n */\nClippingPlaneCollection.prototype.update = function (frameState) {\n  let clippingPlanesTexture = this._clippingPlanesTexture;\n  const context = frameState.context;\n  const useFloatTexture = ClippingPlaneCollection.useFloatTexture(context);\n\n  // Compute texture requirements for current planes\n  // In RGBA FLOAT, A plane is 4 floats packed to a RGBA.\n  // In RGBA UNSIGNED_BYTE, A plane is a float in [0, 1) packed to RGBA and an Oct32 quantized normal,\n  // so 8 bits or 2 pixels in RGBA.\n  const pixelsNeeded = useFloatTexture ? this.length : this.length * 2;\n\n  if (defined(clippingPlanesTexture)) {\n    const currentPixelCount =\n      clippingPlanesTexture.width * clippingPlanesTexture.height;\n    // Recreate the texture to double current requirement if it isn't big enough or is 4 times larger than it needs to be.\n    // Optimization note: this isn't exactly the classic resizeable array algorithm\n    // * not necessarily checking for resize after each add/remove operation\n    // * random-access deletes instead of just pops\n    // * alloc ops likely more expensive than demonstrable via big-O analysis\n    if (\n      currentPixelCount < pixelsNeeded ||\n      pixelsNeeded < 0.25 * currentPixelCount\n    ) {\n      clippingPlanesTexture.destroy();\n      clippingPlanesTexture = undefined;\n      this._clippingPlanesTexture = undefined;\n    }\n  }\n\n  // If there are no clipping planes, there's nothing to update.\n  if (this.length === 0) {\n    return;\n  }\n\n  if (!defined(clippingPlanesTexture)) {\n    const requiredResolution = computeTextureResolution(\n      pixelsNeeded,\n      textureResolutionScratch\n    );\n    // Allocate twice as much space as needed to avoid frequent texture reallocation.\n    // Allocate in the Y direction, since texture may be as wide as context texture support.\n    requiredResolution.y *= 2;\n\n    if (useFloatTexture) {\n      clippingPlanesTexture = new Texture({\n        context: context,\n        width: requiredResolution.x,\n        height: requiredResolution.y,\n        pixelFormat: PixelFormat.RGBA,\n        pixelDatatype: PixelDatatype.FLOAT,\n        sampler: Sampler.NEAREST,\n        flipY: false,\n      });\n      this._float32View = new Float32Array(\n        requiredResolution.x * requiredResolution.y * 4\n      );\n    } else {\n      clippingPlanesTexture = new Texture({\n        context: context,\n        width: requiredResolution.x,\n        height: requiredResolution.y,\n        pixelFormat: PixelFormat.RGBA,\n        pixelDatatype: PixelDatatype.UNSIGNED_BYTE,\n        sampler: Sampler.NEAREST,\n        flipY: false,\n      });\n      this._uint8View = new Uint8Array(\n        requiredResolution.x * requiredResolution.y * 4\n      );\n    }\n\n    this._clippingPlanesTexture = clippingPlanesTexture;\n    this._multipleDirtyPlanes = true;\n  }\n\n  const dirtyIndex = this._dirtyIndex;\n  if (!this._multipleDirtyPlanes && dirtyIndex === -1) {\n    return;\n  }\n  if (!this._multipleDirtyPlanes) {\n    // partial updates possible\n    let offsetX = 0;\n    let offsetY = 0;\n    if (useFloatTexture) {\n      offsetY = Math.floor(dirtyIndex / clippingPlanesTexture.width);\n      offsetX = Math.floor(dirtyIndex - offsetY * clippingPlanesTexture.width);\n\n      packPlanesAsFloats(this, dirtyIndex, dirtyIndex + 1);\n      clippingPlanesTexture.copyFrom({\n        source: {\n          width: 1,\n          height: 1,\n          arrayBufferView: this._float32View,\n        },\n        xOffset: offsetX,\n        yOffset: offsetY,\n      });\n    } else {\n      offsetY = Math.floor((dirtyIndex * 2) / clippingPlanesTexture.width);\n      offsetX = Math.floor(\n        dirtyIndex * 2 - offsetY * clippingPlanesTexture.width\n      );\n      packPlanesAsUint8(this, dirtyIndex, dirtyIndex + 1);\n      clippingPlanesTexture.copyFrom({\n        source: {\n          width: 2,\n          height: 1,\n          arrayBufferView: this._uint8View,\n        },\n        xOffset: offsetX,\n        yOffset: offsetY,\n      });\n    }\n  } else if (useFloatTexture) {\n    packPlanesAsFloats(this, 0, this._planes.length);\n    clippingPlanesTexture.copyFrom({\n      source: {\n        width: clippingPlanesTexture.width,\n        height: clippingPlanesTexture.height,\n        arrayBufferView: this._float32View,\n      },\n    });\n  } else {\n    packPlanesAsUint8(this, 0, this._planes.length);\n    clippingPlanesTexture.copyFrom({\n      source: {\n        width: clippingPlanesTexture.width,\n        height: clippingPlanesTexture.height,\n        arrayBufferView: this._uint8View,\n      },\n    });\n  }\n\n  this._multipleDirtyPlanes = false;\n  this._dirtyIndex = -1;\n};\n\nconst scratchMatrix = new Matrix4();\nconst scratchPlane = new Plane(Cartesian3.UNIT_X, 0.0);\n/**\n * Determines the type intersection with the planes of this ClippingPlaneCollection instance and the specified {@link TileBoundingVolume}.\n * @private\n *\n * @param {Object} tileBoundingVolume The volume to determine the intersection with the planes.\n * @param {Matrix4} [transform] An optional, additional matrix to transform the plane to world coordinates.\n * @returns {Intersect} {@link Intersect.INSIDE} if the entire volume is on the side of the planes\n *                      the normal is pointing and should be entirely rendered, {@link Intersect.OUTSIDE}\n *                      if the entire volume is on the opposite side and should be clipped, and\n *                      {@link Intersect.INTERSECTING} if the volume intersects the planes.\n */\nClippingPlaneCollection.prototype.computeIntersectionWithBoundingVolume = function (\n  tileBoundingVolume,\n  transform\n) {\n  const planes = this._planes;\n  const length = planes.length;\n\n  let modelMatrix = this.modelMatrix;\n  if (defined(transform)) {\n    modelMatrix = Matrix4.multiply(transform, modelMatrix, scratchMatrix);\n  }\n\n  // If the collection is not set to union the clipping regions, the volume must be outside of all planes to be\n  // considered completely clipped. If the collection is set to union the clipping regions, if the volume can be\n  // outside any the planes, it is considered completely clipped.\n  // Lastly, if not completely clipped, if any plane is intersecting, more calculations must be performed.\n  let intersection = Intersect.INSIDE;\n  if (!this.unionClippingRegions && length > 0) {\n    intersection = Intersect.OUTSIDE;\n  }\n\n  for (let i = 0; i < length; ++i) {\n    const plane = planes[i];\n\n    Plane.transform(plane, modelMatrix, scratchPlane); // ClippingPlane can be used for Plane math\n\n    const value = tileBoundingVolume.intersectPlane(scratchPlane);\n    if (value === Intersect.INTERSECTING) {\n      intersection = value;\n    } else if (this._testIntersection(value)) {\n      return value;\n    }\n  }\n\n  return intersection;\n};\n\n/**\n * Sets the owner for the input ClippingPlaneCollection if there wasn't another owner.\n * Destroys the owner's previous ClippingPlaneCollection if setting is successful.\n *\n * @param {ClippingPlaneCollection} [clippingPlaneCollection] A ClippingPlaneCollection (or undefined) being attached to an object\n * @param {Object} owner An Object that should receive the new ClippingPlaneCollection\n * @param {String} key The Key for the Object to reference the ClippingPlaneCollection\n * @private\n */\nClippingPlaneCollection.setOwner = function (\n  clippingPlaneCollection,\n  owner,\n  key\n) {\n  // Don't destroy the ClippingPlaneCollection if it is already owned by newOwner\n  if (clippingPlaneCollection === owner[key]) {\n    return;\n  }\n  // Destroy the existing ClippingPlaneCollection, if any\n  owner[key] = owner[key] && owner[key].destroy();\n  if (defined(clippingPlaneCollection)) {\n    //>>includeStart('debug', pragmas.debug);\n    if (defined(clippingPlaneCollection._owner)) {\n      throw new DeveloperError(\n        \"ClippingPlaneCollection should only be assigned to one object\"\n      );\n    }\n    //>>includeEnd('debug');\n    clippingPlaneCollection._owner = owner;\n    owner[key] = clippingPlaneCollection;\n  }\n};\n\n/**\n * Function for checking if the context will allow clipping planes with floating point textures.\n *\n * @param {Context} context The Context that will contain clipped objects and clipping textures.\n * @returns {Boolean} <code>true</code> if floating point textures can be used for clipping planes.\n * @private\n */\nClippingPlaneCollection.useFloatTexture = function (context) {\n  return context.floatingPointTexture;\n};\n\n/**\n * Function for getting the clipping plane collection's texture resolution.\n * If the ClippingPlaneCollection hasn't been updated, returns the resolution that will be\n * allocated based on the current plane count.\n *\n * @param {ClippingPlaneCollection} clippingPlaneCollection The clipping plane collection\n * @param {Context} context The rendering context\n * @param {Cartesian2} result A Cartesian2 for the result.\n * @returns {Cartesian2} The required resolution.\n * @private\n */\nClippingPlaneCollection.getTextureResolution = function (\n  clippingPlaneCollection,\n  context,\n  result\n) {\n  const texture = clippingPlaneCollection.texture;\n  if (defined(texture)) {\n    result.x = texture.width;\n    result.y = texture.height;\n    return result;\n  }\n\n  const pixelsNeeded = ClippingPlaneCollection.useFloatTexture(context)\n    ? clippingPlaneCollection.length\n    : clippingPlaneCollection.length * 2;\n  const requiredResolution = computeTextureResolution(pixelsNeeded, result);\n\n  // Allocate twice as much space as needed to avoid frequent texture reallocation.\n  requiredResolution.y *= 2;\n  return requiredResolution;\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see ClippingPlaneCollection#destroy\n */\nClippingPlaneCollection.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * clippingPlanes = clippingPlanes && clippingPlanes.destroy();\n *\n * @see ClippingPlaneCollection#isDestroyed\n */\nClippingPlaneCollection.prototype.destroy = function () {\n  this._clippingPlanesTexture =\n    this._clippingPlanesTexture && this._clippingPlanesTexture.destroy();\n  return destroyObject(this);\n};\nexport default ClippingPlaneCollection;\n","import BlendingState from \"./BlendingState.js\";\nimport Buffer from \"../Renderer/Buffer.js\";\nimport BufferUsage from \"../Renderer/BufferUsage.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport ComputeCommand from \"../Renderer/ComputeCommand.js\";\nimport CloudType from \"./CloudType.js\";\nimport CloudCollectionFS from \"../Shaders/CloudCollectionFS.js\";\nimport CloudCollectionVS from \"../Shaders/CloudCollectionVS.js\";\nimport CloudNoiseFS from \"../Shaders/CloudNoiseFS.js\";\nimport CloudNoiseVS from \"../Shaders/CloudNoiseVS.js\";\nimport ComponentDatatype from \"../Core/ComponentDatatype.js\";\nimport CumulusCloud from \"./CumulusCloud.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport DrawCommand from \"../Renderer/DrawCommand.js\";\nimport EncodedCartesian3 from \"../Core/EncodedCartesian3.js\";\nimport IndexDatatype from \"../Core/IndexDatatype.js\";\nimport Pass from \"../Renderer/Pass.js\";\nimport PixelDatatype from \"../Renderer/PixelDatatype.js\";\nimport PixelFormat from \"../Core/PixelFormat.js\";\nimport RenderState from \"../Renderer/RenderState.js\";\nimport Sampler from \"../Renderer/Sampler.js\";\nimport ShaderSource from \"../Renderer/ShaderSource.js\";\nimport ShaderProgram from \"../Renderer/ShaderProgram.js\";\nimport Texture from \"../Renderer/Texture.js\";\nimport TextureMagnificationFilter from \"../Renderer/TextureMagnificationFilter.js\";\nimport TextureMinificationFilter from \"../Renderer/TextureMinificationFilter.js\";\nimport TextureWrap from \"../Renderer/TextureWrap.js\";\nimport VertexArray from \"../Renderer/VertexArray.js\";\nimport VertexArrayFacade from \"../Renderer/VertexArrayFacade.js\";\nimport WebGLConstants from \"../Core/WebGLConstants.js\";\n\nlet attributeLocations;\nconst scratchTextureDimensions = new Cartesian3();\n\nconst attributeLocationsBatched = {\n  positionHighAndScaleX: 0,\n  positionLowAndScaleY: 1,\n  packedAttribute0: 2, // show, brightness, direction\n  packedAttribute1: 3, // cloudSize, slice\n  color: 4,\n};\n\nconst attributeLocationsInstanced = {\n  direction: 0,\n  positionHighAndScaleX: 1,\n  positionLowAndScaleY: 2,\n  packedAttribute0: 3, // show, brightness\n  packedAttribute1: 4, // cloudSize, slice\n  color: 5,\n};\n\nconst SHOW_INDEX = CumulusCloud.SHOW_INDEX;\nconst POSITION_INDEX = CumulusCloud.POSITION_INDEX;\nconst SCALE_INDEX = CumulusCloud.SCALE_INDEX;\nconst MAXIMUM_SIZE_INDEX = CumulusCloud.MAXIMUM_SIZE_INDEX;\nconst SLICE_INDEX = CumulusCloud.SLICE_INDEX;\nconst BRIGHTNESS_INDEX = CumulusCloud.BRIGHTNESS_INDEX;\nconst NUMBER_OF_PROPERTIES = CumulusCloud.NUMBER_OF_PROPERTIES;\nconst COLOR_INDEX = CumulusCloud.COLOR_INDEX;\n\n/**\n * A renderable collection of clouds in the 3D scene.\n * <br /><br />\n * <div align='center'>\n * <img src='Images/CumulusCloud.png' width='400' height='300' /><br />\n * Example cumulus clouds\n * </div>\n * <br /><br />\n * Clouds are added and removed from the collection using {@link CloudCollection#add}\n * and {@link CloudCollection#remove}.\n * @alias CloudCollection\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Boolean} [options.show=true] Whether to display the clouds.\n * @param {Number} [options.noiseDetail=16.0] Desired amount of detail in the noise texture.\n * @param {Number} [options.noiseOffset=Cartesian3.ZERO] Desired translation of data in noise texture.\n * @param {Boolean} [options.debugBillboards=false] For debugging only. Determines if the billboards are rendered with an opaque color.\n * @param {Boolean} [options.debugEllipsoids=false] For debugging only. Determines if the clouds will be rendered as opaque ellipsoids.\n * @see CloudCollection#add\n * @see CloudCollection#remove\n * @see CumulusCloud\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=Clouds.html|Cesium Sandcastle Clouds Demo}\n * @demo {@link https://sandcastle.cesium.com/index.html?src=Cloud%20Parameters.html|Cesium Sandcastle Cloud Parameters Demo}\n *\n * @example\n * // Create a cloud collection with two cumulus clouds\n * const clouds = scene.primitives.add(new Cesium.CloudCollection());\n * clouds.add({\n *   position : new Cesium.Cartesian3(1.0, 2.0, 3.0),\n *   maximumSize: new Cesium.Cartesian3(20.0, 12.0, 8.0)\n * });\n * clouds.add({\n *   position : new Cesium.Cartesian3(4.0, 5.0, 6.0),\n *   maximumSize: new Cesium.Cartesian3(15.0, 9.0, 9.0),\n *   slice: 0.5\n * });\n *\n */\nfunction CloudCollection(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  this._clouds = [];\n  this._cloudsToUpdate = [];\n  this._cloudsToUpdateIndex = 0;\n  this._cloudsRemoved = false;\n  this._createVertexArray = false;\n\n  this._propertiesChanged = new Uint32Array(NUMBER_OF_PROPERTIES);\n\n  this._noiseTexture = undefined;\n  this._textureSliceWidth = 128;\n  this._noiseTextureRows = 4;\n\n  /**\n   * <p>\n   * Controls the amount of detail captured in the precomputed noise texture\n   * used to render the cumulus clouds. In order for the texture to be tileable,\n   * this must be a power of two. For best results, set this to be a power of two\n   * between <code>8.0</code> and <code>32.0</code> (inclusive).\n   * </p>\n   *\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'>\n   *   <code>clouds.noiseDetail = 8.0;</code><br/>\n   *   <img src='Images/CloudCollection.noiseDetail8.png' width='250' height='158' />\n   * </td>\n   * <td align='center'>\n   *   <code>clouds.noiseDetail = 32.0;</code><br/>\n   *   <img src='Images/CloudCollection.noiseDetail32.png' width='250' height='158' />\n   * </td>\n   * </tr></table>\n   * </div>\n   *\n   * @type {Number}\n   *\n   * @default 16.0\n   */\n  this.noiseDetail = defaultValue(options.noiseDetail, 16.0);\n\n  /**\n   * <p>\n   * Applies a translation to noise texture coordinates to generate different data.\n   * This can be modified if the default noise does not generate good-looking clouds.\n   * </p>\n   *\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'>\n   *   <code>default</code><br/>\n   *   <img src='Images/CloudCollection.noiseOffsetdefault.png' width='250' height='158' />\n   * </td>\n   * <td align='center'>\n   *   <code>clouds.noiseOffset = new Cesium.Cartesian3(10, 20, 10);</code><br/>\n   *   <img src='Images/CloudCollection.noiseOffsetx10y20z10.png' width='250' height='158' />\n   * </td>\n   * </tr></table>\n   * </div>\n   * @type {Cartesian3}\n   *\n   * @default Cartesian3.ZERO\n   */\n  this.noiseOffset = Cartesian3.clone(\n    defaultValue(options.noiseOffset, Cartesian3.ZERO)\n  );\n\n  this._loading = false;\n  this._ready = false;\n\n  const that = this;\n  this._uniforms = {\n    u_noiseTexture: function () {\n      return that._noiseTexture;\n    },\n    u_noiseTextureDimensions: getNoiseTextureDimensions(that),\n    u_noiseDetail: function () {\n      return that.noiseDetail;\n    },\n  };\n\n  this._vaNoise = undefined;\n  this._spNoise = undefined;\n\n  this._spCreated = false;\n  this._sp = undefined;\n  this._rs = undefined;\n\n  /**\n   * Determines if billboards in this collection will be shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n\n  this._colorCommands = [];\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Renders the billboards with one opaque color for the sake of debugging.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugBillboards = defaultValue(options.debugBillboards, false);\n  this._compiledDebugBillboards = false;\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the clouds as opaque, monochrome ellipsoids for the sake of debugging.\n   * If <code>debugBillboards</code> is also true, then the ellipsoids will draw on top of the billboards.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugEllipsoids = defaultValue(options.debugEllipsoids, false);\n  this._compiledDebugEllipsoids = false;\n}\n\n// Wraps useful texture metrics into a single vec3 for less overhead.\nfunction getNoiseTextureDimensions(collection) {\n  return function () {\n    scratchTextureDimensions.x = collection._textureSliceWidth;\n    scratchTextureDimensions.y = collection._noiseTextureRows;\n    scratchTextureDimensions.z = 1.0 / collection._noiseTextureRows;\n    return scratchTextureDimensions;\n  };\n}\n\nObject.defineProperties(CloudCollection.prototype, {\n  /**\n   * Returns the number of clouds in this collection.\n   * @memberof CloudCollection.prototype\n   * @type {Number}\n   */\n  length: {\n    get: function () {\n      removeClouds(this);\n      return this._clouds.length;\n    },\n  },\n});\n\nfunction destroyClouds(clouds) {\n  const length = clouds.length;\n  for (let i = 0; i < length; ++i) {\n    if (clouds[i]) {\n      clouds[i]._destroy();\n    }\n  }\n}\n\n/**\n * Creates and adds a cloud with the specified initial properties to the collection.\n * The added cloud is returned so it can be modified or removed from the collection later.\n *\n * @param {Object}[options] A template describing the cloud's properties as shown in Example 1.\n * @returns {CumulusCloud} The cloud that was added to the collection.\n *\n * @performance Calling <code>add</code> is expected constant time.  However, the collection's vertex buffer\n * is rewritten - an <code>O(n)</code> operation that also incurs CPU to GPU overhead.  For\n * best performance, add as many clouds as possible before calling <code>update</code>.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * // Example 1:  Add a cumulus cloud, specifying all the default values.\n * const c = clouds.add({\n *   show : true,\n *   position : Cesium.Cartesian3.ZERO,\n *   scale : new Cesium.Cartesian2(20.0, 12.0),\n *   maximumSize: new Cesium.Cartesian3(20.0, 12.0, 12.0),\n *   slice: -1.0,\n *   cloudType : CloudType.CUMULUS\n * });\n *\n * @example\n * // Example 2:  Specify only the cloud's cartographic position.\n * const c = clouds.add({\n *   position : Cesium.Cartesian3.fromDegrees(longitude, latitude, height)\n * });\n *\n * @see CloudCollection#remove\n * @see CloudCollection#removeAll\n */\nCloudCollection.prototype.add = function (options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  const cloudType = defaultValue(options.cloudType, CloudType.CUMULUS);\n  //>>includeStart('debug', pragmas.debug);\n  if (!CloudType.validate(cloudType)) {\n    throw new DeveloperError(\"invalid cloud type\");\n  }\n  //>>includeEnd('debug');\n\n  let cloud;\n  if (cloudType === CloudType.CUMULUS) {\n    cloud = new CumulusCloud(options, this);\n    cloud._index = this._clouds.length;\n    this._clouds.push(cloud);\n    this._createVertexArray = true;\n  }\n\n  return cloud;\n};\n\n/**\n * Removes a cloud from the collection.\n *\n * @param {CumulusCloud} cloud The cloud to remove.\n * @returns {Boolean} <code>true</code> if the cloud was removed; <code>false</code> if the cloud was not found in the collection.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * const c = clouds.add(...);\n * clouds.remove(c);  // Returns true\n *\n * @see CloudCollection#add\n * @see CloudCollection#removeAll\n * @see CumulusCloud#show\n */\nCloudCollection.prototype.remove = function (cloud) {\n  if (this.contains(cloud)) {\n    this._clouds[cloud._index] = undefined; // Removed later in removeClouds()\n    this._cloudsRemoved = true;\n    this._createVertexArray = true;\n    cloud._destroy();\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * Removes all clouds from the collection.\n *\n * @performance <code>O(n)</code>.  It is more efficient to remove all the clouds\n * from a collection and then add new ones than to create a new collection entirely.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @example\n * clouds.add(...);\n * clouds.add(...);\n * clouds.removeAll();\n *\n * @see CloudCollection#add\n * @see CloudCollection#remove\n */\nCloudCollection.prototype.removeAll = function () {\n  destroyClouds(this._clouds);\n  this._clouds = [];\n  this._cloudsToUpdate = [];\n  this._cloudsToUpdateIndex = 0;\n  this._cloudsRemoved = false;\n\n  this._createVertexArray = true;\n};\n\nfunction removeClouds(cloudCollection) {\n  if (cloudCollection._cloudsRemoved) {\n    cloudCollection._cloudsRemoved = false;\n\n    const newClouds = [];\n    const clouds = cloudCollection._clouds;\n    const length = clouds.length;\n    for (let i = 0, j = 0; i < length; ++i) {\n      const cloud = clouds[i];\n      if (defined(cloud)) {\n        clouds._index = j++;\n        newClouds.push(cloud);\n      }\n    }\n\n    cloudCollection._clouds = newClouds;\n  }\n}\n\nCloudCollection.prototype._updateCloud = function (cloud, propertyChanged) {\n  if (!cloud._dirty) {\n    this._cloudsToUpdate[this._cloudsToUpdateIndex++] = cloud;\n  }\n\n  ++this._propertiesChanged[propertyChanged];\n};\n\n/**\n * Check whether this collection contains a given cloud.\n *\n * @param {CumulusCloud} [cloud] The cloud to check for.\n * @returns {Boolean} true if this collection contains the cloud, false otherwise.\n *\n * @see CloudCollection#get\n */\nCloudCollection.prototype.contains = function (cloud) {\n  return defined(cloud) && cloud._cloudCollection === this;\n};\n\n/**\n * Returns the cloud in the collection at the specified index. Indices are zero-based\n * and increase as clouds are added. Removing a cloud shifts all clouds after\n * it to the left, changing their indices. This function is commonly used with\n * {@link CloudCollection#length} to iterate over all the clouds in the collection.\n *\n * @param {Number} index The zero-based index of the cloud.\n * @returns {CumulusCloud} The cloud at the specified index.\n *\n * @performance Expected constant time. If clouds were removed from the collection and\n * {@link CloudCollection#update} was not called, an implicit <code>O(n)</code>\n * operation is performed.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * // Toggle the show property of every cloud in the collection\n * const len = clouds.length;\n * for (let i = 0; i < len; ++i) {\n *   const c = clouds.get(i);\n *   c.show = !c.show;\n * }\n *\n * @see CloudCollection#length\n */\nCloudCollection.prototype.get = function (index) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.number(\"index\", index);\n  //>>includeEnd('debug');\n\n  removeClouds(this);\n  return this._clouds[index];\n};\n\nconst texturePositions = new Float32Array([\n  -1.0,\n  -1.0,\n  1.0,\n  -1.0,\n  1.0,\n  1.0,\n  -1.0,\n  1.0,\n]);\n\nconst textureIndices = new Uint16Array([0, 1, 2, 0, 2, 3]);\n\nfunction createTextureVA(context) {\n  const positionBuffer = Buffer.createVertexBuffer({\n    context: context,\n    typedArray: texturePositions,\n    usage: BufferUsage.STATIC_DRAW,\n  });\n  const indexBuffer = Buffer.createIndexBuffer({\n    context: context,\n    typedArray: textureIndices,\n    usage: BufferUsage.STATIC_DRAW,\n    indexDatatype: IndexDatatype.UNSIGNED_SHORT,\n  });\n\n  const attributes = [\n    {\n      index: 0,\n      vertexBuffer: positionBuffer,\n      componentsPerAttribute: 2,\n      componentDatatype: ComponentDatatype.FLOAT,\n    },\n  ];\n\n  return new VertexArray({\n    context: context,\n    attributes: attributes,\n    indexBuffer: indexBuffer,\n  });\n}\n\nlet getIndexBuffer;\n\nfunction getIndexBufferBatched(context) {\n  const sixteenK = 16 * 1024;\n\n  let indexBuffer = context.cache.cloudCollection_indexBufferBatched;\n  if (defined(indexBuffer)) {\n    return indexBuffer;\n  }\n\n  // Subtract 6 because the last index is reserved for primitive restart.\n  // https://www.khronos.org/registry/webgl/specs/latest/2.0/#5.18\n  const length = sixteenK * 6 - 6;\n  const indices = new Uint16Array(length);\n  for (let i = 0, j = 0; i < length; i += 6, j += 4) {\n    indices[i] = j;\n    indices[i + 1] = j + 1;\n    indices[i + 2] = j + 2;\n\n    indices[i + 3] = j;\n    indices[i + 4] = j + 2;\n    indices[i + 5] = j + 3;\n  }\n\n  indexBuffer = Buffer.createIndexBuffer({\n    context: context,\n    typedArray: indices,\n    usage: BufferUsage.STATIC_DRAW,\n    indexDatatype: IndexDatatype.UNSIGNED_SHORT,\n  });\n  indexBuffer.vertexArrayDestroyable = false;\n  context.cache.cloudCollection_indexBufferBatched = indexBuffer;\n  return indexBuffer;\n}\n\nfunction getIndexBufferInstanced(context) {\n  let indexBuffer = context.cache.cloudCollection_indexBufferInstanced;\n  if (defined(indexBuffer)) {\n    return indexBuffer;\n  }\n\n  indexBuffer = Buffer.createIndexBuffer({\n    context: context,\n    typedArray: new Uint16Array([0, 1, 2, 0, 2, 3]),\n    usage: BufferUsage.STATIC_DRAW,\n    indexDatatype: IndexDatatype.UNSIGNED_SHORT,\n  });\n\n  indexBuffer.vertexArrayDestroyable = false;\n  context.cache.cloudCollection_indexBufferInstanced = indexBuffer;\n  return indexBuffer;\n}\n\nfunction getVertexBufferInstanced(context) {\n  let vertexBuffer = context.cache.cloudCollection_vertexBufferInstanced;\n  if (defined(vertexBuffer)) {\n    return vertexBuffer;\n  }\n\n  vertexBuffer = Buffer.createVertexBuffer({\n    context: context,\n    typedArray: new Float32Array([0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0]),\n    usage: BufferUsage.STATIC_DRAW,\n  });\n\n  vertexBuffer.vertexArrayDestroyable = false;\n  context.cache.cloudCollection_vertexBufferInstanced = vertexBuffer;\n  return vertexBuffer;\n}\n\nfunction createVAF(context, numberOfClouds, instanced) {\n  const attributes = [\n    {\n      index: attributeLocations.positionHighAndScaleX,\n      componentsPerAttribute: 4,\n      componentDatatype: ComponentDatatype.FLOAT,\n      usage: BufferUsage.STATIC_DRAW,\n    },\n    {\n      index: attributeLocations.positionLowAndScaleY,\n      componentsPerAttribute: 4,\n      componentDatatype: ComponentDatatype.FLOAT,\n      usage: BufferUsage.STATIC_DRAW,\n    },\n    {\n      index: attributeLocations.packedAttribute0,\n      componentsPerAttribute: 4,\n      componentDatatype: ComponentDatatype.FLOAT,\n      usage: BufferUsage.STATIC_DRAW,\n    },\n    {\n      index: attributeLocations.packedAttribute1,\n      componentsPerAttribute: 4,\n      componentDatatype: ComponentDatatype.FLOAT,\n      usage: BufferUsage.STATIC_DRAW,\n    },\n    {\n      index: attributeLocations.color,\n      componentsPerAttribute: 4,\n      componentDatatype: ComponentDatatype.UNSIGNED_BYTE,\n      normalize: true,\n      usage: BufferUsage.STATIC_DRAW,\n    },\n  ];\n\n  if (instanced) {\n    attributes.push({\n      index: attributeLocations.direction,\n      componentsPerAttribute: 2,\n      componentDatatype: ComponentDatatype.FLOAT,\n      vertexBuffer: getVertexBufferInstanced(context),\n    });\n  }\n\n  const sizeInVertices = instanced ? numberOfClouds : 4 * numberOfClouds;\n  return new VertexArrayFacade(context, attributes, sizeInVertices, instanced);\n}\n\nconst writePositionScratch = new EncodedCartesian3();\n\nfunction writePositionAndScale(cloudCollection, frameState, vafWriters, cloud) {\n  let i;\n  const positionHighWriter =\n    vafWriters[attributeLocations.positionHighAndScaleX];\n  const positionLowWriter = vafWriters[attributeLocations.positionLowAndScaleY];\n  const position = cloud.position;\n\n  EncodedCartesian3.fromCartesian(position, writePositionScratch);\n  const scale = cloud.scale;\n\n  const high = writePositionScratch.high;\n  const low = writePositionScratch.low;\n\n  if (cloudCollection._instanced) {\n    i = cloud._index;\n    positionHighWriter(i, high.x, high.y, high.z, scale.x);\n    positionLowWriter(i, low.x, low.y, low.z, scale.y);\n  } else {\n    i = cloud._index * 4;\n    positionHighWriter(i + 0, high.x, high.y, high.z, scale.x);\n    positionHighWriter(i + 1, high.x, high.y, high.z, scale.x);\n    positionHighWriter(i + 2, high.x, high.y, high.z, scale.x);\n    positionHighWriter(i + 3, high.x, high.y, high.z, scale.x);\n\n    positionLowWriter(i + 0, low.x, low.y, low.z, scale.y);\n    positionLowWriter(i + 1, low.x, low.y, low.z, scale.y);\n    positionLowWriter(i + 2, low.x, low.y, low.z, scale.y);\n    positionLowWriter(i + 3, low.x, low.y, low.z, scale.y);\n  }\n}\n\nfunction writePackedAttribute0(cloudCollection, frameState, vafWriters, cloud) {\n  let i;\n  const writer = vafWriters[attributeLocations.packedAttribute0];\n  const show = cloud.show;\n  const brightness = cloud.brightness;\n\n  if (cloudCollection._instanced) {\n    i = cloud._index;\n    writer(i, show, brightness, 0.0, 0.0);\n  } else {\n    i = cloud._index * 4;\n    writer(i + 0, show, brightness, 0.0, 0.0);\n    writer(i + 1, show, brightness, 1.0, 0.0);\n    writer(i + 2, show, brightness, 1.0, 1.0);\n    writer(i + 3, show, brightness, 0.0, 1.0);\n  }\n}\n\nfunction writePackedAttribute1(cloudCollection, frameState, vafWriters, cloud) {\n  let i;\n  const writer = vafWriters[attributeLocations.packedAttribute1];\n  const maximumSize = cloud.maximumSize;\n  const slice = cloud.slice;\n\n  if (cloudCollection._instanced) {\n    i = cloud._index;\n    writer(i, maximumSize.x, maximumSize.y, maximumSize.z, slice);\n  } else {\n    i = cloud._index * 4;\n    writer(i + 0, maximumSize.x, maximumSize.y, maximumSize.z, slice);\n    writer(i + 1, maximumSize.x, maximumSize.y, maximumSize.z, slice);\n    writer(i + 2, maximumSize.x, maximumSize.y, maximumSize.z, slice);\n    writer(i + 3, maximumSize.x, maximumSize.y, maximumSize.z, slice);\n  }\n}\n\nfunction writeColor(cloudCollection, frameState, vafWriters, cloud) {\n  let i;\n  const writer = vafWriters[attributeLocations.color];\n  const color = cloud.color;\n  const red = Color.floatToByte(color.red);\n  const green = Color.floatToByte(color.green);\n  const blue = Color.floatToByte(color.blue);\n  const alpha = Color.floatToByte(color.alpha);\n\n  if (cloudCollection._instanced) {\n    i = cloud._index;\n    writer(i, red, green, blue, alpha);\n  } else {\n    i = cloud._index * 4;\n    writer(i + 0, red, green, blue, alpha);\n    writer(i + 1, red, green, blue, alpha);\n    writer(i + 2, red, green, blue, alpha);\n    writer(i + 3, red, green, blue, alpha);\n  }\n}\nfunction writeCloud(cloudCollection, frameState, vafWriters, cloud) {\n  writePositionAndScale(cloudCollection, frameState, vafWriters, cloud);\n  writePackedAttribute0(cloudCollection, frameState, vafWriters, cloud);\n  writePackedAttribute1(cloudCollection, frameState, vafWriters, cloud);\n  writeColor(cloudCollection, frameState, vafWriters, cloud);\n}\n\nfunction createNoiseTexture(cloudCollection, frameState, vsSource, fsSource) {\n  const that = cloudCollection;\n\n  const textureSliceWidth = that._textureSliceWidth;\n  const noiseTextureRows = that._noiseTextureRows;\n  //>>includeStart('debug', pragmas.debug);\n  if (\n    textureSliceWidth / noiseTextureRows < 1 ||\n    textureSliceWidth % noiseTextureRows !== 0\n  ) {\n    throw new DeveloperError(\n      \"noiseTextureRows must evenly divide textureSliceWidth\"\n    );\n  }\n  //>>includeEnd('debug');\n\n  const context = frameState.context;\n  that._vaNoise = createTextureVA(context);\n  that._spNoise = ShaderProgram.fromCache({\n    context: context,\n    vertexShaderSource: vsSource,\n    fragmentShaderSource: fsSource,\n    attributeLocations: {\n      position: 0,\n    },\n  });\n\n  const noiseDetail = that.noiseDetail;\n  const noiseOffset = that.noiseOffset;\n\n  that._noiseTexture = new Texture({\n    context: context,\n    width: (textureSliceWidth * textureSliceWidth) / noiseTextureRows,\n    height: textureSliceWidth * noiseTextureRows,\n    pixelDatatype: PixelDatatype.UNSIGNED_BYTE,\n    pixelFormat: PixelFormat.RGBA,\n    sampler: new Sampler({\n      wrapS: TextureWrap.REPEAT,\n      wrapT: TextureWrap.REPEAT,\n      minificationFilter: TextureMinificationFilter.NEAREST,\n      magnificationFilter: TextureMagnificationFilter.NEAREST,\n    }),\n  });\n\n  const textureCommand = new ComputeCommand({\n    vertexArray: that._vaNoise,\n    shaderProgram: that._spNoise,\n    outputTexture: that._noiseTexture,\n    uniformMap: {\n      u_noiseTextureDimensions: getNoiseTextureDimensions(that),\n      u_noiseDetail: function () {\n        return noiseDetail;\n      },\n      u_noiseOffset: function () {\n        return noiseOffset;\n      },\n    },\n    persists: false,\n    owner: cloudCollection,\n    postExecute: function (texture) {\n      that._ready = true;\n      that._loading = false;\n    },\n  });\n\n  frameState.commandList.push(textureCommand);\n  that._loading = true;\n}\n\nfunction createVertexArray(cloudCollection, frameState) {\n  const that = cloudCollection;\n  const context = frameState.context;\n  that._createVertexArray = false;\n  that._vaf = that._vaf && that._vaf.destroy();\n\n  const clouds = cloudCollection._clouds;\n  const cloudsLength = clouds.length;\n  if (cloudsLength > 0) {\n    that._vaf = createVAF(context, cloudsLength, that._instanced);\n    const vafWriters = that._vaf.writers;\n\n    let i;\n    // Rewrite entire buffer if clouds were added or removed.\n    for (i = 0; i < cloudsLength; ++i) {\n      const cloud = clouds[i];\n      writeCloud(cloudCollection, frameState, vafWriters, cloud);\n    }\n\n    // Different cloud collections share the same index buffer.\n    that._vaf.commit(getIndexBuffer(context));\n  }\n}\n\nconst scratchWriterArray = [];\n\nfunction updateClouds(cloudCollection, frameState) {\n  const context = frameState.context;\n  const that = cloudCollection;\n  const clouds = that._clouds;\n  const cloudsLength = clouds.length;\n  const cloudsToUpdate = that._cloudsToUpdate;\n  const cloudsToUpdateLength = that._cloudsToUpdateIndex;\n\n  const properties = that._propertiesChanged;\n\n  const writers = scratchWriterArray;\n  writers.length = 0;\n\n  if (properties[POSITION_INDEX] || properties[SCALE_INDEX]) {\n    writers.push(writePositionAndScale);\n  }\n\n  if (properties[SHOW_INDEX] || properties[BRIGHTNESS_INDEX]) {\n    writers.push(writePackedAttribute0);\n  }\n\n  if (properties[MAXIMUM_SIZE_INDEX] || properties[SLICE_INDEX]) {\n    writers.push(writePackedAttribute1);\n  }\n\n  if (properties[COLOR_INDEX]) {\n    writers.push(writeColor);\n  }\n\n  const numWriters = writers.length;\n  const vafWriters = that._vaf.writers;\n\n  let i, c, w;\n  if (cloudsToUpdateLength / cloudsLength > 0.1) {\n    // Like BillboardCollection, if more than 10% of clouds change,\n    // rewrite the entire buffer.\n\n    for (i = 0; i < cloudsToUpdateLength; ++i) {\n      c = cloudsToUpdate[i];\n      c._dirty = false;\n\n      for (w = 0; w < numWriters; ++w) {\n        writers[w](cloudCollection, frameState, vafWriters, c);\n      }\n    }\n\n    that._vaf.commit(getIndexBuffer(context));\n  } else {\n    for (i = 0; i < cloudsToUpdateLength; ++i) {\n      c = cloudsToUpdate[i];\n      c._dirty = false;\n\n      for (w = 0; w < numWriters; ++w) {\n        writers[w](cloudCollection, frameState, vafWriters, c);\n      }\n\n      if (that._instanced) {\n        that._vaf.subCommit(c._index, 1);\n      } else {\n        that._vaf.subCommit(c._index * 4, 4);\n      }\n    }\n    that._vaf.endSubCommits();\n  }\n\n  that._cloudsToUpdateIndex = 0;\n}\n\nfunction createShaderProgram(cloudCollection, frameState, vsSource, fsSource) {\n  const context = frameState.context;\n  const that = cloudCollection;\n  const vs = new ShaderSource({\n    defines: [],\n    sources: [vsSource],\n  });\n\n  if (that._instanced) {\n    vs.defines.push(\"INSTANCED\");\n  }\n\n  const fs = new ShaderSource({\n    defines: [],\n    sources: [fsSource],\n  });\n\n  if (that.debugBillboards) {\n    fs.defines.push(\"DEBUG_BILLBOARDS\");\n  }\n\n  if (that.debugEllipsoids) {\n    fs.defines.push(\"DEBUG_ELLIPSOIDS\");\n  }\n\n  that._sp = ShaderProgram.replaceCache({\n    context: context,\n    shaderProgram: that._sp,\n    vertexShaderSource: vs,\n    fragmentShaderSource: fs,\n    attributeLocations: attributeLocations,\n  });\n\n  that._rs = RenderState.fromCache({\n    depthTest: {\n      enabled: true,\n      func: WebGLConstants.LESS,\n    },\n    depthMask: false,\n    blending: BlendingState.ALPHA_BLEND,\n  });\n\n  that._spCreated = true;\n  that._compiledDebugBillboards = that.debugBillboards;\n  that._compiledDebugEllipsoids = that.debugEllipsoids;\n}\n\nfunction createDrawCommands(cloudCollection, frameState) {\n  const that = cloudCollection;\n  const pass = frameState.passes;\n  const uniforms = that._uniforms;\n  const commandList = frameState.commandList;\n  if (pass.render) {\n    const colorList = that._colorCommands;\n\n    const va = that._vaf.va;\n    const vaLength = va.length;\n    colorList.length = vaLength;\n    for (let i = 0; i < vaLength; i++) {\n      let command = colorList[i];\n      if (!defined(command)) {\n        command = colorList[i] = new DrawCommand();\n      }\n      command.pass = Pass.TRANSLUCENT;\n      command.owner = cloudCollection;\n      command.uniformMap = uniforms;\n      command.count = va[i].indicesCount;\n      command.vertexArray = va[i].va;\n      command.shaderProgram = that._sp;\n      command.renderState = that._rs;\n      if (that._instanced) {\n        command.count = 6;\n        command.instanceCount = that._clouds.length;\n      }\n\n      commandList.push(command);\n    }\n  }\n}\n\n/**\n * @private\n */\nCloudCollection.prototype.update = function (frameState) {\n  removeClouds(this);\n  if (!this.show) {\n    return;\n  }\n\n  const debugging = this.debugBillboards || this.debugEllipsoids;\n  this._ready = debugging ? true : defined(this._noiseTexture);\n\n  if (!this._ready && !this._loading && !debugging) {\n    createNoiseTexture(this, frameState, CloudNoiseVS, CloudNoiseFS);\n  }\n\n  this._instanced = frameState.context.instancedArrays;\n  attributeLocations = this._instanced\n    ? attributeLocationsInstanced\n    : attributeLocationsBatched;\n  getIndexBuffer = this._instanced\n    ? getIndexBufferInstanced\n    : getIndexBufferBatched;\n\n  const clouds = this._clouds;\n  const cloudsLength = clouds.length;\n  const cloudsToUpdate = this._cloudsToUpdate;\n  const cloudsToUpdateLength = this._cloudsToUpdateIndex;\n\n  if (this._createVertexArray) {\n    createVertexArray(this, frameState);\n  } else if (cloudsToUpdateLength > 0) {\n    // Clouds were modified, but none were added or removed.\n    updateClouds(this, frameState);\n  }\n\n  // If the number of total clouds ever shrinks considerably,\n  // truncate cloudsToUpdate so that we free memory that\n  // we are no longer using.\n  if (cloudsToUpdateLength > cloudsLength * 1.5) {\n    cloudsToUpdate.length = cloudsLength;\n  }\n\n  if (\n    !defined(this._vaf) ||\n    !defined(this._vaf.va) ||\n    !this._ready & !debugging\n  ) {\n    return;\n  }\n\n  if (\n    !this._spCreated ||\n    this.debugBillboards !== this._compiledDebugBillboards ||\n    this.debugEllipsoids !== this._compiledDebugEllipsoids\n  ) {\n    createShaderProgram(this, frameState, CloudCollectionVS, CloudCollectionFS);\n  }\n\n  createDrawCommands(this, frameState);\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see CloudCollection#destroy\n */\nCloudCollection.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * clouds = clouds && clouds.destroy();\n *\n * @see CloudCollection#isDestroyed\n */\nCloudCollection.prototype.destroy = function () {\n  this._noiseTexture = this._noiseTexture && this._noiseTexture.destroy();\n  this._sp = this._sp && this._sp.destroy();\n  this._vaf = this._vaf && this._vaf.destroy();\n\n  destroyClouds(this._clouds);\n\n  return destroyObject(this);\n};\n\nexport default CloudCollection;\n","/**\n * Specifies the type of the cloud that is added to a {@link CloudCollection} in {@link CloudCollection#add}.\n *\n * @enum {Number}\n */\n\nconst CloudType = {\n  /**\n   * Cumulus cloud.\n   *\n   * @type {Number}\n   * @constant\n   */\n  CUMULUS: 0,\n};\n\n/**\n * Validates that the provided cloud type is a valid {@link CloudType}\n *\n * @param {CloudType} cloudType The cloud type to validate.\n * @returns {Boolean} <code>true</code> if the provided cloud type is a valid value; otherwise, <code>false</code>.\n *\n * @example\n * if (!Cesium.CloudType.validate(cloudType)) {\n *   throw new Cesium.DeveloperError('cloudType must be a valid value.');\n * }\n */\n\nCloudType.validate = function (cloudType) {\n  return cloudType === CloudType.CUMULUS;\n};\n\nexport default Object.freeze(CloudType);\n","import CesiumMath from \"../Core/Math.js\";\n\n/**\n * Defines different modes for blending between a target color and a primitive's source color.\n *\n * HIGHLIGHT multiplies the source color by the target color\n * REPLACE replaces the source color with the target color\n * MIX blends the source color and target color together\n *\n * @enum {Number}\n *\n * @see Model.colorBlendMode\n */\nconst ColorBlendMode = {\n  HIGHLIGHT: 0,\n  REPLACE: 1,\n  MIX: 2,\n};\n\n/**\n * @private\n */\nColorBlendMode.getColorBlend = function (colorBlendMode, colorBlendAmount) {\n  if (colorBlendMode === ColorBlendMode.HIGHLIGHT) {\n    return 0.0;\n  } else if (colorBlendMode === ColorBlendMode.REPLACE) {\n    return 1.0;\n  } else if (colorBlendMode === ColorBlendMode.MIX) {\n    // The value 0.0 is reserved for highlight, so clamp to just above 0.0.\n    return CesiumMath.clamp(colorBlendAmount, CesiumMath.EPSILON4, 1.0);\n  }\n};\nexport default Object.freeze(ColorBlendMode);\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport getMagic from \"../Core/getMagic.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\n\n/**\n * Represents the contents of a\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Composite|Composite}\n * tile in a {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification|3D Tiles} tileset.\n * <p>\n * Implements the {@link Cesium3DTileContent} interface.\n * </p>\n *\n * @alias Composite3DTileContent\n * @constructor\n *\n * @private\n */\nfunction Composite3DTileContent(\n  tileset,\n  tile,\n  resource,\n  arrayBuffer,\n  byteOffset,\n  factory\n) {\n  this._tileset = tileset;\n  this._tile = tile;\n  this._resource = resource;\n  this._contents = [];\n\n  this._metadata = undefined;\n  this._group = undefined;\n\n  this._readyPromise = initialize(this, arrayBuffer, byteOffset, factory);\n}\n\nObject.defineProperties(Composite3DTileContent.prototype, {\n  featurePropertiesDirty: {\n    get: function () {\n      const contents = this._contents;\n      const length = contents.length;\n      for (let i = 0; i < length; ++i) {\n        if (contents[i].featurePropertiesDirty) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n    set: function (value) {\n      const contents = this._contents;\n      const length = contents.length;\n      for (let i = 0; i < length; ++i) {\n        contents[i].featurePropertiesDirty = value;\n      }\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n   * always returns <code>0</code>.  Instead call <code>featuresLength</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  featuresLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n   * always returns <code>0</code>.  Instead call <code>pointsLength</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  pointsLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n   * always returns <code>0</code>.  Instead call <code>trianglesLength</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  trianglesLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n   * always returns <code>0</code>.  Instead call <code>geometryByteLength</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  geometryByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface.   <code>Composite3DTileContent</code>\n   * always returns <code>0</code>.  Instead call <code>texturesByteLength</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  texturesByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n   * always returns <code>0</code>.  Instead call <code>batchTableByteLength</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  batchTableByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  innerContents: {\n    get: function () {\n      return this._contents;\n    },\n  },\n\n  readyPromise: {\n    get: function () {\n      return this._readyPromise;\n    },\n  },\n\n  tileset: {\n    get: function () {\n      return this._tileset;\n    },\n  },\n\n  tile: {\n    get: function () {\n      return this._tile;\n    },\n  },\n\n  url: {\n    get: function () {\n      return this._resource.getUrlComponent(true);\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface. <code>Composite3DTileContent</code>\n   * both stores the content metadata and propagates the content metadata to all of its children.\n   * @memberof Composite3DTileContent.prototype\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  metadata: {\n    get: function () {\n      return this._metadata;\n    },\n    set: function (value) {\n      this._metadata = value;\n      const contents = this._contents;\n      const length = contents.length;\n      for (let i = 0; i < length; ++i) {\n        contents[i].metadata = value;\n      }\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface. <code>Composite3DTileContent</code>\n   * always returns <code>undefined</code>.  Instead call <code>batchTable</code> for a tile in the composite.\n   * @memberof Composite3DTileContent.prototype\n   */\n  batchTable: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  /**\n   * Part of the {@link Cesium3DTileContent} interface. <code>Composite3DTileContent</code>\n   * both stores the group metadata and propagates the group metadata to all of its children.\n   * @memberof Composite3DTileContent.prototype\n   * @private\n   * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n   */\n  group: {\n    get: function () {\n      return this._group;\n    },\n    set: function (value) {\n      this._group = value;\n      const contents = this._contents;\n      const length = contents.length;\n      for (let i = 0; i < length; ++i) {\n        contents[i].group = value;\n      }\n    },\n  },\n});\n\nconst sizeOfUint32 = Uint32Array.BYTES_PER_ELEMENT;\n\nfunction initialize(content, arrayBuffer, byteOffset, factory) {\n  byteOffset = defaultValue(byteOffset, 0);\n\n  const uint8Array = new Uint8Array(arrayBuffer);\n  const view = new DataView(arrayBuffer);\n  byteOffset += sizeOfUint32; // Skip magic\n\n  const version = view.getUint32(byteOffset, true);\n  if (version !== 1) {\n    throw new RuntimeError(\n      `Only Composite Tile version 1 is supported. Version ${version} is not.`\n    );\n  }\n  byteOffset += sizeOfUint32;\n\n  // Skip byteLength\n  byteOffset += sizeOfUint32;\n\n  const tilesLength = view.getUint32(byteOffset, true);\n  byteOffset += sizeOfUint32;\n\n  const contentPromises = [];\n\n  for (let i = 0; i < tilesLength; ++i) {\n    const tileType = getMagic(uint8Array, byteOffset);\n\n    // Tile byte length is stored after magic and version\n    const tileByteLength = view.getUint32(byteOffset + sizeOfUint32 * 2, true);\n\n    const contentFactory = factory[tileType];\n\n    if (defined(contentFactory)) {\n      const innerContent = contentFactory(\n        content._tileset,\n        content._tile,\n        content._resource,\n        arrayBuffer,\n        byteOffset\n      );\n      content._contents.push(innerContent);\n      contentPromises.push(innerContent.readyPromise);\n    } else {\n      throw new RuntimeError(\n        `Unknown tile content type, ${tileType}, inside Composite tile`\n      );\n    }\n\n    byteOffset += tileByteLength;\n  }\n\n  return Promise.all(contentPromises).then(function () {\n    return content;\n  });\n}\n\n/**\n * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n * always returns <code>false</code>.  Instead call <code>hasProperty</code> for a tile in the composite.\n */\nComposite3DTileContent.prototype.hasProperty = function (batchId, name) {\n  return false;\n};\n\n/**\n * Part of the {@link Cesium3DTileContent} interface.  <code>Composite3DTileContent</code>\n * always returns <code>undefined</code>.  Instead call <code>getFeature</code> for a tile in the composite.\n */\nComposite3DTileContent.prototype.getFeature = function (batchId) {\n  return undefined;\n};\n\nComposite3DTileContent.prototype.applyDebugSettings = function (\n  enabled,\n  color\n) {\n  const contents = this._contents;\n  const length = contents.length;\n  for (let i = 0; i < length; ++i) {\n    contents[i].applyDebugSettings(enabled, color);\n  }\n};\n\nComposite3DTileContent.prototype.applyStyle = function (style) {\n  const contents = this._contents;\n  const length = contents.length;\n  for (let i = 0; i < length; ++i) {\n    contents[i].applyStyle(style);\n  }\n};\n\nComposite3DTileContent.prototype.update = function (tileset, frameState) {\n  const contents = this._contents;\n  const length = contents.length;\n  for (let i = 0; i < length; ++i) {\n    contents[i].update(tileset, frameState);\n  }\n};\n\nComposite3DTileContent.prototype.isDestroyed = function () {\n  return false;\n};\n\nComposite3DTileContent.prototype.destroy = function () {\n  const contents = this._contents;\n  const length = contents.length;\n  for (let i = 0; i < length; ++i) {\n    contents[i].destroy();\n  }\n  return destroyObject(this);\n};\nexport default Composite3DTileContent;\n","import clone from \"../Core/clone.js\";\nimport defined from \"../Core/defined.js\";\nimport Expression from \"./Expression.js\";\n\n/**\n * An expression for a style applied to a {@link Cesium3DTileset}.\n * <p>\n * Evaluates a conditions expression defined using the\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}.\n * </p>\n * <p>\n * Implements the {@link StyleExpression} interface.\n * </p>\n *\n * @alias ConditionsExpression\n * @constructor\n *\n * @param {Object} [conditionsExpression] The conditions expression defined using the 3D Tiles Styling language.\n * @param {Object} [defines] Defines in the style.\n *\n * @example\n * const expression = new Cesium.ConditionsExpression({\n *     conditions : [\n *         ['${Area} > 10, 'color(\"#FF0000\")'],\n *         ['${id} !== \"1\"', 'color(\"#00FF00\")'],\n *         ['true', 'color(\"#FFFFFF\")']\n *     ]\n * });\n * expression.evaluateColor(feature, result); // returns a Cesium.Color object\n */\nfunction ConditionsExpression(conditionsExpression, defines) {\n  this._conditionsExpression = clone(conditionsExpression, true);\n  this._conditions = conditionsExpression.conditions;\n  this._runtimeConditions = undefined;\n\n  setRuntime(this, defines);\n}\n\nObject.defineProperties(ConditionsExpression.prototype, {\n  /**\n   * Gets the conditions expression defined in the 3D Tiles Styling language.\n   *\n   * @memberof ConditionsExpression.prototype\n   *\n   * @type {Object}\n   * @readonly\n   *\n   * @default undefined\n   */\n  conditionsExpression: {\n    get: function () {\n      return this._conditionsExpression;\n    },\n  },\n});\n\nfunction Statement(condition, expression) {\n  this.condition = condition;\n  this.expression = expression;\n}\n\nfunction setRuntime(expression, defines) {\n  const runtimeConditions = [];\n  const conditions = expression._conditions;\n  if (!defined(conditions)) {\n    return;\n  }\n  const length = conditions.length;\n  for (let i = 0; i < length; ++i) {\n    const statement = conditions[i];\n    const cond = String(statement[0]);\n    const condExpression = String(statement[1]);\n    runtimeConditions.push(\n      new Statement(\n        new Expression(cond, defines),\n        new Expression(condExpression, defines)\n      )\n    );\n  }\n  expression._runtimeConditions = runtimeConditions;\n}\n\n/**\n * Evaluates the result of an expression, optionally using the provided feature's properties. If the result of\n * the expression in the\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}\n * is of type <code>Boolean</code>, <code>Number</code>, or <code>String</code>, the corresponding JavaScript\n * primitive type will be returned. If the result is a <code>RegExp</code>, a Javascript <code>RegExp</code>\n * object will be returned. If the result is a <code>Cartesian2</code>, <code>Cartesian3</code>, or <code>Cartesian4</code>,\n * a {@link Cartesian2}, {@link Cartesian3}, or {@link Cartesian4} object will be returned. If the <code>result</code> argument is\n * a {@link Color}, the {@link Cartesian4} value is converted to a {@link Color} and then returned.\n *\n * @param {Cesium3DTileFeature} feature The feature whose properties may be used as variables in the expression.\n * @param {Object} [result] The object onto which to store the result.\n * @returns {Boolean|Number|String|RegExp|Cartesian2|Cartesian3|Cartesian4|Color} The result of evaluating the expression.\n */\nConditionsExpression.prototype.evaluate = function (feature, result) {\n  const conditions = this._runtimeConditions;\n  if (!defined(conditions)) {\n    return undefined;\n  }\n  const length = conditions.length;\n  for (let i = 0; i < length; ++i) {\n    const statement = conditions[i];\n    if (statement.condition.evaluate(feature)) {\n      return statement.expression.evaluate(feature, result);\n    }\n  }\n};\n\n/**\n * Evaluates the result of a Color expression, using the values defined by a feature.\n * <p>\n * This is equivalent to {@link ConditionsExpression#evaluate} but always returns a {@link Color} object.\n * </p>\n * @param {Cesium3DTileFeature} feature The feature whose properties may be used as variables in the expression.\n * @param {Color} [result] The object in which to store the result\n * @returns {Color} The modified result parameter or a new Color instance if one was not provided.\n */\nConditionsExpression.prototype.evaluateColor = function (feature, result) {\n  const conditions = this._runtimeConditions;\n  if (!defined(conditions)) {\n    return undefined;\n  }\n  const length = conditions.length;\n  for (let i = 0; i < length; ++i) {\n    const statement = conditions[i];\n    if (statement.condition.evaluate(feature)) {\n      return statement.expression.evaluateColor(feature, result);\n    }\n  }\n};\n\n/**\n * Gets the shader function for this expression.\n * Returns undefined if the shader function can't be generated from this expression.\n *\n * @param {String} functionSignature Signature of the generated function.\n * @param {Object} variableSubstitutionMap Maps variable names to shader variable names.\n * @param {Object} shaderState Stores information about the generated shader function, including whether it is translucent.\n * @param {String} returnType The return type of the generated function.\n *\n * @returns {String} The shader function.\n *\n * @private\n */\nConditionsExpression.prototype.getShaderFunction = function (\n  functionSignature,\n  variableSubstitutionMap,\n  shaderState,\n  returnType\n) {\n  const conditions = this._runtimeConditions;\n  if (!defined(conditions) || conditions.length === 0) {\n    return undefined;\n  }\n\n  let shaderFunction = \"\";\n  const length = conditions.length;\n  for (let i = 0; i < length; ++i) {\n    const statement = conditions[i];\n\n    const condition = statement.condition.getShaderExpression(\n      variableSubstitutionMap,\n      shaderState\n    );\n    const expression = statement.expression.getShaderExpression(\n      variableSubstitutionMap,\n      shaderState\n    );\n\n    // Build the if/else chain from the list of conditions\n    shaderFunction +=\n      `    ${i === 0 ? \"if\" : \"else if\"} (${condition})\\n` +\n      `    {\\n` +\n      `        return ${expression};\\n` +\n      `    }\\n`;\n  }\n\n  shaderFunction =\n    `${returnType} ${functionSignature}\\n` +\n    `{\\n${shaderFunction}    return ${returnType}(1.0);\\n` + // Return a default value if no conditions are met\n    `}\\n`;\n\n  return shaderFunction;\n};\n\n/**\n * Gets the variables used by the expression.\n *\n * @returns {String[]} The variables used by the expression.\n *\n * @private\n */\nConditionsExpression.prototype.getVariables = function () {\n  let variables = [];\n\n  const conditions = this._runtimeConditions;\n  if (!defined(conditions) || conditions.length === 0) {\n    return variables;\n  }\n\n  const length = conditions.length;\n  for (let i = 0; i < length; ++i) {\n    const statement = conditions[i];\n    variables.push.apply(variables, statement.condition.getVariables());\n    variables.push.apply(variables, statement.expression.getVariables());\n  }\n\n  // Remove duplicates\n  variables = variables.filter(function (variable, index, variables) {\n    return variables.indexOf(variable) === index;\n  });\n\n  return variables;\n};\n\nexport default ConditionsExpression;\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport CesiumMath from \"../Core/Math.js\";\n\nconst defaultAngle = CesiumMath.toRadians(30.0);\n\n/**\n * A ParticleEmitter that emits particles within a cone.\n * Particles will be positioned at the tip of the cone and have initial velocities going towards the base.\n *\n * @alias ConeEmitter\n * @constructor\n *\n * @param {Number} [angle=Cesium.Math.toRadians(30.0)] The angle of the cone in radians.\n */\nfunction ConeEmitter(angle) {\n  this._angle = defaultValue(angle, defaultAngle);\n}\n\nObject.defineProperties(ConeEmitter.prototype, {\n  /**\n   * The angle of the cone in radians.\n   * @memberof CircleEmitter.prototype\n   * @type {Number}\n   * @default Cesium.Math.toRadians(30.0)\n   */\n  angle: {\n    get: function () {\n      return this._angle;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n      this._angle = value;\n    },\n  },\n});\n\n/**\n * Initializes the given {Particle} by setting it's position and velocity.\n *\n * @private\n * @param {Particle} particle The particle to initialize\n */\nConeEmitter.prototype.emit = function (particle) {\n  const radius = Math.tan(this._angle);\n\n  // Compute a random point on the cone's base\n  const theta = CesiumMath.randomBetween(0.0, CesiumMath.TWO_PI);\n  const rad = CesiumMath.randomBetween(0.0, radius);\n\n  const x = rad * Math.cos(theta);\n  const y = rad * Math.sin(theta);\n  const z = 1.0;\n\n  particle.velocity = Cartesian3.fromElements(x, y, z, particle.velocity);\n  Cartesian3.normalize(particle.velocity, particle.velocity);\n  particle.position = Cartesian3.clone(Cartesian3.ZERO, particle.position);\n};\nexport default ConeEmitter;\n","import Check from \"../Core/Check.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport MetadataEntity from \"./MetadataEntity.js\";\n\n/**\n * Metadata about the content of a 3D Tile. This represents the content metadata JSON (3D Tiles 1.1)\n * or the <code>3DTILES_metadata</code> extension on a single {@link Cesium3DTileContent}\n * <p>\n * See the {@link https://github.com/CesiumGS/3d-tiles/tree/main/extensions/3DTILES_metadata|3DTILES_metadata Extension} for 3D Tiles\n * </p>\n *\n * @param {Object} options Object with the following properties:\n * @param {Object} options.content Either the content metadata JSON (3D Tiles 1.1) or the extension JSON attached to the content.\n * @param {MetadataClass} options.class The class that the content metadata conforms to.\n *\n * @alias ContentMetadata\n * @constructor\n * @private\n * @experimental This feature is using part of the 3D Tiles spec that is not final and is subject to change without Cesium's standard deprecation policy.\n */\nexport default function ContentMetadata(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  const content = options.content;\n  const metadataClass = options.class;\n\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"options.content\", content);\n  Check.typeOf.object(\"options.class\", metadataClass);\n  //>>includeEnd('debug');\n\n  this._class = metadataClass;\n  this._properties = content.properties;\n  this._extensions = content.extensions;\n  this._extras = content.extras;\n}\n\nObject.defineProperties(ContentMetadata.prototype, {\n  /**\n   * The class that properties conform to.\n   *\n   * @memberof ContentMetadata.prototype\n   * @type {MetadataClass}\n   * @readonly\n   * @private\n   */\n  class: {\n    get: function () {\n      return this._class;\n    },\n  },\n\n  /**\n   * Extras in the JSON object.\n   *\n   * @memberof ContentMetadata.prototype\n   * @type {Object}\n   * @readonly\n   * @private\n   */\n  extras: {\n    get: function () {\n      return this._extras;\n    },\n  },\n\n  /**\n   * Extensions in the JSON object.\n   *\n   * @memberof ContentMetadata.prototype\n   * @type {Object}\n   * @readonly\n   * @private\n   */\n  extensions: {\n    get: function () {\n      return this._extensions;\n    },\n  },\n});\n\n/**\n * Returns whether the content has this property.\n *\n * @param {String} propertyId The case-sensitive ID of the property.\n * @returns {Boolean} Whether the content has this property.\n * @private\n */\nContentMetadata.prototype.hasProperty = function (propertyId) {\n  return MetadataEntity.hasProperty(propertyId, this._properties, this._class);\n};\n\n/**\n * Returns whether the content has a property with the given semantic.\n *\n * @param {String} semantic The case-sensitive semantic of the property.\n * @returns {Boolean} Whether the content has a property with the given semantic.\n * @private\n */\nContentMetadata.prototype.hasPropertyBySemantic = function (semantic) {\n  return MetadataEntity.hasPropertyBySemantic(\n    semantic,\n    this._properties,\n    this._class\n  );\n};\n\n/**\n * Returns an array of property IDs.\n *\n * @param {String[]} [results] An array into which to store the results.\n * @returns {String[]} The property IDs.\n * @private\n */\nContentMetadata.prototype.getPropertyIds = function (results) {\n  return MetadataEntity.getPropertyIds(this._properties, this._class, results);\n};\n\n/**\n * Returns a copy of the value of the property with the given ID.\n * <p>\n * If the property is normalized the normalized value is returned.\n * </p>\n *\n * @param {String} propertyId The case-sensitive ID of the property.\n * @returns {*} The value of the property or <code>undefined</code> if the content does not have this property.\n * @private\n */\nContentMetadata.prototype.getProperty = function (propertyId) {\n  return MetadataEntity.getProperty(propertyId, this._properties, this._class);\n};\n\n/**\n * Sets the value of the property with the given ID.\n * <p>\n * If the property is normalized a normalized value must be provided to this function.\n * </p>\n *\n * @param {String} propertyId The case-sensitive ID of the property.\n * @param {*} value The value of the property that will be copied.\n * @returns {Boolean} <code>true</code> if the property was set, <code>false</code> otherwise.\n * @private\n */\nContentMetadata.prototype.setProperty = function (propertyId, value) {\n  return MetadataEntity.setProperty(\n    propertyId,\n    value,\n    this._properties,\n    this._class\n  );\n};\n\n/**\n * Returns a copy of the value of the property with the given semantic.\n *\n * @param {String} semantic The case-sensitive semantic of the property.\n * @returns {*} The value of the property or <code>undefined</code> if the content does not have this semantic.\n * @private\n */\nContentMetadata.prototype.getPropertyBySemantic = function (semantic) {\n  return MetadataEntity.getPropertyBySemantic(\n    semantic,\n    this._properties,\n    this._class\n  );\n};\n\n/**\n * Sets the value of the property with the given semantic.\n *\n * @param {String} semantic The case-sensitive semantic of the property.\n * @param {*} value The value of the property that will be copied.\n * @returns {Boolean} <code>true</code> if the property was set, <code>false</code> otherwise.\n * @private\n */\nContentMetadata.prototype.setPropertyBySemantic = function (semantic, value) {\n  return MetadataEntity.setPropertyBySemantic(\n    semantic,\n    value,\n    this._properties,\n    this._class\n  );\n};\n","import AssociativeArray from \"../Core/AssociativeArray.js\";\nimport buildModuleUrl from \"../Core/buildModuleUrl.js\";\nimport Check from \"../Core/Check.js\";\nimport Credit from \"../Core/Credit.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport Uri from \"../ThirdParty/Uri.js\";\n\nconst mobileWidth = 576;\nconst lightboxHeight = 100;\nconst textColor = \"#ffffff\";\nconst highlightColor = \"#48b\";\n\n/**\n * Used to sort the credits by frequency of appearance\n * when they are later displayed.\n *\n * @alias CreditDisplay.CreditDisplayElement\n * @constructor\n *\n * @private\n */\nfunction CreditDisplayElement(credit, count) {\n  this.credit = credit;\n  this.count = defaultValue(count, 1);\n}\n\nfunction contains(credits, credit) {\n  const len = credits.length;\n  for (let i = 0; i < len; i++) {\n    const existingCredit = credits[i];\n    if (Credit.equals(existingCredit, credit)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction swapCesiumCredit(creditDisplay) {\n  // We don't want to clutter the screen with the Cesium logo and the Cesium ion\n  // logo at the same time. Since the ion logo is required, we just replace the\n  // Cesium logo or add the logo if the Cesium one was removed.\n  const previousCredit = creditDisplay._previousCesiumCredit;\n  const currentCredit = creditDisplay._currentCesiumCredit;\n  if (Credit.equals(currentCredit, previousCredit)) {\n    return;\n  }\n\n  if (defined(previousCredit)) {\n    creditDisplay._cesiumCreditContainer.removeChild(previousCredit.element);\n  }\n  if (defined(currentCredit)) {\n    creditDisplay._cesiumCreditContainer.appendChild(currentCredit.element);\n  }\n\n  creditDisplay._previousCesiumCredit = currentCredit;\n}\n\nconst delimiterClassName = \"cesium-credit-delimiter\";\n\nfunction createDelimiterElement(delimiter) {\n  const delimiterElement = document.createElement(\"span\");\n  delimiterElement.textContent = delimiter;\n  delimiterElement.className = delimiterClassName;\n  return delimiterElement;\n}\n\nfunction createCreditElement(element, elementWrapperTagName) {\n  // may need to wrap the credit in another element\n  if (defined(elementWrapperTagName)) {\n    const wrapper = document.createElement(elementWrapperTagName);\n    wrapper._creditId = element._creditId;\n    wrapper.appendChild(element);\n    element = wrapper;\n  }\n  return element;\n}\n\nfunction displayCredits(container, credits, delimiter, elementWrapperTagName) {\n  const childNodes = container.childNodes;\n  let domIndex = -1;\n\n  // Sort the credits such that more frequent credits appear first\n  credits.sort(function (credit1, credit2) {\n    return credit2.count - credit1.count;\n  });\n\n  for (let creditIndex = 0; creditIndex < credits.length; ++creditIndex) {\n    const credit = credits[creditIndex].credit;\n    if (defined(credit)) {\n      domIndex = creditIndex;\n      if (defined(delimiter)) {\n        // credits may be separated by delimiters\n        domIndex *= 2;\n        if (creditIndex > 0) {\n          const delimiterDomIndex = domIndex - 1;\n          if (childNodes.length <= delimiterDomIndex) {\n            container.appendChild(createDelimiterElement(delimiter));\n          } else {\n            const existingDelimiter = childNodes[delimiterDomIndex];\n            if (existingDelimiter.className !== delimiterClassName) {\n              container.replaceChild(\n                createDelimiterElement(delimiter),\n                existingDelimiter\n              );\n            }\n          }\n        }\n      }\n\n      const element = credit.element;\n\n      // check to see if the correct credit is in the right place\n      if (childNodes.length <= domIndex) {\n        container.appendChild(\n          createCreditElement(element, elementWrapperTagName)\n        );\n      } else {\n        const existingElement = childNodes[domIndex];\n        if (existingElement._creditId !== credit._id) {\n          // not the right credit, swap it in\n          container.replaceChild(\n            createCreditElement(element, elementWrapperTagName),\n            existingElement\n          );\n        }\n      }\n    }\n  }\n\n  // any remaining nodes in the container are unnecessary\n  ++domIndex;\n  while (domIndex < childNodes.length) {\n    container.removeChild(childNodes[domIndex]);\n  }\n}\n\nfunction styleLightboxContainer(that) {\n  const lightboxCredits = that._lightboxCredits;\n  const width = that.viewport.clientWidth;\n  const height = that.viewport.clientHeight;\n  if (width !== that._lastViewportWidth) {\n    if (width < mobileWidth) {\n      lightboxCredits.className =\n        \"cesium-credit-lightbox cesium-credit-lightbox-mobile\";\n      lightboxCredits.style.marginTop = \"0\";\n    } else {\n      lightboxCredits.className =\n        \"cesium-credit-lightbox cesium-credit-lightbox-expanded\";\n      lightboxCredits.style.marginTop = `${Math.floor(\n        (height - lightboxCredits.clientHeight) * 0.5\n      )}px`;\n    }\n    that._lastViewportWidth = width;\n  }\n\n  if (width >= mobileWidth && height !== that._lastViewportHeight) {\n    lightboxCredits.style.marginTop = `${Math.floor(\n      (height - lightboxCredits.clientHeight) * 0.5\n    )}px`;\n    that._lastViewportHeight = height;\n  }\n}\n\nfunction addStyle(selector, styles) {\n  let style = `${selector} {`;\n  for (const attribute in styles) {\n    if (styles.hasOwnProperty(attribute)) {\n      style += `${attribute}: ${styles[attribute]}; `;\n    }\n  }\n  style += \" }\\n\";\n  return style;\n}\n\nfunction appendCss() {\n  let style = \"\";\n  style += addStyle(\".cesium-credit-lightbox-overlay\", {\n    display: \"none\",\n    \"z-index\": \"1\", //must be at least 1 to draw over top other Cesium widgets\n    position: \"absolute\",\n    top: \"0\",\n    left: \"0\",\n    width: \"100%\",\n    height: \"100%\",\n    \"background-color\": \"rgba(80, 80, 80, 0.8)\",\n  });\n\n  style += addStyle(\".cesium-credit-lightbox\", {\n    \"background-color\": \"#303336\",\n    color: textColor,\n    position: \"relative\",\n    \"min-height\": `${lightboxHeight}px`,\n    margin: \"auto\",\n  });\n\n  style += addStyle(\n    \".cesium-credit-lightbox > ul > li a, .cesium-credit-lightbox > ul > li a:visited\",\n    {\n      color: textColor,\n    }\n  );\n\n  style += addStyle(\".cesium-credit-lightbox > ul > li a:hover\", {\n    color: highlightColor,\n  });\n\n  style += addStyle(\".cesium-credit-lightbox.cesium-credit-lightbox-expanded\", {\n    border: \"1px solid #444\",\n    \"border-radius\": \"5px\",\n    \"max-width\": \"370px\",\n  });\n\n  style += addStyle(\".cesium-credit-lightbox.cesium-credit-lightbox-mobile\", {\n    height: \"100%\",\n    width: \"100%\",\n  });\n\n  style += addStyle(\".cesium-credit-lightbox-title\", {\n    padding: \"20px 20px 0 20px\",\n  });\n\n  style += addStyle(\".cesium-credit-lightbox-close\", {\n    \"font-size\": \"18pt\",\n    cursor: \"pointer\",\n    position: \"absolute\",\n    top: \"0\",\n    right: \"6px\",\n    color: textColor,\n  });\n\n  style += addStyle(\".cesium-credit-lightbox-close:hover\", {\n    color: highlightColor,\n  });\n\n  style += addStyle(\".cesium-credit-lightbox > ul\", {\n    margin: \"0\",\n    padding: \"12px 20px 12px 40px\",\n    \"font-size\": \"13px\",\n  });\n\n  style += addStyle(\".cesium-credit-lightbox > ul > li\", {\n    \"padding-bottom\": \"6px\",\n  });\n\n  style += addStyle(\".cesium-credit-lightbox > ul > li *\", {\n    padding: \"0\",\n    margin: \"0\",\n  });\n\n  style += addStyle(\".cesium-credit-expand-link\", {\n    \"padding-left\": \"5px\",\n    cursor: \"pointer\",\n    \"text-decoration\": \"underline\",\n    color: textColor,\n  });\n  style += addStyle(\".cesium-credit-expand-link:hover\", {\n    color: highlightColor,\n  });\n\n  style += addStyle(\".cesium-credit-text\", {\n    color: textColor,\n  });\n\n  style += addStyle(\n    \".cesium-credit-textContainer *, .cesium-credit-logoContainer *\",\n    {\n      display: \"inline\",\n    }\n  );\n\n  const head = document.head;\n  const css = document.createElement(\"style\");\n  css.innerHTML = style;\n  head.insertBefore(css, head.firstChild);\n}\n\n/**\n * The credit display is responsible for displaying credits on screen.\n *\n * @param {HTMLElement} container The HTML element where credits will be displayed\n * @param {String} [delimiter= ' • '] The string to separate text credits\n * @param {HTMLElement} [viewport=document.body] The HTML element that will contain the credits popup\n *\n * @alias CreditDisplay\n * @constructor\n *\n * @example\n * const creditDisplay = new Cesium.CreditDisplay(creditContainer);\n */\nfunction CreditDisplay(container, delimiter, viewport) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"container\", container);\n  //>>includeEnd('debug');\n  const that = this;\n\n  viewport = defaultValue(viewport, document.body);\n\n  const lightbox = document.createElement(\"div\");\n  lightbox.className = \"cesium-credit-lightbox-overlay\";\n  viewport.appendChild(lightbox);\n\n  const lightboxCredits = document.createElement(\"div\");\n  lightboxCredits.className = \"cesium-credit-lightbox\";\n  lightbox.appendChild(lightboxCredits);\n\n  function hideLightbox(event) {\n    if (lightboxCredits.contains(event.target)) {\n      return;\n    }\n    that.hideLightbox();\n  }\n  lightbox.addEventListener(\"click\", hideLightbox, false);\n\n  const title = document.createElement(\"div\");\n  title.className = \"cesium-credit-lightbox-title\";\n  title.textContent = \"Data provided by:\";\n  lightboxCredits.appendChild(title);\n\n  const closeButton = document.createElement(\"a\");\n  closeButton.onclick = this.hideLightbox.bind(this);\n  closeButton.innerHTML = \"&times;\";\n  closeButton.className = \"cesium-credit-lightbox-close\";\n  lightboxCredits.appendChild(closeButton);\n\n  const creditList = document.createElement(\"ul\");\n  lightboxCredits.appendChild(creditList);\n\n  const cesiumCreditContainer = document.createElement(\"div\");\n  cesiumCreditContainer.className = \"cesium-credit-logoContainer\";\n  cesiumCreditContainer.style.display = \"inline\";\n  container.appendChild(cesiumCreditContainer);\n\n  const screenContainer = document.createElement(\"div\");\n  screenContainer.className = \"cesium-credit-textContainer\";\n  screenContainer.style.display = \"inline\";\n  container.appendChild(screenContainer);\n\n  const expandLink = document.createElement(\"a\");\n  expandLink.className = \"cesium-credit-expand-link\";\n  expandLink.onclick = this.showLightbox.bind(this);\n  expandLink.textContent = \"Data attribution\";\n  container.appendChild(expandLink);\n\n  appendCss();\n  const cesiumCredit = Credit.clone(CreditDisplay.cesiumCredit);\n\n  this._delimiter = defaultValue(delimiter, \" • \");\n  this._screenContainer = screenContainer;\n  this._cesiumCreditContainer = cesiumCreditContainer;\n  this._lastViewportHeight = undefined;\n  this._lastViewportWidth = undefined;\n  this._lightboxCredits = lightboxCredits;\n  this._creditList = creditList;\n  this._lightbox = lightbox;\n  this._hideLightbox = hideLightbox;\n  this._expandLink = expandLink;\n  this._expanded = false;\n  this._defaultCredits = [];\n  this._cesiumCredit = cesiumCredit;\n  this._previousCesiumCredit = undefined;\n  this._currentCesiumCredit = cesiumCredit;\n  this._creditDisplayElementPool = [];\n  this._creditDisplayElementIndex = 0;\n\n  this._currentFrameCredits = {\n    screenCredits: new AssociativeArray(),\n    lightboxCredits: new AssociativeArray(),\n  };\n\n  this._defaultCredit = undefined;\n\n  this.viewport = viewport;\n\n  /**\n   * The HTML element where credits will be displayed.\n   * @type {HTMLElement}\n   */\n  this.container = container;\n}\n\nfunction setCredit(creditDisplay, credits, credit, count) {\n  count = defaultValue(count, 1);\n  let creditDisplayElement = credits.get(credit.id);\n  if (!defined(creditDisplayElement)) {\n    const pool = creditDisplay._creditDisplayElementPool;\n    const poolIndex = creditDisplay._creditDisplayElementPoolIndex;\n    if (poolIndex < pool.length) {\n      creditDisplayElement = pool[poolIndex];\n      creditDisplayElement.credit = credit;\n      creditDisplayElement.count = count;\n    } else {\n      creditDisplayElement = new CreditDisplayElement(credit, count);\n      pool.push(creditDisplayElement);\n    }\n    ++creditDisplay._creditDisplayElementPoolIndex;\n    credits.set(credit.id, creditDisplayElement);\n  } else if (creditDisplayElement.count < Number.MAX_VALUE) {\n    creditDisplayElement.count += count;\n  }\n}\n/**\n * Adds a credit to the list of current credits to be displayed in the credit container\n *\n * @param {Credit} credit The credit to display\n */\nCreditDisplay.prototype.addCredit = function (credit) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"credit\", credit);\n  //>>includeEnd('debug');\n\n  if (credit._isIon) {\n    // If this is the an ion logo credit from the ion server\n    // Juse use the default credit (which is identical) to avoid blinking\n    if (!defined(this._defaultCredit)) {\n      this._defaultCredit = Credit.clone(getDefaultCredit());\n    }\n    this._currentCesiumCredit = this._defaultCredit;\n    return;\n  }\n\n  let credits;\n  if (!credit.showOnScreen) {\n    credits = this._currentFrameCredits.lightboxCredits;\n  } else {\n    credits = this._currentFrameCredits.screenCredits;\n  }\n\n  setCredit(this, credits, credit);\n};\n\n/**\n * Adds credits that will persist until they are removed\n *\n * @param {Credit} credit The credit to added to defaults\n */\nCreditDisplay.prototype.addDefaultCredit = function (credit) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"credit\", credit);\n  //>>includeEnd('debug');\n\n  const defaultCredits = this._defaultCredits;\n  if (!contains(defaultCredits, credit)) {\n    defaultCredits.push(credit);\n  }\n};\n\n/**\n * Removes a default credit\n *\n * @param {Credit} credit The credit to be removed from defaults\n */\nCreditDisplay.prototype.removeDefaultCredit = function (credit) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.defined(\"credit\", credit);\n  //>>includeEnd('debug');\n\n  const defaultCredits = this._defaultCredits;\n  const index = defaultCredits.indexOf(credit);\n  if (index !== -1) {\n    defaultCredits.splice(index, 1);\n  }\n};\n\nCreditDisplay.prototype.showLightbox = function () {\n  this._lightbox.style.display = \"block\";\n  this._expanded = true;\n};\n\nCreditDisplay.prototype.hideLightbox = function () {\n  this._lightbox.style.display = \"none\";\n  this._expanded = false;\n};\n\n/**\n * Updates the credit display before a new frame is rendered.\n */\nCreditDisplay.prototype.update = function () {\n  if (this._expanded) {\n    styleLightboxContainer(this);\n  }\n};\n\n/**\n * Resets the credit display to a beginning of frame state, clearing out current credits.\n */\nCreditDisplay.prototype.beginFrame = function () {\n  const currentFrameCredits = this._currentFrameCredits;\n  this._creditDisplayElementPoolIndex = 0;\n\n  const screenCredits = currentFrameCredits.screenCredits;\n  screenCredits.removeAll();\n  const defaultCredits = this._defaultCredits;\n  for (let i = 0; i < defaultCredits.length; ++i) {\n    const defaultCredit = defaultCredits[i];\n    setCredit(this, screenCredits, defaultCredit, Number.MAX_VALUE);\n  }\n\n  currentFrameCredits.lightboxCredits.removeAll();\n\n  if (!Credit.equals(CreditDisplay.cesiumCredit, this._cesiumCredit)) {\n    this._cesiumCredit = Credit.clone(CreditDisplay.cesiumCredit);\n  }\n  this._currentCesiumCredit = this._cesiumCredit;\n};\n\n/**\n * Sets the credit display to the end of frame state, displaying credits from the last frame in the credit container.\n */\nCreditDisplay.prototype.endFrame = function () {\n  const screenCredits = this._currentFrameCredits.screenCredits.values;\n  displayCredits(\n    this._screenContainer,\n    screenCredits,\n    this._delimiter,\n    undefined\n  );\n\n  const lightboxCredits = this._currentFrameCredits.lightboxCredits.values;\n  this._expandLink.style.display =\n    lightboxCredits.length > 0 ? \"inline\" : \"none\";\n  displayCredits(this._creditList, lightboxCredits, undefined, \"li\");\n\n  swapCesiumCredit(this);\n};\n\n/**\n * Destroys the resources held by this object.  Destroying an object allows for deterministic\n * release of resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n */\nCreditDisplay.prototype.destroy = function () {\n  this._lightbox.removeEventListener(\"click\", this._hideLightbox, false);\n\n  this.container.removeChild(this._cesiumCreditContainer);\n  this.container.removeChild(this._screenContainer);\n  this.container.removeChild(this._expandLink);\n  this.viewport.removeChild(this._lightbox);\n\n  return destroyObject(this);\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n */\nCreditDisplay.prototype.isDestroyed = function () {\n  return false;\n};\n\nCreditDisplay._cesiumCredit = undefined;\nCreditDisplay._cesiumCreditInitialized = false;\n\nlet defaultCredit;\nfunction getDefaultCredit() {\n  if (!defined(defaultCredit)) {\n    let logo = buildModuleUrl(\"Assets/Images/ion-credit.png\");\n\n    // When hosting in a WebView, the base URL scheme is file:// or ms-appx-web://\n    // which is stripped out from the Credit's <img> tag; use the full path instead\n    if (\n      logo.indexOf(\"http://\") !== 0 &&\n      logo.indexOf(\"https://\") !== 0 &&\n      logo.indexOf(\"data:\") !== 0\n    ) {\n      const logoUrl = new Uri(logo);\n      logo = logoUrl.path();\n    }\n\n    defaultCredit = new Credit(\n      `<a href=\"https://cesium.com/\" target=\"_blank\"><img src=\"${logo}\" title=\"Cesium ion\"/></a>`,\n      true\n    );\n  }\n\n  if (!CreditDisplay._cesiumCreditInitialized) {\n    CreditDisplay._cesiumCredit = defaultCredit;\n    CreditDisplay._cesiumCreditInitialized = true;\n  }\n  return defaultCredit;\n}\n\nObject.defineProperties(CreditDisplay, {\n  /**\n   * Gets or sets the Cesium logo credit.\n   * @memberof CreditDisplay\n   * @type {Credit}\n   */\n  cesiumCredit: {\n    get: function () {\n      getDefaultCredit();\n      return CreditDisplay._cesiumCredit;\n    },\n    set: function (value) {\n      CreditDisplay._cesiumCredit = value;\n      CreditDisplay._cesiumCreditInitialized = true;\n    },\n  },\n});\n\nCreditDisplay.CreditDisplayElement = CreditDisplayElement;\nexport default CreditDisplay;\n","import WebGLConstants from \"../Core/WebGLConstants.js\";\n\n/**\n * Determines which triangles, if any, are culled.\n *\n * @enum {Number}\n */\nconst CullFace = {\n  /**\n   * Front-facing triangles are culled.\n   *\n   * @type {Number}\n   * @constant\n   */\n  FRONT: WebGLConstants.FRONT,\n\n  /**\n   * Back-facing triangles are culled.\n   *\n   * @type {Number}\n   * @constant\n   */\n  BACK: WebGLConstants.BACK,\n\n  /**\n   * Both front-facing and back-facing triangles are culled.\n   *\n   * @type {Number}\n   * @constant\n   */\n  FRONT_AND_BACK: WebGLConstants.FRONT_AND_BACK,\n};\nexport default Object.freeze(CullFace);\n","import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\n\n/**\n * A cumulus cloud billboard positioned in the 3D scene, that is created and rendered using a {@link CloudCollection}.\n * A cloud is created and its initial properties are set by calling {@link CloudCollection#add}.\n * and {@link CloudCollection#remove}.\n * <br /><br />\n * <div align='center'>\n * <img src='Images/CumulusCloud.png' width='400' height='300' /><br />\n * Example cumulus clouds\n * </div>\n * @alias CumulusCloud\n *\n * @performance Similar to {@link Billboard}, reading a property, e.g., {@link CumulusCloud#show},\n * takes constant time. Assigning to a property is constant time but results in\n * CPU to GPU traffic when {@link CloudCollection#update} is called.  The per-cloud traffic is\n * the same regardless of how many properties were updated.  If most clouds in a collection need to be\n * updated, it may be more efficient to clear the collection with {@link CloudCollection#removeAll}\n * and add new clouds instead of modifying each one.\n *\n * @see CloudCollection\n * @see CloudCollection#add\n *\n * @internalConstructor\n * @class\n *\n * @demo {@link https://sandcastle.cesium.com/index.html?src=Cloud%20Parameters.html|Cesium Sandcastle Cloud Parameters Demo}\n */\nfunction CumulusCloud(options, cloudCollection) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  this._show = defaultValue(options.show, true);\n\n  this._position = Cartesian3.clone(\n    defaultValue(options.position, Cartesian3.ZERO)\n  );\n\n  if (!defined(options.scale) && defined(options.maximumSize)) {\n    this._maximumSize = Cartesian3.clone(options.maximumSize);\n    this._scale = new Cartesian2(this._maximumSize.x, this._maximumSize.y);\n  } else {\n    this._scale = Cartesian2.clone(\n      defaultValue(options.scale, new Cartesian2(20.0, 12.0))\n    );\n\n    const defaultMaxSize = new Cartesian3(\n      this._scale.x,\n      this._scale.y,\n      Math.min(this._scale.x, this._scale.y) / 1.5\n    );\n    this._maximumSize = Cartesian3.clone(\n      defaultValue(options.maximumSize, defaultMaxSize)\n    );\n  }\n\n  this._slice = defaultValue(options.slice, -1.0);\n  this._color = Color.clone(defaultValue(options.color, Color.WHITE));\n  this._brightness = defaultValue(options.brightness, 1.0);\n  this._cloudCollection = cloudCollection;\n  this._index = -1; // Used by CloudCollection\n}\n\nconst SHOW_INDEX = (CumulusCloud.SHOW_INDEX = 0);\nconst POSITION_INDEX = (CumulusCloud.POSITION_INDEX = 1);\nconst SCALE_INDEX = (CumulusCloud.SCALE_INDEX = 2);\nconst MAXIMUM_SIZE_INDEX = (CumulusCloud.MAXIMUM_SIZE_INDEX = 3);\nconst SLICE_INDEX = (CumulusCloud.SLICE_INDEX = 4);\nconst BRIGHTNESS_INDEX = (CumulusCloud.BRIGHTNESS_INDEX = 5);\nconst COLOR_INDEX = (CumulusCloud.COLOR_INDEX = 6);\nCumulusCloud.NUMBER_OF_PROPERTIES = 7;\n\nfunction makeDirty(cloud, propertyChanged) {\n  const cloudCollection = cloud._cloudCollection;\n  if (defined(cloudCollection)) {\n    cloudCollection._updateCloud(cloud, propertyChanged);\n    cloud._dirty = true;\n  }\n}\n\nObject.defineProperties(CumulusCloud.prototype, {\n  /**\n   * Determines if this cumulus cloud will be shown.  Use this to hide or show a cloud, instead\n   * of removing it and re-adding it to the collection.\n   * @memberof CumulusCloud.prototype\n   * @type {Boolean}\n   * @default true\n   */\n  show: {\n    get: function () {\n      return this._show;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      Check.typeOf.bool(\"value\", value);\n      //>>includeEnd('debug');\n\n      if (this._show !== value) {\n        this._show = value;\n        makeDirty(this, SHOW_INDEX);\n      }\n    },\n  },\n\n  /**\n   * Gets or sets the Cartesian position of this cumulus cloud.\n   * @memberof CumulusCloud.prototype\n   * @type {Cartesian3}\n   */\n  position: {\n    get: function () {\n      return this._position;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug)\n      Check.typeOf.object(\"value\", value);\n      //>>includeEnd('debug');\n\n      const position = this._position;\n      if (!Cartesian3.equals(position, value)) {\n        Cartesian3.clone(value, position);\n        makeDirty(this, POSITION_INDEX);\n      }\n    },\n  },\n\n  /**\n   * <p>Gets or sets the scale of the cumulus cloud billboard in meters.\n   * The <code>scale</code> property will affect the size of the billboard,\n   * but not the cloud's actual appearance.</p>\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'>\n   *   <code>cloud.scale = new Cesium.Cartesian2(12, 8);</code><br/>\n   *   <img src='Images/CumulusCloud.scalex12y8.png' width='250' height='158' />\n   * </td>\n   * <td align='center'>\n   *   <code>cloud.scale = new Cesium.Cartesian2(24, 10);</code><br/>\n   *   <img src='Images/CumulusCloud.scalex24y10.png' width='250' height='158' />\n   * </td>\n   * </tr></table>\n   * </div>\n   *\n   * <p>To modify the cloud's appearance, modify its <code>maximumSize</code>\n   * and <code>slice</code> properties.</p>\n   * @memberof CumulusCloud.prototype\n   * @type {Cartesian2}\n   *\n   * @see CumulusCloud#maximumSize\n   * @see CumulusCloud#slice\n   */\n  scale: {\n    get: function () {\n      return this._scale;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug)\n      Check.typeOf.object(\"value\", value);\n      //>>includeEnd('debug');\n\n      const scale = this._scale;\n      if (!Cartesian2.equals(scale, value)) {\n        Cartesian2.clone(value, scale);\n        makeDirty(this, SCALE_INDEX);\n      }\n    },\n  },\n\n  /**\n   * <p>Gets or sets the maximum size of the cumulus cloud rendered on the billboard.\n   * This defines a maximum ellipsoid volume that the cloud can appear in.\n   * Rather than guaranteeing a specific size, this specifies a boundary for the\n   * cloud to appear in, and changing it can affect the shape of the cloud.</p>\n   * <p>Changing the z-value of <code>maximumSize</code> has the most dramatic effect\n   * on the cloud's appearance because it changes the depth of the cloud, and thus the\n   * positions at which the cloud-shaping texture is sampled.</p>\n   * <div align='center'>\n   * <table border='0' cellpadding='5'>\n   * <tr>\n   *   <td align='center'>\n   *     <code>cloud.maximumSize = new Cesium.Cartesian3(14, 9, 10);</code><br/>\n   *     <img src='Images/CumulusCloud.maximumSizex14y9z10.png' width='250' height='158' />\n   *   </td>\n   *   <td align='center'>\n   *     <code>cloud.maximumSize.x = 25;</code><br/>\n   *     <img src='Images/CumulusCloud.maximumSizex25.png' width='250' height='158' />\n   *   </td>\n   * </tr>\n   * <tr>\n   *   <td align='center'>\n   *     <code>cloud.maximumSize.y = 5;</code><br/>\n   *     <img src='Images/CumulusCloud.maximumSizey5.png' width='250' height='158' />\n   *   </td>\n   *   <td align='center'>\n   *     <code>cloud.maximumSize.z = 17;</code><br/>\n   *     <img src='Images/CumulusCloud.maximumSizez17.png' width='250' height='158' />\n   *   </td>\n   * </tr>\n   * </table>\n   * </div>\n   *\n   * <p>To modify the billboard's actual size, modify the cloud's <code>scale</code> property.</p>\n   * @memberof CumulusCloud.prototype\n   * @type {Cartesian3}\n   *\n   * @see CumulusCloud#scale\n   */\n  maximumSize: {\n    get: function () {\n      return this._maximumSize;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug)\n      Check.typeOf.object(\"value\", value);\n      //>>includeEnd('debug');\n\n      const maximumSize = this._maximumSize;\n      if (!Cartesian3.equals(maximumSize, value)) {\n        Cartesian3.clone(value, maximumSize);\n        makeDirty(this, MAXIMUM_SIZE_INDEX);\n      }\n    },\n  },\n  /**\n   * Sets the color of the cloud\n   * @memberof CumulusCloud.prototype\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  color: {\n    get: function () {\n      return this._color;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug)\n      Check.typeOf.object(\"value\", value);\n      //>>includeEnd('debug');\n\n      const color = this._color;\n      if (!Color.equals(color, value)) {\n        Color.clone(value, color);\n        makeDirty(this, COLOR_INDEX);\n      }\n    },\n  },\n  /**\n   * <p>Gets or sets the \"slice\" of the cloud that is rendered on the billboard, i.e.\n   * the specific cross-section of the cloud chosen for the billboard's appearance.\n   * Given a value between 0 and 1, the slice specifies how deeply into the cloud\n   * to intersect based on its maximum size in the z-direction.</p>\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'><code>cloud.slice = 0.32;</code><br/><img src='Images/CumulusCloud.slice0.32.png' width='250' height='158' /></td>\n   * <td align='center'><code>cloud.slice = 0.5;</code><br/><img src='Images/CumulusCloud.slice0.5.png' width='250' height='158' /></td>\n   * <td align='center'><code>cloud.slice = 0.6;</code><br/><img src='Images/CumulusCloud.slice0.6.png' width='250' height='158' /></td>\n   * </tr></table>\n   * </div>\n   *\n   * <br />\n   * <p>Due to the nature in which this slice is calculated,\n   * values below <code>0.2</code> may result in cross-sections that are too small,\n   * and the edge of the ellipsoid will be visible. Similarly, values above <code>0.7</code>\n   * will cause the cloud to appear smaller. Values outside the range <code>[0.1, 0.9]</code>\n   * should be avoided entirely because they do not produce desirable results.</p>\n   *\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'><code>cloud.slice = 0.08;</code><br/><img src='Images/CumulusCloud.slice0.08.png' width='250' height='158' /></td>\n   * <td align='center'><code>cloud.slice = 0.8;</code><br/><img src='Images/CumulusCloud.slice0.8.png' width='250' height='158' /></td>\n   * </tr></table>\n   * </div>\n   *\n   * <p>If <code>slice</code> is set to a negative number, the cloud will not render a cross-section.\n   * Instead, it will render the outside of the ellipsoid that is visible. For clouds with\n   * small values of `maximumSize.z`, this can produce good-looking results, but for larger\n   * clouds, this can result in a cloud that is undesirably warped to the ellipsoid volume.</p>\n   *\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'>\n   *  <code>cloud.slice = -1.0;<br/>cloud.maximumSize.z = 18;</code><br/>\n   *  <img src='Images/CumulusCloud.slice-1z18.png' width='250' height='158' />\n   * </td>\n   * <td align='center'>\n   *   <code>cloud.slice = -1.0;<br/>cloud.maximumSize.z = 30;</code><br/>\n   *   <img src='Images/CumulusCloud.slice-1z30.png' width='250' height='158' /></td>\n   * </tr></table>\n   * </div>\n   *\n   * @memberof CumulusCloud.prototype\n   * @type {Number}\n   * @default -1.0\n   */\n  slice: {\n    get: function () {\n      return this._slice;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug)\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n\n      const slice = this._slice;\n      if (slice !== value) {\n        this._slice = value;\n        makeDirty(this, SLICE_INDEX);\n      }\n    },\n  },\n\n  /**\n   * Gets or sets the brightness of the cloud. This can be used to give clouds\n   * a darker, grayer appearance.\n   * <br /><br />\n   * <div align='center'>\n   * <table border='0' cellpadding='5'><tr>\n   * <td align='center'><code>cloud.brightness = 1.0;</code><br/><img src='Images/CumulusCloud.brightness1.png' width='250' height='158' /></td>\n   * <td align='center'><code>cloud.brightness = 0.6;</code><br/><img src='Images/CumulusCloud.brightness0.6.png' width='250' height='158' /></td>\n   * <td align='center'><code>cloud.brightness = 0.0;</code><br/><img src='Images/CumulusCloud.brightness0.png' width='250' height='158' /></td>\n   * </tr></table>\n   * </div>\n   * @memberof CumulusCloud.prototype\n   * @type {Number}\n   * @default 1.0\n   */\n  brightness: {\n    get: function () {\n      return this._brightness;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug)\n      Check.typeOf.number(\"value\", value);\n      //>>includeEnd('debug');\n\n      const brightness = this._brightness;\n      if (brightness !== value) {\n        this._brightness = value;\n        makeDirty(this, BRIGHTNESS_INDEX);\n      }\n    },\n  },\n});\n\nCumulusCloud.prototype._destroy = function () {\n  this._cloudCollection = undefined;\n};\n\nexport default CumulusCloud;\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Appearance from \"./Appearance.js\";\n\n/**\n * Visualizes a vertex attribute by displaying it as a color for debugging.\n * <p>\n * Components for well-known unit-length vectors, i.e., <code>normal</code>,\n * <code>tangent</code>, and <code>bitangent</code>, are scaled and biased\n * from [-1.0, 1.0] to (-1.0, 1.0).\n * </p>\n *\n * @alias DebugAppearance\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {String} options.attributeName The name of the attribute to visualize.\n * @param {Boolean} [options.perInstanceAttribute=false] Boolean that determines whether this attribute is a per-instance geometry attribute.\n * @param {String} [options.glslDatatype='vec3'] The GLSL datatype of the attribute.  Supported datatypes are <code>float</code>, <code>vec2</code>, <code>vec3</code>, and <code>vec4</code>.\n * @param {String} [options.vertexShaderSource] Optional GLSL vertex shader source to override the default vertex shader.\n * @param {String} [options.fragmentShaderSource] Optional GLSL fragment shader source to override the default fragment shader.\n * @param {Object} [options.renderState] Optional render state to override the default render state.\n *\n * @exception {DeveloperError} options.glslDatatype must be float, vec2, vec3, or vec4.\n *\n * @example\n * const primitive = new Cesium.Primitive({\n *   geometryInstances : // ...\n *   appearance : new Cesium.DebugAppearance({\n *     attributeName : 'normal'\n *   })\n * });\n */\nfunction DebugAppearance(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n  const attributeName = options.attributeName;\n  let perInstanceAttribute = options.perInstanceAttribute;\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(attributeName)) {\n    throw new DeveloperError(\"options.attributeName is required.\");\n  }\n  //>>includeEnd('debug');\n\n  if (!defined(perInstanceAttribute)) {\n    perInstanceAttribute = false;\n  }\n\n  let glslDatatype = defaultValue(options.glslDatatype, \"vec3\");\n  const varyingName = `v_${attributeName}`;\n  let getColor;\n\n  // Well-known normalized vector attributes in VertexFormat\n  if (\n    attributeName === \"normal\" ||\n    attributeName === \"tangent\" ||\n    attributeName === \"bitangent\"\n  ) {\n    getColor = `vec4 getColor() { return vec4((${varyingName} + vec3(1.0)) * 0.5, 1.0); }\\n`;\n  } else {\n    // All other attributes, both well-known and custom\n    if (attributeName === \"st\") {\n      glslDatatype = \"vec2\";\n    }\n\n    switch (glslDatatype) {\n      case \"float\":\n        getColor = `vec4 getColor() { return vec4(vec3(${varyingName}), 1.0); }\\n`;\n        break;\n      case \"vec2\":\n        getColor = `vec4 getColor() { return vec4(${varyingName}, 0.0, 1.0); }\\n`;\n        break;\n      case \"vec3\":\n        getColor = `vec4 getColor() { return vec4(${varyingName}, 1.0); }\\n`;\n        break;\n      case \"vec4\":\n        getColor = `vec4 getColor() { return ${varyingName}; }\\n`;\n        break;\n      //>>includeStart('debug', pragmas.debug);\n      default:\n        throw new DeveloperError(\n          \"options.glslDatatype must be float, vec2, vec3, or vec4.\"\n        );\n      //>>includeEnd('debug');\n    }\n  }\n\n  const vs =\n    `${\n      \"attribute vec3 position3DHigh;\\n\" +\n      \"attribute vec3 position3DLow;\\n\" +\n      \"attribute float batchId;\\n\"\n    }${\n      perInstanceAttribute\n        ? \"\"\n        : `attribute ${glslDatatype} ${attributeName};\\n`\n    }varying ${glslDatatype} ${varyingName};\\n` +\n    `void main()\\n` +\n    `{\\n` +\n    `vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\\n${\n      perInstanceAttribute\n        ? `${varyingName} = czm_batchTable_${attributeName}(batchId);\\n`\n        : `${varyingName} = ${attributeName};\\n`\n    }gl_Position = czm_modelViewProjectionRelativeToEye * p;\\n` +\n    `}`;\n  const fs =\n    `varying ${glslDatatype} ${varyingName};\\n${getColor}\\n` +\n    `void main()\\n` +\n    `{\\n` +\n    `gl_FragColor = getColor();\\n` +\n    `}`;\n\n  /**\n   * This property is part of the {@link Appearance} interface, but is not\n   * used by {@link DebugAppearance} since a fully custom fragment shader is used.\n   *\n   * @type Material\n   *\n   * @default undefined\n   */\n  this.material = undefined;\n\n  /**\n   * When <code>true</code>, the geometry is expected to appear translucent.\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.translucent = defaultValue(options.translucent, false);\n\n  this._vertexShaderSource = defaultValue(options.vertexShaderSource, vs);\n  this._fragmentShaderSource = defaultValue(options.fragmentShaderSource, fs);\n  this._renderState = Appearance.getDefaultRenderState(\n    false,\n    false,\n    options.renderState\n  );\n  this._closed = defaultValue(options.closed, false);\n\n  // Non-derived members\n\n  this._attributeName = attributeName;\n  this._glslDatatype = glslDatatype;\n}\n\nObject.defineProperties(DebugAppearance.prototype, {\n  /**\n   * The GLSL source code for the vertex shader.\n   *\n   * @memberof DebugAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  vertexShaderSource: {\n    get: function () {\n      return this._vertexShaderSource;\n    },\n  },\n\n  /**\n   * The GLSL source code for the fragment shader.  The full fragment shader\n   * source is built procedurally taking into account the {@link DebugAppearance#material}.\n   * Use {@link DebugAppearance#getFragmentShaderSource} to get the full source.\n   *\n   * @memberof DebugAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  fragmentShaderSource: {\n    get: function () {\n      return this._fragmentShaderSource;\n    },\n  },\n\n  /**\n   * The WebGL fixed-function state to use when rendering the geometry.\n   *\n   * @memberof DebugAppearance.prototype\n   *\n   * @type {Object}\n   * @readonly\n   */\n  renderState: {\n    get: function () {\n      return this._renderState;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the geometry is expected to be closed.\n   *\n   * @memberof DebugAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  closed: {\n    get: function () {\n      return this._closed;\n    },\n  },\n\n  /**\n   * The name of the attribute being visualized.\n   *\n   * @memberof DebugAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  attributeName: {\n    get: function () {\n      return this._attributeName;\n    },\n  },\n\n  /**\n   * The GLSL datatype of the attribute being visualized.\n   *\n   * @memberof DebugAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  glslDatatype: {\n    get: function () {\n      return this._glslDatatype;\n    },\n  },\n});\n\n/**\n * Returns the full GLSL fragment shader source, which for {@link DebugAppearance} is just\n * {@link DebugAppearance#fragmentShaderSource}.\n *\n * @function\n *\n * @returns {String} The full GLSL fragment shader source.\n */\nDebugAppearance.prototype.getFragmentShaderSource =\n  Appearance.prototype.getFragmentShaderSource;\n\n/**\n * Determines if the geometry is translucent based on {@link DebugAppearance#translucent}.\n *\n * @function\n *\n * @returns {Boolean} <code>true</code> if the appearance is translucent.\n */\nDebugAppearance.prototype.isTranslucent = Appearance.prototype.isTranslucent;\n\n/**\n * Creates a render state.  This is not the final render state instance; instead,\n * it can contain a subset of render state properties identical to the render state\n * created in the context.\n *\n * @function\n *\n * @returns {Object} The render state.\n */\nDebugAppearance.prototype.getRenderState = Appearance.prototype.getRenderState;\nexport default DebugAppearance;\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Color from \"../Core/Color.js\";\nimport ColorGeometryInstanceAttribute from \"../Core/ColorGeometryInstanceAttribute.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport FrustumGeometry from \"../Core/FrustumGeometry.js\";\nimport FrustumOutlineGeometry from \"../Core/FrustumOutlineGeometry.js\";\nimport GeometryInstance from \"../Core/GeometryInstance.js\";\nimport Matrix3 from \"../Core/Matrix3.js\";\nimport OrthographicFrustum from \"../Core/OrthographicFrustum.js\";\nimport OrthographicOffCenterFrustum from \"../Core/OrthographicOffCenterFrustum.js\";\nimport PerspectiveFrustum from \"../Core/PerspectiveFrustum.js\";\nimport PerspectiveOffCenterFrustum from \"../Core/PerspectiveOffCenterFrustum.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\nimport PerInstanceColorAppearance from \"./PerInstanceColorAppearance.js\";\nimport Primitive from \"./Primitive.js\";\n\n/**\n * Draws the outline of the camera's view frustum.\n *\n * @alias DebugCameraPrimitive\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {Camera} options.camera The camera.\n * @param {Number[]} [options.frustumSplits] Distances to the near and far planes of the camera frustums. This overrides the camera's frustum near and far values.\n * @param {Color} [options.color=Color.CYAN] The color of the debug outline.\n * @param {Boolean} [options.updateOnChange=true] Whether the primitive updates when the underlying camera changes.\n * @param {Boolean} [options.show=true] Determines if this primitive will be shown.\n * @param {Object} [options.id] A user-defined object to return when the instance is picked with {@link Scene#pick}.\n *\n * @example\n * primitives.add(new Cesium.DebugCameraPrimitive({\n *   camera : camera,\n *   color : Cesium.Color.YELLOW\n * }));\n */\nfunction DebugCameraPrimitive(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(options.camera)) {\n    throw new DeveloperError(\"options.camera is required.\");\n  }\n  //>>includeEnd('debug');\n\n  this._camera = options.camera;\n  this._frustumSplits = options.frustumSplits;\n  this._color = defaultValue(options.color, Color.CYAN);\n  this._updateOnChange = defaultValue(options.updateOnChange, true);\n\n  /**\n   * Determines if this primitive will be shown.\n   *\n   * @type Boolean\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n\n  /**\n   * User-defined value returned when the primitive is picked.\n   *\n   * @type {*}\n   * @default undefined\n   *\n   * @see Scene#pick\n   */\n  this.id = options.id;\n  this._id = undefined;\n\n  this._outlinePrimitives = [];\n  this._planesPrimitives = [];\n}\n\nconst scratchRight = new Cartesian3();\nconst scratchRotation = new Matrix3();\nconst scratchOrientation = new Quaternion();\nconst scratchPerspective = new PerspectiveFrustum();\nconst scratchPerspectiveOffCenter = new PerspectiveOffCenterFrustum();\nconst scratchOrthographic = new OrthographicFrustum();\nconst scratchOrthographicOffCenter = new OrthographicOffCenterFrustum();\n\nconst scratchColor = new Color();\nconst scratchSplits = [1.0, 100000.0];\n\n/**\n * @private\n */\nDebugCameraPrimitive.prototype.update = function (frameState) {\n  if (!this.show) {\n    return;\n  }\n\n  const planesPrimitives = this._planesPrimitives;\n  const outlinePrimitives = this._outlinePrimitives;\n  let i;\n  let length;\n\n  if (this._updateOnChange) {\n    // Recreate the primitive every frame\n    length = planesPrimitives.length;\n    for (i = 0; i < length; ++i) {\n      outlinePrimitives[i] =\n        outlinePrimitives[i] && outlinePrimitives[i].destroy();\n      planesPrimitives[i] =\n        planesPrimitives[i] && planesPrimitives[i].destroy();\n    }\n    planesPrimitives.length = 0;\n    outlinePrimitives.length = 0;\n  }\n\n  if (planesPrimitives.length === 0) {\n    const camera = this._camera;\n    const cameraFrustum = camera.frustum;\n    let frustum;\n    if (cameraFrustum instanceof PerspectiveFrustum) {\n      frustum = scratchPerspective;\n    } else if (cameraFrustum instanceof PerspectiveOffCenterFrustum) {\n      frustum = scratchPerspectiveOffCenter;\n    } else if (cameraFrustum instanceof OrthographicFrustum) {\n      frustum = scratchOrthographic;\n    } else {\n      frustum = scratchOrthographicOffCenter;\n    }\n    frustum = cameraFrustum.clone(frustum);\n\n    let numFrustums;\n    let frustumSplits = this._frustumSplits;\n    if (!defined(frustumSplits) || frustumSplits.length <= 1) {\n      // Use near and far planes if no splits created\n      frustumSplits = scratchSplits;\n      frustumSplits[0] = this._camera.frustum.near;\n      frustumSplits[1] = this._camera.frustum.far;\n      numFrustums = 1;\n    } else {\n      numFrustums = frustumSplits.length - 1;\n    }\n\n    const position = camera.positionWC;\n    const direction = camera.directionWC;\n    const up = camera.upWC;\n    let right = camera.rightWC;\n    right = Cartesian3.negate(right, scratchRight);\n\n    const rotation = scratchRotation;\n    Matrix3.setColumn(rotation, 0, right, rotation);\n    Matrix3.setColumn(rotation, 1, up, rotation);\n    Matrix3.setColumn(rotation, 2, direction, rotation);\n\n    const orientation = Quaternion.fromRotationMatrix(\n      rotation,\n      scratchOrientation\n    );\n\n    planesPrimitives.length = outlinePrimitives.length = numFrustums;\n\n    for (i = 0; i < numFrustums; ++i) {\n      frustum.near = frustumSplits[i];\n      frustum.far = frustumSplits[i + 1];\n\n      planesPrimitives[i] = new Primitive({\n        geometryInstances: new GeometryInstance({\n          geometry: new FrustumGeometry({\n            origin: position,\n            orientation: orientation,\n            frustum: frustum,\n            _drawNearPlane: i === 0,\n          }),\n          attributes: {\n            color: ColorGeometryInstanceAttribute.fromColor(\n              Color.fromAlpha(this._color, 0.1, scratchColor)\n            ),\n          },\n          id: this.id,\n          pickPrimitive: this,\n        }),\n        appearance: new PerInstanceColorAppearance({\n          translucent: true,\n          flat: true,\n        }),\n        asynchronous: false,\n      });\n\n      outlinePrimitives[i] = new Primitive({\n        geometryInstances: new GeometryInstance({\n          geometry: new FrustumOutlineGeometry({\n            origin: position,\n            orientation: orientation,\n            frustum: frustum,\n            _drawNearPlane: i === 0,\n          }),\n          attributes: {\n            color: ColorGeometryInstanceAttribute.fromColor(this._color),\n          },\n          id: this.id,\n          pickPrimitive: this,\n        }),\n        appearance: new PerInstanceColorAppearance({\n          translucent: false,\n          flat: true,\n        }),\n        asynchronous: false,\n      });\n    }\n  }\n\n  length = planesPrimitives.length;\n  for (i = 0; i < length; ++i) {\n    outlinePrimitives[i].update(frameState);\n    planesPrimitives[i].update(frameState);\n  }\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <p>\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * </p>\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see DebugCameraPrimitive#destroy\n */\nDebugCameraPrimitive.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <p>\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n * </p>\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @example\n * p = p && p.destroy();\n *\n * @see DebugCameraPrimitive#isDestroyed\n */\nDebugCameraPrimitive.prototype.destroy = function () {\n  const length = this._planesPrimitives.length;\n  for (let i = 0; i < length; ++i) {\n    this._outlinePrimitives[i] =\n      this._outlinePrimitives[i] && this._outlinePrimitives[i].destroy();\n    this._planesPrimitives[i] =\n      this._planesPrimitives[i] && this._planesPrimitives[i].destroy();\n  }\n  return destroyObject(this);\n};\nexport default DebugCameraPrimitive;\n","import Color from \"../Core/Color.js\";\nimport DrawCommand from \"../Renderer/DrawCommand.js\";\nimport ShaderSource from \"../Renderer/ShaderSource.js\";\nimport ShaderProgram from \"../Renderer/ShaderProgram.js\";\nimport defined from \"../Core/defined.js\";\n\n/**\n * @private\n */\nfunction DebugInspector() {\n  this._cachedShowFrustumsShaders = {};\n}\n\nfunction getAttributeLocations(shaderProgram) {\n  const attributeLocations = {};\n  const attributes = shaderProgram.vertexAttributes;\n  for (const a in attributes) {\n    if (attributes.hasOwnProperty(a)) {\n      attributeLocations[a] = attributes[a].index;\n    }\n  }\n\n  return attributeLocations;\n}\n\nfunction createDebugShowFrustumsShaderProgram(scene, shaderProgram) {\n  const context = scene.context;\n  const sp = shaderProgram;\n  const fs = sp.fragmentShaderSource.clone();\n\n  const targets = [];\n  fs.sources = fs.sources.map(function (source) {\n    source = ShaderSource.replaceMain(source, \"czm_Debug_main\");\n    const re = /gl_FragData\\[(\\d+)\\]/g;\n    let match;\n    while ((match = re.exec(source)) !== null) {\n      if (targets.indexOf(match[1]) === -1) {\n        targets.push(match[1]);\n      }\n    }\n    return source;\n  });\n  const length = targets.length;\n\n  let newMain = \"\";\n  newMain += \"uniform vec3 debugShowCommandsColor;\\n\";\n  newMain += \"uniform vec3 debugShowFrustumsColor;\\n\";\n  newMain += \"void main() \\n\" + \"{ \\n\" + \"    czm_Debug_main(); \\n\";\n\n  // set debugShowCommandsColor to Color(1.0, 1.0, 1.0, 1.0) to stop rendering scene.debugShowCommands\n  // set debugShowFrustumsColor to Color(1.0, 1.0, 1.0, 1.0) to stop rendering scene.debugShowFrustums\n  let i;\n  if (length > 0) {\n    for (i = 0; i < length; ++i) {\n      newMain += `    gl_FragData[${targets[i]}].rgb *= debugShowCommandsColor;\\n`;\n      newMain += `    gl_FragData[${targets[i]}].rgb *= debugShowFrustumsColor;\\n`;\n    }\n  } else {\n    newMain += \"    gl_FragColor.rgb *= debugShowCommandsColor;\\n\";\n    newMain += \"    gl_FragColor.rgb *= debugShowFrustumsColor;\\n\";\n  }\n  newMain += \"}\";\n\n  fs.sources.push(newMain);\n\n  const attributeLocations = getAttributeLocations(sp);\n\n  return ShaderProgram.fromCache({\n    context: context,\n    vertexShaderSource: sp.vertexShaderSource,\n    fragmentShaderSource: fs,\n    attributeLocations: attributeLocations,\n  });\n}\n\nconst scratchFrustumColor = new Color();\nfunction createDebugShowFrustumsUniformMap(scene, command) {\n  // setup uniform for the shader\n  let debugUniformMap;\n  if (!defined(command.uniformMap)) {\n    debugUniformMap = {};\n  } else {\n    debugUniformMap = command.uniformMap;\n  }\n\n  if (\n    defined(debugUniformMap.debugShowCommandsColor) ||\n    defined(debugUniformMap.debugShowFrustumsColor)\n  ) {\n    return debugUniformMap;\n  }\n\n  debugUniformMap.debugShowCommandsColor = function () {\n    if (!scene.debugShowCommands) {\n      return Color.WHITE;\n    }\n\n    if (!defined(command._debugColor)) {\n      command._debugColor = Color.fromRandom();\n    }\n\n    return command._debugColor;\n  };\n\n  debugUniformMap.debugShowFrustumsColor = function () {\n    if (!scene.debugShowFrustums) {\n      return Color.WHITE;\n    }\n\n    // Support up to three frustums.  If a command overlaps all\n    // three, it's code is not changed.\n    scratchFrustumColor.red =\n      command.debugOverlappingFrustums & (1 << 0) ? 1.0 : 0.0;\n    scratchFrustumColor.green =\n      command.debugOverlappingFrustums & (1 << 1) ? 1.0 : 0.0;\n    scratchFrustumColor.blue =\n      command.debugOverlappingFrustums & (1 << 2) ? 1.0 : 0.0;\n    scratchFrustumColor.alpha = 1.0;\n    return scratchFrustumColor;\n  };\n\n  return debugUniformMap;\n}\n\nconst scratchShowFrustumCommand = new DrawCommand();\nDebugInspector.prototype.executeDebugShowFrustumsCommand = function (\n  scene,\n  command,\n  passState\n) {\n  // create debug command\n  const shaderProgramId = command.shaderProgram.id;\n  let debugShaderProgram = this._cachedShowFrustumsShaders[shaderProgramId];\n  if (!defined(debugShaderProgram)) {\n    debugShaderProgram = createDebugShowFrustumsShaderProgram(\n      scene,\n      command.shaderProgram\n    );\n\n    this._cachedShowFrustumsShaders[shaderProgramId] = debugShaderProgram;\n  }\n\n  const debugCommand = DrawCommand.shallowClone(\n    command,\n    scratchShowFrustumCommand\n  );\n  debugCommand.shaderProgram = debugShaderProgram;\n  debugCommand.uniformMap = createDebugShowFrustumsUniformMap(scene, command);\n  debugCommand.execute(scene.context, passState);\n};\nexport default DebugInspector;\n","import ArcType from \"../Core/ArcType.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport GeometryInstance from \"../Core/GeometryInstance.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport PolylineGeometry from \"../Core/PolylineGeometry.js\";\nimport PolylineColorAppearance from \"./PolylineColorAppearance.js\";\nimport Primitive from \"./Primitive.js\";\n\n/**\n * Draws the axes of a reference frame defined by a matrix that transforms to world\n * coordinates, i.e., Earth's WGS84 coordinates.  The most prominent example is\n * a primitives <code>modelMatrix</code>.\n * <p>\n * The X axis is red; Y is green; and Z is blue.\n * </p>\n * <p>\n * This is for debugging only; it is not optimized for production use.\n * </p>\n *\n * @alias DebugModelMatrixPrimitive\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Number} [options.length=10000000.0] The length of the axes in meters.\n * @param {Number} [options.width=2.0] The width of the axes in pixels.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 matrix that defines the reference frame, i.e., origin plus axes, to visualize.\n * @param {Boolean} [options.show=true] Determines if this primitive will be shown.\n * @param {Object} [options.id] A user-defined object to return when the instance is picked with {@link Scene#pick}\n *\n * @example\n * primitives.add(new Cesium.DebugModelMatrixPrimitive({\n *   modelMatrix : primitive.modelMatrix,  // primitive to debug\n *   length : 100000.0,\n *   width : 10.0\n * }));\n */\nfunction DebugModelMatrixPrimitive(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  /**\n   * The length of the axes in meters.\n   *\n   * @type {Number}\n   * @default 10000000.0\n   */\n  this.length = defaultValue(options.length, 10000000.0);\n  this._length = undefined;\n\n  /**\n   * The width of the axes in pixels.\n   *\n   * @type {Number}\n   * @default 2.0\n   */\n  this.width = defaultValue(options.width, 2.0);\n  this._width = undefined;\n\n  /**\n   * Determines if this primitive will be shown.\n   *\n   * @type Boolean\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n\n  /**\n   * The 4x4 matrix that defines the reference frame, i.e., origin plus axes, to visualize.\n   *\n   * @type {Matrix4}\n   * @default {@link Matrix4.IDENTITY}\n   */\n  this.modelMatrix = Matrix4.clone(\n    defaultValue(options.modelMatrix, Matrix4.IDENTITY)\n  );\n  this._modelMatrix = new Matrix4();\n\n  /**\n   * User-defined value returned when the primitive is picked.\n   *\n   * @type {*}\n   * @default undefined\n   *\n   * @see Scene#pick\n   */\n  this.id = options.id;\n  this._id = undefined;\n\n  this._primitive = undefined;\n}\n\n/**\n * @private\n */\nDebugModelMatrixPrimitive.prototype.update = function (frameState) {\n  if (!this.show) {\n    return;\n  }\n\n  if (\n    !defined(this._primitive) ||\n    !Matrix4.equals(this._modelMatrix, this.modelMatrix) ||\n    this._length !== this.length ||\n    this._width !== this.width ||\n    this._id !== this.id\n  ) {\n    this._modelMatrix = Matrix4.clone(this.modelMatrix, this._modelMatrix);\n    this._length = this.length;\n    this._width = this.width;\n    this._id = this.id;\n\n    if (defined(this._primitive)) {\n      this._primitive.destroy();\n    }\n\n    // Workaround projecting (0, 0, 0)\n    if (\n      this.modelMatrix[12] === 0.0 &&\n      this.modelMatrix[13] === 0.0 &&\n      this.modelMatrix[14] === 0.0\n    ) {\n      this.modelMatrix[14] = 0.01;\n    }\n\n    const x = new GeometryInstance({\n      geometry: new PolylineGeometry({\n        positions: [Cartesian3.ZERO, Cartesian3.UNIT_X],\n        width: this.width,\n        vertexFormat: PolylineColorAppearance.VERTEX_FORMAT,\n        colors: [Color.RED, Color.RED],\n        arcType: ArcType.NONE,\n      }),\n      modelMatrix: Matrix4.multiplyByUniformScale(\n        this.modelMatrix,\n        this.length,\n        new Matrix4()\n      ),\n      id: this.id,\n      pickPrimitive: this,\n    });\n    const y = new GeometryInstance({\n      geometry: new PolylineGeometry({\n        positions: [Cartesian3.ZERO, Cartesian3.UNIT_Y],\n        width: this.width,\n        vertexFormat: PolylineColorAppearance.VERTEX_FORMAT,\n        colors: [Color.GREEN, Color.GREEN],\n        arcType: ArcType.NONE,\n      }),\n      modelMatrix: Matrix4.multiplyByUniformScale(\n        this.modelMatrix,\n        this.length,\n        new Matrix4()\n      ),\n      id: this.id,\n      pickPrimitive: this,\n    });\n    const z = new GeometryInstance({\n      geometry: new PolylineGeometry({\n        positions: [Cartesian3.ZERO, Cartesian3.UNIT_Z],\n        width: this.width,\n        vertexFormat: PolylineColorAppearance.VERTEX_FORMAT,\n        colors: [Color.BLUE, Color.BLUE],\n        arcType: ArcType.NONE,\n      }),\n      modelMatrix: Matrix4.multiplyByUniformScale(\n        this.modelMatrix,\n        this.length,\n        new Matrix4()\n      ),\n      id: this.id,\n      pickPrimitive: this,\n    });\n\n    this._primitive = new Primitive({\n      geometryInstances: [x, y, z],\n      appearance: new PolylineColorAppearance(),\n      asynchronous: false,\n    });\n  }\n\n  this._primitive.update(frameState);\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <p>\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n * </p>\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see DebugModelMatrixPrimitive#destroy\n */\nDebugModelMatrixPrimitive.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <p>\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n * </p>\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n * @example\n * p = p && p.destroy();\n *\n * @see DebugModelMatrixPrimitive#isDestroyed\n */\nDebugModelMatrixPrimitive.prototype.destroy = function () {\n  this._primitive = this._primitive && this._primitive.destroy();\n  return destroyObject(this);\n};\nexport default DebugModelMatrixPrimitive;\n","import WebGLConstants from \"../Core/WebGLConstants.js\";\n\n/**\n * Determines the function used to compare two depths for the depth test.\n *\n * @enum {Number}\n */\nconst DepthFunction = {\n  /**\n   * The depth test never passes.\n   *\n   * @type {Number}\n   * @constant\n   */\n  NEVER: WebGLConstants.NEVER,\n\n  /**\n   * The depth test passes if the incoming depth is less than the stored depth.\n   *\n   * @type {Number}\n   * @constant\n   */\n  LESS: WebGLConstants.LESS,\n\n  /**\n   * The depth test passes if the incoming depth is equal to the stored depth.\n   *\n   * @type {Number}\n   * @constant\n   */\n  EQUAL: WebGLConstants.EQUAL,\n\n  /**\n   * The depth test passes if the incoming depth is less than or equal to the stored depth.\n   *\n   * @type {Number}\n   * @constant\n   */\n  LESS_OR_EQUAL: WebGLConstants.LEQUAL,\n\n  /**\n   * The depth test passes if the incoming depth is greater than the stored depth.\n   *\n   * @type {Number}\n   * @constant\n   */\n  GREATER: WebGLConstants.GREATER,\n\n  /**\n   * The depth test passes if the incoming depth is not equal to the stored depth.\n   *\n   * @type {Number}\n   * @constant\n   */\n  NOT_EQUAL: WebGLConstants.NOTEQUAL,\n\n  /**\n   * The depth test passes if the incoming depth is greater than or equal to the stored depth.\n   *\n   * @type {Number}\n   * @constant\n   */\n  GREATER_OR_EQUAL: WebGLConstants.GEQUAL,\n\n  /**\n   * The depth test always passes.\n   *\n   * @type {Number}\n   * @constant\n   */\n  ALWAYS: WebGLConstants.ALWAYS,\n};\nexport default Object.freeze(DepthFunction);\n","import BoundingSphere from \"../Core/BoundingSphere.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport ComponentDatatype from \"../Core/ComponentDatatype.js\";\nimport defined from \"../Core/defined.js\";\nimport FeatureDetection from \"../Core/FeatureDetection.js\";\nimport Geometry from \"../Core/Geometry.js\";\nimport GeometryAttribute from \"../Core/GeometryAttribute.js\";\nimport OrthographicFrustum from \"../Core/OrthographicFrustum.js\";\nimport PrimitiveType from \"../Core/PrimitiveType.js\";\nimport BufferUsage from \"../Renderer/BufferUsage.js\";\nimport DrawCommand from \"../Renderer/DrawCommand.js\";\nimport Pass from \"../Renderer/Pass.js\";\nimport RenderState from \"../Renderer/RenderState.js\";\nimport ShaderProgram from \"../Renderer/ShaderProgram.js\";\nimport ShaderSource from \"../Renderer/ShaderSource.js\";\nimport VertexArray from \"../Renderer/VertexArray.js\";\nimport DepthPlaneFS from \"../Shaders/DepthPlaneFS.js\";\nimport DepthPlaneVS from \"../Shaders/DepthPlaneVS.js\";\nimport SceneMode from \"./SceneMode.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport Ellipsoid from \"../Core/Ellipsoid.js\";\n\n/**\n * @private\n */\nfunction DepthPlane(depthPlaneEllipsoidOffset) {\n  this._rs = undefined;\n  this._sp = undefined;\n  this._va = undefined;\n  this._command = undefined;\n  this._mode = undefined;\n  this._useLogDepth = false;\n  this._ellipsoidOffset = defaultValue(depthPlaneEllipsoidOffset, 0);\n}\n\nconst depthQuadScratch = FeatureDetection.supportsTypedArrays()\n  ? new Float32Array(12)\n  : [];\nconst scratchCartesian1 = new Cartesian3();\nconst scratchCartesian2 = new Cartesian3();\nconst scratchCartesian3 = new Cartesian3();\nconst scratchCartesian4 = new Cartesian3();\nconst scratchCartesian5 = new Cartesian3();\n\nfunction computeDepthQuad(ellipsoid, frameState) {\n  const radii = ellipsoid.radii;\n  const camera = frameState.camera;\n  let center, eastOffset, northOffset;\n\n  if (camera.frustum instanceof OrthographicFrustum) {\n    center = Cartesian3.ZERO;\n    eastOffset = camera.rightWC;\n    northOffset = camera.upWC;\n  } else {\n    const p = camera.positionWC;\n\n    // Find the corresponding position in the scaled space of the ellipsoid.\n    const q = Cartesian3.multiplyComponents(\n      ellipsoid.oneOverRadii,\n      p,\n      scratchCartesian1\n    );\n\n    const qUnit = Cartesian3.normalize(q, scratchCartesian2);\n\n    // Determine the east and north directions at q.\n    const eUnit = Cartesian3.normalize(\n      Cartesian3.cross(Cartesian3.UNIT_Z, q, scratchCartesian3),\n      scratchCartesian3\n    );\n    const nUnit = Cartesian3.normalize(\n      Cartesian3.cross(qUnit, eUnit, scratchCartesian4),\n      scratchCartesian4\n    );\n\n    const qMagnitude = Cartesian3.magnitude(q);\n\n    // Determine the radius of the 'limb' of the ellipsoid.\n    const wMagnitude = Math.sqrt(qMagnitude * qMagnitude - 1.0);\n\n    // Compute the center and offsets.\n    center = Cartesian3.multiplyByScalar(\n      qUnit,\n      1.0 / qMagnitude,\n      scratchCartesian1\n    );\n    const scalar = wMagnitude / qMagnitude;\n    eastOffset = Cartesian3.multiplyByScalar(eUnit, scalar, scratchCartesian2);\n    northOffset = Cartesian3.multiplyByScalar(nUnit, scalar, scratchCartesian3);\n  }\n\n  // A conservative measure for the longitudes would be to use the min/max longitudes of the bounding frustum.\n  const upperLeft = Cartesian3.add(center, northOffset, scratchCartesian5);\n  Cartesian3.subtract(upperLeft, eastOffset, upperLeft);\n  Cartesian3.multiplyComponents(radii, upperLeft, upperLeft);\n  Cartesian3.pack(upperLeft, depthQuadScratch, 0);\n\n  const lowerLeft = Cartesian3.subtract(center, northOffset, scratchCartesian5);\n  Cartesian3.subtract(lowerLeft, eastOffset, lowerLeft);\n  Cartesian3.multiplyComponents(radii, lowerLeft, lowerLeft);\n  Cartesian3.pack(lowerLeft, depthQuadScratch, 3);\n\n  const upperRight = Cartesian3.add(center, northOffset, scratchCartesian5);\n  Cartesian3.add(upperRight, eastOffset, upperRight);\n  Cartesian3.multiplyComponents(radii, upperRight, upperRight);\n  Cartesian3.pack(upperRight, depthQuadScratch, 6);\n\n  const lowerRight = Cartesian3.subtract(\n    center,\n    northOffset,\n    scratchCartesian5\n  );\n  Cartesian3.add(lowerRight, eastOffset, lowerRight);\n  Cartesian3.multiplyComponents(radii, lowerRight, lowerRight);\n  Cartesian3.pack(lowerRight, depthQuadScratch, 9);\n\n  return depthQuadScratch;\n}\n\nDepthPlane.prototype.update = function (frameState) {\n  this._mode = frameState.mode;\n  if (frameState.mode !== SceneMode.SCENE3D) {\n    return;\n  }\n\n  const context = frameState.context;\n\n  // Allow offsetting the ellipsoid radius to address rendering artefacts below ellipsoid zero elevation.\n  const radii = frameState.mapProjection.ellipsoid.radii;\n  const ellipsoid = new Ellipsoid(\n    radii.x + this._ellipsoidOffset,\n    radii.y + this._ellipsoidOffset,\n    radii.z + this._ellipsoidOffset\n  );\n\n  const useLogDepth = frameState.useLogDepth;\n\n  if (!defined(this._command)) {\n    this._rs = RenderState.fromCache({\n      // Write depth, not color\n      cull: {\n        enabled: true,\n      },\n      depthTest: {\n        enabled: true,\n      },\n      colorMask: {\n        red: false,\n        green: false,\n        blue: false,\n        alpha: false,\n      },\n    });\n\n    this._command = new DrawCommand({\n      renderState: this._rs,\n      boundingVolume: new BoundingSphere(\n        Cartesian3.ZERO,\n        ellipsoid.maximumRadius\n      ),\n      pass: Pass.OPAQUE,\n      owner: this,\n    });\n  }\n\n  if (!defined(this._sp) || this._useLogDepth !== useLogDepth) {\n    this._useLogDepth = useLogDepth;\n\n    const vs = new ShaderSource({\n      sources: [DepthPlaneVS],\n    });\n    const fs = new ShaderSource({\n      sources: [DepthPlaneFS],\n    });\n    if (useLogDepth) {\n      const extension =\n        \"#ifdef GL_EXT_frag_depth \\n\" +\n        \"#extension GL_EXT_frag_depth : enable \\n\" +\n        \"#endif \\n\\n\";\n\n      fs.sources.push(extension);\n      fs.defines.push(\"LOG_DEPTH\");\n      vs.defines.push(\"LOG_DEPTH\");\n    }\n\n    this._sp = ShaderProgram.replaceCache({\n      shaderProgram: this._sp,\n      context: context,\n      vertexShaderSource: vs,\n      fragmentShaderSource: fs,\n      attributeLocations: {\n        position: 0,\n      },\n    });\n\n    this._command.shaderProgram = this._sp;\n  }\n\n  // update depth plane\n  const depthQuad = computeDepthQuad(ellipsoid, frameState);\n\n  // depth plane\n  if (!defined(this._va)) {\n    const geometry = new Geometry({\n      attributes: {\n        position: new GeometryAttribute({\n          componentDatatype: ComponentDatatype.FLOAT,\n          componentsPerAttribute: 3,\n          values: depthQuad,\n        }),\n      },\n      indices: [0, 1, 2, 2, 1, 3],\n      primitiveType: PrimitiveType.TRIANGLES,\n    });\n\n    this._va = VertexArray.fromGeometry({\n      context: context,\n      geometry: geometry,\n      attributeLocations: {\n        position: 0,\n      },\n      bufferUsage: BufferUsage.DYNAMIC_DRAW,\n    });\n\n    this._command.vertexArray = this._va;\n  } else {\n    this._va.getAttribute(0).vertexBuffer.copyFromArrayView(depthQuad);\n  }\n};\n\nDepthPlane.prototype.execute = function (context, passState) {\n  if (this._mode === SceneMode.SCENE3D) {\n    this._command.execute(context, passState);\n  }\n};\n\nDepthPlane.prototype.isDestroyed = function () {\n  return false;\n};\n\nDepthPlane.prototype.destroy = function () {\n  this._sp = this._sp && this._sp.destroy();\n  this._va = this._va && this._va.destroy();\n};\nexport default DepthPlane;\n","import defined from \"../Core/defined.js\";\nimport DrawCommand from \"../Renderer/DrawCommand.js\";\nimport RenderState from \"../Renderer/RenderState.js\";\nimport ShaderSource from \"../Renderer/ShaderSource.js\";\n\n/**\n * @private\n */\nfunction DerivedCommand() {}\n\nconst fragDepthRegex = /\\bgl_FragDepthEXT\\b/;\nconst discardRegex = /\\bdiscard\\b/;\n\nfunction getDepthOnlyShaderProgram(context, shaderProgram) {\n  let shader = context.shaderCache.getDerivedShaderProgram(\n    shaderProgram,\n    \"depthOnly\"\n  );\n  if (!defined(shader)) {\n    const attributeLocations = shaderProgram._attributeLocations;\n    let fs = shaderProgram.fragmentShaderSource;\n\n    let i;\n    let writesDepthOrDiscards = false;\n    const sources = fs.sources;\n    let length = sources.length;\n    for (i = 0; i < length; ++i) {\n      if (fragDepthRegex.test(sources[i]) || discardRegex.test(sources[i])) {\n        writesDepthOrDiscards = true;\n        break;\n      }\n    }\n\n    let usesLogDepth = false;\n    const defines = fs.defines;\n    length = defines.length;\n    for (i = 0; i < length; ++i) {\n      if (defines[i] === \"LOG_DEPTH\") {\n        usesLogDepth = true;\n        break;\n      }\n    }\n\n    let source;\n    if (!writesDepthOrDiscards && !usesLogDepth) {\n      source =\n        \"void main() \\n\" + \"{ \\n\" + \"    gl_FragColor = vec4(1.0); \\n\" + \"} \\n\";\n      fs = new ShaderSource({\n        sources: [source],\n      });\n    } else if (!writesDepthOrDiscards && usesLogDepth) {\n      source =\n        \"#ifdef GL_EXT_frag_depth \\n\" +\n        \"#extension GL_EXT_frag_depth : enable \\n\" +\n        \"#endif \\n\\n\" +\n        \"void main() \\n\" +\n        \"{ \\n\" +\n        \"    gl_FragColor = vec4(1.0); \\n\" +\n        \"    czm_writeLogDepth(); \\n\" +\n        \"} \\n\";\n      fs = new ShaderSource({\n        defines: [\"LOG_DEPTH\"],\n        sources: [source],\n      });\n    }\n\n    shader = context.shaderCache.createDerivedShaderProgram(\n      shaderProgram,\n      \"depthOnly\",\n      {\n        vertexShaderSource: shaderProgram.vertexShaderSource,\n        fragmentShaderSource: fs,\n        attributeLocations: attributeLocations,\n      }\n    );\n  }\n\n  return shader;\n}\n\nfunction getDepthOnlyRenderState(scene, renderState) {\n  const cache = scene._depthOnlyRenderStateCache;\n  let depthOnlyState = cache[renderState.id];\n  if (!defined(depthOnlyState)) {\n    const rs = RenderState.getState(renderState);\n    rs.depthMask = true;\n    rs.colorMask = {\n      red: false,\n      green: false,\n      blue: false,\n      alpha: false,\n    };\n\n    depthOnlyState = RenderState.fromCache(rs);\n    cache[renderState.id] = depthOnlyState;\n  }\n\n  return depthOnlyState;\n}\n\nDerivedCommand.createDepthOnlyDerivedCommand = function (\n  scene,\n  command,\n  context,\n  result\n) {\n  // For a depth only pass, we bind a framebuffer with only a depth attachment (no color attachments),\n  // do not write color, and write depth. If the fragment shader doesn't modify the fragment depth\n  // or discard, the driver can replace the fragment shader with a pass-through shader. We're unsure if this\n  // actually happens so we modify the shader to use a pass-through fragment shader.\n\n  if (!defined(result)) {\n    result = {};\n  }\n\n  let shader;\n  let renderState;\n  if (defined(result.depthOnlyCommand)) {\n    shader = result.depthOnlyCommand.shaderProgram;\n    renderState = result.depthOnlyCommand.renderState;\n  }\n\n  result.depthOnlyCommand = DrawCommand.shallowClone(\n    command,\n    result.depthOnlyCommand\n  );\n\n  if (!defined(shader) || result.shaderProgramId !== command.shaderProgram.id) {\n    result.depthOnlyCommand.shaderProgram = getDepthOnlyShaderProgram(\n      context,\n      command.shaderProgram\n    );\n    result.depthOnlyCommand.renderState = getDepthOnlyRenderState(\n      scene,\n      command.renderState\n    );\n    result.shaderProgramId = command.shaderProgram.id;\n  } else {\n    result.depthOnlyCommand.shaderProgram = shader;\n    result.depthOnlyCommand.renderState = renderState;\n  }\n\n  return result;\n};\n\nconst writeLogDepthRegex = /\\s+czm_writeLogDepth\\(/;\nconst vertexlogDepthRegex = /\\s+czm_vertexLogDepth\\(/;\nconst extensionRegex = /\\s*#extension\\s+GL_EXT_frag_depth\\s*:\\s*enable/;\n\nfunction getLogDepthShaderProgram(context, shaderProgram) {\n  let shader = context.shaderCache.getDerivedShaderProgram(\n    shaderProgram,\n    \"logDepth\"\n  );\n  if (!defined(shader)) {\n    const attributeLocations = shaderProgram._attributeLocations;\n    const vs = shaderProgram.vertexShaderSource.clone();\n    const fs = shaderProgram.fragmentShaderSource.clone();\n\n    vs.defines = defined(vs.defines) ? vs.defines.slice(0) : [];\n    vs.defines.push(\"LOG_DEPTH\");\n    fs.defines = defined(fs.defines) ? fs.defines.slice(0) : [];\n    fs.defines.push(\"LOG_DEPTH\");\n\n    let i;\n    let logMain;\n    let writesLogDepth = false;\n    let sources = vs.sources;\n    let length = sources.length;\n    for (i = 0; i < length; ++i) {\n      if (vertexlogDepthRegex.test(sources[i])) {\n        writesLogDepth = true;\n        break;\n      }\n    }\n\n    if (!writesLogDepth) {\n      for (i = 0; i < length; ++i) {\n        sources[i] = ShaderSource.replaceMain(sources[i], \"czm_log_depth_main\");\n      }\n\n      logMain =\n        \"\\n\\n\" +\n        \"void main() \\n\" +\n        \"{ \\n\" +\n        \"    czm_log_depth_main(); \\n\" +\n        \"    czm_vertexLogDepth(); \\n\" +\n        \"} \\n\";\n      sources.push(logMain);\n    }\n\n    sources = fs.sources;\n    length = sources.length;\n\n    writesLogDepth = false;\n    for (i = 0; i < length; ++i) {\n      if (writeLogDepthRegex.test(sources[i])) {\n        writesLogDepth = true;\n      }\n    }\n    // This define indicates that a log depth value is written by the shader but doesn't use czm_writeLogDepth.\n    if (fs.defines.indexOf(\"LOG_DEPTH_WRITE\") !== -1) {\n      writesLogDepth = true;\n    }\n\n    let addExtension = true;\n    for (i = 0; i < length; ++i) {\n      if (extensionRegex.test(sources[i])) {\n        addExtension = false;\n      }\n    }\n\n    let logSource = \"\";\n    if (addExtension) {\n      logSource +=\n        \"#ifdef GL_EXT_frag_depth \\n\" +\n        \"#extension GL_EXT_frag_depth : enable \\n\" +\n        \"#endif \\n\\n\";\n    }\n\n    if (!writesLogDepth) {\n      for (i = 0; i < length; i++) {\n        sources[i] = ShaderSource.replaceMain(sources[i], \"czm_log_depth_main\");\n      }\n\n      logSource +=\n        \"\\n\" +\n        \"void main() \\n\" +\n        \"{ \\n\" +\n        \"    czm_log_depth_main(); \\n\" +\n        \"    czm_writeLogDepth(); \\n\" +\n        \"} \\n\";\n    }\n\n    sources.push(logSource);\n\n    shader = context.shaderCache.createDerivedShaderProgram(\n      shaderProgram,\n      \"logDepth\",\n      {\n        vertexShaderSource: vs,\n        fragmentShaderSource: fs,\n        attributeLocations: attributeLocations,\n      }\n    );\n  }\n\n  return shader;\n}\n\nDerivedCommand.createLogDepthCommand = function (command, context, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n\n  let shader;\n  if (defined(result.command)) {\n    shader = result.command.shaderProgram;\n  }\n\n  result.command = DrawCommand.shallowClone(command, result.command);\n\n  if (!defined(shader) || result.shaderProgramId !== command.shaderProgram.id) {\n    result.command.shaderProgram = getLogDepthShaderProgram(\n      context,\n      command.shaderProgram\n    );\n    result.shaderProgramId = command.shaderProgram.id;\n  } else {\n    result.command.shaderProgram = shader;\n  }\n\n  return result;\n};\n\nfunction getPickShaderProgram(context, shaderProgram, pickId) {\n  let shader = context.shaderCache.getDerivedShaderProgram(\n    shaderProgram,\n    \"pick\"\n  );\n  if (!defined(shader)) {\n    const attributeLocations = shaderProgram._attributeLocations;\n    let fs = shaderProgram.fragmentShaderSource;\n\n    const sources = fs.sources;\n    const length = sources.length;\n\n    const newMain =\n      `${\n        \"void main() \\n\" +\n        \"{ \\n\" +\n        \"    czm_non_pick_main(); \\n\" +\n        \"    if (gl_FragColor.a == 0.0) { \\n\" +\n        \"        discard; \\n\" +\n        \"    } \\n\" +\n        \"    gl_FragColor = \"\n      }${pickId}; \\n` + `} \\n`;\n    const newSources = new Array(length + 1);\n    for (let i = 0; i < length; ++i) {\n      newSources[i] = ShaderSource.replaceMain(sources[i], \"czm_non_pick_main\");\n    }\n    newSources[length] = newMain;\n    fs = new ShaderSource({\n      sources: newSources,\n      defines: fs.defines,\n    });\n    shader = context.shaderCache.createDerivedShaderProgram(\n      shaderProgram,\n      \"pick\",\n      {\n        vertexShaderSource: shaderProgram.vertexShaderSource,\n        fragmentShaderSource: fs,\n        attributeLocations: attributeLocations,\n      }\n    );\n  }\n\n  return shader;\n}\n\nfunction getPickRenderState(scene, renderState) {\n  const cache = scene.picking.pickRenderStateCache;\n  let pickState = cache[renderState.id];\n  if (!defined(pickState)) {\n    const rs = RenderState.getState(renderState);\n    rs.blending.enabled = false;\n\n    // Turns on depth writing for opaque and translucent passes\n    // Overlapping translucent geometry on the globe surface may exhibit z-fighting\n    // during the pick pass which may not match the rendered scene. Once\n    // terrain is on by default and ground primitives are used instead\n    // this will become less of a problem.\n    rs.depthMask = true;\n\n    pickState = RenderState.fromCache(rs);\n    cache[renderState.id] = pickState;\n  }\n\n  return pickState;\n}\n\nDerivedCommand.createPickDerivedCommand = function (\n  scene,\n  command,\n  context,\n  result\n) {\n  if (!defined(result)) {\n    result = {};\n  }\n\n  let shader;\n  let renderState;\n  if (defined(result.pickCommand)) {\n    shader = result.pickCommand.shaderProgram;\n    renderState = result.pickCommand.renderState;\n  }\n\n  result.pickCommand = DrawCommand.shallowClone(command, result.pickCommand);\n\n  if (!defined(shader) || result.shaderProgramId !== command.shaderProgram.id) {\n    result.pickCommand.shaderProgram = getPickShaderProgram(\n      context,\n      command.shaderProgram,\n      command.pickId\n    );\n    result.pickCommand.renderState = getPickRenderState(\n      scene,\n      command.renderState\n    );\n    result.shaderProgramId = command.shaderProgram.id;\n  } else {\n    result.pickCommand.shaderProgram = shader;\n    result.pickCommand.renderState = renderState;\n  }\n\n  return result;\n};\n\nfunction getHdrShaderProgram(context, shaderProgram) {\n  let shader = context.shaderCache.getDerivedShaderProgram(\n    shaderProgram,\n    \"HDR\"\n  );\n  if (!defined(shader)) {\n    const attributeLocations = shaderProgram._attributeLocations;\n    const vs = shaderProgram.vertexShaderSource.clone();\n    const fs = shaderProgram.fragmentShaderSource.clone();\n\n    vs.defines = defined(vs.defines) ? vs.defines.slice(0) : [];\n    vs.defines.push(\"HDR\");\n    fs.defines = defined(fs.defines) ? fs.defines.slice(0) : [];\n    fs.defines.push(\"HDR\");\n\n    shader = context.shaderCache.createDerivedShaderProgram(\n      shaderProgram,\n      \"HDR\",\n      {\n        vertexShaderSource: vs,\n        fragmentShaderSource: fs,\n        attributeLocations: attributeLocations,\n      }\n    );\n  }\n\n  return shader;\n}\n\nDerivedCommand.createHdrCommand = function (command, context, result) {\n  if (!defined(result)) {\n    result = {};\n  }\n\n  let shader;\n  if (defined(result.command)) {\n    shader = result.command.shaderProgram;\n  }\n\n  result.command = DrawCommand.shallowClone(command, result.command);\n\n  if (!defined(shader) || result.shaderProgramId !== command.shaderProgram.id) {\n    result.command.shaderProgram = getHdrShaderProgram(\n      context,\n      command.shaderProgram\n    );\n    result.shaderProgramId = command.shaderProgram.id;\n  } else {\n    result.command.shaderProgram = shader;\n  }\n\n  return result;\n};\nexport default DerivedCommand;\n","import defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport Matrix3 from \"../Core/Matrix3.js\";\nimport Quaternion from \"../Core/Quaternion.js\";\n\n/**\n * @private\n */\nfunction DeviceOrientationCameraController(scene) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(scene)) {\n    throw new DeveloperError(\"scene is required.\");\n  }\n  //>>includeEnd('debug');\n\n  this._scene = scene;\n\n  this._lastAlpha = undefined;\n  this._lastBeta = undefined;\n  this._lastGamma = undefined;\n\n  this._alpha = undefined;\n  this._beta = undefined;\n  this._gamma = undefined;\n\n  const that = this;\n\n  function callback(e) {\n    const alpha = e.alpha;\n    if (!defined(alpha)) {\n      that._alpha = undefined;\n      that._beta = undefined;\n      that._gamma = undefined;\n      return;\n    }\n\n    that._alpha = CesiumMath.toRadians(alpha);\n    that._beta = CesiumMath.toRadians(e.beta);\n    that._gamma = CesiumMath.toRadians(e.gamma);\n  }\n\n  window.addEventListener(\"deviceorientation\", callback, false);\n\n  this._removeListener = function () {\n    window.removeEventListener(\"deviceorientation\", callback, false);\n  };\n}\n\nconst scratchQuaternion1 = new Quaternion();\nconst scratchQuaternion2 = new Quaternion();\nconst scratchMatrix3 = new Matrix3();\n\nfunction rotate(camera, alpha, beta, gamma) {\n  const direction = camera.direction;\n  const right = camera.right;\n  const up = camera.up;\n\n  const bQuat = Quaternion.fromAxisAngle(direction, beta, scratchQuaternion2);\n  const gQuat = Quaternion.fromAxisAngle(right, gamma, scratchQuaternion1);\n\n  const rotQuat = Quaternion.multiply(gQuat, bQuat, gQuat);\n\n  const aQuat = Quaternion.fromAxisAngle(up, alpha, scratchQuaternion2);\n  Quaternion.multiply(aQuat, rotQuat, rotQuat);\n\n  const matrix = Matrix3.fromQuaternion(rotQuat, scratchMatrix3);\n  Matrix3.multiplyByVector(matrix, right, right);\n  Matrix3.multiplyByVector(matrix, up, up);\n  Matrix3.multiplyByVector(matrix, direction, direction);\n}\n\nDeviceOrientationCameraController.prototype.update = function () {\n  if (!defined(this._alpha)) {\n    return;\n  }\n\n  if (!defined(this._lastAlpha)) {\n    this._lastAlpha = this._alpha;\n    this._lastBeta = this._beta;\n    this._lastGamma = this._gamma;\n  }\n\n  const a = this._lastAlpha - this._alpha;\n  const b = this._lastBeta - this._beta;\n  const g = this._lastGamma - this._gamma;\n\n  rotate(this._scene.camera, -a, b, g);\n\n  this._lastAlpha = this._alpha;\n  this._lastBeta = this._beta;\n  this._lastGamma = this._gamma;\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n */\nDeviceOrientationCameraController.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the resources held by this object.  Destroying an object allows for deterministic\n * release of resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n */\nDeviceOrientationCameraController.prototype.destroy = function () {\n  this._removeListener();\n  return destroyObject(this);\n};\nexport default DeviceOrientationCameraController;\n","import Cartesian3 from \"../Core/Cartesian3.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\n\n/**\n * A light that gets emitted in a single direction from infinitely far away.\n *\n * @param {Object} options Object with the following properties:\n * @param {Cartesian3} options.direction The direction in which light gets emitted.\n * @param {Color} [options.color=Color.WHITE] The color of the light.\n * @param {Number} [options.intensity=1.0] The intensity of the light.\n *\n * @exception {DeveloperError} options.direction cannot be zero-length\n *\n * @alias DirectionalLight\n * @constructor\n */\nfunction DirectionalLight(options) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.object(\"options\", options);\n  Check.typeOf.object(\"options.direction\", options.direction);\n  if (Cartesian3.equals(options.direction, Cartesian3.ZERO)) {\n    throw new DeveloperError(\"options.direction cannot be zero-length\");\n  }\n  //>>includeEnd('debug');\n\n  /**\n   * The direction in which light gets emitted.\n   * @type {Cartesian3}\n   */\n  this.direction = Cartesian3.clone(options.direction);\n\n  /**\n   * The color of the light.\n   * @type {Color}\n   * @default Color.WHITE\n   */\n  this.color = Color.clone(defaultValue(options.color, Color.WHITE));\n\n  /**\n   * The intensity of the light.\n   * @type {Number}\n   * @default 1.0\n   */\n  this.intensity = defaultValue(options.intensity, 1.0);\n}\n\nexport default DirectionalLight;\n","import defined from \"../Core/defined.js\";\n\n/**\n * A policy for discarding tile images that contain no data (and so aren't actually images).\n * This policy discards {@link DiscardEmptyTileImagePolicy.EMPTY_IMAGE}, which is\n * expected to be used in place of any empty tile images by the image loading code.\n *\n * @alias DiscardEmptyTileImagePolicy\n * @constructor\n *\n * @see DiscardMissingTileImagePolicy\n */\nfunction DiscardEmptyTileImagePolicy(options) {}\n\n/**\n * Determines if the discard policy is ready to process images.\n * @returns {Boolean} True if the discard policy is ready to process images; otherwise, false.\n */\nDiscardEmptyTileImagePolicy.prototype.isReady = function () {\n  return true;\n};\n\n/**\n * Given a tile image, decide whether to discard that image.\n *\n * @param {HTMLImageElement} image An image to test.\n * @returns {Boolean} True if the image should be discarded; otherwise, false.\n */\nDiscardEmptyTileImagePolicy.prototype.shouldDiscardImage = function (image) {\n  return DiscardEmptyTileImagePolicy.EMPTY_IMAGE === image;\n};\n\nlet emptyImage;\n\nObject.defineProperties(DiscardEmptyTileImagePolicy, {\n  /**\n   * Default value for representing an empty image.\n   * @type {HTMLImageElement}\n   * @readonly\n   * @memberof DiscardEmptyTileImagePolicy\n   */\n  EMPTY_IMAGE: {\n    get: function () {\n      if (!defined(emptyImage)) {\n        emptyImage = new Image();\n        // load a blank data URI with a 1x1 transparent pixel.\n        emptyImage.src =\n          \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\";\n      }\n      return emptyImage;\n    },\n  },\n});\nexport default DiscardEmptyTileImagePolicy;\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport getImagePixels from \"../Core/getImagePixels.js\";\nimport Resource from \"../Core/Resource.js\";\n\n/**\n * A policy for discarding tile images that match a known image containing a\n * \"missing\" image.\n *\n * @alias DiscardMissingTileImagePolicy\n * @constructor\n *\n * @param {Object} options Object with the following properties:\n * @param {Resource|String} options.missingImageUrl The URL of the known missing image.\n * @param {Cartesian2[]} options.pixelsToCheck An array of {@link Cartesian2} pixel positions to\n *        compare against the missing image.\n * @param {Boolean} [options.disableCheckIfAllPixelsAreTransparent=false] If true, the discard check will be disabled\n *                  if all of the pixelsToCheck in the missingImageUrl have an alpha value of 0.  If false, the\n *                  discard check will proceed no matter the values of the pixelsToCheck.\n */\nfunction DiscardMissingTileImagePolicy(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(options.missingImageUrl)) {\n    throw new DeveloperError(\"options.missingImageUrl is required.\");\n  }\n\n  if (!defined(options.pixelsToCheck)) {\n    throw new DeveloperError(\"options.pixelsToCheck is required.\");\n  }\n  //>>includeEnd('debug');\n\n  this._pixelsToCheck = options.pixelsToCheck;\n  this._missingImagePixels = undefined;\n  this._missingImageByteLength = undefined;\n  this._isReady = false;\n\n  const resource = Resource.createIfNeeded(options.missingImageUrl);\n\n  const that = this;\n\n  function success(image) {\n    if (defined(image.blob)) {\n      that._missingImageByteLength = image.blob.size;\n    }\n\n    let pixels = getImagePixels(image);\n\n    if (options.disableCheckIfAllPixelsAreTransparent) {\n      let allAreTransparent = true;\n      const width = image.width;\n\n      const pixelsToCheck = options.pixelsToCheck;\n      for (\n        let i = 0, len = pixelsToCheck.length;\n        allAreTransparent && i < len;\n        ++i\n      ) {\n        const pos = pixelsToCheck[i];\n        const index = pos.x * 4 + pos.y * width;\n        const alpha = pixels[index + 3];\n\n        if (alpha > 0) {\n          allAreTransparent = false;\n        }\n      }\n\n      if (allAreTransparent) {\n        pixels = undefined;\n      }\n    }\n\n    that._missingImagePixels = pixels;\n    that._isReady = true;\n  }\n\n  function failure() {\n    // Failed to download \"missing\" image, so assume that any truly missing tiles\n    // will also fail to download and disable the discard check.\n    that._missingImagePixels = undefined;\n    that._isReady = true;\n  }\n\n  resource\n    .fetchImage({\n      preferBlob: true,\n      preferImageBitmap: true,\n      flipY: true,\n    })\n    .then(success)\n    .catch(failure);\n}\n\n/**\n * Determines if the discard policy is ready to process images.\n * @returns {Boolean} True if the discard policy is ready to process images; otherwise, false.\n */\nDiscardMissingTileImagePolicy.prototype.isReady = function () {\n  return this._isReady;\n};\n\n/**\n * Given a tile image, decide whether to discard that image.\n *\n * @param {HTMLImageElement} image An image to test.\n * @returns {Boolean} True if the image should be discarded; otherwise, false.\n *\n * @exception {DeveloperError} <code>shouldDiscardImage</code> must not be called before the discard policy is ready.\n */\nDiscardMissingTileImagePolicy.prototype.shouldDiscardImage = function (image) {\n  //>>includeStart('debug', pragmas.debug);\n  if (!this._isReady) {\n    throw new DeveloperError(\n      \"shouldDiscardImage must not be called before the discard policy is ready.\"\n    );\n  }\n  //>>includeEnd('debug');\n\n  const pixelsToCheck = this._pixelsToCheck;\n  const missingImagePixels = this._missingImagePixels;\n\n  // If missingImagePixels is undefined, it indicates that the discard check has been disabled.\n  if (!defined(missingImagePixels)) {\n    return false;\n  }\n\n  if (defined(image.blob) && image.blob.size !== this._missingImageByteLength) {\n    return false;\n  }\n\n  const pixels = getImagePixels(image);\n  const width = image.width;\n\n  for (let i = 0, len = pixelsToCheck.length; i < len; ++i) {\n    const pos = pixelsToCheck[i];\n    const index = pos.x * 4 + pos.y * width;\n    for (let offset = 0; offset < 4; ++offset) {\n      const pixel = index + offset;\n      if (pixels[pixel] !== missingImagePixels[pixel]) {\n        return false;\n      }\n    }\n  }\n  return true;\n};\nexport default DiscardMissingTileImagePolicy;\n","import arraySlice from \"../Core/arraySlice.js\";\nimport ComponentDatatype from \"../Core/ComponentDatatype.js\";\nimport defined from \"../Core/defined.js\";\nimport FeatureDetection from \"../Core/FeatureDetection.js\";\nimport TaskProcessor from \"../Core/TaskProcessor.js\";\nimport ForEach from \"./GltfPipeline/ForEach.js\";\n\n/**\n * @private\n */\nfunction DracoLoader() {}\n\n// Maximum concurrency to use when decoding draco models\nDracoLoader._maxDecodingConcurrency = Math.max(\n  FeatureDetection.hardwareConcurrency - 1,\n  1\n);\n\n// Exposed for testing purposes\nDracoLoader._decoderTaskProcessor = undefined;\nDracoLoader._taskProcessorReady = false;\nDracoLoader._getDecoderTaskProcessor = function () {\n  if (!defined(DracoLoader._decoderTaskProcessor)) {\n    const processor = new TaskProcessor(\n      \"decodeDraco\",\n      DracoLoader._maxDecodingConcurrency\n    );\n    processor\n      .initWebAssemblyModule({\n        modulePath: \"ThirdParty/Workers/draco_decoder_nodejs.js\",\n        wasmBinaryFile: \"ThirdParty/draco_decoder.wasm\",\n      })\n      .then(function () {\n        DracoLoader._taskProcessorReady = true;\n      });\n    DracoLoader._decoderTaskProcessor = processor;\n  }\n\n  return DracoLoader._decoderTaskProcessor;\n};\n\n/**\n * Returns true if the model uses or requires KHR_draco_mesh_compression.\n *\n * @private\n */\nDracoLoader.hasExtension = function (model) {\n  return (\n    defined(model.extensionsRequired.KHR_draco_mesh_compression) ||\n    defined(model.extensionsUsed.KHR_draco_mesh_compression)\n  );\n};\n\nfunction addBufferToLoadResources(loadResources, typedArray) {\n  // Create a new id to differentiate from original glTF bufferViews\n  const bufferViewId = `runtime.${\n    Object.keys(loadResources.createdBufferViews).length\n  }`;\n\n  const loadResourceBuffers = loadResources.buffers;\n  const id = Object.keys(loadResourceBuffers).length;\n  loadResourceBuffers[id] = typedArray;\n  loadResources.createdBufferViews[bufferViewId] = {\n    buffer: id,\n    byteOffset: 0,\n    byteLength: typedArray.byteLength,\n  };\n\n  return bufferViewId;\n}\n\nfunction addNewVertexBuffer(typedArray, model, context) {\n  const loadResources = model._loadResources;\n  const id = addBufferToLoadResources(loadResources, typedArray);\n  loadResources.vertexBuffersToCreate.enqueue(id);\n  return id;\n}\n\nfunction addNewIndexBuffer(indexArray, model, context) {\n  const typedArray = indexArray.typedArray;\n  const loadResources = model._loadResources;\n  const id = addBufferToLoadResources(loadResources, typedArray);\n  loadResources.indexBuffersToCreate.enqueue({\n    id: id,\n    componentType: ComponentDatatype.fromTypedArray(typedArray),\n  });\n\n  return {\n    bufferViewId: id,\n    numberOfIndices: indexArray.numberOfIndices,\n  };\n}\n\nfunction scheduleDecodingTask(\n  decoderTaskProcessor,\n  model,\n  loadResources,\n  context\n) {\n  if (!DracoLoader._taskProcessorReady) {\n    // The task processor is not ready to schedule tasks\n    return;\n  }\n\n  const taskData = loadResources.primitivesToDecode.peek();\n  if (!defined(taskData)) {\n    // All primitives are processing\n    return;\n  }\n\n  const promise = decoderTaskProcessor.scheduleTask(taskData, [\n    taskData.array.buffer,\n  ]);\n  if (!defined(promise)) {\n    // Cannot schedule another task this frame\n    return;\n  }\n\n  loadResources.activeDecodingTasks++;\n  loadResources.primitivesToDecode.dequeue();\n  return promise.then(function (result) {\n    loadResources.activeDecodingTasks--;\n\n    const decodedIndexBuffer = addNewIndexBuffer(\n      result.indexArray,\n      model,\n      context\n    );\n\n    const attributes = {};\n    const decodedAttributeData = result.attributeData;\n    for (const attributeName in decodedAttributeData) {\n      if (decodedAttributeData.hasOwnProperty(attributeName)) {\n        const attribute = decodedAttributeData[attributeName];\n        const vertexArray = attribute.array;\n        const vertexBufferView = addNewVertexBuffer(\n          vertexArray,\n          model,\n          context\n        );\n\n        const data = attribute.data;\n        data.bufferView = vertexBufferView;\n\n        attributes[attributeName] = data;\n      }\n    }\n\n    model._decodedData[`${taskData.mesh}.primitive.${taskData.primitive}`] = {\n      bufferView: decodedIndexBuffer.bufferViewId,\n      numberOfIndices: decodedIndexBuffer.numberOfIndices,\n      attributes: attributes,\n    };\n  });\n}\n\nDracoLoader._decodedModelResourceCache = undefined;\n\n/**\n * Parses draco extension on model primitives and\n * adds the decoding data to the model's load resources.\n *\n * @private\n */\nDracoLoader.parse = function (model, context) {\n  if (!DracoLoader.hasExtension(model)) {\n    return;\n  }\n\n  const loadResources = model._loadResources;\n  const cacheKey = model.cacheKey;\n  if (defined(cacheKey)) {\n    if (!defined(DracoLoader._decodedModelResourceCache)) {\n      if (!defined(context.cache.modelDecodingCache)) {\n        context.cache.modelDecodingCache = {};\n      }\n\n      DracoLoader._decodedModelResourceCache = context.cache.modelDecodingCache;\n    }\n\n    // Decoded data for model will be loaded from cache\n    const cachedData = DracoLoader._decodedModelResourceCache[cacheKey];\n    if (defined(cachedData)) {\n      cachedData.count++;\n      loadResources.pendingDecodingCache = true;\n      return;\n    }\n  }\n\n  const dequantizeInShader = model._dequantizeInShader;\n  const gltf = model.gltfInternal;\n  ForEach.mesh(gltf, function (mesh, meshId) {\n    ForEach.meshPrimitive(mesh, function (primitive, primitiveId) {\n      if (!defined(primitive.extensions)) {\n        return;\n      }\n\n      const compressionData = primitive.extensions.KHR_draco_mesh_compression;\n      if (!defined(compressionData)) {\n        return;\n      }\n\n      const bufferView = gltf.bufferViews[compressionData.bufferView];\n      const typedArray = arraySlice(\n        gltf.buffers[bufferView.buffer].extras._pipeline.source,\n        bufferView.byteOffset,\n        bufferView.byteOffset + bufferView.byteLength\n      );\n      loadResources.primitivesToDecode.enqueue({\n        mesh: meshId,\n        primitive: primitiveId,\n        array: typedArray,\n        bufferView: bufferView,\n        compressedAttributes: compressionData.attributes,\n        dequantizeInShader: dequantizeInShader,\n      });\n    });\n  });\n};\n\n/**\n * Schedules decoding tasks available this frame.\n * @private\n */\nDracoLoader.decodeModel = function (model, context) {\n  if (!DracoLoader.hasExtension(model)) {\n    return Promise.resolve();\n  }\n\n  const loadResources = model._loadResources;\n  const cacheKey = model.cacheKey;\n  if (defined(cacheKey) && defined(DracoLoader._decodedModelResourceCache)) {\n    const cachedData = DracoLoader._decodedModelResourceCache[cacheKey];\n    // Load decoded data for model when cache is ready\n    if (defined(cachedData) && loadResources.pendingDecodingCache) {\n      return Promise.resolve(cachedData.ready).then(function () {\n        model._decodedData = cachedData.data;\n        loadResources.pendingDecodingCache = false;\n      });\n    }\n\n    // Decoded data for model should be cached when ready\n    DracoLoader._decodedModelResourceCache[cacheKey] = {\n      ready: false,\n      count: 1,\n      data: undefined,\n    };\n  }\n\n  if (loadResources.primitivesToDecode.length === 0) {\n    // No more tasks to schedule\n    return Promise.resolve();\n  }\n\n  const decoderTaskProcessor = DracoLoader._getDecoderTaskProcessor();\n  const decodingPromises = [];\n\n  let promise = scheduleDecodingTask(\n    decoderTaskProcessor,\n    model,\n    loadResources,\n    context\n  );\n  while (defined(promise)) {\n    decodingPromises.push(promise);\n    promise = scheduleDecodingTask(\n      decoderTaskProcessor,\n      model,\n      loadResources,\n      context\n    );\n  }\n\n  return Promise.all(decodingPromises);\n};\n\n/**\n * Decodes a compressed point cloud. Returns undefined if the task cannot be scheduled.\n * @private\n */\nDracoLoader.decodePointCloud = function (parameters) {\n  const decoderTaskProcessor = DracoLoader._getDecoderTaskProcessor();\n  if (!DracoLoader._taskProcessorReady) {\n    // The task processor is not ready to schedule tasks\n    return;\n  }\n  return decoderTaskProcessor.scheduleTask(parameters, [\n    parameters.buffer.buffer,\n  ]);\n};\n\n/**\n * Decodes a buffer view. Returns undefined if the task cannot be scheduled.\n *\n * @param {Object} options Object with the following properties:\n * @param {Uint8Array} options.array The typed array containing the buffer view data.\n * @param {Object} options.bufferView The glTF buffer view object.\n * @param {Object.<String, Number>} options.compressedAttributes The compressed attributes.\n * @param {Boolean} options.dequantizeInShader Whether POSITION and NORMAL attributes should be dequantized on the GPU.\n *\n * @returns {Promise} A promise that resolves to the decoded indices and attributes.\n * @private\n */\nDracoLoader.decodeBufferView = function (options) {\n  const decoderTaskProcessor = DracoLoader._getDecoderTaskProcessor();\n  if (!DracoLoader._taskProcessorReady) {\n    // The task processor is not ready to schedule tasks\n    return;\n  }\n\n  return decoderTaskProcessor.scheduleTask(options, [options.array.buffer]);\n};\n\n/**\n * Caches a models decoded data so it doesn't need to decode more than once.\n * @private\n */\nDracoLoader.cacheDataForModel = function (model) {\n  const cacheKey = model.cacheKey;\n  if (defined(cacheKey) && defined(DracoLoader._decodedModelResourceCache)) {\n    const cachedData = DracoLoader._decodedModelResourceCache[cacheKey];\n    if (defined(cachedData)) {\n      cachedData.ready = true;\n      cachedData.data = model._decodedData;\n    }\n  }\n};\n\n/**\n * Destroys the cached data that this model references if it is no longer in use.\n * @private\n */\nDracoLoader.destroyCachedDataForModel = function (model) {\n  const cacheKey = model.cacheKey;\n  if (defined(cacheKey) && defined(DracoLoader._decodedModelResourceCache)) {\n    const cachedData = DracoLoader._decodedModelResourceCache[cacheKey];\n    if (defined(cachedData) && --cachedData.count === 0) {\n      delete DracoLoader._decodedModelResourceCache[cacheKey];\n    }\n  }\n};\nexport default DracoLoader;\n","import BoundingSphere from \"../Core/BoundingSphere.js\";\nimport BoxGeometry from \"../Core/BoxGeometry.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport combine from \"../Core/combine.js\";\nimport defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport Matrix4 from \"../Core/Matrix4.js\";\nimport VertexFormat from \"../Core/VertexFormat.js\";\nimport BufferUsage from \"../Renderer/BufferUsage.js\";\nimport DrawCommand from \"../Renderer/DrawCommand.js\";\nimport Pass from \"../Renderer/Pass.js\";\nimport RenderState from \"../Renderer/RenderState.js\";\nimport ShaderProgram from \"../Renderer/ShaderProgram.js\";\nimport ShaderSource from \"../Renderer/ShaderSource.js\";\nimport VertexArray from \"../Renderer/VertexArray.js\";\nimport EllipsoidFS from \"../Shaders/EllipsoidFS.js\";\nimport EllipsoidVS from \"../Shaders/EllipsoidVS.js\";\nimport BlendingState from \"./BlendingState.js\";\nimport CullFace from \"./CullFace.js\";\nimport Material from \"./Material.js\";\nimport SceneMode from \"./SceneMode.js\";\n\nconst attributeLocations = {\n  position: 0,\n};\n\n/**\n * A renderable ellipsoid.  It can also draw spheres when the three {@link EllipsoidPrimitive#radii} components are equal.\n * <p>\n * This is only supported in 3D.  The ellipsoid is not shown in 2D or Columbus view.\n * </p>\n *\n * @alias EllipsoidPrimitive\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Cartesian3} [options.center=Cartesian3.ZERO] The center of the ellipsoid in the ellipsoid's model coordinates.\n * @param {Cartesian3} [options.radii] The radius of the ellipsoid along the <code>x</code>, <code>y</code>, and <code>z</code> axes in the ellipsoid's model coordinates.\n * @param {Matrix4} [options.modelMatrix=Matrix4.IDENTITY] The 4x4 transformation matrix that transforms the ellipsoid from model to world coordinates.\n * @param {Boolean} [options.show=true] Determines if this primitive will be shown.\n * @param {Material} [options.material=Material.ColorType] The surface appearance of the primitive.\n * @param {Object} [options.id] A user-defined object to return when the instance is picked with {@link Scene#pick}\n * @param {Boolean} [options.debugShowBoundingVolume=false] For debugging only. Determines if this primitive's commands' bounding spheres are shown.\n *\n * @private\n */\nfunction EllipsoidPrimitive(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  /**\n   * The center of the ellipsoid in the ellipsoid's model coordinates.\n   * <p>\n   * The default is {@link Cartesian3.ZERO}.\n   * </p>\n   *\n   * @type {Cartesian3}\n   * @default {@link Cartesian3.ZERO}\n   *\n   * @see EllipsoidPrimitive#modelMatrix\n   */\n  this.center = Cartesian3.clone(defaultValue(options.center, Cartesian3.ZERO));\n  this._center = new Cartesian3();\n\n  /**\n   * The radius of the ellipsoid along the <code>x</code>, <code>y</code>, and <code>z</code> axes in the ellipsoid's model coordinates.\n   * When these are the same, the ellipsoid is a sphere.\n   * <p>\n   * The default is <code>undefined</code>.  The ellipsoid is not drawn until a radii is provided.\n   * </p>\n   *\n   * @type {Cartesian3}\n   * @default undefined\n   *\n   *\n   * @example\n   * // A sphere with a radius of 2.0\n   * e.radii = new Cesium.Cartesian3(2.0, 2.0, 2.0);\n   *\n   * @see EllipsoidPrimitive#modelMatrix\n   */\n  this.radii = Cartesian3.clone(options.radii);\n  this._radii = new Cartesian3();\n\n  this._oneOverEllipsoidRadiiSquared = new Cartesian3();\n  this._boundingSphere = new BoundingSphere();\n\n  /**\n   * The 4x4 transformation matrix that transforms the ellipsoid from model to world coordinates.\n   * When this is the identity matrix, the ellipsoid is drawn in world coordinates, i.e., Earth's WGS84 coordinates.\n   * Local reference frames can be used by providing a different transformation matrix, like that returned\n   * by {@link Transforms.eastNorthUpToFixedFrame}.\n   *\n   * @type {Matrix4}\n   * @default {@link Matrix4.IDENTITY}\n   *\n   * @example\n   * const origin = Cesium.Cartesian3.fromDegrees(-95.0, 40.0, 200000.0);\n   * e.modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(origin);\n   */\n  this.modelMatrix = Matrix4.clone(\n    defaultValue(options.modelMatrix, Matrix4.IDENTITY)\n  );\n  this._modelMatrix = new Matrix4();\n  this._computedModelMatrix = new Matrix4();\n\n  /**\n   * Determines if the ellipsoid primitive will be shown.\n   *\n   * @type {Boolean}\n   * @default true\n   */\n  this.show = defaultValue(options.show, true);\n\n  /**\n   * The surface appearance of the ellipsoid.  This can be one of several built-in {@link Material} objects or a custom material, scripted with\n   * {@link https://github.com/CesiumGS/cesium/wiki/Fabric|Fabric}.\n   * <p>\n   * The default material is <code>Material.ColorType</code>.\n   * </p>\n   *\n   * @type {Material}\n   * @default Material.fromType(Material.ColorType)\n   *\n   *\n   * @example\n   * // 1. Change the color of the default material to yellow\n   * e.material.uniforms.color = new Cesium.Color(1.0, 1.0, 0.0, 1.0);\n   *\n   * // 2. Change material to horizontal stripes\n   * e.material = Cesium.Material.fromType(Cesium.Material.StripeType);\n   *\n   * @see {@link https://github.com/CesiumGS/cesium/wiki/Fabric|Fabric}\n   */\n  this.material = defaultValue(\n    options.material,\n    Material.fromType(Material.ColorType)\n  );\n  this._material = undefined;\n  this._translucent = undefined;\n\n  /**\n   * User-defined object returned when the ellipsoid is picked.\n   *\n   * @type Object\n   *\n   * @default undefined\n   *\n   * @see Scene#pick\n   */\n  this.id = options.id;\n  this._id = undefined;\n\n  /**\n   * This property is for debugging only; it is not for production use nor is it optimized.\n   * <p>\n   * Draws the bounding sphere for each draw command in the primitive.\n   * </p>\n   *\n   * @type {Boolean}\n   *\n   * @default false\n   */\n  this.debugShowBoundingVolume = defaultValue(\n    options.debugShowBoundingVolume,\n    false\n  );\n\n  /**\n   * @private\n   */\n  this.onlySunLighting = defaultValue(options.onlySunLighting, false);\n  this._onlySunLighting = false;\n\n  /**\n   * @private\n   */\n  this._depthTestEnabled = defaultValue(options.depthTestEnabled, true);\n\n  this._useLogDepth = false;\n\n  this._sp = undefined;\n  this._rs = undefined;\n  this._va = undefined;\n\n  this._pickSP = undefined;\n  this._pickId = undefined;\n\n  this._colorCommand = new DrawCommand({\n    owner: defaultValue(options._owner, this),\n  });\n  this._pickCommand = new DrawCommand({\n    owner: defaultValue(options._owner, this),\n    pickOnly: true,\n  });\n\n  const that = this;\n  this._uniforms = {\n    u_radii: function () {\n      return that.radii;\n    },\n    u_oneOverEllipsoidRadiiSquared: function () {\n      return that._oneOverEllipsoidRadiiSquared;\n    },\n  };\n\n  this._pickUniforms = {\n    czm_pickColor: function () {\n      return that._pickId.color;\n    },\n  };\n}\n\nfunction getVertexArray(context) {\n  let vertexArray = context.cache.ellipsoidPrimitive_vertexArray;\n\n  if (defined(vertexArray)) {\n    return vertexArray;\n  }\n\n  const geometry = BoxGeometry.createGeometry(\n    BoxGeometry.fromDimensions({\n      dimensions: new Cartesian3(2.0, 2.0, 2.0),\n      vertexFormat: VertexFormat.POSITION_ONLY,\n    })\n  );\n\n  vertexArray = VertexArray.fromGeometry({\n    context: context,\n    geometry: geometry,\n    attributeLocations: attributeLocations,\n    bufferUsage: BufferUsage.STATIC_DRAW,\n    interleave: true,\n  });\n\n  context.cache.ellipsoidPrimitive_vertexArray = vertexArray;\n  return vertexArray;\n}\n\nconst logDepthExtension =\n  \"#ifdef GL_EXT_frag_depth \\n\" +\n  \"#extension GL_EXT_frag_depth : enable \\n\" +\n  \"#endif \\n\\n\";\n\n/**\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\n * get the draw commands needed to render this primitive.\n * <p>\n * Do not call this function directly.  This is documented just to\n * list the exceptions that may be propagated when the scene is rendered:\n * </p>\n *\n * @exception {DeveloperError} this.material must be defined.\n */\nEllipsoidPrimitive.prototype.update = function (frameState) {\n  if (\n    !this.show ||\n    frameState.mode !== SceneMode.SCENE3D ||\n    !defined(this.center) ||\n    !defined(this.radii)\n  ) {\n    return;\n  }\n\n  //>>includeStart('debug', pragmas.debug);\n  if (!defined(this.material)) {\n    throw new DeveloperError(\"this.material must be defined.\");\n  }\n  //>>includeEnd('debug');\n\n  const context = frameState.context;\n  const translucent = this.material.isTranslucent();\n  const translucencyChanged = this._translucent !== translucent;\n\n  if (!defined(this._rs) || translucencyChanged) {\n    this._translucent = translucent;\n\n    // If this render state is ever updated to use a non-default\n    // depth range, the hard-coded values in EllipsoidVS.glsl need\n    // to be updated as well.\n\n    this._rs = RenderState.fromCache({\n      // Cull front faces - not back faces - so the ellipsoid doesn't\n      // disappear if the viewer enters the bounding box.\n      cull: {\n        enabled: true,\n        face: CullFace.FRONT,\n      },\n      depthTest: {\n        enabled: this._depthTestEnabled,\n      },\n      // Only write depth when EXT_frag_depth is supported since the depth for\n      // the bounding box is wrong; it is not the true depth of the ray casted ellipsoid.\n      depthMask: !translucent && context.fragmentDepth,\n      blending: translucent ? BlendingState.ALPHA_BLEND : undefined,\n    });\n  }\n\n  if (!defined(this._va)) {\n    this._va = getVertexArray(context);\n  }\n\n  let boundingSphereDirty = false;\n\n  const radii = this.radii;\n  if (!Cartesian3.equals(this._radii, radii)) {\n    Cartesian3.clone(radii, this._radii);\n\n    const r = this._oneOverEllipsoidRadiiSquared;\n    r.x = 1.0 / (radii.x * radii.x);\n    r.y = 1.0 / (radii.y * radii.y);\n    r.z = 1.0 / (radii.z * radii.z);\n\n    boundingSphereDirty = true;\n  }\n\n  if (\n    !Matrix4.equals(this.modelMatrix, this._modelMatrix) ||\n    !Cartesian3.equals(this.center, this._center)\n  ) {\n    Matrix4.clone(this.modelMatrix, this._modelMatrix);\n    Cartesian3.clone(this.center, this._center);\n\n    // Translate model coordinates used for rendering such that the origin is the center of the ellipsoid.\n    Matrix4.multiplyByTranslation(\n      this.modelMatrix,\n      this.center,\n      this._computedModelMatrix\n    );\n    boundingSphereDirty = true;\n  }\n\n  if (boundingSphereDirty) {\n    Cartesian3.clone(Cartesian3.ZERO, this._boundingSphere.center);\n    this._boundingSphere.radius = Cartesian3.maximumComponent(radii);\n    BoundingSphere.transform(\n      this._boundingSphere,\n      this._computedModelMatrix,\n      this._boundingSphere\n    );\n  }\n\n  const materialChanged = this._material !== this.material;\n  this._material = this.material;\n  this._material.update(context);\n\n  const lightingChanged = this.onlySunLighting !== this._onlySunLighting;\n  this._onlySunLighting = this.onlySunLighting;\n\n  const useLogDepth = frameState.useLogDepth;\n  const useLogDepthChanged = this._useLogDepth !== useLogDepth;\n  this._useLogDepth = useLogDepth;\n\n  const colorCommand = this._colorCommand;\n  let vs;\n  let fs;\n\n  // Recompile shader when material, lighting, or translucency changes\n  if (\n    materialChanged ||\n    lightingChanged ||\n    translucencyChanged ||\n    useLogDepthChanged\n  ) {\n    vs = new ShaderSource({\n      sources: [EllipsoidVS],\n    });\n    fs = new ShaderSource({\n      sources: [this.material.shaderSource, EllipsoidFS],\n    });\n    if (this.onlySunLighting) {\n      fs.defines.push(\"ONLY_SUN_LIGHTING\");\n    }\n    if (!translucent && context.fragmentDepth) {\n      fs.defines.push(\"WRITE_DEPTH\");\n    }\n    if (this._useLogDepth) {\n      vs.defines.push(\"LOG_DEPTH\");\n      fs.defines.push(\"LOG_DEPTH\");\n      fs.sources.push(logDepthExtension);\n    }\n\n    this._sp = ShaderProgram.replaceCache({\n      context: context,\n      shaderProgram: this._sp,\n      vertexShaderSource: vs,\n      fragmentShaderSource: fs,\n      attributeLocations: attributeLocations,\n    });\n\n    colorCommand.vertexArray = this._va;\n    colorCommand.renderState = this._rs;\n    colorCommand.shaderProgram = this._sp;\n    colorCommand.uniformMap = combine(this._uniforms, this.material._uniforms);\n    colorCommand.executeInClosestFrustum = translucent;\n  }\n\n  const commandList = frameState.commandList;\n  const passes = frameState.passes;\n\n  if (passes.render) {\n    colorCommand.boundingVolume = this._boundingSphere;\n    colorCommand.debugShowBoundingVolume = this.debugShowBoundingVolume;\n    colorCommand.modelMatrix = this._computedModelMatrix;\n    colorCommand.pass = translucent ? Pass.TRANSLUCENT : Pass.OPAQUE;\n\n    commandList.push(colorCommand);\n  }\n\n  if (passes.pick) {\n    const pickCommand = this._pickCommand;\n\n    if (!defined(this._pickId) || this._id !== this.id) {\n      this._id = this.id;\n      this._pickId = this._pickId && this._pickId.destroy();\n      this._pickId = context.createPickId({\n        primitive: this,\n        id: this.id,\n      });\n    }\n\n    // Recompile shader when material changes\n    if (\n      materialChanged ||\n      lightingChanged ||\n      !defined(this._pickSP) ||\n      useLogDepthChanged\n    ) {\n      vs = new ShaderSource({\n        sources: [EllipsoidVS],\n      });\n      fs = new ShaderSource({\n        sources: [this.material.shaderSource, EllipsoidFS],\n        pickColorQualifier: \"uniform\",\n      });\n      if (this.onlySunLighting) {\n        fs.defines.push(\"ONLY_SUN_LIGHTING\");\n      }\n      if (!translucent && context.fragmentDepth) {\n        fs.defines.push(\"WRITE_DEPTH\");\n      }\n      if (this._useLogDepth) {\n        vs.defines.push(\"LOG_DEPTH\");\n        fs.defines.push(\"LOG_DEPTH\");\n        fs.sources.push(logDepthExtension);\n      }\n\n      this._pickSP = ShaderProgram.replaceCache({\n        context: context,\n        shaderProgram: this._pickSP,\n        vertexShaderSource: vs,\n        fragmentShaderSource: fs,\n        attributeLocations: attributeLocations,\n      });\n\n      pickCommand.vertexArray = this._va;\n      pickCommand.renderState = this._rs;\n      pickCommand.shaderProgram = this._pickSP;\n      pickCommand.uniformMap = combine(\n        combine(this._uniforms, this._pickUniforms),\n        this.material._uniforms\n      );\n      pickCommand.executeInClosestFrustum = translucent;\n    }\n\n    pickCommand.boundingVolume = this._boundingSphere;\n    pickCommand.modelMatrix = this._computedModelMatrix;\n    pickCommand.pass = translucent ? Pass.TRANSLUCENT : Pass.OPAQUE;\n\n    commandList.push(pickCommand);\n  }\n};\n\n/**\n * Returns true if this object was destroyed; otherwise, false.\n * <br /><br />\n * If this object was destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.\n *\n * @returns {Boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\n *\n * @see EllipsoidPrimitive#destroy\n */\nEllipsoidPrimitive.prototype.isDestroyed = function () {\n  return false;\n};\n\n/**\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\n * <br /><br />\n * Once an object is destroyed, it should not be used; calling any function other than\n * <code>isDestroyed</code> will result in a {@link DeveloperError} exception.  Therefore,\n * assign the return value (<code>undefined</code>) to the object as done in the example.\n *\n * @exception {DeveloperError} This object was destroyed, i.e., destroy() was called.\n *\n *\n * @example\n * e = e && e.destroy();\n *\n * @see EllipsoidPrimitive#isDestroyed\n */\nEllipsoidPrimitive.prototype.destroy = function () {\n  this._sp = this._sp && this._sp.destroy();\n  this._pickSP = this._pickSP && this._pickSP.destroy();\n  this._pickId = this._pickId && this._pickId.destroy();\n  return destroyObject(this);\n};\nexport default EllipsoidPrimitive;\n","import defaultValue from \"../Core/defaultValue.js\";\nimport defined from \"../Core/defined.js\";\nimport VertexFormat from \"../Core/VertexFormat.js\";\nimport EllipsoidSurfaceAppearanceFS from \"../Shaders/Appearances/EllipsoidSurfaceAppearanceFS.js\";\nimport EllipsoidSurfaceAppearanceVS from \"../Shaders/Appearances/EllipsoidSurfaceAppearanceVS.js\";\nimport Appearance from \"./Appearance.js\";\nimport Material from \"./Material.js\";\n\n/**\n * An appearance for geometry on the surface of the ellipsoid like {@link PolygonGeometry}\n * and {@link RectangleGeometry}, which supports all materials like {@link MaterialAppearance}\n * with {@link MaterialAppearance.MaterialSupport.ALL}.  However, this appearance requires\n * fewer vertex attributes since the fragment shader can procedurally compute <code>normal</code>,\n * <code>tangent</code>, and <code>bitangent</code>.\n *\n * @alias EllipsoidSurfaceAppearance\n * @constructor\n *\n * @param {Object} [options] Object with the following properties:\n * @param {Boolean} [options.flat=false] When <code>true</code>, flat shading is used in the fragment shader, which means lighting is not taking into account.\n * @param {Boolean} [options.faceForward=options.aboveGround] When <code>true</code>, the fragment shader flips the surface normal as needed to ensure that the normal faces the viewer to avoid dark spots.  This is useful when both sides of a geometry should be shaded like {@link WallGeometry}.\n * @param {Boolean} [options.translucent=true] When <code>true</code>, the geometry is expected to appear translucent so {@link EllipsoidSurfaceAppearance#renderState} has alpha blending enabled.\n * @param {Boolean} [options.aboveGround=false] When <code>true</code>, the geometry is expected to be on the ellipsoid's surface - not at a constant height above it - so {@link EllipsoidSurfaceAppearance#renderState} has backface culling enabled.\n * @param {Material} [options.material=Material.ColorType] The material used to determine the fragment color.\n * @param {String} [options.vertexShaderSource] Optional GLSL vertex shader source to override the default vertex shader.\n * @param {String} [options.fragmentShaderSource] Optional GLSL fragment shader source to override the default fragment shader.\n * @param {Object} [options.renderState] Optional render state to override the default render state.\n *\n * @see {@link https://github.com/CesiumGS/cesium/wiki/Fabric|Fabric}\n *\n * @example\n * const primitive = new Cesium.Primitive({\n *   geometryInstances : new Cesium.GeometryInstance({\n *     geometry : new Cesium.PolygonGeometry({\n *       vertexFormat : Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,\n *       // ...\n *     })\n *   }),\n *   appearance : new Cesium.EllipsoidSurfaceAppearance({\n *     material : Cesium.Material.fromType('Stripe')\n *   })\n * });\n */\nfunction EllipsoidSurfaceAppearance(options) {\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n  const translucent = defaultValue(options.translucent, true);\n  const aboveGround = defaultValue(options.aboveGround, false);\n\n  /**\n   * The material used to determine the fragment color.  Unlike other {@link EllipsoidSurfaceAppearance}\n   * properties, this is not read-only, so an appearance's material can change on the fly.\n   *\n   * @type Material\n   *\n   * @default {@link Material.ColorType}\n   *\n   * @see {@link https://github.com/CesiumGS/cesium/wiki/Fabric|Fabric}\n   */\n  this.material = defined(options.material)\n    ? options.material\n    : Material.fromType(Material.ColorType);\n\n  /**\n   * When <code>true</code>, the geometry is expected to appear translucent.\n   *\n   * @type {Boolean}\n   *\n   * @default true\n   */\n  this.translucent = defaultValue(options.translucent, true);\n\n  this._vertexShaderSource = defaultValue(\n    options.vertexShaderSource,\n    EllipsoidSurfaceAppearanceVS\n  );\n  this._fragmentShaderSource = defaultValue(\n    options.fragmentShaderSource,\n    EllipsoidSurfaceAppearanceFS\n  );\n  this._renderState = Appearance.getDefaultRenderState(\n    translucent,\n    !aboveGround,\n    options.renderState\n  );\n  this._closed = false;\n\n  // Non-derived members\n\n  this._flat = defaultValue(options.flat, false);\n  this._faceForward = defaultValue(options.faceForward, aboveGround);\n  this._aboveGround = aboveGround;\n}\n\nObject.defineProperties(EllipsoidSurfaceAppearance.prototype, {\n  /**\n   * The GLSL source code for the vertex shader.\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  vertexShaderSource: {\n    get: function () {\n      return this._vertexShaderSource;\n    },\n  },\n\n  /**\n   * The GLSL source code for the fragment shader.  The full fragment shader\n   * source is built procedurally taking into account {@link EllipsoidSurfaceAppearance#material},\n   * {@link EllipsoidSurfaceAppearance#flat}, and {@link EllipsoidSurfaceAppearance#faceForward}.\n   * Use {@link EllipsoidSurfaceAppearance#getFragmentShaderSource} to get the full source.\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {String}\n   * @readonly\n   */\n  fragmentShaderSource: {\n    get: function () {\n      return this._fragmentShaderSource;\n    },\n  },\n\n  /**\n   * The WebGL fixed-function state to use when rendering the geometry.\n   * <p>\n   * The render state can be explicitly defined when constructing a {@link EllipsoidSurfaceAppearance}\n   * instance, or it is set implicitly via {@link EllipsoidSurfaceAppearance#translucent}\n   * and {@link EllipsoidSurfaceAppearance#aboveGround}.\n   * </p>\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {Object}\n   * @readonly\n   */\n  renderState: {\n    get: function () {\n      return this._renderState;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the geometry is expected to be closed so\n   * {@link EllipsoidSurfaceAppearance#renderState} has backface culling enabled.\n   * If the viewer enters the geometry, it will not be visible.\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  closed: {\n    get: function () {\n      return this._closed;\n    },\n  },\n\n  /**\n   * The {@link VertexFormat} that this appearance instance is compatible with.\n   * A geometry can have more vertex attributes and still be compatible - at a\n   * potential performance cost - but it can't have less.\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type VertexFormat\n   * @readonly\n   *\n   * @default {@link EllipsoidSurfaceAppearance.VERTEX_FORMAT}\n   */\n  vertexFormat: {\n    get: function () {\n      return EllipsoidSurfaceAppearance.VERTEX_FORMAT;\n    },\n  },\n\n  /**\n   * When <code>true</code>, flat shading is used in the fragment shader,\n   * which means lighting is not taking into account.\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  flat: {\n    get: function () {\n      return this._flat;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the fragment shader flips the surface normal\n   * as needed to ensure that the normal faces the viewer to avoid\n   * dark spots.  This is useful when both sides of a geometry should be\n   * shaded like {@link WallGeometry}.\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default true\n   */\n  faceForward: {\n    get: function () {\n      return this._faceForward;\n    },\n  },\n\n  /**\n   * When <code>true</code>, the geometry is expected to be on the ellipsoid's\n   * surface - not at a constant height above it - so {@link EllipsoidSurfaceAppearance#renderState}\n   * has backface culling enabled.\n   *\n   *\n   * @memberof EllipsoidSurfaceAppearance.prototype\n   *\n   * @type {Boolean}\n   * @readonly\n   *\n   * @default false\n   */\n  aboveGround: {\n    get: function () {\n      return this._aboveGround;\n    },\n  },\n});\n\n/**\n * The {@link VertexFormat} that all {@link EllipsoidSurfaceAppearance} instances\n * are compatible with, which requires only <code>position</code> and <code>st</code>\n * attributes.  Other attributes are procedurally computed in the fragment shader.\n *\n * @type VertexFormat\n *\n * @constant\n */\nEllipsoidSurfaceAppearance.VERTEX_FORMAT = VertexFormat.POSITION_AND_ST;\n\n/**\n * Procedurally creates the full GLSL fragment shader source.  For {@link EllipsoidSurfaceAppearance},\n * this is derived from {@link EllipsoidSurfaceAppearance#fragmentShaderSource}, {@link EllipsoidSurfaceAppearance#flat},\n * and {@link EllipsoidSurfaceAppearance#faceForward}.\n *\n * @function\n *\n * @returns {String} The full GLSL fragment shader source.\n */\nEllipsoidSurfaceAppearance.prototype.getFragmentShaderSource =\n  Appearance.prototype.getFragmentShaderSource;\n\n/**\n * Determines if the geometry is translucent based on {@link EllipsoidSurfaceAppearance#translucent} and {@link Material#isTranslucent}.\n *\n * @function\n *\n * @returns {Boolean} <code>true</code> if the appearance is translucent.\n */\nEllipsoidSurfaceAppearance.prototype.isTranslucent =\n  Appearance.prototype.isTranslucent;\n\n/**\n * Creates a render state.  This is not the final render state instance; instead,\n * it can contain a subset of render state properties identical to the render state\n * created in the context.\n *\n * @function\n *\n * @returns {Object} The render state.\n */\nEllipsoidSurfaceAppearance.prototype.getRenderState =\n  Appearance.prototype.getRenderState;\nexport default EllipsoidSurfaceAppearance;\n","import destroyObject from \"../Core/destroyObject.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\n\n/**\n * Represents empty content for tiles in a\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification|3D Tiles} tileset that\n * do not have content, e.g., because they are used to optimize hierarchical culling.\n * <p>\n * Implements the {@link Cesium3DTileContent} interface.\n * </p>\n *\n * @alias Empty3DTileContent\n * @constructor\n *\n * @private\n */\nfunction Empty3DTileContent(tileset, tile) {\n  this._tileset = tileset;\n  this._tile = tile;\n\n  this.featurePropertiesDirty = false;\n}\n\nObject.defineProperties(Empty3DTileContent.prototype, {\n  featuresLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  pointsLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  trianglesLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  geometryByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  texturesByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  batchTableByteLength: {\n    get: function () {\n      return 0;\n    },\n  },\n\n  innerContents: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  readyPromise: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  tileset: {\n    get: function () {\n      return this._tileset;\n    },\n  },\n\n  tile: {\n    get: function () {\n      return this._tile;\n    },\n  },\n\n  url: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  metadata: {\n    get: function () {\n      return undefined;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      throw new DeveloperError(\n        \"Empty3DTileContent cannot have content metadata\"\n      );\n      //>>includeEnd('debug');\n    },\n  },\n\n  batchTable: {\n    get: function () {\n      return undefined;\n    },\n  },\n\n  group: {\n    get: function () {\n      return undefined;\n    },\n    set: function (value) {\n      //>>includeStart('debug', pragmas.debug);\n      throw new DeveloperError(\"Empty3DTileContent cannot have group metadata\");\n      //>>includeEnd('debug');\n    },\n  },\n});\n\n/**\n * Part of the {@link Cesium3DTileContent} interface.  <code>Empty3DTileContent</code>\n * always returns <code>false</code> since a tile of this type does not have any features.\n */\nEmpty3DTileContent.prototype.hasProperty = function (batchId, name) {\n  return false;\n};\n\n/**\n * Part of the {@link Cesium3DTileContent} interface.  <code>Empty3DTileContent</code>\n * always returns <code>undefined</code> since a tile of this type does not have any features.\n */\nEmpty3DTileContent.prototype.getFeature = function (batchId) {\n  return undefined;\n};\n\nEmpty3DTileContent.prototype.applyDebugSettings = function (enabled, color) {};\n\nEmpty3DTileContent.prototype.applyStyle = function (style) {};\n\nEmpty3DTileContent.prototype.update = function (tileset, frameState) {};\n\nEmpty3DTileContent.prototype.isDestroyed = function () {\n  return false;\n};\n\nEmpty3DTileContent.prototype.destroy = function () {\n  return destroyObject(this);\n};\nexport default Empty3DTileContent;\n","import Cartesian2 from \"../Core/Cartesian2.js\";\nimport Cartesian3 from \"../Core/Cartesian3.js\";\nimport Cartesian4 from \"../Core/Cartesian4.js\";\nimport Check from \"../Core/Check.js\";\nimport Color from \"../Core/Color.js\";\nimport defined from \"../Core/defined.js\";\nimport DeveloperError from \"../Core/DeveloperError.js\";\nimport CesiumMath from \"../Core/Math.js\";\nimport RuntimeError from \"../Core/RuntimeError.js\";\nimport jsep from \"../ThirdParty/jsep.js\";\nimport ExpressionNodeType from \"./ExpressionNodeType.js\";\n\n/**\n * An expression for a style applied to a {@link Cesium3DTileset}.\n * <p>\n * Evaluates an expression defined using the\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}.\n * </p>\n * <p>\n * Implements the {@link StyleExpression} interface.\n * </p>\n *\n * @alias Expression\n * @constructor\n *\n * @param {String} [expression] The expression defined using the 3D Tiles Styling language.\n * @param {Object} [defines] Defines in the style.\n *\n * @example\n * const expression = new Cesium.Expression('(regExp(\"^Chest\").test(${County})) && (${YearBuilt} >= 1970)');\n * expression.evaluate(feature); // returns true or false depending on the feature's properties\n *\n * @example\n * const expression = new Cesium.Expression('(${Temperature} > 90) ? color(\"red\") : color(\"white\")');\n * expression.evaluateColor(feature, result); // returns a Cesium.Color object\n */\nfunction Expression(expression, defines) {\n  //>>includeStart('debug', pragmas.debug);\n  Check.typeOf.string(\"expression\", expression);\n  //>>includeEnd('debug');\n\n  this._expression = expression;\n  expression = replaceDefines(expression, defines);\n  expression = replaceVariables(removeBackslashes(expression));\n\n  // customize jsep operators\n  jsep.addBinaryOp(\"=~\", 0);\n  jsep.addBinaryOp(\"!~\", 0);\n\n  let ast;\n  try {\n    ast = jsep(expression);\n  } catch (e) {\n    throw new RuntimeError(e);\n  }\n\n  this._runtimeAst = createRuntimeAst(this, ast);\n}\n\nObject.defineProperties(Expression.prototype, {\n  /**\n   * Gets the expression defined in the 3D Tiles Styling language.\n   *\n   * @memberof Expression.prototype\n   *\n   * @type {String}\n   * @readonly\n   *\n   * @default undefined\n   */\n  expression: {\n    get: function () {\n      return this._expression;\n    },\n  },\n});\n\n// Scratch storage manager while evaluating deep expressions.\n// For example, an expression like dot(vec4(${red}), vec4(${green}) * vec4(${blue}) requires 3 scratch Cartesian4's\nconst scratchStorage = {\n  arrayIndex: 0,\n  arrayArray: [[]],\n  cartesian2Index: 0,\n  cartesian3Index: 0,\n  cartesian4Index: 0,\n  cartesian2Array: [new Cartesian2()],\n  cartesian3Array: [new Cartesian3()],\n  cartesian4Array: [new Cartesian4()],\n  reset: function () {\n    this.arrayIndex = 0;\n    this.cartesian2Index = 0;\n    this.cartesian3Index = 0;\n    this.cartesian4Index = 0;\n  },\n  getArray: function () {\n    if (this.arrayIndex >= this.arrayArray.length) {\n      this.arrayArray.push([]);\n    }\n    const array = this.arrayArray[this.arrayIndex++];\n    array.length = 0;\n    return array;\n  },\n  getCartesian2: function () {\n    if (this.cartesian2Index >= this.cartesian2Array.length) {\n      this.cartesian2Array.push(new Cartesian2());\n    }\n    return this.cartesian2Array[this.cartesian2Index++];\n  },\n  getCartesian3: function () {\n    if (this.cartesian3Index >= this.cartesian3Array.length) {\n      this.cartesian3Array.push(new Cartesian3());\n    }\n    return this.cartesian3Array[this.cartesian3Index++];\n  },\n  getCartesian4: function () {\n    if (this.cartesian4Index >= this.cartesian4Array.length) {\n      this.cartesian4Array.push(new Cartesian4());\n    }\n    return this.cartesian4Array[this.cartesian4Index++];\n  },\n};\n\n/**\n * Evaluates the result of an expression, optionally using the provided feature's properties. If the result of\n * the expression in the\n * {@link https://github.com/CesiumGS/3d-tiles/tree/main/specification/Styling|3D Tiles Styling language}\n * is of type <code>Boolean</code>, <code>Number</code>, or <code>String</code>, the corresponding JavaScript\n * primitive type will be returned. If the result is a <code>RegExp</code>, a Javascript <code>RegExp</code>\n * object will be returned. If the result is a <code>Cartesian2</code>, <code>Cartesian3</code>, or <code>Cartesian4</code>,\n * a {@link Cartesian2}, {@link Cartesian3}, or {@link Cartesian4} object will be returned. If the <code>result</code> argument is\n * a {@link Color}, the {@link Cartesian4} value is converted to a {@link Color} and then returned.\n *\n * @param {Cesium3DTileFeature} feature The feature whose properties may be used as variables in the expression.\n * @param {Object} [result] The object onto which to store the result.\n * @returns {Boolean|Number|String|RegExp|Cartesian2|Cartesian3|Cartesian4|Color} The result of evaluating the expression.\n */\nExpression.prototype.evaluate = function (feature, result) {\n  scratchStorage.reset();\n  const value = this._runtimeAst.evaluate(feature);\n  if (result instanceof Color && value instanceof Cartesian4) {\n    return Color.fromCartesian4(value, result);\n  }\n  if (\n    value instanceof Cartesian2 ||\n    value instanceof Cartesian3 ||\n    value instanceof Cartesian4\n  ) {\n    return value.clone(result);\n  }\n  return value;\n};\n\n/**\n * Evaluates the result of a Color expression, optionally using the provided feature's properties.\n * <p>\n * This is equivalent to {@link Expression#evaluate} but always returns a {@link Color} object.\n * </p>\n *\n * @param {Cesium3DTileFeature} feature The feature whose properties may be used as variables in the expression.\n * @param {Color} [result] The object in which to store the result\n * @returns {Color} The modified result parameter or a new Color instance if one was not provided.\n */\nExpression.prototype.evaluateColor = function (feature, result) {\n  scratchStorage.reset();\n  const color = this._runtimeAst.evaluate(feature);\n  return Color.fromCartesian4(color, result);\n};\n\n/**\n * Gets the shader function for this expression.\n * Returns undefined if the shader function can't be generated from this expression.\n *\n * @param {String} functionSignature Signature of the generated function.\n * @param {Object} variableSubstitutionMap Maps variable names to shader variable names.\n * @param {Object} shaderState Stores information about the generated shader function, including whether it is translucent.\n * @param {String} returnType The return type of the generated function.\n *\n * @returns {String} The shader function.\n *\n * @private\n */\nExpression.prototype.getShaderFunction = function (\n  functionSignature,\n  variableSubstitutionMap,\n  shaderState,\n  returnType\n) {\n  let shaderExpression = this.getShaderExpression(\n    variableSubstitutionMap,\n    shaderState\n  );\n\n  shaderExpression =\n    `${returnType} ${functionSignature}\\n` +\n    `{\\n` +\n    `    return ${shaderExpression};\\n` +\n    `}\\n`;\n\n  return shaderExpression;\n};\n\n/**\n * Gets the shader expression for this expression.\n * Returns undefined if the shader expression can't be generated from this expression.\n *\n * @param {Object} variableSubstitutionMap Maps variable names to shader variable names.\n * @param {Object} shaderState Stores information about the generated shader function, including whether it is translucent.\n *\n * @returns {String} The shader expression.\n *\n * @private\n */\nExpression.prototype.getShaderExpression = function (\n  variableSubstitutionMap,\n  shaderState\n) {\n  return this._runtimeAst.getShaderExpression(\n    variableSubstitutionMap,\n    shaderState\n  );\n};\n\n/**\n * Gets the variables used by the expression.\n *\n * @returns {String[]} The variables used by the expression.\n *\n * @private\n */\nExpression.prototype.getVariables = function () {\n  let variables = [];\n\n  this._runtimeAst.getVariables(variables);\n\n  // Remove duplicates\n  variables = variables.filter(function (variable, index, variables) {\n    return variables.indexOf(variable) === index;\n  });\n\n  return variables;\n};\n\nconst unaryOperators = [\"!\", \"-\", \"+\"];\nconst binaryOperators = [\n  \"+\",\n  \"-\",\n  \"*\",\n  \"/\",\n  \"%\",\n  \"===\",\n  \"!==\",\n  \">\",\n  \">=\",\n  \"<\",\n  \"<=\",\n  \"&&\",\n  \"||\",\n  \"!~\",\n  \"=~\",\n];\n\nconst variableRegex = /\\${(.*?)}/g; // Matches ${variable_name}\nconst backslashRegex = /\\\\/g;\nconst backslashReplacement = \"@#%\";\nconst replacementRegex = /@#%/g;\n\nconst scratchColor = new Color();\n\nconst unaryFunctions = {\n  abs: getEvaluateUnaryComponentwise(Math.abs),\n  sqrt: getEvaluateUnaryComponentwise(Math.sqrt),\n  cos: getEvaluateUnaryComponentwise(Math.cos),\n  sin: getEvaluateUnaryComponentwise(Math.sin),\n  tan: getEvaluateUnaryComponentwise(Math.tan),\n  acos: getEvaluateUnaryComponentwise(Math.acos),\n  asin: getEvaluateUnaryComponentwise(Math.asin),\n  atan: getEvaluateUnaryComponentwise(Math.atan),\n  radians: getEvaluateUnaryComponentwise(CesiumMath.toRadians),\n  degrees: getEvaluateUnaryComponentwise(CesiumMath.toDegrees),\n  sign: getEvaluateUnaryComponentwise(CesiumMath.sign),\n  floor: getEvaluateUnaryComponentwise(Math.floor),\n  ceil: getEvaluateUnaryComponentwise(Math.ceil),\n  round: getEvaluateUnaryComponentwise(Math.round),\n  exp: getEvaluateUnaryComponentwise(Math.exp),\n  exp2: getEvaluateUnaryComponentwise(exp2),\n  log: getEvaluateUnaryComponentwise(Math.log),\n  log2: getEvaluateUnaryComponentwise(log2),\n  fract: getEvaluateUnaryComponentwise(fract),\n  length: length,\n  normalize: normalize,\n};\n\nconst binaryFunctions = {\n  atan2: getEvaluateBinaryComponentwise(Math.atan2, false),\n  pow: getEvaluateBinaryComponentwise(Math.pow, false),\n  min: getEvaluateBinaryComponentwise(Math.min, true),\n  max: getEvaluateBinaryComponentwise(Math.max, true),\n  distance: distance,\n  dot: dot,\n  cross: cross,\n};\n\nconst ternaryFunctions = {\n  clamp: getEvaluateTernaryComponentwise(CesiumMath.clamp, true),\n  mix: getEvaluateTernaryComponentwise(CesiumMath.lerp, true),\n};\n\nfunction fract(number) {\n  return number - Math.floor(number);\n}\n\nfunction exp2(exponent) {\n  return Math.pow(2.0, exponent);\n}\n\nfunction log2(number) {\n  return CesiumMath.log2(number);\n}\n\nfunction getEvaluateUnaryComponentwise(operation) {\n  return function (call, left) {\n    if (typeof left === \"number\") {\n      return operation(left);\n    } else if (left instanceof Cartesian2) {\n      return Cartesian2.fromElements(\n        operation(left.x),\n        operation(left.y),\n        scratchStorage.getCartesian2()\n      );\n    } else if (left instanceof Cartesian3) {\n      return Cartesian3.fromElements(\n        operation(left.x),\n        operation(left.y),\n        operation(left.z),\n        scratchStorage.getCartesian3()\n      );\n    } else if (left instanceof Cartesian4) {\n      return Cartesian4.fromElements(\n        operation(left.x),\n        operation(left.y),\n        operation(left.z),\n        operation(left.w),\n        scratchStorage.getCartesian4()\n      );\n    }\n    throw new RuntimeError(\n      `Function \"${call}\" requires a vector or number argument. Argument is ${left}.`\n    );\n  };\n}\n\nfunction getEvaluateBinaryComponentwise(operation, allowScalar) {\n  return function (call, left, right) {\n    if (allowScalar && typeof right === \"number\") {\n      if (typeof left === \"number\") {\n        return operation(left, right);\n      } else if (left instanceof Cartesian2) {\n        return Cartesian2.fromElements(\n          operation(left.x, right),\n          operation(left.y, right),\n          scratchStorage.getCartesian2()\n        );\n      } else if (left instanceof Cartesian3) {\n        return Cartesian3.fromElements(\n          operation(left.x, right),\n          operation(left.y, right),\n          operation(left.z, right),\n          scratchStorage.getCartesian3()\n        );\n      } else if (left instanceof Cartesian4) {\n        return Cartesian4.fromElements(\n          operation(left.x, right),\n          operation(left.y, right),\n          operation(left.z, right),\n          operation(left.w, right),\n          scratchStorage.getCartesian4()\n        );\n      }\n    }\n\n    if (typeof left === \"number\" && typeof right === \"number\") {\n      return operation(left, right);\n    } else if (left instanceof Cartesian2 && right instanceof Cartesian2) {\n      return Cartesian2.fromElements(\n        operation(left.x, right.x),\n        operation(left.y, right.y),\n        scratchStorage.getCartesian2()\n      );\n    } else if (left instanceof Cartesian3 && right instanceof Cartesian3) {\n      return Cartesian3.fromElements(\n        operation(left.x, right.x),\n        operation(left.y, right.y),\n        operation(left.z, right.z),\n        scratchStorage.getCartesian3()\n      );\n    } else if (left instanceof Cartesian4 && right instanceof Cartesian4) {\n      return Cartesian4.fromElements(\n        operation(left.x, right.x),\n        operation(left.y, right.y),\n        operation(left.z, right.z),\n        operation(left.w, right.w),\n        scratchStorage.getCartesian4()\n      );\n    }\n\n    throw new RuntimeError(\n      `Function \"${call}\" requires vector or number arguments of matching types. Arguments are ${left} and ${right}.`\n    );\n  };\n}\n\nfunction getEvaluateTernaryComponentwise(operation, allowScalar) {\n  return function (call, left, right, test) {\n    if (allowScalar && typeof test === \"number\") {\n      if (typeof left === \"number\" && typeof right === \"number\") {\n        return operation(left, right, test);\n      } else if (left instanceof Cartesian2 && right instanceof Cartesian2) {\n        return Cartesian2.fromElements(\n          operation(left.x, right.x, test),\n          operation(left.y, right.y, test),\n          scratchStorage.getCartesian2()\n        );\n      } else if (left instanceof Cartesian3 && right instanceof Cartesian3) {\n        return Cartesian3.fromElements(\n          operation(left.x, right.x, test),\n          operation(left.y, right.y, test),\n          operation(left.z, right.z, test),\n          scratchStorage.getCartesian3()\n        );\n      } else if (left instanceof Cartesian4 && right instanceof Cartesian4) {\n        return Cartesian4.fromElements(\n          operation(left.x, right.x, test),\n          operation(left.y, right.y, test),\n          operation(left.z, right.z, test),\n          operation(left.w, right.w, test),\n          scratchStorage.getCartesian4()\n        );\n      }\n    }\n\n    if (\n      typeof left === \"number\" &&\n      typeof right === \"number\" &&\n      typeof test === \"number\"\n    ) {\n      return operation(left, right, test);\n    } else if (\n      left instanceof Cartesian2 &&\n      right instanceof Cartesian2 &&\n      test instanceof Cartesian2\n    ) {\n      return Cartesian2.fromElements(\n        operation(left.x, right.x, test.x),\n        operation(left.y, right.y, test.y),\n        scratchStorage.getCartesian2()\n      );\n    } else if (\n      left instanceof Cartesian3 &&\n      right instanceof Cartesian3 &&\n      test instanceof Cartesian3\n    ) {\n      return Cartesian3.fromElements(\n        operation(left.x, right.x, test.x),\n        operation(left.y, right.y, test.y),\n        operation(left.z, right.z, test.z),\n        scratchStorage.getCartesian3()\n      );\n    } else if (\n      left instanceof Cartesian4 &&\n      right instanceof Cartesian4 &&\n      test instanceof Cartesian4\n    ) {\n      return Cartesian4.fromElements(\n        operation(left.x, right.x, test.x),\n        operation(left.y, right.y, test.y),\n        operation(left.z, right.z, test.z),\n        operation(left.w, right.w, test.w),\n        scratchStorage.getCartesian4()\n      );\n    }\n\n    throw new RuntimeError(\n      `Function \"${call}\" requires vector or number arguments of matching types. Arguments are ${left}, ${right}, and ${test}.`\n    );\n  };\n}\n\nfunction length(call, left) {\n  if (typeof left === \"number\") {\n    return Math.abs(left);\n  } else if (left instanceof Cartesian2) {\n    return Cartesian2.magnitude(left);\n  } else if (left instanceof Cartesian3) {\n    return Cartesian3.magnitude(left);\n  } else if (left instanceof Cartesian4) {\n    return Cartesian4.magnitude(left);\n  }\n\n  throw new RuntimeError(\n    `Function \"${call}\" requires a vector or number argument. Argument is ${left}.`\n  );\n}\n\nfunction normalize(call, left) {\n  if (typeof left === \"number\") {\n    return 1.0;\n  } else if (left instanceof Cartesian2) {\n    return Cartesian2.normalize(left, scratchStorage.getCartesian2());\n  } else if (left instanceof Cartesian3) {\n    return Cartesian3.normalize(left, scratchStorage.getCartesian3());\n  } else if (left instanceof Cartesian4) {\n    return Cartesian4.normalize(left, scratchStorage.getCartesian4());\n  }\n\n  throw new RuntimeError(\n    `Function \"${call}\" requires a vector or number argument. Argument is ${left}.`\n  );\n}\n\nfunction distance(call, left, right) {\n  if (typeof left === \"number\" && typeof right === \"number\") {\n    return Math.abs(left - right);\n  } else if (left instanceof Cartesian2 && right instanceof Cartesian2) {\n    return Cartesian2.distance(left, right);\n  } else if (left instanceof Cartesian3 && right instanceof Cartesian3) {\n    return Cartesian3.distance(left, right);\n  } else if (left instanceof Cartesian4 && right instanceof Cartesian4) {\n    return Cartesian4.distance(left, right);\n  }\n\n  throw new RuntimeError(\n    `Function \"${call}\" requires vector or number arguments of matching types. Arguments are ${left} and ${right}.`\n  );\n}\n\nfunction dot(call, left, right) {\n  if (typeof left === \"number\" && typeof right === \"number\") {\n    return left * right;\n  } else if (left instanceof Cartesian2 && right instanceof Cartesian2) {\n    return Cartesian2.dot(left, right);\n  } else if (left instanceof Cartesian3 && right instanceof Cartesian3) {\n    return Cartesian3.dot(left, right);\n  } else if (left instanceof Cartesian4 && right instanceof Cartesian4) {\n    return Cartesian4.dot(left, right);\n  }\n\n  throw new RuntimeError(\n    `Function \"${call}\" requires vector or number arguments of matching types. Arguments are ${left} and ${right}.`\n  );\n}\n\nfunction cross(call, left, right) {\n  if (left instanceof Cartesian3 && right instanceof Cartesian3) {\n    return Cartesian3.cross(left, right, scratchStorage.getCartesian3());\n  }\n\n  throw new RuntimeError(\n    `Function \"${call}\" requires vec3 arguments. Arguments are ${left} and ${right}.`\n  );\n}\n\nfunction Node(type, value, left, right, test) {\n  this._type = type;\n  this._value = value;\n  this._left = left;\n  this._right = right;\n  this._test = test;\n  this.evaluate = undefined;\n\n  setEvaluateFunction(this);\n}\n\nfunction replaceDefines(expression, defines) {\n  if (!defined(defines)) {\n    return expression;\n  }\n  for (const key in defines) {\n    if (defines.hasOwnProperty(key)) {\n      const definePlaceholder = new RegExp(`\\\\$\\\\{${key}\\\\}`, \"g\");\n      const defineReplace = `(${defines[key]})`;\n      if (defined(defineReplace)) {\n        expression = expression.replace(definePlaceholder, defineReplace);\n      }\n    }\n  }\n  return expression;\n}\n\nfunction removeBackslashes(expression) {\n  return expression.replace(backslashRegex, backslashReplacement);\n}\n\nfunction replaceBackslashes(expression) {\n  return expression.replace(replacementRegex, \"\\\\\");\n}\n\nfunction replaceVariables(expression) {\n  let exp = expression;\n  let result = \"\";\n  let i = exp.indexOf(\"${\");\n  while (i >= 0) {\n    // Check if string is inside quotes\n    const openSingleQuote = exp.indexOf(\"'\");\n    const openDoubleQuote = exp.indexOf('\"');\n    let closeQuote;\n    if (openSingleQuote >= 0 && openSingleQuote < i) {\n      closeQuote = exp.indexOf(\"'\", openSingleQuote + 1);\n      result += exp.substr(0, closeQuote + 1);\n      exp = exp.substr(closeQuote + 1);\n      i = exp.indexOf(\"${\");\n    } else if (openDoubleQuote >= 0 && openDoubleQuote < i) {\n      closeQuote = exp.indexOf('\"', openDoubleQuote + 1);\n      result += exp.substr(0, closeQuote + 1);\n      exp = exp.substr(closeQuote + 1);\n      i = exp.indexOf(\"${\");\n    } else {\n      result += exp.substr(0, i);\n      const j = exp.indexOf(\"}\");\n      if (j < 0) {\n        throw new RuntimeError(\"Unmatched {.\");\n      }\n      result += `czm_${exp.substr(i + 2, j - (i + 2))}`;\n      exp = exp.substr(j + 1);\n      i = exp.indexOf(\"${\");\n    }\n  }\n  result += exp;\n  return result;\n}\n\nfunction parseLiteral(ast) {\n  const type = typeof ast.value;\n  if (ast.value === null) {\n    return new Node(ExpressionNodeType.LITERAL_NULL, null);\n  } else if (type === \"boolean\") {\n    return new Node(ExpressionNodeType.LITERAL_BOOLEAN, ast.value);\n  } else if (type === \"number\") {\n    return new Node(ExpressionNodeType.LITERAL_NUMBER, ast.value);\n  } else if (type === \"string\") {\n    if (ast.value.indexOf(\"${\") >= 0) {\n      return new Node(ExpressionNodeType.VARIABLE_IN_STRING, ast.value);\n    }\n    return new Node(\n      ExpressionNodeType.LITERAL_STRING,\n      replaceBackslashes(ast.value)\n    );\n  }\n}\n\nfunction parseCall(expression, ast) {\n  const args = ast.arguments;\n  const argsLength = args.length;\n  let call;\n  let val, left, right;\n\n  // Member function calls\n  if (ast.callee.type === \"MemberExpression\") {\n    call = ast.callee.property.name;\n    const object = ast.callee.object;\n    if (call === \"test\" || call === \"exec\") {\n      // Make sure this is called on a valid type\n      if (object.callee.name !== \"regExp\") {\n        throw new RuntimeError(`${call} is not a function.`);\n      }\n      if (argsLength === 0) {\n        if (call === \"test\") {\n          return new Node(ExpressionNodeType.LITERAL_BOOLEAN, false);\n        }\n        return new Node(ExpressionNodeType.LITERAL_NULL, null);\n      }\n      left = createRuntimeAst(expression, object);\n      right = createRuntimeAst(expression, args[0]);\n      return new Node(ExpressionNodeType.FUNCTION_CALL, call, left, right);\n    } else if (call === \"toString\") {\n      val = createRuntimeAst(expression, object);\n      return new Node(ExpressionNodeType.FUNCTION_CALL, call, val);\n    }\n\n    throw new RuntimeError(`Unexpected function call \"${call}\".`);\n  }\n\n  // Non-member function calls\n  call = ast.callee.name;\n  if (call === \"color\") {\n    if (argsLength === 0) {\n      return new Node(ExpressionNodeType.LITERAL_COLOR, call);\n    }\n    val = createRuntimeAst(expression, args[0]);\n    if (defined(args[1])) {\n      const alpha = createRuntimeAst(expression, args[1]);\n      return new Node(ExpressionNodeType.LITERAL_COLOR, call, [val, alpha]);\n    }\n    return new Node(ExpressionNodeType.LITERAL_COLOR, call, [val]);\n  } else if (call === \"rgb\" || call === \"hsl\") {\n    if (argsLength < 3) {\n      throw new RuntimeError(`${call} requires three arguments.`);\n    }\n    val = [\n      createRuntimeAst(expression, args[0]),\n      createRuntimeAst(expression, args[1]),\n      createRuntimeAst(expression, args[2]),\n    ];\n    return new Node(ExpressionNodeType.LITERAL_COLOR, call, val);\n  } else if (call === \"rgba\" || call === \"hsla\") {\n    if (argsLength < 4) {\n      throw new RuntimeError(`${call} requires four arguments.`);\n    }\n    val = [\n      createRuntimeAst(expression, args[0]),\n      createRuntimeAst(expression, args[1]),\n      createRuntimeAst(expression, args[2]),\n      createRuntimeAst(expression, args[3]),\n    ];\n    return new Node(ExpressionNodeType.LITERAL_COLOR, call, val);\n  } else if (call === \"vec2\" || call === \"vec3\" || call === \"vec4\") {\n    // Check for invalid constructors at evaluation time\n    val = new Array(argsLength);\n    for (let i = 0; i < argsLength; ++i) {\n      val[i] = createRuntimeAst(expression, args[i]);\n    }\n    return new Node(ExpressionNodeType.LITERAL_VECTOR, call, val);\n  } else if (call === \"isNaN\" || call === \"isFinite\") {\n    if (argsLength === 0) {\n      if (call === \"isNaN\") {\n        return new Node(ExpressionNodeType.LITERAL_BOOLEAN, true);\n      }\n      return new Node(ExpressionNodeType.LITERAL_BOOLEAN, false);\n    }\n    val = createRuntimeAst(expression, args[0]);\n    return new Node(ExpressionNodeType.UNARY, call, val);\n  } else if (call === \"isExactClass\" || call === \"isClass\") {\n    if (argsLength < 1 || argsLength > 1) {\n      throw new RuntimeError(`${call} requires exactly one argument.`);\n    }\n    val = createRuntimeAst(expression, args[0]);\n    return new Node(ExpressionNodeType.UNARY, call, val);\n  } else if (call === \"getExactClassName\") {\n    if (argsLength > 0) {\n      throw new RuntimeError(`${call} does not take any argument.`);\n    }\n    return new Node(ExpressionNodeType.UNARY, call);\n  } else if (defined(unaryFunctions[call])) {\n    if (argsLength !== 1) {\n      throw new RuntimeError(`${call} requires exactly one argument.`);\n    }\n    val = createRuntimeAst(expression, args[0]);\n    return new Node(ExpressionNodeType.UNARY, call, val);\n  } else if (defined(binaryFunctions[call])) {\n    if (argsLength !== 2) {\n      throw new RuntimeError(`${call} requires exactly two arguments.`);\n    }\n    left = createRuntimeAst(expression, args[0]);\n    right = createRuntimeAst(expression, args[1]);\n    return new Node(ExpressionNodeType.BINARY, call, left, right);\n  } else if (defined(ternaryFunctions[call])) {\n    if (argsLength !== 3) {\n      throw new RuntimeError(`${call} requires exactly three arguments.`);\n    }\n    left = createRuntimeAst(expression, args[0]);\n    right = createRuntimeAst(expression, args[1]);\n    const test = createRuntimeAst(expression, args[2]);\n    return new Node(ExpressionNodeType.TERNARY, call, left, right, test);\n  } else if (call === \"Boolean\") {\n    if (argsLength === 0) {\n      return new Node(ExpressionNodeType.LITERAL_BOOLEAN, false);\n    }\n    val = createRuntimeAst(expression, args[0]);\n    return new Node(ExpressionNodeType.UNARY, call, val);\n  } else if (call === \"Number\") {\n    if (argsLength === 0) {\n      return new Node(ExpressionNodeType.LITERAL_NUMBER, 0);\n    }\n    val = createRuntimeAst(expression, args[0]);\n    return new Node(ExpressionNodeType.UNARY, call, val);\n  } else if (call === \"String\") {\n    if (argsLength === 0) {\n      return new Node(ExpressionNodeType.LITERAL_STRING, \"\");\n    }\n    val = createRuntimeAst(expression, args[0]);\n    return new Node(ExpressionNodeType.UNARY, call, val);\n  } else if (call === \"regExp\") {\n    return parseRegex(expression, ast);\n  }\n\n  throw new RuntimeError(`Unexpected function call \"${call}\".`);\n}\n\nfunction parseRegex(expression, ast) {\n  const args = ast.arguments;\n  // no arguments, return default regex\n  if (args.length === 0) {\n    return new Node(ExpressionNodeType.LITERAL_REGEX, new RegExp());\n  }\n\n  const pattern = createRuntimeAst(expression, args[0]);\n  let exp;\n\n  // optional flag argument supplied\n  if (args.length > 1) {\n    const flags = createRuntimeAst(expression, args[1]);\n    if (isLiteralType(pattern) && isLiteralType(flags)) {\n      try {\n        exp = new RegExp(\n          replaceBackslashes(String(pattern._value)),\n          flags._value\n        );\n      } catch (e) {\n        throw new RuntimeError(e);\n      }\n      return new Node(ExpressionNodeType.LITERAL_REGEX, exp);\n    }\n    return new Node(ExpressionNodeType.REGEX, pattern, flags);\n  }\n\n  // only pattern argument supplied\n  if (isLiteralType(pattern)) {\n    try {\n      exp = new RegExp(replaceBackslashes(String(pattern._value)));\n    } catch (e) {\n      throw new RuntimeError(e);\n    }\n    return new Node(ExpressionNodeType.LITERAL_REGEX, exp);\n  }\n  return new Node(ExpressionNodeType.REGEX, pattern);\n}\n\nfunction parseKeywordsAndVariables(ast) {\n  if (isVariable(ast.name)) {\n    const name = getPropertyName(ast.name);\n    if (name.substr(0, 8) === \"tiles3d_\") {\n      return new Node(ExpressionNodeType.BUILTIN_VARIABLE, name);\n    }\n    return new Node(ExpressionNodeType.VARIABLE, name);\n  } else if (ast.name === \"NaN\") {\n    return new Node(ExpressionNodeType.LITERAL_NUMBER, NaN);\n  } else if (ast.name === \"Infinity\") {\n    return new Node(ExpressionNodeType.LITERAL_NUMBER, Infinity);\n  } else if (ast.name === \"undefined\") {\n    return new Node(ExpressionNodeType.LITERAL_UNDEFINED, undefined);\n  }\n\n  throw new RuntimeError(`${ast.name} is not defined.`);\n}\n\nfunction parseMathConstant(ast) {\n  const name = ast.property.name;\n  if (name === \"PI\") {\n    return new Node(ExpressionNodeType.LITERAL_NUMBER, Math.PI);\n  } else if (name === \"E\") {\n    return new Node(ExpressionNodeType.LITERAL_NUMBER, Math.E);\n  }\n}\n\nfunction parseNumberConstant(ast) {\n  const name = ast.property.name;\n  if (name === \"POSITIVE_INFINITY\") {\n    return new Node(\n      ExpressionNodeType.LITERAL_NUMBER,\n      Number.POSITIVE_INFINITY\n    );\n  }\n}\n\nfunction parseMemberExpression(expression, ast) {\n  if (ast.object.name === \"Math\") {\n    return parseMathConstant(ast);\n  } else if (ast.object.name === \"Number\") {\n    return parseNumberConstant(ast);\n  }\n\n  let val;\n  const obj = createRuntimeAst(expression, ast.object);\n  if (ast.computed) {\n    val = createRuntimeAst(expression, ast.property);\n    return new Node(ExpressionNodeType.MEMBER, \"brackets\", obj, val);\n  }\n\n  val = new Node(ExpressionNodeType.LITERAL_STRING, ast.property.name);\n  return new Node(ExpressionNodeType.MEMBER, \"dot\", obj, val);\n}\n\nfunction isLiteralType(node) {\n  return node._type >= ExpressionNodeType.LITERAL_NULL;\n}\n\nfunction isVariable(name) {\n  return name.substr(0, 4) === \"czm_\";\n}\n\nfunction getPropertyName(variable) {\n  return variable.substr(4);\n}\n\nfunction createRuntimeAst(expression, ast) {\n  let node;\n  let op;\n  let left;\n  let right;\n\n  if (ast.type === \"Literal\") {\n    node = parseLiteral(ast);\n  } else if (ast.type === \"CallExpression\") {\n    node = parseCall(expression, ast);\n  } else if (ast.type === \"Identifier\") {\n    node = parseKeywordsAndVariables(ast);\n  } else if (ast.type === \"UnaryExpression\") {\n    op = ast.operator;\n    const child = createRuntimeAst(expression, ast.argument);\n    if (unaryOperators.indexOf(op) > -1) {\n      node = new Node(ExpressionNodeType.UNARY, op, child);\n    } else {\n      throw new RuntimeError(`Unexpected operator \"${op}\".`);\n    }\n  } else if (ast.type === \"BinaryExpression\") {\n    op = ast.operator;\n    left = createRuntimeAst(expression, ast.left);\n    right = createRuntimeAst(expression, ast.right);\n    if (binaryOperators.indexOf(op) > -1) {\n      node = new Node(ExpressionNodeType.BINARY, op, left, right);\n    } else {\n      throw new RuntimeError(`Unexpected operator \"${op}\".`);\n    }\n  } else if (ast.type === \"LogicalExpression\") {\n    op = ast.operator;\n    left = createRuntimeAst(expression, ast.left);\n    right = createRuntimeAst(expression, ast.right);\n    if (binaryOperators.indexOf(op) > -1) {\n      node = new Node(ExpressionNodeType.BINARY, op, left, right);\n    }\n  } else if (ast.type === \"ConditionalExpression\") {\n    const test = createRuntimeAst(expression, ast.test);\n    left = createRuntimeAst(expression, ast.consequent);\n    right = createRuntimeAst(expression, ast.alternate);\n    node = new Node(ExpressionNodeType.CONDITIONAL, \"?\", left, right, test);\n  } else if (ast.type === \"MemberExpression\") {\n    node = parseMemberExpression(expression, ast);\n  } else if (ast.type === \"ArrayExpression\") {\n    const val = [];\n    for (let i = 0; i < ast.elements.length; i++) {\n      val[i] = createRuntimeAst(expression, ast.elements[i]);\n    }\n    node = new Node(ExpressionNodeType.ARRAY, val);\n  } else if (ast.type === \"Compound\") {\n    // empty expression or multiple expressions\n    throw new RuntimeError(\"Provide exactly one expression.\");\n  } else {\n    throw new RuntimeError(\"Cannot parse expression.\");\n  }\n\n  return node;\n}\n\nfunction setEvaluateFunction(node) {\n  if (node._type === ExpressionNodeType.CONDITIONAL) {\n    node.evaluate = node._evaluateConditional;\n  } else if (node._type === ExpressionNodeType.FUNCTION_CALL) {\n    if (node._value === \"test\") {\n      node.evaluate = node._evaluateRegExpTest;\n    } else if (node._value === \"exec\") {\n      node.evaluate = node._evaluateRegExpExec;\n    } else if (node._value === \"toString\") {\n      node.evaluate = node._evaluateToString;\n    }\n  } else if (node._type === ExpressionNodeType.UNARY) {\n    if (node._value === \"!\") {\n      node.evaluate = node._evaluateNot;\n    } else if (node._value === \"-\") {\n      node.evaluate = node._evaluateNegative;\n    } else if (node._value === \"+\") {\n      node.evaluate = node._evaluatePositive;\n    } else if (node._value === \"isNaN\") {\n      node.evaluate = node._evaluateNaN;\n    } else if (node._value === \"isFinite\") {\n      node.evaluate = node._evaluateIsFinite;\n    } else if (node._value === \"isExactClass\") {\n      node.evaluate = node._evaluateIsExactClass;\n    } else if (node._value === \"isClass\") {\n      node.evaluate = node._evaluateIsClass;\n    } else if (node._value === \"getExactClassName\") {\n      node.evaluate = node._evaluateGetExactClassName;\n    } else if (node._value === \"Boolean\") {\n      node.evaluate = node._evaluateBooleanConversion;\n    } else if (node._value === \"Number\") {\n      node.evaluate = node._evaluateNumberConversion;\n    } else if (node._value === \"String\") {\n      node.evaluate = node._evaluateStringConversion;\n    } else if (defined(unaryFunctions[node._value])) {\n      node.evaluate = getEvaluateUnaryFunction(node._value);\n    }\n  } else if (node._type === ExpressionNodeType.BINARY) {\n    if (node._value === \"+\") {\n      node.evaluate = node._evaluatePlus;\n    } else if (node._value === \"-\") {\n      node.evaluate = node._evaluateMinus;\n    } else if (node._value === \"*\") {\n      node.evaluate = node._evaluateTimes;\n    } else if (node._value === \"/\") {\n      node.evaluate = node._evaluateDivide;\n    } else if (node._value === \"%\") {\n      node.evaluate = node._evaluateMod;\n    } else if (node._value === \"===\") {\n      node.evaluate = node._evaluateEqualsStrict;\n    } else if (node._value === \"!==\") {\n      node.evaluate = node._evaluateNotEqualsStrict;\n    } else if (node._value === \"<\") {\n      node.evaluate = node._evaluateLessThan;\n    } else if (node._value === \"<=\") {\n      node.evaluate = node._evaluateLessThanOrEquals;\n    } else if (node._value === \">\") {\n      node.evaluate = node._evaluateGreaterThan;\n    } else if (node._value === \">=\") {\n      node.evaluate = node._evaluateGreaterThanOrEquals;\n    } else if (node._value === \"&&\") {\n      node.evaluate = node._evaluateAnd;\n    } else if (node._value === \"||\") {\n      node.evaluate = node._evaluateOr;\n    } else if (node._value === \"=~\") {\n      node.evaluate = node._evaluateRegExpMatch;\n    } else if (node._value === \"!~\") {\n      node.evaluate = node._evaluateRegExpNotMatch;\n    } else if (defined(binaryFunctions[node._value])) {\n      node.evaluate = getEvaluateBinaryFunction(node._value);\n    }\n  } else if (node._type === ExpressionNodeType.TERNARY) {\n    node.evaluate = getEvaluateTernaryFunction(node._value);\n  } else if (node._type === ExpressionNodeType.MEMBER) {\n    if (node._value === \"brackets\") {\n      node.evaluate = node._evaluateMemberBrackets;\n    } else {\n      node.evaluate = node._evaluateMemberDot;\n    }\n  } else if (node._type === ExpressionNodeType.ARRAY) {\n    node.evaluate = node._evaluateArray;\n  } else if (node._type === ExpressionNodeType.VARIABLE) {\n    node.evaluate = node._evaluateVariable;\n  } else if (node._type === ExpressionNodeType.VARIABLE_IN_STRING) {\n    node.evaluate = node._evaluateVariableString;\n  } else if (node._type === ExpressionNodeType.LITERAL_COLOR) {\n    node.evaluate = node._evaluateLiteralColor;\n  } else if (node._type === ExpressionNodeType.LITERAL_VECTOR) {\n    node.evaluate = node._evaluateLiteralVector;\n  } else if (node._type === ExpressionNodeType.LITERAL_STRING) {\n    node.evaluate = node._evaluateLiteralString;\n  } else if (node._type === ExpressionNodeType.REGEX) {\n    node.evaluate = node._evaluateRegExp;\n  } else if (node._type === ExpressionNodeType.BUILTIN_VARIABLE) {\n    if (node._value === \"tiles3d_tileset_time\") {\n      node.evaluate = evaluateTilesetTime;\n    }\n  } else {\n    node.evaluate = node._evaluateLiteral;\n  }\n}\n\nfunction evaluateTilesetTime(feature) {\n  if (!defined(feature)) {\n    return 0.0;\n  }\n  return feature.content.tileset.timeSinceLoad;\n}\n\nfunction getEvaluateUnaryFunction(call) {\n  const evaluate = unaryFunctions[call];\n  return function (feature) {\n    const left = this._left.evaluate(feature);\n    return evaluate(call, left);\n  };\n}\n\nfunction getEvaluateBinaryFunction(call) {\n  const evaluate = binaryFunctions[call];\n  return function (feature) {\n    const left = this._left.evaluate(feature);\n    const right = this._right.evaluate(feature);\n    return evaluate(call, left, right);\n  };\n}\n\nfunction getEvaluateTernaryFunction(call) {\n  const evaluate = ternaryFunctions[call];\n  return function (feature) {\n    const left = this._left.evaluate(feature);\n    const right = this._right.evaluate(feature);\n    const test = this._test.evaluate(feature);\n    return evaluate(call, left, right, test);\n  };\n}\n\nfunction getFeatureProperty(feature, name) {\n  // Returns undefined if the feature is not defined or the property name is not defined for that feature\n  if (defined(feature)) {\n    return feature.getPropertyInherited(name);\n  }\n}\n\nNode.prototype._evaluateLiteral = function () {\n  return this._value;\n};\n\nNode.prototype._evaluateLiteralColor = function (feature) {\n  const color = scratchColor;\n  const args = this._left;\n  if (this._value === \"color\") {\n    if (!defined(args)) {\n      Color.fromBytes(255, 255, 255, 255, color);\n    } else if (args.length > 1) {\n      Color.fromCssColorString(args[0].evaluate(feature), color);\n      color.alpha = args[1].evaluate(feature);\n    } else {\n      Color.fromCssColorString(args[0].evaluate(feature), color);\n    }\n  } else if (this._value === \"rgb\") {\n    Color.fromBytes(\n      args[0].evaluate(feature),\n      args[1].evaluate(feature),\n      args[2].evaluate(feature),\n      255,\n      color\n    );\n  } else if (this._value === \"rgba\") {\n    // convert between css alpha (0 to 1) and cesium alpha (0 to 255)\n    const a = args[3].evaluate(feature) * 255;\n    Color.fromBytes(\n      args[0].evaluate(feature),\n      args[1].evaluate(feature),\n      args[2].evaluate(feature),\n      a,\n      color\n    );\n  } else if (this._value === \"hsl\") {\n    Color.fromHsl(\n      args[0].evaluate(feature),\n      args[1].evaluate(feature),\n      args[2].evaluate(feature),\n      1.0,\n      color\n    );\n  } else if (this._value === \"hsla\") {\n    Color.fromHsl(\n      args[0].evaluate(feature),\n      args[1].evaluate(feature),\n      args[2].evaluate(feature),\n      args[3].evaluate(feature),\n      color\n    );\n  }\n  return Cartesian4.fromColor(color, scratchStorage.getCartesian4());\n};\n\nNode.prototype._evaluateLiteralVector = function (feature) {\n  // Gather the components that make up the vector, which includes components from interior vectors.\n  // For example vec3(1, 2, 3) or vec3(vec2(1, 2), 3) are both valid.\n  //\n  // If the number of components does not equal the vector's size, then a RuntimeError is thrown - with two exceptions:\n  // 1. A vector may be constructed from a larger vector and drop the extra components.\n  // 2. A vector may be constructed from a single component - vec3(1) will become vec3(1, 1, 1).\n  //\n  // Examples of invalid constructors include:\n  // vec4(1, 2)        // not enough components\n  // vec3(vec2(1, 2))  // not enough components\n  // vec3(1, 2, 3, 4)  // too many components\n  // vec2(vec4(1), 1)  // too many components\n\n  const components = scratchStorage.getArray();\n  const call = this._value;\n  const args = this._left;\n  const argsLength = args.length;\n  for (let i = 0; i < argsLength; ++i) {\n    const value = args[i].evaluate(feature);\n    if (typeof value === \"number\") {\n      components.push(value);\n    } else if (value instanceof Cartesian2) {\n      components.push(value.x, value.y);\n    } else if (value instanceof Cartesian3) {\n      components.push(value.x, value.y, value.z);\n    } else if (value instanceof Cartesian4) {\n      components.push(value.x, value.y, value.z, value.w);\n    } else {\n      throw new RuntimeError(\n        `${call} argument must be a vector or number. Argument is ${value}.`\n      );\n    }\n  }\n\n  const componentsLength = components.length;\n  const vectorLength = parseInt(call.charAt(3));\n\n  if (componentsLength === 0) {\n    throw new RuntimeError(`Invalid ${call} constructor. No valid arguments.`);\n  } else if (componentsLength < vectorLength && componentsLength > 1) {\n    throw new RuntimeError(\n      `Invalid ${call} constructor. Not enough arguments.`\n    );\n  } else if (componentsLength > vectorLength && argsLength > 1) {\n    throw new RuntimeError(`Invalid ${call} constructor. Too many arguments.`);\n  }\n\n  if (componentsLength === 1) {\n    // Add the same component 3 more times\n    const component = components[0];\n    components.push(component, component, component);\n  }\n\n  if (call === \"vec2\") {\n    return Cartesian2.fromArray(components, 0, scratchStorage.getCartesian2());\n  } else if (call === \"vec3\") {\n    return Cartesian3.fromArray(components, 0, scratchStorage.getCartesian3());\n  } else if (call === \"vec4\") {\n    return Cartesian4.fromArray(components, 0, scratchStorage.getCartesian4());\n  }\n};\n\nNode.prototype._evaluateLiteralString = function () {\n  return this._value;\n};\n\nNode.prototype._evaluateVariableString = function (feature) {\n  let result = this._value;\n  let match = variableRegex.exec(result);\n  while (match !== null) {\n    const placeholder = match[0];\n    const variableName = match[1];\n    let property = getFeatureProperty(feature, variableName);\n    if (!defined(property)) {\n      property = \"\";\n    }\n    result = result.replace(placeholder, property);\n    match = variableRegex.exec(result);\n  }\n  return result;\n};\n\nNode.prototype._evaluateVariable = function (feature) {\n  // evaluates to undefined if the property name is not defined for that feature\n  return getFeatureProperty(feature, this._value);\n};\n\nfunction checkFeature(ast) {\n  return ast._value === \"feature\";\n}\n\n// PERFORMANCE_IDEA: Determine if parent property needs to be computed before runtime\nNode.prototype._evaluateMemberDot = function (feature) {\n  if (checkFeature(this._left)) {\n    return getFeatureProperty(feature, this._right.evaluate(feature));\n  }\n  const property = this._left.evaluate(feature);\n  if (!defined(property)) {\n    return undefined;\n  }\n\n  const member = this._right.evaluate(feature);\n  if (\n    property instanceof Cartesian2 ||\n    property instanceof Cartesian3 ||\n    property instanceof Cartesian4\n  ) {\n    // Vector components may be accessed with .r, .g, .b, .a and implicitly with .x, .y, .z, .w\n    if (member === \"r\") {\n      return property.x;\n    } else if (member === \"g\") {\n      return property.y;\n    } else if (member === \"b\") {\n      return property.z;\n    } else if (member === \"a\") {\n      return property.w;\n    }\n  }\n  return property[member];\n};\n\nNode.prototype._evaluateMemberBrackets = function (feature) {\n  if (checkFeature(this._left)) {\n    return getFeatureProperty(feature, this._right.evaluate(feature));\n  }\n  const property = this._left.evaluate(feature);\n  if (!defined(property)) {\n    return undefined;\n  }\n\n  const member = this._right.evaluate(feature);\n  if (\n    property instanceof Cartesian2 ||\n    property instanceof Cartesian3 ||\n    property instanceof Cartesian4\n  ) {\n    // Vector components may be accessed with [0][1][2][3], ['r']['g']['b']['a'] and implicitly with ['x']['y']['z']['w']\n    // For Cartesian2 and Cartesian3 out-of-range components will just return undefined\n    if (member === 0 || member === \"r\") {\n      return property.x;\n    } else if (member === 1 || member === \"g\") {\n      return property.y;\n    } else if (member === 2 || member === \"b\") {\n      return property.z;\n    } else if (member === 3 || member === \"a\") {\n      return property.w;\n    }\n  }\n  return property[member];\n};\n\nNode.prototype._evaluateArray = function (feature) {\n  const array = [];\n  for (let i = 0; i < this._value.length; i++) {\n    array[i] = this._value[i].evaluate(feature);\n  }\n  return array;\n};\n\n// PERFORMANCE_IDEA: Have \"fast path\" functions that deal only with specific types\n// that we can assign if we know the types before runtime\n\nNode.prototype._evaluateNot = function (feature) {\n  const left = this._left.evaluate(feature);\n  if (typeof left !== \"boolean\") {\n    throw new RuntimeError(\n      `Operator \"!\" requires a boolean argument. Argument is ${left}.`\n    );\n  }\n  return !left;\n};\n\nNode.prototype._evaluateNegative = function (feature) {\n  const left = this._left.evaluate(feature);\n  if (left instanceof Cartesian2) {\n    return Cartesian2.negate(left, scratchStorage.getCartesian2());\n  } else if (left instanceof Cartesian3) {\n    return Cartesian3.negate(left, scratchStorage.getCartesian3());\n  } else if (left instanceof Cartesian4) {\n    return Cartesian4.negate(left, scratchStorage.getCartesian4());\n  } else if (typeof left === \"number\") {\n    return -left;\n  }\n\n  throw new RuntimeError(\n    `Operator \"-\" requires a vector or number argument. Argument is ${left}.`\n  );\n};\n\nNode.prototype._evaluatePositive = function (feature) {\n  const left = this._left.evaluate(feature);\n\n  if (\n    !(\n      left instanceof Cartesian2 ||\n      left instanceof Cartesian3 ||\n      left instanceof Cartesian4 ||\n      typeof left === \"number\"\n    )\n  ) {\n    throw new RuntimeError(\n      `Operator \"+\" requires a vector or number argument. Argument is ${left}.`\n    );\n  }\n\n  return left;\n};\n\nNode.prototype._evaluateLessThan = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (typeof left !== \"number\" || typeof right !== \"number\") {\n    throw new RuntimeError(\n      `Operator \"<\" requires number arguments. Arguments are ${left} and ${right}.`\n    );\n  }\n\n  return left < right;\n};\n\nNode.prototype._evaluateLessThanOrEquals = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (typeof left !== \"number\" || typeof right !== \"number\") {\n    throw new RuntimeError(\n      `Operator \"<=\" requires number arguments. Arguments are ${left} and ${right}.`\n    );\n  }\n\n  return left <= right;\n};\n\nNode.prototype._evaluateGreaterThan = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (typeof left !== \"number\" || typeof right !== \"number\") {\n    throw new RuntimeError(\n      `Operator \">\" requires number arguments. Arguments are ${left} and ${right}.`\n    );\n  }\n\n  return left > right;\n};\n\nNode.prototype._evaluateGreaterThanOrEquals = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (typeof left !== \"number\" || typeof right !== \"number\") {\n    throw new RuntimeError(\n      `Operator \">=\" requires number arguments. Arguments are ${left} and ${right}.`\n    );\n  }\n\n  return left >= right;\n};\n\nNode.prototype._evaluateOr = function (feature) {\n  const left = this._left.evaluate(feature);\n  if (typeof left !== \"boolean\") {\n    throw new RuntimeError(\n      `Operator \"||\" requires boolean arguments. First argument is ${left}.`\n    );\n  }\n\n  // short circuit the expression\n  if (left) {\n    return true;\n  }\n\n  const right = this._right.evaluate(feature);\n  if (typeof right !== \"boolean\") {\n    throw new RuntimeError(\n      `Operator \"||\" requires boolean arguments. Second argument is ${right}.`\n    );\n  }\n\n  return left || right;\n};\n\nNode.prototype._evaluateAnd = function (feature) {\n  const left = this._left.evaluate(feature);\n  if (typeof left !== \"boolean\") {\n    throw new RuntimeError(\n      `Operator \"&&\" requires boolean arguments. First argument is ${left}.`\n    );\n  }\n\n  // short circuit the expression\n  if (!left) {\n    return false;\n  }\n\n  const right = this._right.evaluate(feature);\n  if (typeof right !== \"boolean\") {\n    throw new RuntimeError(\n      `Operator \"&&\" requires boolean arguments. Second argument is ${right}.`\n    );\n  }\n\n  return left && right;\n};\n\nNode.prototype._evaluatePlus = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (right instanceof Cartesian2 && left instanceof Cartesian2) {\n    return Cartesian2.add(left, right, scratchStorage.getCartesian2());\n  } else if (right instanceof Cartesian3 && left instanceof Cartesian3) {\n    return Cartesian3.add(left, right, scratchStorage.getCartesian3());\n  } else if (right instanceof Cartesian4 && left instanceof Cartesian4) {\n    return Cartesian4.add(left, right, scratchStorage.getCartesian4());\n  } else if (typeof left === \"string\" || typeof right === \"string\") {\n    // If only one argument is a string the other argument calls its toString function.\n    return left + right;\n  } else if (typeof left === \"number\" && typeof right === \"number\") {\n    return left + right;\n  }\n\n  throw new RuntimeError(\n    `Operator \"+\" requires vector or number arguments of matching types, or at least one string argument. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateMinus = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (right instanceof Cartesian2 && left instanceof Cartesian2) {\n    return Cartesian2.subtract(left, right, scratchStorage.getCartesian2());\n  } else if (right instanceof Cartesian3 && left instanceof Cartesian3) {\n    return Cartesian3.subtract(left, right, scratchStorage.getCartesian3());\n  } else if (right instanceof Cartesian4 && left instanceof Cartesian4) {\n    return Cartesian4.subtract(left, right, scratchStorage.getCartesian4());\n  } else if (typeof left === \"number\" && typeof right === \"number\") {\n    return left - right;\n  }\n\n  throw new RuntimeError(\n    `Operator \"-\" requires vector or number arguments of matching types. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateTimes = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (right instanceof Cartesian2 && left instanceof Cartesian2) {\n    return Cartesian2.multiplyComponents(\n      left,\n      right,\n      scratchStorage.getCartesian2()\n    );\n  } else if (right instanceof Cartesian2 && typeof left === \"number\") {\n    return Cartesian2.multiplyByScalar(\n      right,\n      left,\n      scratchStorage.getCartesian2()\n    );\n  } else if (left instanceof Cartesian2 && typeof right === \"number\") {\n    return Cartesian2.multiplyByScalar(\n      left,\n      right,\n      scratchStorage.getCartesian2()\n    );\n  } else if (right instanceof Cartesian3 && left instanceof Cartesian3) {\n    return Cartesian3.multiplyComponents(\n      left,\n      right,\n      scratchStorage.getCartesian3()\n    );\n  } else if (right instanceof Cartesian3 && typeof left === \"number\") {\n    return Cartesian3.multiplyByScalar(\n      right,\n      left,\n      scratchStorage.getCartesian3()\n    );\n  } else if (left instanceof Cartesian3 && typeof right === \"number\") {\n    return Cartesian3.multiplyByScalar(\n      left,\n      right,\n      scratchStorage.getCartesian3()\n    );\n  } else if (right instanceof Cartesian4 && left instanceof Cartesian4) {\n    return Cartesian4.multiplyComponents(\n      left,\n      right,\n      scratchStorage.getCartesian4()\n    );\n  } else if (right instanceof Cartesian4 && typeof left === \"number\") {\n    return Cartesian4.multiplyByScalar(\n      right,\n      left,\n      scratchStorage.getCartesian4()\n    );\n  } else if (left instanceof Cartesian4 && typeof right === \"number\") {\n    return Cartesian4.multiplyByScalar(\n      left,\n      right,\n      scratchStorage.getCartesian4()\n    );\n  } else if (typeof left === \"number\" && typeof right === \"number\") {\n    return left * right;\n  }\n\n  throw new RuntimeError(\n    `Operator \"*\" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateDivide = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (right instanceof Cartesian2 && left instanceof Cartesian2) {\n    return Cartesian2.divideComponents(\n      left,\n      right,\n      scratchStorage.getCartesian2()\n    );\n  } else if (left instanceof Cartesian2 && typeof right === \"number\") {\n    return Cartesian2.divideByScalar(\n      left,\n      right,\n      scratchStorage.getCartesian2()\n    );\n  } else if (right instanceof Cartesian3 && left instanceof Cartesian3) {\n    return Cartesian3.divideComponents(\n      left,\n      right,\n      scratchStorage.getCartesian3()\n    );\n  } else if (left instanceof Cartesian3 && typeof right === \"number\") {\n    return Cartesian3.divideByScalar(\n      left,\n      right,\n      scratchStorage.getCartesian3()\n    );\n  } else if (right instanceof Cartesian4 && left instanceof Cartesian4) {\n    return Cartesian4.divideComponents(\n      left,\n      right,\n      scratchStorage.getCartesian4()\n    );\n  } else if (left instanceof Cartesian4 && typeof right === \"number\") {\n    return Cartesian4.divideByScalar(\n      left,\n      right,\n      scratchStorage.getCartesian4()\n    );\n  } else if (typeof left === \"number\" && typeof right === \"number\") {\n    return left / right;\n  }\n\n  throw new RuntimeError(\n    `Operator \"/\" requires vector or number arguments of matching types, or a number as the second argument. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateMod = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (right instanceof Cartesian2 && left instanceof Cartesian2) {\n    return Cartesian2.fromElements(\n      left.x % right.x,\n      left.y % right.y,\n      scratchStorage.getCartesian2()\n    );\n  } else if (right instanceof Cartesian3 && left instanceof Cartesian3) {\n    return Cartesian3.fromElements(\n      left.x % right.x,\n      left.y % right.y,\n      left.z % right.z,\n      scratchStorage.getCartesian3()\n    );\n  } else if (right instanceof Cartesian4 && left instanceof Cartesian4) {\n    return Cartesian4.fromElements(\n      left.x % right.x,\n      left.y % right.y,\n      left.z % right.z,\n      left.w % right.w,\n      scratchStorage.getCartesian4()\n    );\n  } else if (typeof left === \"number\" && typeof right === \"number\") {\n    return left % right;\n  }\n\n  throw new RuntimeError(\n    `Operator \"%\" requires vector or number arguments of matching types. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateEqualsStrict = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (\n    (right instanceof Cartesian2 && left instanceof Cartesian2) ||\n    (right instanceof Cartesian3 && left instanceof Cartesian3) ||\n    (right instanceof Cartesian4 && left instanceof Cartesian4)\n  ) {\n    return left.equals(right);\n  }\n  return left === right;\n};\n\nNode.prototype._evaluateNotEqualsStrict = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n  if (\n    (right instanceof Cartesian2 && left instanceof Cartesian2) ||\n    (right instanceof Cartesian3 && left instanceof Cartesian3) ||\n    (right instanceof Cartesian4 && left instanceof Cartesian4)\n  ) {\n    return !left.equals(right);\n  }\n  return left !== right;\n};\n\nNode.prototype._evaluateConditional = function (feature) {\n  const test = this._test.evaluate(feature);\n\n  if (typeof test !== \"boolean\") {\n    throw new RuntimeError(\n      `Conditional argument of conditional expression must be a boolean. Argument is ${test}.`\n    );\n  }\n\n  if (test) {\n    return this._left.evaluate(feature);\n  }\n  return this._right.evaluate(feature);\n};\n\nNode.prototype._evaluateNaN = function (feature) {\n  return isNaN(this._left.evaluate(feature));\n};\n\nNode.prototype._evaluateIsFinite = function (feature) {\n  return isFinite(this._left.evaluate(feature));\n};\n\nNode.prototype._evaluateIsExactClass = function (feature) {\n  if (defined(feature)) {\n    return feature.isExactClass(this._left.evaluate(feature));\n  }\n  return false;\n};\n\nNode.prototype._evaluateIsClass = function (feature) {\n  if (defined(feature)) {\n    return feature.isClass(this._left.evaluate(feature));\n  }\n  return false;\n};\n\nNode.prototype._evaluateGetExactClassName = function (feature) {\n  if (defined(feature)) {\n    return feature.getExactClassName();\n  }\n};\n\nNode.prototype._evaluateBooleanConversion = function (feature) {\n  return Boolean(this._left.evaluate(feature));\n};\n\nNode.prototype._evaluateNumberConversion = function (feature) {\n  return Number(this._left.evaluate(feature));\n};\n\nNode.prototype._evaluateStringConversion = function (feature) {\n  return String(this._left.evaluate(feature));\n};\n\nNode.prototype._evaluateRegExp = function (feature) {\n  const pattern = this._value.evaluate(feature);\n  let flags = \"\";\n\n  if (defined(this._left)) {\n    flags = this._left.evaluate(feature);\n  }\n\n  let exp;\n  try {\n    exp = new RegExp(pattern, flags);\n  } catch (e) {\n    throw new RuntimeError(e);\n  }\n  return exp;\n};\n\nNode.prototype._evaluateRegExpTest = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (!(left instanceof RegExp && typeof right === \"string\")) {\n    throw new RuntimeError(\n      `RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${left} and ${right}.`\n    );\n  }\n\n  return left.test(right);\n};\n\nNode.prototype._evaluateRegExpMatch = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (left instanceof RegExp && typeof right === \"string\") {\n    return left.test(right);\n  } else if (right instanceof RegExp && typeof left === \"string\") {\n    return right.test(left);\n  }\n\n  throw new RuntimeError(\n    `Operator \"=~\" requires one RegExp argument and one string argument. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateRegExpNotMatch = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (left instanceof RegExp && typeof right === \"string\") {\n    return !left.test(right);\n  } else if (right instanceof RegExp && typeof left === \"string\") {\n    return !right.test(left);\n  }\n\n  throw new RuntimeError(\n    `Operator \"!~\" requires one RegExp argument and one string argument. Arguments are ${left} and ${right}.`\n  );\n};\n\nNode.prototype._evaluateRegExpExec = function (feature) {\n  const left = this._left.evaluate(feature);\n  const right = this._right.evaluate(feature);\n\n  if (!(left instanceof RegExp && typeof right === \"string\")) {\n    throw new RuntimeError(\n      `RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${left} and ${right}.`\n    );\n  }\n\n  const exec = left.exec(right);\n  if (!defined(exec)) {\n    return null;\n  }\n  return exec[1];\n};\n\nNode.prototype._evaluateToString = function (feature) {\n  const left = this._left.evaluate(feature);\n  if (\n    left instanceof RegExp ||\n    left instanceof Cartesian2 ||\n    left instanceof Cartesian3 ||\n    left instanceof Cartesian4\n  ) {\n    return String(left);\n  }\n\n  throw new RuntimeError(`Unexpected function call \"${this._value}\".`);\n};\n\nfunction convertHSLToRGB(ast) {\n  // Check if the color contains any nested expressions to see if the color can be converted here.\n  // E.g. \"hsl(0.9, 0.6, 0.7)\" is able to convert directly to rgb, \"hsl(0.9, 0.6, ${Height})\" is not.\n  const channels = ast._left;\n  const length = channels.length;\n  for (let i = 0; i < length; ++i) {\n    if (channels[i]._type !== ExpressionNodeType.LITERAL_NUMBER) {\n      return undefined;\n    }\n  }\n  const h = channels[0]._value;\n  const s = channels[1]._value;\n  const l = channels[2]._value;\n  const a = length === 4 ? channels[3]._value : 1.0;\n  return Color.fromHsl(h, s, l, a, scratchColor);\n}\n\nfunction convertRGBToColor(ast) {\n  // Check if the color contains any nested expressions to see if the color can be converted here.\n  // E.g. \"rgb(255, 255, 255)\" is able to convert directly to Color, \"rgb(255, 255, ${Height})\" is not.\n  const channels = ast._left;\n  const length = channels.length;\n  for (let i = 0; i < length; ++i) {\n    if (channels[i]._type !== ExpressionNodeType.LITERAL_NUMBER) {\n      return undefined;\n    }\n  }\n  const color = scratchColor;\n  color.red = channels[0]._value / 255.0;\n  color.green = channels[1]._value / 255.0;\n  color.blue = channels[2]._value / 255.0;\n  color.alpha = length === 4 ? channels[3]._value : 1.0;\n  return color;\n}\n\nfunction numberToString(number) {\n  if (number % 1 === 0) {\n    // Add a .0 to whole numbers\n    return number.toFixed(1);\n  }\n\n  return number.toString();\n}\n\nfunction colorToVec3(color) {\n  const r = numberToString(color.red);\n  const g = numberToString(color.green);\n  const b = numberToString(color.blue);\n  return `vec3(${r}, ${g}, ${b})`;\n}\n\nfunction colorToVec4(color) {\n  const r = numberToString(color.red);\n  const g = numberToString(color.green);\n  const b = numberToString(color.blue);\n  const a = numberToString(color.alpha);\n  return `vec4(${r}, ${g}, ${b}, ${a})`;\n}\n\nfunction getExpressionArray(\n  array,\n  variableSubstitutionMap,\n  shaderState,\n  parent\n) {\n  const length = array.length;\n  const expressions = new Array(length);\n  for (let i = 0; i < length; ++i) {\n    expressions[i] = array[i].getShaderExpression(\n      variableSubstitutionMap,\n      shaderState,\n      parent\n    );\n  }\n  return expressions;\n}\n\nfunction getVariableName(variableName, variableSubstitutionMap) {\n  if (!defined(variableSubstitutionMap[variableName])) {\n    return Expression.NULL_SENTINEL;\n  }\n\n  return variableSubstitutionMap[variableName];\n}\n\n/**\n * @private\n */\nExpression.NULL_SENTINEL = \"czm_infinity\"; // null just needs to be some sentinel value that will cause \"[expression] === null\" to be false in nearly all cases. GLSL doesn't have a NaN constant so use czm_infinity.\n\nNode.prototype.getShaderExpression = function (\n  variableSubstitutionMap,\n  shaderState,\n  parent\n) {\n  let color;\n  let left;\n  let right;\n  let test;\n\n  const type = this._type;\n  let value = this._value;\n\n  if (defined(this._left)) {\n    if (Array.isArray(this._left)) {\n      // Left can be an array if the type is LITERAL_COLOR or LITERAL_VECTOR\n      left = getExpressionArray(\n        this._left,\n        variableSubstitutionMap,\n        shaderState,\n        this\n      );\n    } else {\n      left = this._left.getShaderExpression(\n        variableSubstitutionMap,\n        shaderState,\n        this\n      );\n    }\n  }\n\n  if (defined(this._right)) {\n    right = this._right.getShaderExpression(\n      variableSubstitutionMap,\n      shaderState,\n      this\n    );\n  }\n\n  if (defined(this._test)) {\n    test = this._test.getShaderExpression(\n      variableSubstitutionMap,\n      shaderState,\n      this\n    );\n  }\n\n  if (Array.isArray(this._value)) {\n    // For ARRAY type\n    value = getExpressionArray(\n      this._value,\n      variableSubstitutionMap,\n      shaderState,\n      this\n    );\n  }\n\n  let args;\n  let length;\n  let vectorExpression;\n  switch (type) {\n    case ExpressionNodeType.VARIABLE:\n      if (checkFeature(this)) {\n        return undefined;\n      }\n      return getVariableName(value, variableSubstitutionMap);\n    case ExpressionNodeType.UNARY:\n      // Supported types: +, -, !, Boolean, Number\n      if (value === \"Boolean\") {\n        return `bool(${left})`;\n      } else if (value === \"Number\") {\n        return `float(${left})`;\n      } else if (value === \"round\") {\n        return `floor(${left} + 0.5)`;\n      } else if (defined(unaryFunctions[value])) {\n        return `${value}(${left})`;\n      } else if (value === \"isNaN\") {\n        // In GLSL 2.0 use isnan instead\n        return `(${left} != ${left})`;\n      } else if (value === \"isFinite\") {\n        // In GLSL 2.0 use isinf instead. GLSL doesn't have an infinity constant so use czm_infinity which is an arbitrarily big enough number.\n        return `(abs(${left}) < czm_infinity)`;\n      } else if (\n        value === \"String\" ||\n        value === \"isExactClass\" ||\n        value === \"isClass\" ||\n        value === \"getExactClassName\"\n      ) {\n        throw new RuntimeError(\n          `Error generating style shader: \"${value}\" is not supported.`\n        );\n      }\n      return value + left;\n    case ExpressionNodeType.BINARY:\n      // Supported types: ||, &&, ===, !==, <, >, <=, >=, +, -, *, /, %\n      if (value === \"%\") {\n        return `mod(${left}, ${right})`;\n      } else if (value === \"===\") {\n        return `(${left} == ${right})`;\n      } else if (value === \"!==\") {\n        return `(${left} != ${right})`;\n      } else if (value === \"atan2\") {\n        return `atan(${left}, ${right})`;\n      } else if (defined(binaryFunctions[value])) {\n        return `${value}(${left}, ${right})`;\n      }\n      return `(${left} ${value} ${right})`;\n    case ExpressionNodeType.TERNARY:\n      if (defined(ternaryFunctions[value])) {\n        return `${value}(${left}, ${right}, ${test})`;\n      }\n      break;\n    case ExpressionNodeType.CONDITIONAL:\n      return `(${test} ? ${left} : ${right})`;\n    case ExpressionNodeType.MEMBER:\n      if (checkFeature(this._left)) {\n        return getVariableName(right, variableSubstitutionMap);\n      }\n      // This is intended for accessing the components of vector properties. String members aren't supported.\n      // Check for 0.0 rather than 0 because all numbers are previously converted to decimals.\n      if (right === \"r\" || right === \"x\" || right === \"0.0\") {\n        return `${left}[0]`;\n      } else if (right === \"g\" || right === \"y\" || right === \"1.0\") {\n        return `${left}[1]`;\n      } else if (right === \"b\" || right === \"z\" || right === \"2.0\") {\n        return `${left}[2]`;\n      } else if (right === \"a\" || right === \"w\" || right === \"3.0\") {\n        return `${left}[3]`;\n      }\n      return `${left}[int(${right})]`;\n    case ExpressionNodeType.FUNCTION_CALL:\n      throw new RuntimeError(\n        `Error generating style shader: \"${value}\" is not supported.`\n      );\n    case ExpressionNodeType.ARRAY:\n      if (value.length === 4) {\n        return `vec4(${value[0]}, ${value[1]}, ${value[2]}, ${value[3]})`;\n      } else if (value.length === 3) {\n        return `vec3(${value[0]}, ${value[1]}, ${value[2]})`;\n      } else if (value.length === 2) {\n        return `vec2(${value[0]}, ${value[1]})`;\n      }\n      throw new RuntimeError(\n        \"Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.\"\n      );\n    case ExpressionNodeType.REGEX:\n      throw new RuntimeError(\n        \"Error generating style shader: Regular expressions are not supported.\"\n      );\n    case ExpressionNodeType.VARIABLE_IN_STRING:\n      throw new RuntimeError(\n        \"Error generating style shader: Converting a variable to a string is not supported.\"\n      );\n    case ExpressionNodeType.LITERAL_NULL:\n      return Expression.NULL_SENTINEL;\n    case ExpressionNodeType.LITERAL_BOOLEAN:\n      return value ? \"true\" : \"false\";\n    case ExpressionNodeType.LITERAL_NUMBER:\n      return numberToString(value);\n    case ExpressionNodeType.LITERAL_STRING:\n      if (defined(parent) && parent._type === ExpressionNodeType.MEMBER) {\n        if (\n          value === \"r\" ||\n          value === \"g\" ||\n          value === \"b\" ||\n          value === \"a\" ||\n          value === \"x\" ||\n          value === \"y\" ||\n          value === \"z\" ||\n          value === \"w\" ||\n          checkFeature(parent._left)\n        ) {\n          return value;\n        }\n      }\n      // Check for css color strings\n      color = Color.fromCssColorString(value, scratchColor);\n      if (defined(color)) {\n        return colorToVec3(color);\n      }\n      throw new RuntimeError(\n        \"Error generating style shader: String literals are not supported.\"\n      );\n    case ExpressionNodeType.LITERAL_COLOR:\n      args = left;\n      if (value === \"color\") {\n        if (!defined(args)) {\n          return \"vec4(1.0)\";\n        } else if (args.length > 1) {\n          const rgb = args[0];\n          const alpha = args[1];\n          if (alpha !== \"1.0\") {\n            shaderState.translucent = true;\n          }\n          return `vec4(${rgb}, ${alpha})`;\n        }\n        return `vec4(${args[0]}, 1.0)`;\n      } else if (value === \"rgb\") {\n        color = convertRGBToColor(this);\n        if (defined(color)) {\n          return colorToVec4(color);\n        }\n        return `vec4(${args[0]} / 255.0, ${args[1]} / 255.0, ${args[2]} / 255.0, 1.0)`;\n      } else if (value === \"rgba\") {\n        if (args[3] !== \"1.0\") {\n          shaderState.translucent = true;\n        }\n        color = convertRGBToColor(this);\n        if (defined(color)) {\n          return colorToVec4(color);\n        }\n        return `vec4(${args[0]} / 255.0, ${args[1]} / 255.0, ${args[2]} / 255.0, ${args[3]})`;\n      } else if (value === \"hsl\") {\n        color = convertHSLToRGB(this);\n        if (defined(color)) {\n          return colorToVec4(color);\n        }\n        return `vec4(czm_HSLToRGB(vec3(${args[0]}, ${args[1]}, ${args[2]})), 1.0)`;\n      } else if (value === \"hsla\") {\n        color = convertHSLToRGB(this);\n        if (defined(color)) {\n          if (color.alpha !== 1.0) {\n            shaderState.translucent = true;\n          }\n          return colorToVec4(color);\n        }\n        if (args[3] !== \"1.0\") {\n          shaderState.translucent = true;\n        }\n        return `vec4(czm_HSLToRGB(vec3(${args[0]}, ${args[1]}, ${args[2]})), ${args[3]})`;\n      }\n      break;\n    case ExpressionNodeType.LITERAL_VECTOR:\n      //>>includeStart('debug', pragmas.debug);\n      if (!defined(left)) {\n        throw new DeveloperError(\n          \"left should always be defined for type ExpressionNodeType.LITERAL_VECTOR\"\n        );\n      }\n      //>>includeEnd('debug');\n      length = left.length;\n      vectorExpression = `${value}(`;\n      for (let i = 0; i < length; ++i) {\n        vectorExpression += left[i];\n        if (i < length - 1) {\n          vectorExpression += \", \";\n        }\n      }\n      vectorExpression += \")\";\n      return vectorExpression;\n    case ExpressionNodeType.LITERAL_REGEX:\n      throw new RuntimeError(\n        \"Error generating style shader: Regular expressions are not supported.\"\n      );\n    case ExpressionNodeType.LITERAL_UNDEFINED:\n      return Expression.NULL_SENTINEL;\n    case ExpressionNodeType.BUILTIN_VARIABLE:\n      if (value === \"tiles3d_tileset_time\") {\n        return \"u_time\";\n      }\n  }\n};\n\nNode.prototype.getVariables = function (variables, parent) {\n  let array;\n  let length;\n  let i;\n\n  const type = this._type;\n  const value = this._value;\n\n  if (defined(this._left)) {\n    if (Array.isArray(this._left)) {\n      // Left can be an array if the type is LITERAL_COLOR or LITERAL_VECTOR\n      array = this._left;\n      length = array.length;\n      for (i = 0; i < length; ++i) {\n        array[i].getVariables(variables, this);\n      }\n    } else {\n      this._left.getVariables(variables, this);\n    }\n  }\n\n  if (defined(this._right)) {\n    this._right.getVariables(variables, this);\n  }\n\n  if (defined(this._test)) {\n    this._test.getVariables(variables, this);\n  }\n\n  if (Array.isArray(this._value)) {\n    // For ARRAY type\n    array = this._value;\n    length = array.length;\n    for (i = 0; i < length; ++i) {\n      array[i].getVariables(variables, this);\n    }\n  }\n\n  let match;\n  switch (type) {\n    case ExpressionNodeType.VARIABLE:\n      if (!checkFeature(this)) {\n        variables.push(value);\n      }\n      break;\n    case ExpressionNodeType.VARIABLE_IN_STRING:\n      match = variableRegex.exec(value);\n      while (match !== null) {\n        variables.push(match[1]);\n        match = variableRegex.exec(value);\n      }\n      break;\n    case ExpressionNodeType.LITERAL_STRING:\n      if (\n        defined(parent) &&\n        parent._type === ExpressionNodeType.MEMBER &&\n        checkFeature(parent._left)\n      ) {\n        variables.push(value);\n      }\n      break;\n  }\n};\n\nexport default Expression;\n","/**\n * @private\n */\nconst ExpressionNodeType = {\n  VARIABLE: 0,\n  UNARY: 1,\n  BINARY: 2,\n  TERNARY: 3,\n  CONDITIONAL: 4,\n  MEMBER: 5,\n  FUNCTION_CALL: 6,\n  ARRAY: 7,\n  REGEX: 8,\n  VARIABLE_IN_STRING: 9,\n  LITERAL_NULL: 10,\n  LITERAL_BOOLEAN: 11,\n  LITERAL_NUMBER: 12,\n  LITERAL_STRING: 13,\n  LITERAL_COLOR: 14,\n  LITERAL_VECTOR: 15,\n  LITERAL_REGEX: 16,\n  LITERAL_UNDEFINED: 17,\n  BUILTIN_VARIABLE: 18,\n};\nexport default Object.freeze(ExpressionNodeType);\n"],"names":["Cesium3DTile","tileset","baseResource","header","parent","this","_tileset","_header","hasContentsArray","contents","hasMultipleContents","length","contentHeader","content","_contentHeader","transform","parentTransform","computedTransform","modelMatrix","parentInitialTransform","_initialTransform","contentBoundingVolume","viewerRequestVolume","refine","_boundingVolume","createBoundingVolume","boundingVolume","_boundingVolume2D","undefined","_contentBoundingVolume","_contentBoundingVolume2D","_viewerRequestVolume","geometricError","_geometricError","_deprecationWarning","updateGeometricErrorScale","toUpperCase","children","contentState","contentResource","serverKey","hasEmptyContent","clone","contentHeaderUri","uri","url","getDerivedResource","getUrlComponent","_content","_contentResource","_contentState","_contentReadyToProcessPromise","_contentReadyPromise","_expiredContent","_serverKey","hasTilesetContent","hasImplicitContent","hasImplicitContentMetadata","metadata","cacheNode","expire","expireDuration","expireDate","duration","date","lastStyleTime","_optimChildrenWithinParent","clippingPlanesDirty","priorityDeferred","implicitTileset","implicitCoordinates","implicitSubtree","_distanceToCamera","_centerZDepth","_screenSpaceError","_screenSpaceErrorProgressiveResolution","_visibilityPlaneMask","_visible","_inRequestVolume","_finalResolution","_depth","_stackLength","_selectionDepth","_updatedVisibilityFrame","_touchedFrame","_visitedFrame","_selectedFrame","_requestedFrame","_ancestorWithContent","_ancestorWithContentAvailable","_refines","_shouldSelect","_isClipped","_clippingPlanesState","_debugBoundingVolume","_debugContentBoundingVolume","_debugViewerRequestVolume","_debugColor","alpha","_debugColorizeTiles","_priority","_priorityHolder","_priorityProgressiveResolution","_priorityProgressiveResolutionScreenSpaceErrorLeaf","_priorityReverseScreenSpaceError","_foveatedFactor","_wasMinPriorityChild","_loadTimestamp","_commandsLength","_color","_colorDirty","_request","Object","defineProperties","prototype","get","boundingSphere","extras","color","set","value","contentAvailable","contentReady","contentFailed","contentUnloaded","contentExpired","contentReadyToProcessPromise","contentReadyPromise","commandsLength","scratchCartesian","scratchJulianDate","createPriorityFunction","tile","multipleContentFailed","error","statistics","numberOfTilesProcessing","singleContentFailed","numberOfPendingRequests","getScreenSpaceError","frameState","useParentGeometricError","progressiveResolutionHeightFraction","heightFraction","parentGeometricError","camera","frustum","context","width","drawingBufferWidth","height","drawingBufferHeight","mode","_offCenterFrustum","Math","max","top","bottom","right","left","distance","sseDenominator","dynamicScreenSpaceError","density","_dynamicScreenSpaceErrorComputedDensity","factor","dynamicScreenSpaceErrorFactor","pixelRatio","updateVisibility","parentVisibilityPlaneMask","updateTransform","distanceToTile","distanceToTileCenter","visibility","insideViewerRequestVolume","screenSpaceError","_skipLevelOfDetail","root","getPriorityReverseScreenSpaceError","isProgressiveResolutionTile","_maximumScreenSpaceError","maximumScreenSpaceError","tilePasses","parentFails","isPriorityProgressiveResolution","radius","scaledCameraDirection","directionWC","closestPointOnLine","positionWC","toLine","center","toLineNormalized","scaledToLine","closestOnSphere","toClosestOnSphere","toClosestOnSphereNormalize","abs","replace","skipLevelOfDetail","foveatedScreenSpaceError","foveatedConeSize","_pass","maximumFovatedFactor","cos","fov","foveatedConeFactor","range","normalizedFoveatedFactor","sseRelaxation","foveatedInterpolationCallback","foveatedMinimumScreenSpaceErrorRelaxation","sse","isPriorityDeferred","updateExpiration","now","requestContent","multipleContents","contentsJson","extensions","backloggedRequestCount","requestInnerContents","contentsFetchedPromise","then","isDestroyed","readyPromise","catch","requestMultipleContents","resource","expired","setQueryParameters","toString","request","throttle","throttleByServer","type","priorityFunction","promise","fetchArrayBuffer","previousState","arrayBuffer","preprocessed","_disableSkipLevelOfDetail","contentType","contentFactory","binaryPayload","buffer","jsonPayload","subtree","coordinates","getContentMetadataView","groupMetadata","group","makeContent","expireDurationDate","updateExpireDate","state","numberOfAttemptedRequests","Promise","reject","requestSingleContent","cancelRequests","cancel","unloadContent","destroy","scratchProjectedBoundingSphere","getBoundingVolume","sphere","mapProjection","cullingVolume","clippingPlanes","enabled","intersection","computeIntersectionWithBoundingVolume","clippingPlanesOriginMatrix","computeVisibilityWithPlaneMask","contentVisibility","getContentBoundingVolume","computeVisibility","distanceToCamera","scratchToTileCenter","toCenter","scratchMatrix","scratchScale","scratchHalfAxes","scratchCenter","scratchRectangle","scratchOrientedBoundingBox","scratchTransform","createRegion","region","initialTransform","result","rectangle","minimumHeight","maximumHeight","orientedBoundingBox","halfAxes","rotationScale","update","createBoxFromTransformedRegion","rectangleRegion","boundingVolumeHeader","box","createBox","scale","createSphere","uniformScale","passOptions","commandStart","commandList","currentClippingPlanesState","clippingPlanesState","updateClippingPlanes","isRender","hasContentBoundingVolume","empty","showVolume","debugShowBoundingVolume","debugShowContentBoundingVolume","createDebugVolume","attributes","getGeometryInstanceAttributes","debugShowViewerRequestVolume","debugColorizeTilesOn","debugColorizeTiles","_heatmap","tilePropertyName","debugColorizeTilesOff","colorize","applyDebugSettings","makeStyleDirty","expiredContent","updateContent","i","command","translucent","pass","depthForTranslucentClassification","scratchCommandList","isolateDigits","normalizedValue","numberOfDigits","leftShift","scaled","pow","parseInt","priorityNormalizeAndClamp","minimum","maximum","process","savedCommandList","updatePriority","preferLeaves","minimumPriority","_minimumPriority","maximumPriority","_maximumPriority","preloadProgressiveResolutionScale","foveatedLeftShift","foveatedDeferScale","preloadProgressiveResolutionLeftShift","preloadFlightScale","foveatedDeferLeftShift","depthDigits","depth","preferredSortingDigits","reverseScreenSpaceError","preloadProgressiveResolutionDigits","foveatedDigits","foveatedFactor","preferredSortingLeftShift","foveatedDeferDigits","preloadFlightDigits","freeze","NOT_COMPUTED","USE_OPTIMIZATION","SKIP_OPTIMIZATION","Cesium3DTileOptimizations","scratchAxis","checkChildrenWithinParent","_orientedBoundingBox","childBoundingVolume","childOrientedBoundingBox","axis","axisLength","x","y","z","Cesium3DTilePass","RENDER","PICK","SHADOW","PRELOAD","PRELOAD_FLIGHT","REQUEST_RENDER_MODE_DEFER_CHECK","MOST_DETAILED_PRELOAD","MOST_DETAILED_PICK","NUMBER_OF_PASSES","Array","traversal","requestTiles","ignoreCommands","getPassOptions","options","ready","Cesium3DTilePointFeature","batchId","billboard","label","polyline","_billboard","_label","_polyline","_batchId","_billboardImage","_billboardColor","_billboardOutlineColor","_billboardOutlineWidth","_billboardSize","_pointSize","_pointOutlineColor","_pointOutlineWidth","_heightOffset","_pickIds","setBillboardImage","scratchCartographic","feature","b","image","newColor","defaultColor","newOutlineColor","defaultPointOutlineColor","newOutlineWidth","defaultPointOutlineWidth","newPointSize","defaultPointSize","currentColor","currentOutlineColor","currentOutlineWidth","currentPointSize","centerAlpha","cssColor","toCssColorString","cssOutlineColor","textureId","JSON","stringify","setImage","show","pointSize","pointOutlineColor","pointOutlineWidth","labelColor","fillColor","labelOutlineColor","outlineColor","labelOutlineWidth","outlineWidth","font","labelStyle","style","labelText","text","backgroundColor","backgroundPadding","backgroundEnabled","showBackground","scaleByDistance","translucencyByDistance","distanceDisplayCondition","heightOffset","offset","ellipsoid","cart","cartesianToCartographic","position","newPosition","cartographicToCartesian","positions","anchorLineEnabled","anchorLineColor","material","uniforms","imageChanged","disableDepthTestDistance","horizontalOrigin","verticalOrigin","labelHorizontalOrigin","labelVerticalOrigin","primitive","pickIds","ids","pickId","hasProperty","name","batchTable","getPropertyNames","results","getProperty","getPropertyInherited","setProperty","featurePropertiesDirty","isExactClass","className","isClass","getExactClassName","ADD","REPLACE","Cesium3DTileStyle","_style","_ready","_show","_labelColor","_labelOutlineColor","_labelOutlineWidth","_font","_labelStyle","_labelText","_backgroundColor","_backgroundPadding","_backgroundEnabled","_scaleByDistance","_translucencyByDistance","_distanceDisplayCondition","_anchorLineEnabled","_anchorLineColor","_image","_disableDepthTestDistance","_horizontalOrigin","_verticalOrigin","_labelHorizontalOrigin","_labelVerticalOrigin","_meta","_colorShaderFunction","_showShaderFunction","_pointSizeShaderFunction","_colorShaderFunctionReady","_showShaderFunctionReady","_pointSizeShaderFunctionReady","_colorShaderTranslucent","that","_readyPromise","fetchJson","styleJson","setup","resolve","meta","defines","metaJson","property","hasOwnProperty","getExpression","tileStyle","String","conditions","getJsonFromExpression","expression","conditionsExpression","fromUrl","getColorShaderFunction","functionSignature","variableSubstitutionMap","shaderState","getShaderFunction","getShowShaderFunction","getPointSizeShaderFunction","getVariables","variables","push","apply","filter","variable","index","indexOf","Cesium3DTileStyleEngine","_styleDirty","_lastStyleTime","makeDirty","resetDirty","applyStyle","styleDirty","_statistics","tiles","_selectedTiles","_selectedTilesToStyle","numberOfFeaturesStyled","featuresLength","numberOfTilesStyled","Cesium3DTileset","_url","_basePath","_root","_resource","_asset","_properties","_extensionsUsed","_extensions","_gltfUpAxis","_cache","_processingQueue","_emptyTiles","_requestedTiles","_timeSinceLoad","_updatedModelMatrixFrame","_modelMatrixChanged","_previousModelMatrix","_extras","_credits","_showCreditsOnScreen","showCreditsOnScreen","_cullWithChildrenBounds","cullWithChildrenBounds","_allTilesAdditive","_hasMixedContent","_stencilClearCommand","_backfaceCommands","_maximumMemoryUsage","maximumMemoryUsage","_styleEngine","_modelMatrix","_statisticsLast","_statisticsPerPass","_requestedTilesInFlight","Number","MAX_VALUE","debugHeatmapTilePropertyName","cullRequestsWhileMoving","_cullRequestsWhileMoving","cullRequestsWhileMovingMultiplier","_tilesLoaded","_initialTilesLoaded","_tileDebugLabels","_classificationType","classificationType","_ellipsoid","_initialClippingPlanesOriginMatrix","_clippingPlanesOriginMatrix","_clippingPlanesOriginMatrixDirty","_vectorClassificationOnly","vectorClassificationOnly","_vectorKeepDecodedPositions","vectorKeepDecodedPositions","preloadWhenHidden","preloadFlightDestinations","_foveatedConeSize","_foveatedMinimumScreenSpaceErrorRelaxation","foveatedTimeDelay","dynamicScreenSpaceErrorDensity","dynamicScreenSpaceErrorHeightFalloff","shadows","colorBlendMode","colorBlendAmount","_pointCloudShading","pointCloudShading","_pointCloudEyeDomeLighting","loadProgress","allTilesLoaded","initialTilesLoaded","tileLoad","tileUnload","tileFailed","tileVisible","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","_clippingPlanes","imageBasedLighting","_imageBasedLighting","_shouldDestroyImageBasedLighting","lightColor","backFaceCulling","showOutline","splitDirection","debugFreezeFrame","_enableDebugWireframe","enableDebugWireframe","debugWireframe","debugPickedTileLabelOnly","debugPickedTile","debugPickPosition","debugShowGeometricError","debugShowRenderingStatistics","debugShowMemoryUsage","debugShowUrl","examineVectorLinesFunction","_metadataExtension","_customShader","customShader","enableModelExperimental","featureIdLabel","_featureIdLabel","instanceFeatureIdLabel","_instanceFeatureIdLabel","_schemaLoader","basePath","credits","extension","getBaseUri","isDataUri","loadJson","tilesetJson","metadataJson","schemaLoader","schemaUri","schema","processMetadataExtension","loadTileset","gltfUpAxis","asset","properties","extensionsUsed","cesium","extraCredits","credit","html","clippingPlanesOrigin","originCartographic","makeTile","tileHeader","parentTile","implicitTiling","metadataSchema","rootCoordinates","subdivisionScheme","subtreeLevels","level","contentUri","subtreeUriTemplate","templateValues","getTemplateValues","deepCopy","tileJson","isCesium3DTileset","tilesLoaded","metadataExtension","timeSinceLoad","totalMemoryUsageInBytes","texturesByteLength","geometryByteLength","batchTableByteLength","styleEngine","tilesetUrl","version","extensionsRequired","checkSupportedExtensions","tilesetVersion","v","rootTile","stack","pop","numberOfTilesTotal","childTile","scratchPositionNormal","scratchPosition","scratchDirection","attemptedRequests","scratchStack","destroyTile","destroySubtree","decrementLoadCounts","numberOfTilesWithContentReady","addToProcessingQueue","e","incrementLoadCounts","numberOfLoadedTilesTotal","add","raiseEvent","handleTileSuccess","message","numberOfListeners","handleTileFailure","sortRequestByPriority","a","postPassesUpdate","requestedTilesInFlight","removeCount","outOfView","frameNumber","cancelOutOfViewRequests","statisticsLast","lastNumberOfPendingRequest","lastNumberOfTilesProcessing","progressChanged","afterRender","raiseLoadProgressEvent","unloadTiles","unloadTile","prePassesUpdate","filterProcessingQueue","processTiles","time","up","direction","tileBoundingVolume","positionCartographic","transformLocal","centerLocal","minimumRadius","centerCartographic","positionLocal","boxHeight","heightClose","heightFar","t","horizonFactor","updateDynamicScreenSpaceError","newFrame","reset","stringOptions","maximumFractionDigits","formatMemoryString","memorySizeInBytes","memoryInMegabytes","toLocaleString","round","computeTileLabelPosition","normal","addTileDebugLabel","labelString","pointsLength","trianglesLength","urls","innerContentUrls","newLabel","substring","POSITIVE_INFINITY","updateTiles","numberOfInitialCommands","selectedTiles","selectedLength","emptyTiles","emptyLength","bivariateVisibilityTest","stencilBuffer","stencil","renderState","stencilMask","lengthBeforeUpdate","incrementSelectionCounts","selected","addedCommandsLength","trim","backfaceCommands","values","backfaceCommandsLength","numberOfCommands","attenuation","eyeDomeLighting","removeAll","pixelOffset","updateTileDebugLabels","passStatistics","clear","resetMinimumMaximum","detectModelMatrixChanged","selectTiles","isAsync","requestedTiles","sort","showOnScreen","creditDisplay","addCredit","trimLoadedTiles","updateForPass","tilesetPassState","originalCommandList","originalCamera","originalCullingVolume","hasExtension","extensionName","supportedExtensions","MAXAR_content_geojson","Cesium3DTilesetCache","_list","_sentinel","_trimTiles","splice","tail","touch","node","unloadCallback","remove","trimTiles","list","maximumMemoryUsageInBytes","sentinel","head","item","next","Cesium3DTilesetHeatmap","_minimum","_maximum","_previousMinimum","_previousMaximum","_referenceMinimum","_referenceMaximum","getHeatmapValue","tileValue","getTime","setReferenceMinimumMaximum","heatmapColors","heatmapValue","heatmap","min","getHeatmapValueAndUpdateMinimumMaximum","shiftedMax","colorPosition","colorPositionFloor","floor","colorPositionCeil","ceil","colorZero","colorOne","finalColor","red","green","blue","referenceMinimum","referenceMaximum","useReference","Cesium3DTilesetMetadata","class","classes","groupIds","groups","groupsJson","isArray","keys","groupId","id","_schema","_groups","_groupIds","Cesium3DTilesetMostDetailedTraversal","stackMaximumLength","isVisible","canTraverse","updateAndPushChildren","child","loadTile","hasUnloadedContent","touchTile","visitTile","visited","selectDesiredTile","traverse","Cesium3DTilesetStatistics","numberOfFeaturesSelected","numberOfFeaturesLoaded","numberOfPointsSelected","numberOfPointsLoaded","numberOfTrianglesSelected","numberOfTilesCulledWithChildrenUnion","updatePointAndFeatureCounts","decrement","load","innerContents","Cesium3DTilesetTraversal","emptyTraversal","descendantTraversal","selectionTraversal","ancestorStack","ancestorStackMaximumLength","addEmptyTile","selectTile","tileContent","loadedTile","childrenLength","updateTile","selectDescendants","diameter","deltaMagnitude","positionWCDeltaMagnitude","positionWCDeltaMagnitudeLastFrame","isOnScreenLongEnough","cameraHasNotStoppedMovingLongEnough","timeSinceMoved","updateTileVisibility","hasChildren","meetsScreenSpaceErrorEarly","useOptimization","anyVisible","anyChildrenVisible","updateMinimumMaximumPriority","updateTileAncestorContentLinks","hasContent","reachedSkippingThreshold","ancestor","sortChildrenByDistanceToCamera","checkRefines","refines","minIndex","childRefines","executeEmptyTraversal","minPriorityChild","priorityHolder","inBaseTraversal","executeTraversal","baseTraversal","parentRefines","stoppedRefining","allDescendantsLoaded","emptyContent","emptyLeaf","traverseAndSelect","lastAncestor","waitingTile","peek","shouldSelect","executeSkipTraversal","executeBaseAndSkipTraversal","executeBaseTraversal","CircleEmitter","_radius","emit","particle","theta","rad","sin","velocity","boundingSphereCartesian3Scratch","ModelState","ClassificationModel","gltf","ArrayBuffer","Uint8Array","_pipeline","source","gltfNodes","nodes","gltfMeshes","meshes","meshId","mesh","gltfPrimitives","primitives","gltfPositionAttribute","POSITION","gltfBatchIdAttribute","_BATCHID","_gltf","_debugShowBoundingVolume","_debugWireframe","_vertexShaderLoaded","vertexShaderLoaded","_classificationShaderLoaded","classificationShaderLoaded","_uniformMapLoaded","uniformMapLoaded","_pickIdLoaded","pickIdLoaded","_ignoreCommands","_upAxis","upAxis","_batchTable","_computedModelMatrix","_initialRadius","_boundingSphere","_scaledBoundingSphere","_state","NEEDS_LOAD","_loadResources","_mode","_dirty","_nodeMatrix","_primitive","_extensionsRequired","_quantizedUniforms","_buffers","_vertexArray","_shaderProgram","_uniformMap","_geometryByteLength","_trianglesLength","_rtcCenter","_rtcCenterEye","_rtcCenter3D","_rtcCenter2D","createVertexBuffer","bufferViewId","model","loadResources","bufferView","bufferViews","vertexBuffer","getBuffer","byteLength","createIndexBuffer","componentType","indexBuffer","typedArray","indexDatatype","modifyShader","shader","callback","createProgram","positionName","batchIdName","attributeLocations","modelViewProjectionName","uniformDecl","toClip","projectionName","modelViewName","vs","WEB3D_quantized_attributes","modifyShaderForQuantizedAttributes","drawVS","drawFS","vertexShaderSource","fragmentShaderSource","gltfInternal","LOADED","nonUniformScale","scaledBoundingSphere","dirty","gltfSemanticUniforms","PROJECTION","uniformState","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","createPrimitive","uniformMap","vertexArray","accessors","ix","indices","positionAccessor","minMax","count","byteOffset","indicesCount","triangleCountFromPrimitiveIndices","quantizedUniformMap","createUniformsForQuantizedAttributes","attribute","componentDatatype","bufferLength","positionsBuffer","vertexBatchIds","Uint16Array","BYTES_PER_ELEMENT","Uint32Array","batchIds","indexCounts","indexOffsets","batchedIndices","indexOffset","indexCount","currentId","indicesLength","j","_vertexShaderSource","_fragmentShaderSource","_attributeLocations","_pickId","createResources","glExtensionsUsed","pendingBufferLoads","vertexBuffersToCreate","indexBuffersToCreate","dequeue","createBuffers","finishedBuffersCreation","rendererBuffers","accessorId","attributeName","attributeLocation","componentsPerAttribute","offsetInBytes","strideInBytes","accessor","createVertexArray","technique","uniform","uniformName","semantic","createUniformMap","finished","gltfNode","createRuntimeNodes","scratchComputedTranslation","scratchComputedMatrixIn2D","updateCommands","supportsWebP","LOADING","FAILED","CESIUM_RTC","projection","cartographic","projectedCart","project","justLoaded","buffers","addBuffersToLoadResources","target","enqueue","indexBufferIds","parseBufferViews","modeChanged","modelTransformChanged","computedModelMatrix","translation","boundingSphereInternal","to2D","updateNodeModelMatrix","ClassificationPrimitive","geometryInstances","debugShowShadowVolume","_debugShowShadowVolume","_extruded","_sp","_spStencil","_spPick","_spColor","_spPick2D","_spColor2D","_rsStencilDepthPass","_rsStencilDepthPass3DTiles","_rsColorPass","_rsPickPass","_commandsIgnoreShow","_pickPrimitive","_hasSphericalExtentsAttribute","_hasPlanarExtentsAttributes","_hasPerColorAttribute","appearance","_createBoundingVolumeFunction","_updateAndQueueCommandsFunction","_usePickOffsets","_primitiveOptions","vertexCacheOptimize","interleave","releaseGeometryInstances","allowPicking","asynchronous","compressVertices","_createRenderStatesFunction","_createShaderProgramFunction","_createCommandsFunction","_createPickOffsets","getStencilDepthRenderState","enableStencil","mask3DTiles","stencilFunction","colorMask","stencilTest","frontFunction","frontOperation","fail","zFail","zPass","backFunction","backOperation","reference","mask","depthTest","func","depthMask","getColorRenderState","blending","_needs2DShader","isSupported","scene","pickRenderState","createShaderProgram","classificationPrimitive","getVertexShaderCallback","scene3DOnly","planarExtents","cullFragmentsUsingExtents","search","attributeDecl","globalDecl","decode","modifiedVS","join","modifyForEncodedNormals","extrudedDefine","vsSource","sources","fsSource","shadowVolumeAppearance","shaderProgram","vsPick","pickFS3D","createPickFragmentShader","pickVS3D","createPickVertexShader","pickProgram2D","shaderCache","getDerivedShaderProgram","pickFS2D","pickVS2D","createDerivedShaderProgram","fsColorSource","createFragmentShader","vsColorSource","createVertexShader","colorProgram2D","fsColorSource2D","vsColorSource2D","createCommands","twoPasses","colorCommands","pickCommands","derivedCommand","_va","vaIndex","getUniformMapCallback","needs2DShader","owner","primitiveType","_primitiveType","derivedCommands","_uniforms","derived2DCommand","appearance2D","commandsIgnoreShow","spStencil","commandIndex","commandIgnoreShow","createColorCommands","usePickOffsets","pickOffsets","pickOffset","pickIndex","_pickOffsets","pickOnly","pick2D","createPickCommands","boundingVolumeIndex","updateAndQueueRenderCommand","cull","updateAndQueuePickCommand","primitiveOptions","instances","instance","firstColor","hasPerColorAttribute","allColorsSame","hasSphericalExtentsAttribute","hasPlanarExtentsAttributes","flat","geometry","pickPrimitive","stencilEnabled","createRenderStates","boundingVolumes","_boundingSphereWC","_boundingSphereCV","_boundingSphere2D","_boundingSphereMorph","queueTerrainCommands","queue3DTilesCommands","passes","render","colorLength","invertClassification","ignoreShowCommands","ignoreShowCommandsLength","pick","pickLength","updateAndQueueCommands","_error","ClassificationType","TERRAIN","CESIUM_3D_TILE","BOTH","ClippingPlane","_distance","_normal","UpdateChangedCartesian3","onChangeCallback","clippingPlane","_clippingPlane","_cartesian3","fromPlane","plane","ClippingPlaneCollection","_planes","_dirtyIndex","_multipleDirtyPlanes","_enabled","edgeColor","edgeWidth","planeAdded","planeRemoved","_owner","unionClippingRegions","_unionClippingRegions","_testIntersection","unionIntersectFunction","defaultIntersectFunction","_uint8View","_float32View","_clippingPlanesTexture","planes","planesLength","setIndexDirty","collection","texture","newPlaneIndex","contains","planeToKeep","planesCount","distanceEncodeScratch","oct32EncodeScratch","packPlanesAsUint8","clippingPlaneCollection","startIndex","endIndex","uint8View","byteIndex","oct32Normal","w","encodedDistance","packPlanesAsFloats","float32View","floatIndex","computeTextureResolution","pixelsNeeded","maxSize","textureResolutionScratch","clippingPlanesTexture","useFloatTexture","currentPixelCount","requiredResolution","pixelFormat","pixelDatatype","sampler","flipY","Float32Array","dirtyIndex","copyFrom","arrayBufferView","offsetX","offsetY","xOffset","yOffset","scratchPlane","intersectPlane","setOwner","key","floatingPointTexture","getTextureResolution","scratchTextureDimensions","attributeLocationsBatched","positionHighAndScaleX","positionLowAndScaleY","packedAttribute0","packedAttribute1","attributeLocationsInstanced","SHOW_INDEX","POSITION_INDEX","SCALE_INDEX","MAXIMUM_SIZE_INDEX","SLICE_INDEX","BRIGHTNESS_INDEX","NUMBER_OF_PROPERTIES","COLOR_INDEX","CloudCollection","_clouds","_cloudsToUpdate","_cloudsToUpdateIndex","_cloudsRemoved","_createVertexArray","_propertiesChanged","_noiseTexture","_textureSliceWidth","_noiseTextureRows","noiseDetail","noiseOffset","_loading","u_noiseTexture","u_noiseTextureDimensions","getNoiseTextureDimensions","u_noiseDetail","_vaNoise","_spNoise","_spCreated","_rs","_colorCommands","debugBillboards","_compiledDebugBillboards","debugEllipsoids","_compiledDebugEllipsoids","destroyClouds","clouds","_destroy","removeClouds","cloudCollection","newClouds","cloud","_index","cloudType","_updateCloud","propertyChanged","_cloudCollection","texturePositions","textureIndices","getIndexBuffer","getIndexBufferBatched","cache","cloudCollection_indexBufferBatched","sixteenK","usage","vertexArrayDestroyable","getIndexBufferInstanced","cloudCollection_indexBufferInstanced","getVertexBufferInstanced","cloudCollection_vertexBufferInstanced","writePositionScratch","writePositionAndScale","vafWriters","positionHighWriter","positionLowWriter","high","low","_instanced","writePackedAttribute0","writer","brightness","writePackedAttribute1","maximumSize","slice","writeColor","writeCloud","createNoiseTexture","textureSliceWidth","noiseTextureRows","positionBuffer","createTextureVA","wrapS","wrapT","minificationFilter","magnificationFilter","textureCommand","outputTexture","u_noiseOffset","persists","postExecute","_vaf","cloudsLength","numberOfClouds","instanced","normalize","sizeInVertices","createVAF","writers","commit","scratchWriterArray","debugging","instancedArrays","cloudsToUpdate","cloudsToUpdateLength","numWriters","c","subCommit","endSubCommits","updateClouds","va","fs","colorList","vaLength","instanceCount","createDrawCommands","CloudType","CUMULUS","ColorBlendMode","HIGHLIGHT","MIX","Composite3DTileContent","factory","_tile","_contents","_metadata","_group","uint8Array","view","DataView","sizeOfUint32","getUint32","tilesLength","contentPromises","tileType","tileByteLength","innerContent","all","initialize","getFeature","ConditionsExpression","_conditionsExpression","_conditions","_runtimeConditions","runtimeConditions","statement","cond","condExpression","Statement","setRuntime","condition","evaluate","evaluateColor","returnType","shaderFunction","getShaderExpression","defaultAngle","ConeEmitter","angle","_angle","tan","ContentMetadata","metadataClass","_class","propertyId","hasPropertyBySemantic","getPropertyIds","getPropertyBySemantic","setPropertyBySemantic","textColor","highlightColor","CreditDisplayElement","delimiterClassName","createDelimiterElement","delimiter","delimiterElement","document","createElement","textContent","createCreditElement","element","elementWrapperTagName","wrapper","_creditId","appendChild","displayCredits","container","childNodes","domIndex","credit1","credit2","creditIndex","delimiterDomIndex","existingDelimiter","replaceChild","existingElement","_id","removeChild","addStyle","selector","styles","CreditDisplay","viewport","body","lightbox","lightboxCredits","hideLightbox","event","addEventListener","title","closeButton","onclick","bind","innerHTML","creditList","cesiumCreditContainer","display","screenContainer","expandLink","showLightbox","margin","border","padding","cursor","css","insertBefore","firstChild","appendCss","cesiumCredit","_delimiter","_screenContainer","_cesiumCreditContainer","_lastViewportHeight","_lastViewportWidth","_lightboxCredits","_creditList","_lightbox","_hideLightbox","_expandLink","_expanded","_defaultCredits","_cesiumCredit","_previousCesiumCredit","_currentCesiumCredit","_creditDisplayElementPool","_creditDisplayElementIndex","_currentFrameCredits","screenCredits","_defaultCredit","setCredit","creditDisplayElement","pool","poolIndex","_creditDisplayElementPoolIndex","defaultCredit","getDefaultCredit","logo","path","_cesiumCreditInitialized","_isIon","addDefaultCredit","defaultCredits","len","existingCredit","removeDefaultCredit","clientWidth","clientHeight","marginTop","styleLightboxContainer","beginFrame","currentFrameCredits","endFrame","previousCredit","currentCredit","swapCesiumCredit","removeEventListener","CullFace","FRONT","BACK","FRONT_AND_BACK","CumulusCloud","_position","_maximumSize","_scale","defaultMaxSize","_slice","_brightness","DebugAppearance","perInstanceAttribute","glslDatatype","varyingName","getColor","_renderState","_closed","closed","_attributeName","_glslDatatype","getFragmentShaderSource","isTranslucent","getRenderState","DebugCameraPrimitive","_camera","_frustumSplits","frustumSplits","_updateOnChange","updateOnChange","_outlinePrimitives","_planesPrimitives","scratchRight","scratchRotation","scratchOrientation","scratchPerspective","scratchPerspectiveOffCenter","scratchOrthographic","scratchOrthographicOffCenter","scratchColor","scratchSplits","planesPrimitives","outlinePrimitives","cameraFrustum","numFrustums","near","far","upWC","rightWC","rotation","orientation","origin","_drawNearPlane","DebugInspector","_cachedShowFrustumsShaders","scratchFrustumColor","scratchShowFrustumCommand","executeDebugShowFrustumsCommand","passState","shaderProgramId","debugShaderProgram","sp","targets","map","re","match","exec","newMain","vertexAttributes","getAttributeLocations","createDebugShowFrustumsShaderProgram","debugCommand","debugUniformMap","debugShowCommandsColor","debugShowFrustumsColor","debugShowCommands","debugShowFrustums","debugOverlappingFrustums","createDebugShowFrustumsUniformMap","execute","DebugModelMatrixPrimitive","_length","_width","vertexFormat","colors","arcType","DepthFunction","NEVER","LESS","EQUAL","LESS_OR_EQUAL","GREATER","NOT_EQUAL","GREATER_OR_EQUAL","ALWAYS","DepthPlane","depthPlaneEllipsoidOffset","_command","_useLogDepth","_ellipsoidOffset","depthQuadScratch","scratchCartesian1","scratchCartesian2","scratchCartesian3","scratchCartesian4","scratchCartesian5","radii","useLogDepth","maximumRadius","depthQuad","eastOffset","northOffset","p","q","oneOverRadii","qUnit","eUnit","nUnit","qMagnitude","wMagnitude","sqrt","scalar","upperLeft","lowerLeft","upperRight","lowerRight","computeDepthQuad","getAttribute","copyFromArrayView","bufferUsage","DerivedCommand","fragDepthRegex","discardRegex","createDepthOnlyDerivedCommand","depthOnlyCommand","writesDepthOrDiscards","test","usesLogDepth","getDepthOnlyShaderProgram","_depthOnlyRenderStateCache","depthOnlyState","rs","getDepthOnlyRenderState","writeLogDepthRegex","vertexlogDepthRegex","extensionRegex","createLogDepthCommand","logMain","writesLogDepth","addExtension","logSource","getLogDepthShaderProgram","createPickDerivedCommand","pickCommand","newSources","getPickShaderProgram","picking","pickRenderStateCache","pickState","getPickRenderState","createHdrCommand","getHdrShaderProgram","DeviceOrientationCameraController","_scene","_lastAlpha","_lastBeta","_lastGamma","_alpha","_beta","_gamma","beta","gamma","window","_removeListener","scratchQuaternion1","scratchQuaternion2","scratchMatrix3","g","bQuat","gQuat","rotQuat","aQuat","matrix","rotate","intensity","DiscardEmptyTileImagePolicy","emptyImage","isReady","shouldDiscardImage","EMPTY_IMAGE","Image","src","DiscardMissingTileImagePolicy","missingImageUrl","pixelsToCheck","_pixelsToCheck","_missingImagePixels","_missingImageByteLength","_isReady","fetchImage","preferBlob","preferImageBitmap","blob","size","pixels","disableCheckIfAllPixelsAreTransparent","allAreTransparent","pos","missingImagePixels","pixel","DracoLoader","addBufferToLoadResources","createdBufferViews","loadResourceBuffers","addNewVertexBuffer","scheduleDecodingTask","decoderTaskProcessor","_taskProcessorReady","taskData","primitivesToDecode","scheduleTask","array","activeDecodingTasks","decodedIndexBuffer","indexArray","numberOfIndices","addNewIndexBuffer","decodedAttributeData","attributeData","vertexBufferView","data","_decodedData","_maxDecodingConcurrency","_decoderTaskProcessor","_getDecoderTaskProcessor","processor","initWebAssemblyModule","modulePath","wasmBinaryFile","KHR_draco_mesh_compression","_decodedModelResourceCache","parse","cacheKey","modelDecodingCache","cachedData","pendingDecodingCache","dequantizeInShader","_dequantizeInShader","primitiveId","compressionData","compressedAttributes","decodeModel","decodingPromises","decodePointCloud","parameters","decodeBufferView","cacheDataForModel","destroyCachedDataForModel","EllipsoidPrimitive","_center","_radii","_oneOverEllipsoidRadiiSquared","_material","_translucent","onlySunLighting","_onlySunLighting","_depthTestEnabled","depthTestEnabled","_pickSP","_colorCommand","_pickCommand","u_radii","u_oneOverEllipsoidRadiiSquared","_pickUniforms","czm_pickColor","logDepthExtension","translucencyChanged","face","fragmentDepth","ellipsoidPrimitive_vertexArray","dimensions","getVertexArray","boundingSphereDirty","r","materialChanged","lightingChanged","useLogDepthChanged","colorCommand","shaderSource","executeInClosestFrustum","createPickId","pickColorQualifier","EllipsoidSurfaceAppearance","aboveGround","_flat","_faceForward","faceForward","_aboveGround","VERTEX_FORMAT","Empty3DTileContent","Expression","ast","_expression","definePlaceholder","RegExp","defineReplace","replaceDefines","exp","openSingleQuote","openDoubleQuote","closeQuote","substr","replaceVariables","backslashRegex","removeBackslashes","_runtimeAst","createRuntimeAst","scratchStorage","arrayIndex","arrayArray","cartesian2Index","cartesian3Index","cartesian4Index","cartesian2Array","cartesian3Array","cartesian4Array","getArray","getCartesian2","getCartesian3","getCartesian4","shaderExpression","unaryOperators","binaryOperators","variableRegex","replacementRegex","unaryFunctions","getEvaluateUnaryComponentwise","acos","asin","atan","radians","degrees","sign","exp2","exponent","log","log2","number","fract","call","binaryFunctions","atan2","getEvaluateBinaryComponentwise","dot","cross","ternaryFunctions","clamp","getEvaluateTernaryComponentwise","mix","operation","allowScalar","Node","_type","_value","_left","_right","_test","_evaluateConditional","_evaluateRegExpTest","_evaluateRegExpExec","_evaluateToString","_evaluateNot","_evaluateNegative","_evaluatePositive","_evaluateNaN","_evaluateIsFinite","_evaluateIsExactClass","_evaluateIsClass","_evaluateGetExactClassName","_evaluateBooleanConversion","_evaluateNumberConversion","_evaluateStringConversion","getEvaluateUnaryFunction","_evaluatePlus","_evaluateMinus","_evaluateTimes","_evaluateDivide","_evaluateMod","_evaluateEqualsStrict","_evaluateNotEqualsStrict","_evaluateLessThan","_evaluateLessThanOrEquals","_evaluateGreaterThan","_evaluateGreaterThanOrEquals","_evaluateAnd","_evaluateOr","_evaluateRegExpMatch","_evaluateRegExpNotMatch","getEvaluateBinaryFunction","getEvaluateTernaryFunction","_evaluateMemberBrackets","_evaluateMemberDot","_evaluateArray","_evaluateVariable","_evaluateVariableString","_evaluateLiteralColor","_evaluateLiteralVector","_evaluateLiteralString","_evaluateRegExp","evaluateTilesetTime","_evaluateLiteral","replaceBackslashes","parseCall","args","arguments","argsLength","val","callee","object","pattern","flags","isLiteralType","parseRegex","parseMemberExpression","PI","E","parseMathConstant","parseNumberConstant","obj","computed","op","parseLiteral","NaN","Infinity","parseKeywordsAndVariables","operator","argument","consequent","alternate","elements","getFeatureProperty","checkFeature","convertHSLToRGB","channels","h","s","l","convertRGBToColor","numberToString","toFixed","colorToVec4","getExpressionArray","expressions","getVariableName","variableName","NULL_SENTINEL","components","componentsLength","vectorLength","charAt","component","placeholder","member","equals","isNaN","isFinite","Boolean","vectorExpression","colorToVec3","rgb","VARIABLE","UNARY","BINARY","TERNARY","CONDITIONAL","MEMBER","FUNCTION_CALL","ARRAY","REGEX","VARIABLE_IN_STRING","LITERAL_NULL","LITERAL_BOOLEAN","LITERAL_NUMBER","LITERAL_STRING","LITERAL_COLOR","LITERAL_VECTOR","LITERAL_REGEX","LITERAL_UNDEFINED","BUILTIN_VARIABLE"],"sourceRoot":""}