"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8692],{21144:(t,e,i)=>{i.d(e,{Z:()=>p});var n=i(93517),r=i(17497),o=i(88779),s=i(54485),a=i(20176),h=i(92893),l=i(31163),u=i(79285),c=i(19157),d=i(81186);function f(t,e){let i;if((e=(0,o.Z)(e,0))>0){i=new Array(e);for(let t=0;t<e;t++)i[t]=n.Z}this._numberOfDerivatives=e,this._property=new d.Z(n.Z,i),this._definitionChanged=new h.Z,this._referenceFrame=(0,o.Z)(t,l.Z.FIXED),this._property._definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this)}),this)}Object.defineProperties(f.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(t){this._property.forwardExtrapolationType=t}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(t){this._property.forwardExtrapolationDuration=t}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(t){this._property.backwardExtrapolationType=t}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(t){this._property.backwardExtrapolationDuration=t}}}),f.prototype.getValue=function(t,e){return this.getValueInReferenceFrame(t,l.Z.FIXED,e)},f.prototype.getValueInReferenceFrame=function(t,e,i){if(r.Z.defined("time",t),r.Z.defined("referenceFrame",e),i=this._property.getValue(t,i),(0,s.Z)(i))return u.Z.convertToReferenceFrame(t,i,this._referenceFrame,e,i)},f.prototype.setInterpolationOptions=function(t){this._property.setInterpolationOptions(t)},f.prototype.addSample=function(t,e,i){const n=this._numberOfDerivatives;if(n>0&&(!(0,s.Z)(i)||i.length!==n))throw new a.Z("derivatives length must be equal to the number of derivatives.");this._property.addSample(t,e,i)},f.prototype.addSamples=function(t,e,i){this._property.addSamples(t,e,i)},f.prototype.addSamplesPackedArray=function(t,e){this._property.addSamplesPackedArray(t,e)},f.prototype.removeSample=function(t){return this._property.removeSample(t)},f.prototype.removeSamples=function(t){this._property.removeSamples(t)},f.prototype.equals=function(t){return this===t||t instanceof f&&c.Z.equals(this._property,t._property)&&this._referenceFrame===t._referenceFrame};const p=f},81186:(t,e,i)=>{i.d(e,{Z:()=>v});var n=i(17216),r=i(17497),o=i(88779),s=i(54485),a=i(20176),h=i(92893),l=i(54219),u=i(97262),c=i(99536);const d={packedLength:1,pack:function(t,e,i){e[i=(0,o.Z)(i,0)]=t},unpack:function(t,e,i){return t[e=(0,o.Z)(e,0)]}};function f(t,e,i){let n;const r=t.length,o=i.length,s=r+o;if(t.length=s,r!==e){let i=r-1;for(n=s-1;n>=e;n--)t[n]=t[i--]}for(n=0;n<o;n++)t[e++]=i[n]}function p(t,e){return t instanceof u.Z?t:"string"==typeof t?u.Z.fromIso8601(t):u.Z.addSeconds(e,t,new u.Z)}const _=[],m=[];function g(t,e,i,r,o){let a,h,l,c,d,g,Z=0;for(;Z<r.length;){d=p(r[Z],t),l=(0,n.Z)(e,d,u.Z.compare);let y=0,v=0;if(l<0){for(l=~l,c=l*o,h=void 0,g=e[l];Z<r.length&&(d=p(r[Z],t),!((0,s.Z)(h)&&u.Z.compare(h,d)>=0||(0,s.Z)(g)&&u.Z.compare(d,g)>=0));){for(_[y++]=d,Z+=1,a=0;a<o;a++)m[v++]=r[Z],Z+=1;h=d}y>0&&(m.length=v,f(i,c,m),_.length=y,f(e,l,_))}else{for(a=0;a<o;a++)Z++,i[l*o+a]=r[Z];Z++}}}function Z(t,e){r.Z.defined("type",t);let i=t;i===Number&&(i=d);let n,a=i.packedLength,u=(0,o.Z)(i.packedInterpolationLength,a),f=0;if((0,s.Z)(e)){const t=e.length;n=new Array(t);for(let i=0;i<t;i++){let t=e[i];t===Number&&(t=d);const r=t.packedLength;a+=r,u+=(0,o.Z)(t.packedInterpolationLength,r),n[i]=t}f=t}this._type=t,this._innerType=i,this._interpolationDegree=1,this._interpolationAlgorithm=c.Z,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=a,this._packedInterpolationLength=u,this._updateTableLength=!0,this._interpolationResult=new Array(u),this._definitionChanged=new h.Z,this._derivativeTypes=e,this._innerDerivativeTypes=n,this._inputOrder=f,this._forwardExtrapolationType=l.Z.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=l.Z.NONE,this._backwardExtrapolationDuration=0}function y(t,e,i){const n=t._packedLength;t._times.splice(e,i),t._values.splice(e*n,i*n),t._updateTableLength=!0,t._definitionChanged.raiseEvent(t)}Object.defineProperties(Z.prototype,{isConstant:{get:function(){return 0===this._values.length}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(t){this._forwardExtrapolationType!==t&&(this._forwardExtrapolationType=t,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(t){this._forwardExtrapolationDuration!==t&&(this._forwardExtrapolationDuration=t,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(t){this._backwardExtrapolationType!==t&&(this._backwardExtrapolationType=t,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(t){this._backwardExtrapolationDuration!==t&&(this._backwardExtrapolationDuration=t,this._definitionChanged.raiseEvent(this))}}}),Z.prototype.getValue=function(t,e){r.Z.defined("time",t);const i=this._times,o=i.length;if(0===o)return;let a;const h=this._innerType,c=this._values;let d=(0,n.Z)(i,t,u.Z.compare);if(d<0){if(d=~d,0===d){const n=i[d];if(a=this._backwardExtrapolationDuration,this._backwardExtrapolationType===l.Z.NONE||0!==a&&u.Z.secondsDifference(n,t)>a)return;if(this._backwardExtrapolationType===l.Z.HOLD)return h.unpack(c,0,e)}if(d>=o){d=o-1;const n=i[d];if(a=this._forwardExtrapolationDuration,this._forwardExtrapolationType===l.Z.NONE||0!==a&&u.Z.secondsDifference(t,n)>a)return;if(this._forwardExtrapolationType===l.Z.HOLD)return d=o-1,h.unpack(c,d*h.packedLength,e)}const n=this._xTable,r=this._yTable,f=this._interpolationAlgorithm,p=this._packedInterpolationLength,_=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;const t=Math.min(f.getRequiredDataPoints(this._interpolationDegree,_),o);t!==this._numberOfPoints&&(this._numberOfPoints=t,n.length=t,r.length=t*p)}const m=this._numberOfPoints-1;if(m<1)return;let g=0,Z=o-1;if(Z-g+1>=m+1){let t=d-(m/2|0)-1;t<g&&(t=g);let e=t+m;e>Z&&(e=Z,t=e-m,t<g&&(t=g)),g=t,Z=e}const y=Z-g+1;for(let t=0;t<y;++t)n[t]=u.Z.secondsDifference(i[g+t],i[Z]);if((0,s.Z)(h.convertPackedArrayForInterpolation))h.convertPackedArrayForInterpolation(c,g,Z,r);else{let t=0;const e=this._packedLength;let i=g*e;const n=(Z+1)*e;for(;i<n;)r[t]=c[i],i++,t++}const v=u.Z.secondsDifference(t,i[Z]);let w;if(0!==_&&(0,s.Z)(f.interpolate)){const t=Math.floor(p/(_+1));w=f.interpolate(v,n,r,t,_,_,this._interpolationResult)}else w=f.interpolateOrderZero(v,n,r,p,this._interpolationResult);return(0,s.Z)(h.unpackInterpolationResult)?h.unpackInterpolationResult(w,c,g,Z,e):h.unpack(w,0,e)}return h.unpack(c,d*this._packedLength,e)},Z.prototype.setInterpolationOptions=function(t){if(!(0,s.Z)(t))return;let e=!1;const i=t.interpolationAlgorithm,n=t.interpolationDegree;(0,s.Z)(i)&&this._interpolationAlgorithm!==i&&(this._interpolationAlgorithm=i,e=!0),(0,s.Z)(n)&&this._interpolationDegree!==n&&(this._interpolationDegree=n,e=!0),e&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))},Z.prototype.addSample=function(t,e,i){const n=this._innerDerivativeTypes,o=(0,s.Z)(n);r.Z.defined("time",t),r.Z.defined("value",e),o&&r.Z.defined("derivatives",i);const a=this._innerType,h=[];if(h.push(t),a.pack(e,h,h.length),o){const t=n.length;for(let e=0;e<t;e++)n[e].pack(i[e],h,h.length)}g(void 0,this._times,this._values,h,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},Z.prototype.addSamples=function(t,e,i){const n=this._innerDerivativeTypes,o=(0,s.Z)(n);if(r.Z.defined("times",t),r.Z.defined("values",e),t.length!==e.length)throw new a.Z("times and values must be the same length.");if(o&&(!(0,s.Z)(i)||i.length!==t.length))throw new a.Z("times and derivativeValues must be the same length.");const h=this._innerType,l=t.length,u=[];for(let r=0;r<l;r++)if(u.push(t[r]),h.pack(e[r],u,u.length),o){const t=i[r],e=n.length;for(let i=0;i<e;i++)n[i].pack(t[i],u,u.length)}g(void 0,this._times,this._values,u,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},Z.prototype.addSamplesPackedArray=function(t,e){r.Z.defined("packedSamples",t),g(e,this._times,this._values,t,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},Z.prototype.removeSample=function(t){r.Z.defined("time",t);const e=(0,n.Z)(this._times,t,u.Z.compare);return!(e<0)&&(y(this,e,1),!0)},Z.prototype.removeSamples=function(t){r.Z.defined("timeInterval",t);const e=this._times;let i=(0,n.Z)(e,t.start,u.Z.compare);i<0?i=~i:t.isStartIncluded||++i;let o=(0,n.Z)(e,t.stop,u.Z.compare);o<0?o=~o:t.isStopIncluded&&++o,y(this,i,o-i)},Z.prototype.equals=function(t){if(this===t)return!0;if(!(0,s.Z)(t))return!1;if(this._type!==t._type||this._interpolationDegree!==t._interpolationDegree||this._interpolationAlgorithm!==t._interpolationAlgorithm)return!1;const e=this._derivativeTypes,i=(0,s.Z)(e),n=t._derivativeTypes;if(i!==(0,s.Z)(n))return!1;let r,o;if(i){if(o=e.length,o!==n.length)return!1;for(r=0;r<o;r++)if(e[r]!==n[r])return!1}const a=this._times,h=t._times;if(o=a.length,o!==h.length)return!1;for(r=0;r<o;r++)if(!u.Z.equals(a[r],h[r]))return!1;const l=this._values,c=t._values;for(o=l.length,r=0;r<o;r++)if(l[r]!==c[r])return!1;return!0},Z._mergeNewSamples=g;const v=Z},20909:(t,e,i)=>{i.d(e,{Z:()=>u});var n=i(54485),r=i(20176),o=i(99996),s=i(92893),a=i(31163),h=i(19157);function l(t){this._definitionChanged=new s.Z,this._value=void 0,this._removeSubscription=void 0,this.setValue(t)}Object.defineProperties(l.prototype,{isConstant:{get:function(){return h.Z.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return(0,n.Z)(this._value)?this._value.referenceFrame:a.Z.FIXED}}}),l.prototype.getValue=function(t,e){return this.getValueInReferenceFrame(t,a.Z.FIXED,e)},l.prototype.setValue=function(t){this._value!==t&&(this._value=t,(0,n.Z)(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),(0,n.Z)(t)&&(this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},l.prototype.getValueInReferenceFrame=function(t,e,i){if(!(0,n.Z)(t))throw new r.Z("time is required.");if(!(0,n.Z)(e))throw new r.Z("referenceFrame is required.");if((0,n.Z)(this._value))return i=this._value.getValueInReferenceFrame(t,e,i),(0,n.Z)(i)?o.Z.WGS84.scaleToGeodeticSurface(i,i):void 0},l.prototype.equals=function(t){return this===t||t instanceof l&&this._value===t._value},l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const u=l},9831:(t,e,i)=>{i.d(e,{Z:()=>D});var n=i(28474),r=i(93517),o=i(6785),s=i(41631),a=i(54485),h=i(51178),l=i(64493),u=i(6206),c=i(9008),d=i(27401),f=i(87546),p=i(3334),_=i(39613),m=i(19157);const g=new o.Z,Z=new h.Z,y=new h.Z,v=r.Z.ZERO,w=new r.Z;function T(t,e,i,r,o,s,h){let l;this.translucent=e,this.appearanceType=i,this.depthFailAppearanceType=r,this.depthFailMaterialProperty=o,this.depthFailMaterial=void 0,this.closed=s,this.shadows=h,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n.Z,this.updaters=new n.Z,this.updatersWithAttributes=new n.Z,this.attributes=new n.Z,this.subscriptions=new n.Z,this.showsUpdated=new n.Z,this.itemsToRemove=[],this.invalidated=!1,(0,a.Z)(o)&&(l=o.definitionChanged.addEventListener(T.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=l}function b(t,e,i,n,r){this._solidItems=[],this._translucentItems=[],this._primitives=t,this._appearanceType=e,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}function E(t,e){for(let i=t.length-1;i>=0;i--){const n=t[i];if(n.remove(e))return 0===n.updaters.length&&(t.splice(i,1),n.destroy()),!0}return!1}function x(t,e,i){let n=!1;const r=e.length;for(let o=0;o<r;++o){const r=e[o],s=r.itemsToRemove,a=s.length;if(a>0)for(o=0;o<a;o++){const e=s[o];r.remove(e),t.add(i,e),n=!0}}return n}function A(t,e,i,n){let r,o=e.length;for(r=o-1;r>=0;r--){const n=e[r];if(n.invalidated){e.splice(r,1);const o=n.updaters.values,s=o.length;for(let e=0;e<s;e++)t.add(i,o[e]);n.destroy()}}for(o=e.length,r=0;r<o;++r)n=e[r].update(i)&&n;return n}function C(t,e,i){const n=t.length;for(let r=0;r<n;r++){const n=t[r];if(n.contains(e))return n.getBoundingSphere(e,i)}return f.Z.FAILED}function S(t){const e=t.length;for(let i=0;i<e;i++)t[i].destroy();t.length=0}T.prototype.onMaterialChanged=function(){this.invalidated=!0},T.prototype.isMaterial=function(t){const e=this.depthFailMaterialProperty,i=t.depthFailMaterialProperty;return i===e||!!(0,a.Z)(e)&&e.equals(i)},T.prototype.add=function(t,e){const i=t.id;if(this.createPrimitive=!0,this.geometry.set(i,e),this.updaters.set(i,t),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&m.Z.isConstant(t.distanceDisplayConditionProperty)&&m.Z.isConstant(t.terrainOffsetProperty)){const e=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&e.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(i,t)},T.prototype.remove=function(t){const e=t.id;if(this.createPrimitive=this.geometry.remove(e)||this.createPrimitive,this.updaters.remove(e)){this.updatersWithAttributes.remove(e);const t=this.subscriptions.get(e);return(0,a.Z)(t)&&(t(),this.subscriptions.remove(e),this.showsUpdated.remove(e)),!0}return!1},T.prototype.update=function(t){let e=!0,i=0,n=this.primitive;const f=this.primitives;let T;if(this.createPrimitive){const i=this.geometry.values;if(i.length>0){let r;(0,a.Z)(n)&&((0,a.Z)(this.oldPrimitive)?f.remove(n):this.oldPrimitive=n),(0,a.Z)(this.depthFailAppearanceType)&&((0,a.Z)(this.depthFailMaterialProperty)&&(this.depthFailMaterial=_.Z.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial)),r=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),n=new d.Z({show:!1,asynchronous:!0,geometryInstances:i.slice(),appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:r,shadows:this.shadows}),f.add(n),e=!1}else{(0,a.Z)(n)&&(f.remove(n),n=void 0);const t=this.oldPrimitive;(0,a.Z)(t)&&(f.remove(t),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1,this.waitingOnCreate=!0}else if((0,a.Z)(n)&&n.ready){n.show=!0,(0,a.Z)(this.oldPrimitive)&&(f.remove(this.oldPrimitive),this.oldPrimitive=void 0),!(0,a.Z)(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof p.Z||(this.depthFailMaterial=_.Z.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);const e=this.updatersWithAttributes.values,d=e.length,b=this.waitingOnCreate;for(T=0;T<d;T++){const d=e[T],f=this.geometry.get(d.id);let _=this.attributes.get(f.id.id);if((0,a.Z)(_)||(_=n.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,_)),!d.fillMaterialProperty.isConstant||b){const e=d.fillMaterialProperty.color,n=m.Z.getValueOrDefault(e,t,o.Z.WHITE,g);o.Z.equals(_._lastColor,n)||(_._lastColor=o.Z.clone(n,_._lastColor),_.color=s.Z.toValue(n,_.color),(this.translucent&&255===_.color[3]||!this.translucent&&255!==_.color[3])&&(this.itemsToRemove[i++]=d))}if((0,a.Z)(this.depthFailAppearanceType)&&d.depthFailMaterialProperty instanceof p.Z&&(!d.depthFailMaterialProperty.isConstant||b)){const e=d.depthFailMaterialProperty.color,i=m.Z.getValueOrDefault(e,t,o.Z.WHITE,g);o.Z.equals(_._lastDepthFailColor,i)||(_._lastDepthFailColor=o.Z.clone(i,_._lastDepthFailColor),_.depthFailColor=s.Z.toValue(i,_.depthFailColor))}const E=d.entity.isShowing&&(d.hasConstantFill||d.isFilled(t));E!==(1===_.show[0])&&(_.show=c.Z.toValue(E,_.show));const x=d.distanceDisplayConditionProperty;if(!m.Z.isConstant(x)){const e=m.Z.getValueOrDefault(x,t,y,Z);h.Z.equals(e,_._lastDistanceDisplayCondition)||(_._lastDistanceDisplayCondition=h.Z.clone(e,_._lastDistanceDisplayCondition),_.distanceDisplayCondition=l.Z.toValue(e,_.distanceDisplayCondition))}const A=d.terrainOffsetProperty;if(!m.Z.isConstant(A)){const e=m.Z.getValueOrDefault(A,t,v,w);r.Z.equals(e,_._lastOffset)||(_._lastOffset=r.Z.clone(e,_._lastOffset),_.offset=u.Z.toValue(e,_.offset))}}this.updateShows(n),this.waitingOnCreate=!1}else(0,a.Z)(n)&&!n.ready&&(e=!1);return this.itemsToRemove.length=i,e},T.prototype.updateShows=function(t){const e=this.showsUpdated.values,i=e.length;for(let n=0;n<i;n++){const i=e[n],r=this.geometry.get(i.id);let o=this.attributes.get(r.id.id);(0,a.Z)(o)||(o=t.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,o));const s=i.entity.isShowing;s!==(1===o.show[0])&&(o.show=c.Z.toValue(s,o.show),r.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},T.prototype.contains=function(t){return this.updaters.contains(t.id)},T.prototype.getBoundingSphere=function(t,e){const i=this.primitive;if(!i.ready)return f.Z.PENDING;const n=i.getGeometryInstanceAttributes(t.entity);return!(0,a.Z)(n)||!(0,a.Z)(n.boundingSphere)||(0,a.Z)(n.show)&&0===n.show[0]?f.Z.FAILED:(n.boundingSphere.clone(e),f.Z.DONE)},T.prototype.destroy=function(){const t=this.primitive,e=this.primitives;(0,a.Z)(t)&&e.remove(t);const i=this.oldPrimitive;(0,a.Z)(i)&&e.remove(i),(0,a.Z)(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},b.prototype.add=function(t,e){let i,n;const r=e.createFillGeometryInstance(t);255===r.attributes.color.value[3]?(i=this._solidItems,n=!1):(i=this._translucentItems,n=!0);const o=i.length;for(let t=0;t<o;t++){const n=i[t];if(n.isMaterial(e))return void n.add(e,r)}const s=new T(this._primitives,n,this._appearanceType,this._depthFailAppearanceType,e.depthFailMaterialProperty,this._closed,this._shadows);s.add(e,r),i.push(s)},b.prototype.remove=function(t){E(this._solidItems,t)||E(this._translucentItems,t)},b.prototype.update=function(t){let e=A(this,this._solidItems,t,!0);e=A(this,this._translucentItems,t,e)&&e;const i=x(this,this._solidItems,t),n=x(this,this._translucentItems,t);return(i||n)&&(e=A(this,this._solidItems,t,e)&&e,e=A(this,this._translucentItems,t,e)&&e),e},b.prototype.getBoundingSphere=function(t,e){const i=C(this._solidItems,t,e);return i===f.Z.FAILED?C(this._translucentItems,t,e):i},b.prototype.removeAllPrimitives=function(){S(this._solidItems),S(this._translucentItems)};const D=b},4052:(t,e,i)=>{i.d(e,{Z:()=>E});var n=i(28474),r=i(93517),o=i(6785),s=i(41631),a=i(54485),h=i(51178),l=i(64493),u=i(6206),c=i(9008),d=i(27401),f=i(87546),p=i(3334),_=i(39613),m=i(19157);const g=new h.Z,Z=new h.Z,y=r.Z.ZERO,v=new r.Z;function w(t,e,i,r,o,s,a){this.primitives=t,this.appearanceType=e,this.materialProperty=i,this.depthFailAppearanceType=r,this.depthFailMaterialProperty=o,this.closed=s,this.shadows=a,this.updaters=new n.Z,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n.Z,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new n.Z,this.attributes=new n.Z,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(w.prototype.onMaterialChanged,this),this.subscriptions=new n.Z,this.showsUpdated=new n.Z}w.prototype.onMaterialChanged=function(){this.invalidated=!0},w.prototype.isMaterial=function(t){const e=this.materialProperty,i=t.fillMaterialProperty,n=this.depthFailMaterialProperty,r=t.depthFailMaterialProperty;if(i===e&&r===n)return!0;let o=(0,a.Z)(e)&&e.equals(i);return o=(!(0,a.Z)(n)&&!(0,a.Z)(r)||(0,a.Z)(n)&&n.equals(r))&&o,o},w.prototype.add=function(t,e){const i=e.id;if(this.updaters.set(i,e),this.geometry.set(i,e.createFillGeometryInstance(t)),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&m.Z.isConstant(e.distanceDisplayConditionProperty)&&m.Z.isConstant(e.terrainOffsetProperty)){const t=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&t.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e);this.createPrimitive=!0},w.prototype.remove=function(t){const e=t.id;if(this.createPrimitive=this.geometry.remove(e)||this.createPrimitive,this.updaters.remove(e)){this.updatersWithAttributes.remove(e);const t=this.subscriptions.get(e);return(0,a.Z)(t)&&(t(),this.subscriptions.remove(e),this.showsUpdated.remove(e)),!0}return!1};const T=new o.Z;function b(t,e,i,n,r){this._items=[],this._primitives=t,this._appearanceType=e,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}w.prototype.update=function(t){let e=!0,i=this.primitive;const n=this.primitives,f=this.geometry.values;let w;if(this.createPrimitive){if(f.length>0){let r;(0,a.Z)(i)&&((0,a.Z)(this.oldPrimitive)?n.remove(i):this.oldPrimitive=i),this.material=_.Z.getValue(t,this.materialProperty,this.material),(0,a.Z)(this.depthFailMaterialProperty)&&(this.depthFailMaterial=_.Z.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial),r=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),i=new d.Z({show:!1,asynchronous:!0,geometryInstances:f.slice(),appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:r,shadows:this.shadows}),n.add(i),e=!1}else{(0,a.Z)(i)&&(n.remove(i),i=void 0);const t=this.oldPrimitive;(0,a.Z)(t)&&(n.remove(t),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1}else if((0,a.Z)(i)&&i.ready){i.show=!0,(0,a.Z)(this.oldPrimitive)&&(n.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=_.Z.getValue(t,this.materialProperty,this.material),this.primitive.appearance.material=this.material,!(0,a.Z)(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof p.Z||(this.depthFailMaterial=_.Z.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);const e=this.updatersWithAttributes.values,d=e.length;for(w=0;w<d;w++){const n=e[w],d=n.entity,f=this.geometry.get(n.id);let _=this.attributes.get(f.id.id);if((0,a.Z)(_)||(_=i.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,_)),(0,a.Z)(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof p.Z&&!n.depthFailMaterialProperty.isConstant){const e=n.depthFailMaterialProperty.color,i=m.Z.getValueOrDefault(e,t,o.Z.WHITE,T);o.Z.equals(_._lastDepthFailColor,i)||(_._lastDepthFailColor=o.Z.clone(i,_._lastDepthFailColor),_.depthFailColor=s.Z.toValue(i,_.depthFailColor))}const b=d.isShowing&&(n.hasConstantFill||n.isFilled(t));b!==(1===_.show[0])&&(_.show=c.Z.toValue(b,_.show));const E=n.distanceDisplayConditionProperty;if(!m.Z.isConstant(E)){const e=m.Z.getValueOrDefault(E,t,Z,g);h.Z.equals(e,_._lastDistanceDisplayCondition)||(_._lastDistanceDisplayCondition=h.Z.clone(e,_._lastDistanceDisplayCondition),_.distanceDisplayCondition=l.Z.toValue(e,_.distanceDisplayCondition))}const x=n.terrainOffsetProperty;if(!m.Z.isConstant(x)){const e=m.Z.getValueOrDefault(x,t,y,v);r.Z.equals(e,_._lastOffset)||(_._lastOffset=r.Z.clone(e,_._lastOffset),_.offset=u.Z.toValue(e,_.offset))}}this.updateShows(i)}else(0,a.Z)(i)&&!i.ready&&(e=!1);return e},w.prototype.updateShows=function(t){const e=this.showsUpdated.values,i=e.length;for(let n=0;n<i;n++){const i=e[n],r=i.entity,o=this.geometry.get(i.id);let s=this.attributes.get(o.id.id);(0,a.Z)(s)||(s=t.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,s));const h=r.isShowing;h!==(1===s.show[0])&&(s.show=c.Z.toValue(h,s.show),o.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},w.prototype.contains=function(t){return this.updaters.contains(t.id)},w.prototype.getBoundingSphere=function(t,e){const i=this.primitive;if(!i.ready)return f.Z.PENDING;const n=i.getGeometryInstanceAttributes(t.entity);return!(0,a.Z)(n)||!(0,a.Z)(n.boundingSphere)||(0,a.Z)(n.show)&&0===n.show[0]?f.Z.FAILED:(n.boundingSphere.clone(e),f.Z.DONE)},w.prototype.destroy=function(){const t=this.primitive,e=this.primitives;(0,a.Z)(t)&&e.remove(t);const i=this.oldPrimitive;(0,a.Z)(i)&&e.remove(i),this.removeMaterialSubscription()},b.prototype.add=function(t,e){const i=this._items,n=i.length;for(let r=0;r<n;r++){const n=i[r];if(n.isMaterial(e))return void n.add(t,e)}const r=new w(this._primitives,this._appearanceType,e.fillMaterialProperty,this._depthFailAppearanceType,e.depthFailMaterialProperty,this._closed,this._shadows);r.add(t,e),i.push(r)},b.prototype.remove=function(t){const e=this._items;for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.remove(t)){0===n.updaters.length&&(e.splice(i,1),n.destroy());break}}},b.prototype.update=function(t){let e;const i=this._items;for(e=i.length-1;e>=0;e--){const n=i[e];if(n.invalidated){i.splice(e,1);const r=n.updaters.values,o=r.length;for(let e=0;e<o;e++)this.add(t,r[e]);n.destroy()}}let n=!0;for(e=0;e<i.length;e++)n=i[e].update(t)&&n;return n},b.prototype.getBoundingSphere=function(t,e){const i=this._items,n=i.length;for(let r=0;r<n;r++){const n=i[r];if(n.contains(t))return n.getBoundingSphere(t,e)}return f.Z.FAILED},b.prototype.removeAllPrimitives=function(){const t=this._items,e=t.length;for(let i=0;i<e;i++)t[i].destroy();this._items.length=0};const E=b},58207:(t,e,i)=>{i.d(e,{Z:()=>y});var n=i(28474),r=i(6785),o=i(41631),s=i(54485),a=i(51178),h=i(64493),l=i(9008),u=i(63333),c=i(87546),d=i(19157),f=i(7499);const p=new r.Z,_=new a.Z,m=new a.Z;function g(t,e,i,r){this.primitives=t,this.zIndex=r,this.classificationType=e,this.color=i,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n.Z,this.updaters=new n.Z,this.updatersWithAttributes=new n.Z,this.attributes=new n.Z,this.subscriptions=new n.Z,this.showsUpdated=new n.Z,this.itemsToRemove=[],this.isDirty=!1,this.rectangleCollisionCheck=new f.Z}function Z(t,e){this._batches=[],this._primitives=t,this._classificationType=e}g.prototype.overlapping=function(t){return this.rectangleCollisionCheck.collides(t)},g.prototype.add=function(t,e){const i=t.id;if(this.createPrimitive=!0,this.geometry.set(i,e),this.updaters.set(i,t),this.rectangleCollisionCheck.insert(i,e.geometry.rectangle),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&d.Z.isConstant(t.distanceDisplayConditionProperty)){const e=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&e.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(i,t)},g.prototype.remove=function(t){const e=t.id,i=this.geometry.get(e);if(this.createPrimitive=this.geometry.remove(e)||this.createPrimitive,this.updaters.remove(e)){this.rectangleCollisionCheck.remove(e,i.geometry.rectangle),this.updatersWithAttributes.remove(e);const t=this.subscriptions.get(e);return(0,s.Z)(t)&&(t(),this.subscriptions.remove(e),this.showsUpdated.remove(e)),!0}return!1},g.prototype.update=function(t){let e=!0;let i=this.primitive;const n=this.primitives;let c;if(this.createPrimitive){const t=this.geometry.values;if(t.length>0)(0,s.Z)(i)&&((0,s.Z)(this.oldPrimitive)?n.remove(i):this.oldPrimitive=i),i=new u.Z({show:!1,asynchronous:!0,geometryInstances:t.slice(),classificationType:this.classificationType}),n.add(i,this.zIndex),e=!1;else{(0,s.Z)(i)&&(n.remove(i),i=void 0);const t=this.oldPrimitive;(0,s.Z)(t)&&(n.remove(t),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1,this.waitingOnCreate=!0}else if((0,s.Z)(i)&&i.ready){i.show=!0,(0,s.Z)(this.oldPrimitive)&&(n.remove(this.oldPrimitive),this.oldPrimitive=void 0);const e=this.updatersWithAttributes.values,u=e.length,f=this.waitingOnCreate;for(c=0;c<u;c++){const n=e[c],u=this.geometry.get(n.id);let g=this.attributes.get(u.id.id);if((0,s.Z)(g)||(g=i.getGeometryInstanceAttributes(u.id),this.attributes.set(u.id.id,g)),!n.fillMaterialProperty.isConstant||f){const e=n.fillMaterialProperty.color,i=d.Z.getValueOrDefault(e,t,r.Z.WHITE,p);r.Z.equals(g._lastColor,i)||(g._lastColor=r.Z.clone(i,g._lastColor),g.color=o.Z.toValue(i,g.color))}const Z=n.entity.isShowing&&(n.hasConstantFill||n.isFilled(t));Z!==(1===g.show[0])&&(g.show=l.Z.toValue(Z,g.show));const y=n.distanceDisplayConditionProperty;if(!d.Z.isConstant(y)){const e=d.Z.getValueOrDefault(y,t,m,_);a.Z.equals(e,g._lastDistanceDisplayCondition)||(g._lastDistanceDisplayCondition=a.Z.clone(e,g._lastDistanceDisplayCondition),g.distanceDisplayCondition=h.Z.toValue(e,g.distanceDisplayCondition))}}this.updateShows(i),this.waitingOnCreate=!1}else(0,s.Z)(i)&&!i.ready&&(e=!1);return this.itemsToRemove.length=0,e},g.prototype.updateShows=function(t){const e=this.showsUpdated.values,i=e.length;for(let n=0;n<i;n++){const i=e[n],r=this.geometry.get(i.id);let o=this.attributes.get(r.id.id);(0,s.Z)(o)||(o=t.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,o));const a=i.entity.isShowing;a!==(1===o.show[0])&&(o.show=l.Z.toValue(a,o.show),r.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},g.prototype.contains=function(t){return this.updaters.contains(t.id)},g.prototype.getBoundingSphere=function(t,e){const i=this.primitive;if(!i.ready)return c.Z.PENDING;const n=i.getBoundingSphere(t.entity);return(0,s.Z)(n)?(n.clone(e),c.Z.DONE):c.Z.FAILED},g.prototype.removeAllPrimitives=function(){const t=this.primitives,e=this.primitive;(0,s.Z)(e)&&(t.remove(e),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());const i=this.oldPrimitive;(0,s.Z)(i)&&(t.remove(i),this.oldPrimitive=void 0)},Z.prototype.add=function(t,e){const i=e.createFillGeometryInstance(t),n=this._batches,r=d.Z.getValueOrDefault(e.zIndex,0);let o;const a=n.length;for(let t=0;t<a;++t){const e=n[t];if(e.zIndex===r&&!e.overlapping(i.geometry.rectangle)){o=e;break}}return(0,s.Z)(o)||(o=new g(this._primitives,this._classificationType,i.attributes.color.value,r),n.push(o)),o.add(e,i),o},Z.prototype.remove=function(t){const e=this._batches,i=e.length;for(let n=0;n<i;++n)if(e[n].remove(t))return},Z.prototype.update=function(t){let e,i,n=!0;const r=this._batches,o=r.length;for(e=0;e<o;++e)n=r[e].update(t)&&n;for(e=0;e<o;++e){const n=r[e],o=n.itemsToRemove,s=o.length;for(let e=0;e<s;e++){i=o[e],n.remove(i);const r=this.add(t,i);n.isDirty=!0,r.isDirty=!0}}for(e=o-1;e>=0;--e){const i=r[e];i.isDirty&&(n=r[e].update(t)&&n,i.isDirty=!1),0===i.geometry.length&&r.splice(e,1)}return n},Z.prototype.getBoundingSphere=function(t,e){const i=this._batches,n=i.length;for(let r=0;r<n;++r){const n=i[r];if(n.contains(t))return n.getBoundingSphere(t,e)}return c.Z.FAILED},Z.prototype.removeAllPrimitives=function(){const t=this._batches,e=t.length;for(let i=0;i<e;++i)t[i].removeAllPrimitives()};const y=Z},48762:(t,e,i)=>{i.d(e,{Z:()=>y});var n=i(28474),r=i(54485),o=i(51178),s=i(64493),a=i(7499),h=i(9008),l=i(63333),u=i(342),c=i(87546),d=i(3334),f=i(39613),p=i(19157);const _=new o.Z,m=new o.Z;function g(t,e,i,r,o,s){this.primitives=t,this.classificationType=e,this.appearanceType=i,this.materialProperty=r,this.updaters=new n.Z,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n.Z,this.material=void 0,this.updatersWithAttributes=new n.Z,this.attributes=new n.Z,this.invalidated=!1,this.removeMaterialSubscription=r.definitionChanged.addEventListener(g.prototype.onMaterialChanged,this),this.subscriptions=new n.Z,this.showsUpdated=new n.Z,this.usingSphericalTextureCoordinates=o,this.zIndex=s,this.rectangleCollisionCheck=new a.Z}function Z(t,e,i){this._items=[],this._primitives=t,this._classificationType=e,this._appearanceType=i}g.prototype.onMaterialChanged=function(){this.invalidated=!0},g.prototype.overlapping=function(t){return this.rectangleCollisionCheck.collides(t)},g.prototype.isMaterial=function(t){const e=this.materialProperty,i=t.fillMaterialProperty;return i===e||i instanceof d.Z&&e instanceof d.Z||(0,r.Z)(e)&&e.equals(i)},g.prototype.add=function(t,e,i){const n=e.id;if(this.updaters.set(n,e),this.geometry.set(n,i),this.rectangleCollisionCheck.insert(n,i.geometry.rectangle),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&p.Z.isConstant(e.distanceDisplayConditionProperty)){const t=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&t.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(n,e);this.createPrimitive=!0},g.prototype.remove=function(t){const e=t.id,i=this.geometry.get(e);if(this.createPrimitive=this.geometry.remove(e)||this.createPrimitive,this.updaters.remove(e)){this.rectangleCollisionCheck.remove(e,i.geometry.rectangle),this.updatersWithAttributes.remove(e);const t=this.subscriptions.get(e);return(0,r.Z)(t)&&(t(),this.subscriptions.remove(e)),!0}return!1},g.prototype.update=function(t){let e=!0,i=this.primitive;const n=this.primitives,a=this.geometry.values;let u;if(this.createPrimitive){if(a.length>0)(0,r.Z)(i)&&((0,r.Z)(this.oldPrimitive)?n.remove(i):this.oldPrimitive=i),this.material=f.Z.getValue(t,this.materialProperty,this.material),i=new l.Z({show:!1,asynchronous:!0,geometryInstances:a.slice(),appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),n.add(i,this.zIndex),e=!1;else{(0,r.Z)(i)&&(n.remove(i),i=void 0);const t=this.oldPrimitive;(0,r.Z)(t)&&(n.remove(t),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1}else if((0,r.Z)(i)&&i.ready){i.show=!0,(0,r.Z)(this.oldPrimitive)&&(n.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=f.Z.getValue(t,this.materialProperty,this.material),this.primitive.appearance.material=this.material;const e=this.updatersWithAttributes.values,a=e.length;for(u=0;u<a;u++){const n=e[u],a=n.entity,l=this.geometry.get(n.id);let c=this.attributes.get(l.id.id);(0,r.Z)(c)||(c=i.getGeometryInstanceAttributes(l.id),this.attributes.set(l.id.id,c));const d=a.isShowing&&(n.hasConstantFill||n.isFilled(t));d!==(1===c.show[0])&&(c.show=h.Z.toValue(d,c.show));const f=n.distanceDisplayConditionProperty;if(!p.Z.isConstant(f)){const e=p.Z.getValueOrDefault(f,t,m,_);o.Z.equals(e,c._lastDistanceDisplayCondition)||(c._lastDistanceDisplayCondition=o.Z.clone(e,c._lastDistanceDisplayCondition),c.distanceDisplayCondition=s.Z.toValue(e,c.distanceDisplayCondition))}}this.updateShows(i)}else(0,r.Z)(i)&&!i.ready&&(e=!1);return e},g.prototype.updateShows=function(t){const e=this.showsUpdated.values,i=e.length;for(let n=0;n<i;n++){const i=e[n],o=i.entity,s=this.geometry.get(i.id);let a=this.attributes.get(s.id.id);(0,r.Z)(a)||(a=t.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));const l=o.isShowing;l!==(1===a.show[0])&&(a.show=h.Z.toValue(l,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()},g.prototype.contains=function(t){return this.updaters.contains(t.id)},g.prototype.getBoundingSphere=function(t,e){const i=this.primitive;if(!i.ready)return c.Z.PENDING;const n=i.getGeometryInstanceAttributes(t.entity);return!(0,r.Z)(n)||!(0,r.Z)(n.boundingSphere)||(0,r.Z)(n.show)&&0===n.show[0]?c.Z.FAILED:(n.boundingSphere.clone(e),c.Z.DONE)},g.prototype.destroy=function(){const t=this.primitive,e=this.primitives;(0,r.Z)(t)&&e.remove(t);const i=this.oldPrimitive;(0,r.Z)(i)&&e.remove(i),this.removeMaterialSubscription()},Z.prototype.add=function(t,e){const i=this._items,n=i.length,r=e.createFillGeometryInstance(t),o=u.Z.shouldUseSphericalCoordinates(r.geometry.rectangle),s=p.Z.getValueOrDefault(e.zIndex,0);for(let a=0;a<n;++a){const n=i[a];if(n.isMaterial(e)&&n.usingSphericalTextureCoordinates===o&&n.zIndex===s&&!n.overlapping(r.geometry.rectangle))return void n.add(t,e,r)}const a=new g(this._primitives,this._classificationType,this._appearanceType,e.fillMaterialProperty,o,s);a.add(t,e,r),i.push(a)},Z.prototype.remove=function(t){const e=this._items;for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.remove(t)){0===n.updaters.length&&(e.splice(i,1),n.destroy());break}}},Z.prototype.update=function(t){let e;const i=this._items;for(e=i.length-1;e>=0;e--){const n=i[e];if(n.invalidated){i.splice(e,1);const r=n.updaters.values,o=r.length;for(let e=0;e<o;e++)this.add(t,r[e]);n.destroy()}}let n=!0;for(e=0;e<i.length;e++)n=i[e].update(t)&&n;return n},Z.prototype.getBoundingSphere=function(t,e){const i=this._items,n=i.length;for(let r=0;r<n;r++){const n=i[r];if(n.contains(t))return n.getBoundingSphere(t,e)}return c.Z.FAILED},Z.prototype.removeAllPrimitives=function(){const t=this._items,e=t.length;for(let i=0;i<e;i++)t[i].destroy();this._items.length=0};const y=Z},38660:(t,e,i)=>{i.d(e,{Z:()=>b});var n=i(28474),r=i(6785),o=i(41631),s=i(88779),a=i(54485),h=i(51178),l=i(64493),u=i(9008),c=i(94193),d=i(69154),f=i(11922),p=i(87546),_=i(3334),m=i(39613),g=i(19157);const Z=new r.Z,y=new h.Z,v=new h.Z;function w(t,e,i,r,o){let s;s=i instanceof _.Z?d.Z:f.Z,this.orderedGroundPrimitives=t,this.classificationType=e,this.appearanceType=s,this.materialProperty=i,this.updaters=new n.Z,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n.Z,this.material=void 0,this.updatersWithAttributes=new n.Z,this.attributes=new n.Z,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(w.prototype.onMaterialChanged,this),this.subscriptions=new n.Z,this.showsUpdated=new n.Z,this.zIndex=r,this._asynchronous=o}function T(t,e,i){this._items=[],this._orderedGroundPrimitives=t,this._classificationType=e,this._asynchronous=(0,s.Z)(i,!0)}w.prototype.onMaterialChanged=function(){this.invalidated=!0},w.prototype.isMaterial=function(t){const e=this.materialProperty,i=t.fillMaterialProperty;return i===e||i instanceof _.Z&&e instanceof _.Z||(0,a.Z)(e)&&e.equals(i)},w.prototype.add=function(t,e,i){const n=e.id;if(this.updaters.set(n,e),this.geometry.set(n,i),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&g.Z.isConstant(e.distanceDisplayConditionProperty)){const t=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&t.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(n,e);this.createPrimitive=!0},w.prototype.remove=function(t){const e=t.id;if(this.createPrimitive=this.geometry.remove(e)||this.createPrimitive,this.updaters.remove(e)){this.updatersWithAttributes.remove(e);const t=this.subscriptions.get(e);return(0,a.Z)(t)&&(t(),this.subscriptions.remove(e)),!0}return!1},w.prototype.update=function(t){let e=!0,i=this.primitive;const n=this.orderedGroundPrimitives,s=this.geometry.values;let d;if(this.createPrimitive){if(s.length>0)(0,a.Z)(i)&&((0,a.Z)(this.oldPrimitive)?n.remove(i):this.oldPrimitive=i),i=new c.Z({show:!1,asynchronous:this._asynchronous,geometryInstances:s.slice(),appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===f.Z&&(this.material=m.Z.getValue(t,this.materialProperty,this.material),i.appearance.material=this.material),n.add(i,this.zIndex),e=!1;else{(0,a.Z)(i)&&(n.remove(i),i=void 0);const t=this.oldPrimitive;(0,a.Z)(t)&&(n.remove(t),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1}else if((0,a.Z)(i)&&i.ready){i.show=!0,(0,a.Z)(this.oldPrimitive)&&(n.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===f.Z&&(this.material=m.Z.getValue(t,this.materialProperty,this.material),this.primitive.appearance.material=this.material);const e=this.updatersWithAttributes.values,s=e.length;for(d=0;d<s;d++){const n=e[d],s=n.entity,c=this.geometry.get(n.id);let f=this.attributes.get(c.id.id);if((0,a.Z)(f)||(f=i.getGeometryInstanceAttributes(c.id),this.attributes.set(c.id.id,f)),!n.fillMaterialProperty.isConstant){const e=n.fillMaterialProperty.color,i=g.Z.getValueOrDefault(e,t,r.Z.WHITE,Z);r.Z.equals(f._lastColor,i)||(f._lastColor=r.Z.clone(i,f._lastColor),f.color=o.Z.toValue(i,f.color))}const p=s.isShowing&&(n.hasConstantFill||n.isFilled(t));p!==(1===f.show[0])&&(f.show=u.Z.toValue(p,f.show));const _=n.distanceDisplayConditionProperty;if(!g.Z.isConstant(_)){const e=g.Z.getValueOrDefault(_,t,v,y);h.Z.equals(e,f._lastDistanceDisplayCondition)||(f._lastDistanceDisplayCondition=h.Z.clone(e,f._lastDistanceDisplayCondition),f.distanceDisplayCondition=l.Z.toValue(e,f.distanceDisplayCondition))}}this.updateShows(i)}else(0,a.Z)(i)&&!i.ready&&(e=!1);return e},w.prototype.updateShows=function(t){const e=this.showsUpdated.values,i=e.length;for(let n=0;n<i;n++){const i=e[n],r=i.entity,o=this.geometry.get(i.id);let s=this.attributes.get(o.id.id);(0,a.Z)(s)||(s=t.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,s));const h=r.isShowing;h!==(1===s.show[0])&&(s.show=u.Z.toValue(h,s.show),o.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},w.prototype.contains=function(t){return this.updaters.contains(t.id)},w.prototype.getBoundingSphere=function(t,e){const i=this.primitive;if(!i.ready)return p.Z.PENDING;const n=i.getGeometryInstanceAttributes(t.entity);return!(0,a.Z)(n)||!(0,a.Z)(n.boundingSphere)||(0,a.Z)(n.show)&&0===n.show[0]?p.Z.FAILED:(n.boundingSphere.clone(e),p.Z.DONE)},w.prototype.destroy=function(){const t=this.primitive,e=this.orderedGroundPrimitives;(0,a.Z)(t)&&e.remove(t);const i=this.oldPrimitive;(0,a.Z)(i)&&e.remove(i),this.removeMaterialSubscription()},T.prototype.add=function(t,e){const i=this._items,n=i.length,r=e.createFillGeometryInstance(t),o=g.Z.getValueOrDefault(e.zIndex,0);for(let s=0;s<n;++s){const n=i[s];if(n.isMaterial(e)&&n.zIndex===o)return void n.add(t,e,r)}const s=new w(this._orderedGroundPrimitives,this._classificationType,e.fillMaterialProperty,o,this._asynchronous);s.add(t,e,r),i.push(s)},T.prototype.remove=function(t){const e=this._items;for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.remove(t)){0===n.updaters.length&&(e.splice(i,1),n.destroy());break}}},T.prototype.update=function(t){let e;const i=this._items;for(e=i.length-1;e>=0;e--){const n=i[e];if(n.invalidated){i.splice(e,1);const r=n.updaters.values,o=r.length;for(let e=0;e<o;e++)this.add(t,r[e]);n.destroy()}}let n=!0;for(e=0;e<i.length;e++)n=i[e].update(t)&&n;return n},T.prototype.getBoundingSphere=function(t,e){const i=this._items,n=i.length;for(let r=0;r<n;r++){const n=i[r];if(n.contains(t))return n.getBoundingSphere(t,e)}return p.Z.FAILED},T.prototype.removeAllPrimitives=function(){const t=this._items,e=t.length;for(let i=0;i<e;i++)t[i].destroy();this._items.length=0};const b=T},73699:(t,e,i)=>{i.d(e,{Z:()=>b});var n=i(28474),r=i(93517),o=i(6785),s=i(41631),a=i(54485),h=i(51178),l=i(64493),u=i(6206),c=i(9008),d=i(73020),f=i(27401),p=i(87546),_=i(19157);const m=new o.Z,g=new h.Z,Z=new h.Z,y=r.Z.ZERO,v=new r.Z;function w(t,e,i,r){this.translucent=e,this.width=i,this.shadows=r,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new n.Z,this.updaters=new n.Z,this.updatersWithAttributes=new n.Z,this.attributes=new n.Z,this.itemsToRemove=[],this.subscriptions=new n.Z,this.showsUpdated=new n.Z}function T(t,e,i){this._primitives=t,this._scene=e,this._shadows=i,this._solidBatches=new n.Z,this._translucentBatches=new n.Z}w.prototype.add=function(t,e){const i=t.id;if(this.createPrimitive=!0,this.geometry.set(i,e),this.updaters.set(i,t),t.hasConstantOutline&&t.outlineColorProperty.isConstant&&_.Z.isConstant(t.distanceDisplayConditionProperty)&&_.Z.isConstant(t.terrainOffsetProperty)){const e=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&e.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(i,t)},w.prototype.remove=function(t){const e=t.id;if(this.createPrimitive=this.geometry.remove(e)||this.createPrimitive,this.updaters.remove(e)){this.updatersWithAttributes.remove(e);const t=this.subscriptions.get(e);return(0,a.Z)(t)&&(t(),this.subscriptions.remove(e),this.showsUpdated.remove(e)),!0}return!1},w.prototype.update=function(t){let e=!0,i=0,n=this.primitive;const p=this.primitives;let w;if(this.createPrimitive){const t=this.geometry.values;if(t.length>0)(0,a.Z)(n)&&((0,a.Z)(this.oldPrimitive)?p.remove(n):this.oldPrimitive=n),n=new f.Z({show:!1,asynchronous:!0,geometryInstances:t.slice(),appearance:new d.Z({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),p.add(n),e=!1;else{(0,a.Z)(n)&&(p.remove(n),n=void 0);const t=this.oldPrimitive;(0,a.Z)(t)&&(p.remove(t),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1,this.waitingOnCreate=!0}else if((0,a.Z)(n)&&n.ready){n.show=!0,(0,a.Z)(this.oldPrimitive)&&(p.remove(this.oldPrimitive),this.oldPrimitive=void 0);const e=this.updatersWithAttributes.values,d=e.length,f=this.waitingOnCreate;for(w=0;w<d;w++){const d=e[w],p=this.geometry.get(d.id);let T=this.attributes.get(p.id.id);if((0,a.Z)(T)||(T=n.getGeometryInstanceAttributes(p.id),this.attributes.set(p.id.id,T)),!d.outlineColorProperty.isConstant||f){const e=d.outlineColorProperty,n=_.Z.getValueOrDefault(e,t,o.Z.WHITE,m);o.Z.equals(T._lastColor,n)||(T._lastColor=o.Z.clone(n,T._lastColor),T.color=s.Z.toValue(n,T.color),(this.translucent&&255===T.color[3]||!this.translucent&&255!==T.color[3])&&(this.itemsToRemove[i++]=d))}const b=d.entity.isShowing&&(d.hasConstantOutline||d.isOutlineVisible(t));b!==(1===T.show[0])&&(T.show=c.Z.toValue(b,T.show));const E=d.distanceDisplayConditionProperty;if(!_.Z.isConstant(E)){const e=_.Z.getValueOrDefault(E,t,Z,g);h.Z.equals(e,T._lastDistanceDisplayCondition)||(T._lastDistanceDisplayCondition=h.Z.clone(e,T._lastDistanceDisplayCondition),T.distanceDisplayCondition=l.Z.toValue(e,T.distanceDisplayCondition))}const x=d.terrainOffsetProperty;if(!_.Z.isConstant(x)){const e=_.Z.getValueOrDefault(x,t,y,v);r.Z.equals(e,T._lastOffset)||(T._lastOffset=r.Z.clone(e,T._lastOffset),T.offset=u.Z.toValue(e,T.offset))}}this.updateShows(n),this.waitingOnCreate=!1}else(0,a.Z)(n)&&!n.ready&&(e=!1);return this.itemsToRemove.length=i,e},w.prototype.updateShows=function(t){const e=this.showsUpdated.values,i=e.length;for(let n=0;n<i;n++){const i=e[n],r=this.geometry.get(i.id);let o=this.attributes.get(r.id.id);(0,a.Z)(o)||(o=t.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,o));const s=i.entity.isShowing;s!==(1===o.show[0])&&(o.show=c.Z.toValue(s,o.show),r.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},w.prototype.contains=function(t){return this.updaters.contains(t.id)},w.prototype.getBoundingSphere=function(t,e){const i=this.primitive;if(!i.ready)return p.Z.PENDING;const n=i.getGeometryInstanceAttributes(t.entity);return!(0,a.Z)(n)||!(0,a.Z)(n.boundingSphere)||(0,a.Z)(n.show)&&0===n.show[0]?p.Z.FAILED:(n.boundingSphere.clone(e),p.Z.DONE)},w.prototype.removeAllPrimitives=function(){const t=this.primitives,e=this.primitive;(0,a.Z)(e)&&(t.remove(e),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());const i=this.oldPrimitive;(0,a.Z)(i)&&(t.remove(i),this.oldPrimitive=void 0)},T.prototype.add=function(t,e){const i=e.createOutlineGeometryInstance(t),n=this._scene.clampLineWidth(e.outlineWidth);let r,o;255===i.attributes.color.value[3]?(r=this._solidBatches,o=r.get(n),(0,a.Z)(o)||(o=new w(this._primitives,!1,n,this._shadows),r.set(n,o)),o.add(e,i)):(r=this._translucentBatches,o=r.get(n),(0,a.Z)(o)||(o=new w(this._primitives,!0,n,this._shadows),r.set(n,o)),o.add(e,i))},T.prototype.remove=function(t){let e;const i=this._solidBatches.values,n=i.length;for(e=0;e<n;e++)if(i[e].remove(t))return;const r=this._translucentBatches.values,o=r.length;for(e=0;e<o;e++)if(r[e].remove(t))return},T.prototype.update=function(t){let e,i,n,r;const o=this._solidBatches.values,s=o.length,a=this._translucentBatches.values,h=a.length;let l,u=!0,c=!1;do{for(c=!1,i=0;i<s;i++){r=o[i],u=r.update(t),l=r.itemsToRemove;const s=l.length;if(s>0)for(c=!0,e=0;e<s;e++)n=l[e],r.remove(n),this.add(t,n)}for(i=0;i<h;i++){r=a[i],u=r.update(t),l=r.itemsToRemove;const o=l.length;if(o>0)for(c=!0,e=0;e<o;e++)n=l[e],r.remove(n),this.add(t,n)}}while(c);return u},T.prototype.getBoundingSphere=function(t,e){let i;const n=this._solidBatches.values,r=n.length;for(i=0;i<r;i++){const r=n[i];if(r.contains(t))return r.getBoundingSphere(t,e)}const o=this._translucentBatches.values,s=o.length;for(i=0;i<s;i++){const n=o[i];if(n.contains(t))return n.getBoundingSphere(t,e)}return p.Z.FAILED},T.prototype.removeAllPrimitives=function(){let t;const e=this._solidBatches.values,i=e.length;for(t=0;t<i;t++)e[t].removeAllPrimitives();const n=this._translucentBatches.values,r=n.length;for(t=0;t<r;t++)n[t].removeAllPrimitives()};const b=T},11984:(t,e,i)=>{i.d(e,{Z:()=>p});var n=i(6785),r=i(88779),o=i(54485),s=i(92893),a=i(37105),h=i(19157),l=i(74662);const u=l.Z.HORIZONTAL,c=n.Z.WHITE,d=n.Z.BLACK;function f(t){t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),this._definitionChanged=new s.Z,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=t.orientation,this.evenColor=t.evenColor,this.oddColor=t.oddColor,this.offset=t.offset,this.repeat=t.repeat}Object.defineProperties(f.prototype,{isConstant:{get:function(){return h.Z.isConstant(this._orientation)&&h.Z.isConstant(this._evenColor)&&h.Z.isConstant(this._oddColor)&&h.Z.isConstant(this._offset)&&h.Z.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:(0,a.Z)("orientation"),evenColor:(0,a.Z)("evenColor"),oddColor:(0,a.Z)("oddColor"),offset:(0,a.Z)("offset"),repeat:(0,a.Z)("repeat")}),f.prototype.getType=function(t){return"Stripe"},f.prototype.getValue=function(t,e){return(0,o.Z)(e)||(e={}),e.horizontal=h.Z.getValueOrDefault(this._orientation,t,u)===l.Z.HORIZONTAL,e.evenColor=h.Z.getValueOrClonedDefault(this._evenColor,t,c,e.evenColor),e.oddColor=h.Z.getValueOrClonedDefault(this._oddColor,t,d,e.oddColor),e.offset=h.Z.getValueOrDefault(this._offset,t,0),e.repeat=h.Z.getValueOrDefault(this._repeat,t,1),e},f.prototype.equals=function(t){return this===t||t instanceof f&&h.Z.equals(this._orientation,t._orientation)&&h.Z.equals(this._evenColor,t._evenColor)&&h.Z.equals(this._oddColor,t._oddColor)&&h.Z.equals(this._offset,t._offset)&&h.Z.equals(this._repeat,t._repeat)};const p=f},74662:(t,e,i)=>{i.d(e,{Z:()=>n});const n=Object.freeze({HORIZONTAL:0,VERTICAL:1})},23824:(t,e,i)=>{i.d(e,{Z:()=>g});var n=i(93517),r=i(66866),o=i(17497),s=i(54485),a=i(90332),h=i(92893),l=i(18926),u=i(22874),c=i(16272),d=i(18061),f=i(19157);const p=new n.Z,_=new r.Z;function m(t,e,i,a){o.Z.defined("scene",t),o.Z.defined("positionProperty",e),this._scene=t,this._heightReference=i,this._extrudedHeightReference=a,this._positionProperty=e,this._position=new n.Z,this._cartographicPosition=new r.Z,this._normal=new n.Z,this._definitionChanged=new h.Z,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;const u=this;if((0,s.Z)(t.globe)&&(this._removeEventListener=t.terrainProviderChanged.addEventListener((function(){u._updateClamping()})),this._removeModeListener=t.morphComplete.addEventListener((function(){u._updateClamping()}))),e.isConstant){const i=e.getValue(l.Z.MINIMUM_VALUE,p);if(!(0,s.Z)(i)||n.Z.equals(i,n.Z.ZERO)||!(0,s.Z)(t.globe))return;this._position=n.Z.clone(i,this._position),this._updateClamping(),this._normal=t.globe.ellipsoid.geodeticSurfaceNormal(i,this._normal)}}Object.defineProperties(m.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),m.prototype._updateClamping=function(){(0,s.Z)(this._removeCallbackFunc)&&this._removeCallbackFunc();const t=this._scene,e=t.globe,i=this._position;if(!(0,s.Z)(e)||n.Z.equals(i,n.Z.ZERO))return void(this._terrainHeight=0);const r=e.ellipsoid,o=e._surface,a=this,h=r.cartesianToCartographic(i,this._cartographicPosition),l=e.getHeight(h);(0,s.Z)(l)?this._terrainHeight=l:this._terrainHeight=0,this._removeCallbackFunc=o.updateHeight(h,(function(e){if(t.mode===d.Z.SCENE3D){const t=r.cartesianToCartographic(e,_);a._terrainHeight=t.height}else a._terrainHeight=e.x;a.definitionChanged.raiseEvent()}))},m.prototype.getValue=function(t,e){const i=f.Z.getValueOrDefault(this._heightReference,t,c.Z.NONE),r=f.Z.getValueOrDefault(this._extrudedHeightReference,t,c.Z.NONE);if(i===c.Z.NONE&&r!==c.Z.RELATIVE_TO_GROUND)return this._position=n.Z.clone(n.Z.ZERO,this._position),n.Z.clone(n.Z.ZERO,e);if(this._positionProperty.isConstant)return n.Z.multiplyByScalar(this._normal,this._terrainHeight,e);const o=this._scene,a=this._positionProperty.getValue(t,p);if(!(0,s.Z)(a)||n.Z.equals(a,n.Z.ZERO)||!(0,s.Z)(o.globe))return n.Z.clone(n.Z.ZERO,e);if(n.Z.equalsEpsilon(this._position,a,u.Z.EPSILON10))return n.Z.multiplyByScalar(this._normal,this._terrainHeight,e);this._position=n.Z.clone(a,this._position),this._updateClamping();const h=o.globe.ellipsoid.geodeticSurfaceNormal(a,this._normal);return n.Z.multiplyByScalar(h,this._terrainHeight,e)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return(0,s.Z)(this._removeEventListener)&&this._removeEventListener(),(0,s.Z)(this._removeModeListener)&&this._removeModeListener(),(0,s.Z)(this._removeCallbackFunc)&&this._removeCallbackFunc(),(0,a.Z)(this)};const g=m},78490:(t,e,i)=>{i.d(e,{Z:()=>d});var n=i(88779),r=i(54485),o=i(20176),s=i(92893),a=i(31163),h=i(99842),l=i(79285),u=i(19157);function c(t){this._definitionChanged=new s.Z,this._intervals=new h.Z,this._intervals.changedEvent.addEventListener(c.prototype._intervalsChanged,this),this._referenceFrame=(0,n.Z)(t,a.Z.FIXED)}Object.defineProperties(c.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}}),c.prototype.getValue=function(t,e){return this.getValueInReferenceFrame(t,a.Z.FIXED,e)},c.prototype.getValueInReferenceFrame=function(t,e,i){if(!(0,r.Z)(t))throw new o.Z("time is required.");if(!(0,r.Z)(e))throw new o.Z("referenceFrame is required.");const n=this._intervals.findDataForIntervalContainingDate(t);if((0,r.Z)(n))return l.Z.convertToReferenceFrame(t,n,this._referenceFrame,e,i)},c.prototype.equals=function(t){return this===t||t instanceof c&&this._intervals.equals(t._intervals,u.Z.equals)&&this._referenceFrame===t._referenceFrame},c.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};const d=c},79773:(t,e,i)=>{i.d(e,{Z:()=>l});var n=i(54485),r=i(20176),o=i(92893),s=i(99842),a=i(19157);function h(){this._definitionChanged=new o.Z,this._intervals=new s.Z,this._intervals.changedEvent.addEventListener(h.prototype._intervalsChanged,this)}Object.defineProperties(h.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),h.prototype.getValue=function(t,e){if(!(0,n.Z)(t))throw new r.Z("time is required");const i=this._intervals.findDataForIntervalContainingDate(t);return(0,n.Z)(i)&&"function"==typeof i.clone?i.clone(e):i},h.prototype.equals=function(t){return this===t||t instanceof h&&this._intervals.equals(t._intervals,a.Z.equals)},h.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};const l=h},345:(t,e,i)=>{i.d(e,{Z:()=>g});var n=i(93517),r=i(88779),o=i(54485),s=i(99996),a=i(92893),h=i(39109),l=i(20291),u=i(7004),c=i(19157),d=i(7911);function f(t,e){this._velocityVectorProperty=new d.Z(t,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new a.Z,this.ellipsoid=(0,r.Z)(e,s.Z.WGS84);const i=this;this._velocityVectorProperty.definitionChanged.addEventListener((function(){i._definitionChanged.raiseEvent(i)}))}Object.defineProperties(f.prototype,{isConstant:{get:function(){return c.Z.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(t){this._velocityVectorProperty.position=t}},ellipsoid:{get:function(){return this._ellipsoid},set:function(t){this._ellipsoid!==t&&(this._ellipsoid=t,this._definitionChanged.raiseEvent(this))}}});const p=new n.Z,_=new n.Z,m=new h.Z;f.prototype.getValue=function(t,e){const i=this._velocityVectorProperty._getValue(t,_,p);if((0,o.Z)(i))return u.Z.rotationMatrixFromPositionVelocity(p,i,this._ellipsoid,m),l.Z.fromRotationMatrix(m,e)},f.prototype.equals=function(t){return this===t||t instanceof f&&c.Z.equals(this._velocityVectorProperty,t._velocityVectorProperty)&&(this._ellipsoid===t._ellipsoid||this._ellipsoid.equals(t._ellipsoid))};const g=f},7911:(t,e,i)=>{i.d(e,{Z:()=>_});var n=i(93517),r=i(88779),o=i(54485),s=i(20176),a=i(92893),h=i(97262),l=i(19157);function u(t,e){this._position=void 0,this._subscription=void 0,this._definitionChanged=new a.Z,this._normalize=(0,r.Z)(e,!0),this.position=t}Object.defineProperties(u.prototype,{isConstant:{get:function(){return l.Z.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(t){const e=this._position;e!==t&&((0,o.Z)(e)&&this._subscription(),this._position=t,(0,o.Z)(t)&&(this._subscription=t._definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this)}),this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(t){this._normalize!==t&&(this._normalize=t,this._definitionChanged.raiseEvent(this))}}});const c=new n.Z,d=new n.Z,f=new h.Z,p=1/60;u.prototype.getValue=function(t,e){return this._getValue(t,e)},u.prototype._getValue=function(t,e,i){if(!(0,o.Z)(t))throw new s.Z("time is required");(0,o.Z)(e)||(e=new n.Z);const r=this._position;if(l.Z.isConstant(r))return this._normalize?void 0:n.Z.clone(n.Z.ZERO,e);let a=r.getValue(t,c),u=r.getValue(h.Z.addSeconds(t,p,f),d);if(!(0,o.Z)(a))return;if(!(0,o.Z)(u)&&(u=a,a=r.getValue(h.Z.addSeconds(t,-p,f),d),!(0,o.Z)(a)))return;if(n.Z.equals(a,u))return this._normalize?void 0:n.Z.clone(n.Z.ZERO,e);(0,o.Z)(i)&&a.clone(i);const _=n.Z.subtract(u,a,e);return this._normalize?n.Z.normalize(_,e):n.Z.divideByScalar(_,p,e)},u.prototype.equals=function(t){return this===t||t instanceof u&&l.Z.equals(this._position,t._position)};const _=u},52285:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(20176);function r(){n.Z.throwInstantiationError()}r.prototype.update=n.Z.throwInstantiationError,r.prototype.getBoundingSphere=n.Z.throwInstantiationError,r.prototype.isDestroyed=n.Z.throwInstantiationError,r.prototype.destroy=n.Z.throwInstantiationError;const o=r},23803:(t,e,i)=>{i.d(e,{Z:()=>E});var n=i(17497),r=i(6785),o=i(41631),s=i(54485),a=i(20176),h=i(64493),l=i(78224),u=i(18926),c=i(9008),d=i(62237),f=i(62775),p=i(41656),_=i(73020),m=i(3334),g=i(58034),Z=i(31969),y=i(19157);const v=new r.Z;function w(t){this.id=t,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function T(t,e){Z.Z.call(this,{entity:t,scene:e,geometryOptions:new w(t),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(t,"wall",t.wall,void 0)}function b(t,e,i){g.Z.call(this,t,e,i)}(0,s.Z)(Object.create)&&(T.prototype=Object.create(Z.Z.prototype),T.prototype.constructor=T),T.prototype.createFillGeometryInstance=function(t){if(n.Z.defined("time",t),!this._fillEnabled)throw new a.Z("This instance does not represent a filled geometry.");const e=this._entity,i=e.isAvailable(t);let u,f;const p=new c.Z(i&&e.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),_=this._distanceDisplayConditionProperty.getValue(t),g=h.Z.fromDistanceDisplayCondition(_);if(this._materialProperty instanceof m.Z){let e;(0,s.Z)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(e=this._materialProperty.color.getValue(t,v)),(0,s.Z)(e)||(e=r.Z.WHITE),f=o.Z.fromColor(e),u={show:p,distanceDisplayCondition:g,color:f}}else u={show:p,distanceDisplayCondition:g};return new l.Z({id:e,geometry:new d.Z(this._options),attributes:u})},T.prototype.createOutlineGeometryInstance=function(t){if(n.Z.defined("time",t),!this._outlineEnabled)throw new a.Z("This instance does not represent an outlined geometry.");const e=this._entity,i=e.isAvailable(t),s=y.Z.getValueOrDefault(this._outlineColorProperty,t,r.Z.BLACK,v),u=this._distanceDisplayConditionProperty.getValue(t);return new l.Z({id:e,geometry:new f.Z(this._options),attributes:{show:new c.Z(i&&e.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:o.Z.fromColor(s),distanceDisplayCondition:h.Z.fromDistanceDisplayCondition(u)}})},T.prototype._isHidden=function(t,e){return!(0,s.Z)(e.positions)||Z.Z.prototype._isHidden.call(this,t,e)},T.prototype._getIsClosed=function(t){return!1},T.prototype._isDynamic=function(t,e){return!(e.positions.isConstant&&y.Z.isConstant(e.minimumHeights)&&y.Z.isConstant(e.maximumHeights)&&y.Z.isConstant(e.outlineWidth)&&y.Z.isConstant(e.granularity))},T.prototype._setStaticOptions=function(t,e){const i=e.minimumHeights,n=e.maximumHeights,r=e.granularity,o=this._materialProperty instanceof m.Z,a=this._options;a.vertexFormat=o?_.Z.VERTEX_FORMAT:p.Z.MaterialSupport.TEXTURED.vertexFormat,a.positions=e.positions.getValue(u.Z.MINIMUM_VALUE,a.positions),a.minimumHeights=(0,s.Z)(i)?i.getValue(u.Z.MINIMUM_VALUE,a.minimumHeights):void 0,a.maximumHeights=(0,s.Z)(n)?n.getValue(u.Z.MINIMUM_VALUE,a.maximumHeights):void 0,a.granularity=(0,s.Z)(r)?r.getValue(u.Z.MINIMUM_VALUE):void 0},T.DynamicGeometryUpdater=b,(0,s.Z)(Object.create)&&(b.prototype=Object.create(g.Z.prototype),b.prototype.constructor=b),b.prototype._isHidden=function(t,e,i){return!(0,s.Z)(this._options.positions)||g.Z.prototype._isHidden.call(this,t,e,i)},b.prototype._setOptions=function(t,e,i){const n=this._options;n.positions=y.Z.getValueOrUndefined(e.positions,i,n.positions),n.minimumHeights=y.Z.getValueOrUndefined(e.minimumHeights,i,n.minimumHeights),n.maximumHeights=y.Z.getValueOrUndefined(e.maximumHeights,i,n.maximumHeights),n.granularity=y.Z.getValueOrUndefined(e.granularity,i)};const E=T},29711:(t,e,i)=>{i.d(e,{Z:()=>u});var n=i(88779),r=i(54485),o=i(20176),s=i(92893),a=i(78731),h=i(37105);function l(t){this._definitionChanged=new s.Z,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge((0,n.Z)(t,n.Z.EMPTY_OBJECT))}Object.defineProperties(l.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:(0,h.Z)("show"),positions:(0,h.Z)("positions"),minimumHeights:(0,h.Z)("minimumHeights"),maximumHeights:(0,h.Z)("maximumHeights"),granularity:(0,h.Z)("granularity"),fill:(0,h.Z)("fill"),material:(0,a.Z)("material"),outline:(0,h.Z)("outline"),outlineColor:(0,h.Z)("outlineColor"),outlineWidth:(0,h.Z)("outlineWidth"),shadows:(0,h.Z)("shadows"),distanceDisplayCondition:(0,h.Z)("distanceDisplayCondition")}),l.prototype.clone=function(t){return(0,r.Z)(t)?(t.show=this.show,t.positions=this.positions,t.minimumHeights=this.minimumHeights,t.maximumHeights=this.maximumHeights,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new l(this)},l.prototype.merge=function(t){if(!(0,r.Z)(t))throw new o.Z("source is required.");this.show=(0,n.Z)(this.show,t.show),this.positions=(0,n.Z)(this.positions,t.positions),this.minimumHeights=(0,n.Z)(this.minimumHeights,t.minimumHeights),this.maximumHeights=(0,n.Z)(this.maximumHeights,t.maximumHeights),this.granularity=(0,n.Z)(this.granularity,t.granularity),this.fill=(0,n.Z)(this.fill,t.fill),this.material=(0,n.Z)(this.material,t.material),this.outline=(0,n.Z)(this.outline,t.outline),this.outlineColor=(0,n.Z)(this.outlineColor,t.outlineColor),this.outlineWidth=(0,n.Z)(this.outlineWidth,t.outlineWidth),this.shadows=(0,n.Z)(this.shadows,t.shadows),this.distanceDisplayCondition=(0,n.Z)(this.distanceDisplayCondition,t.distanceDisplayCondition)};const u=l},78731:(t,e,i)=>{i.d(e,{Z:()=>u});var n=i(6785),r=i(20176),o=i(67197),s=i(3334),a=i(37105),h=i(30607);function l(t){if(t instanceof n.Z)return new s.Z(t);if("string"==typeof t||t instanceof o.Z||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){const e=new h.Z;return e.image=t,e}throw new r.Z(`Unable to infer material type: ${t}`)}const u=function(t,e){return(0,a.Z)(t,e,l)}},37105:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(88779),r=i(54485),o=i(9234);function s(t){return new o.Z(t)}const a=function(t,e,i){return function(t,e,i,n,o){return{configurable:n,get:function(){return this[e]},set:function(n){const s=this[e],a=this[i];(0,r.Z)(a)&&(a(),this[i]=void 0),!(void 0!==n)||(0,r.Z)(n)&&(0,r.Z)(n.getValue)||!(0,r.Z)(o)||(n=o(n)),s!==n&&(this[e]=n,this._definitionChanged.raiseEvent(this,t,n,s)),(0,r.Z)(n)&&(0,r.Z)(n.definitionChanged)&&(this[i]=n.definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this,t,n,n)}),this))}}}(t,`_${t.toString()}`,`_${t.toString()}Subscription`,(0,n.Z)(e,!1),(0,n.Z)(i,s))}},64896:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(37105);function r(t){return t}const o=function(t,e){return(0,n.Z)(t,e,r)}},80578:(t,e,i)=>{i.d(e,{Z:()=>at});var n=i(25914),r=i(59015),o=i(93517),s=i(66866),a=i(6785),h=i(93737),l=i(88779),u=i(58587),c=i(54485),d=i(20176),f=i(99996),p=i(18926),_=i(97262),m=i(22874),g=i(34152),Z=i(31163),y=i(67197),v=i(21514),w=i(78368),T=i(99842),b=i(16272),E=i(72293),x=i(49824),A=i(93191),C=i(53188),S=i(36655),D=i(99520),P=i(25163),O=i(21144),I=i(81186),F=i(20909);const R="http://www.google.com/kml/ext/2.2";function L(t){this._files={},this._promises=[],this._count=0,this._modelCallback=t}const M=/^data:image\/([^,;]+)/;function N(t,e){return function(i){t._files[e]=i}}function V(t){this._time=t}function B(){this._ids={},this._styles={},this._count=0}function U(){this._ids={}}function z(t){const e=(t=(0,l.Z)(t,l.Z.EMPTY_OBJECT)).entities,i=(0,l.Z)(t.kmz,!1);if(!(0,c.Z)(e))throw new d.Z("entities is required.");const r=z._createState(t),o=e.values.filter((function(t){return!(0,c.Z)(t.parent)})),s=r.kmlDoc,a=s.documentElement;a.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:gx",R);const h=s.createElement("Document");a.appendChild(h),W(r,h,o),r.styleCache.save(h);const u=r.externalFileHandler;return u.promise.then((function(){const t=(new XMLSerializer).serializeToString(r.kmlDoc);return i?function(t,e){const i=(0,n.Z)("ThirdParty/Workers/z-worker-pako.js");A.Z.configure({workerScripts:{deflate:[i,"./pako_deflate.min.js"],inflate:[i,"./pako_inflate.min.js"]}});const r=new A.Z.BlobWriter,o=new A.Z.ZipWriter(r);return o.add("doc.kml",new A.Z.TextReader(t)).then((function(){const t=Object.keys(e);return G(o,t,e,0)})).then((function(){return o.close()})).then((function(t){return{kmz:t}}))}(t,u.files):{kml:t,externalFiles:u.files}}))}function G(t,e,i,n){if(e.length===n)return;const r=e[n];return t.add(r,new A.Z.BlobReader(i[r])).then((function(){return G(t,e,i,n+1)}))}function W(t,e,i){const n=t.kmlDoc,r=t.styleCache,o=t.valueGetter,s=t.idManager,a=i.length;let h,l,u;for(let d=0;d<a;++d){const a=i[d];let f;h=[],l=[],u=[],Y(t,a,l,u),K(t,a.polyline,l,u),Q(t,a.rectangle,l,u,h),Q(t,a.polygon,l,u,h),et(t,a,a.model,l,u);const m=a.availability;(0,c.Z)(m)&&(f=n.createElement("TimeSpan"),_.Z.equals(m.start,p.Z.MINIMUM_VALUE)||f.appendChild(ot(n,"begin",_.Z.toIso8601(m.start))),_.Z.equals(m.stop,p.Z.MAXIMUM_VALUE)||f.appendChild(ot(n,"end",_.Z.toIso8601(m.stop))));for(let t=0;t<h.length;++t){const i=h[t];i.setAttribute("id",s.get(a.id)),i.appendChild(ot(n,"name",a.name)),i.appendChild(ot(n,"visibility",a.show)),i.appendChild(ot(n,"description",a.description)),(0,c.Z)(f)&&i.appendChild(f),e.appendChild(i)}const g=l.length;if(g>0){const t=n.createElement("Placemark");t.setAttribute("id",s.get(a.id));let i=a.name;const h=a.label;if((0,c.Z)(h)){const t=n.createElement("LabelStyle"),e=o.get(h.text);i=(0,c.Z)(e)&&e.length>0?e:i;const r=o.getColor(h.fillColor);(0,c.Z)(r)&&(t.appendChild(ot(n,"color",r)),t.appendChild(ot(n,"colorMode","normal")));const s=o.get(h.scale);(0,c.Z)(s)&&t.appendChild(ot(n,"scale",s)),u.push(t)}t.appendChild(ot(n,"name",i)),t.appendChild(ot(n,"visibility",a.show)),t.appendChild(ot(n,"description",a.description)),(0,c.Z)(f)&&t.appendChild(f),e.appendChild(t);const d=u.length;if(d>0){const e=n.createElement("Style");for(let t=0;t<d;++t)e.appendChild(u[t]);t.appendChild(ot(n,"styleUrl",r.get(e)))}if(1===l.length)t.appendChild(l[0]);else if(l.length>1){const e=n.createElement("MultiGeometry");for(let t=0;t<g;++t)e.appendChild(l[t]);t.appendChild(e)}}const Z=a._children;if(Z.length>0){const i=n.createElement("Folder");i.setAttribute("id",s.get(a.id)),i.appendChild(ot(n,"name",a.name)),i.appendChild(ot(n,"visibility",a.show)),i.appendChild(ot(n,"description",a.description)),e.appendChild(i),W(t,i,Z)}}}L.prototype.texture=function(t){const e=this;let i;if("string"==typeof t||t instanceof y.Z){if(!(t=y.Z.createIfNeeded(t)).isDataUri)return t.url;const n=t.url.match(M);i="texture_"+ ++this._count,(0,c.Z)(n)&&(i+=`.${n[1]}`);const r=t.fetchBlob().then((function(t){e._files[i]=t}));return this._promises.push(r),i}if(t instanceof HTMLCanvasElement){const n=(0,u.Z)();return this._promises.push(n.promise),i=`texture_${++this._count}.png`,t.toBlob((function(t){e._files[i]=t,n.resolve()})),i}return""},L.prototype.model=function(t,e){const i=this._modelCallback;if(!(0,c.Z)(i))throw new v.Z("Encountered a model entity while exporting to KML, but no model callback was supplied.");const n={},r=i(t,e,n);for(const t in n)if(n.hasOwnProperty(t)){const e=Promise.resolve(n[t]);this._promises.push(e),e.then(N(this,t))}return r},Object.defineProperties(L.prototype,{promise:{get:function(){return Promise.all(this._promises)}},files:{get:function(){return this._files}}}),V.prototype.get=function(t,e,i){let n;return(0,c.Z)(t)&&(n=(0,c.Z)(t.getValue)?t.getValue(this._time,i):t),(0,l.Z)(n,e)},V.prototype.getColor=function(t,e){const i=this.get(t,e);if((0,c.Z)(i))return st(i)},V.prototype.getMaterialType=function(t){if((0,c.Z)(t))return t.getType(this._time)},B.prototype.get=function(t){const e=this._ids,i=t.innerHTML;if((0,c.Z)(e[i]))return e[i];let n="style-"+ ++this._count;return t.setAttribute("id",n),n=`#${n}`,e[i]=n,this._styles[i]=t,n},B.prototype.save=function(t){const e=this._styles,i=t.childNodes[0];for(const n in e)e.hasOwnProperty(n)&&t.insertBefore(e[n],i)},U.prototype.get=function(t){if(!(0,c.Z)(t))return this.get((0,h.Z)());const e=this._ids;return(0,c.Z)(e[t])?`${t.toString()}-${++e[t]}`:(e[t]=0,t)},z._createState=function(t){const e=t.entities,i=new B,n=e.computeAvailability(),r=(0,c.Z)(t.time)?t.time:n.start;let o=(0,l.Z)(t.defaultAvailability,n);const s=(0,l.Z)(t.sampleDuration,60);o.start===p.Z.MINIMUM_VALUE?o.stop===p.Z.MAXIMUM_VALUE?o=new w.Z:_.Z.addSeconds(o.stop,-10*s,o.start):o.stop===p.Z.MAXIMUM_VALUE&&_.Z.addSeconds(o.start,10*s,o.stop);const a=new L(t.modelCallback);return{kmlDoc:document.implementation.createDocument("http://www.opengis.net/kml/2.2","kml"),ellipsoid:(0,l.Z)(t.ellipsoid,f.Z.WGS84),idManager:new U,styleCache:i,externalFileHandler:a,time:r,valueGetter:new V(r),sampleDuration:s,defaultAvailability:new T.Z([o])}};const k=new o.Z,H=new s.Z,j=new _.Z;function Y(t,e,i,n){const r=t.kmlDoc,o=t.ellipsoid,s=t.valueGetter,a=(0,l.Z)(e.billboard,e.point);if(!(0,c.Z)(a)&&!(0,c.Z)(e.path))return;const h=e.position;if(!h.isConstant)return void q(t,e,a,i,n);s.get(h,void 0,k);const u=ot(r,"coordinates",rt(k,o)),d=r.createElement("Point"),f=r.createElement("altitudeMode");f.appendChild(nt(t,a.heightReference)),d.appendChild(f),d.appendChild(u),i.push(d);const p=a instanceof C.Z?$(t,a):X(t,a);n.push(p)}function q(t,e,i,n,r){const s=t.kmlDoc,a=t.ellipsoid,h=t.valueGetter;let u;const d=e.position;let f=!0;d instanceof S.Z?(u=d.intervals,f=!1):u=(0,l.Z)(e.availability,t.defaultAvailability);const p=i instanceof D.Z;let m,g,y;const v=[];for(m=0;m<u.length;++m){const e=u.get(m);let n=f?d:e.data;const r=s.createElement("altitudeMode");n instanceof F.Z?(n=n._value,r.appendChild(nt(t,b.Z.CLAMP_TO_GROUND))):(0,c.Z)(i)?r.appendChild(nt(t,i.heightReference)):r.appendChild(nt(t,b.Z.NONE));const l=[],w=[];if(n.isConstant){h.get(n,void 0,k);const t=ot(s,"coordinates",rt(k,a));l.push(_.Z.toIso8601(e.start)),w.push(t),l.push(_.Z.toIso8601(e.stop)),w.push(t)}else if(n instanceof O.Z)for(y=n._property._times,g=0;g<y.length;++g)l.push(_.Z.toIso8601(y[g])),n.getValueInReferenceFrame(y[g],Z.Z.FIXED,k),w.push(rt(k,a));else if(n instanceof I.Z){y=n._times;const t=n._values;for(g=0;g<y.length;++g)l.push(_.Z.toIso8601(y[g])),o.Z.fromArray(t,3*g,k),w.push(rt(k,a))}else{const i=t.sampleDuration;e.start.clone(j),e.isStartIncluded||_.Z.addSeconds(j,i,j);const r=e.stop;for(;_.Z.lessThan(j,r);)n.getValue(j,k),l.push(_.Z.toIso8601(j)),w.push(rt(k,a)),_.Z.addSeconds(j,i,j);e.isStopIncluded&&_.Z.equals(j,r)&&(n.getValue(j,k),l.push(_.Z.toIso8601(j)),w.push(rt(k,a)))}const T=s.createElementNS(R,"Track");T.appendChild(r);for(let t=0;t<l.length;++t){const e=ot(s,"when",l[t]),i=ot(s,"coord",w[t],R);T.appendChild(e),T.appendChild(i)}p&&T.appendChild(tt(t,i)),v.push(T)}if(1===v.length)n.push(v[0]);else if(v.length>1){const t=s.createElementNS(R,"MultiTrack");for(m=0;m<v.length;++m)t.appendChild(v[m]);n.push(t)}if((0,c.Z)(i)&&!p){const e=i instanceof C.Z?$(t,i):X(t,i);r.push(e)}const w=e.path;if((0,c.Z)(w)){const e=h.get(w.width),i=w.material;if((0,c.Z)(i)||(0,c.Z)(e)){const n=s.createElement("LineStyle");(0,c.Z)(e)&&n.appendChild(ot(s,"width",e)),it(t,i,n),r.push(n)}}}function X(t,e){const i=t.kmlDoc,n=t.valueGetter,r=i.createElement("IconStyle"),o=n.getColor(e.color);(0,c.Z)(o)&&(r.appendChild(ot(i,"color",o)),r.appendChild(ot(i,"colorMode","normal")));const s=n.get(e.pixelSize);return(0,c.Z)(s)&&r.appendChild(ot(i,"scale",s/32)),r}function $(t,e){const i=t.kmlDoc,n=t.valueGetter,s=t.externalFileHandler,a=i.createElement("IconStyle");let h=n.get(e.image);if((0,c.Z)(h)){h=s.texture(h);const t=i.createElement("Icon");t.appendChild(ot(i,"href",h));const r=n.get(e.imageSubRegion);(0,c.Z)(r)&&(t.appendChild(ot(i,"x",r.x,R)),t.appendChild(ot(i,"y",r.y,R)),t.appendChild(ot(i,"w",r.width,R)),t.appendChild(ot(i,"h",r.height,R))),a.appendChild(t)}const u=n.getColor(e.color);(0,c.Z)(u)&&(a.appendChild(ot(i,"color",u)),a.appendChild(ot(i,"colorMode","normal")));let d=n.get(e.scale);(0,c.Z)(d)&&a.appendChild(ot(i,"scale",d));const f=n.get(e.pixelOffset);if((0,c.Z)(f)){d=(0,l.Z)(d,1),r.Z.divideByScalar(f,d,f);const t=n.get(e.width,32),o=n.get(e.height,32),s=n.get(e.horizontalOrigin,E.Z.CENTER);s===E.Z.CENTER?f.x-=.5*t:s===E.Z.RIGHT&&(f.x-=t);const h=n.get(e.verticalOrigin,x.Z.CENTER);h===x.Z.TOP?f.y+=o:h===x.Z.CENTER&&(f.y+=.5*o);const u=i.createElement("hotSpot");u.setAttribute("x",-f.x),u.setAttribute("y",f.y),u.setAttribute("xunits","pixels"),u.setAttribute("yunits","pixels"),a.appendChild(u)}let p=n.get(e.rotation);const _=n.get(e.alignedAxis);return(0,c.Z)(p)&&o.Z.equals(o.Z.UNIT_Z,_)&&(p=m.Z.toDegrees(-p),0===p&&(p=360),a.appendChild(ot(i,"heading",p))),a}function K(t,e,i,n){const r=t.kmlDoc,o=t.ellipsoid,s=t.valueGetter;if(!(0,c.Z)(e))return;const a=r.createElement("LineString"),h=r.createElement("altitudeMode"),l=s.get(e.clampToGround,!1);let u;l?(a.appendChild(ot(r,"tessellate",!0)),u=r.createTextNode("clampToGround")):u=r.createTextNode("absolute"),h.appendChild(u),a.appendChild(h);const d=e.positions,f=ot(r,"coordinates",rt(s.get(d),o));a.appendChild(f);const p=s.get(e.zIndex);l&&(0,c.Z)(p)&&a.appendChild(ot(r,"drawOrder",p,R)),i.push(a);const _=r.createElement("LineStyle"),m=s.get(e.width);(0,c.Z)(m)&&_.appendChild(ot(r,"width",m)),it(t,e.material,_),n.push(_)}function J(t,e,i,n){const r=t.kmlDoc,o=t.ellipsoid,a=[],h=e.length;for(let t=0;t<h;++t)s.Z.fromCartesian(e[t],o,H),a.push(`${m.Z.toDegrees(H.longitude)},${m.Z.toDegrees(H.latitude)},${n?H.height:i}`);const l=ot(r,"coordinates",a.join(" ")),u=r.createElement("LinearRing");return u.appendChild(l),u}function Q(t,e,i,n,r){const o=t.kmlDoc,s=t.valueGetter;if(!(0,c.Z)(e))return;const h=e instanceof P.Z;if(h&&"Image"===s.getMaterialType(e.material))return void function(t,e,i){const n=t.kmlDoc,r=t.valueGetter,o=t.externalFileHandler,s=n.createElement("GroundOverlay"),a=n.createElement("altitudeMode");a.appendChild(nt(t,e.heightReference)),s.appendChild(a);const h=r.get(e.height);(0,c.Z)(h)&&s.appendChild(ot(n,"altitude",h));const l=r.get(e.coordinates),u=n.createElement("LatLonBox");u.appendChild(ot(n,"north",m.Z.toDegrees(l.north))),u.appendChild(ot(n,"south",m.Z.toDegrees(l.south))),u.appendChild(ot(n,"east",m.Z.toDegrees(l.east))),u.appendChild(ot(n,"west",m.Z.toDegrees(l.west))),s.appendChild(u);const d=r.get(e.material),f=o.texture(d.image),p=n.createElement("Icon");p.appendChild(ot(n,"href",f)),s.appendChild(p);const _=d.color;(0,c.Z)(_)&&s.appendChild(ot(n,"color",st(d.color)));i.push(s)}(t,e,r);const l=o.createElement("Polygon"),u=s.get(e.extrudedHeight,0);u>0&&l.appendChild(ot(o,"extrude",!0));const d=h?function(t,e,i){const n=t.kmlDoc,r=t.valueGetter;let o=r.get(e.height,0);i>0&&(o=i);const s=e.coordinates,a=r.get(s),h=[],l=[g.Z.northeast,g.Z.southeast,g.Z.southwest,g.Z.northwest];for(let t=0;t<4;++t)l[t](a,H),h.push(`${m.Z.toDegrees(H.longitude)},${m.Z.toDegrees(H.latitude)},${o}`);const u=ot(n,"coordinates",h.join(" ")),c=n.createElement("outerBoundaryIs"),d=n.createElement("LinearRing");return d.appendChild(u),c.appendChild(d),[c]}(t,e,u):function(t,e,i){const n=t.kmlDoc,r=t.valueGetter;let o=r.get(e.height,0);const s=r.get(e.perPositionHeight,!1);!s&&i>0&&(o=i);const a=[],h=e.hierarchy,l=r.get(h),u=Array.isArray(l)?l:l.positions,d=n.createElement("outerBoundaryIs");d.appendChild(J(t,u,o,s)),a.push(d);const f=l.holes;if((0,c.Z)(f)){const e=f.length;for(let i=0;i<e;++i){const e=n.createElement("innerBoundaryIs");e.appendChild(J(t,f[i].positions,o,s)),a.push(e)}}return a}(t,e,u),f=d.length;for(let t=0;t<f;++t)l.appendChild(d[t]);const p=o.createElement("altitudeMode");p.appendChild(nt(t,e.heightReference)),l.appendChild(p),i.push(l);const _=o.createElement("PolyStyle"),Z=s.get(e.fill,!1);Z&&_.appendChild(ot(o,"fill",Z)),it(t,e.material,_);const y=s.get(e.outline,!1);if(y){_.appendChild(ot(o,"outline",y));const t=o.createElement("LineStyle"),i=s.get(e.outlineWidth,1);t.appendChild(ot(o,"width",i));const r=s.getColor(e.outlineColor,a.Z.BLACK);t.appendChild(ot(o,"color",r)),t.appendChild(ot(o,"colorMode","normal")),n.push(t)}n.push(_)}function tt(t,e){const i=t.kmlDoc,n=t.valueGetter,r=t.externalFileHandler,o=i.createElement("Model"),s=n.get(e.scale);if((0,c.Z)(s)){const t=i.createElement("scale");t.appendChild(ot(i,"x",s)),t.appendChild(ot(i,"y",s)),t.appendChild(ot(i,"z",s)),o.appendChild(t)}const a=i.createElement("Link"),h=r.model(e,t.time);return a.appendChild(ot(i,"href",h)),o.appendChild(a),o}function et(t,e,i,n,r){const o=t.kmlDoc,a=t.ellipsoid,h=t.valueGetter;if(!(0,c.Z)(i))return;const l=e.position;if(!l.isConstant)return void q(t,e,i,n,r);const u=tt(t,i),d=o.createElement("altitudeMode");d.appendChild(nt(t,i.heightReference)),u.appendChild(d),h.get(l,void 0,k),s.Z.fromCartesian(k,a,H);const f=o.createElement("Location");f.appendChild(ot(o,"longitude",m.Z.toDegrees(H.longitude))),f.appendChild(ot(o,"latitude",m.Z.toDegrees(H.latitude))),f.appendChild(ot(o,"altitude",H.height)),u.appendChild(f),n.push(u)}function it(t,e,i){const n=t.kmlDoc,r=t.valueGetter;if(!(0,c.Z)(e))return;const o=r.get(e);if(!(0,c.Z)(o))return;let s;let h,l;switch(r.getMaterialType(e)){case"Image":s=st(a.Z.WHITE);break;case"Color":case"Grid":case"PolylineGlow":case"PolylineArrow":case"PolylineDash":s=st(o.color);break;case"PolylineOutline":s=st(o.color),h=st(o.outlineColor),l=o.outlineWidth,i.appendChild(ot(n,"outerColor",h,R)),i.appendChild(ot(n,"outerWidth",l,R));break;case"Stripe":s=st(o.oddColor)}(0,c.Z)(s)&&(i.appendChild(ot(n,"color",s)),i.appendChild(ot(n,"colorMode","normal")))}function nt(t,e){const i=t.kmlDoc;let n;switch(t.valueGetter.get(e,b.Z.NONE)){case b.Z.NONE:n=i.createTextNode("absolute");break;case b.Z.CLAMP_TO_GROUND:n=i.createTextNode("clampToGround");break;case b.Z.RELATIVE_TO_GROUND:n=i.createTextNode("relativeToGround")}return n}function rt(t,e){Array.isArray(t)||(t=[t]);const i=t.length,n=[];for(let r=0;r<i;++r)s.Z.fromCartesian(t[r],e,H),n.push(`${m.Z.toDegrees(H.longitude)},${m.Z.toDegrees(H.latitude)},${H.height}`);return n.join(" ")}function ot(t,e,i,n){"boolean"==typeof(i=(0,l.Z)(i,""))&&(i=i?"1":"0");const r=(0,c.Z)(n)?t.createElementNS(n,e):t.createElement(e),o="string"===i&&-1!==i.indexOf("<")?t.createCDATASection(i):t.createTextNode(i);return r.appendChild(o),r}function st(t){let e="";const i=t.toBytes();for(let t=3;t>=0;--t)e+=i[t]<16?`0${i[t].toString(16)}`:i[t].toString(16);return e}const at=z},88163:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(54485),r=i(9088),o=i(31969),s=i(23824);const a=function(t,e,i,a){if(o.Z.prototype._onEntityPropertyChanged.call(this,t,e,i,a),-1===this._observedPropertyNames.indexOf(e))return;const h=this._entity[this._geometryPropertyName];if(!(0,n.Z)(h))return;(0,n.Z)(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);const l=h.heightReference;if((0,n.Z)(l)){const t=new r.Z(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new s.Z(this._scene,t,l)}}},6421:(t,e,i)=>{i.d(e,{Z:()=>l});var n=i(93517),r=i(71118),o=i(95411);const s=new n.Z;function a(t){this._size=t.size,this._datatype=t.datatype,this.getValue=t.getValue}const h={};h[o.Z.FLOAT]="float",h[o.Z.FLOAT_VEC2]="vec2",h[o.Z.FLOAT_VEC3]="vec3",h[o.Z.FLOAT_VEC4]="vec4",h[o.Z.INT]="int",h[o.Z.INT_VEC2]="ivec2",h[o.Z.INT_VEC3]="ivec3",h[o.Z.INT_VEC4]="ivec4",h[o.Z.BOOL]="bool",h[o.Z.BOOL_VEC2]="bvec2",h[o.Z.BOOL_VEC3]="bvec3",h[o.Z.BOOL_VEC4]="bvec4",h[o.Z.FLOAT_MAT2]="mat2",h[o.Z.FLOAT_MAT3]="mat3",h[o.Z.FLOAT_MAT4]="mat4",h[o.Z.SAMPLER_2D]="sampler2D",h[o.Z.SAMPLER_CUBE]="samplerCube",a.prototype.getDeclaration=function(t){let e=`uniform ${h[this._datatype]} ${t}`;const i=this._size;return e+=1===i?";":`[${i.toString()}];`,e};const l={czm_viewport:new a({size:1,datatype:o.Z.FLOAT_VEC4,getValue:function(t){return t.viewportCartesian4}}),czm_viewportOrthographic:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.viewportOrthographic}}),czm_viewportTransformation:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.viewportTransformation}}),czm_globeDepthTexture:new a({size:1,datatype:o.Z.SAMPLER_2D,getValue:function(t){return t.globeDepthTexture}}),czm_model:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.model}}),czm_inverseModel:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseModel}}),czm_view:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.view}}),czm_view3D:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.view3D}}),czm_viewRotation:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.viewRotation}}),czm_viewRotation3D:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.viewRotation3D}}),czm_inverseView:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseView}}),czm_inverseView3D:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseView3D}}),czm_inverseViewRotation:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.inverseViewRotation}}),czm_inverseViewRotation3D:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.inverseViewRotation3D}}),czm_projection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.projection}}),czm_inverseProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseProjection}}),czm_infiniteProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.infiniteProjection}}),czm_modelView:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.modelView}}),czm_modelView3D:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.modelView3D}}),czm_modelViewRelativeToEye:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.modelViewRelativeToEye}}),czm_inverseModelView:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseModelView}}),czm_inverseModelView3D:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseModelView3D}}),czm_viewProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.viewProjection}}),czm_inverseViewProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseViewProjection}}),czm_modelViewProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.modelViewProjection}}),czm_inverseModelViewProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new a({size:1,datatype:o.Z.FLOAT_MAT4,getValue:function(t){return t.modelViewInfiniteProjection}}),czm_orthographicIn3D:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.orthographicIn3D?1:0}}),czm_normal:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.normal}}),czm_normal3D:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.normal3D}}),czm_inverseNormal:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.inverseNormal}}),czm_inverseNormal3D:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.inverseNormal3D}}),czm_eyeHeight:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.eyeHeight}}),czm_eyeHeight2D:new a({size:1,datatype:o.Z.FLOAT_VEC2,getValue:function(t){return t.eyeHeight2D}}),czm_entireFrustum:new a({size:1,datatype:o.Z.FLOAT_VEC2,getValue:function(t){return t.entireFrustum}}),czm_currentFrustum:new a({size:1,datatype:o.Z.FLOAT_VEC2,getValue:function(t){return t.currentFrustum}}),czm_frustumPlanes:new a({size:1,datatype:o.Z.FLOAT_VEC4,getValue:function(t){return t.frustumPlanes}}),czm_farDepthFromNearPlusOne:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.sunPositionWC}}),czm_sunPositionColumbusView:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.sunPositionColumbusView}}),czm_sunDirectionEC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.sunDirectionEC}}),czm_sunDirectionWC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.sunDirectionWC}}),czm_moonDirectionEC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.moonDirectionEC}}),czm_lightDirectionEC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.lightDirectionEC}}),czm_lightDirectionWC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.lightDirectionWC}}),czm_lightColor:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.lightColor}}),czm_lightColorHdr:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return r.Z.getTranslation(t.inverseView,s)}}),czm_frameNumber:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.frameState.frameNumber}}),czm_morphTime:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.frameState.morphTime}}),czm_sceneMode:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.frameState.mode}}),czm_pass:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.pass}}),czm_backgroundColor:new a({size:1,datatype:o.Z.FLOAT_VEC4,getValue:function(t){return t.backgroundColor}}),czm_brdfLut:new a({size:1,datatype:o.Z.SAMPLER_2D,getValue:function(t){return t.brdfLut}}),czm_environmentMap:new a({size:1,datatype:o.Z.SAMPLER_CUBE,getValue:function(t){return t.environmentMap}}),czm_specularEnvironmentMaps:new a({size:1,datatype:o.Z.SAMPLER_2D,getValue:function(t){return t.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new a({size:1,datatype:o.Z.FLOAT_VEC2,getValue:function(t){return t.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new a({size:9,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new a({size:1,datatype:o.Z.FLOAT_MAT3,getValue:function(t){return t.temeToPseudoFixedMatrix}}),czm_pixelRatio:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.pixelRatio}}),czm_fogDensity:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.fogDensity}}),czm_splitPosition:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.splitPosition}}),czm_geometricToleranceOverMeter:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new a({size:1,datatype:o.Z.FLOAT_VEC4,getValue:function(t){return t.invertClassificationColor}}),czm_gamma:new a({size:1,datatype:o.Z.FLOAT,getValue:function(t){return t.gamma}}),czm_ellipsoidRadii:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new a({size:1,datatype:o.Z.FLOAT_VEC3,getValue:function(t){return t.ellipsoid.oneOverRadii}})}},31328:(t,e,i)=>{i.d(e,{Z:()=>d});var n=i(17497),r=i(88779),o=i(54485),s=i(90332),a=i(20176),h=i(39172),l=i(95411),u=i(36627);function c(t){if(t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context),!(0,o.Z)(t.typedArray)&&!(0,o.Z)(t.sizeInBytes))throw new a.Z("Either options.sizeInBytes or options.typedArray is required.");if((0,o.Z)(t.typedArray)&&(0,o.Z)(t.sizeInBytes))throw new a.Z("Cannot pass in both options.sizeInBytes and options.typedArray.");if((0,o.Z)(t.typedArray)&&(n.Z.typeOf.object("options.typedArray",t.typedArray),n.Z.typeOf.number("options.typedArray.byteLength",t.typedArray.byteLength)),!u.Z.validate(t.usage))throw new a.Z("usage is invalid.");const e=t.context._gl,i=t.bufferTarget,s=t.typedArray;let h=t.sizeInBytes;const l=t.usage,c=(0,o.Z)(s);c&&(h=s.byteLength),n.Z.typeOf.number.greaterThan("sizeInBytes",h,0);const d=e.createBuffer();e.bindBuffer(i,d),e.bufferData(i,c?s:h,l),e.bindBuffer(i,null),this._gl=e,this._webgl2=t.context._webgl2,this._bufferTarget=i,this._sizeInBytes=h,this._usage=l,this._buffer=d,this.vertexArrayDestroyable=!0}c.createVertexBuffer=function(t){return n.Z.defined("options.context",t.context),new c({context:t.context,bufferTarget:l.Z.ARRAY_BUFFER,typedArray:t.typedArray,sizeInBytes:t.sizeInBytes,usage:t.usage})},c.createIndexBuffer=function(t){if(n.Z.defined("options.context",t.context),!h.Z.validate(t.indexDatatype))throw new a.Z("Invalid indexDatatype.");if(t.indexDatatype===h.Z.UNSIGNED_INT&&!t.context.elementIndexUint)throw new a.Z("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");const e=t.context,i=t.indexDatatype,r=h.Z.getSizeInBytes(i),o=new c({context:e,bufferTarget:l.Z.ELEMENT_ARRAY_BUFFER,typedArray:t.typedArray,sizeInBytes:t.sizeInBytes,usage:t.usage}),s=o.sizeInBytes/r;return Object.defineProperties(o,{indexDatatype:{get:function(){return i}},bytesPerIndex:{get:function(){return r}},numberOfIndices:{get:function(){return s}}}),o},Object.defineProperties(c.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),c.prototype._getBuffer=function(){return this._buffer},c.prototype.copyFromArrayView=function(t,e){e=(0,r.Z)(e,0),n.Z.defined("arrayView",t),n.Z.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",e+t.byteLength,this._sizeInBytes);const i=this._gl,o=this._bufferTarget;i.bindBuffer(o,this._buffer),i.bufferSubData(o,e,t),i.bindBuffer(o,null)},c.prototype.copyFromBuffer=function(t,e,i,n){if(!this._webgl2)throw new a.Z("A WebGL 2 context is required.");if(!(0,o.Z)(t))throw new a.Z("readBuffer must be defined.");if(!(0,o.Z)(n)||n<=0)throw new a.Z("sizeInBytes must be defined and be greater than zero.");if(!(0,o.Z)(e)||e<0||e+n>t._sizeInBytes)throw new a.Z("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!(0,o.Z)(i)||i<0||i+n>this._sizeInBytes)throw new a.Z("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===t._buffer&&(i>=e&&i<e+n||e>i&&e<i+n))throw new a.Z("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===l.Z.ELEMENT_ARRAY_BUFFER&&t._bufferTarget!==l.Z.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==l.Z.ELEMENT_ARRAY_BUFFER&&t._bufferTarget===l.Z.ELEMENT_ARRAY_BUFFER)throw new a.Z("Can not copy an index buffer into another buffer type.");const r=l.Z.COPY_READ_BUFFER,s=l.Z.COPY_WRITE_BUFFER,h=this._gl;h.bindBuffer(s,this._buffer),h.bindBuffer(r,t._buffer),h.copyBufferSubData(r,s,e,i,n),h.bindBuffer(s,null),h.bindBuffer(r,null)},c.prototype.getBufferData=function(t,e,i,n){if(e=(0,r.Z)(e,0),i=(0,r.Z)(i,0),!this._webgl2)throw new a.Z("A WebGL 2 context is required.");if(!(0,o.Z)(t))throw new a.Z("arrayView is required.");let s,h,u=t.byteLength;if((0,o.Z)(n)?(s=n,(0,o.Z)(u)?h=1:(u=t.length,h=t.BYTES_PER_ELEMENT)):(0,o.Z)(u)?(s=u-i,h=1):(u=t.length,s=u-i,h=t.BYTES_PER_ELEMENT),i<0||i>u)throw new a.Z("destinationOffset must be greater than zero and less than the arrayView length.");if(i+s>u)throw new a.Z("destinationOffset + length must be less than or equal to the arrayViewLength.");if(e<0||e>this._sizeInBytes)throw new a.Z("sourceOffset must be greater than zero and less than the buffers size.");if(e+s*h>this._sizeInBytes)throw new a.Z("sourceOffset + length must be less than the buffers size.");const c=this._gl,d=l.Z.COPY_READ_BUFFER;c.bindBuffer(d,this._buffer),c.getBufferSubData(d,e,t,i,n),c.bindBuffer(d,null)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),(0,s.Z)(this)};const d=c},36627:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={STREAM_DRAW:n.Z.STREAM_DRAW,STATIC_DRAW:n.Z.STATIC_DRAW,DYNAMIC_DRAW:n.Z.DYNAMIC_DRAW,validate:function(t){return t===r.STREAM_DRAW||t===r.STATIC_DRAW||t===r.DYNAMIC_DRAW}},o=Object.freeze(r)},74366:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(6785),r=i(88779);function o(t){t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),this.color=t.color,this.depth=t.depth,this.stencil=t.stencil,this.renderState=t.renderState,this.framebuffer=t.framebuffer,this.owner=t.owner,this.pass=t.pass}o.ALL=Object.freeze(new o({color:new n.Z(0,0,0,0),depth:1,stencil:0})),o.prototype.execute=function(t,e){t.clear(this,e)};const s=o},2099:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(88779),r=i(1577);function o(t){t=(0,n.Z)(t,n.Z.EMPTY_OBJECT),this.vertexArray=t.vertexArray,this.fragmentShaderSource=t.fragmentShaderSource,this.shaderProgram=t.shaderProgram,this.uniformMap=t.uniformMap,this.outputTexture=t.outputTexture,this.preExecute=t.preExecute,this.postExecute=t.postExecute,this.canceled=t.canceled,this.persists=(0,n.Z)(t.persists,!1),this.pass=r.Z.COMPUTE,this.owner=t.owner}o.prototype.execute=function(t){t.execute(this)};const s=o},93029:(t,e,i)=>{i.d(e,{Z:()=>v});var n=i(23114),r=i(17497),o=i(6785),s=i(54485),a=i(90332),h=i(20176),l=i(84473),u=i(42713),c=i(74366),d=i(71087),f=i(36274),p=i(74064),_=i(17426);function m(t){this._context=t}let g;const Z=new d.Z({primitiveType:l.Z.TRIANGLES}),y=new c.Z({color:new o.Z(0,0,0,0)});m.prototype.execute=function(t){if(r.Z.defined("computeCommand",t),(0,s.Z)(t.preExecute)&&t.preExecute(t),!(0,s.Z)(t.fragmentShaderSource)&&!(0,s.Z)(t.shaderProgram))throw new h.Z("computeCommand.fragmentShaderSource or computeCommand.shaderProgram is required.");r.Z.defined("computeCommand.outputTexture",t.outputTexture);const e=t.outputTexture,i=e.width,o=e.height,a=this._context,l=(0,s.Z)(t.vertexArray)?t.vertexArray:a.getViewportQuadVertexArray(),c=(0,s.Z)(t.shaderProgram)?t.shaderProgram:function(t,e){return _.Z.fromCache({context:t,vertexShaderSource:u.Z,fragmentShaderSource:e,attributeLocations:{position:0,textureCoordinates:1}})}(a,t.fragmentShaderSource),d=function(t,e){return new f.Z({context:t,colorTextures:[e],destroyAttachments:!1})}(a,e),m=function(t,e){return(0,s.Z)(g)&&g.viewport.width===t&&g.viewport.height===e||(g=p.Z.fromCache({viewport:new n.Z(0,0,t,e)})),g}(i,o),v=t.uniformMap,w=y;w.framebuffer=d,w.renderState=m,w.execute(a);const T=Z;T.vertexArray=l,T.renderState=m,T.shaderProgram=c,T.uniformMap=v,T.framebuffer=d,T.execute(a),d.destroy(),t.persists||(c.destroy(),(0,s.Z)(t.vertexArray)&&l.destroy()),(0,s.Z)(t.postExecute)&&t.postExecute(e)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return(0,a.Z)(this)};const v=m},6365:(t,e,i)=>{i.d(e,{Z:()=>j});var n=i(17497),r=i(55077),o=i(6785),s=i(44990),a=i(93737),h=i(88779),l=i(54485),u=i(90332),c=i(20176),d=i(97845),f=i(94061),p=i(22260),_=i(71118),m=i(91166),g=i(84473),Z=i(21514),y=i(95411),v=i(42713),w=i(36627),T=i(74366),b=i(85834),E=i(83159),x=i(71087),A=i(59434),C=i(27400),S=i(74064),D=i(48865),P=i(17426),O=i(47334),I=i(86397),F=i(50801),R=i(46801);function L(t,e,i){const n=t.getError();if(n!==t.NO_ERROR)throw new Z.Z(function(t,e,i,n){let r=`${function(t,e){let i="WebGL Error:  ";switch(e){case t.INVALID_ENUM:i+="INVALID_ENUM";break;case t.INVALID_VALUE:i+="INVALID_VALUE";break;case t.INVALID_OPERATION:i+="INVALID_OPERATION";break;case t.OUT_OF_MEMORY:i+="OUT_OF_MEMORY";break;case t.CONTEXT_LOST_WEBGL:i+="CONTEXT_LOST_WEBGL lost";break;default:i+=`Unknown (${e})`}return i}(t,n)}: ${e.name}(`;for(let t=0;t<i.length;++t)0!==t&&(r+=", "),r+=i[t];return r+=");",r}(t,e,i,n))}function M(t,e,i){return{get:function(){const n=t[e];return i(t,`get: ${e}`,n),t[e]},set:function(n){t[e]=n,i(t,`set: ${e}`,n)}}}function N(t,e){const i=e.length;for(let n=0;n<i;++n){const i=t.getExtension(e[n]);if(i)return i}}function V(t,e){if("undefined"==typeof WebGLRenderingContext)throw new Z.Z("The browser does not support WebGL.  Visit http://get.webgl.org.");n.Z.defined("canvas",t),this._canvas=t,e=(0,r.Z)(e,!0),(e=(0,h.Z)(e,{})).allowTextureFilterAnisotropic=(0,h.Z)(e.allowTextureFilterAnisotropic,!0);const i=(0,h.Z)(e.webgl,{});i.alpha=(0,h.Z)(i.alpha,!1),i.stencil=(0,h.Z)(i.stencil,!0);const s=(0,h.Z)(e.requestWebgl2,!1)&&"undefined"!=typeof WebGL2RenderingContext;let u,c=!1;const d=e.getWebGLStub;if((0,l.Z)(d))u=d(t,i);else if(s&&(u=t.getContext("webgl2",i)||t.getContext("experimental-webgl2",i)||void 0,(0,l.Z)(u)&&(c=!0)),(0,l.Z)(u)||(u=t.getContext("webgl",i)||t.getContext("experimental-webgl",i)||void 0),!(0,l.Z)(u))throw new Z.Z("The browser supports WebGL, but initialization failed.");this._originalGLContext=u,this._gl=u,this._webgl2=c,this._id=(0,a.Z)(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new D.Z(this),this._textureCache=new I.Z;const f=u;this._stencilBits=f.getParameter(f.STENCIL_BITS),b.Z._maximumCombinedTextureImageUnits=f.getParameter(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS),b.Z._maximumCubeMapSize=f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE),b.Z._maximumFragmentUniformVectors=f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS),b.Z._maximumTextureImageUnits=f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS),b.Z._maximumRenderbufferSize=f.getParameter(f.MAX_RENDERBUFFER_SIZE),b.Z._maximumTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE),b.Z._maximumVaryingVectors=f.getParameter(f.MAX_VARYING_VECTORS),b.Z._maximumVertexAttributes=f.getParameter(f.MAX_VERTEX_ATTRIBS),b.Z._maximumVertexTextureImageUnits=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b.Z._maximumVertexUniformVectors=f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS),b.Z._maximumSamples=this._webgl2?f.getParameter(f.MAX_SAMPLES):0;const _=f.getParameter(f.ALIASED_LINE_WIDTH_RANGE);b.Z._minimumAliasedLineWidth=_[0],b.Z._maximumAliasedLineWidth=_[1];const m=f.getParameter(f.ALIASED_POINT_SIZE_RANGE);b.Z._minimumAliasedPointSize=m[0],b.Z._maximumAliasedPointSize=m[1];const g=f.getParameter(f.MAX_VIEWPORT_DIMS);b.Z._maximumViewportWidth=g[0],b.Z._maximumViewportHeight=g[1];const v=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT);b.Z._highpFloatSupported=0!==v.precision;const w=f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT);b.Z._highpIntSupported=0!==w.rangeMax,this._antialias=f.getContextAttributes().antialias,this._standardDerivatives=!!N(f,["OES_standard_derivatives"]),this._blendMinmax=!!N(f,["EXT_blend_minmax"]),this._elementIndexUint=!!N(f,["OES_element_index_uint"]),this._depthTexture=!!N(f,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!N(f,["EXT_frag_depth"]),this._debugShaders=N(f,["WEBGL_debug_shaders"]),this._textureFloat=!!N(f,["OES_texture_float"]),this._textureHalfFloat=!!N(f,["OES_texture_half_float"]),this._textureFloatLinear=!!N(f,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!N(f,["OES_texture_half_float_linear"]),this._colorBufferFloat=!!N(f,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._floatBlend=!!N(f,["EXT_float_blend"]),this._colorBufferHalfFloat=!!N(f,["EXT_color_buffer_half_float"]),this._s3tc=!!N(f,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!N(f,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._astc=!!N(f,["WEBGL_compressed_texture_astc"]),this._etc=!!N(f,["WEBG_compressed_texture_etc"]),this._etc1=!!N(f,["WEBGL_compressed_texture_etc1"]),this._bc7=!!N(f,["EXT_texture_compression_bptc"]),p.Z.setKTX2SupportedFormats(this._s3tc,this._pvrtc,this._astc,this._etc,this._etc1,this._bc7);const T=e.allowTextureFilterAnisotropic?N(f,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;let E,x,C,P,O,R,L,M,V,B;if(this._textureFilterAnisotropic=T,b.Z._maximumTextureFilterAnisotropy=(0,l.Z)(T)?f.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,c){const t=this;E=function(){return t._gl.createVertexArray()},x=function(e){t._gl.bindVertexArray(e)},C=function(e){t._gl.deleteVertexArray(e)},P=function(t,e,i,n,r){f.drawElementsInstanced(t,e,i,n,r)},O=function(t,e,i,n){f.drawArraysInstanced(t,e,i,n)},R=function(t,e){f.vertexAttribDivisor(t,e)},L=function(t){f.drawBuffers(t)}}else M=N(f,["OES_vertex_array_object"]),(0,l.Z)(M)&&(E=function(){return M.createVertexArrayOES()},x=function(t){M.bindVertexArrayOES(t)},C=function(t){M.deleteVertexArrayOES(t)}),V=N(f,["ANGLE_instanced_arrays"]),(0,l.Z)(V)&&(P=function(t,e,i,n,r){V.drawElementsInstancedANGLE(t,e,i,n,r)},O=function(t,e,i,n){V.drawArraysInstancedANGLE(t,e,i,n)},R=function(t,e){V.vertexAttribDivisorANGLE(t,e)}),B=N(f,["WEBGL_draw_buffers"]),(0,l.Z)(B)&&(L=function(t){B.drawBuffersWEBGL(t)});this.glCreateVertexArray=E,this.glBindVertexArray=x,this.glDeleteVertexArray=C,this.glDrawElementsInstanced=P,this.glDrawArraysInstanced=O,this.glVertexAttribDivisor=R,this.glDrawBuffers=L,this._vertexArrayObject=!!M,this._instancedArrays=!!V,this._drawBuffers=!!B,b.Z._maximumDrawBuffers=this.drawBuffers?f.getParameter(y.Z.MAX_DRAW_BUFFERS):1,b.Z._maximumColorAttachments=this.drawBuffers?f.getParameter(y.Z.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new o.Z(0,0,0,0),this._clearDepth=1,this._clearStencil=0;const U=new F.Z,z=new A.Z(this),G=S.Z.fromCache();this._defaultPassState=z,this._defaultRenderState=G,this._defaultTexture=void 0,this._defaultEmissiveTexture=void 0,this._defaultNormalTexture=void 0,this._defaultCubeMap=void 0,this._us=U,this._currentRenderState=G,this._currentPassState=z,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(let t=0;t<b.Z._maximumVertexAttributes;t++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=e,this.cache={},S.Z.apply(f,G,z)}const B={};function U(t,e,i,n){const r=t._currentRenderState,o=t._currentPassState;t._currentRenderState=e,t._currentPassState=i,S.Z.partialApply(t._gl,r,e,o,i,n)}let z;function G(t,e){if(e!==t._currentFramebuffer){t._currentFramebuffer=e;let i=z;if((0,l.Z)(e))e._bind(),function(t){if(t.validateFramebuffer){const e=t._gl,i=e.checkFramebufferStatus(e.FRAMEBUFFER);if(i!==e.FRAMEBUFFER_COMPLETE){let t;switch(i){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:t="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:t="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:t="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case e.FRAMEBUFFER_UNSUPPORTED:t="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions."}throw new c.Z(t)}}}(t),i=e._getActiveColorAttachments();else{const e=t._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)}t.drawBuffers&&t.glDrawBuffers(i)}}Object.defineProperties(V.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},msaa:{get:function(){return this._webgl2}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},floatBlend:{get:function(){return this._floatBlend}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},astc:{get:function(){return this._astc}},etc:{get:function(){return this._etc}},etc1:{get:function(){return this._etc1}},bc7:{get:function(){return this._bc7}},supportsBasis:{get:function(){return this._s3tc||this._pvrtc||this._astc||this._etc||this._etc1||this._bc7}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(t){this._throwOnWebGLError=t,this._gl=function(t,e){if(!(0,l.Z)(e))return t;function i(i){return function(){const n=i.apply(t,arguments);return e(t,i,arguments),n}}const n={};for(const r in t){const o=t[r];o instanceof Function?n[r]=i(o):Object.defineProperty(n,r,M(t,r,e))}return n}(this._originalGLContext,t?L:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new O.Z({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultEmissiveTexture:{get:function(){return void 0===this._defaultEmissiveTexture&&(this._defaultEmissiveTexture=new O.Z({context:this,pixelFormat:m.Z.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([0,0,0])},flipY:!1})),this._defaultEmissiveTexture}},defaultNormalTexture:{get:function(){return void 0===this._defaultNormalTexture&&(this._defaultNormalTexture=new O.Z({context:this,pixelFormat:m.Z.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([128,128,255])},flipY:!1})),this._defaultNormalTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){const t={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new E.Z({context:this,source:{positiveX:t,negativeX:t,positiveY:t,negativeY:t,positiveZ:t,negativeZ:t},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return B}}}),"undefined"!=typeof WebGLRenderingContext&&(z=[y.Z.BACK]);const W=new T.Z;V.prototype.clear=function(t,e){t=(0,h.Z)(t,W),e=(0,h.Z)(e,this._defaultPassState);const i=this._gl;let n=0;const r=t.color,s=t.depth,a=t.stencil;(0,l.Z)(r)&&(o.Z.equals(this._clearColor,r)||(o.Z.clone(r,this._clearColor),i.clearColor(r.red,r.green,r.blue,r.alpha)),n|=i.COLOR_BUFFER_BIT),(0,l.Z)(s)&&(s!==this._clearDepth&&(this._clearDepth=s,i.clearDepth(s)),n|=i.DEPTH_BUFFER_BIT),(0,l.Z)(a)&&(a!==this._clearStencil&&(this._clearStencil=a,i.clearStencil(a)),n|=i.STENCIL_BUFFER_BIT);U(this,(0,h.Z)(t.renderState,this._defaultRenderState),e,!0);G(this,(0,h.Z)(t.framebuffer,e.framebuffer)),i.clear(n)},V.prototype.draw=function(t,e,i,r){n.Z.defined("drawCommand",t),n.Z.defined("drawCommand.shaderProgram",t._shaderProgram),e=(0,h.Z)(e,this._defaultPassState);const o=(0,h.Z)(t._framebuffer,e.framebuffer),s=(0,h.Z)(t._renderState,this._defaultRenderState);i=(0,h.Z)(i,t._shaderProgram),r=(0,h.Z)(r,t._uniformMap),function(t,e,i,n,r){if((0,l.Z)(e)&&r.depthTest&&r.depthTest.enabled&&!e.hasDepthAttachment)throw new c.Z("The depth test can not be enabled (drawCommand.renderState.depthTest.enabled) because the framebuffer (drawCommand.framebuffer) does not have a depth or depth-stencil renderbuffer.");G(t,e),U(t,r,i,!1),n._bind(),t._maxFrameTextureUnitIndex=Math.max(t._maxFrameTextureUnitIndex,n.maximumTextureUnitIndex)}(this,o,e,i,s),function(t,e,i,r){const o=e._primitiveType,s=e._vertexArray;let a=e._offset,u=e._count;const d=e.instanceCount;if(!g.Z.validate(o))throw new c.Z("drawCommand.primitiveType is required and must be valid.");if(n.Z.defined("drawCommand.vertexArray",s),n.Z.typeOf.number.greaterThanOrEquals("drawCommand.offset",a,0),(0,l.Z)(u)&&n.Z.typeOf.number.greaterThanOrEquals("drawCommand.count",u,0),n.Z.typeOf.number.greaterThanOrEquals("drawCommand.instanceCount",d,0),d>0&&!t.instancedArrays)throw new c.Z("Instanced arrays extension is not supported");t._us.model=(0,h.Z)(e._modelMatrix,_.Z.IDENTITY),i._setUniforms(r,t._us,t.validateShaderProgram),s._bind();const f=s.indexBuffer;(0,l.Z)(f)?(a*=f.bytesPerIndex,u=(0,h.Z)(u,f.numberOfIndices),0===d?t._gl.drawElements(o,u,f.indexDatatype,a):t.glDrawElementsInstanced(o,u,f.indexDatatype,a,d)):(u=(0,h.Z)(u,s.numberOfVertices),0===d?t._gl.drawArrays(o,a,u):t.glDrawArraysInstanced(o,a,u,d)),s._unBind()}(this,t,i,r)},V.prototype.endFrame=function(){const t=this._gl;t.useProgram(null),this._currentFramebuffer=void 0,t.bindFramebuffer(t.FRAMEBUFFER,null);const e=z;this.drawBuffers&&this.glDrawBuffers(e);const i=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(let e=0;e<i;++e)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,null),t.bindTexture(t.TEXTURE_CUBE_MAP,null)},V.prototype.readPixels=function(t){const e=this._gl;t=(0,h.Z)(t,h.Z.EMPTY_OBJECT);const i=Math.max((0,h.Z)(t.x,0),0),r=Math.max((0,h.Z)(t.y,0),0),o=(0,h.Z)(t.width,e.drawingBufferWidth),s=(0,h.Z)(t.height,e.drawingBufferHeight),a=t.framebuffer;n.Z.typeOf.number.greaterThan("readState.width",o,0),n.Z.typeOf.number.greaterThan("readState.height",s,0);let u=C.Z.UNSIGNED_BYTE;(0,l.Z)(a)&&a.numberOfColorAttachments>0&&(u=a.getColorTexture(0).pixelDatatype);const c=m.Z.createTypedArray(m.Z.RGBA,u,o,s);return G(this,a),e.readPixels(i,r,o,s,m.Z.RGBA,C.Z.toWebGLConstant(u,this),c),c};const k={position:0,textureCoordinates:1};function H(t,e,i){this._pickObjects=t,this.key=e,this.color=i}V.prototype.getViewportQuadVertexArray=function(){let t=this.cache.viewportQuad_vertexArray;if(!(0,l.Z)(t)){const e=new d.Z({attributes:{position:new f.Z({componentDatatype:s.Z.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new f.Z({componentDatatype:s.Z.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:g.Z.TRIANGLES});t=R.Z.fromGeometry({context:this,geometry:e,attributeLocations:k,bufferUsage:w.Z.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=t}return t},V.prototype.createViewportQuadCommand=function(t,e){return e=(0,h.Z)(e,h.Z.EMPTY_OBJECT),new x.Z({vertexArray:this.getViewportQuadVertexArray(),primitiveType:g.Z.TRIANGLES,renderState:e.renderState,shaderProgram:P.Z.fromCache({context:this,vertexShaderSource:v.Z,fragmentShaderSource:t,attributeLocations:k}),uniformMap:e.uniformMap,owner:e.owner,framebuffer:e.framebuffer,pass:e.pass})},V.prototype.getObjectByPickColor=function(t){return n.Z.defined("pickColor",t),this._pickObjects[t.toRgba()]},Object.defineProperties(H.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(t){this._pickObjects[this.key]=t}}}),H.prototype.destroy=function(){delete this._pickObjects[this.key]},V.prototype.createPickId=function(t){n.Z.defined("object",t),++this._nextPickColor[0];const e=this._nextPickColor[0];if(0===e)throw new Z.Z("Out of unique Pick IDs.");return this._pickObjects[e]=t,new H(this._pickObjects,e,o.Z.fromRgba(e))},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){const t=this.cache;for(const e in t)if(t.hasOwnProperty(e)){const i=t[e];(0,l.Z)(i.destroy)&&i.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultEmissiveTexture=this._defaultEmissiveTexture&&this._defaultEmissiveTexture.destroy(),this._defaultNormalTexture=this._defaultNormalTexture&&this._defaultNormalTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),(0,u.Z)(this)};const j=V},85834:(t,e,i)=>{i.d(e,{Z:()=>r});const n={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(n,{maximumCombinedTextureImageUnits:{get:function(){return n._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return n._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return n._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return n._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return n._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return n._maximumTextureSize}},maximumVaryingVectors:{get:function(){return n._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return n._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return n._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return n._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return n._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return n._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return n._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return n._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return n._maximumViewportWidth}},maximumViewportHeight:{get:function(){return n._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return n._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return n._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return n._maximumColorAttachments}},maximumSamples:{get:function(){return n._maximumSamples}},highpFloatSupported:{get:function(){return n._highpFloatSupported}},highpIntSupported:{get:function(){return n._highpIntSupported}}});const r=n},83159:(t,e,i)=>{i.d(e,{Z:()=>Z});var n=i(17497),r=i(88779),o=i(54485),s=i(90332),a=i(20176),h=i(22874),l=i(91166),u=i(85834),c=i(16164),d=i(22641),f=i(27400),p=i(28696),_=i(92106),m=i(48867);function g(t){t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context);const e=t.context,i=t.source;let s,h;if((0,o.Z)(i)){const t=[i.positiveX,i.negativeX,i.positiveY,i.negativeY,i.positiveZ,i.negativeZ];if(!(t[0]&&t[1]&&t[2]&&t[3]&&t[4]&&t[5]))throw new a.Z("options.source requires positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ faces.");s=t[0].width,h=t[0].height;for(let e=1;e<6;++e)if(Number(t[e].width)!==s||Number(t[e].height)!==h)throw new a.Z("Each face in options.source must have the same width and height.")}else s=t.width,h=t.height;const d=s,_=(0,r.Z)(t.pixelDatatype,f.Z.UNSIGNED_BYTE),m=(0,r.Z)(t.pixelFormat,l.Z.RGBA),g=l.Z.toInternalFormat(m,_,e);if(!(0,o.Z)(s)||!(0,o.Z)(h))throw new a.Z("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.");if(s!==h)throw new a.Z("Width must equal height.");if(d<=0)throw new a.Z("Width and height must be greater than zero.");if(d>u.Z.maximumCubeMapSize)throw new a.Z(`Width and height must be less than or equal to the maximum cube map size (${u.Z.maximumCubeMapSize}).  Check maximumCubeMapSize.`);if(!l.Z.validate(m))throw new a.Z("Invalid options.pixelFormat.");if(l.Z.isDepthFormat(m))throw new a.Z("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.");if(!f.Z.validate(_))throw new a.Z("Invalid options.pixelDatatype.");if(_===f.Z.FLOAT&&!e.floatingPointTexture)throw new a.Z("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.");if(_===f.Z.HALF_FLOAT&&!e.halfFloatingPointTexture)throw new a.Z("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension.");const Z=6*l.Z.textureSizeInBytes(m,_,d,d),y=t.preMultiplyAlpha||m===l.Z.RGB||m===l.Z.LUMINANCE,v=(0,r.Z)(t.flipY,!0),w=(0,r.Z)(t.skipColorSpaceConversion,!1),T=e._gl,b=T.TEXTURE_CUBE_MAP,E=T.createTexture();function x(t,i,n,r,a){let h=i.arrayBufferView;(0,o.Z)(h)||(h=i.bufferView);let u=4;(0,o.Z)(h)&&(u=l.Z.alignmentInBytes(m,_,s)),T.pixelStorei(T.UNPACK_ALIGNMENT,u),a?T.pixelStorei(T.UNPACK_COLORSPACE_CONVERSION_WEBGL,T.NONE):T.pixelStorei(T.UNPACK_COLORSPACE_CONVERSION_WEBGL,T.BROWSER_DEFAULT_WEBGL),(0,o.Z)(h)?(T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),T.pixelStorei(T.UNPACK_FLIP_Y_WEBGL,!1),r&&(h=l.Z.flipY(h,m,_,d,d)),T.texImage2D(t,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),h)):(T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),T.pixelStorei(T.UNPACK_FLIP_Y_WEBGL,r),T.texImage2D(t,0,g,m,f.Z.toWebGLConstant(_,e),i))}T.activeTexture(T.TEXTURE0),T.bindTexture(b,E),(0,o.Z)(i)?(x(T.TEXTURE_CUBE_MAP_POSITIVE_X,i.positiveX,y,v,w),x(T.TEXTURE_CUBE_MAP_NEGATIVE_X,i.negativeX,y,v,w),x(T.TEXTURE_CUBE_MAP_POSITIVE_Y,i.positiveY,y,v,w),x(T.TEXTURE_CUBE_MAP_NEGATIVE_Y,i.negativeY,y,v,w),x(T.TEXTURE_CUBE_MAP_POSITIVE_Z,i.positiveZ,y,v,w),x(T.TEXTURE_CUBE_MAP_NEGATIVE_Z,i.negativeZ,y,v,w)):(T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),null),T.texImage2D(T.TEXTURE_CUBE_MAP_NEGATIVE_X,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),null),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_Y,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),null),T.texImage2D(T.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),null),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_Z,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),null),T.texImage2D(T.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,g,d,d,0,m,f.Z.toWebGLConstant(_,e),null)),T.bindTexture(b,null),this._context=e,this._textureFilterAnisotropic=e._textureFilterAnisotropic,this._textureTarget=b,this._texture=E,this._pixelFormat=m,this._pixelDatatype=_,this._size=d,this._hasMipmap=!1,this._sizeInBytes=Z,this._preMultiplyAlpha=y,this._flipY=v,this._sampler=void 0;const A=(0,o.Z)(i);this._positiveX=new c.Z(e,E,b,T.TEXTURE_CUBE_MAP_POSITIVE_X,g,m,_,d,y,v,A),this._negativeX=new c.Z(e,E,b,T.TEXTURE_CUBE_MAP_NEGATIVE_X,g,m,_,d,y,v,A),this._positiveY=new c.Z(e,E,b,T.TEXTURE_CUBE_MAP_POSITIVE_Y,g,m,_,d,y,v,A),this._negativeY=new c.Z(e,E,b,T.TEXTURE_CUBE_MAP_NEGATIVE_Y,g,m,_,d,y,v,A),this._positiveZ=new c.Z(e,E,b,T.TEXTURE_CUBE_MAP_POSITIVE_Z,g,m,_,d,y,v,A),this._negativeZ=new c.Z(e,E,b,T.TEXTURE_CUBE_MAP_NEGATIVE_Z,g,m,_,d,y,v,A),this.sampler=(0,o.Z)(t.sampler)?t.sampler:new p.Z}Object.defineProperties(g.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(t){let e=t.minificationFilter,i=t.magnificationFilter;const n=e===m.Z.NEAREST_MIPMAP_NEAREST||e===m.Z.NEAREST_MIPMAP_LINEAR||e===m.Z.LINEAR_MIPMAP_NEAREST||e===m.Z.LINEAR_MIPMAP_LINEAR,r=this._context,s=this._pixelDatatype;(s===f.Z.FLOAT&&!r.textureFloatLinear||s===f.Z.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(e=n?m.Z.NEAREST_MIPMAP_NEAREST:m.Z.NEAREST,i=_.Z.NEAREST);const a=r._gl,h=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(h,this._texture),a.texParameteri(h,a.TEXTURE_MIN_FILTER,e),a.texParameteri(h,a.TEXTURE_MAG_FILTER,i),a.texParameteri(h,a.TEXTURE_WRAP_S,t.wrapS),a.texParameteri(h,a.TEXTURE_WRAP_T,t.wrapT),(0,o.Z)(this._textureFilterAnisotropic)&&a.texParameteri(h,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),a.bindTexture(h,null),this._sampler=t}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),g.prototype.generateMipmap=function(t){if(t=(0,r.Z)(t,d.Z.DONT_CARE),this._size>1&&!h.Z.isPowerOfTwo(this._size))throw new a.Z("width and height must be a power of two to call generateMipmap().");if(!d.Z.validate(t))throw new a.Z("hint is invalid.");this._hasMipmap=!0;const e=this._context._gl,i=this._textureTarget;e.hint(e.GENERATE_MIPMAP_HINT,t),e.activeTexture(e.TEXTURE0),e.bindTexture(i,this._texture),e.generateMipmap(i),e.bindTexture(i,null)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=(0,s.Z)(this._positiveX),this._negativeX=(0,s.Z)(this._negativeX),this._positiveY=(0,s.Z)(this._positiveY),this._negativeY=(0,s.Z)(this._negativeY),this._positiveZ=(0,s.Z)(this._positiveZ),this._negativeZ=(0,s.Z)(this._negativeZ),(0,s.Z)(this)};const Z=g},16164:(t,e,i)=>{i.d(e,{Z:()=>u});var n=i(17497),r=i(88779),o=i(54485),s=i(20176),a=i(91166),h=i(27400);function l(t,e,i,n,r,o,s,a,h,l,u){this._context=t,this._texture=e,this._textureTarget=i,this._targetFace=n,this._pixelDatatype=s,this._internalFormat=r,this._pixelFormat=o,this._size=a,this._preMultiplyAlpha=h,this._flipY=l,this._initialized=u}Object.defineProperties(l.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),l.prototype.copyFrom=function(t){n.Z.defined("options",t);const e=(0,r.Z)(t.xOffset,0),i=(0,r.Z)(t.yOffset,0);if(n.Z.defined("options.source",t.source),n.Z.typeOf.number.greaterThanOrEquals("xOffset",e,0),n.Z.typeOf.number.greaterThanOrEquals("yOffset",i,0),e+t.source.width>this._size)throw new s.Z("xOffset + options.source.width must be less than or equal to width.");if(i+t.source.height>this._size)throw new s.Z("yOffset + options.source.height must be less than or equal to height.");const l=t.source,u=this._context._gl,c=this._textureTarget,d=this._targetFace;u.activeTexture(u.TEXTURE0),u.bindTexture(c,this._texture);const f=l.width,p=l.height;let _=l.arrayBufferView;const m=this._size,g=this._pixelFormat,Z=this._internalFormat,y=this._pixelDatatype,v=this._preMultiplyAlpha,w=this._flipY,T=(0,r.Z)(t.skipColorSpaceConversion,!1);let b=4;(0,o.Z)(_)&&(b=a.Z.alignmentInBytes(g,y,f)),u.pixelStorei(u.UNPACK_ALIGNMENT,b),T?u.pixelStorei(u.UNPACK_COLORSPACE_CONVERSION_WEBGL,u.NONE):u.pixelStorei(u.UNPACK_COLORSPACE_CONVERSION_WEBGL,u.BROWSER_DEFAULT_WEBGL);let E=!1;if(!this._initialized){if(0===e&&0===i&&f===m&&p===m)(0,o.Z)(_)?(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1),w&&(_=a.Z.flipY(_,g,y,m,m)),u.texImage2D(d,0,Z,m,m,0,g,h.Z.toWebGLConstant(y,this._context),_)):(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,v),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,w),u.texImage2D(d,0,Z,g,h.Z.toWebGLConstant(y,this._context),l)),E=!0;else{u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1);const t=a.Z.createTypedArray(g,y,m,m);u.texImage2D(d,0,Z,m,m,0,g,h.Z.toWebGLConstant(y,this._context),t)}this._initialized=!0}E||((0,o.Z)(_)?(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1),w&&(_=a.Z.flipY(_,g,y,f,p)),u.texSubImage2D(d,0,e,i,f,p,g,h.Z.toWebGLConstant(y,this._context),_)):(u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,v),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,w),u.texSubImage2D(d,0,e,i,g,h.Z.toWebGLConstant(y,this._context),l))),u.bindTexture(c,null)},l.prototype.copyFromFramebuffer=function(t,e,i,o,a,l){if(t=(0,r.Z)(t,0),e=(0,r.Z)(e,0),i=(0,r.Z)(i,0),o=(0,r.Z)(o,0),a=(0,r.Z)(a,this._size),l=(0,r.Z)(l,this._size),n.Z.typeOf.number.greaterThanOrEquals("xOffset",t,0),n.Z.typeOf.number.greaterThanOrEquals("yOffset",e,0),n.Z.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),n.Z.typeOf.number.greaterThanOrEquals("framebufferYOffset",o,0),t+a>this._size)throw new s.Z("xOffset + source.width must be less than or equal to width.");if(e+l>this._size)throw new s.Z("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===h.Z.FLOAT)throw new s.Z("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===h.Z.HALF_FLOAT)throw new s.Z("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");const u=this._context._gl,c=this._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(c,this._texture),u.copyTexSubImage2D(this._targetFace,0,t,e,i,o,a,l),u.bindTexture(c,null),this._initialized=!0};const u=l},71087:(t,e,i)=>{i.d(e,{Z:()=>g});var n=i(88779),r=i(54485),o=i(84473);const s=1,a=2,h=4,l=8,u=16,c=32,d=64,f=128;function p(t){t=(0,n.Z)(t,n.Z.EMPTY_OBJECT),this._boundingVolume=t.boundingVolume,this._orientedBoundingBox=t.orientedBoundingBox,this._modelMatrix=t.modelMatrix,this._primitiveType=(0,n.Z)(t.primitiveType,o.Z.TRIANGLES),this._vertexArray=t.vertexArray,this._count=t.count,this._offset=(0,n.Z)(t.offset,0),this._instanceCount=(0,n.Z)(t.instanceCount,0),this._shaderProgram=t.shaderProgram,this._uniformMap=t.uniformMap,this._renderState=t.renderState,this._framebuffer=t.framebuffer,this._pass=t.pass,this._owner=t.owner,this._debugOverlappingFrustums=0,this._pickId=t.pickId,this._flags=0,this.cull=(0,n.Z)(t.cull,!0),this.occlude=(0,n.Z)(t.occlude,!0),this.executeInClosestFrustum=(0,n.Z)(t.executeInClosestFrustum,!1),this.debugShowBoundingVolume=(0,n.Z)(t.debugShowBoundingVolume,!1),this.castShadows=(0,n.Z)(t.castShadows,!1),this.receiveShadows=(0,n.Z)(t.receiveShadows,!1),this.pickOnly=(0,n.Z)(t.pickOnly,!1),this.depthForTranslucentClassification=(0,n.Z)(t.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function _(t,e){return(t._flags&e)===e}function m(t,e,i){i?t._flags|=e:t._flags&=~e}Object.defineProperties(p.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(t){this._boundingVolume!==t&&(this._boundingVolume=t,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(t){this._orientedBoundingBox!==t&&(this._orientedBoundingBox=t,this.dirty=!0)}},cull:{get:function(){return _(this,s)},set:function(t){_(this,s)!==t&&(m(this,s,t),this.dirty=!0)}},occlude:{get:function(){return _(this,a)},set:function(t){_(this,a)!==t&&(m(this,a,t),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(t){this._modelMatrix!==t&&(this._modelMatrix=t,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(t){this._primitiveType!==t&&(this._primitiveType=t,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(t){this._vertexArray!==t&&(this._vertexArray=t,this.dirty=!0)}},count:{get:function(){return this._count},set:function(t){this._count!==t&&(this._count=t,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(t){this._offset!==t&&(this._offset=t,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(t){this._instanceCount!==t&&(this._instanceCount=t,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(t){this._shaderProgram!==t&&(this._shaderProgram=t,this.dirty=!0)}},castShadows:{get:function(){return _(this,u)},set:function(t){_(this,u)!==t&&(m(this,u,t),this.dirty=!0)}},receiveShadows:{get:function(){return _(this,c)},set:function(t){_(this,c)!==t&&(m(this,c,t),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(t){this._uniformMap!==t&&(this._uniformMap=t,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(t){this._renderState!==t&&(this._renderState=t,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(t){this._framebuffer!==t&&(this._framebuffer=t,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(t){this._pass!==t&&(this._pass=t,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return _(this,h)},set:function(t){_(this,h)!==t&&(m(this,h,t),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(t){this._owner!==t&&(this._owner=t,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return _(this,l)},set:function(t){_(this,l)!==t&&(m(this,l,t),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(t){this._debugOverlappingFrustums!==t&&(this._debugOverlappingFrustums=t,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(t){this._pickId!==t&&(this._pickId=t,this.dirty=!0)}},pickOnly:{get:function(){return _(this,d)},set:function(t){_(this,d)!==t&&(m(this,d,t),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return _(this,f)},set:function(t){_(this,f)!==t&&(m(this,f,t),this.dirty=!0)}}}),p.shallowClone=function(t,e){if((0,r.Z)(t))return(0,r.Z)(e)||(e=new p),e._boundingVolume=t._boundingVolume,e._orientedBoundingBox=t._orientedBoundingBox,e._modelMatrix=t._modelMatrix,e._primitiveType=t._primitiveType,e._vertexArray=t._vertexArray,e._count=t._count,e._offset=t._offset,e._instanceCount=t._instanceCount,e._shaderProgram=t._shaderProgram,e._uniformMap=t._uniformMap,e._renderState=t._renderState,e._framebuffer=t._framebuffer,e._pass=t._pass,e._owner=t._owner,e._debugOverlappingFrustums=t._debugOverlappingFrustums,e._pickId=t._pickId,e._flags=t._flags,e.dirty=!0,e.lastDirtyTime=0,e},p.prototype.execute=function(t,e){t.draw(this,e)};const g=p},36274:(t,e,i)=>{i.d(e,{Z:()=>p});var n=i(17497),r=i(88779),o=i(54485),s=i(90332),a=i(20176),h=i(91166),l=i(85834),u=i(27400);function c(t,e,i){const n=t._gl;n.framebufferTexture2D(n.FRAMEBUFFER,e,i._target,i._texture,0)}function d(t,e,i){const n=t._gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,e,n.RENDERBUFFER,i._getRenderbuffer())}function f(t){const e=(t=(0,r.Z)(t,r.Z.EMPTY_OBJECT)).context;n.Z.defined("options.context",e);const i=e._gl,s=l.Z.maximumColorAttachments;if(this._gl=i,this._framebuffer=i.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=(0,r.Z)(t.destroyAttachments,!0),(0,o.Z)(t.colorTextures)&&(0,o.Z)(t.colorRenderbuffers))throw new a.Z("Cannot have both color texture and color renderbuffer attachments.");if((0,o.Z)(t.depthTexture)&&(0,o.Z)(t.depthRenderbuffer))throw new a.Z("Cannot have both a depth texture and depth renderbuffer attachment.");if((0,o.Z)(t.depthStencilTexture)&&(0,o.Z)(t.depthStencilRenderbuffer))throw new a.Z("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.");const f=(0,o.Z)(t.depthTexture)||(0,o.Z)(t.depthRenderbuffer),p=(0,o.Z)(t.depthStencilTexture)||(0,o.Z)(t.depthStencilRenderbuffer);if(f&&p)throw new a.Z("Cannot have both a depth and depth-stencil attachment.");if((0,o.Z)(t.stencilRenderbuffer)&&p)throw new a.Z("Cannot have both a stencil and depth-stencil attachment.");if(f&&(0,o.Z)(t.stencilRenderbuffer))throw new a.Z("Cannot have both a depth and stencil attachment.");let _,m,g,Z,y;if(this._bind(),(0,o.Z)(t.colorTextures)){const i=t.colorTextures;if(Z=this._colorTextures.length=this._activeColorAttachments.length=i.length,Z>s)throw new a.Z("The number of color attachments exceeds the number supported.");for(g=0;g<Z;++g){if(_=i[g],!h.Z.isColorFormat(_.pixelFormat))throw new a.Z("The color-texture pixel-format must be a color format.");if(_.pixelDatatype===u.Z.FLOAT&&!e.colorBufferFloat)throw new a.Z("The color texture pixel datatype is FLOAT and the WebGL implementation does not support the EXT_color_buffer_float or WEBGL_color_buffer_float extensions. See Context.colorBufferFloat.");if(_.pixelDatatype===u.Z.HALF_FLOAT&&!e.colorBufferHalfFloat)throw new a.Z("The color texture pixel datatype is HALF_FLOAT and the WebGL implementation does not support the EXT_color_buffer_half_float extension. See Context.colorBufferHalfFloat.");y=this._gl.COLOR_ATTACHMENT0+g,c(this,y,_),this._activeColorAttachments[g]=y,this._colorTextures[g]=_}}if((0,o.Z)(t.colorRenderbuffers)){const e=t.colorRenderbuffers;if(Z=this._colorRenderbuffers.length=this._activeColorAttachments.length=e.length,Z>s)throw new a.Z("The number of color attachments exceeds the number supported.");for(g=0;g<Z;++g)m=e[g],y=this._gl.COLOR_ATTACHMENT0+g,d(this,y,m),this._activeColorAttachments[g]=y,this._colorRenderbuffers[g]=m}if((0,o.Z)(t.depthTexture)){if(_=t.depthTexture,_.pixelFormat!==h.Z.DEPTH_COMPONENT)throw new a.Z("The depth-texture pixel-format must be DEPTH_COMPONENT.");c(this,this._gl.DEPTH_ATTACHMENT,_),this._depthTexture=_}if((0,o.Z)(t.depthRenderbuffer)&&(m=t.depthRenderbuffer,d(this,this._gl.DEPTH_ATTACHMENT,m),this._depthRenderbuffer=m),(0,o.Z)(t.stencilRenderbuffer)&&(m=t.stencilRenderbuffer,d(this,this._gl.STENCIL_ATTACHMENT,m),this._stencilRenderbuffer=m),(0,o.Z)(t.depthStencilTexture)){if(_=t.depthStencilTexture,_.pixelFormat!==h.Z.DEPTH_STENCIL)throw new a.Z("The depth-stencil pixel-format must be DEPTH_STENCIL.");c(this,this._gl.DEPTH_STENCIL_ATTACHMENT,_),this._depthStencilTexture=_}(0,o.Z)(t.depthStencilRenderbuffer)&&(m=t.depthStencilRenderbuffer,d(this,this._gl.DEPTH_STENCIL_ATTACHMENT,m),this._depthStencilRenderbuffer=m),this._unBind()}Object.defineProperties(f.prototype,{status:{get:function(){this._bind();const t=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),t}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),f.prototype._bind=function(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer)},f.prototype._unBind=function(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},f.prototype.bindDraw=function(){const t=this._gl;t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this._framebuffer)},f.prototype.bindRead=function(){const t=this._gl;t.bindFramebuffer(t.READ_FRAMEBUFFER,this._framebuffer)},f.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},f.prototype.getColorTexture=function(t){if(!(0,o.Z)(t)||t<0||t>=this._colorTextures.length)throw new a.Z("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorTextures[t]},f.prototype.getColorRenderbuffer=function(t){if(!(0,o.Z)(t)||t<0||t>=this._colorRenderbuffers.length)throw new a.Z("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorRenderbuffers[t]},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){if(this.destroyAttachments){let t=0;const e=this._colorTextures;let i=e.length;for(;t<i;++t){const i=e[t];(0,o.Z)(i)&&i.destroy()}const n=this._colorRenderbuffers;for(i=n.length,t=0;t<i;++t){const e=n[t];(0,o.Z)(e)&&e.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),(0,s.Z)(this)};const p=f},37791:(t,e,i)=>{i.d(e,{Z:()=>_});var n=i(36274),r=i(49133),o=i(27400),s=i(29825),a=i(88573),h=i(28696),l=i(47334),u=i(88779),c=i(54485),d=i(20176),f=i(91166);function p(t){if(t=(0,u.Z)(t,u.Z.EMPTY_OBJECT),this._numSamples=(0,u.Z)(t.numSamples,1),this._colorAttachmentsLength=(0,u.Z)(t.colorAttachmentsLength,1),this._color=(0,u.Z)(t.color,!0),this._depth=(0,u.Z)(t.depth,!1),this._depthStencil=(0,u.Z)(t.depthStencil,!1),this._supportsDepthTexture=(0,u.Z)(t.supportsDepthTexture,!1),!this._color&&!this._depth&&!this._depthStencil)throw new d.Z("Must enable at least one type of framebuffer attachment.");if(this._depth&&this._depthStencil)throw new d.Z("Cannot have both a depth and depth-stencil attachment.");this._createColorAttachments=(0,u.Z)(t.createColorAttachments,!0),this._createDepthAttachments=(0,u.Z)(t.createDepthAttachments,!0),this._pixelDatatype=t.pixelDatatype,this._pixelFormat=t.pixelFormat,this._width=void 0,this._height=void 0,this._framebuffer=void 0,this._multisampleFramebuffer=void 0,this._colorTextures=void 0,this._color&&(this._colorTextures=new Array(this._colorAttachmentsLength),this._colorRenderbuffers=new Array(this._colorAttachmentsLength)),this._colorRenderbuffer=void 0,this._depthStencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthRenderbuffer=void 0,this._depthTexture=void 0,this._attachmentsDirty=!1}Object.defineProperties(p.prototype,{framebuffer:{get:function(){return this._numSamples>1?this._multisampleFramebuffer.getRenderFramebuffer():this._framebuffer}},numSamples:{get:function(){return this._numSamples}},status:{get:function(){return this.framebuffer.status}}}),p.prototype.isDirty=function(t,e,i,n,r){i=(0,u.Z)(i,1);const o=this._width!==t||this._height!==e,s=this._numSamples!==i,a=(0,c.Z)(n)&&this._pixelDatatype!==n||(0,c.Z)(r)&&this._pixelFormat!==r,h=1===i?(0,c.Z)(this._framebuffer):(0,c.Z)(this._multisampleFramebuffer);return this._attachmentsDirty||o||s||a||!h||this._color&&!(0,c.Z)(this._colorTextures[0])},p.prototype.update=function(t,e,i,p,_,m){if(!(0,c.Z)(e)||!(0,c.Z)(i))throw new d.Z("width and height must be defined.");if(p=t.msaa?(0,u.Z)(p,1):1,_=(0,u.Z)(_,this._color?(0,u.Z)(this._pixelDatatype,o.Z.UNSIGNED_BYTE):void 0),m=(0,u.Z)(m,this._color?(0,u.Z)(this._pixelFormat,f.Z.RGBA):void 0),this.isDirty(e,i,p,_,m)){if(this.destroy(),this._width=e,this._height=i,this._numSamples=p,this._pixelDatatype=_,this._pixelFormat=m,this._attachmentsDirty=!1,this._color&&this._createColorAttachments)for(let n=0;n<this._colorAttachmentsLength;++n)if(this._colorTextures[n]=new l.Z({context:t,width:e,height:i,pixelFormat:m,pixelDatatype:_,sampler:h.Z.NEAREST}),this._numSamples>1){const r=a.Z.getColorFormat(_);this._colorRenderbuffers[n]=new s.Z({context:t,width:e,height:i,format:r,numSamples:this._numSamples})}this._depthStencil&&this._createDepthAttachments&&(this._supportsDepthTexture&&t.depthTexture?(this._depthStencilTexture=new l.Z({context:t,width:e,height:i,pixelFormat:f.Z.DEPTH_STENCIL,pixelDatatype:o.Z.UNSIGNED_INT_24_8,sampler:h.Z.NEAREST}),this._numSamples>1&&(this._depthStencilRenderbuffer=new s.Z({context:t,width:e,height:i,format:a.Z.DEPTH24_STENCIL8,numSamples:this._numSamples}))):this._depthStencilRenderbuffer=new s.Z({context:t,width:e,height:i,format:a.Z.DEPTH_STENCIL})),this._depth&&this._createDepthAttachments&&(this._supportsDepthTexture&&t.depthTexture?this._depthTexture=new l.Z({context:t,width:e,height:i,pixelFormat:f.Z.DEPTH_COMPONENT,pixelDatatype:o.Z.UNSIGNED_INT,sampler:h.Z.NEAREST}):this._depthRenderbuffer=new s.Z({context:t,width:e,height:i,format:a.Z.DEPTH_COMPONENT16})),this._numSamples>1?this._multisampleFramebuffer=new r.Z({context:t,width:this._width,height:this._height,colorTextures:this._colorTextures,colorRenderbuffers:this._colorRenderbuffers,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}):this._framebuffer=new n.Z({context:t,colorTextures:this._colorTextures,depthTexture:this._depthTexture,depthRenderbuffer:this._depthRenderbuffer,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1})}},p.prototype.getColorTexture=function(t){if((t=(0,u.Z)(t,0))>=this._colorAttachmentsLength)throw new d.Z("index must be smaller than total number of color attachments.");return this._colorTextures[t]},p.prototype.setColorTexture=function(t,e){if(e=(0,u.Z)(e,0),this._createColorAttachments)throw new d.Z("createColorAttachments must be false if setColorTexture is called.");if(e>=this._colorAttachmentsLength)throw new d.Z("index must be smaller than total number of color attachments.");this._attachmentsDirty=t!==this._colorTextures[e],this._colorTextures[e]=t},p.prototype.getColorRenderbuffer=function(t){if((t=(0,u.Z)(t,0))>=this._colorAttachmentsLength)throw new d.Z("index must be smaller than total number of color attachments.");return this._colorRenderbuffers[t]},p.prototype.setColorRenderbuffer=function(t,e){if(e=(0,u.Z)(e,0),this._createColorAttachments)throw new d.Z("createColorAttachments must be false if setColorRenderbuffer is called.");if(e>=this._colorAttachmentsLength)throw new d.Z("index must be smaller than total number of color attachments.");this._attachmentsDirty=t!==this._colorRenderbuffers[e],this._colorRenderbuffers[e]=t},p.prototype.getDepthRenderbuffer=function(){return this._depthRenderbuffer},p.prototype.setDepthRenderbuffer=function(t){if(this._createDepthAttachments)throw new d.Z("createDepthAttachments must be false if setDepthRenderbuffer is called.");this._attachmentsDirty=t!==this._depthRenderbuffer,this._depthRenderbuffer=t},p.prototype.getDepthTexture=function(){return this._depthTexture},p.prototype.setDepthTexture=function(t){if(this._createDepthAttachments)throw new d.Z("createDepthAttachments must be false if setDepthTexture is called.");this._attachmentsDirty=t!==this._depthTexture,this._depthTexture=t},p.prototype.getDepthStencilRenderbuffer=function(){return this._depthStencilRenderbuffer},p.prototype.setDepthStencilRenderbuffer=function(t){if(this._createDepthAttachments)throw new d.Z("createDepthAttachments must be false if setDepthStencilRenderbuffer is called.");this._attachmentsDirty=t!==this._depthStencilRenderbuffer,this._depthStencilRenderbuffer=t},p.prototype.getDepthStencilTexture=function(){return this._depthStencilTexture},p.prototype.setDepthStencilTexture=function(t){if(this._createDepthAttachments)throw new d.Z("createDepthAttachments must be false if setDepthStencilTexture is called.");this._attachmentsDirty=t!==this._depthStencilTexture,this._depthStencilTexture=t},p.prototype.prepareTextures=function(t,e){this._numSamples>1&&this._multisampleFramebuffer.blitFramebuffers(t,e)},p.prototype.clear=function(t,e,i){const n=e.framebuffer;e.framebuffer=this.framebuffer,e.execute(t,i),e.framebuffer=n},p.prototype.destroyFramebuffer=function(){this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._multisampleFramebuffer=this._multisampleFramebuffer&&this._multisampleFramebuffer.destroy()},p.prototype.destroy=function(){if(this._color){let t;const e=this._colorTextures.length;for(t=0;t<e;++t){const e=this._colorTextures[t];this._createColorAttachments&&(0,c.Z)(e)&&!e.isDestroyed()&&(this._colorTextures[t].destroy(),this._colorTextures[t]=void 0),(0,c.Z)(e)&&e.isDestroyed()&&(this._colorTextures[t]=void 0);const i=this._colorRenderbuffers[t];this._createColorAttachments&&(0,c.Z)(i)&&!i.isDestroyed()&&(this._colorRenderbuffers[t].destroy(),this._colorRenderbuffers[t]=void 0),(0,c.Z)(i)&&i.isDestroyed()&&(this._colorRenderbuffers[t]=void 0)}}this._depthStencil&&(this._createDepthAttachments&&(this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()),(0,c.Z)(this._depthStencilTexture)&&this._depthStencilTexture.isDestroyed()&&(this._depthStencilTexture=void 0),(0,c.Z)(this._depthStencilRenderbuffer)&&this._depthStencilRenderbuffer.isDestroyed()&&(this._depthStencilRenderbuffer=void 0)),this._depth&&(this._createDepthAttachments&&(this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy()),(0,c.Z)(this._depthTexture)&&this._depthTexture.isDestroyed()&&(this._depthTexture=void 0),(0,c.Z)(this._depthRenderbuffer)&&this._depthRenderbuffer.isDestroyed()&&(this._depthRenderbuffer=void 0)),this.destroyFramebuffer()};const _=p},22641:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={DONT_CARE:n.Z.DONT_CARE,FASTEST:n.Z.FASTEST,NICEST:n.Z.NICEST,validate:function(t){return t===r.DONT_CARE||t===r.FASTEST||t===r.NICEST}},o=Object.freeze(r)},49133:(t,e,i)=>{i.d(e,{Z:()=>u});var n=i(17497),r=i(88779),o=i(54485),s=i(90332),a=i(20176),h=i(36274);function l(t){const e=(t=(0,r.Z)(t,r.Z.EMPTY_OBJECT)).context,i=t.width,s=t.height;n.Z.defined("options.context",e),n.Z.defined("options.width",i),n.Z.defined("options.height",s),this._width=i,this._height=s;const l=t.colorRenderbuffers,u=t.colorTextures;if((0,o.Z)(l)!==(0,o.Z)(u))throw new a.Z("Both color renderbuffer and texture attachments must be provided.");const c=t.depthStencilRenderbuffer,d=t.depthStencilTexture;if((0,o.Z)(c)!==(0,o.Z)(d))throw new a.Z("Both depth-stencil renderbuffer and texture attachments must be provided.");this._renderFramebuffer=new h.Z({context:e,colorRenderbuffers:l,depthStencilRenderbuffer:c,destroyAttachments:t.destroyAttachments}),this._colorFramebuffer=new h.Z({context:e,colorTextures:u,depthStencilTexture:d,destroyAttachments:t.destroyAttachments})}l.prototype.getRenderFramebuffer=function(){return this._renderFramebuffer},l.prototype.getColorFramebuffer=function(){return this._colorFramebuffer},l.prototype.blitFramebuffers=function(t,e){this._renderFramebuffer.bindRead(),this._colorFramebuffer.bindDraw();const i=t._gl;let n=0;this._colorFramebuffer._colorTextures.length>0&&(n|=i.COLOR_BUFFER_BIT),(0,o.Z)(this._colorFramebuffer.depthStencilTexture)&&(n|=i.DEPTH_BUFFER_BIT|(e?i.STENCIL_BUFFER_BIT:0)),i.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,n,i.NEAREST),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._renderFramebuffer.destroy(),this._colorFramebuffer.destroy(),(0,s.Z)(this)};const u=l},1577:(t,e,i)=>{i.d(e,{Z:()=>n});const n=Object.freeze({ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,OVERLAY:9,NUMBER_OF_PASSES:10})},59434:(t,e,i)=>{i.d(e,{Z:()=>n});const n=function(t){this.context=t,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}},27400:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={UNSIGNED_BYTE:n.Z.UNSIGNED_BYTE,UNSIGNED_SHORT:n.Z.UNSIGNED_SHORT,UNSIGNED_INT:n.Z.UNSIGNED_INT,FLOAT:n.Z.FLOAT,HALF_FLOAT:n.Z.HALF_FLOAT_OES,UNSIGNED_INT_24_8:n.Z.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:n.Z.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:n.Z.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:n.Z.UNSIGNED_SHORT_5_6_5,toWebGLConstant:function(t,e){switch(t){case r.UNSIGNED_BYTE:return n.Z.UNSIGNED_BYTE;case r.UNSIGNED_SHORT:return n.Z.UNSIGNED_SHORT;case r.UNSIGNED_INT:return n.Z.UNSIGNED_INT;case r.FLOAT:return n.Z.FLOAT;case r.HALF_FLOAT:return e.webgl2?n.Z.HALF_FLOAT:n.Z.HALF_FLOAT_OES;case r.UNSIGNED_INT_24_8:return n.Z.UNSIGNED_INT_24_8;case r.UNSIGNED_SHORT_4_4_4_4:return n.Z.UNSIGNED_SHORT_4_4_4_4;case r.UNSIGNED_SHORT_5_5_5_1:return n.Z.UNSIGNED_SHORT_5_5_5_1;case r.UNSIGNED_SHORT_5_6_5:return r.UNSIGNED_SHORT_5_6_5}},isPacked:function(t){return t===r.UNSIGNED_INT_24_8||t===r.UNSIGNED_SHORT_4_4_4_4||t===r.UNSIGNED_SHORT_5_5_5_1||t===r.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(t){switch(t){case r.UNSIGNED_BYTE:return 1;case r.UNSIGNED_SHORT:case r.UNSIGNED_SHORT_4_4_4_4:case r.UNSIGNED_SHORT_5_5_5_1:case r.UNSIGNED_SHORT_5_6_5:case r.HALF_FLOAT:return 2;case r.UNSIGNED_INT:case r.FLOAT:case r.UNSIGNED_INT_24_8:return 4}},validate:function(t){return t===r.UNSIGNED_BYTE||t===r.UNSIGNED_SHORT||t===r.UNSIGNED_INT||t===r.FLOAT||t===r.HALF_FLOAT||t===r.UNSIGNED_INT_24_8||t===r.UNSIGNED_SHORT_4_4_4_4||t===r.UNSIGNED_SHORT_5_5_5_1||t===r.UNSIGNED_SHORT_5_6_5}},o=Object.freeze(r)},74064:(t,e,i)=>{i.d(e,{Z:()=>L});var n=i(23114),r=i(6785),o=i(88779),s=i(54485),a=i(20176),h=i(95411),l=i(39892),u=i(85834),c=i(30396);function d(t){return t===h.Z.FUNC_ADD||t===h.Z.FUNC_SUBTRACT||t===h.Z.FUNC_REVERSE_SUBTRACT||t===h.Z.MIN||t===h.Z.MAX}function f(t){return t===h.Z.ZERO||t===h.Z.ONE||t===h.Z.SRC_COLOR||t===h.Z.ONE_MINUS_SRC_COLOR||t===h.Z.DST_COLOR||t===h.Z.ONE_MINUS_DST_COLOR||t===h.Z.SRC_ALPHA||t===h.Z.ONE_MINUS_SRC_ALPHA||t===h.Z.DST_ALPHA||t===h.Z.ONE_MINUS_DST_ALPHA||t===h.Z.CONSTANT_COLOR||t===h.Z.ONE_MINUS_CONSTANT_COLOR||t===h.Z.CONSTANT_ALPHA||t===h.Z.ONE_MINUS_CONSTANT_ALPHA||t===h.Z.SRC_ALPHA_SATURATE}function p(t){return t===h.Z.NEVER||t===h.Z.LESS||t===h.Z.EQUAL||t===h.Z.LEQUAL||t===h.Z.GREATER||t===h.Z.NOTEQUAL||t===h.Z.GEQUAL||t===h.Z.ALWAYS}function _(t){return t===h.Z.ZERO||t===h.Z.KEEP||t===h.Z.REPLACE||t===h.Z.INCR||t===h.Z.DECR||t===h.Z.INVERT||t===h.Z.INCR_WRAP||t===h.Z.DECR_WRAP}function m(t){const e=(0,o.Z)(t,o.Z.EMPTY_OBJECT),i=(0,o.Z)(e.cull,o.Z.EMPTY_OBJECT),c=(0,o.Z)(e.polygonOffset,o.Z.EMPTY_OBJECT),m=(0,o.Z)(e.scissorTest,o.Z.EMPTY_OBJECT),g=(0,o.Z)(m.rectangle,o.Z.EMPTY_OBJECT),Z=(0,o.Z)(e.depthRange,o.Z.EMPTY_OBJECT),y=(0,o.Z)(e.depthTest,o.Z.EMPTY_OBJECT),v=(0,o.Z)(e.colorMask,o.Z.EMPTY_OBJECT),w=(0,o.Z)(e.blending,o.Z.EMPTY_OBJECT),T=(0,o.Z)(w.color,o.Z.EMPTY_OBJECT),b=(0,o.Z)(e.stencilTest,o.Z.EMPTY_OBJECT),E=(0,o.Z)(b.frontOperation,o.Z.EMPTY_OBJECT),x=(0,o.Z)(b.backOperation,o.Z.EMPTY_OBJECT),A=(0,o.Z)(e.sampleCoverage,o.Z.EMPTY_OBJECT),C=e.viewport;if(this.frontFace=(0,o.Z)(e.frontFace,l.Z.COUNTER_CLOCKWISE),this.cull={enabled:(0,o.Z)(i.enabled,!1),face:(0,o.Z)(i.face,h.Z.BACK)},this.lineWidth=(0,o.Z)(e.lineWidth,1),this.polygonOffset={enabled:(0,o.Z)(c.enabled,!1),factor:(0,o.Z)(c.factor,0),units:(0,o.Z)(c.units,0)},this.scissorTest={enabled:(0,o.Z)(m.enabled,!1),rectangle:n.Z.clone(g)},this.depthRange={near:(0,o.Z)(Z.near,0),far:(0,o.Z)(Z.far,1)},this.depthTest={enabled:(0,o.Z)(y.enabled,!1),func:(0,o.Z)(y.func,h.Z.LESS)},this.colorMask={red:(0,o.Z)(v.red,!0),green:(0,o.Z)(v.green,!0),blue:(0,o.Z)(v.blue,!0),alpha:(0,o.Z)(v.alpha,!0)},this.depthMask=(0,o.Z)(e.depthMask,!0),this.stencilMask=(0,o.Z)(e.stencilMask,-1),this.blending={enabled:(0,o.Z)(w.enabled,!1),color:new r.Z((0,o.Z)(T.red,0),(0,o.Z)(T.green,0),(0,o.Z)(T.blue,0),(0,o.Z)(T.alpha,0)),equationRgb:(0,o.Z)(w.equationRgb,h.Z.FUNC_ADD),equationAlpha:(0,o.Z)(w.equationAlpha,h.Z.FUNC_ADD),functionSourceRgb:(0,o.Z)(w.functionSourceRgb,h.Z.ONE),functionSourceAlpha:(0,o.Z)(w.functionSourceAlpha,h.Z.ONE),functionDestinationRgb:(0,o.Z)(w.functionDestinationRgb,h.Z.ZERO),functionDestinationAlpha:(0,o.Z)(w.functionDestinationAlpha,h.Z.ZERO)},this.stencilTest={enabled:(0,o.Z)(b.enabled,!1),frontFunction:(0,o.Z)(b.frontFunction,h.Z.ALWAYS),backFunction:(0,o.Z)(b.backFunction,h.Z.ALWAYS),reference:(0,o.Z)(b.reference,0),mask:(0,o.Z)(b.mask,-1),frontOperation:{fail:(0,o.Z)(E.fail,h.Z.KEEP),zFail:(0,o.Z)(E.zFail,h.Z.KEEP),zPass:(0,o.Z)(E.zPass,h.Z.KEEP)},backOperation:{fail:(0,o.Z)(x.fail,h.Z.KEEP),zFail:(0,o.Z)(x.zFail,h.Z.KEEP),zPass:(0,o.Z)(x.zPass,h.Z.KEEP)}},this.sampleCoverage={enabled:(0,o.Z)(A.enabled,!1),value:(0,o.Z)(A.value,1),invert:(0,o.Z)(A.invert,!1)},this.viewport=(0,s.Z)(C)?new n.Z(C.x,C.y,C.width,C.height):void 0,this.lineWidth<u.Z.minimumAliasedLineWidth||this.lineWidth>u.Z.maximumAliasedLineWidth)throw new a.Z("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.");if(!l.Z.validate(this.frontFace))throw new a.Z("Invalid renderState.frontFace.");if((S=this.cull.face)!==h.Z.FRONT&&S!==h.Z.BACK&&S!==h.Z.FRONT_AND_BACK)throw new a.Z("Invalid renderState.cull.face.");var S,D;if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0)throw new a.Z("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.");if(this.depthRange.near>this.depthRange.far)throw new a.Z("renderState.depthRange.near can not be greater than renderState.depthRange.far.");if(this.depthRange.near<0)throw new a.Z("renderState.depthRange.near must be greater than or equal to zero.");if(this.depthRange.far>1)throw new a.Z("renderState.depthRange.far must be less than or equal to one.");if((D=this.depthTest.func)!==h.Z.NEVER&&D!==h.Z.LESS&&D!==h.Z.EQUAL&&D!==h.Z.LEQUAL&&D!==h.Z.GREATER&&D!==h.Z.NOTEQUAL&&D!==h.Z.GEQUAL&&D!==h.Z.ALWAYS)throw new a.Z("Invalid renderState.depthTest.func.");if(this.blending.color.red<0||this.blending.color.red>1||this.blending.color.green<0||this.blending.color.green>1||this.blending.color.blue<0||this.blending.color.blue>1||this.blending.color.alpha<0||this.blending.color.alpha>1)throw new a.Z("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.");if(!d(this.blending.equationRgb))throw new a.Z("Invalid renderState.blending.equationRgb.");if(!d(this.blending.equationAlpha))throw new a.Z("Invalid renderState.blending.equationAlpha.");if(!f(this.blending.functionSourceRgb))throw new a.Z("Invalid renderState.blending.functionSourceRgb.");if(!f(this.blending.functionSourceAlpha))throw new a.Z("Invalid renderState.blending.functionSourceAlpha.");if(!f(this.blending.functionDestinationRgb))throw new a.Z("Invalid renderState.blending.functionDestinationRgb.");if(!f(this.blending.functionDestinationAlpha))throw new a.Z("Invalid renderState.blending.functionDestinationAlpha.");if(!p(this.stencilTest.frontFunction))throw new a.Z("Invalid renderState.stencilTest.frontFunction.");if(!p(this.stencilTest.backFunction))throw new a.Z("Invalid renderState.stencilTest.backFunction.");if(!_(this.stencilTest.frontOperation.fail))throw new a.Z("Invalid renderState.stencilTest.frontOperation.fail.");if(!_(this.stencilTest.frontOperation.zFail))throw new a.Z("Invalid renderState.stencilTest.frontOperation.zFail.");if(!_(this.stencilTest.frontOperation.zPass))throw new a.Z("Invalid renderState.stencilTest.frontOperation.zPass.");if(!_(this.stencilTest.backOperation.fail))throw new a.Z("Invalid renderState.stencilTest.backOperation.fail.");if(!_(this.stencilTest.backOperation.zFail))throw new a.Z("Invalid renderState.stencilTest.backOperation.zFail.");if(!_(this.stencilTest.backOperation.zPass))throw new a.Z("Invalid renderState.stencilTest.backOperation.zPass.");if((0,s.Z)(this.viewport)){if(this.viewport.width<0)throw new a.Z("renderState.viewport.width must be greater than or equal to zero.");if(this.viewport.height<0)throw new a.Z("renderState.viewport.height must be greater than or equal to zero.");if(this.viewport.width>u.Z.maximumViewportWidth)throw new a.Z(`renderState.viewport.width must be less than or equal to the maximum viewport width (${u.Z.maximumViewportWidth.toString()}).  Check maximumViewportWidth.`);if(this.viewport.height>u.Z.maximumViewportHeight)throw new a.Z(`renderState.viewport.height must be less than or equal to the maximum viewport height (${u.Z.maximumViewportHeight.toString()}).  Check maximumViewportHeight.`)}this.id=0,this._applyFunctions=[]}let g=0,Z={};function y(t,e,i){i?t.enable(e):t.disable(e)}function v(t,e){t.frontFace(e.frontFace)}function w(t,e){const i=e.cull,n=i.enabled;y(t,t.CULL_FACE,n),n&&t.cullFace(i.face)}function T(t,e){t.lineWidth(e.lineWidth)}function b(t,e){const i=e.polygonOffset,n=i.enabled;y(t,t.POLYGON_OFFSET_FILL,n),n&&t.polygonOffset(i.factor,i.units)}function E(t,e,i){const n=e.scissorTest,r=(0,s.Z)(i.scissorTest)?i.scissorTest.enabled:n.enabled;if(y(t,t.SCISSOR_TEST,r),r){const e=(0,s.Z)(i.scissorTest)?i.scissorTest.rectangle:n.rectangle;t.scissor(e.x,e.y,e.width,e.height)}}function x(t,e){const i=e.depthRange;t.depthRange(i.near,i.far)}function A(t,e){const i=e.depthTest,n=i.enabled;y(t,t.DEPTH_TEST,n),n&&t.depthFunc(i.func)}function C(t,e){const i=e.colorMask;t.colorMask(i.red,i.green,i.blue,i.alpha)}function S(t,e){t.depthMask(e.depthMask)}function D(t,e){t.stencilMask(e.stencilMask)}function P(t,e,i){const n=e.blending,r=(0,s.Z)(i.blendingEnabled)?i.blendingEnabled:n.enabled;y(t,t.BLEND,r),r&&(!function(t,e){t.blendColor(e.red,e.green,e.blue,e.alpha)}(t,n.color),t.blendEquationSeparate(n.equationRgb,n.equationAlpha),t.blendFuncSeparate(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha))}function O(t,e){const i=e.stencilTest,n=i.enabled;if(y(t,t.STENCIL_TEST,n),n){const e=i.frontFunction,n=i.backFunction,r=i.reference,o=i.mask;t.stencilFunc(e,r,o),t.stencilFuncSeparate(t.BACK,n,r,o),t.stencilFuncSeparate(t.FRONT,e,r,o);const s=i.frontOperation,a=s.fail,h=s.zFail,l=s.zPass;t.stencilOpSeparate(t.FRONT,a,h,l);const u=i.backOperation,c=u.fail,d=u.zFail,f=u.zPass;t.stencilOpSeparate(t.BACK,c,d,f)}}function I(t,e){const i=e.sampleCoverage,n=i.enabled;y(t,t.SAMPLE_COVERAGE,n),n&&t.sampleCoverage(i.value,i.invert)}m.fromCache=function(t){const e=JSON.stringify(t);let i=Z[e];if((0,s.Z)(i))return++i.referenceCount,i.state;let n=new m(t);const r=JSON.stringify(n);return i=Z[r],(0,s.Z)(i)||(n.id=g++,n=(0,c.Z)(n),i={referenceCount:0,state:n},Z[r]=i),++i.referenceCount,Z[e]={referenceCount:1,state:i.state},i.state},m.removeFromCache=function(t){const e=new m(t),i=JSON.stringify(e),n=Z[i],r=JSON.stringify(t),o=Z[r];(0,s.Z)(o)&&(--o.referenceCount,0===o.referenceCount&&(delete Z[r],(0,s.Z)(n)&&--n.referenceCount)),(0,s.Z)(n)&&0===n.referenceCount&&delete Z[i]},m.getCache=function(){return Z},m.clearCache=function(){Z={}};const F=new n.Z;function R(t,e,i){let n=(0,o.Z)(e.viewport,i.viewport);(0,s.Z)(n)||(n=F,n.width=i.context.drawingBufferWidth,n.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=n,t.viewport(n.x,n.y,n.width,n.height)}m.apply=function(t,e,i){v(t,e),w(t,e),T(t,e),b(t,e),x(t,e),A(t,e),C(t,e),S(t,e),D(t,e),O(t,e),I(t,e),E(t,e,i),P(t,e,i),R(t,e,i)},m.partialApply=function(t,e,i,n,r,o){if(e!==i){let n=i._applyFunctions[e.id];(0,s.Z)(n)||(n=function(t,e){const i=[];return t.frontFace!==e.frontFace&&i.push(v),t.cull.enabled===e.cull.enabled&&t.cull.face===e.cull.face||i.push(w),t.lineWidth!==e.lineWidth&&i.push(T),t.polygonOffset.enabled===e.polygonOffset.enabled&&t.polygonOffset.factor===e.polygonOffset.factor&&t.polygonOffset.units===e.polygonOffset.units||i.push(b),t.depthRange.near===e.depthRange.near&&t.depthRange.far===e.depthRange.far||i.push(x),t.depthTest.enabled===e.depthTest.enabled&&t.depthTest.func===e.depthTest.func||i.push(A),t.colorMask.red===e.colorMask.red&&t.colorMask.green===e.colorMask.green&&t.colorMask.blue===e.colorMask.blue&&t.colorMask.alpha===e.colorMask.alpha||i.push(C),t.depthMask!==e.depthMask&&i.push(S),t.stencilMask!==e.stencilMask&&i.push(D),t.stencilTest.enabled===e.stencilTest.enabled&&t.stencilTest.frontFunction===e.stencilTest.frontFunction&&t.stencilTest.backFunction===e.stencilTest.backFunction&&t.stencilTest.reference===e.stencilTest.reference&&t.stencilTest.mask===e.stencilTest.mask&&t.stencilTest.frontOperation.fail===e.stencilTest.frontOperation.fail&&t.stencilTest.frontOperation.zFail===e.stencilTest.frontOperation.zFail&&t.stencilTest.backOperation.fail===e.stencilTest.backOperation.fail&&t.stencilTest.backOperation.zFail===e.stencilTest.backOperation.zFail&&t.stencilTest.backOperation.zPass===e.stencilTest.backOperation.zPass||i.push(O),t.sampleCoverage.enabled===e.sampleCoverage.enabled&&t.sampleCoverage.value===e.sampleCoverage.value&&t.sampleCoverage.invert===e.sampleCoverage.invert||i.push(I),i}(e,i),i._applyFunctions[e.id]=n);const r=n.length;for(let e=0;e<r;++e)n[e](t,i)}(((0,s.Z)(n.scissorTest)?n.scissorTest:e.scissorTest)!==((0,s.Z)(r.scissorTest)?r.scissorTest:i.scissorTest)||o)&&E(t,i,r);const a=(0,s.Z)(n.blendingEnabled)?n.blendingEnabled:e.blending.enabled,h=(0,s.Z)(r.blendingEnabled)?r.blendingEnabled:i.blending.enabled;(a!==h||h&&e.blending!==i.blending)&&P(t,i,r),e===i&&n===r&&n.context===r.context||R(t,i,r)},m.getState=function(t){if(!(0,s.Z)(t))throw new a.Z("renderState is required.");return{frontFace:t.frontFace,cull:{enabled:t.cull.enabled,face:t.cull.face},lineWidth:t.lineWidth,polygonOffset:{enabled:t.polygonOffset.enabled,factor:t.polygonOffset.factor,units:t.polygonOffset.units},scissorTest:{enabled:t.scissorTest.enabled,rectangle:n.Z.clone(t.scissorTest.rectangle)},depthRange:{near:t.depthRange.near,far:t.depthRange.far},depthTest:{enabled:t.depthTest.enabled,func:t.depthTest.func},colorMask:{red:t.colorMask.red,green:t.colorMask.green,blue:t.colorMask.blue,alpha:t.colorMask.alpha},depthMask:t.depthMask,stencilMask:t.stencilMask,blending:{enabled:t.blending.enabled,color:r.Z.clone(t.blending.color),equationRgb:t.blending.equationRgb,equationAlpha:t.blending.equationAlpha,functionSourceRgb:t.blending.functionSourceRgb,functionSourceAlpha:t.blending.functionSourceAlpha,functionDestinationRgb:t.blending.functionDestinationRgb,functionDestinationAlpha:t.blending.functionDestinationAlpha},stencilTest:{enabled:t.stencilTest.enabled,frontFunction:t.stencilTest.frontFunction,backFunction:t.stencilTest.backFunction,reference:t.stencilTest.reference,mask:t.stencilTest.mask,frontOperation:{fail:t.stencilTest.frontOperation.fail,zFail:t.stencilTest.frontOperation.zFail,zPass:t.stencilTest.frontOperation.zPass},backOperation:{fail:t.stencilTest.backOperation.fail,zFail:t.stencilTest.backOperation.zFail,zPass:t.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:t.sampleCoverage.enabled,value:t.sampleCoverage.value,invert:t.sampleCoverage.invert},viewport:(0,s.Z)(t.viewport)?n.Z.clone(t.viewport):void 0}};const L=m},29825:(t,e,i)=>{i.d(e,{Z:()=>c});var n=i(17497),r=i(88779),o=i(54485),s=i(90332),a=i(20176),h=i(85834),l=i(88573);function u(t){t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context);const e=t.context._gl,i=h.Z.maximumRenderbufferSize,s=(0,r.Z)(t.format,l.Z.RGBA4),u=(0,o.Z)(t.width)?t.width:e.drawingBufferWidth,c=(0,o.Z)(t.height)?t.height:e.drawingBufferHeight,d=(0,r.Z)(t.numSamples,1);if(!l.Z.validate(s))throw new a.Z("Invalid format.");if(n.Z.typeOf.number.greaterThan("width",u,0),u>i)throw new a.Z(`Width must be less than or equal to the maximum renderbuffer size (${i}).  Check maximumRenderbufferSize.`);if(n.Z.typeOf.number.greaterThan("height",c,0),c>i)throw new a.Z(`Height must be less than or equal to the maximum renderbuffer size (${i}).  Check maximumRenderbufferSize.`);this._gl=e,this._format=s,this._width=u,this._height=c,this._renderbuffer=this._gl.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this._renderbuffer),d>1?e.renderbufferStorageMultisample(e.RENDERBUFFER,d,s,u,c):e.renderbufferStorage(e.RENDERBUFFER,s,u,c),e.bindRenderbuffer(e.RENDERBUFFER,null)}Object.defineProperties(u.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),u.prototype._getRenderbuffer=function(){return this._renderbuffer},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),(0,s.Z)(this)};const c=u},88573:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={RGBA4:n.Z.RGBA4,RGBA8:n.Z.RGBA8,RGBA16F:n.Z.RGBA16F,RGBA32F:n.Z.RGBA32F,RGB5_A1:n.Z.RGB5_A1,RGB565:n.Z.RGB565,DEPTH_COMPONENT16:n.Z.DEPTH_COMPONENT16,STENCIL_INDEX8:n.Z.STENCIL_INDEX8,DEPTH_STENCIL:n.Z.DEPTH_STENCIL,DEPTH24_STENCIL8:n.Z.DEPTH24_STENCIL8,validate:function(t){return t===r.RGBA4||t===r.RGBA8||t===r.RGBA16F||t===r.RGBA32F||t===r.RGB5_A1||t===r.RGB565||t===r.DEPTH_COMPONENT16||t===r.STENCIL_INDEX8||t===r.DEPTH_STENCIL||t===r.DEPTH24_STENCIL8},getColorFormat:function(t){return t===n.Z.FLOAT?r.RGBA32F:t===n.Z.HALF_FLOAT_OES?r.RGBA16F:r.RGBA8}},o=Object.freeze(r)},28696:(t,e,i)=>{i.d(e,{Z:()=>c});var n=i(17497),r=i(88779),o=i(54485),s=i(20176),a=i(92106),h=i(48867),l=i(91373);function u(t){t=(0,r.Z)(t,r.Z.EMPTY_OBJECT);const e=(0,r.Z)(t.wrapS,l.Z.CLAMP_TO_EDGE),i=(0,r.Z)(t.wrapT,l.Z.CLAMP_TO_EDGE),u=(0,r.Z)(t.minificationFilter,h.Z.LINEAR),c=(0,r.Z)(t.magnificationFilter,a.Z.LINEAR),d=(0,o.Z)(t.maximumAnisotropy)?t.maximumAnisotropy:1;if(!l.Z.validate(e))throw new s.Z("Invalid sampler.wrapS.");if(!l.Z.validate(i))throw new s.Z("Invalid sampler.wrapT.");if(!h.Z.validate(u))throw new s.Z("Invalid sampler.minificationFilter.");if(!a.Z.validate(c))throw new s.Z("Invalid sampler.magnificationFilter.");n.Z.typeOf.number.greaterThanOrEquals("maximumAnisotropy",d,1),this._wrapS=e,this._wrapT=i,this._minificationFilter=u,this._magnificationFilter=c,this._maximumAnisotropy=d}Object.defineProperties(u.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),u.equals=function(t,e){return t===e||(0,o.Z)(t)&&(0,o.Z)(e)&&t._wrapS===e._wrapS&&t._wrapT===e._wrapT&&t._minificationFilter===e._minificationFilter&&t._magnificationFilter===e._magnificationFilter&&t._maximumAnisotropy===e._maximumAnisotropy},u.NEAREST=Object.freeze(new u({wrapS:l.Z.CLAMP_TO_EDGE,wrapT:l.Z.CLAMP_TO_EDGE,minificationFilter:h.Z.NEAREST,magnificationFilter:a.Z.NEAREST}));const c=u},63452:(t,e,i)=>{i.d(e,{Z:()=>f});var n=i(17497),r=i(55077),o=i(54485),s=i(88779),a=i(20176),h=i(83567),l=i(17426),u=i(7048),c=i(2442),d=i(9755);function f(){this._positionAttributeLine=void 0,this._nextAttributeLocation=1,this._attributeLocations={},this._attributeLines=[],this._structs={},this._functions={},this._vertexShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]},this._fragmentShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]}}Object.defineProperties(f.prototype,{attributeLocations:{get:function(){return this._attributeLocations}}}),f.prototype.addDefine=function(t,e,i){n.Z.typeOf.string("identifier",t),i=(0,s.Z)(i,h.Z.BOTH);let r=t;(0,o.Z)(e)&&(r+=` ${e.toString()}`),h.Z.includesVertexShader(i)&&this._vertexShaderParts.defineLines.push(r),h.Z.includesFragmentShader(i)&&this._fragmentShaderParts.defineLines.push(r)},f.prototype.addStruct=function(t,e,i){n.Z.typeOf.string("structId",t),n.Z.typeOf.string("structName",e),n.Z.typeOf.number("destination",i),this._structs[t]=new c.Z(e),h.Z.includesVertexShader(i)&&this._vertexShaderParts.structIds.push(t),h.Z.includesFragmentShader(i)&&this._fragmentShaderParts.structIds.push(t)},f.prototype.addStructField=function(t,e,i){n.Z.typeOf.string("structId",t),n.Z.typeOf.string("type",e),n.Z.typeOf.string("identifier",i),this._structs[t].addField(e,i)},f.prototype.addFunction=function(t,e,i){n.Z.typeOf.string("functionName",t),n.Z.typeOf.string("signature",e),n.Z.typeOf.number("destination",i),this._functions[t]=new d.Z(e),h.Z.includesVertexShader(i)&&this._vertexShaderParts.functionIds.push(t),h.Z.includesFragmentShader(i)&&this._fragmentShaderParts.functionIds.push(t)},f.prototype.addFunctionLines=function(t,e){n.Z.typeOf.string("functionName",t),n.Z.typeOf.object("lines",e),this._functions[t].addLines(e)},f.prototype.addUniform=function(t,e,i){n.Z.typeOf.string("type",t),n.Z.typeOf.string("identifier",e),i=(0,s.Z)(i,h.Z.BOTH);const r=`uniform ${t} ${e};`;h.Z.includesVertexShader(i)&&this._vertexShaderParts.uniformLines.push(r),h.Z.includesFragmentShader(i)&&this._fragmentShaderParts.uniformLines.push(r)},f.prototype.setPositionAttribute=function(t,e){if(n.Z.typeOf.string("type",t),n.Z.typeOf.string("identifier",e),(0,o.Z)(this._positionAttributeLine))throw new a.Z("setPositionAttribute() must be called exactly once for the attribute used for gl_Position. For other attributes, use addAttribute()");return this._positionAttributeLine=`attribute ${t} ${e};`,this._attributeLocations[e]=0,0},f.prototype.addAttribute=function(t,e){n.Z.typeOf.string("type",t),n.Z.typeOf.string("identifier",e);const i=`attribute ${t} ${e};`;this._attributeLines.push(i);const r=this._nextAttributeLocation;return this._attributeLocations[e]=r,this._nextAttributeLocation+=function(t){switch(t){case"mat2":return 2;case"mat3":return 3;case"mat4":return 4;default:return 1}}(t),r},f.prototype.addVarying=function(t,e){n.Z.typeOf.string("type",t),n.Z.typeOf.string("identifier",e);const i=`varying ${t} ${e};`;this._vertexShaderParts.varyingLines.push(i),this._fragmentShaderParts.varyingLines.push(i)},f.prototype.addVertexLines=function(t){n.Z.typeOf.object("lines",t),Array.prototype.push.apply(this._vertexShaderParts.shaderLines,t)},f.prototype.addFragmentLines=function(t){n.Z.typeOf.object("lines",t),Array.prototype.push.apply(this._fragmentShaderParts.shaderLines,t)},f.prototype.buildShaderProgram=function(t){n.Z.typeOf.object("context",t);const e=(0,o.Z)(this._positionAttributeLine)?[this._positionAttributeLine]:[],i=function(t){const e=[],i=[];let n,r,o,s,a=t._vertexShaderParts.structIds;for(n=0;n<a.length;n++)r=a[n],o=t._structs[r],s=o.generateGlslLines(),e.push.apply(e,s);for(a=t._fragmentShaderParts.structIds,n=0;n<a.length;n++)r=a[n],o=t._structs[r],s=o.generateGlslLines(),i.push.apply(i,s);return{vertexLines:e,fragmentLines:i}}(this),r=function(t){const e=[],i=[];let n,r,o,s,a=t._vertexShaderParts.functionIds;for(n=0;n<a.length;n++)r=a[n],o=t._functions[r],s=o.generateGlslLines(),e.push.apply(e,s);for(a=t._fragmentShaderParts.functionIds,n=0;n<a.length;n++)r=a[n],o=t._functions[r],s=o.generateGlslLines(),i.push.apply(i,s);return{vertexLines:e,fragmentLines:i}}(this),s=e.concat(this._attributeLines,this._vertexShaderParts.uniformLines,this._vertexShaderParts.varyingLines,i.vertexLines,r.vertexLines,this._vertexShaderParts.shaderLines).join("\n"),a=new u.Z({defines:this._vertexShaderParts.defineLines,sources:[s]}),h=this._fragmentShaderParts.uniformLines.concat(this._fragmentShaderParts.varyingLines,i.fragmentLines,r.fragmentLines,this._fragmentShaderParts.shaderLines).join("\n"),c=new u.Z({defines:this._fragmentShaderParts.defineLines,sources:[h]});return l.Z.fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:this._attributeLocations})},f.prototype.clone=function(){return(0,r.Z)(this,!0)}},48865:(t,e,i)=>{i.d(e,{Z:()=>l});var n=i(54485),r=i(90332),o=i(17426),s=i(7048);function a(t){this._context=t,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function h(t,e){const i=e.derivedKeywords,n=i.length;for(let r=0;r<n;++r){const n=i[r]+e.keyword;h(t,t._shaders[n])}delete t._shaders[e.keyword],e.shaderProgram.finalDestroy()}Object.defineProperties(a.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),a.prototype.replaceShaderProgram=function(t){return(0,n.Z)(t.shaderProgram)&&t.shaderProgram.destroy(),this.getShaderProgram(t)},a.prototype.getShaderProgram=function(t){let e=t.vertexShaderSource,i=t.fragmentShaderSource;const r=t.attributeLocations;"string"==typeof e&&(e=new s.Z({sources:[e]})),"string"==typeof i&&(i=new s.Z({sources:[i]}));const a=e.createCombinedVertexShader(this._context),h=i.createCombinedFragmentShader(this._context),l=a+h+JSON.stringify(r);let u;if((0,n.Z)(this._shaders[l]))u=this._shaders[l],delete this._shadersToRelease[l];else{const t=this._context,n=new o.Z({gl:t._gl,logShaderCompilation:t.logShaderCompilation,debugShaders:t.debugShaders,vertexShaderSource:e,vertexShaderText:a,fragmentShaderSource:i,fragmentShaderText:h,attributeLocations:r});u={cache:this,shaderProgram:n,keyword:l,derivedKeywords:[],count:0},n._cachedShader=u,this._shaders[l]=u,++this._numberOfShaders}return++u.count,u.shaderProgram},a.prototype.replaceDerivedShaderProgram=function(t,e,i){const r=t._cachedShader,o=e+r.keyword,s=this._shaders[o];if((0,n.Z)(s)){h(this,s);const t=r.derivedKeywords.indexOf(e);t>-1&&r.derivedKeywords.splice(t,1)}return this.createDerivedShaderProgram(t,e,i)},a.prototype.getDerivedShaderProgram=function(t,e){const i=e+t._cachedShader.keyword,r=this._shaders[i];if((0,n.Z)(r))return r.shaderProgram},a.prototype.createDerivedShaderProgram=function(t,e,i){const n=t._cachedShader,r=e+n.keyword;let a=i.vertexShaderSource,h=i.fragmentShaderSource;const l=i.attributeLocations;"string"==typeof a&&(a=new s.Z({sources:[a]})),"string"==typeof h&&(h=new s.Z({sources:[h]}));const u=this._context,c=a.createCombinedVertexShader(u),d=h.createCombinedFragmentShader(u),f=new o.Z({gl:u._gl,logShaderCompilation:u.logShaderCompilation,debugShaders:u.debugShaders,vertexShaderSource:a,vertexShaderText:c,fragmentShaderSource:h,fragmentShaderText:d,attributeLocations:l}),p={cache:this,shaderProgram:f,keyword:r,derivedKeywords:[],count:0};return n.derivedKeywords.push(e),f._cachedShader=p,this._shaders[r]=p,f},a.prototype.destroyReleasedShaderPrograms=function(){const t=this._shadersToRelease;for(const e in t)if(t.hasOwnProperty(e)){h(this,t[e]),--this._numberOfShaders}this._shadersToRelease={}},a.prototype.releaseShaderProgram=function(t){if((0,n.Z)(t)){const e=t._cachedShader;e&&0==--e.count&&(this._shadersToRelease[e.keyword]=e)}},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){const t=this._shaders;for(const e in t)t.hasOwnProperty(e)&&t[e].shaderProgram.finalDestroy();return(0,r.Z)(this)};const l=a},83567:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(17497);const r={VERTEX:0,FRAGMENT:1,BOTH:2,includesVertexShader:function(t){return n.Z.typeOf.number("destination",t),t===r.VERTEX||t===r.BOTH},includesFragmentShader:function(t){return n.Z.typeOf.number("destination",t),t===r.FRAGMENT||t===r.BOTH}},o=Object.freeze(r)},9755:(t,e,i)=>{function n(t){this.signature=t,this.body=[]}i.d(e,{Z:()=>n}),n.prototype.addLines=function(t){const e=t.map((function(t){return`    ${t}`}));Array.prototype.push.apply(this.body,e)},n.prototype.generateGlslLines=function(){return[].concat(this.signature,"{",this.body,"}")}},17426:(t,e,i)=>{i.d(e,{Z:()=>Z});var n=i(17497),r=i(88779),o=i(54485),s=i(90332),a=i(20176),h=i(21514),l=i(6421),u=i(85834),c=i(21398),d=i(53790);let f=0;function p(t){let e=t.vertexShaderText,i=t.fragmentShaderText;"undefined"!=typeof spector&&(e=e.replace(/^#line/gm,"//#line"),i=i.replace(/^#line/gm,"//#line"));const n=function(t,e){const i={};if(!u.Z.highpFloatSupported||!u.Z.highpIntSupported){let n,r,o,s;const a=_(t),h=_(e),l=a.length,u=h.length;for(n=0;n<l;n++)for(r=0;r<u;r++)if(a[n]===h[r]){o=a[n],s=`czm_mediump_${o}`;const t=new RegExp(`${o}\\b`,"g");e=e.replace(t,s),i[s]=o}}return{fragmentShaderText:e,duplicateUniformNames:i}}(e,i);this._gl=t.gl,this._logShaderCompilation=t.logShaderCompilation,this._debugShaders=t.debugShaders,this._attributeLocations=t.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=n.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=t.vertexShaderSource,this._vertexShaderText=t.vertexShaderText,this._fragmentShaderSource=t.fragmentShaderSource,this._fragmentShaderText=n.fragmentShaderText,this.id=f++}function _(t){const e=[],i=t.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if((0,o.Z)(i)){const t=i.length;for(let n=0;n<t;n++){const t=i[n].trim(),r=t.slice(t.lastIndexOf(" ")+1);e.push(r)}}return e}p.fromCache=function(t){return t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context),t.context.shaderCache.getShaderProgram(t)},p.replaceCache=function(t){return t=(0,r.Z)(t,r.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context),t.context.shaderCache.replaceShaderProgram(t)},Object.defineProperties(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return m(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return m(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return m(this),this._uniformsByName}}});function m(t){(0,o.Z)(t._program)||g(t)}function g(t){const e=t._program,i=t._gl,n=function(t,e){const i=e._vertexShaderText,n=e._fragmentShaderText,r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,i),t.compileShader(r);const s=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(s,n),t.compileShader(s);const a=t.createProgram();t.attachShader(a,r),t.attachShader(a,s),t.deleteShader(r),t.deleteShader(s);const l=e._attributeLocations;if((0,o.Z)(l))for(const e in l)l.hasOwnProperty(e)&&t.bindAttribLocation(a,l[e],e);let u;if(t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS)){const i=e._debugShaders;if(!t.getShaderParameter(s,t.COMPILE_STATUS))throw u=t.getShaderInfoLog(s),(0,o.Z)(i)&&i.getTranslatedShaderSource(s),t.deleteProgram(a),new h.Z(`Fragment shader failed to compile.  Compile log: ${u}`);if(!t.getShaderParameter(r,t.COMPILE_STATUS))throw u=t.getShaderInfoLog(r),(0,o.Z)(i)&&i.getTranslatedShaderSource(r),t.deleteProgram(a),new h.Z(`Vertex shader failed to compile.  Compile log: ${u}`);throw u=t.getProgramInfoLog(a),(0,o.Z)(i),t.deleteProgram(a),new h.Z(`Program failed to link.  Link log: ${u}`)}const c=e._logShaderCompilation;return c&&(u=t.getShaderInfoLog(r),(0,o.Z)(u)&&u.length),c&&(u=t.getShaderInfoLog(s),(0,o.Z)(u)&&u.length),c&&(u=t.getProgramInfoLog(a),(0,o.Z)(u)&&u.length),a}(i,t,t._debugShaders),r=i.getProgramParameter(n,i.ACTIVE_ATTRIBUTES),s=function(t,e){const i={},n=[],r=[],s=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let a=0;a<s;++a){const s=t.getActiveUniform(e,a),h="[0]",l=-1!==s.name.indexOf(h,s.name.length-h.length)?s.name.slice(0,s.name.length-3):s.name;if(0!==l.indexOf("gl_"))if(s.name.indexOf("[")<0){const o=t.getUniformLocation(e,l);if(null!==o){const e=(0,c.Z)(t,s,l,o);i[l]=e,n.push(e),e._setSampler&&r.push(e)}}else{let a,h,u,c;const f=l.indexOf("[");if(f>=0){if(a=i[l.slice(0,f)],!(0,o.Z)(a))continue;h=a._locations,h.length<=1&&(u=a.value,c=t.getUniformLocation(e,l),null!==c&&(h.push(c),u.push(t.getUniform(e,c))))}else{h=[];for(let i=0;i<s.size;++i)c=t.getUniformLocation(e,`${l}[${i}]`),null!==c&&h.push(c);a=(0,d.Z)(t,s,l,h),i[l]=a,n.push(a),a._setSampler&&r.push(a)}}}return{uniformsByName:i,uniforms:n,samplerUniforms:r}}(i,n),a=function(t,e){const i=[],n=[];for(const r in e)if(e.hasOwnProperty(r)){const s=e[r];let a=r;const h=t._duplicateUniformNames[a];(0,o.Z)(h)&&(s.name=h,a=h);const u=l.Z[a];(0,o.Z)(u)?i.push({uniform:s,automaticUniform:u}):n.push(s)}return{automaticUniforms:i,manualUniforms:n}}(t,s.uniformsByName);t._program=n,t._numberOfVertexAttributes=r,t._vertexAttributes=function(t,e,i){const n={};for(let r=0;r<i;++r){const i=t.getActiveAttrib(e,r),o=t.getAttribLocation(e,i.name);n[i.name]={name:i.name,type:i.type,index:o}}return n}(i,n,r),t._uniformsByName=s.uniformsByName,t._uniforms=s.uniforms,t._automaticUniforms=a.automaticUniforms,t._manualUniforms=a.manualUniforms,t.maximumTextureUnitIndex=function(t,e,i){t.useProgram(e);let n=0;const r=i.length;for(let t=0;t<r;++t)n=i[t]._setSampler(n);return t.useProgram(null),n}(i,n,s.samplerUniforms),e&&t._gl.deleteProgram(e),"undefined"!=typeof spector&&(t._program.__SPECTOR_rebuildProgram=function(e,i,n,r){const o=t._vertexShaderText,s=t._fragmentShaderText,a=/ ! = /g;t._vertexShaderText=e.replace(a," != "),t._fragmentShaderText=i.replace(a," != ");try{g(t),n(t._program)}catch(e){t._vertexShaderText=o,t._fragmentShaderText=s;const i=/(?:Compile|Link) error: ([^]*)/.exec(e.message);r(i?i[1]:e.message)}})}p.prototype._bind=function(){m(this),this._gl.useProgram(this._program)},p.prototype._setUniforms=function(t,e,i){let n,r;if((0,o.Z)(t)){const e=this._manualUniforms;for(n=e.length,r=0;r<n;++r){const i=e[r];i.value=t[i.name]()}}const s=this._automaticUniforms;for(n=s.length,r=0;r<n;++r){const t=s[r];t.uniform.value=t.automaticUniform.getValue(e)}const h=this._uniforms;for(n=h.length,r=0;r<n;++r)h[r].set();if(i){const t=this._gl,e=this._program;if(t.validateProgram(e),!t.getProgramParameter(e,t.VALIDATE_STATUS))throw new a.Z(`Program validation failed.  Program info log: ${t.getProgramInfoLog(e)}`)}},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},p.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),(0,s.Z)(this)};const Z=p},7048:(t,e,i)=>{i.d(e,{Z:()=>y});var n=i(88779),r=i(54485),o=i(20176),s=i(7589),a=i(14191),h=i(6421);function l(t){return(t=t.replace(/\/\/.*/g,"")).replace(/\/\*\*[\s\S]*?\*\//gm,(function(t){const e=t.match(/\n/gm).length;let i="";for(let t=0;t<e;++t)i+="\n";return i}))}function u(t,e,i){let n;for(let e=0;e<i.length;++e)i[e].name===t&&(n=i[e]);return(0,r.Z)(n)||(n={name:t,glslSource:e=l(e),dependsOn:[],requiredBy:[],evaluated:!1},i.push(n)),n}function c(t,e){if(t.evaluated)return;t.evaluated=!0;let i=t.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);(0,r.Z)(i)&&null!==i&&(i=i.filter((function(t,e){return i.indexOf(t)===e})),i.forEach((function(i){if(i!==t.name&&p._czmBuiltinsAndUniforms.hasOwnProperty(i)){const n=u(i,p._czmBuiltinsAndUniforms[i],e);t.dependsOn.push(n),n.requiredBy.push(t),c(n,e)}})))}function d(t){const e=[],i=u("main",t,e);c(i,e),function(t){const e=[],i=[];for(;t.length>0;){const n=t.pop();i.push(n),0===n.requiredBy.length&&e.push(n)}for(;e.length>0;){const i=e.shift();t.push(i);for(let t=0;t<i.dependsOn.length;++t){const n=i.dependsOn[t],r=n.requiredBy.indexOf(i);n.requiredBy.splice(r,1),0===n.requiredBy.length&&e.push(n)}}const n=[];for(let t=0;t<i.length;++t)0!==i[t].requiredBy.length&&n.push(i[t]);if(0!==n.length){let t="A circular dependency was found in the following built-in functions/structs/constants: \n";for(let e=0;e<n.length;++e)t=`${t+n[e].name}\n`;throw new o.Z(t)}}(e);let n="";for(let t=e.length-1;t>=0;--t)n=`${n+e[t].glslSource}\n`;return n.replace(i.glslSource,"")}function f(t,e,i){let n,a,h="";const u=t.sources;if((0,r.Z)(u))for(n=0,a=u.length;n<a;++n)h+=`\n#line 0\n${u[n]}`;let c;h=l(h),h=h.replace(/#version\s+(.*?)\n/gm,(function(t,e){if((0,r.Z)(c)&&c!==e)throw new o.Z(`inconsistent versions found: ${c} and ${e}`);return c=e,"\n"}));const f=[];h=h.replace(/#extension.*\n/gm,(function(t){return f.push(t),"\n"})),h=h.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");const _=t.pickColorQualifier;(0,r.Z)(_)&&(h=p.createPickFragmentShaderSource(h,_));let m="";(0,r.Z)(c)&&(m=`#version ${c}\n`);const g=f.length;for(n=0;n<g;n++)m+=f[n];e&&(m+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    precision highp int;\n#else\n    precision mediump float;\n    precision mediump int;\n    #define highp mediump\n#endif\n\n");const Z=t.defines;if((0,r.Z)(Z))for(n=0,a=Z.length;n<a;++n){const t=Z[n];0!==t.length&&(m+=`#define ${t}\n`)}return i.webgl2&&(m+="#define OUTPUT_DECLARATION\n\n"),i.textureFloatLinear&&(m+="#define OES_texture_float_linear\n\n"),i.floatingPointTexture&&(m+="#define OES_texture_float\n\n"),t.includeBuiltIns&&(m+=d(h)),m+="\n#line 0\n",m+=h,i.webgl2&&(m=(0,s.Z)(m,e,!0)),m}function p(t){const e=(t=(0,n.Z)(t,n.Z.EMPTY_OBJECT)).pickColorQualifier;if((0,r.Z)(e)&&"uniform"!==e&&"varying"!==e)throw new o.Z("options.pickColorQualifier must be 'uniform' or 'varying'.");this.defines=(0,r.Z)(t.defines)?t.defines.slice(0):[],this.sources=(0,r.Z)(t.sources)?t.sources.slice(0):[],this.pickColorQualifier=e,this.includeBuiltIns=(0,n.Z)(t.includeBuiltIns,!0)}p.prototype.clone=function(){return new p({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},p.replaceMain=function(t,e){return e=`void ${e}()`,t.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,e)},p.prototype.createCombinedVertexShader=function(t){return f(this,!1,t)},p.prototype.createCombinedFragmentShader=function(t){return f(this,!0,t)},p._czmBuiltinsAndUniforms={};for(const t in a.Z)a.Z.hasOwnProperty(t)&&(p._czmBuiltinsAndUniforms[t]=a.Z[t]);for(const t in h.Z)if(h.Z.hasOwnProperty(t)){const e=h.Z[t];"function"==typeof e.getDeclaration&&(p._czmBuiltinsAndUniforms[t]=e.getDeclaration(t))}function _(t,e){const i=t.sources,n=i.length;for(let t=0;t<n;++t)if(-1!==i[t].indexOf(e))return!0;return!1}function m(t,e){const i=e.length;for(let n=0;n<i;++n){const i=e[n];if(_(t,i))return i}}p.createPickVertexShaderSource=function(t){return`${p.replaceMain(t,"czm_old_main")}\nattribute vec4 pickColor; \nvarying vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}`},p.createPickFragmentShaderSource=function(t,e){return`${p.replaceMain(t,"czm_old_main")}\n${`${e} vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (gl_FragColor.a == 0.0) { \n       discard; \n    } \n    gl_FragColor = czm_pickColor; \n}`}`};const g=["v_normalEC","v_normal"];p.findNormalVarying=function(t){return _(t,"#ifdef HAS_NORMALS")?_(t,"#define HAS_NORMALS")?"v_normalEC":void 0:m(t,g)};const Z=["v_positionEC"];p.findPositionVarying=function(t){return m(t,Z)};const y=p},2442:(t,e,i)=>{function n(t){this.name=t,this.fields=[]}i.d(e,{Z:()=>n}),n.prototype.addField=function(t,e){const i=`    ${t} ${e};`;this.fields.push(i)},n.prototype.generateGlslLines=function(){let t=this.fields;return 0===t.length&&(t=["    float _empty;"]),[].concat(`struct ${this.name}`,"{",t,"};")}},47334:(t,e,i)=>{i.d(e,{Z:()=>y});var n=i(59015),r=i(17497),o=i(93737),s=i(88779),a=i(54485),h=i(90332),l=i(20176),u=i(22874),c=i(91166),d=i(85834),f=i(22641),p=i(27400),_=i(28696),m=i(92106),g=i(48867);function Z(t){t=(0,s.Z)(t,s.Z.EMPTY_OBJECT),r.Z.defined("options.context",t.context);const e=t.context;let i=t.width,h=t.height;const u=t.source;(0,a.Z)(u)&&((0,a.Z)(i)||(i=(0,s.Z)(u.videoWidth,u.width)),(0,a.Z)(h)||(h=(0,s.Z)(u.videoHeight,u.height)));const f=(0,s.Z)(t.pixelFormat,c.Z.RGBA),m=(0,s.Z)(t.pixelDatatype,p.Z.UNSIGNED_BYTE),g=c.Z.toInternalFormat(f,m,e),Z=c.Z.isCompressedFormat(g);if(!(0,a.Z)(i)||!(0,a.Z)(h))throw new l.Z("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(r.Z.typeOf.number.greaterThan("width",i,0),i>d.Z.maximumTextureSize)throw new l.Z(`Width must be less than or equal to the maximum texture size (${d.Z.maximumTextureSize}).  Check maximumTextureSize.`);if(r.Z.typeOf.number.greaterThan("height",h,0),h>d.Z.maximumTextureSize)throw new l.Z(`Height must be less than or equal to the maximum texture size (${d.Z.maximumTextureSize}).  Check maximumTextureSize.`);if(!c.Z.validate(f))throw new l.Z("Invalid options.pixelFormat.");if(!Z&&!p.Z.validate(m))throw new l.Z("Invalid options.pixelDatatype.");if(f===c.Z.DEPTH_COMPONENT&&m!==p.Z.UNSIGNED_SHORT&&m!==p.Z.UNSIGNED_INT)throw new l.Z("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(f===c.Z.DEPTH_STENCIL&&m!==p.Z.UNSIGNED_INT_24_8)throw new l.Z("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(m===p.Z.FLOAT&&!e.floatingPointTexture)throw new l.Z("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(m===p.Z.HALF_FLOAT&&!e.halfFloatingPointTexture)throw new l.Z("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(c.Z.isDepthFormat(f)){if((0,a.Z)(u))throw new l.Z("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!e.depthTexture)throw new l.Z("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(Z){if(!(0,a.Z)(u)||!(0,a.Z)(u.arrayBufferView))throw new l.Z("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.");if(c.Z.isDXTFormat(g)&&!e.s3tc)throw new l.Z("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_compressed_texture_s3tc extension. Check context.s3tc.");if(c.Z.isPVRTCFormat(g)&&!e.pvrtc)throw new l.Z("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_compressed_texture_pvrtc extension. Check context.pvrtc.");if(c.Z.isASTCFormat(g)&&!e.astc)throw new l.Z("When options.pixelFormat is ASTC compressed, this WebGL implementation must support the WEBGL_compressed_texture_astc extension. Check context.astc.");if(c.Z.isETC2Format(g)&&!e.etc)throw new l.Z("When options.pixelFormat is ETC2 compressed, this WebGL implementation must support the WEBGL_compressed_texture_etc extension. Check context.etc.");if(c.Z.isETC1Format(g)&&!e.etc1)throw new l.Z("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_compressed_texture_etc1 extension. Check context.etc1.");if(c.Z.isBC7Format(g)&&!e.bc7)throw new l.Z("When options.pixelFormat is BC7 compressed, this WebGL implementation must support the EXT_texture_compression_bptc extension. Check context.bc7.");if(c.Z.compressedTextureSizeInBytes(g,i,h)!==u.arrayBufferView.byteLength)throw new l.Z("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}const y=t.preMultiplyAlpha||f===c.Z.RGB||f===c.Z.LUMINANCE,v=(0,s.Z)(t.flipY,!0),w=(0,s.Z)(t.skipColorSpaceConversion,!1);let T=!0;const b=e._gl,E=b.TEXTURE_2D,x=b.createTexture();b.activeTexture(b.TEXTURE0),b.bindTexture(E,x);let A,C=4;if((0,a.Z)(u)&&(0,a.Z)(u.arrayBufferView)&&!Z&&(C=c.Z.alignmentInBytes(f,m,i)),b.pixelStorei(b.UNPACK_ALIGNMENT,C),w?b.pixelStorei(b.UNPACK_COLORSPACE_CONVERSION_WEBGL,b.NONE):b.pixelStorei(b.UNPACK_COLORSPACE_CONVERSION_WEBGL,b.BROWSER_DEFAULT_WEBGL),(0,a.Z)(u))if((0,a.Z)(u.arrayBufferView)){b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);let t,n,r,o=u.arrayBufferView;if(Z){if(b.compressedTexImage2D(E,0,g,i,h,0,o),(0,a.Z)(u.mipLevels))for(n=i,r=h,t=0;t<u.mipLevels.length;++t)n=0|Math.floor(n/2),n<1&&(n=1),r=0|Math.floor(r/2),r<1&&(r=1),b.compressedTexImage2D(E,t+1,g,n,r,0,u.mipLevels[t])}else if(v&&(o=c.Z.flipY(o,f,m,i,h)),b.texImage2D(E,0,g,i,h,0,f,p.Z.toWebGLConstant(m,e),o),(0,a.Z)(u.mipLevels))for(n=i,r=h,t=0;t<u.mipLevels.length;++t)n=0|Math.floor(n/2),n<1&&(n=1),r=0|Math.floor(r/2),r<1&&(r=1),b.texImage2D(E,t+1,g,n,r,0,f,p.Z.toWebGLConstant(m,e),u.mipLevels[t])}else(0,a.Z)(u.framebuffer)?(b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),u.framebuffer!==e.defaultFramebuffer&&u.framebuffer._bind(),b.copyTexImage2D(E,0,g,u.xOffset,u.yOffset,i,h,0),u.framebuffer!==e.defaultFramebuffer&&u.framebuffer._unBind()):(b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,v),b.texImage2D(E,0,g,f,p.Z.toWebGLConstant(m,e),u));else b.texImage2D(E,0,g,i,h,0,f,p.Z.toWebGLConstant(m,e),null),T=!1;b.bindTexture(E,null),A=Z?c.Z.compressedTextureSizeInBytes(f,i,h):c.Z.textureSizeInBytes(f,m,i,h),this._id=(0,o.Z)(),this._context=e,this._textureFilterAnisotropic=e._textureFilterAnisotropic,this._textureTarget=E,this._texture=x,this._internalFormat=g,this._pixelFormat=f,this._pixelDatatype=m,this._width=i,this._height=h,this._dimensions=new n.Z(i,h),this._hasMipmap=!1,this._sizeInBytes=A,this._preMultiplyAlpha=y,this._flipY=v,this._initialized=T,this._sampler=void 0,this.sampler=(0,a.Z)(t.sampler)?t.sampler:new _.Z}Z.create=function(t){return new Z(t)},Z.fromFramebuffer=function(t){t=(0,s.Z)(t,s.Z.EMPTY_OBJECT),r.Z.defined("options.context",t.context);const e=t.context,i=e._gl,n=(0,s.Z)(t.pixelFormat,c.Z.RGB),o=(0,s.Z)(t.framebufferXOffset,0),h=(0,s.Z)(t.framebufferYOffset,0),u=(0,s.Z)(t.width,i.drawingBufferWidth),d=(0,s.Z)(t.height,i.drawingBufferHeight),f=t.framebuffer;if(!c.Z.validate(n))throw new l.Z("Invalid pixelFormat.");if(c.Z.isDepthFormat(n)||c.Z.isCompressedFormat(n))throw new l.Z("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(r.Z.defined("options.context",t.context),r.Z.typeOf.number.greaterThanOrEquals("framebufferXOffset",o,0),r.Z.typeOf.number.greaterThanOrEquals("framebufferYOffset",h,0),o+u>i.drawingBufferWidth)throw new l.Z("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(h+d>i.drawingBufferHeight)throw new l.Z("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new Z({context:e,width:u,height:d,pixelFormat:n,source:{framebuffer:(0,a.Z)(f)?f:e.defaultFramebuffer,xOffset:o,yOffset:h,width:u,height:d}})},Object.defineProperties(Z.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(t){let e=t.minificationFilter,i=t.magnificationFilter;const n=this._context,r=this._pixelFormat,o=this._pixelDatatype,s=e===g.Z.NEAREST_MIPMAP_NEAREST||e===g.Z.NEAREST_MIPMAP_LINEAR||e===g.Z.LINEAR_MIPMAP_NEAREST||e===g.Z.LINEAR_MIPMAP_LINEAR;(o===p.Z.FLOAT&&!n.textureFloatLinear||o===p.Z.HALF_FLOAT&&!n.textureHalfFloatLinear)&&(e=s?g.Z.NEAREST_MIPMAP_NEAREST:g.Z.NEAREST,i=m.Z.NEAREST),n.webgl2&&c.Z.isDepthFormat(r)&&(e=g.Z.NEAREST,i=m.Z.NEAREST);const h=n._gl,l=this._textureTarget;h.activeTexture(h.TEXTURE0),h.bindTexture(l,this._texture),h.texParameteri(l,h.TEXTURE_MIN_FILTER,e),h.texParameteri(l,h.TEXTURE_MAG_FILTER,i),h.texParameteri(l,h.TEXTURE_WRAP_S,t.wrapS),h.texParameteri(l,h.TEXTURE_WRAP_T,t.wrapT),(0,a.Z)(this._textureFilterAnisotropic)&&h.texParameteri(l,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),h.bindTexture(l,null),this._sampler=t}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),Z.prototype.copyFrom=function(t){r.Z.defined("options",t);const e=(0,s.Z)(t.xOffset,0),i=(0,s.Z)(t.yOffset,0);if(r.Z.defined("options.source",t.source),c.Z.isDepthFormat(this._pixelFormat))throw new l.Z("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(c.Z.isCompressedFormat(this._pixelFormat))throw new l.Z("Cannot call copyFrom with a compressed texture pixel format.");r.Z.typeOf.number.greaterThanOrEquals("xOffset",e,0),r.Z.typeOf.number.greaterThanOrEquals("yOffset",i,0),r.Z.typeOf.number.lessThanOrEquals("xOffset + options.source.width",e+t.source.width,this._width),r.Z.typeOf.number.lessThanOrEquals("yOffset + options.source.height",i+t.source.height,this._height);const n=t.source,o=this._context,h=o._gl,u=this._textureTarget;h.activeTexture(h.TEXTURE0),h.bindTexture(u,this._texture);const d=n.width,f=n.height;let _=n.arrayBufferView;const m=this._width,g=this._height,Z=this._internalFormat,y=this._pixelFormat,v=this._pixelDatatype,w=this._preMultiplyAlpha,T=this._flipY,b=(0,s.Z)(t.skipColorSpaceConversion,!1);let E=4;(0,a.Z)(_)&&(E=c.Z.alignmentInBytes(y,v,d)),h.pixelStorei(h.UNPACK_ALIGNMENT,E),b?h.pixelStorei(h.UNPACK_COLORSPACE_CONVERSION_WEBGL,h.NONE):h.pixelStorei(h.UNPACK_COLORSPACE_CONVERSION_WEBGL,h.BROWSER_DEFAULT_WEBGL);let x=!1;if(!this._initialized){if(0===e&&0===i&&d===m&&f===g)(0,a.Z)(_)?(h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!1),T&&(_=c.Z.flipY(_,y,v,m,g)),h.texImage2D(u,0,Z,m,g,0,y,p.Z.toWebGLConstant(v,o),_)):(h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,T),h.texImage2D(u,0,Z,y,p.Z.toWebGLConstant(v,o),n)),x=!0;else{h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!1);const t=c.Z.createTypedArray(y,v,m,g);h.texImage2D(u,0,Z,m,g,0,y,p.Z.toWebGLConstant(v,o),t)}this._initialized=!0}x||((0,a.Z)(_)?(h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!1),T&&(_=c.Z.flipY(_,y,v,d,f)),h.texSubImage2D(u,0,e,i,d,f,y,p.Z.toWebGLConstant(v,o),_)):(h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,T),h.texSubImage2D(u,0,e,i,y,p.Z.toWebGLConstant(v,o),n))),h.bindTexture(u,null)},Z.prototype.copyFromFramebuffer=function(t,e,i,n,o,a){if(t=(0,s.Z)(t,0),e=(0,s.Z)(e,0),i=(0,s.Z)(i,0),n=(0,s.Z)(n,0),o=(0,s.Z)(o,this._width),a=(0,s.Z)(a,this._height),c.Z.isDepthFormat(this._pixelFormat))throw new l.Z("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===p.Z.FLOAT)throw new l.Z("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===p.Z.HALF_FLOAT)throw new l.Z("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");if(c.Z.isCompressedFormat(this._pixelFormat))throw new l.Z("Cannot call copyFrom with a compressed texture pixel format.");r.Z.typeOf.number.greaterThanOrEquals("xOffset",t,0),r.Z.typeOf.number.greaterThanOrEquals("yOffset",e,0),r.Z.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),r.Z.typeOf.number.greaterThanOrEquals("framebufferYOffset",n,0),r.Z.typeOf.number.lessThanOrEquals("xOffset + width",t+o,this._width),r.Z.typeOf.number.lessThanOrEquals("yOffset + height",e+a,this._height);const h=this._context._gl,u=this._textureTarget;h.activeTexture(h.TEXTURE0),h.bindTexture(u,this._texture),h.copyTexSubImage2D(u,0,t,e,i,n,o,a),h.bindTexture(u,null),this._initialized=!0},Z.prototype.generateMipmap=function(t){if(t=(0,s.Z)(t,f.Z.DONT_CARE),c.Z.isDepthFormat(this._pixelFormat))throw new l.Z("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(c.Z.isCompressedFormat(this._pixelFormat))throw new l.Z("Cannot call generateMipmap with a compressed pixel format.");if(this._width>1&&!u.Z.isPowerOfTwo(this._width))throw new l.Z("width must be a power of two to call generateMipmap().");if(this._height>1&&!u.Z.isPowerOfTwo(this._height))throw new l.Z("height must be a power of two to call generateMipmap().");if(!f.Z.validate(t))throw new l.Z("hint is invalid.");this._hasMipmap=!0;const e=this._context._gl,i=this._textureTarget;e.hint(e.GENERATE_MIPMAP_HINT,t),e.activeTexture(e.TEXTURE0),e.bindTexture(i,this._texture),e.generateMipmap(i),e.bindTexture(i,null)},Z.prototype.isDestroyed=function(){return!1},Z.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),(0,h.Z)(this)};const y=Z},86397:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(54485),r=i(90332);function o(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}Object.defineProperties(o.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}}),o.prototype.getTexture=function(t){const e=this._textures[t];if((0,n.Z)(e))return delete this._texturesToRelease[t],++e.count,e.texture},o.prototype.addTexture=function(t,e){const i={texture:e,count:1};e.finalDestroy=e.destroy;const n=this;e.destroy=function(){0==--i.count&&(n._texturesToRelease[t]=i)},this._textures[t]=i,++this._numberOfTextures},o.prototype.destroyReleasedTextures=function(){const t=this._texturesToRelease;for(const e in t)if(t.hasOwnProperty(e)){const i=t[e];delete this._textures[e],i.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){const t=this._textures;for(const e in t)t.hasOwnProperty(e)&&t[e].texture.finalDestroy();return(0,r.Z)(this)};const s=o},92106:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={NEAREST:n.Z.NEAREST,LINEAR:n.Z.LINEAR,validate:function(t){return t===r.NEAREST||t===r.LINEAR}},o=Object.freeze(r)},48867:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={NEAREST:n.Z.NEAREST,LINEAR:n.Z.LINEAR,NEAREST_MIPMAP_NEAREST:n.Z.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:n.Z.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:n.Z.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:n.Z.LINEAR_MIPMAP_LINEAR,validate:function(t){return t===r.NEAREST||t===r.LINEAR||t===r.NEAREST_MIPMAP_NEAREST||t===r.LINEAR_MIPMAP_NEAREST||t===r.NEAREST_MIPMAP_LINEAR||t===r.LINEAR_MIPMAP_LINEAR}},o=Object.freeze(r)},91373:(t,e,i)=>{i.d(e,{Z:()=>o});var n=i(95411);const r={CLAMP_TO_EDGE:n.Z.CLAMP_TO_EDGE,REPEAT:n.Z.REPEAT,MIRRORED_REPEAT:n.Z.MIRRORED_REPEAT,validate:function(t){return t===r.CLAMP_TO_EDGE||t===r.REPEAT||t===r.MIRRORED_REPEAT}},o=Object.freeze(r)},50801:(t,e,i)=>{i.d(e,{Z:()=>V});var n=i(23114),r=i(59015),o=i(93517),s=i(90868),a=i(66866),h=i(6785),l=i(88779),u=i(54485),c=i(99996),d=i(88173),f=i(22874),p=i(39109),_=i(71118),m=i(74408),g=i(39851),Z=i(7004),y=i(18061),v=i(66406);function w(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new n.Z,this._viewportCartesian4=new s.Z,this._viewportDirty=!1,this._viewportOrthographicMatrix=_.Z.clone(_.Z.IDENTITY),this._viewportTransformation=_.Z.clone(_.Z.IDENTITY),this._model=_.Z.clone(_.Z.IDENTITY),this._view=_.Z.clone(_.Z.IDENTITY),this._inverseView=_.Z.clone(_.Z.IDENTITY),this._projection=_.Z.clone(_.Z.IDENTITY),this._infiniteProjection=_.Z.clone(_.Z.IDENTITY),this._entireFrustum=new r.Z,this._currentFrustum=new r.Z,this._frustumPlanes=new s.Z,this._farDepthFromNearPlusOne=void 0,this._log2FarDepthFromNearPlusOne=void 0,this._oneOverLog2FarDepthFromNearPlusOne=void 0,this._frameState=void 0,this._temeToPseudoFixed=p.Z.clone(_.Z.IDENTITY),this._view3DDirty=!0,this._view3D=new _.Z,this._inverseView3DDirty=!0,this._inverseView3D=new _.Z,this._inverseModelDirty=!0,this._inverseModel=new _.Z,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new p.Z,this._viewRotation=new p.Z,this._inverseViewRotation=new p.Z,this._viewRotation3D=new p.Z,this._inverseViewRotation3D=new p.Z,this._inverseProjectionDirty=!0,this._inverseProjection=new _.Z,this._modelViewDirty=!0,this._modelView=new _.Z,this._modelView3DDirty=!0,this._modelView3D=new _.Z,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new _.Z,this._inverseModelViewDirty=!0,this._inverseModelView=new _.Z,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new _.Z,this._viewProjectionDirty=!0,this._viewProjection=new _.Z,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new _.Z,this._modelViewProjectionDirty=!0,this._modelViewProjection=new _.Z,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new _.Z,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new _.Z,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new _.Z,this._normalDirty=!0,this._normal=new p.Z,this._normal3DDirty=!0,this._normal3D=new p.Z,this._inverseNormalDirty=!0,this._inverseNormal=new p.Z,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new p.Z,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new d.Z,this._cameraPosition=new o.Z,this._sunPositionWC=new o.Z,this._sunPositionColumbusView=new o.Z,this._sunDirectionWC=new o.Z,this._sunDirectionEC=new o.Z,this._moonDirectionEC=new o.Z,this._lightDirectionWC=new o.Z,this._lightDirectionEC=new o.Z,this._lightColor=new o.Z,this._lightColorHdr=new o.Z,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._ellipsoid=void 0,this._cameraDirection=new o.Z,this._cameraRight=new o.Z,this._cameraUp=new o.Z,this._frustum2DWidth=0,this._eyeHeight=0,this._eyeHeight2D=new r.Z,this._pixelRatio=1,this._orthographicIn3D=!1,this._backgroundColor=new h.Z,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsDimensions=new r.Z,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._splitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}Object.defineProperties(w.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(t){if(!n.Z.equals(t,this._viewport)){n.Z.clone(t,this._viewport);const e=this._viewport,i=this._viewportCartesian4;i.x=e.x,i.y=e.y,i.z=e.width,i.w=e.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return A(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return A(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(t){_.Z.clone(t,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,_.Z.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){const t=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,_.Z.getMatrix3(this.inverseModel,t),p.Z.transpose(t,t)),t}},view:{get:function(){return this._view}},view3D:{get:function(){return M(this),this._view3D}},viewRotation:{get:function(){return M(this),this._viewRotation}},viewRotation3D:{get:function(){return M(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return N(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return N(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){var t;return(t=this)._inverseProjectionDirty&&(t._inverseProjectionDirty=!1,t._mode===y.Z.SCENE2D||t._mode===y.Z.MORPHING||t._orthographicIn3D?_.Z.clone(_.Z.ZERO,t._inverseProjection):_.Z.inverse(t._projection,t._inverseProjection)),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){var t;return(t=this)._modelViewDirty&&(t._modelViewDirty=!1,_.Z.multiplyTransformation(t._view,t._model,t._modelView)),this._modelView}},modelView3D:{get:function(){var t;return(t=this)._modelView3DDirty&&(t._modelView3DDirty=!1,_.Z.multiplyTransformation(t.view3D,t._model,t._modelView3D)),this._modelView3D}},modelViewRelativeToEye:{get:function(){return function(t){if(t._modelViewRelativeToEyeDirty){t._modelViewRelativeToEyeDirty=!1;const e=t.modelView,i=t._modelViewRelativeToEye;i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=0,i[13]=0,i[14]=0,i[15]=e[15]}}(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){var t;return(t=this)._inverseModelViewDirty&&(t._inverseModelViewDirty=!1,_.Z.inverse(t.modelView,t._inverseModelView)),this._inverseModelView}},inverseModelView3D:{get:function(){var t;return(t=this)._inverseModelView3DDirty&&(t._inverseModelView3DDirty=!1,_.Z.inverse(t.modelView3D,t._inverseModelView3D)),this._inverseModelView3D}},viewProjection:{get:function(){var t;return(t=this)._viewProjectionDirty&&(t._viewProjectionDirty=!1,_.Z.multiply(t._projection,t._view,t._viewProjection)),this._viewProjection}},inverseViewProjection:{get:function(){var t;return(t=this)._inverseViewProjectionDirty&&(t._inverseViewProjectionDirty=!1,_.Z.inverse(t.viewProjection,t._inverseViewProjection)),this._inverseViewProjection}},modelViewProjection:{get:function(){var t;return(t=this)._modelViewProjectionDirty&&(t._modelViewProjectionDirty=!1,_.Z.multiply(t._projection,t.modelView,t._modelViewProjection)),this._modelViewProjection}},inverseModelViewProjection:{get:function(){var t;return(t=this)._inverseModelViewProjectionDirty&&(t._inverseModelViewProjectionDirty=!1,_.Z.inverse(t.modelViewProjection,t._inverseModelViewProjection)),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){var t;return(t=this)._modelViewProjectionRelativeToEyeDirty&&(t._modelViewProjectionRelativeToEyeDirty=!1,_.Z.multiply(t._projection,t.modelViewRelativeToEye,t._modelViewProjectionRelativeToEye)),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){var t;return(t=this)._modelViewInfiniteProjectionDirty&&(t._modelViewInfiniteProjectionDirty=!1,_.Z.multiply(t._infiniteProjection,t.modelView,t._modelViewInfiniteProjection)),this._modelViewInfiniteProjection}},normal:{get:function(){return function(t){if(t._normalDirty){t._normalDirty=!1;const e=t._normal;_.Z.getMatrix3(t.inverseModelView,e),p.Z.getRotation(e,e),p.Z.transpose(e,e)}}(this),this._normal}},normal3D:{get:function(){return function(t){if(t._normal3DDirty){t._normal3DDirty=!1;const e=t._normal3D;_.Z.getMatrix3(t.inverseModelView3D,e),p.Z.getRotation(e,e),p.Z.transpose(e,e)}}(this),this._normal3D}},inverseNormal:{get:function(){var t;return(t=this)._inverseNormalDirty&&(t._inverseNormalDirty=!1,_.Z.getMatrix3(t.inverseModelView,t._inverseNormal),p.Z.getRotation(t._inverseNormal,t._inverseNormal)),this._inverseNormal}},inverseNormal3D:{get:function(){var t;return(t=this)._inverseNormal3DDirty&&(t._inverseNormal3DDirty=!1,_.Z.getMatrix3(t.inverseModelView3D,t._inverseNormal3D),p.Z.getRotation(t._inverseNormal3D,t._inverseNormal3D)),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},farDepthFromNearPlusOne:{get:function(){return this._farDepthFromNearPlusOne}},log2FarDepthFromNearPlusOne:{get:function(){return this._log2FarDepthFromNearPlusOne}},oneOverLog2FarDepthFromNearPlusOne:{get:function(){return this._oneOverLog2FarDepthFromNearPlusOne}},eyeHeight:{get:function(){return this._eyeHeight}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},lightDirectionWC:{get:function(){return this._lightDirectionWC}},lightDirectionEC:{get:function(){return this._lightDirectionEC}},lightColor:{get:function(){return this._lightColor}},lightColorHdr:{get:function(){return this._lightColorHdr}},encodedCameraPositionMCHigh:{get:function(){return S(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return S(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},pixelRatio:{get:function(){return this._pixelRatio}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsDimensions:{get:function(){return this._specularEnvironmentMapsDimensions}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},splitPosition:{get:function(){return this._splitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}},ellipsoid:{get:function(){return(0,l.Z)(this._ellipsoid,c.Z.WGS84)}}});let T=new p.Z;const b=new a.Z;w.prototype.updateCamera=function(t){var e,i;e=this,i=t.viewMatrix,_.Z.clone(i,e._view),_.Z.getMatrix3(i,e._viewRotation),e._view3DDirty=!0,e._inverseView3DDirty=!0,e._modelViewDirty=!0,e._modelView3DDirty=!0,e._modelViewRelativeToEyeDirty=!0,e._inverseModelViewDirty=!0,e._inverseModelView3DDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0,e._modelViewInfiniteProjectionDirty=!0,e._normalDirty=!0,e._inverseNormalDirty=!0,e._normal3DDirty=!0,e._inverseNormal3DDirty=!0,function(t,e){_.Z.clone(e,t._inverseView),_.Z.getMatrix3(e,t._inverseViewRotation)}(this,t.inverseViewMatrix),function(t,e){o.Z.clone(e.positionWC,t._cameraPosition),o.Z.clone(e.directionWC,t._cameraDirection),o.Z.clone(e.rightWC,t._cameraRight),o.Z.clone(e.upWC,t._cameraUp);const i=e.positionCartographic;(0,u.Z)(i)?t._eyeHeight=i.height:t._eyeHeight=-t._ellipsoid.maximumRadius,t._encodedCameraPositionMCDirty=!0}(this,t),this._entireFrustum.x=t.frustum.near,this._entireFrustum.y=t.frustum.far,this.updateFrustum(t.frustum),this._orthographicIn3D=this._mode!==y.Z.SCENE2D&&t.frustum instanceof m.Z},w.prototype.updateFrustum=function(t){var e,i;e=this,i=t.projectionMatrix,_.Z.clone(i,e._projection),e._inverseProjectionDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0,(0,u.Z)(t.infiniteProjectionMatrix)&&function(t,e){_.Z.clone(e,t._infiniteProjection),t._modelViewInfiniteProjectionDirty=!0}(this,t.infiniteProjectionMatrix),this._currentFrustum.x=t.near,this._currentFrustum.y=t.far,this._farDepthFromNearPlusOne=t.far-t.near+1,this._log2FarDepthFromNearPlusOne=f.Z.log2(this._farDepthFromNearPlusOne),this._oneOverLog2FarDepthFromNearPlusOne=1/this._log2FarDepthFromNearPlusOne,(0,u.Z)(t._offCenterFrustum)&&(t=t._offCenterFrustum),this._frustumPlanes.x=t.top,this._frustumPlanes.y=t.bottom,this._frustumPlanes.z=t.left,this._frustumPlanes.w=t.right},w.prototype.updatePass=function(t){this._pass=t};const E=[],x=new v.Z;function A(t){if(t._viewportDirty){const e=t._viewport;_.Z.computeOrthographicOffCenter(e.x,e.x+e.width,e.y,e.y+e.height,0,1,t._viewportOrthographicMatrix),_.Z.computeViewportTransformation(e,0,1,t._viewportTransformation),t._viewportDirty=!1}}w.prototype.update=function(t){this._mode=t.mode,this._mapProjection=t.mapProjection,this._ellipsoid=t.mapProjection.ellipsoid,this._pixelRatio=t.pixelRatio;const e=t.camera;this.updateCamera(e),t.mode===y.Z.SCENE2D?(this._frustum2DWidth=e.frustum.right-e.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),function(t,e){(0,u.Z)(Z.Z.computeIcrfToFixedMatrix(e.time,T))||(T=Z.Z.computeTemeToPseudoFixedMatrix(e.time,T));let i=g.Z.computeSunPositionInEarthInertialFrame(e.time,t._sunPositionWC);p.Z.multiplyByVector(T,i,i),o.Z.normalize(i,t._sunDirectionWC),i=p.Z.multiplyByVector(t.viewRotation3D,i,t._sunDirectionEC),o.Z.normalize(i,i),i=g.Z.computeMoonPositionInEarthInertialFrame(e.time,t._moonDirectionEC),p.Z.multiplyByVector(T,i,i),p.Z.multiplyByVector(t.viewRotation3D,i,i),o.Z.normalize(i,i);const n=e.mapProjection,r=n.ellipsoid.cartesianToCartographic(t._sunPositionWC,b);n.project(r,t._sunPositionColumbusView)}(this,t);const i=(0,l.Z)(t.light,x);i instanceof v.Z?(this._lightDirectionWC=o.Z.clone(this._sunDirectionWC,this._lightDirectionWC),this._lightDirectionEC=o.Z.clone(this._sunDirectionEC,this._lightDirectionEC)):(this._lightDirectionWC=o.Z.normalize(o.Z.negate(i.direction,this._lightDirectionWC),this._lightDirectionWC),this._lightDirectionEC=p.Z.multiplyByVector(this.viewRotation3D,this._lightDirectionWC,this._lightDirectionEC));const n=i.color;let s=o.Z.fromElements(n.red,n.green,n.blue,this._lightColorHdr);s=o.Z.multiplyByScalar(s,i.intensity,s);const a=o.Z.maximumComponent(s);a>1?o.Z.divideByScalar(s,a,this._lightColor):o.Z.clone(s,this._lightColor);const c=t.brdfLutGenerator,d=(0,u.Z)(c)?c.colorTexture:void 0;this._brdfLut=d,this._environmentMap=(0,l.Z)(t.environmentMap,t.context.defaultCubeMap),this._sphericalHarmonicCoefficients=(0,l.Z)(t.sphericalHarmonicCoefficients,E),this._specularEnvironmentMaps=t.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=t.specularEnvironmentMapsMaximumLOD,(0,u.Z)(this._specularEnvironmentMaps)&&r.Z.clone(this._specularEnvironmentMaps.dimensions,this._specularEnvironmentMapsDimensions),this._fogDensity=t.fog.density,this._invertClassificationColor=t.invertClassificationColor,this._frameState=t,this._temeToPseudoFixed=Z.Z.computeTemeToPseudoFixedMatrix(t.time,this._temeToPseudoFixed),this._splitPosition=t.splitPosition*t.context.drawingBufferWidth;const f=e.frustum.fov,_=this._viewport;let m;m=(0,u.Z)(f)?_.height>_.width?2*Math.tan(.5*f)/_.height:2*Math.tan(.5*f)/_.width:1/Math.max(_.width,_.height),this._geometricToleranceOverMeter=m*t.maximumScreenSpaceError,h.Z.clone(t.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=t.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};const C=new o.Z;function S(t){t._encodedCameraPositionMCDirty&&(t._encodedCameraPositionMCDirty=!1,_.Z.multiplyByPoint(t.inverseModel,t._cameraPosition,C),d.Z.fromCartesian(C,t._encodedCameraPositionMC))}const D=new o.Z,P=new o.Z,O=new o.Z,I=new o.Z,F=new a.Z,R=new o.Z,L=new _.Z;function M(t){t._view3DDirty&&(t._mode===y.Z.SCENE3D?_.Z.clone(t._view,t._view3D):function(t,e,i,n,r,s,a,h){const l=D;l.x=t.y,l.y=t.z,l.z=t.x;const c=P;c.x=i.y,c.y=i.z,c.z=i.x;const d=O;d.x=n.y,d.y=n.z,d.z=n.x;const p=I;p.x=e.y,p.y=e.z,p.z=e.x,s===y.Z.SCENE2D&&(l.z=.5*r);const m=a.unproject(l,F);m.longitude=f.Z.clamp(m.longitude,-Math.PI,Math.PI),m.latitude=f.Z.clamp(m.latitude,-f.Z.PI_OVER_TWO,f.Z.PI_OVER_TWO);const g=a.ellipsoid,v=g.cartographicToCartesian(m,R),w=Z.Z.eastNorthUpToFixedFrame(v,g,L);_.Z.multiplyByPointAsVector(w,c,c),_.Z.multiplyByPointAsVector(w,d,d),_.Z.multiplyByPointAsVector(w,p,p),(0,u.Z)(h)||(h=new _.Z),h[0]=c.x,h[1]=d.x,h[2]=-p.x,h[3]=0,h[4]=c.y,h[5]=d.y,h[6]=-p.y,h[7]=0,h[8]=c.z,h[9]=d.z,h[10]=-p.z,h[11]=0,h[12]=-o.Z.dot(c,v),h[13]=-o.Z.dot(d,v),h[14]=o.Z.dot(p,v),h[15]=1}(t._cameraPosition,t._cameraDirection,t._cameraRight,t._cameraUp,t._frustum2DWidth,t._mode,t._mapProjection,t._view3D),_.Z.getMatrix3(t._view3D,t._viewRotation3D),t._view3DDirty=!1)}function N(t){t._inverseView3DDirty&&(_.Z.inverseTransformation(t.view3D,t._inverseView3D),_.Z.getMatrix3(t._inverseView3D,t._inverseViewRotation3D),t._inverseView3DDirty=!1)}const V=w},46801:(t,e,i)=>{i.d(e,{Z:()=>w});var n=i(17497),r=i(44990),o=i(88779),s=i(54485),a=i(90332),h=i(20176),l=i(97845),u=i(39172),c=i(22874),d=i(21514),f=i(31328),p=i(36627),_=i(85834);function m(t,e,i,n){const a=(0,s.Z)(e.vertexBuffer),l=(0,s.Z)(e.value),u=e.value?e.value.length:e.componentsPerAttribute;if(!a&&!l)throw new h.Z("attribute must have a vertexBuffer or a value.");if(a&&l)throw new h.Z("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.");if(1!==u&&2!==u&&3!==u&&4!==u){if(l)throw new h.Z("attribute.value.length must be in the range [1, 4].");throw new h.Z("attribute.componentsPerAttribute must be in the range [1, 4].")}if((0,s.Z)(e.componentDatatype)&&!r.Z.validate(e.componentDatatype))throw new h.Z("attribute must have a valid componentDatatype or not specify it.");if((0,s.Z)(e.strideInBytes)&&e.strideInBytes>255)throw new h.Z("attribute must have a strideInBytes less than or equal to 255 or not specify it.");if((0,s.Z)(e.instanceDivisor)&&e.instanceDivisor>0&&!n.instancedArrays)throw new h.Z("instanced arrays is not supported");if((0,s.Z)(e.instanceDivisor)&&e.instanceDivisor<0)throw new h.Z("attribute must have an instanceDivisor greater than or equal to zero");if((0,s.Z)(e.instanceDivisor)&&l)throw new h.Z("attribute cannot have have an instanceDivisor if it is not backed by a buffer");if((0,s.Z)(e.instanceDivisor)&&e.instanceDivisor>0&&0===e.index)throw new h.Z("attribute zero cannot have an instanceDivisor greater than 0");const c={index:(0,o.Z)(e.index,i),enabled:(0,o.Z)(e.enabled,!0),vertexBuffer:e.vertexBuffer,value:l?e.value.slice(0):void 0,componentsPerAttribute:u,componentDatatype:(0,o.Z)(e.componentDatatype,r.Z.FLOAT),normalize:(0,o.Z)(e.normalize,!1),offsetInBytes:(0,o.Z)(e.offsetInBytes,0),strideInBytes:(0,o.Z)(e.strideInBytes,0),instanceDivisor:(0,o.Z)(e.instanceDivisor,0)};if(a)c.vertexAttrib=function(t){const e=this.index;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),t.vertexAttribPointer(e,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),t.enableVertexAttribArray(e),this.instanceDivisor>0&&(n.glVertexAttribDivisor(e,this.instanceDivisor),n._vertexAttribDivisors[e]=this.instanceDivisor,n._previousDrawInstanced=!0)},c.disableVertexAttribArray=function(t){t.disableVertexAttribArray(this.index),this.instanceDivisor>0&&n.glVertexAttribDivisor(i,0)};else{switch(c.componentsPerAttribute){case 1:c.vertexAttrib=function(t){t.vertexAttrib1fv(this.index,this.value)};break;case 2:c.vertexAttrib=function(t){t.vertexAttrib2fv(this.index,this.value)};break;case 3:c.vertexAttrib=function(t){t.vertexAttrib3fv(this.index,this.value)};break;case 4:c.vertexAttrib=function(t){t.vertexAttrib4fv(this.index,this.value)}}c.disableVertexAttribArray=function(t){}}t.push(c)}function g(t,e,i){for(let i=0;i<e.length;++i){const n=e[i];n.enabled&&n.vertexAttrib(t)}(0,s.Z)(i)&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i._getBuffer())}function Z(t){t=(0,o.Z)(t,o.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context),n.Z.defined("options.attributes",t.attributes);const e=t.context,i=e._gl,a=t.attributes,l=t.indexBuffer;let u;const c=[];let d=1,f=!1,p=!1,_=a.length;for(u=0;u<_;++u)m(c,a[u],u,e);for(_=c.length,u=0;u<_;++u){const t=c[u];if((0,s.Z)(t.vertexBuffer)&&0===t.instanceDivisor){const e=t.strideInBytes||t.componentsPerAttribute*r.Z.getSizeInBytes(t.componentDatatype);d=t.vertexBuffer.sizeInBytes/e;break}}for(u=0;u<_;++u)c[u].instanceDivisor>0&&(f=!0),(0,s.Z)(c[u].value)&&(p=!0);const Z={};for(u=0;u<_;++u){const t=c[u].index;if(Z[t])throw new h.Z(`Index ${t} is used by more than one attribute.`);Z[t]=!0}let y;e.vertexArrayObject&&(y=e.glCreateVertexArray(),e.glBindVertexArray(y),g(i,c,l),e.glBindVertexArray(null)),this._numberOfVertices=d,this._hasInstancedAttributes=f,this._hasConstantAttributes=p,this._context=e,this._gl=i,this._vao=y,this._attributes=c,this._indexBuffer=l}function y(t){return t.values.length/t.componentsPerAttribute}function v(t){return r.Z.getSizeInBytes(t.componentDatatype)*t.componentsPerAttribute}Z.fromGeometry=function(t){t=(0,o.Z)(t,o.Z.EMPTY_OBJECT),n.Z.defined("options.context",t.context);const e=t.context,i=(0,o.Z)(t.geometry,o.Z.EMPTY_OBJECT),a=(0,o.Z)(t.bufferUsage,p.Z.DYNAMIC_DRAW),h=(0,o.Z)(t.attributeLocations,o.Z.EMPTY_OBJECT),_=(0,o.Z)(t.interleave,!1),m=t.vertexArrayAttributes;let g,w,T;const b=(0,s.Z)(m)?m:[],E=i.attributes;if(_){const t=function(t){let e,i,n;const o=[];for(i in t)t.hasOwnProperty(i)&&(0,s.Z)(t[i])&&(0,s.Z)(t[i].values)&&(o.push(i),t[i].componentDatatype===r.Z.DOUBLE&&(t[i].componentDatatype=r.Z.FLOAT,t[i].values=r.Z.createTypedArray(r.Z.FLOAT,t[i].values)));let a;const h=o.length;if(h>0)for(a=y(t[o[0]]),e=1;e<h;++e){const i=y(t[o[e]]);if(i!==a)throw new d.Z(`Each attribute list must have the same number of vertices.  Attribute ${o[e]} has a different number of vertices (${i.toString()}) than attribute ${o[0]} (${a.toString()}).`)}o.sort((function(e,i){return r.Z.getSizeInBytes(t[i].componentDatatype)-r.Z.getSizeInBytes(t[e].componentDatatype)}));let l=0;const u={};for(e=0;e<h;++e)i=o[e],n=t[i],u[i]=l,l+=v(n);if(l>0){const s=r.Z.getSizeInBytes(t[o[0]].componentDatatype),c=l%s;0!==c&&(l+=s-c);const d=new ArrayBuffer(a*l),f={};for(e=0;e<h;++e){i=o[e];const n=r.Z.getSizeInBytes(t[i].componentDatatype);f[i]={pointer:r.Z.createTypedArray(t[i].componentDatatype,d),index:u[i]/n,strideInComponentType:l/n}}for(e=0;e<a;++e)for(let r=0;r<h;++r){i=o[r],n=t[i];const s=n.values,a=f[i],h=a.pointer,l=n.componentsPerAttribute;for(let t=0;t<l;++t)h[a.index+t]=s[e*l+t];a.index+=a.strideInComponentType}return{buffer:d,offsetsInBytes:u,vertexSizeInBytes:l}}}(E);if((0,s.Z)(t)){T=f.Z.createVertexBuffer({context:e,typedArray:t.buffer,usage:a});const i=t.offsetsInBytes,n=t.vertexSizeInBytes;for(g in E)E.hasOwnProperty(g)&&(0,s.Z)(E[g])&&(w=E[g],(0,s.Z)(w.values)?b.push({index:h[g],vertexBuffer:T,componentDatatype:w.componentDatatype,componentsPerAttribute:w.componentsPerAttribute,normalize:w.normalize,offsetInBytes:i[g],strideInBytes:n}):b.push({index:h[g],value:w.value,componentDatatype:w.componentDatatype,normalize:w.normalize}))}}else for(g in E)if(E.hasOwnProperty(g)&&(0,s.Z)(E[g])){w=E[g];let t=w.componentDatatype;t===r.Z.DOUBLE&&(t=r.Z.FLOAT),T=void 0,(0,s.Z)(w.values)&&(T=f.Z.createVertexBuffer({context:e,typedArray:r.Z.createTypedArray(t,w.values),usage:a})),b.push({index:h[g],vertexBuffer:T,value:w.value,componentDatatype:t,componentsPerAttribute:w.componentsPerAttribute,normalize:w.normalize})}let x;const A=i.indices;return(0,s.Z)(A)&&(x=l.Z.computeNumberOfVertices(i)>=c.Z.SIXTY_FOUR_KILOBYTES&&e.elementIndexUint?f.Z.createIndexBuffer({context:e,typedArray:new Uint32Array(A),usage:a,indexDatatype:u.Z.UNSIGNED_INT}):f.Z.createIndexBuffer({context:e,typedArray:new Uint16Array(A),usage:a,indexDatatype:u.Z.UNSIGNED_SHORT})),new Z({context:e,attributes:b,indexBuffer:x})},Object.defineProperties(Z.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),Z.prototype.getAttribute=function(t){return n.Z.defined("index",t),this._attributes[t]},Z.prototype._bind=function(){(0,s.Z)(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&function(t){const e=t._context,i=t._hasInstancedAttributes;if(!i&&!e._previousDrawInstanced)return;e._previousDrawInstanced=i;const n=e._vertexAttribDivisors,r=t._attributes,o=_.Z.maximumVertexAttributes;let s;if(i){const t=r.length;for(s=0;s<t;++s){const t=r[s];if(t.enabled){const i=t.instanceDivisor,r=t.index;i!==n[r]&&(e.glVertexAttribDivisor(r,i),n[r]=i)}}}else for(s=0;s<o;++s)n[s]>0&&(e.glVertexAttribDivisor(s,0),n[s]=0)}(this),this._hasConstantAttributes&&function(t,e){const i=t._attributes,n=i.length;for(let t=0;t<n;++t){const n=i[t];n.enabled&&(0,s.Z)(n.value)&&n.vertexAttrib(e)}}(this,this._gl)):g(this._gl,this._attributes,this._indexBuffer)},Z.prototype._unBind=function(){if((0,s.Z)(this._vao))this._context.glBindVertexArray(null);else{const t=this._attributes,e=this._gl;for(let i=0;i<t.length;++i){const n=t[i];n.enabled&&n.disableVertexAttribArray(e)}this._indexBuffer&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}},Z.prototype.isDestroyed=function(){return!1},Z.prototype.destroy=function(){const t=this._attributes;for(let e=0;e<t.length;++e){const i=t[e].vertexBuffer;(0,s.Z)(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy()}const e=this._indexBuffer;return(0,s.Z)(e)&&!e.isDestroyed()&&e.vertexArrayDestroyable&&e.destroy(),(0,s.Z)(this._vao)&&this._context.glDeleteVertexArray(this._vao),(0,a.Z)(this)};const w=Z},19695:(t,e,i)=>{i.d(e,{Z:()=>Z});var n=i(17497),r=i(44990),o=i(88779),s=i(54485),a=i(90332),h=i(20176),l=i(22874),u=i(31328),c=i(36627),d=i(46801);function f(t,e,i,a){if(n.Z.defined("context",t),!e||0===e.length)throw new h.Z("At least one attribute is required.");const l=f._verifyAttributes(e);i=(0,o.Z)(i,0);const u=[],c={};let d,p;const _=l.length;for(let t=0;t<_;++t){const e=l[t];e.vertexBuffer?u.push(e):(p=e.usage,d=c[p],(0,s.Z)(d)||(d=c[p]=[]),d.push(e))}function m(t,e){return r.Z.getSizeInBytes(e.componentDatatype)-r.Z.getSizeInBytes(t.componentDatatype)}for(p in this._allBuffers=[],c)if(c.hasOwnProperty(p)){d=c[p],d.sort(m);const t=f._vertexSizeInBytes(d),e={vertexSizeInBytes:t,vertexBuffer:void 0,usage:d[0].usage,needsCommit:!1,arrayBuffer:void 0,arrayViews:f._createArrayViews(d,t)};this._allBuffers.push(e)}this._size=0,this._instanced=(0,o.Z)(a,!1),this._precreated=u,this._context=t,this.writers=void 0,this.va=void 0,this.resize(i)}f._verifyAttributes=function(t){const e=[];for(let i=0;i<t.length;++i){const n=t[i],s={index:(0,o.Z)(n.index,i),enabled:(0,o.Z)(n.enabled,!0),componentsPerAttribute:n.componentsPerAttribute,componentDatatype:(0,o.Z)(n.componentDatatype,r.Z.FLOAT),normalize:(0,o.Z)(n.normalize,!1),vertexBuffer:n.vertexBuffer,usage:(0,o.Z)(n.usage,c.Z.STATIC_DRAW)};if(e.push(s),1!==s.componentsPerAttribute&&2!==s.componentsPerAttribute&&3!==s.componentsPerAttribute&&4!==s.componentsPerAttribute)throw new h.Z("attribute.componentsPerAttribute must be in the range [1, 4].");const a=s.componentDatatype;if(!r.Z.validate(a))throw new h.Z("Attribute must have a valid componentDatatype or not specify it.");if(!c.Z.validate(s.usage))throw new h.Z("Attribute must have a valid usage or not specify it.")}const i=new Array(e.length);for(let t=0;t<e.length;++t){const n=e[t].index;if(i[n])throw new h.Z(`Index ${n} is used by more than one attribute.`);i[n]=!0}return e},f._vertexSizeInBytes=function(t){let e=0;const i=t.length;for(let n=0;n<i;++n){const i=t[n];e+=i.componentsPerAttribute*r.Z.getSizeInBytes(i.componentDatatype)}const n=i>0?r.Z.getSizeInBytes(t[0].componentDatatype):0,o=n>0?e%n:0;return e+=0===o?0:n-o,e},f._createArrayViews=function(t,e){const i=[];let n=0;const o=t.length;for(let s=0;s<o;++s){const o=t[s],a=o.componentDatatype;i.push({index:o.index,enabled:o.enabled,componentsPerAttribute:o.componentsPerAttribute,componentDatatype:a,normalize:o.normalize,offsetInBytes:n,vertexSizeInComponentType:e/r.Z.getSizeInBytes(a),view:void 0}),n+=o.componentsPerAttribute*r.Z.getSizeInBytes(a)}return i},f.prototype.resize=function(t){this._size=t;const e=this._allBuffers;this.writers=[];for(let t=0,i=e.length;t<i;++t){const i=e[t];f._resize(i,this._size),f._appendWriters(this.writers,i)}g(this)},f._resize=function(t,e){if(t.vertexSizeInBytes>0){const i=new ArrayBuffer(e*t.vertexSizeInBytes);if((0,s.Z)(t.arrayBuffer)){const e=new Uint8Array(i),n=new Uint8Array(t.arrayBuffer),r=n.length;for(let t=0;t<r;++t)e[t]=n[t]}const n=t.arrayViews,o=n.length;for(let t=0;t<o;++t){const e=n[t];e.view=r.Z.createArrayBufferView(e.componentDatatype,i,e.offsetInBytes)}t.arrayBuffer=i}};const p=[function(t,e,i){return function(n,r){e[n*i]=r,t.needsCommit=!0}},function(t,e,i){return function(n,r,o){const s=n*i;e[s]=r,e[s+1]=o,t.needsCommit=!0}},function(t,e,i){return function(n,r,o,s){const a=n*i;e[a]=r,e[a+1]=o,e[a+2]=s,t.needsCommit=!0}},function(t,e,i){return function(n,r,o,s,a){const h=n*i;e[h]=r,e[h+1]=o,e[h+2]=s,e[h+3]=a,t.needsCommit=!0}}];function _(t,e){if(e.needsCommit&&e.vertexSizeInBytes>0){e.needsCommit=!1;const i=e.vertexBuffer,n=t._size*e.vertexSizeInBytes,r=(0,s.Z)(i);if(!r||i.sizeInBytes<n)return r&&i.destroy(),e.vertexBuffer=u.Z.createVertexBuffer({context:t._context,typedArray:e.arrayBuffer,usage:e.usage}),e.vertexBuffer.vertexArrayDestroyable=!1,!0;e.vertexBuffer.copyFromArrayView(e.arrayBuffer)}return!1}function m(t,e,i){if(t.needsCommit&&t.vertexSizeInBytes>0){const n=t.vertexSizeInBytes*e,r=t.vertexSizeInBytes*i;t.vertexBuffer.copyFromArrayView(new Uint8Array(t.arrayBuffer,n,r),n)}}function g(t){const e=t.va;if(!(0,s.Z)(e))return;const i=e.length;for(let t=0;t<i;++t)e[t].va.destroy();t.va=void 0}f._appendWriters=function(t,e){const i=e.arrayViews,n=i.length;for(let r=0;r<n;++r){const n=i[r];t[n.index]=p[n.componentsPerAttribute-1](e,n.view,n.vertexSizeInComponentType)}},f.prototype.commit=function(t){let e=!1;const i=this._allBuffers;let n,r,o;for(r=0,o=i.length;r<o;++r)n=i[r],e=_(this,n)||e;if(e||!(0,s.Z)(this.va)){g(this);const e=this.va=[],a=l.Z.SIXTY_FOUR_KILOBYTES-4,h=(0,s.Z)(t)&&!this._instanced?Math.ceil(this._size/a):1;for(let s=0;s<h;++s){let l=[];for(r=0,o=i.length;r<o;++r){n=i[r];const t=s*(n.vertexSizeInBytes*a);f._appendAttributes(l,n,t,this._instanced)}l=l.concat(this._precreated),e.push({va:new d.Z({context:this._context,attributes:l,indexBuffer:t}),indicesCount:1.5*(s!==h-1?a:this._size%a)})}}},f._appendAttributes=function(t,e,i,n){const r=e.arrayViews,o=r.length;for(let s=0;s<o;++s){const o=r[s];t.push({index:o.index,enabled:o.enabled,componentsPerAttribute:o.componentsPerAttribute,componentDatatype:o.componentDatatype,normalize:o.normalize,vertexBuffer:e.vertexBuffer,offsetInBytes:i+o.offsetInBytes,strideInBytes:e.vertexSizeInBytes,instanceDivisor:n?1:0})}},f.prototype.subCommit=function(t,e){if(t<0||t>=this._size)throw new h.Z("offsetInVertices must be greater than or equal to zero and less than the vertex array size.");if(t+e>this._size)throw new h.Z("offsetInVertices + lengthInVertices cannot exceed the vertex array size.");const i=this._allBuffers;for(let n=0,r=i.length;n<r;++n)m(i[n],t,e)},f.prototype.endSubCommits=function(){const t=this._allBuffers;for(let e=0,i=t.length;e<i;++e)t[e].needsCommit=!1},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){const t=this._allBuffers;for(let e=0,i=t.length;e<i;++e){const i=t[e];i.vertexBuffer=i.vertexBuffer&&i.vertexBuffer.destroy()}return g(this),(0,a.Z)(this)};const Z=f},21398:(t,e,i)=>{i.d(e,{Z:()=>S});var n=i(59015),r=i(93517),o=i(90868),s=i(6785),a=i(54485),h=i(20176),l=i(40734),u=i(39109),c=i(71118),d=i(21514);function f(t,e,i,n){this.name=i,this.value=void 0,this._value=0,this._gl=t,this._location=n}function p(t,e,i,r){this.name=i,this.value=void 0,this._value=new n.Z,this._gl=t,this._location=r}function _(t,e,i,n){this.name=i,this.value=void 0,this._value=void 0,this._gl=t,this._location=n}function m(t,e,i,n){this.name=i,this.value=void 0,this._value=void 0,this._gl=t,this._location=n}function g(t,e,i,n){this.name=i,this.value=void 0,this._gl=t,this._location=n,this.textureUnitIndex=void 0}function Z(t,e,i,n){this.name=i,this.value=void 0,this._value=0,this._gl=t,this._location=n}function y(t,e,i,r){this.name=i,this.value=void 0,this._value=new n.Z,this._gl=t,this._location=r}function v(t,e,i,n){this.name=i,this.value=void 0,this._value=new r.Z,this._gl=t,this._location=n}function w(t,e,i,n){this.name=i,this.value=void 0,this._value=new o.Z,this._gl=t,this._location=n}f.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},p.prototype.set=function(){const t=this.value;n.Z.equals(t,this._value)||(n.Z.clone(t,this._value),this._gl.uniform2f(this._location,t.x,t.y))},_.prototype.set=function(){const t=this.value;if((0,a.Z)(t.red))s.Z.equals(t,this._value)||(this._value=s.Z.clone(t,this._value),this._gl.uniform3f(this._location,t.red,t.green,t.blue));else{if(!(0,a.Z)(t.x))throw new h.Z(`Invalid vec3 value for uniform "${this.name}".`);r.Z.equals(t,this._value)||(this._value=r.Z.clone(t,this._value),this._gl.uniform3f(this._location,t.x,t.y,t.z))}},m.prototype.set=function(){const t=this.value;if((0,a.Z)(t.red))s.Z.equals(t,this._value)||(this._value=s.Z.clone(t,this._value),this._gl.uniform4f(this._location,t.red,t.green,t.blue,t.alpha));else{if(!(0,a.Z)(t.x))throw new h.Z(`Invalid vec4 value for uniform "${this.name}".`);o.Z.equals(t,this._value)||(this._value=o.Z.clone(t,this._value),this._gl.uniform4f(this._location,t.x,t.y,t.z,t.w))}},g.prototype.set=function(){const t=this._gl;t.activeTexture(t.TEXTURE0+this.textureUnitIndex);const e=this.value;t.bindTexture(e._target,e._texture)},g.prototype._setSampler=function(t){return this.textureUnitIndex=t,this._gl.uniform1i(this._location,t),t+1},Z.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},y.prototype.set=function(){const t=this.value;n.Z.equals(t,this._value)||(n.Z.clone(t,this._value),this._gl.uniform2i(this._location,t.x,t.y))},v.prototype.set=function(){const t=this.value;r.Z.equals(t,this._value)||(r.Z.clone(t,this._value),this._gl.uniform3i(this._location,t.x,t.y,t.z))},w.prototype.set=function(){const t=this.value;o.Z.equals(t,this._value)||(o.Z.clone(t,this._value),this._gl.uniform4i(this._location,t.x,t.y,t.z,t.w))};const T=new Float32Array(4);function b(t,e,i,n){this.name=i,this.value=void 0,this._value=new l.Z,this._gl=t,this._location=n}b.prototype.set=function(){if(!l.Z.equalsArray(this.value,this._value,0)){l.Z.clone(this.value,this._value);const t=l.Z.toArray(this.value,T);this._gl.uniformMatrix2fv(this._location,!1,t)}};const E=new Float32Array(9);function x(t,e,i,n){this.name=i,this.value=void 0,this._value=new u.Z,this._gl=t,this._location=n}x.prototype.set=function(){if(!u.Z.equalsArray(this.value,this._value,0)){u.Z.clone(this.value,this._value);const t=u.Z.toArray(this.value,E);this._gl.uniformMatrix3fv(this._location,!1,t)}};const A=new Float32Array(16);function C(t,e,i,n){this.name=i,this.value=void 0,this._value=new c.Z,this._gl=t,this._location=n}C.prototype.set=function(){if(!c.Z.equalsArray(this.value,this._value,0)){c.Z.clone(this.value,this._value);const t=c.Z.toArray(this.value,A);this._gl.uniformMatrix4fv(this._location,!1,t)}};const S=function(t,e,i,n){switch(e.type){case t.FLOAT:return new f(t,e,i,n);case t.FLOAT_VEC2:return new p(t,e,i,n);case t.FLOAT_VEC3:return new _(t,e,i,n);case t.FLOAT_VEC4:return new m(t,e,i,n);case t.SAMPLER_2D:case t.SAMPLER_CUBE:return new g(t,e,i,n);case t.INT:case t.BOOL:return new Z(t,e,i,n);case t.INT_VEC2:case t.BOOL_VEC2:return new y(t,e,i,n);case t.INT_VEC3:case t.BOOL_VEC3:return new v(t,e,i,n);case t.INT_VEC4:case t.BOOL_VEC4:return new w(t,e,i,n);case t.FLOAT_MAT2:return new b(t,e,i,n);case t.FLOAT_MAT3:return new x(t,e,i,n);case t.FLOAT_MAT4:return new C(t,e,i,n);default:throw new d.Z(`Unrecognized uniform type: ${e.type} for uniform "${i}".`)}}},53790:(t,e,i)=>{i.d(e,{Z:()=>x});var n=i(59015),r=i(93517),o=i(90868),s=i(6785),a=i(54485),h=i(20176),l=i(40734),u=i(39109),c=i(71118),d=i(21514);function f(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=t,this._location=n[0]}function p(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(2*r),this._gl=t,this._location=n[0]}function _(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(3*r),this._gl=t,this._location=n[0]}function m(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(4*r),this._gl=t,this._location=n[0]}function g(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=t,this._locations=n,this.textureUnitIndex=void 0}function Z(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r),this._gl=t,this._location=n[0]}function y(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(2*r),this._gl=t,this._location=n[0]}function v(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(3*r),this._gl=t,this._location=n[0]}function w(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(4*r),this._gl=t,this._location=n[0]}function T(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(4*r),this._gl=t,this._location=n[0]}function b(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(9*r),this._gl=t,this._location=n[0]}function E(t,e,i,n){const r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(16*r),this._gl=t,this._location=n[0]}f.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1;for(let r=0;r<e;++r){const e=t[r];e!==i[r]&&(i[r]=e,n=!0)}n&&this._gl.uniform1fv(this._location,i)},p.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let r=!1,o=0;for(let s=0;s<e;++s){const e=t[s];n.Z.equalsArray(e,i,o)||(n.Z.pack(e,i,o),r=!0),o+=2}r&&this._gl.uniform2fv(this._location,i)},_.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,o=0;for(let s=0;s<e;++s){const e=t[s];if((0,a.Z)(e.red))e.red===i[o]&&e.green===i[o+1]&&e.blue===i[o+2]||(i[o]=e.red,i[o+1]=e.green,i[o+2]=e.blue,n=!0);else{if(!(0,a.Z)(e.x))throw new h.Z("Invalid vec3 value.");r.Z.equalsArray(e,i,o)||(r.Z.pack(e,i,o),n=!0)}o+=3}n&&this._gl.uniform3fv(this._location,i)},m.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,r=0;for(let l=0;l<e;++l){const e=t[l];if((0,a.Z)(e.red))s.Z.equalsArray(e,i,r)||(s.Z.pack(e,i,r),n=!0);else{if(!(0,a.Z)(e.x))throw new h.Z("Invalid vec4 value.");o.Z.equalsArray(e,i,r)||(o.Z.pack(e,i,r),n=!0)}r+=4}n&&this._gl.uniform4fv(this._location,i)},g.prototype.set=function(){const t=this._gl,e=t.TEXTURE0+this.textureUnitIndex,i=this.value,n=i.length;for(let r=0;r<n;++r){const n=i[r];t.activeTexture(e+r),t.bindTexture(n._target,n._texture)}},g.prototype._setSampler=function(t){this.textureUnitIndex=t;const e=this._locations,i=e.length;for(let n=0;n<i;++n){const i=t+n;this._gl.uniform1i(e[n],i)}return t+i},Z.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1;for(let r=0;r<e;++r){const e=t[r];e!==i[r]&&(i[r]=e,n=!0)}n&&this._gl.uniform1iv(this._location,i)},y.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let r=!1,o=0;for(let s=0;s<e;++s){const e=t[s];n.Z.equalsArray(e,i,o)||(n.Z.pack(e,i,o),r=!0),o+=2}r&&this._gl.uniform2iv(this._location,i)},v.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,o=0;for(let s=0;s<e;++s){const e=t[s];r.Z.equalsArray(e,i,o)||(r.Z.pack(e,i,o),n=!0),o+=3}n&&this._gl.uniform3iv(this._location,i)},w.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,r=0;for(let s=0;s<e;++s){const e=t[s];o.Z.equalsArray(e,i,r)||(o.Z.pack(e,i,r),n=!0),r+=4}n&&this._gl.uniform4iv(this._location,i)},T.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,r=0;for(let o=0;o<e;++o){const e=t[o];l.Z.equalsArray(e,i,r)||(l.Z.pack(e,i,r),n=!0),r+=4}n&&this._gl.uniformMatrix2fv(this._location,!1,i)},b.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,r=0;for(let o=0;o<e;++o){const e=t[o];u.Z.equalsArray(e,i,r)||(u.Z.pack(e,i,r),n=!0),r+=9}n&&this._gl.uniformMatrix3fv(this._location,!1,i)},E.prototype.set=function(){const t=this.value,e=t.length,i=this._value;let n=!1,r=0;for(let o=0;o<e;++o){const e=t[o];c.Z.equalsArray(e,i,r)||(c.Z.pack(e,i,r),n=!0),r+=16}n&&this._gl.uniformMatrix4fv(this._location,!1,i)};const x=function(t,e,i,n){switch(e.type){case t.FLOAT:return new f(t,e,i,n);case t.FLOAT_VEC2:return new p(t,e,i,n);case t.FLOAT_VEC3:return new _(t,e,i,n);case t.FLOAT_VEC4:return new m(t,e,i,n);case t.SAMPLER_2D:case t.SAMPLER_CUBE:return new g(t,e,i,n);case t.INT:case t.BOOL:return new Z(t,e,i,n);case t.INT_VEC2:case t.BOOL_VEC2:return new y(t,e,i,n);case t.INT_VEC3:case t.BOOL_VEC3:return new v(t,e,i,n);case t.INT_VEC4:case t.BOOL_VEC4:return new w(t,e,i,n);case t.FLOAT_MAT2:return new T(t,e,i,n);case t.FLOAT_MAT3:return new b(t,e,i,n);case t.FLOAT_MAT4:return new E(t,e,i,n);default:throw new d.Z(`Unrecognized uniform type: ${e.type} for uniform "${i}".`)}}},30396:(t,e,i)=>{i.d(e,{Z:()=>n});const n=function t(e){if("object"!=typeof e||null===e)return e;let i;const n=Object.keys(e);for(let r=0;r<n.length;r++)i=n[r],e.hasOwnProperty(i)&&"_applyFunctions"!==i&&(e[i]=t(e[i]));return Object.freeze(e)}},3492:(t,e,i)=>{i.d(e,{Z:()=>h});var n=i(17497),r=i(54485),o=i(20176),s=i(67197),a=i(83159);const h=function(t,e,i){if(n.Z.defined("context",t),!((0,r.Z)(e)&&(0,r.Z)(e.positiveX)&&(0,r.Z)(e.negativeX)&&(0,r.Z)(e.positiveY)&&(0,r.Z)(e.negativeY)&&(0,r.Z)(e.positiveZ)&&(0,r.Z)(e.negativeZ)))throw new o.Z("urls is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");const h={flipY:!0,skipColorSpaceConversion:i,preferImageBitmap:!0},l=[s.Z.createIfNeeded(e.positiveX).fetchImage(h),s.Z.createIfNeeded(e.negativeX).fetchImage(h),s.Z.createIfNeeded(e.positiveY).fetchImage(h),s.Z.createIfNeeded(e.negativeY).fetchImage(h),s.Z.createIfNeeded(e.positiveZ).fetchImage(h),s.Z.createIfNeeded(e.negativeZ).fetchImage(h)];return Promise.all(l).then((function(e){return new a.Z({context:t,source:{positiveX:e[0],negativeX:e[1],positiveY:e[2],negativeY:e[3],positiveZ:e[4],negativeZ:e[5]}})}))}},7589:(t,e,i)=>{i.d(e,{Z:()=>h});var n=i(54485),r=i(20176);function o(t,e,i){const n=new RegExp(`(^|[^\\w])(${t})($|[^\\w])`,"g"),r=i.length;for(let t=0;t<r;++t){const r=i[t];i[t]=r.replace(n,`$1${e}$3`)}}function s(t,e){-1===e.indexOf(t)&&e.push(t)}function a(t,e,i){!function(t,e,i){const n=i.length;for(let r=0;r<n;++r){const n=i[r];i[r]=n.replace(t,e)}}(new RegExp(`#extension\\s+GL_${t}\\s+:\\s+[a-zA-Z0-9]+\\s*$`,"g"),"",i),o(`GL_${t}`,e,i)}const h=function(t,e){const i=/#define OUTPUT_DECLARATION/,h=t.split("\n");if(/#version 300 es/g.test(t))return t;let l,u,c=-1;for(l=0;l<h.length;++l)if(u=h[l],i.test(u)){c=l;break}if(-1===c)throw new r.Z("Could not find a #define OUTPUT_DECLARATION!");const d=[];for(l=0;l<10;l++){const e=`gl_FragData\\[${l}\\]`,i=`czm_out${l}`;new RegExp(e,"g").test(t)&&(s(i,d),o(e,i,h),h.splice(c,0,`layout(location = ${l}) out vec4 ${i};`),c+=1)}const f="czm_fragColor";(function(t,e){const i=new RegExp(`(^|[^\\w])(${t})($|[^\\w])`,"g"),n=e.length;for(let t=0;t<n;++t){const n=e[t];if(i.test(n))return!0}return!1})("gl_FragColor",h)&&(s(f,d),o("gl_FragColor",f,h),h.splice(c,0,"layout(location = 0) out vec4 czm_fragColor;"),c+=1);const p=function(t,e){const i={},r=t.length,o=[];for(let s=0;s<e.length;++s){const a=e[s],h=/(#ifdef|#if)/g.test(a),l=/#else/g.test(a),u=/#endif/g.test(a);if(h)o.push(a);else if(l){let t=o[o.length-1].replace("ifdef","ifndef");/if/g.test(t)&&(t=t.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),o.pop(),o.push(t)}else if(u)o.pop();else if(!/layout/g.test(a))for(let e=0;e<r;++e){const r=t[e];-1!==a.indexOf(r)&&((0,n.Z)(i[r])?i[r]=i[r].filter((function(t){return o.indexOf(t)>=0})):i[r]=o.slice())}}return i}(d,h),_={};for(l=0;l<h.length;l++){u=h[l];for(const t in p)if(p.hasOwnProperty(t)){new RegExp(`(layout)[^]+(out)[^]+(${t})[^]+`,"g").test(u)&&(_[u]=t)}}for(const t in _)if(_.hasOwnProperty(t)){const e=_[t];let i=h.indexOf(t);const n=p[e],r=n.length;for(let t=0;t<r;t++)h.splice(i,0,n[t]);i+=r+1;for(let t=r-1;t>=0;t--)h.splice(i,0,`#endif //${n[t]}`)}const m="WEBGL_2",g="#version 300 es";let Z=!1;for(l=0;l<h.length;l++)if(/#version/.test(h[l])){h[l]=g,Z=!0;break}return Z||h.splice(0,0,g),h.splice(1,0,"#define WEBGL_2"),a("EXT_draw_buffers",m,h),a("EXT_frag_depth",m,h),a("OES_standard_derivatives",m,h),o("texture2D","texture",h),o("texture3D","texture",h),o("textureCube","texture",h),o("gl_FragDepthEXT","gl_FragDepth",h),e?o("varying","in",h):(o("attribute","in",h),o("varying","out",h)),function(t){let e="";const i=t.length;for(let n=0;n<i;++n)e+=`${t[n]}\n`;return e}(h)}}}]);