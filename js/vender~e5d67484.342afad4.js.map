{"version":3,"file":"js/vender~e5d67484.342afad4.js","mappings":"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","sources":["webpack:///../../../node_modules/@babylonjs/core/Misc/HighDynamicRange/cubemapToSphericalPolynomial.js","webpack:///../../../node_modules/@babylonjs/core/Misc/HighDynamicRange/hdr.js","webpack:///../../../node_modules/@babylonjs/core/Misc/HighDynamicRange/panoramaToCubemap.js","webpack:///../../../node_modules/@babylonjs/core/Misc/andOrNotEvaluator.js","webpack:///../../../node_modules/@babylonjs/core/Misc/arrayTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/basis.js","webpack:///../../../node_modules/@babylonjs/core/Misc/brdfTextureTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/codeStringParsingTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/computePressure.js","webpack:///../../../node_modules/@babylonjs/core/Misc/copyTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/coroutine.js","webpack:///../../../node_modules/@babylonjs/core/Misc/dataReader.js","webpack:///../../../node_modules/@babylonjs/core/Misc/dds.js","webpack:///../../../node_modules/@babylonjs/core/Misc/decorators.js","webpack:///../../../node_modules/@babylonjs/core/Misc/deepCopier.js","webpack:///../../../node_modules/@babylonjs/core/Misc/deferred.js","webpack:///../../../node_modules/@babylonjs/core/Misc/depthReducer.js","webpack:///../../../node_modules/@babylonjs/core/Misc/devTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/domManagement.js","webpack:///../../../node_modules/@babylonjs/core/Misc/environmentTextureTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/error.js","webpack:///../../../node_modules/@babylonjs/core/Misc/fileTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/filesInputStore.js","webpack:///../../../node_modules/@babylonjs/core/Misc/gradients.js","webpack:///../../../node_modules/@babylonjs/core/Misc/guid.js","webpack:///../../../node_modules/@babylonjs/core/Misc/assetsManager.js","webpack:///../../../node_modules/@babylonjs/core/Misc/meshExploder.js","webpack:///../../../node_modules/@babylonjs/core/Misc/filesInput.js","webpack:///../../../node_modules/@babylonjs/core/Misc/sceneOptimizer.js","webpack:///../../../node_modules/@babylonjs/core/Misc/sceneSerializer.js","webpack:///../../../node_modules/@babylonjs/core/Misc/videoRecorder.js","webpack:///../../../node_modules/@babylonjs/core/Misc/screenshotTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/iInspectable.js","webpack:///../../../node_modules/@babylonjs/core/Misc/trajectoryClassifier.js","webpack:///../../../node_modules/@babylonjs/core/Misc/dataStorage.js","webpack:///../../../node_modules/@babylonjs/core/Misc/sceneRecorder.js","webpack:///../../../node_modules/@babylonjs/core/Misc/reflector.js","webpack:///../../../node_modules/@babylonjs/core/Misc/PerformanceViewer/dynamicFloat32Array.js","webpack:///../../../node_modules/@babylonjs/core/Misc/PerformanceViewer/performanceViewerCollector.js","webpack:///../../../node_modules/@babylonjs/core/Misc/PerformanceViewer/performanceViewerCollectionStrategies.js","webpack:///../../../node_modules/@babylonjs/core/Misc/PerformanceViewer/performanceViewerSceneExtension.js","webpack:///../../../node_modules/@babylonjs/core/Misc/observableCoroutine.js","webpack:///../../../node_modules/@babylonjs/core/Misc/instantiationTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/khronosTextureContainer.js","webpack:///../../../node_modules/@babylonjs/core/Misc/khronosTextureContainer2.js","webpack:///../../../node_modules/@babylonjs/core/Misc/logger.js","webpack:///../../../node_modules/@babylonjs/core/Misc/minMaxReducer.js","webpack:///../../../node_modules/@babylonjs/core/Misc/observable.js","webpack:///../../../node_modules/@babylonjs/core/Misc/perfCounter.js","webpack:///../../../node_modules/@babylonjs/core/Misc/performanceMonitor.js","webpack:///../../../node_modules/@babylonjs/core/Misc/pivotTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/precisionDate.js","webpack:///../../../node_modules/@babylonjs/core/Misc/retryStrategy.js","webpack:///../../../node_modules/@babylonjs/core/Misc/rgbdTextureTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/smartArray.js","webpack:///../../../node_modules/@babylonjs/core/Misc/stringDictionary.js","webpack:///../../../node_modules/@babylonjs/core/Misc/stringTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/tags.js","webpack:///../../../node_modules/@babylonjs/core/Misc/textureTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/tga.js","webpack:///../../../node_modules/@babylonjs/core/Misc/timer.js","webpack:///../../../node_modules/@babylonjs/core/Misc/timingTools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/tools.js","webpack:///../../../node_modules/@babylonjs/core/Misc/typeStore.js","webpack:///../../../node_modules/@babylonjs/core/Misc/uniqueIdGenerator.js","webpack:///../../../node_modules/@babylonjs/core/Misc/virtualJoystick.js","webpack:///../../../node_modules/@babylonjs/core/Misc/webRequest.js","webpack:///../../../node_modules/@babylonjs/core/Misc/workerPool.js","webpack:///../../../node_modules/@babylonjs/core/Morph/morphTarget.js","webpack:///../../../node_modules/@babylonjs/core/Morph/morphTargetManager.js","webpack:///../../../node_modules/@babylonjs/core/Navigation/Plugins/recastJSPlugin.js","webpack:///../../../node_modules/@babylonjs/core/Offline/database.js"],"sourcesContent":["import { Vector3 } from \"../../Maths/math.vector.js\";\nimport { Scalar } from \"../../Maths/math.scalar.js\";\nimport { SphericalPolynomial, SphericalHarmonics } from \"../../Maths/sphericalPolynomial.js\";\n\nimport { ToLinearSpace } from \"../../Maths/math.constants.js\";\nimport { Color3 } from \"../../Maths/math.color.js\";\nvar FileFaceOrientation = /** @class */ (function () {\n    function FileFaceOrientation(name, worldAxisForNormal, worldAxisForFileX, worldAxisForFileY) {\n        this.name = name;\n        this.worldAxisForNormal = worldAxisForNormal;\n        this.worldAxisForFileX = worldAxisForFileX;\n        this.worldAxisForFileY = worldAxisForFileY;\n    }\n    return FileFaceOrientation;\n}());\n/**\n * Helper class dealing with the extraction of spherical polynomial dataArray\n * from a cube map.\n */\nvar CubeMapToSphericalPolynomialTools = /** @class */ (function () {\n    function CubeMapToSphericalPolynomialTools() {\n    }\n    /**\n     * Converts a texture to the according Spherical Polynomial data.\n     * This extracts the first 3 orders only as they are the only one used in the lighting.\n     *\n     * @param texture The texture to extract the information from.\n     * @return The Spherical Polynomial data.\n     */\n    CubeMapToSphericalPolynomialTools.ConvertCubeMapTextureToSphericalPolynomial = function (texture) {\n        var _this = this;\n        var _a;\n        if (!texture.isCube) {\n            // Only supports cube Textures currently.\n            return null;\n        }\n        (_a = texture.getScene()) === null || _a === void 0 ? void 0 : _a.getEngine().flushFramebuffer();\n        var size = texture.getSize().width;\n        var rightPromise = texture.readPixels(0, undefined, undefined, false);\n        var leftPromise = texture.readPixels(1, undefined, undefined, false);\n        var upPromise;\n        var downPromise;\n        if (texture.isRenderTarget) {\n            upPromise = texture.readPixels(3, undefined, undefined, false);\n            downPromise = texture.readPixels(2, undefined, undefined, false);\n        }\n        else {\n            upPromise = texture.readPixels(2, undefined, undefined, false);\n            downPromise = texture.readPixels(3, undefined, undefined, false);\n        }\n        var frontPromise = texture.readPixels(4, undefined, undefined, false);\n        var backPromise = texture.readPixels(5, undefined, undefined, false);\n        var gammaSpace = texture.gammaSpace;\n        // Always read as RGBA.\n        var format = 5;\n        var type = 0;\n        if (texture.textureType == 1 || texture.textureType == 2) {\n            type = 1;\n        }\n        return new Promise(function (resolve) {\n            Promise.all([leftPromise, rightPromise, upPromise, downPromise, frontPromise, backPromise]).then(function (_a) {\n                var left = _a[0], right = _a[1], up = _a[2], down = _a[3], front = _a[4], back = _a[5];\n                var cubeInfo = {\n                    size: size,\n                    right: right,\n                    left: left,\n                    up: up,\n                    down: down,\n                    front: front,\n                    back: back,\n                    format: format,\n                    type: type,\n                    gammaSpace: gammaSpace,\n                };\n                resolve(_this.ConvertCubeMapToSphericalPolynomial(cubeInfo));\n            });\n        });\n    };\n    /**\n     * Compute the area on the unit sphere of the rectangle defined by (x,y) and the origin\n     * See https://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/\n     * @param x\n     * @param y\n     */\n    CubeMapToSphericalPolynomialTools._AreaElement = function (x, y) {\n        return Math.atan2(x * y, Math.sqrt(x * x + y * y + 1));\n    };\n    /**\n     * Converts a cubemap to the according Spherical Polynomial data.\n     * This extracts the first 3 orders only as they are the only one used in the lighting.\n     *\n     * @param cubeInfo The Cube map to extract the information from.\n     * @return The Spherical Polynomial data.\n     */\n    CubeMapToSphericalPolynomialTools.ConvertCubeMapToSphericalPolynomial = function (cubeInfo) {\n        var sphericalHarmonics = new SphericalHarmonics();\n        var totalSolidAngle = 0.0;\n        // The (u,v) range is [-1,+1], so the distance between each texel is 2/Size.\n        var du = 2.0 / cubeInfo.size;\n        var dv = du;\n        var halfTexel = 0.5 * du;\n        // The (u,v) of the first texel is half a texel from the corner (-1,-1).\n        var minUV = halfTexel - 1.0;\n        for (var faceIndex = 0; faceIndex < 6; faceIndex++) {\n            var fileFace = this._FileFaces[faceIndex];\n            var dataArray = cubeInfo[fileFace.name];\n            var v = minUV;\n            // TODO: we could perform the summation directly into a SphericalPolynomial (SP), which is more efficient than SphericalHarmonic (SH).\n            // This is possible because during the summation we do not need the SH-specific properties, e.g. orthogonality.\n            // Because SP is still linear, so summation is fine in that basis.\n            var stride = cubeInfo.format === 5 ? 4 : 3;\n            for (var y = 0; y < cubeInfo.size; y++) {\n                var u = minUV;\n                for (var x = 0; x < cubeInfo.size; x++) {\n                    // World direction (not normalised)\n                    var worldDirection = fileFace.worldAxisForFileX.scale(u).add(fileFace.worldAxisForFileY.scale(v)).add(fileFace.worldAxisForNormal);\n                    worldDirection.normalize();\n                    var deltaSolidAngle = this._AreaElement(u - halfTexel, v - halfTexel) -\n                        this._AreaElement(u - halfTexel, v + halfTexel) -\n                        this._AreaElement(u + halfTexel, v - halfTexel) +\n                        this._AreaElement(u + halfTexel, v + halfTexel);\n                    var r = dataArray[y * cubeInfo.size * stride + x * stride + 0];\n                    var g = dataArray[y * cubeInfo.size * stride + x * stride + 1];\n                    var b = dataArray[y * cubeInfo.size * stride + x * stride + 2];\n                    // Prevent NaN harmonics with extreme HDRI data.\n                    if (isNaN(r)) {\n                        r = 0;\n                    }\n                    if (isNaN(g)) {\n                        g = 0;\n                    }\n                    if (isNaN(b)) {\n                        b = 0;\n                    }\n                    // Handle Integer types.\n                    if (cubeInfo.type === 0) {\n                        r /= 255;\n                        g /= 255;\n                        b /= 255;\n                    }\n                    // Handle Gamma space textures.\n                    if (cubeInfo.gammaSpace) {\n                        r = Math.pow(Scalar.Clamp(r), ToLinearSpace);\n                        g = Math.pow(Scalar.Clamp(g), ToLinearSpace);\n                        b = Math.pow(Scalar.Clamp(b), ToLinearSpace);\n                    }\n                    // Prevent to explode in case of really high dynamic ranges.\n                    // sh 3 would not be enough to accurately represent it.\n                    var max = 4096;\n                    r = Scalar.Clamp(r, 0, max);\n                    g = Scalar.Clamp(g, 0, max);\n                    b = Scalar.Clamp(b, 0, max);\n                    var color = new Color3(r, g, b);\n                    sphericalHarmonics.addLight(worldDirection, color, deltaSolidAngle);\n                    totalSolidAngle += deltaSolidAngle;\n                    u += du;\n                }\n                v += dv;\n            }\n        }\n        // Solid angle for entire sphere is 4*pi\n        var sphereSolidAngle = 4.0 * Math.PI;\n        // Adjust the solid angle to allow for how many faces we processed.\n        var facesProcessed = 6.0;\n        var expectedSolidAngle = (sphereSolidAngle * facesProcessed) / 6.0;\n        // Adjust the harmonics so that the accumulated solid angle matches the expected solid angle.\n        // This is needed because the numerical integration over the cube uses a\n        // small angle approximation of solid angle for each texel (see deltaSolidAngle),\n        // and also to compensate for accumulative error due to float precision in the summation.\n        var correctionFactor = expectedSolidAngle / totalSolidAngle;\n        sphericalHarmonics.scaleInPlace(correctionFactor);\n        sphericalHarmonics.convertIncidentRadianceToIrradiance();\n        sphericalHarmonics.convertIrradianceToLambertianRadiance();\n        return SphericalPolynomial.FromHarmonics(sphericalHarmonics);\n    };\n    CubeMapToSphericalPolynomialTools._FileFaces = [\n        new FileFaceOrientation(\"right\", new Vector3(1, 0, 0), new Vector3(0, 0, -1), new Vector3(0, -1, 0)),\n        new FileFaceOrientation(\"left\", new Vector3(-1, 0, 0), new Vector3(0, 0, 1), new Vector3(0, -1, 0)),\n        new FileFaceOrientation(\"up\", new Vector3(0, 1, 0), new Vector3(1, 0, 0), new Vector3(0, 0, 1)),\n        new FileFaceOrientation(\"down\", new Vector3(0, -1, 0), new Vector3(1, 0, 0), new Vector3(0, 0, -1)),\n        new FileFaceOrientation(\"front\", new Vector3(0, 0, 1), new Vector3(1, 0, 0), new Vector3(0, -1, 0)),\n        new FileFaceOrientation(\"back\", new Vector3(0, 0, -1), new Vector3(-1, 0, 0), new Vector3(0, -1, 0)), // -Z bottom\n    ];\n    return CubeMapToSphericalPolynomialTools;\n}());\nexport { CubeMapToSphericalPolynomialTools };\n//# sourceMappingURL=cubemapToSphericalPolynomial.js.map","import { PanoramaToCubeMapTools } from \"./panoramaToCubemap.js\";\n/**\n * This groups tools to convert HDR texture to native colors array.\n */\nvar HDRTools = /** @class */ (function () {\n    function HDRTools() {\n    }\n    HDRTools._Ldexp = function (mantissa, exponent) {\n        if (exponent > 1023) {\n            return mantissa * Math.pow(2, 1023) * Math.pow(2, exponent - 1023);\n        }\n        if (exponent < -1074) {\n            return mantissa * Math.pow(2, -1074) * Math.pow(2, exponent + 1074);\n        }\n        return mantissa * Math.pow(2, exponent);\n    };\n    HDRTools._Rgbe2float = function (float32array, red, green, blue, exponent, index) {\n        if (exponent > 0) {\n            /*nonzero pixel*/\n            exponent = this._Ldexp(1.0, exponent - (128 + 8));\n            float32array[index + 0] = red * exponent;\n            float32array[index + 1] = green * exponent;\n            float32array[index + 2] = blue * exponent;\n        }\n        else {\n            float32array[index + 0] = 0;\n            float32array[index + 1] = 0;\n            float32array[index + 2] = 0;\n        }\n    };\n    HDRTools._ReadStringLine = function (uint8array, startIndex) {\n        var line = \"\";\n        var character = \"\";\n        for (var i = startIndex; i < uint8array.length - startIndex; i++) {\n            character = String.fromCharCode(uint8array[i]);\n            if (character == \"\\n\") {\n                break;\n            }\n            line += character;\n        }\n        return line;\n    };\n    /**\n     * Reads header information from an RGBE texture stored in a native array.\n     * More information on this format are available here:\n     * https://en.wikipedia.org/wiki/RGBE_image_format\n     *\n     * @param uint8array The binary file stored in  native array.\n     * @return The header information.\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    HDRTools.RGBE_ReadHeader = function (uint8array) {\n        var height = 0;\n        var width = 0;\n        var line = this._ReadStringLine(uint8array, 0);\n        if (line[0] != \"#\" || line[1] != \"?\") {\n            throw \"Bad HDR Format.\";\n        }\n        var endOfHeader = false;\n        var findFormat = false;\n        var lineIndex = 0;\n        do {\n            lineIndex += line.length + 1;\n            line = this._ReadStringLine(uint8array, lineIndex);\n            if (line == \"FORMAT=32-bit_rle_rgbe\") {\n                findFormat = true;\n            }\n            else if (line.length == 0) {\n                endOfHeader = true;\n            }\n        } while (!endOfHeader);\n        if (!findFormat) {\n            throw \"HDR Bad header format, unsupported FORMAT\";\n        }\n        lineIndex += line.length + 1;\n        line = this._ReadStringLine(uint8array, lineIndex);\n        var sizeRegexp = /^-Y (.*) \\+X (.*)$/g;\n        var match = sizeRegexp.exec(line);\n        // TODO. Support +Y and -X if needed.\n        if (!match || match.length < 3) {\n            throw \"HDR Bad header format, no size\";\n        }\n        width = parseInt(match[2]);\n        height = parseInt(match[1]);\n        if (width < 8 || width > 0x7fff) {\n            throw \"HDR Bad header format, unsupported size\";\n        }\n        lineIndex += line.length + 1;\n        return {\n            height: height,\n            width: width,\n            dataPosition: lineIndex,\n        };\n    };\n    /**\n     * Returns the cubemap information (each faces texture data) extracted from an RGBE texture.\n     * This RGBE texture needs to store the information as a panorama.\n     *\n     * More information on this format are available here:\n     * https://en.wikipedia.org/wiki/RGBE_image_format\n     *\n     * @param buffer The binary file stored in an array buffer.\n     * @param size The expected size of the extracted cubemap.\n     * @return The Cube Map information.\n     */\n    HDRTools.GetCubeMapTextureData = function (buffer, size) {\n        var uint8array = new Uint8Array(buffer);\n        var hdrInfo = this.RGBE_ReadHeader(uint8array);\n        var data = this.RGBE_ReadPixels(uint8array, hdrInfo);\n        var cubeMapData = PanoramaToCubeMapTools.ConvertPanoramaToCubemap(data, hdrInfo.width, hdrInfo.height, size);\n        return cubeMapData;\n    };\n    /**\n     * Returns the pixels data extracted from an RGBE texture.\n     * This pixels will be stored left to right up to down in the R G B order in one array.\n     *\n     * More information on this format are available here:\n     * https://en.wikipedia.org/wiki/RGBE_image_format\n     *\n     * @param uint8array The binary file stored in an array buffer.\n     * @param hdrInfo The header information of the file.\n     * @return The pixels data in RGB right to left up to down order.\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    HDRTools.RGBE_ReadPixels = function (uint8array, hdrInfo) {\n        return this._RGBEReadPixelsRLE(uint8array, hdrInfo);\n    };\n    HDRTools._RGBEReadPixelsRLE = function (uint8array, hdrInfo) {\n        var num_scanlines = hdrInfo.height;\n        var scanline_width = hdrInfo.width;\n        var a, b, c, d, count;\n        var dataIndex = hdrInfo.dataPosition;\n        var index = 0, endIndex = 0, i = 0;\n        var scanLineArrayBuffer = new ArrayBuffer(scanline_width * 4); // four channel R G B E\n        var scanLineArray = new Uint8Array(scanLineArrayBuffer);\n        // 3 channels of 4 bytes per pixel in float.\n        var resultBuffer = new ArrayBuffer(hdrInfo.width * hdrInfo.height * 4 * 3);\n        var resultArray = new Float32Array(resultBuffer);\n        // read in each successive scanline\n        while (num_scanlines > 0) {\n            a = uint8array[dataIndex++];\n            b = uint8array[dataIndex++];\n            c = uint8array[dataIndex++];\n            d = uint8array[dataIndex++];\n            if (a != 2 || b != 2 || c & 0x80 || hdrInfo.width < 8 || hdrInfo.width > 32767) {\n                return this._RGBEReadPixelsNOTRLE(uint8array, hdrInfo);\n            }\n            if (((c << 8) | d) != scanline_width) {\n                throw \"HDR Bad header format, wrong scan line width\";\n            }\n            index = 0;\n            // read each of the four channels for the scanline into the buffer\n            for (i = 0; i < 4; i++) {\n                endIndex = (i + 1) * scanline_width;\n                while (index < endIndex) {\n                    a = uint8array[dataIndex++];\n                    b = uint8array[dataIndex++];\n                    if (a > 128) {\n                        // a run of the same value\n                        count = a - 128;\n                        if (count == 0 || count > endIndex - index) {\n                            throw \"HDR Bad Format, bad scanline data (run)\";\n                        }\n                        while (count-- > 0) {\n                            scanLineArray[index++] = b;\n                        }\n                    }\n                    else {\n                        // a non-run\n                        count = a;\n                        if (count == 0 || count > endIndex - index) {\n                            throw \"HDR Bad Format, bad scanline data (non-run)\";\n                        }\n                        scanLineArray[index++] = b;\n                        if (--count > 0) {\n                            for (var j = 0; j < count; j++) {\n                                scanLineArray[index++] = uint8array[dataIndex++];\n                            }\n                        }\n                    }\n                }\n            }\n            // now convert data from buffer into floats\n            for (i = 0; i < scanline_width; i++) {\n                a = scanLineArray[i];\n                b = scanLineArray[i + scanline_width];\n                c = scanLineArray[i + 2 * scanline_width];\n                d = scanLineArray[i + 3 * scanline_width];\n                this._Rgbe2float(resultArray, a, b, c, d, (hdrInfo.height - num_scanlines) * scanline_width * 3 + i * 3);\n            }\n            num_scanlines--;\n        }\n        return resultArray;\n    };\n    HDRTools._RGBEReadPixelsNOTRLE = function (uint8array, hdrInfo) {\n        // this file is not run length encoded\n        // read values sequentially\n        var num_scanlines = hdrInfo.height;\n        var scanline_width = hdrInfo.width;\n        var a, b, c, d, i;\n        var dataIndex = hdrInfo.dataPosition;\n        // 3 channels of 4 bytes per pixel in float.\n        var resultBuffer = new ArrayBuffer(hdrInfo.width * hdrInfo.height * 4 * 3);\n        var resultArray = new Float32Array(resultBuffer);\n        // read in each successive scanline\n        while (num_scanlines > 0) {\n            for (i = 0; i < hdrInfo.width; i++) {\n                a = uint8array[dataIndex++];\n                b = uint8array[dataIndex++];\n                c = uint8array[dataIndex++];\n                d = uint8array[dataIndex++];\n                this._Rgbe2float(resultArray, a, b, c, d, (hdrInfo.height - num_scanlines) * scanline_width * 3 + i * 3);\n            }\n            num_scanlines--;\n        }\n        return resultArray;\n    };\n    return HDRTools;\n}());\nexport { HDRTools };\n//# sourceMappingURL=hdr.js.map","import { Vector3 } from \"../../Maths/math.vector.js\";\n\n/**\n * Helper class useful to convert panorama picture to their cubemap representation in 6 faces.\n */\nvar PanoramaToCubeMapTools = /** @class */ (function () {\n    function PanoramaToCubeMapTools() {\n    }\n    /**\n     * Converts a panorama stored in RGB right to left up to down format into a cubemap (6 faces).\n     *\n     * @param float32Array The source data.\n     * @param inputWidth The width of the input panorama.\n     * @param inputHeight The height of the input panorama.\n     * @param size The willing size of the generated cubemap (each faces will be size * size pixels)\n     * @return The cubemap data\n     */\n    PanoramaToCubeMapTools.ConvertPanoramaToCubemap = function (float32Array, inputWidth, inputHeight, size) {\n        if (!float32Array) {\n            throw \"ConvertPanoramaToCubemap: input cannot be null\";\n        }\n        if (float32Array.length != inputWidth * inputHeight * 3) {\n            throw \"ConvertPanoramaToCubemap: input size is wrong\";\n        }\n        var textureFront = this.CreateCubemapTexture(size, this.FACE_FRONT, float32Array, inputWidth, inputHeight);\n        var textureBack = this.CreateCubemapTexture(size, this.FACE_BACK, float32Array, inputWidth, inputHeight);\n        var textureLeft = this.CreateCubemapTexture(size, this.FACE_LEFT, float32Array, inputWidth, inputHeight);\n        var textureRight = this.CreateCubemapTexture(size, this.FACE_RIGHT, float32Array, inputWidth, inputHeight);\n        var textureUp = this.CreateCubemapTexture(size, this.FACE_UP, float32Array, inputWidth, inputHeight);\n        var textureDown = this.CreateCubemapTexture(size, this.FACE_DOWN, float32Array, inputWidth, inputHeight);\n        return {\n            front: textureFront,\n            back: textureBack,\n            left: textureLeft,\n            right: textureRight,\n            up: textureUp,\n            down: textureDown,\n            size: size,\n            type: 1,\n            format: 4,\n            gammaSpace: false,\n        };\n    };\n    PanoramaToCubeMapTools.CreateCubemapTexture = function (texSize, faceData, float32Array, inputWidth, inputHeight) {\n        var buffer = new ArrayBuffer(texSize * texSize * 4 * 3);\n        var textureArray = new Float32Array(buffer);\n        var rotDX1 = faceData[1].subtract(faceData[0]).scale(1 / texSize);\n        var rotDX2 = faceData[3].subtract(faceData[2]).scale(1 / texSize);\n        var dy = 1 / texSize;\n        var fy = 0;\n        for (var y = 0; y < texSize; y++) {\n            var xv1 = faceData[0];\n            var xv2 = faceData[2];\n            for (var x = 0; x < texSize; x++) {\n                var v = xv2.subtract(xv1).scale(fy).add(xv1);\n                v.normalize();\n                var color = this.CalcProjectionSpherical(v, float32Array, inputWidth, inputHeight);\n                // 3 channels per pixels\n                textureArray[y * texSize * 3 + x * 3 + 0] = color.r;\n                textureArray[y * texSize * 3 + x * 3 + 1] = color.g;\n                textureArray[y * texSize * 3 + x * 3 + 2] = color.b;\n                xv1 = xv1.add(rotDX1);\n                xv2 = xv2.add(rotDX2);\n            }\n            fy += dy;\n        }\n        return textureArray;\n    };\n    PanoramaToCubeMapTools.CalcProjectionSpherical = function (vDir, float32Array, inputWidth, inputHeight) {\n        var theta = Math.atan2(vDir.z, vDir.x);\n        var phi = Math.acos(vDir.y);\n        while (theta < -Math.PI) {\n            theta += 2 * Math.PI;\n        }\n        while (theta > Math.PI) {\n            theta -= 2 * Math.PI;\n        }\n        var dx = theta / Math.PI;\n        var dy = phi / Math.PI;\n        // recenter.\n        dx = dx * 0.5 + 0.5;\n        var px = Math.round(dx * inputWidth);\n        if (px < 0) {\n            px = 0;\n        }\n        else if (px >= inputWidth) {\n            px = inputWidth - 1;\n        }\n        var py = Math.round(dy * inputHeight);\n        if (py < 0) {\n            py = 0;\n        }\n        else if (py >= inputHeight) {\n            py = inputHeight - 1;\n        }\n        var inputY = inputHeight - py - 1;\n        var r = float32Array[inputY * inputWidth * 3 + px * 3 + 0];\n        var g = float32Array[inputY * inputWidth * 3 + px * 3 + 1];\n        var b = float32Array[inputY * inputWidth * 3 + px * 3 + 2];\n        return {\n            r: r,\n            g: g,\n            b: b,\n        };\n    };\n    PanoramaToCubeMapTools.FACE_LEFT = [new Vector3(-1.0, -1.0, -1.0), new Vector3(1.0, -1.0, -1.0), new Vector3(-1.0, 1.0, -1.0), new Vector3(1.0, 1.0, -1.0)];\n    PanoramaToCubeMapTools.FACE_RIGHT = [new Vector3(1.0, -1.0, 1.0), new Vector3(-1.0, -1.0, 1.0), new Vector3(1.0, 1.0, 1.0), new Vector3(-1.0, 1.0, 1.0)];\n    PanoramaToCubeMapTools.FACE_FRONT = [new Vector3(1.0, -1.0, -1.0), new Vector3(1.0, -1.0, 1.0), new Vector3(1.0, 1.0, -1.0), new Vector3(1.0, 1.0, 1.0)];\n    PanoramaToCubeMapTools.FACE_BACK = [new Vector3(-1.0, -1.0, 1.0), new Vector3(-1.0, -1.0, -1.0), new Vector3(-1.0, 1.0, 1.0), new Vector3(-1.0, 1.0, -1.0)];\n    PanoramaToCubeMapTools.FACE_DOWN = [new Vector3(1.0, 1.0, -1.0), new Vector3(1.0, 1.0, 1.0), new Vector3(-1.0, 1.0, -1.0), new Vector3(-1.0, 1.0, 1.0)];\n    PanoramaToCubeMapTools.FACE_UP = [new Vector3(-1.0, -1.0, -1.0), new Vector3(-1.0, -1.0, 1.0), new Vector3(1.0, -1.0, -1.0), new Vector3(1.0, -1.0, 1.0)];\n    return PanoramaToCubeMapTools;\n}());\nexport { PanoramaToCubeMapTools };\n//# sourceMappingURL=panoramaToCubemap.js.map","/**\n * Class used to evaluate queries containing `and` and `or` operators\n */\nvar AndOrNotEvaluator = /** @class */ (function () {\n    function AndOrNotEvaluator() {\n    }\n    /**\n     * Evaluate a query\n     * @param query defines the query to evaluate\n     * @param evaluateCallback defines the callback used to filter result\n     * @returns true if the query matches\n     */\n    AndOrNotEvaluator.Eval = function (query, evaluateCallback) {\n        if (!query.match(/\\([^()]*\\)/g)) {\n            query = AndOrNotEvaluator._HandleParenthesisContent(query, evaluateCallback);\n        }\n        else {\n            query = query.replace(/\\([^()]*\\)/g, function (r) {\n                // remove parenthesis\n                r = r.slice(1, r.length - 1);\n                return AndOrNotEvaluator._HandleParenthesisContent(r, evaluateCallback);\n            });\n        }\n        if (query === \"true\") {\n            return true;\n        }\n        if (query === \"false\") {\n            return false;\n        }\n        return AndOrNotEvaluator.Eval(query, evaluateCallback);\n    };\n    AndOrNotEvaluator._HandleParenthesisContent = function (parenthesisContent, evaluateCallback) {\n        evaluateCallback =\n            evaluateCallback ||\n                (function (r) {\n                    return r === \"true\" ? true : false;\n                });\n        var result;\n        var or = parenthesisContent.split(\"||\");\n        for (var i in or) {\n            if (Object.prototype.hasOwnProperty.call(or, i)) {\n                var ori = AndOrNotEvaluator._SimplifyNegation(or[i].trim());\n                var and = ori.split(\"&&\");\n                if (and.length > 1) {\n                    for (var j = 0; j < and.length; ++j) {\n                        var andj = AndOrNotEvaluator._SimplifyNegation(and[j].trim());\n                        if (andj !== \"true\" && andj !== \"false\") {\n                            if (andj[0] === \"!\") {\n                                result = !evaluateCallback(andj.substring(1));\n                            }\n                            else {\n                                result = evaluateCallback(andj);\n                            }\n                        }\n                        else {\n                            result = andj === \"true\" ? true : false;\n                        }\n                        if (!result) {\n                            // no need to continue since 'false && ... && ...' will always return false\n                            ori = \"false\";\n                            break;\n                        }\n                    }\n                }\n                if (result || ori === \"true\") {\n                    // no need to continue since 'true || ... || ...' will always return true\n                    result = true;\n                    break;\n                }\n                // result equals false (or undefined)\n                if (ori !== \"true\" && ori !== \"false\") {\n                    if (ori[0] === \"!\") {\n                        result = !evaluateCallback(ori.substring(1));\n                    }\n                    else {\n                        result = evaluateCallback(ori);\n                    }\n                }\n                else {\n                    result = ori === \"true\" ? true : false;\n                }\n            }\n        }\n        // the whole parenthesis scope is replaced by 'true' or 'false'\n        return result ? \"true\" : \"false\";\n    };\n    AndOrNotEvaluator._SimplifyNegation = function (booleanString) {\n        booleanString = booleanString.replace(/^[\\s!]+/, function (r) {\n            // remove whitespaces\n            r = r.replace(/[\\s]/g, function () { return \"\"; });\n            return r.length % 2 ? \"!\" : \"\";\n        });\n        booleanString = booleanString.trim();\n        if (booleanString === \"!true\") {\n            booleanString = \"false\";\n        }\n        else if (booleanString === \"!false\") {\n            booleanString = \"true\";\n        }\n        return booleanString;\n    };\n    return AndOrNotEvaluator;\n}());\nexport { AndOrNotEvaluator };\n//# sourceMappingURL=andOrNotEvaluator.js.map","/**\n * Class containing a set of static utilities functions for arrays.\n */\nvar ArrayTools = /** @class */ (function () {\n    function ArrayTools() {\n    }\n    /**\n     * Returns an array of the given size filled with elements built from the given constructor and the parameters.\n     * @param size the number of element to construct and put in the array.\n     * @param itemBuilder a callback responsible for creating new instance of item. Called once per array entry.\n     * @returns a new array filled with new objects.\n     */\n    ArrayTools.BuildArray = function (size, itemBuilder) {\n        var a = [];\n        for (var i = 0; i < size; ++i) {\n            a.push(itemBuilder());\n        }\n        return a;\n    };\n    /**\n     * Returns a tuple of the given size filled with elements built from the given constructor and the parameters.\n     * @param size he number of element to construct and put in the tuple.\n     * @param itemBuilder a callback responsible for creating new instance of item. Called once per tuple entry.\n     * @returns a new tuple filled with new objects.\n     */\n    ArrayTools.BuildTuple = function (size, itemBuilder) {\n        return ArrayTools.BuildArray(size, itemBuilder);\n    };\n    return ArrayTools;\n}());\nexport { ArrayTools };\n//# sourceMappingURL=arrayTools.js.map","import { Tools } from \"./tools.js\";\nimport { Texture } from \"../Materials/Textures/texture.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Scalar } from \"../Maths/math.scalar.js\";\n\n/**\n * Info about the .basis files\n */\nvar BasisFileInfo = /** @class */ (function () {\n    function BasisFileInfo() {\n    }\n    return BasisFileInfo;\n}());\n/**\n * Result of transcoding a basis file\n */\nvar TranscodeResult = /** @class */ (function () {\n    function TranscodeResult() {\n    }\n    return TranscodeResult;\n}());\n/**\n * Configuration options for the Basis transcoder\n */\nvar BasisTranscodeConfiguration = /** @class */ (function () {\n    function BasisTranscodeConfiguration() {\n    }\n    return BasisTranscodeConfiguration;\n}());\nexport { BasisTranscodeConfiguration };\n/**\n * @hidden\n * Enum of basis transcoder formats\n */\nvar BASIS_FORMATS;\n(function (BASIS_FORMATS) {\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFETC1\"] = 0] = \"cTFETC1\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFBC1\"] = 1] = \"cTFBC1\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFBC4\"] = 2] = \"cTFBC4\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFPVRTC1_4_OPAQUE_ONLY\"] = 3] = \"cTFPVRTC1_4_OPAQUE_ONLY\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFBC7_M6_OPAQUE_ONLY\"] = 4] = \"cTFBC7_M6_OPAQUE_ONLY\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFETC2\"] = 5] = \"cTFETC2\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFBC3\"] = 6] = \"cTFBC3\";\n    BASIS_FORMATS[BASIS_FORMATS[\"cTFBC5\"] = 7] = \"cTFBC5\";\n})(BASIS_FORMATS || (BASIS_FORMATS = {}));\n/**\n * Used to load .Basis files\n * See https://github.com/BinomialLLC/basis_universal/tree/master/webgl\n */\nexport var BasisToolsOptions = {\n    /**\n     * URL to use when loading the basis transcoder\n     */\n    JSModuleURL: \"https://preview.babylonjs.com/basisTranscoder/basis_transcoder.js\",\n    /**\n     * URL to use when loading the wasm module for the transcoder\n     */\n    WasmModuleURL: \"https://preview.babylonjs.com/basisTranscoder/basis_transcoder.wasm\",\n};\n/**\n * Get the internal format to be passed to texImage2D corresponding to the .basis format value\n * @param basisFormat format chosen from GetSupportedTranscodeFormat\n * @param engine\n * @returns internal format corresponding to the Basis format\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport var GetInternalFormatFromBasisFormat = function (basisFormat, engine) {\n    var format;\n    switch (basisFormat) {\n        case BASIS_FORMATS.cTFETC1:\n            format = 36196;\n            break;\n        case BASIS_FORMATS.cTFBC1:\n            format = 33776;\n            break;\n        case BASIS_FORMATS.cTFBC4:\n            format = 33779;\n            break;\n    }\n    if (format === undefined) {\n        throw \"The chosen Basis transcoder format is not currently supported\";\n    }\n    return format;\n};\nvar _WorkerPromise = null;\nvar _Worker = null;\nvar _actionId = 0;\nvar _IgnoreSupportedFormats = false;\nvar _CreateWorkerAsync = function () {\n    if (!_WorkerPromise) {\n        _WorkerPromise = new Promise(function (res, reject) {\n            if (_Worker) {\n                res(_Worker);\n            }\n            else {\n                Tools.LoadFileAsync(BasisToolsOptions.WasmModuleURL)\n                    .then(function (wasmBinary) {\n                    var workerBlobUrl = URL.createObjectURL(new Blob([\"(\".concat(workerFunc, \")()\")], { type: \"application/javascript\" }));\n                    _Worker = new Worker(workerBlobUrl);\n                    var initHandler = function (msg) {\n                        if (msg.data.action === \"init\") {\n                            _Worker.removeEventListener(\"message\", initHandler);\n                            res(_Worker);\n                        }\n                        else if (msg.data.action === \"error\") {\n                            reject(msg.data.error || \"error initializing worker\");\n                        }\n                    };\n                    _Worker.addEventListener(\"message\", initHandler);\n                    _Worker.postMessage({ action: \"init\", url: BasisToolsOptions.JSModuleURL, wasmBinary: wasmBinary });\n                })\n                    .catch(reject);\n            }\n        });\n    }\n    return _WorkerPromise;\n};\n/**\n * Transcodes a loaded image file to compressed pixel data\n * @param data image data to transcode\n * @param config configuration options for the transcoding\n * @returns a promise resulting in the transcoded image\n */\nexport var TranscodeAsync = function (data, config) {\n    var dataView = data instanceof ArrayBuffer ? new Uint8Array(data) : data;\n    return new Promise(function (res, rej) {\n        _CreateWorkerAsync().then(function () {\n            var actionId = _actionId++;\n            var messageHandler = function (msg) {\n                if (msg.data.action === \"transcode\" && msg.data.id === actionId) {\n                    _Worker.removeEventListener(\"message\", messageHandler);\n                    if (!msg.data.success) {\n                        rej(\"Transcode is not supported on this device\");\n                    }\n                    else {\n                        res(msg.data);\n                    }\n                }\n            };\n            _Worker.addEventListener(\"message\", messageHandler);\n            var dataViewCopy = new Uint8Array(dataView.byteLength);\n            dataViewCopy.set(new Uint8Array(dataView.buffer, dataView.byteOffset, dataView.byteLength));\n            _Worker.postMessage({ action: \"transcode\", id: actionId, imageData: dataViewCopy, config: config, ignoreSupportedFormats: _IgnoreSupportedFormats }, [\n                dataViewCopy.buffer,\n            ]);\n        }, function (error) {\n            rej(error);\n        });\n    });\n};\n/**\n * Loads a texture from the transcode result\n * @param texture texture load to\n * @param transcodeResult the result of transcoding the basis file to load from\n */\nexport var LoadTextureFromTranscodeResult = function (texture, transcodeResult) {\n    var engine = texture.getEngine();\n    var _loop_1 = function (i) {\n        var rootImage = transcodeResult.fileInfo.images[i].levels[0];\n        texture._invertVScale = texture.invertY;\n        if (transcodeResult.format === -1) {\n            // No compatable compressed format found, fallback to RGB\n            texture.type = 10;\n            texture.format = 4;\n            if (engine._features.basisNeedsPOT && (Scalar.Log2(rootImage.width) % 1 !== 0 || Scalar.Log2(rootImage.height) % 1 !== 0)) {\n                // Create non power of two texture\n                var source_1 = new InternalTexture(engine, InternalTextureSource.Temp);\n                texture._invertVScale = texture.invertY;\n                source_1.type = 10;\n                source_1.format = 4;\n                // Fallback requires aligned width/height\n                source_1.width = (rootImage.width + 3) & ~3;\n                source_1.height = (rootImage.height + 3) & ~3;\n                engine._bindTextureDirectly(engine._gl.TEXTURE_2D, source_1, true);\n                engine._uploadDataToTextureDirectly(source_1, rootImage.transcodedPixels, i, 0, 4, true);\n                // Resize to power of two\n                engine._rescaleTexture(source_1, texture, engine.scenes[0], engine._getInternalFormat(4), function () {\n                    engine._releaseTexture(source_1);\n                    engine._bindTextureDirectly(engine._gl.TEXTURE_2D, texture, true);\n                });\n            }\n            else {\n                // Fallback is already inverted\n                texture._invertVScale = !texture.invertY;\n                // Upload directly\n                texture.width = (rootImage.width + 3) & ~3;\n                texture.height = (rootImage.height + 3) & ~3;\n                engine._uploadDataToTextureDirectly(texture, rootImage.transcodedPixels, i, 0, 4, true);\n            }\n        }\n        else {\n            texture.width = rootImage.width;\n            texture.height = rootImage.height;\n            texture.generateMipMaps = transcodeResult.fileInfo.images[i].levels.length > 1;\n            // Upload all mip levels in the file\n            transcodeResult.fileInfo.images[i].levels.forEach(function (level, index) {\n                engine._uploadCompressedDataToTextureDirectly(texture, BasisTools.GetInternalFormatFromBasisFormat(transcodeResult.format, engine), level.width, level.height, level.transcodedPixels, i, index);\n            });\n            if (engine._features.basisNeedsPOT && (Scalar.Log2(texture.width) % 1 !== 0 || Scalar.Log2(texture.height) % 1 !== 0)) {\n                Tools.Warn(\"Loaded .basis texture width and height are not a power of two. Texture wrapping will be set to Texture.CLAMP_ADDRESSMODE as other modes are not supported with non power of two dimensions in webGL 1.\");\n                texture._cachedWrapU = Texture.CLAMP_ADDRESSMODE;\n                texture._cachedWrapV = Texture.CLAMP_ADDRESSMODE;\n            }\n        }\n    };\n    for (var i = 0; i < transcodeResult.fileInfo.images.length; i++) {\n        _loop_1(i);\n    }\n};\n/**\n * Used to load .Basis files\n * See https://github.com/BinomialLLC/basis_universal/tree/master/webgl\n */\nexport var BasisTools = {\n    /**\n     * URL to use when loading the basis transcoder\n     */\n    JSModuleURL: BasisToolsOptions.JSModuleURL,\n    /**\n     * URL to use when loading the wasm module for the transcoder\n     */\n    WasmModuleURL: BasisToolsOptions.WasmModuleURL,\n    /**\n     * Get the internal format to be passed to texImage2D corresponding to the .basis format value\n     * @param basisFormat format chosen from GetSupportedTranscodeFormat\n     * @returns internal format corresponding to the Basis format\n     */\n    GetInternalFormatFromBasisFormat: GetInternalFormatFromBasisFormat,\n    /**\n     * Transcodes a loaded image file to compressed pixel data\n     * @param data image data to transcode\n     * @param config configuration options for the transcoding\n     * @returns a promise resulting in the transcoded image\n     */\n    TranscodeAsync: TranscodeAsync,\n    /**\n     * Loads a texture from the transcode result\n     * @param texture texture load to\n     * @param transcodeResult the result of transcoding the basis file to load from\n     */\n    LoadTextureFromTranscodeResult: LoadTextureFromTranscodeResult,\n};\nfunction workerFunc() {\n    var _BASIS_FORMAT = {\n        cTFETC1: 0,\n        cTFBC1: 1,\n        cTFBC4: 2,\n        cTFPVRTC1_4_OPAQUE_ONLY: 3,\n        cTFBC7_M6_OPAQUE_ONLY: 4,\n        cTFETC2: 5,\n        cTFBC3: 6,\n        cTFBC5: 7,\n    };\n    var transcoderModulePromise = null;\n    onmessage = function (event) {\n        if (event.data.action === \"init\") {\n            // Load the transcoder if it hasn't been yet\n            if (!transcoderModulePromise) {\n                // Override wasm binary\n                Module = { wasmBinary: event.data.wasmBinary };\n                // make sure we loaded the script correctly\n                try {\n                    importScripts(event.data.url);\n                }\n                catch (e) {\n                    postMessage({ action: \"error\", error: e });\n                }\n                transcoderModulePromise = new Promise(function (res) {\n                    Module.onRuntimeInitialized = function () {\n                        Module.initializeBasis();\n                        res();\n                    };\n                });\n            }\n            transcoderModulePromise.then(function () {\n                postMessage({ action: \"init\" });\n            });\n        }\n        else if (event.data.action === \"transcode\") {\n            // Transcode the basis image and return the resulting pixels\n            var config = event.data.config;\n            var imgData = event.data.imageData;\n            var loadedFile = new Module.BasisFile(imgData);\n            var fileInfo = GetFileInfo(loadedFile);\n            var format = event.data.ignoreSupportedFormats ? null : GetSupportedTranscodeFormat(event.data.config, fileInfo);\n            var needsConversion = false;\n            if (format === null) {\n                needsConversion = true;\n                format = fileInfo.hasAlpha ? _BASIS_FORMAT.cTFBC3 : _BASIS_FORMAT.cTFBC1;\n            }\n            // Begin transcode\n            var success = true;\n            if (!loadedFile.startTranscoding()) {\n                success = false;\n            }\n            var buffers = [];\n            for (var imageIndex = 0; imageIndex < fileInfo.images.length; imageIndex++) {\n                if (!success) {\n                    break;\n                }\n                var image = fileInfo.images[imageIndex];\n                if (config.loadSingleImage === undefined || config.loadSingleImage === imageIndex) {\n                    var mipCount = image.levels.length;\n                    if (config.loadMipmapLevels === false) {\n                        mipCount = 1;\n                    }\n                    for (var levelIndex = 0; levelIndex < mipCount; levelIndex++) {\n                        var levelInfo = image.levels[levelIndex];\n                        var pixels = TranscodeLevel(loadedFile, imageIndex, levelIndex, format, needsConversion);\n                        if (!pixels) {\n                            success = false;\n                            break;\n                        }\n                        levelInfo.transcodedPixels = pixels;\n                        buffers.push(levelInfo.transcodedPixels.buffer);\n                    }\n                }\n            }\n            // Close file\n            loadedFile.close();\n            loadedFile.delete();\n            if (needsConversion) {\n                format = -1;\n            }\n            if (!success) {\n                postMessage({ action: \"transcode\", success: success, id: event.data.id });\n            }\n            else {\n                postMessage({ action: \"transcode\", success: success, id: event.data.id, fileInfo: fileInfo, format: format }, buffers);\n            }\n        }\n    };\n    /**\n     * Detects the supported transcode format for the file\n     * @param config transcode config\n     * @param fileInfo info about the file\n     * @returns the chosed format or null if none are supported\n     */\n    function GetSupportedTranscodeFormat(config, fileInfo) {\n        var format = null;\n        if (config.supportedCompressionFormats) {\n            if (config.supportedCompressionFormats.etc1) {\n                format = _BASIS_FORMAT.cTFETC1;\n            }\n            else if (config.supportedCompressionFormats.s3tc) {\n                format = fileInfo.hasAlpha ? _BASIS_FORMAT.cTFBC3 : _BASIS_FORMAT.cTFBC1;\n            }\n            else if (config.supportedCompressionFormats.pvrtc) {\n                // TODO uncomment this after pvrtc bug is fixed is basis transcoder\n                // See discussion here: https://github.com/mrdoob/three.js/issues/16524#issuecomment-498929924\n                // format = _BASIS_FORMAT.cTFPVRTC1_4_OPAQUE_ONLY;\n            }\n            else if (config.supportedCompressionFormats.etc2) {\n                format = _BASIS_FORMAT.cTFETC2;\n            }\n        }\n        return format;\n    }\n    /**\n     * Retrieves information about the basis file eg. dimensions\n     * @param basisFile the basis file to get the info from\n     * @returns information about the basis file\n     */\n    function GetFileInfo(basisFile) {\n        var hasAlpha = basisFile.getHasAlpha();\n        var imageCount = basisFile.getNumImages();\n        var images = [];\n        for (var i = 0; i < imageCount; i++) {\n            var imageInfo = {\n                levels: [],\n            };\n            var levelCount = basisFile.getNumLevels(i);\n            for (var level = 0; level < levelCount; level++) {\n                var levelInfo = {\n                    width: basisFile.getImageWidth(i, level),\n                    height: basisFile.getImageHeight(i, level),\n                };\n                imageInfo.levels.push(levelInfo);\n            }\n            images.push(imageInfo);\n        }\n        var info = { hasAlpha: hasAlpha, images: images };\n        return info;\n    }\n    function TranscodeLevel(loadedFile, imageIndex, levelIndex, format, convertToRgb565) {\n        var dstSize = loadedFile.getImageTranscodedSizeInBytes(imageIndex, levelIndex, format);\n        var dst = new Uint8Array(dstSize);\n        if (!loadedFile.transcodeImage(dst, imageIndex, levelIndex, format, 1, 0)) {\n            return null;\n        }\n        // If no supported format is found, load as dxt and convert to rgb565\n        if (convertToRgb565) {\n            var alignedWidth = (loadedFile.getImageWidth(imageIndex, levelIndex) + 3) & ~3;\n            var alignedHeight = (loadedFile.getImageHeight(imageIndex, levelIndex) + 3) & ~3;\n            dst = ConvertDxtToRgb565(dst, 0, alignedWidth, alignedHeight);\n        }\n        return dst;\n    }\n    /**\n     * From https://github.com/BinomialLLC/basis_universal/blob/master/webgl/texture/dxt-to-rgb565.js\n     * An unoptimized version of dxtToRgb565.  Also, the floating\n     * point math used to compute the colors actually results in\n     * slightly different colors compared to hardware DXT decoders.\n     * @param src dxt src pixels\n     * @param srcByteOffset offset for the start of src\n     * @param  width aligned width of the image\n     * @param  height aligned height of the image\n     * @return the converted pixels\n     */\n    function ConvertDxtToRgb565(src, srcByteOffset, width, height) {\n        var c = new Uint16Array(4);\n        var dst = new Uint16Array(width * height);\n        var blockWidth = width / 4;\n        var blockHeight = height / 4;\n        for (var blockY = 0; blockY < blockHeight; blockY++) {\n            for (var blockX = 0; blockX < blockWidth; blockX++) {\n                var i = srcByteOffset + 8 * (blockY * blockWidth + blockX);\n                c[0] = src[i] | (src[i + 1] << 8);\n                c[1] = src[i + 2] | (src[i + 3] << 8);\n                c[2] =\n                    ((2 * (c[0] & 0x1f) + 1 * (c[1] & 0x1f)) / 3) |\n                        (((2 * (c[0] & 0x7e0) + 1 * (c[1] & 0x7e0)) / 3) & 0x7e0) |\n                        (((2 * (c[0] & 0xf800) + 1 * (c[1] & 0xf800)) / 3) & 0xf800);\n                c[3] =\n                    ((2 * (c[1] & 0x1f) + 1 * (c[0] & 0x1f)) / 3) |\n                        (((2 * (c[1] & 0x7e0) + 1 * (c[0] & 0x7e0)) / 3) & 0x7e0) |\n                        (((2 * (c[1] & 0xf800) + 1 * (c[0] & 0xf800)) / 3) & 0xf800);\n                for (var row = 0; row < 4; row++) {\n                    var m = src[i + 4 + row];\n                    var dstI = (blockY * 4 + row) * width + blockX * 4;\n                    dst[dstI++] = c[m & 0x3];\n                    dst[dstI++] = c[(m >> 2) & 0x3];\n                    dst[dstI++] = c[(m >> 4) & 0x3];\n                    dst[dstI++] = c[(m >> 6) & 0x3];\n                }\n            }\n        }\n        return dst;\n    }\n}\nObject.defineProperty(BasisTools, \"JSModuleURL\", {\n    get: function () {\n        return BasisToolsOptions.JSModuleURL;\n    },\n    set: function (value) {\n        BasisToolsOptions.JSModuleURL = value;\n    },\n});\nObject.defineProperty(BasisTools, \"WasmModuleURL\", {\n    get: function () {\n        return BasisToolsOptions.WasmModuleURL;\n    },\n    set: function (value) {\n        BasisToolsOptions.WasmModuleURL = value;\n    },\n});\n//# sourceMappingURL=basis.js.map","import { Texture } from \"../Materials/Textures/texture.js\";\nimport { RGBDTextureTools } from \"./rgbdTextureTools.js\";\nimport { Tools } from \"./tools.js\";\n// eslint-disable-next-line @typescript-eslint/naming-convention\nvar _environmentBRDFBase64Texture = \"data:image/png;base64,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\";\nvar _instanceNumber = 0;\n/**\n * Gets a default environment BRDF for MS-BRDF Height Correlated BRDF\n * @param scene defines the hosting scene\n * @returns the environment BRDF texture\n */\nexport var GetEnvironmentBRDFTexture = function (scene) {\n    if (!scene.environmentBRDFTexture) {\n        // Forces Delayed Texture Loading to prevent undefined error whilst setting RGBD values.\n        var useDelayedTextureLoading = scene.useDelayedTextureLoading;\n        scene.useDelayedTextureLoading = false;\n        var previousState = scene._blockEntityCollection;\n        scene._blockEntityCollection = false;\n        var texture_1 = Texture.CreateFromBase64String(_environmentBRDFBase64Texture, \"EnvironmentBRDFTexture\" + _instanceNumber++, scene, true, false, Texture.BILINEAR_SAMPLINGMODE);\n        scene._blockEntityCollection = previousState;\n        // BRDF Texture should not be cached here due to pre processing and redundant scene caches.\n        var texturesCache = scene.getEngine().getLoadedTexturesCache();\n        var index = texturesCache.indexOf(texture_1.getInternalTexture());\n        if (index !== -1) {\n            texturesCache.splice(index, 1);\n        }\n        texture_1.isRGBD = true;\n        texture_1.wrapU = Texture.CLAMP_ADDRESSMODE;\n        texture_1.wrapV = Texture.CLAMP_ADDRESSMODE;\n        scene.environmentBRDFTexture = texture_1;\n        scene.useDelayedTextureLoading = useDelayedTextureLoading;\n        RGBDTextureTools.ExpandRGBDTexture(texture_1);\n        var observer_1 = scene.getEngine().onContextRestoredObservable.add(function () {\n            texture_1.isRGBD = true;\n            var checkReady = function () {\n                if (texture_1.isReady()) {\n                    RGBDTextureTools.ExpandRGBDTexture(texture_1);\n                }\n                else {\n                    Tools.SetImmediate(checkReady);\n                }\n            };\n            checkReady();\n        });\n        scene.onDisposeObservable.add(function () {\n            scene.getEngine().onContextRestoredObservable.remove(observer_1);\n        });\n    }\n    return scene.environmentBRDFTexture;\n};\n/**\n * Class used to host texture specific utilities\n */\nexport var BRDFTextureTools = {\n    /**\n     * Gets a default environment BRDF for MS-BRDF Height Correlated BRDF\n     * @param scene defines the hosting scene\n     * @returns the environment BRDF texture\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    GetEnvironmentBRDFTexture: GetEnvironmentBRDFTexture,\n};\n//# sourceMappingURL=brdfTextureTools.js.map","/**\n * Extracts the characters between two markers (for eg, between \"(\" and \")\"). The function handles nested markers as well as markers inside strings (delimited by \", ' or `) and comments\n * @param markerOpen opening marker\n * @param markerClose closing marker\n * @param block code block to parse\n * @param startIndex starting index in block where the extraction must start. The character at block[startIndex] should be the markerOpen character!\n * @returns index of the last character for the extraction (or -1 if the string is invalid - no matching closing marker found). The string to extract (without the markers) is the string between startIndex + 1 and the returned value (exclusive)\n */\nexport function ExtractBetweenMarkers(markerOpen, markerClose, block, startIndex) {\n    var currPos = startIndex, openMarkers = 0, waitForChar = \"\";\n    while (currPos < block.length) {\n        var currChar = block.charAt(currPos);\n        if (!waitForChar) {\n            switch (currChar) {\n                case markerOpen:\n                    openMarkers++;\n                    break;\n                case markerClose:\n                    openMarkers--;\n                    break;\n                case '\"':\n                case \"'\":\n                case \"`\":\n                    waitForChar = currChar;\n                    break;\n                case \"/\":\n                    if (currPos + 1 < block.length) {\n                        var nextChar = block.charAt(currPos + 1);\n                        if (nextChar === \"/\") {\n                            waitForChar = \"\\n\";\n                        }\n                        else if (nextChar === \"*\") {\n                            waitForChar = \"*/\";\n                        }\n                    }\n                    break;\n            }\n        }\n        else {\n            if (currChar === waitForChar) {\n                if (waitForChar === '\"' || waitForChar === \"'\") {\n                    block.charAt(currPos - 1) !== \"\\\\\" && (waitForChar = \"\");\n                }\n                else {\n                    waitForChar = \"\";\n                }\n            }\n            else if (waitForChar === \"*/\" && currChar === \"*\" && currPos + 1 < block.length) {\n                block.charAt(currPos + 1) === \"/\" && (waitForChar = \"\");\n                if (waitForChar === \"\") {\n                    currPos++;\n                }\n            }\n        }\n        currPos++;\n        if (openMarkers === 0) {\n            break;\n        }\n    }\n    return openMarkers === 0 ? currPos - 1 : -1;\n}\n/**\n * Parses a string and skip whitespaces\n * @param s string to parse\n * @param index index where to start parsing\n * @returns the index after all whitespaces have been skipped\n */\nexport function SkipWhitespaces(s, index) {\n    while (index < s.length) {\n        var c = s[index];\n        if (c !== \" \" && c !== \"\\n\" && c !== \"\\r\" && c !== \"\\t\" && c !== \"\\u000a\" && c !== \"\\u00a0\") {\n            break;\n        }\n        index++;\n    }\n    return index;\n}\n/**\n * Checks if a character is an identifier character (meaning, if it is 0-9, A-Z, a-z or _)\n * @param c character to check\n * @returns true if the character is an identifier character\n */\nexport function IsIdentifierChar(c) {\n    var v = c.charCodeAt(0);\n    return ((v >= 48 && v <= 57) || // 0-9\n        (v >= 65 && v <= 90) || // A-Z\n        (v >= 97 && v <= 122) || // a-z\n        v == 95); // _\n}\n/**\n * Removes the comments of a code block\n * @param block code block to parse\n * @returns block with the comments removed\n */\nexport function RemoveComments(block) {\n    var currPos = 0, waitForChar = \"\", inComments = false;\n    var s = [];\n    while (currPos < block.length) {\n        var currChar = block.charAt(currPos);\n        if (!waitForChar) {\n            switch (currChar) {\n                case '\"':\n                case \"'\":\n                case \"`\":\n                    waitForChar = currChar;\n                    break;\n                case \"/\":\n                    if (currPos + 1 < block.length) {\n                        var nextChar = block.charAt(currPos + 1);\n                        if (nextChar === \"/\") {\n                            waitForChar = \"\\n\";\n                            inComments = true;\n                        }\n                        else if (nextChar === \"*\") {\n                            waitForChar = \"*/\";\n                            inComments = true;\n                        }\n                    }\n                    break;\n            }\n            if (!inComments) {\n                s.push(currChar);\n            }\n        }\n        else {\n            if (currChar === waitForChar) {\n                if (waitForChar === '\"' || waitForChar === \"'\") {\n                    block.charAt(currPos - 1) !== \"\\\\\" && (waitForChar = \"\");\n                    s.push(currChar);\n                }\n                else {\n                    waitForChar = \"\";\n                    inComments = false;\n                }\n            }\n            else if (waitForChar === \"*/\" && currChar === \"*\" && currPos + 1 < block.length) {\n                block.charAt(currPos + 1) === \"/\" && (waitForChar = \"\");\n                if (waitForChar === \"\") {\n                    inComments = false;\n                    currPos++;\n                }\n            }\n            else {\n                if (!inComments) {\n                    s.push(currChar);\n                }\n            }\n        }\n        currPos++;\n    }\n    return s.join(\"\");\n}\n/**\n * Finds the first occurrence of a character in a string going backward\n * @param s the string to parse\n * @param index starting index in the string\n * @param c the character to find\n * @returns the index of the character if found, else -1\n */\nexport function FindBackward(s, index, c) {\n    while (index >= 0 && s.charAt(index) !== c) {\n        index--;\n    }\n    return index;\n}\n/**\n * Escapes a string so that it is usable as a regular expression\n * @param s string to escape\n * @returns escaped string\n */\nexport function EscapeRegExp(s) {\n    return s.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n//# sourceMappingURL=codeStringParsingTools.js.map","import { IsWindowObjectExist } from \"./domManagement.js\";\n/**\n * A wrapper for the experimental compute pressure api which allows a callback to be called whenever certain thresholds are met.\n */\nvar ComputePressureObserverWrapper = /** @class */ (function () {\n    /**\n     * A compute pressure observer will call this callback, whenever these thresholds are met.\n     * @param callback The callback that is called whenever thresholds are met.\n     * @param thresholds An object containing the thresholds used to decide what value to to return for each update property (average of start and end of a threshold boundary).\n     */\n    function ComputePressureObserverWrapper(callback, thresholds) {\n        if (ComputePressureObserverWrapper.IsAvailable) {\n            this._observer = new window.ComputePressureObserver(callback, thresholds);\n        }\n    }\n    Object.defineProperty(ComputePressureObserverWrapper, \"IsAvailable\", {\n        /**\n         * Returns true if ComputePressureObserver is available for use, false otherwise.\n         */\n        get: function () {\n            return IsWindowObjectExist() && \"ComputePressureObserver\" in window;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Method that must be called to begin observing changes, and triggering callbacks.\n     */\n    ComputePressureObserverWrapper.prototype.observe = function () {\n        var _a, _b;\n        ((_a = this._observer) === null || _a === void 0 ? void 0 : _a.observe) &&\n            ((_b = this._observer) === null || _b === void 0 ? void 0 : _b.observe().catch(function () {\n                // Ignore error\n            }));\n    };\n    /**\n     * Method that must be called to stop observing changes and triggering callbacks (cleanup function).\n     */\n    ComputePressureObserverWrapper.prototype.unobserve = function () {\n        var _a, _b;\n        ((_a = this._observer) === null || _a === void 0 ? void 0 : _a.unobserve) && ((_b = this._observer) === null || _b === void 0 ? void 0 : _b.unobserve());\n    };\n    return ComputePressureObserverWrapper;\n}());\nexport { ComputePressureObserverWrapper };\n//# sourceMappingURL=computePressure.js.map","import { __awaiter, __generator } from \"tslib\";\n/**\n * Transform some pixel data to a base64 string\n * @param pixels defines the pixel data to transform to base64\n * @param size defines the width and height of the (texture) data\n * @param invertY true if the data must be inverted for the Y coordinate during the conversion\n * @returns The base64 encoded string or null\n */\nexport function GenerateBase64StringFromPixelData(pixels, size, invertY) {\n    if (invertY === void 0) { invertY = false; }\n    var width = size.width;\n    var height = size.height;\n    if (pixels instanceof Float32Array) {\n        var len = pixels.byteLength / pixels.BYTES_PER_ELEMENT;\n        var npixels = new Uint8Array(len);\n        while (--len >= 0) {\n            var val = pixels[len];\n            if (val < 0) {\n                val = 0;\n            }\n            else if (val > 1) {\n                val = 1;\n            }\n            npixels[len] = val * 255;\n        }\n        pixels = npixels;\n    }\n    var canvas = document.createElement(\"canvas\");\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext(\"2d\");\n    if (!ctx) {\n        return null;\n    }\n    var imageData = ctx.createImageData(width, height);\n    var castData = imageData.data;\n    castData.set(pixels);\n    ctx.putImageData(imageData, 0, 0);\n    if (invertY) {\n        var canvas2 = document.createElement(\"canvas\");\n        canvas2.width = width;\n        canvas2.height = height;\n        var ctx2 = canvas2.getContext(\"2d\");\n        if (!ctx2) {\n            return null;\n        }\n        ctx2.translate(0, height);\n        ctx2.scale(1, -1);\n        ctx2.drawImage(canvas, 0, 0);\n        return canvas2.toDataURL(\"image/png\");\n    }\n    return canvas.toDataURL(\"image/png\");\n}\n/**\n * Reads the pixels stored in the webgl texture and returns them as a base64 string\n * @param texture defines the texture to read pixels from\n * @param faceIndex defines the face of the texture to read (in case of cube texture)\n * @param level defines the LOD level of the texture to read (in case of Mip Maps)\n * @returns The base64 encoded string or null\n */\nexport function GenerateBase64StringFromTexture(texture, faceIndex, level) {\n    if (faceIndex === void 0) { faceIndex = 0; }\n    if (level === void 0) { level = 0; }\n    var internalTexture = texture.getInternalTexture();\n    if (!internalTexture) {\n        return null;\n    }\n    var pixels = texture._readPixelsSync(faceIndex, level);\n    if (!pixels) {\n        return null;\n    }\n    return GenerateBase64StringFromPixelData(pixels, texture.getSize(), internalTexture.invertY);\n}\n/**\n * Reads the pixels stored in the webgl texture and returns them as a base64 string\n * @param texture defines the texture to read pixels from\n * @param faceIndex defines the face of the texture to read (in case of cube texture)\n * @param level defines the LOD level of the texture to read (in case of Mip Maps)\n * @returns The base64 encoded string or null wrapped in a promise\n */\nexport function GenerateBase64StringFromTextureAsync(texture, faceIndex, level) {\n    if (faceIndex === void 0) { faceIndex = 0; }\n    if (level === void 0) { level = 0; }\n    return __awaiter(this, void 0, void 0, function () {\n        var internalTexture, pixels;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    internalTexture = texture.getInternalTexture();\n                    if (!internalTexture) {\n                        return [2 /*return*/, null];\n                    }\n                    return [4 /*yield*/, texture.readPixels(faceIndex, level)];\n                case 1:\n                    pixels = _a.sent();\n                    if (!pixels) {\n                        return [2 /*return*/, null];\n                    }\n                    return [2 /*return*/, GenerateBase64StringFromPixelData(pixels, texture.getSize(), internalTexture.invertY)];\n            }\n        });\n    });\n}\n/**\n * Class used to host copy specific utilities\n * (Back-compat)\n */\nexport var CopyTools = {\n    /**\n     * Transform some pixel data to a base64 string\n     * @param pixels defines the pixel data to transform to base64\n     * @param size defines the width and height of the (texture) data\n     * @param invertY true if the data must be inverted for the Y coordinate during the conversion\n     * @returns The base64 encoded string or null\n     */\n    GenerateBase64StringFromPixelData: GenerateBase64StringFromPixelData,\n    /**\n     * Reads the pixels stored in the webgl texture and returns them as a base64 string\n     * @param texture defines the texture to read pixels from\n     * @param faceIndex defines the face of the texture to read (in case of cube texture)\n     * @param level defines the LOD level of the texture to read (in case of Mip Maps)\n     * @returns The base64 encoded string or null\n     */\n    GenerateBase64StringFromTexture: GenerateBase64StringFromTexture,\n    /**\n     * Reads the pixels stored in the webgl texture and returns them as a base64 string\n     * @param texture defines the texture to read pixels from\n     * @param faceIndex defines the face of the texture to read (in case of cube texture)\n     * @param level defines the LOD level of the texture to read (in case of Mip Maps)\n     * @returns The base64 encoded string or null wrapped in a promise\n     */\n    GenerateBase64StringFromTextureAsync: GenerateBase64StringFromTextureAsync,\n};\n//# sourceMappingURL=copyTools.js.map","/* eslint-disable @typescript-eslint/naming-convention */\n// \"Coroutines are computer program components that generalize subroutines for non-preemptive multitasking, by allowing execution to be suspended and resumed.\"\n// https://en.wikipedia.org/wiki/Coroutine\n// The inline scheduler simply steps the coroutine synchronously. This is useful for running a coroutine synchronously, and also as a helper function for other schedulers.\n/**\n * @param coroutine\n * @param onStep\n * @param onError\n * @hidden\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function inlineScheduler(coroutine, onStep, onError) {\n    try {\n        var step_1 = coroutine.next();\n        if (step_1.done) {\n            onStep(step_1);\n        }\n        else if (!step_1.value) {\n            // NOTE: The properties of step have been narrowed, but the type of step itself is not narrowed, so the cast below is the most type safe way to deal with this without instantiating a new object to hold the values.\n            onStep(step_1);\n        }\n        else {\n            step_1.value.then(function () {\n                step_1.value = undefined;\n                onStep(step_1);\n            }, onError);\n        }\n    }\n    catch (error) {\n        onError(error);\n    }\n}\n// The yielding scheduler steps the coroutine synchronously until the specified time interval has elapsed, then yields control so other operations can be performed.\n// A single instance of a yielding scheduler could be shared across multiple coroutines to yield when their collective work exceeds the threshold.\n/**\n * @param yieldAfterMS\n * @hidden\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function createYieldingScheduler(yieldAfterMS) {\n    if (yieldAfterMS === void 0) { yieldAfterMS = 25; }\n    var startTime;\n    return function (coroutine, onStep, onError) {\n        var currentTime = performance.now();\n        if (startTime === undefined || currentTime - startTime > yieldAfterMS) {\n            // If this is the first coroutine step, or if the time interval has elapsed, record a new start time, and schedule the coroutine step to happen later, effectively yielding control of the execution context.\n            startTime = currentTime;\n            setTimeout(function () {\n                inlineScheduler(coroutine, onStep, onError);\n            }, 0);\n        }\n        else {\n            // Otherwise it is not time to yield yet, so step the coroutine synchronously.\n            inlineScheduler(coroutine, onStep, onError);\n        }\n    };\n}\n// Runs the specified coroutine with the specified scheduler. The success or error callback will be invoked when the coroutine finishes.\n/**\n * @param coroutine\n * @param scheduler\n * @param onSuccess\n * @param onError\n * @param abortSignal\n * @hidden\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function runCoroutine(coroutine, scheduler, onSuccess, onError, abortSignal) {\n    var resume = function () {\n        var reschedule;\n        var onStep = function (stepResult) {\n            if (stepResult.done) {\n                // If the coroutine is done, report success.\n                onSuccess(stepResult.value);\n            }\n            else {\n                // If the coroutine is not done, resume the coroutine (via the scheduler).\n                if (reschedule === undefined) {\n                    // If reschedule is undefined at this point, then the coroutine must have stepped synchronously, so just flag another loop iteration.\n                    reschedule = true;\n                }\n                else {\n                    // If reschedule is defined at this point, then the coroutine must have stepped asynchronously, so call resume to restart the step loop.\n                    resume();\n                }\n            }\n        };\n        do {\n            reschedule = undefined;\n            if (!abortSignal || !abortSignal.aborted) {\n                scheduler(coroutine, onStep, onError);\n            }\n            else {\n                onError(new Error(\"Aborted\"));\n            }\n            if (reschedule === undefined) {\n                // If reschedule is undefined at this point, then the coroutine must have stepped asynchronously, so stop looping and let the coroutine be resumed later.\n                reschedule = false;\n            }\n        } while (reschedule);\n    };\n    resume();\n}\n// Runs the specified coroutine synchronously.\n/**\n * @param coroutine\n * @param abortSignal\n * @hidden\n */\nexport function runCoroutineSync(coroutine, abortSignal) {\n    // Run the coroutine with the inline scheduler, storing the returned value, or re-throwing the error (since the error callback will be called synchronously by the inline scheduler).\n    var result;\n    runCoroutine(coroutine, inlineScheduler, function (r) { return (result = r); }, function (e) {\n        throw e;\n    }, abortSignal);\n    // Synchronously return the result of the coroutine.\n    return result;\n}\n// Runs the specified coroutine asynchronously with the specified scheduler.\n/**\n * @param coroutine\n * @param scheduler\n * @param abortSignal\n * @hidden\n */\nexport function runCoroutineAsync(coroutine, scheduler, abortSignal) {\n    // Run the coroutine with a yielding scheduler, resolving or rejecting the result promise when the coroutine finishes.\n    return new Promise(function (resolve, reject) {\n        runCoroutine(coroutine, scheduler, resolve, reject, abortSignal);\n    });\n}\n/**\n * Given a function that returns a Coroutine<T>, produce a function with the same parameters that returns a T.\n * The returned function runs the coroutine synchronously.\n * @param coroutineFactory A function that returns a Coroutine<T>.\n * @param abortSignal\n * @returns A function that runs the coroutine synchronously.\n * @hidden\n */\nexport function makeSyncFunction(coroutineFactory, abortSignal) {\n    return function () {\n        var params = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n        }\n        // Run the coroutine synchronously.\n        return runCoroutineSync(coroutineFactory.apply(void 0, params), abortSignal);\n    };\n}\n/**\n * Given a function that returns a Coroutine<T>, product a function with the same parameters that returns a Promise<T>.\n * The returned function runs the coroutine asynchronously, yield control of the execution context occasionally to enable a more responsive experience.\n * @param coroutineFactory A function that returns a Coroutine<T>.\n * @param scheduler\n * @param abortSignal\n * @returns A function that runs the coroutine asynchronously.\n * @hidden\n */\nexport function makeAsyncFunction(coroutineFactory, scheduler, abortSignal) {\n    return function () {\n        var params = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n        }\n        // Run the coroutine asynchronously.\n        return runCoroutineAsync(coroutineFactory.apply(void 0, params), scheduler, abortSignal);\n    };\n}\n//# sourceMappingURL=coroutine.js.map","import { Decode } from \"./stringTools.js\";\n/**\n * Utility class for reading from a data buffer\n */\nvar DataReader = /** @class */ (function () {\n    /**\n     * Constructor\n     * @param buffer The buffer to read\n     */\n    function DataReader(buffer) {\n        /**\n         * The current byte offset from the beginning of the data buffer.\n         */\n        this.byteOffset = 0;\n        this.buffer = buffer;\n    }\n    /**\n     * Loads the given byte length.\n     * @param byteLength The byte length to load\n     * @returns A promise that resolves when the load is complete\n     */\n    DataReader.prototype.loadAsync = function (byteLength) {\n        var _this = this;\n        return this.buffer.readAsync(this.byteOffset, byteLength).then(function (data) {\n            _this._dataView = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            _this._dataByteOffset = 0;\n        });\n    };\n    /**\n     * Read a unsigned 32-bit integer from the currently loaded data range.\n     * @returns The 32-bit integer read\n     */\n    DataReader.prototype.readUint32 = function () {\n        var value = this._dataView.getUint32(this._dataByteOffset, true);\n        this._dataByteOffset += 4;\n        this.byteOffset += 4;\n        return value;\n    };\n    /**\n     * Read a byte array from the currently loaded data range.\n     * @param byteLength The byte length to read\n     * @returns The byte array read\n     */\n    DataReader.prototype.readUint8Array = function (byteLength) {\n        var value = new Uint8Array(this._dataView.buffer, this._dataView.byteOffset + this._dataByteOffset, byteLength);\n        this._dataByteOffset += byteLength;\n        this.byteOffset += byteLength;\n        return value;\n    };\n    /**\n     * Read a string from the currently loaded data range.\n     * @param byteLength The byte length to read\n     * @returns The string read\n     */\n    DataReader.prototype.readString = function (byteLength) {\n        return Decode(this.readUint8Array(byteLength));\n    };\n    /**\n     * Skips the given byte length the currently loaded data range.\n     * @param byteLength The byte length to skip\n     */\n    DataReader.prototype.skipBytes = function (byteLength) {\n        this._dataByteOffset += byteLength;\n        this.byteOffset += byteLength;\n    };\n    return DataReader;\n}());\nexport { DataReader };\n//# sourceMappingURL=dataReader.js.map","/* eslint-disable @typescript-eslint/naming-convention */\nimport { Scalar } from \"../Maths/math.scalar.js\";\nimport { SphericalPolynomial } from \"../Maths/sphericalPolynomial.js\";\n\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { CubeMapToSphericalPolynomialTools } from \"../Misc/HighDynamicRange/cubemapToSphericalPolynomial.js\";\nimport { BaseTexture } from \"../Materials/Textures/baseTexture.js\";\nimport { ThinEngine } from \"../Engines/thinEngine.js\";\nimport { FromHalfFloat, ToHalfFloat } from \"./textureTools.js\";\nimport \"../Engines/Extensions/engine.cubeTexture.js\";\n// Based on demo done by Brandon Jones - http://media.tojicode.com/webgl-samples/dds.html\n// All values and structures referenced from:\n// http://msdn.microsoft.com/en-us/library/bb943991.aspx/\nvar DDS_MAGIC = 0x20534444;\nvar //DDSD_CAPS = 0x1,\n//DDSD_HEIGHT = 0x2,\n//DDSD_WIDTH = 0x4,\n//DDSD_PITCH = 0x8,\n//DDSD_PIXELFORMAT = 0x1000,\nDDSD_MIPMAPCOUNT = 0x20000;\n//DDSD_LINEARSIZE = 0x80000,\n//DDSD_DEPTH = 0x800000;\n// var DDSCAPS_COMPLEX = 0x8,\n//     DDSCAPS_MIPMAP = 0x400000,\n//     DDSCAPS_TEXTURE = 0x1000;\nvar DDSCAPS2_CUBEMAP = 0x200;\n// DDSCAPS2_CUBEMAP_POSITIVEX = 0x400,\n// DDSCAPS2_CUBEMAP_NEGATIVEX = 0x800,\n// DDSCAPS2_CUBEMAP_POSITIVEY = 0x1000,\n// DDSCAPS2_CUBEMAP_NEGATIVEY = 0x2000,\n// DDSCAPS2_CUBEMAP_POSITIVEZ = 0x4000,\n// DDSCAPS2_CUBEMAP_NEGATIVEZ = 0x8000,\n// DDSCAPS2_VOLUME = 0x200000;\nvar //DDPF_ALPHAPIXELS = 0x1,\n//DDPF_ALPHA = 0x2,\nDDPF_FOURCC = 0x4, DDPF_RGB = 0x40, \n//DDPF_YUV = 0x200,\nDDPF_LUMINANCE = 0x20000;\nfunction FourCCToInt32(value) {\n    return value.charCodeAt(0) + (value.charCodeAt(1) << 8) + (value.charCodeAt(2) << 16) + (value.charCodeAt(3) << 24);\n}\nfunction Int32ToFourCC(value) {\n    return String.fromCharCode(value & 0xff, (value >> 8) & 0xff, (value >> 16) & 0xff, (value >> 24) & 0xff);\n}\nvar FOURCC_DXT1 = FourCCToInt32(\"DXT1\");\nvar FOURCC_DXT3 = FourCCToInt32(\"DXT3\");\nvar FOURCC_DXT5 = FourCCToInt32(\"DXT5\");\nvar FOURCC_DX10 = FourCCToInt32(\"DX10\");\nvar FOURCC_D3DFMT_R16G16B16A16F = 113;\nvar FOURCC_D3DFMT_R32G32B32A32F = 116;\nvar DXGI_FORMAT_R32G32B32A32_FLOAT = 2;\nvar DXGI_FORMAT_R16G16B16A16_FLOAT = 10;\nvar DXGI_FORMAT_B8G8R8X8_UNORM = 88;\nvar headerLengthInt = 31; // The header length in 32 bit ints\n// Offsets into the header array\nvar off_magic = 0;\nvar off_size = 1;\nvar off_flags = 2;\nvar off_height = 3;\nvar off_width = 4;\nvar off_mipmapCount = 7;\nvar off_pfFlags = 20;\nvar off_pfFourCC = 21;\nvar off_RGBbpp = 22;\nvar off_RMask = 23;\nvar off_GMask = 24;\nvar off_BMask = 25;\nvar off_AMask = 26;\n// var off_caps1 = 27;\nvar off_caps2 = 28;\n// var off_caps3 = 29;\n// var off_caps4 = 30;\nvar off_dxgiFormat = 32;\n/**\n * Class used to provide DDS decompression tools\n */\nvar DDSTools = /** @class */ (function () {\n    function DDSTools() {\n    }\n    /**\n     * Gets DDS information from an array buffer\n     * @param data defines the array buffer view to read data from\n     * @returns the DDS information\n     */\n    DDSTools.GetDDSInfo = function (data) {\n        var header = new Int32Array(data.buffer, data.byteOffset, headerLengthInt);\n        var extendedHeader = new Int32Array(data.buffer, data.byteOffset, headerLengthInt + 4);\n        var mipmapCount = 1;\n        if (header[off_flags] & DDSD_MIPMAPCOUNT) {\n            mipmapCount = Math.max(1, header[off_mipmapCount]);\n        }\n        var fourCC = header[off_pfFourCC];\n        var dxgiFormat = fourCC === FOURCC_DX10 ? extendedHeader[off_dxgiFormat] : 0;\n        var textureType = 0;\n        switch (fourCC) {\n            case FOURCC_D3DFMT_R16G16B16A16F:\n                textureType = 2;\n                break;\n            case FOURCC_D3DFMT_R32G32B32A32F:\n                textureType = 1;\n                break;\n            case FOURCC_DX10:\n                if (dxgiFormat === DXGI_FORMAT_R16G16B16A16_FLOAT) {\n                    textureType = 2;\n                    break;\n                }\n                if (dxgiFormat === DXGI_FORMAT_R32G32B32A32_FLOAT) {\n                    textureType = 1;\n                    break;\n                }\n        }\n        return {\n            width: header[off_width],\n            height: header[off_height],\n            mipmapCount: mipmapCount,\n            isFourCC: (header[off_pfFlags] & DDPF_FOURCC) === DDPF_FOURCC,\n            isRGB: (header[off_pfFlags] & DDPF_RGB) === DDPF_RGB,\n            isLuminance: (header[off_pfFlags] & DDPF_LUMINANCE) === DDPF_LUMINANCE,\n            isCube: (header[off_caps2] & DDSCAPS2_CUBEMAP) === DDSCAPS2_CUBEMAP,\n            isCompressed: fourCC === FOURCC_DXT1 || fourCC === FOURCC_DXT3 || fourCC === FOURCC_DXT5,\n            dxgiFormat: dxgiFormat,\n            textureType: textureType,\n        };\n    };\n    DDSTools._GetHalfFloatAsFloatRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, lod) {\n        var destArray = new Float32Array(dataLength);\n        var srcData = new Uint16Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var srcPos = (x + y * width) * 4;\n                destArray[index] = FromHalfFloat(srcData[srcPos]);\n                destArray[index + 1] = FromHalfFloat(srcData[srcPos + 1]);\n                destArray[index + 2] = FromHalfFloat(srcData[srcPos + 2]);\n                if (DDSTools.StoreLODInAlphaChannel) {\n                    destArray[index + 3] = lod;\n                }\n                else {\n                    destArray[index + 3] = FromHalfFloat(srcData[srcPos + 3]);\n                }\n                index += 4;\n            }\n        }\n        return destArray;\n    };\n    DDSTools._GetHalfFloatRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, lod) {\n        if (DDSTools.StoreLODInAlphaChannel) {\n            var destArray = new Uint16Array(dataLength);\n            var srcData = new Uint16Array(arrayBuffer, dataOffset);\n            var index = 0;\n            for (var y = 0; y < height; y++) {\n                for (var x = 0; x < width; x++) {\n                    var srcPos = (x + y * width) * 4;\n                    destArray[index] = srcData[srcPos];\n                    destArray[index + 1] = srcData[srcPos + 1];\n                    destArray[index + 2] = srcData[srcPos + 2];\n                    destArray[index + 3] = ToHalfFloat(lod);\n                    index += 4;\n                }\n            }\n            return destArray;\n        }\n        return new Uint16Array(arrayBuffer, dataOffset, dataLength);\n    };\n    DDSTools._GetFloatRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, lod) {\n        if (DDSTools.StoreLODInAlphaChannel) {\n            var destArray = new Float32Array(dataLength);\n            var srcData = new Float32Array(arrayBuffer, dataOffset);\n            var index = 0;\n            for (var y = 0; y < height; y++) {\n                for (var x = 0; x < width; x++) {\n                    var srcPos = (x + y * width) * 4;\n                    destArray[index] = srcData[srcPos];\n                    destArray[index + 1] = srcData[srcPos + 1];\n                    destArray[index + 2] = srcData[srcPos + 2];\n                    destArray[index + 3] = lod;\n                    index += 4;\n                }\n            }\n            return destArray;\n        }\n        return new Float32Array(arrayBuffer, dataOffset, dataLength);\n    };\n    DDSTools._GetFloatAsHalfFloatRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, lod) {\n        var destArray = new Uint16Array(dataLength);\n        var srcData = new Float32Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                destArray[index] = ToHalfFloat(srcData[index]);\n                destArray[index + 1] = ToHalfFloat(srcData[index + 1]);\n                destArray[index + 2] = ToHalfFloat(srcData[index + 2]);\n                if (DDSTools.StoreLODInAlphaChannel) {\n                    destArray[index + 3] = ToHalfFloat(lod);\n                }\n                else {\n                    destArray[index + 3] = ToHalfFloat(srcData[index + 3]);\n                }\n                index += 4;\n            }\n        }\n        return destArray;\n    };\n    DDSTools._GetFloatAsUIntRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, lod) {\n        var destArray = new Uint8Array(dataLength);\n        var srcData = new Float32Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var srcPos = (x + y * width) * 4;\n                destArray[index] = Scalar.Clamp(srcData[srcPos]) * 255;\n                destArray[index + 1] = Scalar.Clamp(srcData[srcPos + 1]) * 255;\n                destArray[index + 2] = Scalar.Clamp(srcData[srcPos + 2]) * 255;\n                if (DDSTools.StoreLODInAlphaChannel) {\n                    destArray[index + 3] = lod;\n                }\n                else {\n                    destArray[index + 3] = Scalar.Clamp(srcData[srcPos + 3]) * 255;\n                }\n                index += 4;\n            }\n        }\n        return destArray;\n    };\n    DDSTools._GetHalfFloatAsUIntRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, lod) {\n        var destArray = new Uint8Array(dataLength);\n        var srcData = new Uint16Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var srcPos = (x + y * width) * 4;\n                destArray[index] = Scalar.Clamp(FromHalfFloat(srcData[srcPos])) * 255;\n                destArray[index + 1] = Scalar.Clamp(FromHalfFloat(srcData[srcPos + 1])) * 255;\n                destArray[index + 2] = Scalar.Clamp(FromHalfFloat(srcData[srcPos + 2])) * 255;\n                if (DDSTools.StoreLODInAlphaChannel) {\n                    destArray[index + 3] = lod;\n                }\n                else {\n                    destArray[index + 3] = Scalar.Clamp(FromHalfFloat(srcData[srcPos + 3])) * 255;\n                }\n                index += 4;\n            }\n        }\n        return destArray;\n    };\n    DDSTools._GetRGBAArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, rOffset, gOffset, bOffset, aOffset) {\n        var byteArray = new Uint8Array(dataLength);\n        var srcData = new Uint8Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var srcPos = (x + y * width) * 4;\n                byteArray[index] = srcData[srcPos + rOffset];\n                byteArray[index + 1] = srcData[srcPos + gOffset];\n                byteArray[index + 2] = srcData[srcPos + bOffset];\n                byteArray[index + 3] = srcData[srcPos + aOffset];\n                index += 4;\n            }\n        }\n        return byteArray;\n    };\n    DDSTools._ExtractLongWordOrder = function (value) {\n        if (value === 0 || value === 255 || value === -16777216) {\n            return 0;\n        }\n        return 1 + DDSTools._ExtractLongWordOrder(value >> 8);\n    };\n    DDSTools._GetRGBArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer, rOffset, gOffset, bOffset) {\n        var byteArray = new Uint8Array(dataLength);\n        var srcData = new Uint8Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var srcPos = (x + y * width) * 3;\n                byteArray[index] = srcData[srcPos + rOffset];\n                byteArray[index + 1] = srcData[srcPos + gOffset];\n                byteArray[index + 2] = srcData[srcPos + bOffset];\n                index += 3;\n            }\n        }\n        return byteArray;\n    };\n    DDSTools._GetLuminanceArrayBuffer = function (width, height, dataOffset, dataLength, arrayBuffer) {\n        var byteArray = new Uint8Array(dataLength);\n        var srcData = new Uint8Array(arrayBuffer, dataOffset);\n        var index = 0;\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var srcPos = x + y * width;\n                byteArray[index] = srcData[srcPos];\n                index++;\n            }\n        }\n        return byteArray;\n    };\n    /**\n     * Uploads DDS Levels to a Babylon Texture\n     * @param engine\n     * @param texture\n     * @param data\n     * @param info\n     * @param loadMipmaps\n     * @param faces\n     * @param lodIndex\n     * @param currentFace\n     * @param destTypeMustBeFilterable\n     * @hidden\n     */\n    DDSTools.UploadDDSLevels = function (engine, texture, data, info, loadMipmaps, faces, lodIndex, currentFace, destTypeMustBeFilterable) {\n        if (lodIndex === void 0) { lodIndex = -1; }\n        if (destTypeMustBeFilterable === void 0) { destTypeMustBeFilterable = true; }\n        var sphericalPolynomialFaces = null;\n        if (info.sphericalPolynomial) {\n            sphericalPolynomialFaces = new Array();\n        }\n        var ext = !!engine.getCaps().s3tc;\n        // TODO WEBGPU Once generateMipMaps is split into generateMipMaps + hasMipMaps in InternalTexture this line can be removed\n        texture.generateMipMaps = loadMipmaps;\n        var header = new Int32Array(data.buffer, data.byteOffset, headerLengthInt);\n        var fourCC, width, height, dataLength = 0, dataOffset;\n        var byteArray, mipmapCount, mip;\n        var internalCompressedFormat = 0;\n        var blockBytes = 1;\n        if (header[off_magic] !== DDS_MAGIC) {\n            Logger.Error(\"Invalid magic number in DDS header\");\n            return;\n        }\n        if (!info.isFourCC && !info.isRGB && !info.isLuminance) {\n            Logger.Error(\"Unsupported format, must contain a FourCC, RGB or LUMINANCE code\");\n            return;\n        }\n        if (info.isCompressed && !ext) {\n            Logger.Error(\"Compressed textures are not supported on this platform.\");\n            return;\n        }\n        var bpp = header[off_RGBbpp];\n        dataOffset = header[off_size] + 4;\n        var computeFormats = false;\n        if (info.isFourCC) {\n            fourCC = header[off_pfFourCC];\n            switch (fourCC) {\n                case FOURCC_DXT1:\n                    blockBytes = 8;\n                    internalCompressedFormat = 33777;\n                    break;\n                case FOURCC_DXT3:\n                    blockBytes = 16;\n                    internalCompressedFormat = 33778;\n                    break;\n                case FOURCC_DXT5:\n                    blockBytes = 16;\n                    internalCompressedFormat = 33779;\n                    break;\n                case FOURCC_D3DFMT_R16G16B16A16F:\n                    computeFormats = true;\n                    bpp = 64;\n                    break;\n                case FOURCC_D3DFMT_R32G32B32A32F:\n                    computeFormats = true;\n                    bpp = 128;\n                    break;\n                case FOURCC_DX10: {\n                    // There is an additionnal header so dataOffset need to be changed\n                    dataOffset += 5 * 4; // 5 uints\n                    var supported = false;\n                    switch (info.dxgiFormat) {\n                        case DXGI_FORMAT_R16G16B16A16_FLOAT:\n                            computeFormats = true;\n                            bpp = 64;\n                            supported = true;\n                            break;\n                        case DXGI_FORMAT_R32G32B32A32_FLOAT:\n                            computeFormats = true;\n                            bpp = 128;\n                            supported = true;\n                            break;\n                        case DXGI_FORMAT_B8G8R8X8_UNORM:\n                            info.isRGB = true;\n                            info.isFourCC = false;\n                            bpp = 32;\n                            supported = true;\n                            break;\n                    }\n                    if (supported) {\n                        break;\n                    }\n                }\n                // eslint-disable-next-line no-fallthrough\n                default:\n                    console.error(\"Unsupported FourCC code:\", Int32ToFourCC(fourCC));\n                    return;\n            }\n        }\n        var rOffset = DDSTools._ExtractLongWordOrder(header[off_RMask]);\n        var gOffset = DDSTools._ExtractLongWordOrder(header[off_GMask]);\n        var bOffset = DDSTools._ExtractLongWordOrder(header[off_BMask]);\n        var aOffset = DDSTools._ExtractLongWordOrder(header[off_AMask]);\n        if (computeFormats) {\n            internalCompressedFormat = engine._getRGBABufferInternalSizedFormat(info.textureType);\n        }\n        mipmapCount = 1;\n        if (header[off_flags] & DDSD_MIPMAPCOUNT && loadMipmaps !== false) {\n            mipmapCount = Math.max(1, header[off_mipmapCount]);\n        }\n        var startFace = currentFace || 0;\n        var caps = engine.getCaps();\n        for (var face = startFace; face < faces; face++) {\n            width = header[off_width];\n            height = header[off_height];\n            for (mip = 0; mip < mipmapCount; ++mip) {\n                if (lodIndex === -1 || lodIndex === mip) {\n                    // In case of fixed LOD, if the lod has just been uploaded, early exit.\n                    var i = lodIndex === -1 ? mip : 0;\n                    if (!info.isCompressed && info.isFourCC) {\n                        texture.format = 5;\n                        dataLength = width * height * 4;\n                        var floatArray = null;\n                        if (engine._badOS || engine._badDesktopOS || (!caps.textureHalfFloat && !caps.textureFloat)) {\n                            // Required because iOS has many issues with float and half float generation\n                            if (bpp === 128) {\n                                floatArray = DDSTools._GetFloatAsUIntRGBAArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, i);\n                                if (sphericalPolynomialFaces && i == 0) {\n                                    sphericalPolynomialFaces.push(DDSTools._GetFloatRGBAArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, i));\n                                }\n                            }\n                            else if (bpp === 64) {\n                                floatArray = DDSTools._GetHalfFloatAsUIntRGBAArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, i);\n                                if (sphericalPolynomialFaces && i == 0) {\n                                    sphericalPolynomialFaces.push(DDSTools._GetHalfFloatAsFloatRGBAArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, i));\n                                }\n                            }\n                            texture.type = 0;\n                        }\n                        else {\n                            var floatAvailable = caps.textureFloat && ((destTypeMustBeFilterable && caps.textureFloatLinearFiltering) || !destTypeMustBeFilterable);\n                            var halfFloatAvailable = caps.textureHalfFloat && ((destTypeMustBeFilterable && caps.textureHalfFloatLinearFiltering) || !destTypeMustBeFilterable);\n                            var destType = (bpp === 128 || (bpp === 64 && !halfFloatAvailable)) && floatAvailable\n                                ? 1\n                                : (bpp === 64 || (bpp === 128 && !floatAvailable)) && halfFloatAvailable\n                                    ? 2\n                                    : 0;\n                            var dataGetter = void 0;\n                            var dataGetterPolynomial = null;\n                            switch (bpp) {\n                                case 128: {\n                                    switch (destType) {\n                                        case 1:\n                                            dataGetter = DDSTools._GetFloatRGBAArrayBuffer;\n                                            dataGetterPolynomial = null;\n                                            break;\n                                        case 2:\n                                            dataGetter = DDSTools._GetFloatAsHalfFloatRGBAArrayBuffer;\n                                            dataGetterPolynomial = DDSTools._GetFloatRGBAArrayBuffer;\n                                            break;\n                                        case 0:\n                                            dataGetter = DDSTools._GetFloatAsUIntRGBAArrayBuffer;\n                                            dataGetterPolynomial = DDSTools._GetFloatRGBAArrayBuffer;\n                                            break;\n                                    }\n                                    break;\n                                }\n                                default: {\n                                    // 64 bpp\n                                    switch (destType) {\n                                        case 1:\n                                            dataGetter = DDSTools._GetHalfFloatAsFloatRGBAArrayBuffer;\n                                            dataGetterPolynomial = null;\n                                            break;\n                                        case 2:\n                                            dataGetter = DDSTools._GetHalfFloatRGBAArrayBuffer;\n                                            dataGetterPolynomial = DDSTools._GetHalfFloatAsFloatRGBAArrayBuffer;\n                                            break;\n                                        case 0:\n                                            dataGetter = DDSTools._GetHalfFloatAsUIntRGBAArrayBuffer;\n                                            dataGetterPolynomial = DDSTools._GetHalfFloatAsFloatRGBAArrayBuffer;\n                                            break;\n                                    }\n                                    break;\n                                }\n                            }\n                            texture.type = destType;\n                            floatArray = dataGetter(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, i);\n                            if (sphericalPolynomialFaces && i == 0) {\n                                sphericalPolynomialFaces.push(dataGetterPolynomial ? dataGetterPolynomial(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, i) : floatArray);\n                            }\n                        }\n                        if (floatArray) {\n                            engine._uploadDataToTextureDirectly(texture, floatArray, face, i);\n                        }\n                    }\n                    else if (info.isRGB) {\n                        texture.type = 0;\n                        if (bpp === 24) {\n                            texture.format = 4;\n                            dataLength = width * height * 3;\n                            byteArray = DDSTools._GetRGBArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, rOffset, gOffset, bOffset);\n                            engine._uploadDataToTextureDirectly(texture, byteArray, face, i);\n                        }\n                        else {\n                            // 32\n                            texture.format = 5;\n                            dataLength = width * height * 4;\n                            byteArray = DDSTools._GetRGBAArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer, rOffset, gOffset, bOffset, aOffset);\n                            engine._uploadDataToTextureDirectly(texture, byteArray, face, i);\n                        }\n                    }\n                    else if (info.isLuminance) {\n                        var unpackAlignment = engine._getUnpackAlignement();\n                        var unpaddedRowSize = width;\n                        var paddedRowSize = Math.floor((width + unpackAlignment - 1) / unpackAlignment) * unpackAlignment;\n                        dataLength = paddedRowSize * (height - 1) + unpaddedRowSize;\n                        byteArray = DDSTools._GetLuminanceArrayBuffer(width, height, data.byteOffset + dataOffset, dataLength, data.buffer);\n                        texture.format = 1;\n                        texture.type = 0;\n                        engine._uploadDataToTextureDirectly(texture, byteArray, face, i);\n                    }\n                    else {\n                        dataLength = (((Math.max(4, width) / 4) * Math.max(4, height)) / 4) * blockBytes;\n                        byteArray = new Uint8Array(data.buffer, data.byteOffset + dataOffset, dataLength);\n                        texture.type = 0;\n                        engine._uploadCompressedDataToTextureDirectly(texture, internalCompressedFormat, width, height, byteArray, face, i);\n                    }\n                }\n                dataOffset += bpp ? width * height * (bpp / 8) : dataLength;\n                width *= 0.5;\n                height *= 0.5;\n                width = Math.max(1.0, width);\n                height = Math.max(1.0, height);\n            }\n            if (currentFace !== undefined) {\n                // Loading a single face\n                break;\n            }\n        }\n        if (sphericalPolynomialFaces && sphericalPolynomialFaces.length > 0) {\n            info.sphericalPolynomial = CubeMapToSphericalPolynomialTools.ConvertCubeMapToSphericalPolynomial({\n                size: header[off_width],\n                right: sphericalPolynomialFaces[0],\n                left: sphericalPolynomialFaces[1],\n                up: sphericalPolynomialFaces[2],\n                down: sphericalPolynomialFaces[3],\n                front: sphericalPolynomialFaces[4],\n                back: sphericalPolynomialFaces[5],\n                format: 5,\n                type: 1,\n                gammaSpace: false,\n            });\n        }\n        else {\n            info.sphericalPolynomial = undefined;\n        }\n    };\n    /**\n     * Gets or sets a boolean indicating that LOD info is stored in alpha channel (false by default)\n     */\n    DDSTools.StoreLODInAlphaChannel = false;\n    return DDSTools;\n}());\nexport { DDSTools };\n/**\n * Create a cube texture from prefiltered data (ie. the mipmaps contain ready to use data for PBR reflection)\n * @param rootUrl defines the url where the file to load is located\n * @param scene defines the current scene\n * @param lodScale defines scale to apply to the mip map selection\n * @param lodOffset defines offset to apply to the mip map selection\n * @param onLoad defines an optional callback raised when the texture is loaded\n * @param onError defines an optional callback raised if there is an issue to load the texture\n * @param format defines the format of the data\n * @param forcedExtension defines the extension to use to pick the right loader\n * @param createPolynomials defines wheter or not to create polynomails harmonics for the texture\n * @returns the cube texture as an InternalTexture\n */\nThinEngine.prototype.createPrefilteredCubeTexture = function (rootUrl, scene, lodScale, lodOffset, onLoad, onError, format, forcedExtension, createPolynomials) {\n    var _this = this;\n    if (onLoad === void 0) { onLoad = null; }\n    if (onError === void 0) { onError = null; }\n    if (forcedExtension === void 0) { forcedExtension = null; }\n    if (createPolynomials === void 0) { createPolynomials = true; }\n    var callback = function (loadData) {\n        if (!loadData) {\n            if (onLoad) {\n                onLoad(null);\n            }\n            return;\n        }\n        var texture = loadData.texture;\n        if (!createPolynomials) {\n            texture._sphericalPolynomial = new SphericalPolynomial();\n        }\n        else if (loadData.info.sphericalPolynomial) {\n            texture._sphericalPolynomial = loadData.info.sphericalPolynomial;\n        }\n        texture._source = InternalTextureSource.CubePrefiltered;\n        if (_this.getCaps().textureLOD) {\n            // Do not add extra process if texture lod is supported.\n            if (onLoad) {\n                onLoad(texture);\n            }\n            return;\n        }\n        var mipSlices = 3;\n        var gl = _this._gl;\n        var width = loadData.width;\n        if (!width) {\n            return;\n        }\n        var textures = [];\n        for (var i = 0; i < mipSlices; i++) {\n            //compute LOD from even spacing in smoothness (matching shader calculation)\n            var smoothness = i / (mipSlices - 1);\n            var roughness = 1 - smoothness;\n            var minLODIndex = lodOffset; // roughness = 0\n            var maxLODIndex = Scalar.Log2(width) * lodScale + lodOffset; // roughness = 1\n            var lodIndex = minLODIndex + (maxLODIndex - minLODIndex) * roughness;\n            var mipmapIndex = Math.round(Math.min(Math.max(lodIndex, 0), maxLODIndex));\n            var glTextureFromLod = new InternalTexture(_this, InternalTextureSource.Temp);\n            glTextureFromLod.type = texture.type;\n            glTextureFromLod.format = texture.format;\n            glTextureFromLod.width = Math.pow(2, Math.max(Scalar.Log2(width) - mipmapIndex, 0));\n            glTextureFromLod.height = glTextureFromLod.width;\n            glTextureFromLod.isCube = true;\n            glTextureFromLod._cachedWrapU = 0;\n            glTextureFromLod._cachedWrapV = 0;\n            _this._bindTextureDirectly(gl.TEXTURE_CUBE_MAP, glTextureFromLod, true);\n            glTextureFromLod.samplingMode = 2;\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n            if (loadData.isDDS) {\n                var info = loadData.info;\n                var data = loadData.data;\n                _this._unpackFlipY(info.isCompressed);\n                DDSTools.UploadDDSLevels(_this, glTextureFromLod, data, info, true, 6, mipmapIndex);\n            }\n            else {\n                Logger.Warn(\"DDS is the only prefiltered cube map supported so far.\");\n            }\n            _this._bindTextureDirectly(gl.TEXTURE_CUBE_MAP, null);\n            // Wrap in a base texture for easy binding.\n            var lodTexture = new BaseTexture(scene);\n            lodTexture.isCube = true;\n            lodTexture._texture = glTextureFromLod;\n            glTextureFromLod.isReady = true;\n            textures.push(lodTexture);\n        }\n        texture._lodTextureHigh = textures[2];\n        texture._lodTextureMid = textures[1];\n        texture._lodTextureLow = textures[0];\n        if (onLoad) {\n            onLoad(texture);\n        }\n    };\n    return this.createCubeTexture(rootUrl, scene, null, false, callback, onError, format, forcedExtension, createPolynomials, lodScale, lodOffset);\n};\n//# sourceMappingURL=dds.js.map","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { Tags } from \"../Misc/tags.js\";\nimport { Quaternion, Vector2, Vector3, Matrix } from \"../Maths/math.vector.js\";\nimport { _WarnImport } from \"./devTools.js\";\nimport { Color4, Color3 } from \"../Maths/math.color.js\";\nvar __decoratorInitialStore = {};\nvar __mergedStore = {};\nvar _copySource = function (creationFunction, source, instanciate) {\n    var destination = creationFunction();\n    // Tags\n    if (Tags) {\n        Tags.AddTagsTo(destination, source.tags);\n    }\n    var classStore = getMergedStore(destination);\n    // Properties\n    for (var property in classStore) {\n        var propertyDescriptor = classStore[property];\n        var sourceProperty = source[property];\n        var propertyType = propertyDescriptor.type;\n        if (sourceProperty !== undefined && sourceProperty !== null && (property !== \"uniqueId\" || SerializationHelper.AllowLoadingUniqueId)) {\n            switch (propertyType) {\n                case 0: // Value\n                case 6: // Mesh reference\n                case 11: // Camera reference\n                    destination[property] = sourceProperty;\n                    break;\n                case 1: // Texture\n                    destination[property] = instanciate || sourceProperty.isRenderTarget ? sourceProperty : sourceProperty.clone();\n                    break;\n                case 2: // Color3\n                case 3: // FresnelParameters\n                case 4: // Vector2\n                case 5: // Vector3\n                case 7: // Color Curves\n                case 10: // Quaternion\n                case 12: // Matrix\n                    destination[property] = instanciate ? sourceProperty : sourceProperty.clone();\n                    break;\n            }\n        }\n    }\n    return destination;\n};\nfunction getDirectStore(target) {\n    var classKey = target.getClassName();\n    if (!__decoratorInitialStore[classKey]) {\n        __decoratorInitialStore[classKey] = {};\n    }\n    return __decoratorInitialStore[classKey];\n}\n/**\n * Return the list of properties flagged as serializable\n * @param target host object\n */\nfunction getMergedStore(target) {\n    var classKey = target.getClassName();\n    if (__mergedStore[classKey]) {\n        return __mergedStore[classKey];\n    }\n    __mergedStore[classKey] = {};\n    var store = __mergedStore[classKey];\n    var currentTarget = target;\n    var currentKey = classKey;\n    while (currentKey) {\n        var initialStore = __decoratorInitialStore[currentKey];\n        for (var property in initialStore) {\n            store[property] = initialStore[property];\n        }\n        var parent_1 = void 0;\n        var done = false;\n        do {\n            parent_1 = Object.getPrototypeOf(currentTarget);\n            if (!parent_1.getClassName) {\n                done = true;\n                break;\n            }\n            if (parent_1.getClassName() !== currentKey) {\n                break;\n            }\n            currentTarget = parent_1;\n        } while (parent_1);\n        if (done) {\n            break;\n        }\n        currentKey = parent_1.getClassName();\n        currentTarget = parent_1;\n    }\n    return store;\n}\nfunction generateSerializableMember(type, sourceName) {\n    return function (target, propertyKey) {\n        var classStore = getDirectStore(target);\n        if (!classStore[propertyKey]) {\n            classStore[propertyKey] = { type: type, sourceName: sourceName };\n        }\n    };\n}\nfunction generateExpandMember(setCallback, targetKey) {\n    if (targetKey === void 0) { targetKey = null; }\n    return function (target, propertyKey) {\n        var key = targetKey || \"_\" + propertyKey;\n        Object.defineProperty(target, propertyKey, {\n            get: function () {\n                return this[key];\n            },\n            set: function (value) {\n                // does this object (i.e. vector3) has an equals function? use it!\n                // Note - not using \"with epsilon\" here, it is expected te behave like the internal cache does.\n                if (typeof this.equals === \"function\") {\n                    if (this.equals(value)) {\n                        return;\n                    }\n                }\n                if (this[key] === value) {\n                    return;\n                }\n                this[key] = value;\n                target[setCallback].apply(this);\n            },\n            enumerable: true,\n            configurable: true,\n        });\n    };\n}\nexport function expandToProperty(callback, targetKey) {\n    if (targetKey === void 0) { targetKey = null; }\n    return generateExpandMember(callback, targetKey);\n}\nexport function serialize(sourceName) {\n    return generateSerializableMember(0, sourceName); // value member\n}\nexport function serializeAsTexture(sourceName) {\n    return generateSerializableMember(1, sourceName); // texture member\n}\nexport function serializeAsColor3(sourceName) {\n    return generateSerializableMember(2, sourceName); // color3 member\n}\nexport function serializeAsFresnelParameters(sourceName) {\n    return generateSerializableMember(3, sourceName); // fresnel parameters member\n}\nexport function serializeAsVector2(sourceName) {\n    return generateSerializableMember(4, sourceName); // vector2 member\n}\nexport function serializeAsVector3(sourceName) {\n    return generateSerializableMember(5, sourceName); // vector3 member\n}\nexport function serializeAsMeshReference(sourceName) {\n    return generateSerializableMember(6, sourceName); // mesh reference member\n}\nexport function serializeAsColorCurves(sourceName) {\n    return generateSerializableMember(7, sourceName); // color curves\n}\nexport function serializeAsColor4(sourceName) {\n    return generateSerializableMember(8, sourceName); // color 4\n}\nexport function serializeAsImageProcessingConfiguration(sourceName) {\n    return generateSerializableMember(9, sourceName); // image processing\n}\nexport function serializeAsQuaternion(sourceName) {\n    return generateSerializableMember(10, sourceName); // quaternion member\n}\nexport function serializeAsMatrix(sourceName) {\n    return generateSerializableMember(12, sourceName); // matrix member\n}\n/**\n * Decorator used to define property that can be serialized as reference to a camera\n * @param sourceName defines the name of the property to decorate\n */\nexport function serializeAsCameraReference(sourceName) {\n    return generateSerializableMember(11, sourceName); // camera reference member\n}\n/**\n * Class used to help serialization objects\n */\nvar SerializationHelper = /** @class */ (function () {\n    function SerializationHelper() {\n    }\n    /**\n     * Appends the serialized animations from the source animations\n     * @param source Source containing the animations\n     * @param destination Target to store the animations\n     */\n    SerializationHelper.AppendSerializedAnimations = function (source, destination) {\n        if (source.animations) {\n            destination.animations = [];\n            for (var animationIndex = 0; animationIndex < source.animations.length; animationIndex++) {\n                var animation = source.animations[animationIndex];\n                destination.animations.push(animation.serialize());\n            }\n        }\n    };\n    /**\n     * Static function used to serialized a specific entity\n     * @param entity defines the entity to serialize\n     * @param serializationObject defines the optional target object where serialization data will be stored\n     * @returns a JSON compatible object representing the serialization of the entity\n     */\n    SerializationHelper.Serialize = function (entity, serializationObject) {\n        if (!serializationObject) {\n            serializationObject = {};\n        }\n        // Tags\n        if (Tags) {\n            serializationObject.tags = Tags.GetTags(entity);\n        }\n        var serializedProperties = getMergedStore(entity);\n        // Properties\n        for (var property in serializedProperties) {\n            var propertyDescriptor = serializedProperties[property];\n            var targetPropertyName = propertyDescriptor.sourceName || property;\n            var propertyType = propertyDescriptor.type;\n            var sourceProperty = entity[property];\n            if (sourceProperty !== undefined && sourceProperty !== null && (property !== \"uniqueId\" || SerializationHelper.AllowLoadingUniqueId)) {\n                switch (propertyType) {\n                    case 0: // Value\n                        serializationObject[targetPropertyName] = sourceProperty;\n                        break;\n                    case 1: // Texture\n                        serializationObject[targetPropertyName] = sourceProperty.serialize();\n                        break;\n                    case 2: // Color3\n                        serializationObject[targetPropertyName] = sourceProperty.asArray();\n                        break;\n                    case 3: // FresnelParameters\n                        serializationObject[targetPropertyName] = sourceProperty.serialize();\n                        break;\n                    case 4: // Vector2\n                        serializationObject[targetPropertyName] = sourceProperty.asArray();\n                        break;\n                    case 5: // Vector3\n                        serializationObject[targetPropertyName] = sourceProperty.asArray();\n                        break;\n                    case 6: // Mesh reference\n                        serializationObject[targetPropertyName] = sourceProperty.id;\n                        break;\n                    case 7: // Color Curves\n                        serializationObject[targetPropertyName] = sourceProperty.serialize();\n                        break;\n                    case 8: // Color 4\n                        serializationObject[targetPropertyName] = sourceProperty.asArray();\n                        break;\n                    case 9: // Image Processing\n                        serializationObject[targetPropertyName] = sourceProperty.serialize();\n                        break;\n                    case 10: // Quaternion\n                        serializationObject[targetPropertyName] = sourceProperty.asArray();\n                        break;\n                    case 11: // Camera reference\n                        serializationObject[targetPropertyName] = sourceProperty.id;\n                        break;\n                    case 12: // Matrix\n                        serializationObject[targetPropertyName] = sourceProperty.asArray();\n                        break;\n                }\n            }\n        }\n        return serializationObject;\n    };\n    /**\n     * Creates a new entity from a serialization data object\n     * @param creationFunction defines a function used to instanciated the new entity\n     * @param source defines the source serialization data\n     * @param scene defines the hosting scene\n     * @param rootUrl defines the root url for resources\n     * @returns a new entity\n     */\n    SerializationHelper.Parse = function (creationFunction, source, scene, rootUrl) {\n        if (rootUrl === void 0) { rootUrl = null; }\n        var destination = creationFunction();\n        if (!rootUrl) {\n            rootUrl = \"\";\n        }\n        // Tags\n        if (Tags) {\n            Tags.AddTagsTo(destination, source.tags);\n        }\n        var classStore = getMergedStore(destination);\n        // Properties\n        for (var property in classStore) {\n            var propertyDescriptor = classStore[property];\n            var sourceProperty = source[propertyDescriptor.sourceName || property];\n            var propertyType = propertyDescriptor.type;\n            if (sourceProperty !== undefined && sourceProperty !== null && (property !== \"uniqueId\" || SerializationHelper.AllowLoadingUniqueId)) {\n                var dest = destination;\n                switch (propertyType) {\n                    case 0: // Value\n                        dest[property] = sourceProperty;\n                        break;\n                    case 1: // Texture\n                        if (scene) {\n                            dest[property] = SerializationHelper._TextureParser(sourceProperty, scene, rootUrl);\n                        }\n                        break;\n                    case 2: // Color3\n                        dest[property] = Color3.FromArray(sourceProperty);\n                        break;\n                    case 3: // FresnelParameters\n                        dest[property] = SerializationHelper._FresnelParametersParser(sourceProperty);\n                        break;\n                    case 4: // Vector2\n                        dest[property] = Vector2.FromArray(sourceProperty);\n                        break;\n                    case 5: // Vector3\n                        dest[property] = Vector3.FromArray(sourceProperty);\n                        break;\n                    case 6: // Mesh reference\n                        if (scene) {\n                            dest[property] = scene.getLastMeshById(sourceProperty);\n                        }\n                        break;\n                    case 7: // Color Curves\n                        dest[property] = SerializationHelper._ColorCurvesParser(sourceProperty);\n                        break;\n                    case 8: // Color 4\n                        dest[property] = Color4.FromArray(sourceProperty);\n                        break;\n                    case 9: // Image Processing\n                        dest[property] = SerializationHelper._ImageProcessingConfigurationParser(sourceProperty);\n                        break;\n                    case 10: // Quaternion\n                        dest[property] = Quaternion.FromArray(sourceProperty);\n                        break;\n                    case 11: // Camera reference\n                        if (scene) {\n                            dest[property] = scene.getCameraById(sourceProperty);\n                        }\n                        break;\n                    case 12: // Matrix\n                        dest[property] = Matrix.FromArray(sourceProperty);\n                        break;\n                }\n            }\n        }\n        return destination;\n    };\n    /**\n     * Clones an object\n     * @param creationFunction defines the function used to instanciate the new object\n     * @param source defines the source object\n     * @returns the cloned object\n     */\n    SerializationHelper.Clone = function (creationFunction, source) {\n        return _copySource(creationFunction, source, false);\n    };\n    /**\n     * Instanciates a new object based on a source one (some data will be shared between both object)\n     * @param creationFunction defines the function used to instanciate the new object\n     * @param source defines the source object\n     * @returns the new object\n     */\n    SerializationHelper.Instanciate = function (creationFunction, source) {\n        return _copySource(creationFunction, source, true);\n    };\n    /**\n     * Gets or sets a boolean to indicate if the UniqueId property should be serialized\n     */\n    SerializationHelper.AllowLoadingUniqueId = false;\n    /**\n     * @param sourceProperty\n     * @hidden\n     */\n    SerializationHelper._ImageProcessingConfigurationParser = function (sourceProperty) {\n        throw _WarnImport(\"ImageProcessingConfiguration\");\n    };\n    /**\n     * @param sourceProperty\n     * @hidden\n     */\n    SerializationHelper._FresnelParametersParser = function (sourceProperty) {\n        throw _WarnImport(\"FresnelParameters\");\n    };\n    /**\n     * @param sourceProperty\n     * @hidden\n     */\n    SerializationHelper._ColorCurvesParser = function (sourceProperty) {\n        throw _WarnImport(\"ColorCurves\");\n    };\n    /**\n     * @param sourceProperty\n     * @param scene\n     * @param rootUrl\n     * @hidden\n     */\n    SerializationHelper._TextureParser = function (sourceProperty, scene, rootUrl) {\n        throw _WarnImport(\"Texture\");\n    };\n    return SerializationHelper;\n}());\nexport { SerializationHelper };\n/**\n * Decorator used to redirect a function to a native implementation if available.\n * @param target\n * @param propertyKey\n * @param descriptor\n * @param predicate\n * @hidden\n */\nexport function nativeOverride(target, propertyKey, descriptor, predicate) {\n    // Cache the original JS function for later.\n    var jsFunc = descriptor.value;\n    // Override the JS function to check for a native override on first invocation. Setting descriptor.value overrides the function at the early stage of code being loaded/imported.\n    descriptor.value = function () {\n        var params = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n        }\n        // Assume the resolved function will be the original JS function, then we will check for the Babylon Native context.\n        var func = jsFunc;\n        // Check if we are executing in a Babylon Native context (e.g. check the presence of the _native global property) and if so also check if a function override is available.\n        if (typeof _native !== \"undefined\" && _native[propertyKey]) {\n            var nativeFunc_1 = _native[propertyKey];\n            // If a predicate was provided, then we'll need to invoke the predicate on each invocation of the underlying function to determine whether to call the native function or the JS function.\n            if (predicate) {\n                // The resolved function will execute the predicate and then either execute the native function or the JS function.\n                func = function () {\n                    var params = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        params[_i] = arguments[_i];\n                    }\n                    return (predicate.apply(void 0, params) ? nativeFunc_1.apply(void 0, params) : jsFunc.apply(void 0, params));\n                };\n            }\n            else {\n                // The resolved function will directly execute the native function.\n                func = nativeFunc_1;\n            }\n        }\n        // Override the JS function again with the final resolved target function.\n        target[propertyKey] = func;\n        // The JS function has now been overridden based on whether we're executing in the context of Babylon Native, but we still need to invoke that function.\n        // Future invocations of the function will just directly invoke the final overridden function, not any of the decorator setup logic above.\n        return func.apply(void 0, params);\n    };\n}\n/**\n * Decorator factory that applies the nativeOverride decorator, but determines whether to redirect to the native implementation based on a filter function that evaluates the function arguments.\n * @param predicate\n * @example @nativeOverride.filter((...[arg1]: Parameters<typeof someClass.someMethod>) => arg1.length > 20)\n *          public someMethod(arg1: string, arg2: number): string {\n * @hidden\n */\nnativeOverride.filter = function (predicate) {\n    return function (target, propertyKey, descriptor) {\n        return nativeOverride(target, propertyKey, descriptor, predicate);\n    };\n};\n//# sourceMappingURL=decorators.js.map","import { Logger } from \"./logger.js\";\nvar CloneValue = function (source, destinationObject) {\n    if (!source) {\n        return null;\n    }\n    if (source.getClassName && source.getClassName() === \"Mesh\") {\n        return null;\n    }\n    if (source.getClassName && source.getClassName() === \"SubMesh\") {\n        return source.clone(destinationObject);\n    }\n    else if (source.clone) {\n        return source.clone();\n    }\n    return null;\n};\nfunction GetAllPropertyNames(obj) {\n    var props = [];\n    do {\n        Object.getOwnPropertyNames(obj).forEach(function (prop) {\n            if (props.indexOf(prop) === -1) {\n                props.push(prop);\n            }\n        });\n    } while ((obj = Object.getPrototypeOf(obj)));\n    return props;\n}\n/**\n * Class containing a set of static utilities functions for deep copy.\n */\nvar DeepCopier = /** @class */ (function () {\n    function DeepCopier() {\n    }\n    /**\n     * Tries to copy an object by duplicating every property\n     * @param source defines the source object\n     * @param destination defines the target object\n     * @param doNotCopyList defines a list of properties to avoid\n     * @param mustCopyList defines a list of properties to copy (even if they start with _)\n     */\n    DeepCopier.DeepCopy = function (source, destination, doNotCopyList, mustCopyList) {\n        var properties = GetAllPropertyNames(source);\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n            var prop = properties_1[_i];\n            if (prop[0] === \"_\" && (!mustCopyList || mustCopyList.indexOf(prop) === -1)) {\n                continue;\n            }\n            if (prop.endsWith(\"Observable\")) {\n                continue;\n            }\n            if (doNotCopyList && doNotCopyList.indexOf(prop) !== -1) {\n                continue;\n            }\n            var sourceValue = source[prop];\n            var typeOfSourceValue = typeof sourceValue;\n            if (typeOfSourceValue === \"function\") {\n                continue;\n            }\n            try {\n                if (typeOfSourceValue === \"object\") {\n                    if (sourceValue instanceof Array) {\n                        destination[prop] = [];\n                        if (sourceValue.length > 0) {\n                            if (typeof sourceValue[0] == \"object\") {\n                                for (var index = 0; index < sourceValue.length; index++) {\n                                    var clonedValue = CloneValue(sourceValue[index], destination);\n                                    if (destination[prop].indexOf(clonedValue) === -1) {\n                                        // Test if auto inject was not done\n                                        destination[prop].push(clonedValue);\n                                    }\n                                }\n                            }\n                            else {\n                                destination[prop] = sourceValue.slice(0);\n                            }\n                        }\n                    }\n                    else {\n                        destination[prop] = CloneValue(sourceValue, destination);\n                    }\n                }\n                else {\n                    destination[prop] = sourceValue;\n                }\n            }\n            catch (e) {\n                // Log a warning (it could be because of a read-only property)\n                Logger.Warn(e.message);\n            }\n        }\n    };\n    return DeepCopier;\n}());\nexport { DeepCopier };\n//# sourceMappingURL=deepCopier.js.map","/**\n * Wrapper class for promise with external resolve and reject.\n */\nvar Deferred = /** @class */ (function () {\n    /**\n     * Constructor for this deferred object.\n     */\n    function Deferred() {\n        var _this = this;\n        this.promise = new Promise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n    }\n    Object.defineProperty(Deferred.prototype, \"resolve\", {\n        /**\n         * The resolve method of the promise associated with this deferred object.\n         */\n        get: function () {\n            return this._resolve;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Deferred.prototype, \"reject\", {\n        /**\n         * The reject method of the promise associated with this deferred object.\n         */\n        get: function () {\n            return this._reject;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Deferred;\n}());\nexport { Deferred };\n//# sourceMappingURL=deferred.js.map","import { __extends } from \"tslib\";\n\nimport { DepthRenderer } from \"../Rendering/depthRenderer.js\";\nimport { MinMaxReducer } from \"./minMaxReducer.js\";\n/**\n * This class is a small wrapper around the MinMaxReducer class to compute the min/max values of a depth texture\n */\nvar DepthReducer = /** @class */ (function (_super) {\n    __extends(DepthReducer, _super);\n    /**\n     * Creates a depth reducer\n     * @param camera The camera used to render the depth texture\n     */\n    function DepthReducer(camera) {\n        return _super.call(this, camera) || this;\n    }\n    Object.defineProperty(DepthReducer.prototype, \"depthRenderer\", {\n        /**\n         * Gets the depth renderer used for the computation.\n         * Note that the result is null if you provide your own renderer when calling setDepthRenderer.\n         */\n        get: function () {\n            return this._depthRenderer;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Sets the depth renderer to use to generate the depth map\n     * @param depthRenderer The depth renderer to use. If not provided, a new one will be created automatically\n     * @param type The texture type of the depth map (default: TEXTURETYPE_HALF_FLOAT)\n     * @param forceFullscreenViewport Forces the post processes used for the reduction to be applied without taking into account viewport (defaults to true)\n     */\n    DepthReducer.prototype.setDepthRenderer = function (depthRenderer, type, forceFullscreenViewport) {\n        if (depthRenderer === void 0) { depthRenderer = null; }\n        if (type === void 0) { type = 2; }\n        if (forceFullscreenViewport === void 0) { forceFullscreenViewport = true; }\n        var scene = this._camera.getScene();\n        if (this._depthRenderer) {\n            delete scene._depthRenderer[this._depthRendererId];\n            this._depthRenderer.dispose();\n            this._depthRenderer = null;\n        }\n        if (depthRenderer === null) {\n            if (!scene._depthRenderer) {\n                scene._depthRenderer = {};\n            }\n            depthRenderer = this._depthRenderer = new DepthRenderer(scene, type, this._camera, false, 1);\n            depthRenderer.enabled = false;\n            this._depthRendererId = \"minmax\" + this._camera.id;\n            scene._depthRenderer[this._depthRendererId] = depthRenderer;\n        }\n        _super.prototype.setSourceTexture.call(this, depthRenderer.getDepthMap(), true, type, forceFullscreenViewport);\n    };\n    /**\n     * @param sourceTexture\n     * @param depthRedux\n     * @param type\n     * @param forceFullscreenViewport\n     * @hidden\n     */\n    DepthReducer.prototype.setSourceTexture = function (sourceTexture, depthRedux, type, forceFullscreenViewport) {\n        if (type === void 0) { type = 2; }\n        if (forceFullscreenViewport === void 0) { forceFullscreenViewport = true; }\n        _super.prototype.setSourceTexture.call(this, sourceTexture, depthRedux, type, forceFullscreenViewport);\n    };\n    /**\n     * Activates the reduction computation.\n     * When activated, the observers registered in onAfterReductionPerformed are\n     * called after the computation is performed\n     */\n    DepthReducer.prototype.activate = function () {\n        if (this._depthRenderer) {\n            this._depthRenderer.enabled = true;\n        }\n        _super.prototype.activate.call(this);\n    };\n    /**\n     * Deactivates the reduction computation.\n     */\n    DepthReducer.prototype.deactivate = function () {\n        _super.prototype.deactivate.call(this);\n        if (this._depthRenderer) {\n            this._depthRenderer.enabled = false;\n        }\n    };\n    /**\n     * Disposes the depth reducer\n     * @param disposeAll true to dispose all the resources. You should always call this function with true as the parameter (or without any parameter as it is the default one). This flag is meant to be used internally.\n     */\n    DepthReducer.prototype.dispose = function (disposeAll) {\n        if (disposeAll === void 0) { disposeAll = true; }\n        _super.prototype.dispose.call(this, disposeAll);\n        if (this._depthRenderer && disposeAll) {\n            var scene = this._depthRenderer.getDepthMap().getScene();\n            if (scene) {\n                delete scene._depthRenderer[this._depthRendererId];\n            }\n            this._depthRenderer.dispose();\n            this._depthRenderer = null;\n        }\n    };\n    return DepthReducer;\n}(MinMaxReducer));\nexport { DepthReducer };\n//# sourceMappingURL=depthReducer.js.map","/**\n * @param name\n * @hidden\n */\nexport function _WarnImport(name) {\n    return \"\".concat(name, \" needs to be imported before as it contains a side-effect required by your code.\");\n}\n//# sourceMappingURL=devTools.js.map","/* eslint-disable @typescript-eslint/naming-convention */\n/**\n * Checks if the window object exists\n * @returns true if the window object exists\n */\nexport function IsWindowObjectExist() {\n    return typeof window !== \"undefined\";\n}\n/**\n * Checks if the navigator object exists\n * @returns true if the navigator object exists\n */\nexport function IsNavigatorAvailable() {\n    return typeof navigator !== \"undefined\";\n}\n/**\n * Check if the document object exists\n * @returns true if the document object exists\n */\nexport function IsDocumentAvailable() {\n    return typeof document !== \"undefined\";\n}\n/**\n * Extracts text content from a DOM element hierarchy\n * @param element defines the root element\n * @returns a string\n */\nexport function GetDOMTextContent(element) {\n    var result = \"\";\n    var child = element.firstChild;\n    while (child) {\n        if (child.nodeType === 3) {\n            result += child.textContent;\n        }\n        child = child.nextSibling;\n    }\n    return result;\n}\n/**\n * Sets of helpers dealing with the DOM and some of the recurrent functions needed in\n * Babylon.js\n */\nexport var DomManagement = {\n    /**\n     * Checks if the window object exists\n     * @returns true if the window object exists\n     */\n    IsWindowObjectExist: IsWindowObjectExist,\n    /**\n     * Checks if the navigator object exists\n     * @returns true if the navigator object exists\n     */\n    IsNavigatorAvailable: IsNavigatorAvailable,\n    /**\n     * Check if the document object exists\n     * @returns true if the document object exists\n     */\n    IsDocumentAvailable: IsDocumentAvailable,\n    /**\n     * Extracts text content from a DOM element hierarchy\n     * @param element defines the root element\n     * @returns a string\n     */\n    GetDOMTextContent: GetDOMTextContent,\n};\n//# sourceMappingURL=domManagement.js.map","import { __assign, __awaiter, __generator } from \"tslib\";\nimport { Tools } from \"./tools.js\";\nimport { Vector3 } from \"../Maths/math.vector.js\";\nimport { Scalar } from \"../Maths/math.scalar.js\";\nimport { SphericalPolynomial } from \"../Maths/sphericalPolynomial.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { BaseTexture } from \"../Materials/Textures/baseTexture.js\";\n\nimport { Scene } from \"../scene.js\";\nimport { PostProcess } from \"../PostProcesses/postProcess.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { RGBDTextureTools } from \"./rgbdTextureTools.js\";\nimport \"../Engines/Extensions/engine.renderTargetCube.js\";\nimport \"../Engines/Extensions/engine.readTexture.js\";\nimport \"../Materials/Textures/baseTexture.polynomial.js\";\nimport \"../Shaders/rgbdEncode.fragment.js\";\nimport \"../Shaders/rgbdDecode.fragment.js\";\nvar DefaultEnvironmentTextureImageType = \"image/png\";\nvar CurrentVersion = 2;\n/**\n * Magic number identifying the env file.\n */\nvar MagicBytes = [0x86, 0x16, 0x87, 0x96, 0xf6, 0xd6, 0x96, 0x36];\n/**\n * Gets the environment info from an env file.\n * @param data The array buffer containing the .env bytes.\n * @returns the environment file info (the json header) if successfully parsed, normalized to the latest supported version.\n */\nexport function GetEnvInfo(data) {\n    var dataView = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    var pos = 0;\n    for (var i = 0; i < MagicBytes.length; i++) {\n        if (dataView.getUint8(pos++) !== MagicBytes[i]) {\n            Logger.Error(\"Not a babylon environment map\");\n            return null;\n        }\n    }\n    // Read json manifest - collect characters up to null terminator\n    var manifestString = \"\";\n    var charCode = 0x00;\n    while ((charCode = dataView.getUint8(pos++))) {\n        manifestString += String.fromCharCode(charCode);\n    }\n    var manifest = JSON.parse(manifestString);\n    manifest = normalizeEnvInfo(manifest);\n    if (manifest.specular) {\n        // Extend the header with the position of the payload.\n        manifest.specular.specularDataPosition = pos;\n        // Fallback to 0.8 exactly if lodGenerationScale is not defined for backward compatibility.\n        manifest.specular.lodGenerationScale = manifest.specular.lodGenerationScale || 0.8;\n    }\n    return manifest;\n}\n/**\n * Normalizes any supported version of the environment file info to the latest version\n * @param info environment file info on any supported version\n * @returns environment file info in the latest supported version\n * @private\n */\nexport function normalizeEnvInfo(info) {\n    if (info.version > CurrentVersion) {\n        throw new Error(\"Unsupported babylon environment map version \\\"\".concat(info.version, \"\\\". Latest supported version is \\\"\").concat(CurrentVersion, \"\\\".\"));\n    }\n    if (info.version === 2) {\n        return info;\n    }\n    // Migrate a v1 info to v2\n    info = __assign(__assign({}, info), { version: 2, imageType: DefaultEnvironmentTextureImageType });\n    return info;\n}\n/**\n * Creates an environment texture from a loaded cube texture.\n * @param texture defines the cube texture to convert in env file\n * @param options options for the conversion process\n * @param options.imageType the mime type for the encoded images, with support for \"image/png\" (default) and \"image/webp\"\n * @param options.imageQuality the image quality of encoded WebP images.\n * @return a promise containing the environment data if successful.\n */\nexport function CreateEnvTextureAsync(texture, options) {\n    var _a;\n    if (options === void 0) { options = {}; }\n    return __awaiter(this, void 0, void 0, function () {\n        var internalTexture, imageType, engine, textureType, cubeWidth, hostingScene, specularTextures, mipmapsCount, i, faceWidth, face, faceData, faceDataFloat, i_1, tempTexture, rgbdEncodedData, imageEncodedData, info, position, i, face, byteLength, infoString, infoBuffer, infoView, i, strLen, totalSize, finalBuffer, finalBufferView, dataView, pos, i, i, face, dataBuffer;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    internalTexture = texture.getInternalTexture();\n                    if (!internalTexture) {\n                        return [2 /*return*/, Promise.reject(\"The cube texture is invalid.\")];\n                    }\n                    imageType = (_a = options.imageType) !== null && _a !== void 0 ? _a : DefaultEnvironmentTextureImageType;\n                    engine = internalTexture.getEngine();\n                    if (texture.textureType !== 2 &&\n                        texture.textureType !== 1 &&\n                        texture.textureType !== 0 &&\n                        texture.textureType !== 0 &&\n                        texture.textureType !== 7 &&\n                        texture.textureType !== -1) {\n                        return [2 /*return*/, Promise.reject(\"The cube texture should allow HDR (Full Float or Half Float).\")];\n                    }\n                    textureType = 1;\n                    if (!engine.getCaps().textureFloatRender) {\n                        textureType = 2;\n                        if (!engine.getCaps().textureHalfFloatRender) {\n                            return [2 /*return*/, Promise.reject(\"Env texture can only be created when the browser supports half float or full float rendering.\")];\n                        }\n                    }\n                    cubeWidth = internalTexture.width;\n                    hostingScene = new Scene(engine);\n                    specularTextures = {};\n                    // As we are going to readPixels the faces of the cube, make sure the drawing/update commands for the cube texture are fully sent to the GPU in case it is drawn for the first time in this very frame!\n                    engine.flushFramebuffer();\n                    mipmapsCount = Scalar.ILog2(internalTexture.width);\n                    i = 0;\n                    _b.label = 1;\n                case 1:\n                    if (!(i <= mipmapsCount)) return [3 /*break*/, 9];\n                    faceWidth = Math.pow(2, mipmapsCount - i);\n                    face = 0;\n                    _b.label = 2;\n                case 2:\n                    if (!(face < 6)) return [3 /*break*/, 8];\n                    return [4 /*yield*/, texture.readPixels(face, i, undefined, false)];\n                case 3:\n                    faceData = _b.sent();\n                    if (faceData && faceData.byteLength === faceData.length) {\n                        faceDataFloat = new Float32Array(faceData.byteLength * 4);\n                        for (i_1 = 0; i_1 < faceData.byteLength; i_1++) {\n                            faceDataFloat[i_1] = faceData[i_1] / 255;\n                            // Gamma to linear\n                            faceDataFloat[i_1] = Math.pow(faceDataFloat[i_1], 2.2);\n                        }\n                        faceData = faceDataFloat;\n                    }\n                    tempTexture = engine.createRawTexture(faceData, faceWidth, faceWidth, 5, false, true, 1, null, textureType);\n                    return [4 /*yield*/, RGBDTextureTools.EncodeTextureToRGBD(tempTexture, hostingScene, textureType)];\n                case 4:\n                    _b.sent();\n                    return [4 /*yield*/, engine._readTexturePixels(tempTexture, faceWidth, faceWidth)];\n                case 5:\n                    rgbdEncodedData = _b.sent();\n                    return [4 /*yield*/, Tools.DumpDataAsync(faceWidth, faceWidth, rgbdEncodedData, imageType, undefined, false, true, options.imageQuality)];\n                case 6:\n                    imageEncodedData = _b.sent();\n                    specularTextures[i * 6 + face] = imageEncodedData;\n                    tempTexture.dispose();\n                    _b.label = 7;\n                case 7:\n                    face++;\n                    return [3 /*break*/, 2];\n                case 8:\n                    i++;\n                    return [3 /*break*/, 1];\n                case 9:\n                    // We can delete the hosting scene keeping track of all the creation objects\n                    hostingScene.dispose();\n                    info = {\n                        version: CurrentVersion,\n                        width: cubeWidth,\n                        imageType: imageType,\n                        irradiance: _CreateEnvTextureIrradiance(texture),\n                        specular: {\n                            mipmaps: [],\n                            lodGenerationScale: texture.lodGenerationScale,\n                        },\n                    };\n                    position = 0;\n                    for (i = 0; i <= mipmapsCount; i++) {\n                        for (face = 0; face < 6; face++) {\n                            byteLength = specularTextures[i * 6 + face].byteLength;\n                            info.specular.mipmaps.push({\n                                length: byteLength,\n                                position: position,\n                            });\n                            position += byteLength;\n                        }\n                    }\n                    infoString = JSON.stringify(info);\n                    infoBuffer = new ArrayBuffer(infoString.length + 1);\n                    infoView = new Uint8Array(infoBuffer);\n                    for (i = 0, strLen = infoString.length; i < strLen; i++) {\n                        infoView[i] = infoString.charCodeAt(i);\n                    }\n                    // Ends up with a null terminator for easier parsing\n                    infoView[infoString.length] = 0x00;\n                    totalSize = MagicBytes.length + position + infoBuffer.byteLength;\n                    finalBuffer = new ArrayBuffer(totalSize);\n                    finalBufferView = new Uint8Array(finalBuffer);\n                    dataView = new DataView(finalBuffer);\n                    pos = 0;\n                    for (i = 0; i < MagicBytes.length; i++) {\n                        dataView.setUint8(pos++, MagicBytes[i]);\n                    }\n                    // Add the json info\n                    finalBufferView.set(new Uint8Array(infoBuffer), pos);\n                    pos += infoBuffer.byteLength;\n                    // Finally inserts the texture data\n                    for (i = 0; i <= mipmapsCount; i++) {\n                        for (face = 0; face < 6; face++) {\n                            dataBuffer = specularTextures[i * 6 + face];\n                            finalBufferView.set(new Uint8Array(dataBuffer), pos);\n                            pos += dataBuffer.byteLength;\n                        }\n                    }\n                    // Voila\n                    return [2 /*return*/, finalBuffer];\n            }\n        });\n    });\n}\n/**\n * Creates a JSON representation of the spherical data.\n * @param texture defines the texture containing the polynomials\n * @return the JSON representation of the spherical info\n */\nfunction _CreateEnvTextureIrradiance(texture) {\n    var polynmials = texture.sphericalPolynomial;\n    if (polynmials == null) {\n        return null;\n    }\n    return {\n        x: [polynmials.x.x, polynmials.x.y, polynmials.x.z],\n        y: [polynmials.y.x, polynmials.y.y, polynmials.y.z],\n        z: [polynmials.z.x, polynmials.z.y, polynmials.z.z],\n        xx: [polynmials.xx.x, polynmials.xx.y, polynmials.xx.z],\n        yy: [polynmials.yy.x, polynmials.yy.y, polynmials.yy.z],\n        zz: [polynmials.zz.x, polynmials.zz.y, polynmials.zz.z],\n        yz: [polynmials.yz.x, polynmials.yz.y, polynmials.yz.z],\n        zx: [polynmials.zx.x, polynmials.zx.y, polynmials.zx.z],\n        xy: [polynmials.xy.x, polynmials.xy.y, polynmials.xy.z],\n    };\n}\n/**\n * Creates the ArrayBufferViews used for initializing environment texture image data.\n * @param data the image data\n * @param info parameters that determine what views will be created for accessing the underlying buffer\n * @return the views described by info providing access to the underlying buffer\n */\nexport function CreateImageDataArrayBufferViews(data, info) {\n    info = normalizeEnvInfo(info);\n    var specularInfo = info.specular;\n    // Double checks the enclosed info\n    var mipmapsCount = Scalar.Log2(info.width);\n    mipmapsCount = Math.round(mipmapsCount) + 1;\n    if (specularInfo.mipmaps.length !== 6 * mipmapsCount) {\n        throw new Error(\"Unsupported specular mipmaps number \\\"\".concat(specularInfo.mipmaps.length, \"\\\"\"));\n    }\n    var imageData = new Array(mipmapsCount);\n    for (var i = 0; i < mipmapsCount; i++) {\n        imageData[i] = new Array(6);\n        for (var face = 0; face < 6; face++) {\n            var imageInfo = specularInfo.mipmaps[i * 6 + face];\n            imageData[i][face] = new Uint8Array(data.buffer, data.byteOffset + specularInfo.specularDataPosition + imageInfo.position, imageInfo.length);\n        }\n    }\n    return imageData;\n}\n/**\n * Uploads the texture info contained in the env file to the GPU.\n * @param texture defines the internal texture to upload to\n * @param data defines the data to load\n * @param info defines the texture info retrieved through the GetEnvInfo method\n * @returns a promise\n */\nexport function UploadEnvLevelsAsync(texture, data, info) {\n    info = normalizeEnvInfo(info);\n    var specularInfo = info.specular;\n    if (!specularInfo) {\n        // Nothing else parsed so far\n        return Promise.resolve();\n    }\n    texture._lodGenerationScale = specularInfo.lodGenerationScale;\n    var imageData = CreateImageDataArrayBufferViews(data, info);\n    return UploadLevelsAsync(texture, imageData, info.imageType);\n}\nfunction _OnImageReadyAsync(image, engine, expandTexture, rgbdPostProcess, url, face, i, generateNonLODTextures, lodTextures, cubeRtt, texture) {\n    return new Promise(function (resolve, reject) {\n        if (expandTexture) {\n            var tempTexture_1 = engine.createTexture(null, true, true, null, 1, null, function (message) {\n                reject(message);\n            }, image);\n            rgbdPostProcess.getEffect().executeWhenCompiled(function () {\n                // Uncompress the data to a RTT\n                rgbdPostProcess.externalTextureSamplerBinding = true;\n                rgbdPostProcess.onApply = function (effect) {\n                    effect._bindTexture(\"textureSampler\", tempTexture_1);\n                    effect.setFloat2(\"scale\", 1, engine._features.needsInvertingBitmap && image instanceof ImageBitmap ? -1 : 1);\n                };\n                if (!engine.scenes.length) {\n                    return;\n                }\n                engine.scenes[0].postProcessManager.directRender([rgbdPostProcess], cubeRtt, true, face, i);\n                // Cleanup\n                engine.restoreDefaultFramebuffer();\n                tempTexture_1.dispose();\n                URL.revokeObjectURL(url);\n                resolve();\n            });\n        }\n        else {\n            engine._uploadImageToTexture(texture, image, face, i);\n            // Upload the face to the non lod texture support\n            if (generateNonLODTextures) {\n                var lodTexture = lodTextures[i];\n                if (lodTexture) {\n                    engine._uploadImageToTexture(lodTexture._texture, image, face, 0);\n                }\n            }\n            resolve();\n        }\n    });\n}\n/**\n * Uploads the levels of image data to the GPU.\n * @param texture defines the internal texture to upload to\n * @param imageData defines the array buffer views of image data [mipmap][face]\n * @param imageType the mime type of the image data\n * @returns a promise\n */\nexport function UploadLevelsAsync(texture, imageData, imageType) {\n    if (imageType === void 0) { imageType = DefaultEnvironmentTextureImageType; }\n    if (!Tools.IsExponentOfTwo(texture.width)) {\n        throw new Error(\"Texture size must be a power of two\");\n    }\n    var mipmapsCount = Scalar.ILog2(texture.width) + 1;\n    // Gets everything ready.\n    var engine = texture.getEngine();\n    var expandTexture = false;\n    var generateNonLODTextures = false;\n    var rgbdPostProcess = null;\n    var cubeRtt = null;\n    var lodTextures = null;\n    var caps = engine.getCaps();\n    texture.format = 5;\n    texture.type = 0;\n    texture.generateMipMaps = true;\n    texture._cachedAnisotropicFilteringLevel = null;\n    engine.updateTextureSamplingMode(3, texture);\n    // Add extra process if texture lod is not supported\n    if (!caps.textureLOD) {\n        expandTexture = false;\n        generateNonLODTextures = true;\n        lodTextures = {};\n    }\n    // in webgl 1 there are no ways to either render or copy lod level information for float textures.\n    else if (!engine._features.supportRenderAndCopyToLodForFloatTextures) {\n        expandTexture = false;\n    }\n    // If half float available we can uncompress the texture\n    else if (caps.textureHalfFloatRender && caps.textureHalfFloatLinearFiltering) {\n        expandTexture = true;\n        texture.type = 2;\n    }\n    // If full float available we can uncompress the texture\n    else if (caps.textureFloatRender && caps.textureFloatLinearFiltering) {\n        expandTexture = true;\n        texture.type = 1;\n    }\n    // Expand the texture if possible\n    if (expandTexture) {\n        // Simply run through the decode PP\n        rgbdPostProcess = new PostProcess(\"rgbdDecode\", \"rgbdDecode\", null, null, 1, null, 3, engine, false, undefined, texture.type, undefined, null, false);\n        texture._isRGBD = false;\n        texture.invertY = false;\n        cubeRtt = engine.createRenderTargetCubeTexture(texture.width, {\n            generateDepthBuffer: false,\n            generateMipMaps: true,\n            generateStencilBuffer: false,\n            samplingMode: 3,\n            type: texture.type,\n            format: 5,\n        });\n    }\n    else {\n        texture._isRGBD = true;\n        texture.invertY = true;\n        // In case of missing support, applies the same patch than DDS files.\n        if (generateNonLODTextures) {\n            var mipSlices = 3;\n            var scale = texture._lodGenerationScale;\n            var offset = texture._lodGenerationOffset;\n            for (var i = 0; i < mipSlices; i++) {\n                //compute LOD from even spacing in smoothness (matching shader calculation)\n                var smoothness = i / (mipSlices - 1);\n                var roughness = 1 - smoothness;\n                var minLODIndex = offset; // roughness = 0\n                var maxLODIndex = (mipmapsCount - 1) * scale + offset; // roughness = 1 (mipmaps start from 0)\n                var lodIndex = minLODIndex + (maxLODIndex - minLODIndex) * roughness;\n                var mipmapIndex = Math.round(Math.min(Math.max(lodIndex, 0), maxLODIndex));\n                var glTextureFromLod = new InternalTexture(engine, InternalTextureSource.Temp);\n                glTextureFromLod.isCube = true;\n                glTextureFromLod.invertY = true;\n                glTextureFromLod.generateMipMaps = false;\n                engine.updateTextureSamplingMode(2, glTextureFromLod);\n                // Wrap in a base texture for easy binding.\n                var lodTexture = new BaseTexture(null);\n                lodTexture.isCube = true;\n                lodTexture._texture = glTextureFromLod;\n                lodTextures[mipmapIndex] = lodTexture;\n                switch (i) {\n                    case 0:\n                        texture._lodTextureLow = lodTexture;\n                        break;\n                    case 1:\n                        texture._lodTextureMid = lodTexture;\n                        break;\n                    case 2:\n                        texture._lodTextureHigh = lodTexture;\n                        break;\n                }\n            }\n        }\n    }\n    var promises = [];\n    var _loop_1 = function (i) {\n        var _loop_2 = function (face) {\n            // Constructs an image element from image data\n            var bytes = imageData[i][face];\n            var blob = new Blob([bytes], { type: imageType });\n            var url = URL.createObjectURL(blob);\n            var promise = void 0;\n            if (typeof Image === \"undefined\" || engine._features.forceBitmapOverHTMLImageElement) {\n                promise = engine.createImageBitmap(blob, { premultiplyAlpha: \"none\" }).then(function (img) {\n                    return _OnImageReadyAsync(img, engine, expandTexture, rgbdPostProcess, url, face, i, generateNonLODTextures, lodTextures, cubeRtt, texture);\n                });\n            }\n            else {\n                var image_1 = new Image();\n                image_1.src = url;\n                // Enqueue promise to upload to the texture.\n                promise = new Promise(function (resolve, reject) {\n                    image_1.onload = function () {\n                        _OnImageReadyAsync(image_1, engine, expandTexture, rgbdPostProcess, url, face, i, generateNonLODTextures, lodTextures, cubeRtt, texture)\n                            .then(function () { return resolve(); })\n                            .catch(function (reason) {\n                            reject(reason);\n                        });\n                    };\n                    image_1.onerror = function (error) {\n                        reject(error);\n                    };\n                });\n            }\n            promises.push(promise);\n        };\n        // All faces\n        for (var face = 0; face < 6; face++) {\n            _loop_2(face);\n        }\n    };\n    // All mipmaps up to provided number of images\n    for (var i = 0; i < imageData.length; i++) {\n        _loop_1(i);\n    }\n    // Fill remaining mipmaps with black textures.\n    if (imageData.length < mipmapsCount) {\n        var data = void 0;\n        var size = Math.pow(2, mipmapsCount - 1 - imageData.length);\n        var dataLength = size * size * 4;\n        switch (texture.type) {\n            case 0: {\n                data = new Uint8Array(dataLength);\n                break;\n            }\n            case 2: {\n                data = new Uint16Array(dataLength);\n                break;\n            }\n            case 1: {\n                data = new Float32Array(dataLength);\n                break;\n            }\n        }\n        for (var i = imageData.length; i < mipmapsCount; i++) {\n            for (var face = 0; face < 6; face++) {\n                engine._uploadArrayBufferViewToTexture(texture, data, face, i);\n            }\n        }\n    }\n    // Once all done, finishes the cleanup and return\n    return Promise.all(promises).then(function () {\n        // Release temp RTT.\n        if (cubeRtt) {\n            engine._releaseTexture(texture);\n            cubeRtt._swapAndDie(texture);\n        }\n        // Release temp Post Process.\n        if (rgbdPostProcess) {\n            rgbdPostProcess.dispose();\n        }\n        // Flag internal texture as ready in case they are in use.\n        if (generateNonLODTextures) {\n            if (texture._lodTextureHigh && texture._lodTextureHigh._texture) {\n                texture._lodTextureHigh._texture.isReady = true;\n            }\n            if (texture._lodTextureMid && texture._lodTextureMid._texture) {\n                texture._lodTextureMid._texture.isReady = true;\n            }\n            if (texture._lodTextureLow && texture._lodTextureLow._texture) {\n                texture._lodTextureLow._texture.isReady = true;\n            }\n        }\n    });\n}\n/**\n * Uploads spherical polynomials information to the texture.\n * @param texture defines the texture we are trying to upload the information to\n * @param info defines the environment texture info retrieved through the GetEnvInfo method\n */\nexport function UploadEnvSpherical(texture, info) {\n    info = normalizeEnvInfo(info);\n    var irradianceInfo = info.irradiance;\n    if (!irradianceInfo) {\n        return;\n    }\n    var sp = new SphericalPolynomial();\n    Vector3.FromArrayToRef(irradianceInfo.x, 0, sp.x);\n    Vector3.FromArrayToRef(irradianceInfo.y, 0, sp.y);\n    Vector3.FromArrayToRef(irradianceInfo.z, 0, sp.z);\n    Vector3.FromArrayToRef(irradianceInfo.xx, 0, sp.xx);\n    Vector3.FromArrayToRef(irradianceInfo.yy, 0, sp.yy);\n    Vector3.FromArrayToRef(irradianceInfo.zz, 0, sp.zz);\n    Vector3.FromArrayToRef(irradianceInfo.yz, 0, sp.yz);\n    Vector3.FromArrayToRef(irradianceInfo.zx, 0, sp.zx);\n    Vector3.FromArrayToRef(irradianceInfo.xy, 0, sp.xy);\n    texture._sphericalPolynomial = sp;\n}\n/**\n * @param internalTexture\n * @param data\n * @param sphericalPolynomial\n * @param lodScale\n * @param lodOffset\n * @hidden\n */\nexport function _UpdateRGBDAsync(internalTexture, data, sphericalPolynomial, lodScale, lodOffset) {\n    var proxy = internalTexture\n        .getEngine()\n        .createRawCubeTexture(null, internalTexture.width, internalTexture.format, internalTexture.type, internalTexture.generateMipMaps, internalTexture.invertY, internalTexture.samplingMode, internalTexture._compression);\n    var proxyPromise = UploadLevelsAsync(proxy, data).then(function () { return internalTexture; });\n    internalTexture.onRebuildCallback = function (_internalTexture) {\n        return {\n            proxy: proxyPromise,\n            isReady: true,\n            isAsync: true,\n        };\n    };\n    internalTexture._source = InternalTextureSource.CubeRawRGBD;\n    internalTexture._bufferViewArrayArray = data;\n    internalTexture._lodGenerationScale = lodScale;\n    internalTexture._lodGenerationOffset = lodOffset;\n    internalTexture._sphericalPolynomial = sphericalPolynomial;\n    return UploadLevelsAsync(internalTexture, data).then(function () {\n        internalTexture.isReady = true;\n        return internalTexture;\n    });\n}\n/**\n * Sets of helpers addressing the serialization and deserialization of environment texture\n * stored in a BabylonJS env file.\n * Those files are usually stored as .env files.\n */\nexport var EnvironmentTextureTools = {\n    /**\n     * Gets the environment info from an env file.\n     * @param data The array buffer containing the .env bytes.\n     * @returns the environment file info (the json header) if successfully parsed, normalized to the latest supported version.\n     */\n    GetEnvInfo: GetEnvInfo,\n    /**\n     * Creates an environment texture from a loaded cube texture.\n     * @param texture defines the cube texture to convert in env file\n     * @param options options for the conversion process\n     * @param options.imageType the mime type for the encoded images, with support for \"image/png\" (default) and \"image/webp\"\n     * @param options.imageQuality the image quality of encoded WebP images.\n     * @return a promise containing the environment data if successful.\n     */\n    CreateEnvTextureAsync: CreateEnvTextureAsync,\n    /**\n     * Creates the ArrayBufferViews used for initializing environment texture image data.\n     * @param data the image data\n     * @param info parameters that determine what views will be created for accessing the underlying buffer\n     * @return the views described by info providing access to the underlying buffer\n     */\n    CreateImageDataArrayBufferViews: CreateImageDataArrayBufferViews,\n    /**\n     * Uploads the texture info contained in the env file to the GPU.\n     * @param texture defines the internal texture to upload to\n     * @param data defines the data to load\n     * @param info defines the texture info retrieved through the GetEnvInfo method\n     * @returns a promise\n     */\n    UploadEnvLevelsAsync: UploadEnvLevelsAsync,\n    /**\n     * Uploads the levels of image data to the GPU.\n     * @param texture defines the internal texture to upload to\n     * @param imageData defines the array buffer views of image data [mipmap][face]\n     * @param imageType the mime type of the image data\n     * @returns a promise\n     */\n    UploadLevelsAsync: UploadLevelsAsync,\n    /**\n     * Uploads spherical polynomials information to the texture.\n     * @param texture defines the texture we are trying to upload the information to\n     * @param info defines the environment texture info retrieved through the GetEnvInfo method\n     */\n    UploadEnvSpherical: UploadEnvSpherical,\n};\n//# sourceMappingURL=environmentTextureTools.js.map","import { __extends } from \"tslib\";\n/* eslint-disable @typescript-eslint/naming-convention */\n/**\n * Base error. Due to limitations of typedoc-check and missing documentation\n * in lib.es5.d.ts, cannot extend Error directly for RuntimeError.\n * @ignore\n */\nvar BaseError = /** @class */ (function (_super) {\n    __extends(BaseError, _super);\n    function BaseError() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    // See https://stackoverflow.com/questions/12915412/how-do-i-extend-a-host-object-e-g-error-in-typescript\n    // and https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n    // Polyfill for Object.setPrototypeOf if necessary.\n    BaseError._setPrototypeOf = Object.setPrototypeOf ||\n        (function (o, proto) {\n            o.__proto__ = proto;\n            return o;\n        });\n    return BaseError;\n}(Error));\nexport { BaseError };\n/* IMP! DO NOT CHANGE THE NUMBERING OF EXISTING ERROR CODES */\n/**\n * Error codes for BaseError\n */\nexport var ErrorCodes = {\n    // Mesh errors 0-999\n    /** Invalid or empty mesh vertex positions. */\n    MeshInvalidPositionsError: 0,\n    // Texture errors 1000-1999\n    /** Unsupported texture found. */\n    UnsupportedTextureError: 1000,\n    // GLTFLoader errors 2000-2999\n    /** Unexpected magic number found in GLTF file header. */\n    GLTFLoaderUnexpectedMagicError: 2000,\n    // SceneLoader errors 3000-3999\n    /** SceneLoader generic error code. Ideally wraps the inner exception. */\n    SceneLoaderError: 3000,\n    // File related errors 4000-4999\n    /** Load file error */\n    LoadFileError: 4000,\n    /** Request file error */\n    RequestFileError: 4001,\n    /** Read file error */\n    ReadFileError: 4002,\n};\n/**\n * Application runtime error\n */\nvar RuntimeError = /** @class */ (function (_super) {\n    __extends(RuntimeError, _super);\n    /**\n     * Creates a new RuntimeError\n     * @param message defines the message of the error\n     * @param errorCode the error code\n     * @param innerError the error that caused the outer error\n     */\n    function RuntimeError(message, errorCode, innerError) {\n        var _this = _super.call(this, message) || this;\n        _this.errorCode = errorCode;\n        _this.innerError = innerError;\n        _this.name = \"RuntimeError\";\n        BaseError._setPrototypeOf(_this, RuntimeError.prototype);\n        return _this;\n    }\n    return RuntimeError;\n}(BaseError));\nexport { RuntimeError };\n//# sourceMappingURL=error.js.map","import { __assign, __extends } from \"tslib\";\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { WebRequest } from \"./webRequest.js\";\nimport { IsWindowObjectExist } from \"./domManagement.js\";\nimport { Observable } from \"./observable.js\";\nimport { FilesInputStore } from \"./filesInputStore.js\";\nimport { RetryStrategy } from \"./retryStrategy.js\";\nimport { BaseError, ErrorCodes, RuntimeError } from \"./error.js\";\nimport { DecodeBase64ToBinary, DecodeBase64ToString, EncodeArrayBufferToBase64 } from \"./stringTools.js\";\nimport { ShaderProcessor } from \"../Engines/Processors/shaderProcessor.js\";\nimport { ThinEngine } from \"../Engines/thinEngine.js\";\nimport { EngineStore } from \"../Engines/engineStore.js\";\nimport { Logger } from \"./logger.js\";\nimport { TimingTools } from \"./timingTools.js\";\nvar Base64DataUrlRegEx = new RegExp(/^data:([^,]+\\/[^,]+)?;base64,/i);\n/** @ignore */\nvar LoadFileError = /** @class */ (function (_super) {\n    __extends(LoadFileError, _super);\n    /**\n     * Creates a new LoadFileError\n     * @param message defines the message of the error\n     * @param object defines the optional web request\n     */\n    function LoadFileError(message, object) {\n        var _this = _super.call(this, message, ErrorCodes.LoadFileError) || this;\n        _this.name = \"LoadFileError\";\n        BaseError._setPrototypeOf(_this, LoadFileError.prototype);\n        if (object instanceof WebRequest) {\n            _this.request = object;\n        }\n        else {\n            _this.file = object;\n        }\n        return _this;\n    }\n    return LoadFileError;\n}(RuntimeError));\nexport { LoadFileError };\n/** @ignore */\nvar RequestFileError = /** @class */ (function (_super) {\n    __extends(RequestFileError, _super);\n    /**\n     * Creates a new LoadFileError\n     * @param message defines the message of the error\n     * @param request defines the optional web request\n     */\n    function RequestFileError(message, request) {\n        var _this = _super.call(this, message, ErrorCodes.RequestFileError) || this;\n        _this.request = request;\n        _this.name = \"RequestFileError\";\n        BaseError._setPrototypeOf(_this, RequestFileError.prototype);\n        return _this;\n    }\n    return RequestFileError;\n}(RuntimeError));\nexport { RequestFileError };\n/** @ignore */\nvar ReadFileError = /** @class */ (function (_super) {\n    __extends(ReadFileError, _super);\n    /**\n     * Creates a new ReadFileError\n     * @param message defines the message of the error\n     * @param file defines the optional file\n     */\n    function ReadFileError(message, file) {\n        var _this = _super.call(this, message, ErrorCodes.ReadFileError) || this;\n        _this.file = file;\n        _this.name = \"ReadFileError\";\n        BaseError._setPrototypeOf(_this, ReadFileError.prototype);\n        return _this;\n    }\n    return ReadFileError;\n}(RuntimeError));\nexport { ReadFileError };\n/**\n * @hidden\n */\nexport var FileToolsOptions = {\n    /**\n     * Gets or sets the retry strategy to apply when an error happens while loading an asset.\n     * When defining this function, return the wait time before trying again or return -1 to\n     * stop retrying and error out.\n     */\n    DefaultRetryStrategy: RetryStrategy.ExponentialBackoff(),\n    /**\n     * Gets or sets the base URL to use to load assets\n     */\n    BaseUrl: \"\",\n    /**\n     * Default behaviour for cors in the application.\n     * It can be a string if the expected behavior is identical in the entire app.\n     * Or a callback to be able to set it per url or on a group of them (in case of Video source for instance)\n     */\n    CorsBehavior: \"anonymous\",\n    /**\n     * Gets or sets a function used to pre-process url before using them to load assets\n     * @param url\n     */\n    PreprocessUrl: function (url) {\n        return url;\n    }\n};\n/**\n * Removes unwanted characters from an url\n * @param url defines the url to clean\n * @returns the cleaned url\n */\nvar _CleanUrl = function (url) {\n    url = url.replace(/#/gm, \"%23\");\n    return url;\n};\n/**\n * Sets the cors behavior on a dom element. This will add the required Tools.CorsBehavior to the element.\n * @param url define the url we are trying\n * @param element define the dom element where to configure the cors policy\n * @param element.crossOrigin\n * @hidden\n */\nexport var SetCorsBehavior = function (url, element) {\n    if (url && url.indexOf(\"data:\") === 0) {\n        return;\n    }\n    if (FileToolsOptions.CorsBehavior) {\n        if (typeof FileToolsOptions.CorsBehavior === \"string\" || FileToolsOptions.CorsBehavior instanceof String) {\n            element.crossOrigin = FileToolsOptions.CorsBehavior;\n        }\n        else {\n            var result = FileToolsOptions.CorsBehavior(url);\n            if (result) {\n                element.crossOrigin = result;\n            }\n        }\n    }\n};\n/**\n * Loads an image as an HTMLImageElement.\n * @param input url string, ArrayBuffer, or Blob to load\n * @param onLoad callback called when the image successfully loads\n * @param onError callback called when the image fails to load\n * @param offlineProvider offline provider for caching\n * @param mimeType optional mime type\n * @param imageBitmapOptions\n * @returns the HTMLImageElement of the loaded image\n * @hidden\n */\nexport var LoadImage = function (input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions) {\n    var _a;\n    if (mimeType === void 0) { mimeType = \"\"; }\n    var url;\n    var usingObjectURL = false;\n    if (input instanceof ArrayBuffer || ArrayBuffer.isView(input)) {\n        if (typeof Blob !== \"undefined\") {\n            url = URL.createObjectURL(new Blob([input], { type: mimeType }));\n            usingObjectURL = true;\n        }\n        else {\n            url = \"data:\".concat(mimeType, \";base64,\") + EncodeArrayBufferToBase64(input);\n        }\n    }\n    else if (input instanceof Blob) {\n        url = URL.createObjectURL(input);\n        usingObjectURL = true;\n    }\n    else {\n        url = _CleanUrl(input);\n        url = FileToolsOptions.PreprocessUrl(input);\n    }\n    var engine = EngineStore.LastCreatedEngine;\n    var onErrorHandler = function (exception) {\n        if (onError) {\n            var inputText = url || input.toString();\n            onError(\"Error while trying to load image: \".concat(inputText.indexOf(\"http\") === 0 || inputText.length <= 128 ? inputText : inputText.slice(0, 128) + \"...\"), exception);\n        }\n    };\n    if (typeof Image === \"undefined\" || ((_a = engine === null || engine === void 0 ? void 0 : engine._features.forceBitmapOverHTMLImageElement) !== null && _a !== void 0 ? _a : false)) {\n        LoadFile(url, function (data) {\n            engine\n                .createImageBitmap(new Blob([data], { type: mimeType }), __assign({ premultiplyAlpha: \"none\" }, imageBitmapOptions))\n                .then(function (imgBmp) {\n                onLoad(imgBmp);\n                if (usingObjectURL) {\n                    URL.revokeObjectURL(url);\n                }\n            })\n                .catch(function (reason) {\n                if (onError) {\n                    onError(\"Error while trying to load image: \" + input, reason);\n                }\n            });\n        }, undefined, offlineProvider || undefined, true, function (request, exception) {\n            onErrorHandler(exception);\n        });\n        return null;\n    }\n    var img = new Image();\n    SetCorsBehavior(url, img);\n    var loadHandler = function () {\n        img.removeEventListener(\"load\", loadHandler);\n        img.removeEventListener(\"error\", errorHandler);\n        onLoad(img);\n        // Must revoke the URL after calling onLoad to avoid security exceptions in\n        // certain scenarios (e.g. when hosted in vscode).\n        if (usingObjectURL && img.src) {\n            URL.revokeObjectURL(img.src);\n        }\n    };\n    var errorHandler = function (err) {\n        img.removeEventListener(\"load\", loadHandler);\n        img.removeEventListener(\"error\", errorHandler);\n        onErrorHandler(err);\n        if (usingObjectURL && img.src) {\n            URL.revokeObjectURL(img.src);\n        }\n    };\n    img.addEventListener(\"load\", loadHandler);\n    img.addEventListener(\"error\", errorHandler);\n    var noOfflineSupport = function () {\n        img.src = url;\n    };\n    var loadFromOfflineSupport = function () {\n        if (offlineProvider) {\n            offlineProvider.loadImage(url, img);\n        }\n    };\n    if (url.substr(0, 5) !== \"blob:\" && url.substr(0, 5) !== \"data:\" && offlineProvider && offlineProvider.enableTexturesOffline) {\n        offlineProvider.open(loadFromOfflineSupport, noOfflineSupport);\n    }\n    else {\n        if (url.indexOf(\"file:\") !== -1) {\n            var textureName = decodeURIComponent(url.substring(5).toLowerCase());\n            if (FilesInputStore.FilesToLoad[textureName]) {\n                try {\n                    var blobURL = void 0;\n                    try {\n                        blobURL = URL.createObjectURL(FilesInputStore.FilesToLoad[textureName]);\n                    }\n                    catch (ex) {\n                        // Chrome doesn't support oneTimeOnly parameter\n                        blobURL = URL.createObjectURL(FilesInputStore.FilesToLoad[textureName]);\n                    }\n                    img.src = blobURL;\n                    usingObjectURL = true;\n                }\n                catch (e) {\n                    img.src = \"\";\n                }\n                return img;\n            }\n        }\n        noOfflineSupport();\n    }\n    return img;\n};\n/**\n * Reads a file from a File object\n * @param file defines the file to load\n * @param onSuccess defines the callback to call when data is loaded\n * @param onProgress defines the callback to call during loading process\n * @param useArrayBuffer defines a boolean indicating that data must be returned as an ArrayBuffer\n * @param onError defines the callback to call when an error occurs\n * @returns a file request object\n * @hidden\n */\nexport var ReadFile = function (file, onSuccess, onProgress, useArrayBuffer, onError) {\n    var reader = new FileReader();\n    var fileRequest = {\n        onCompleteObservable: new Observable(),\n        abort: function () { return reader.abort(); }\n    };\n    reader.onloadend = function () { return fileRequest.onCompleteObservable.notifyObservers(fileRequest); };\n    if (onError) {\n        reader.onerror = function () {\n            onError(new ReadFileError(\"Unable to read \".concat(file.name), file));\n        };\n    }\n    reader.onload = function (e) {\n        //target doesn't have result from ts 1.3\n        onSuccess(e.target[\"result\"]);\n    };\n    if (onProgress) {\n        reader.onprogress = onProgress;\n    }\n    if (!useArrayBuffer) {\n        // Asynchronous read\n        reader.readAsText(file);\n    }\n    else {\n        reader.readAsArrayBuffer(file);\n    }\n    return fileRequest;\n};\n/**\n * Loads a file from a url, a data url, or a file url\n * @param fileOrUrl file, url, data url, or file url to load\n * @param onSuccess callback called when the file successfully loads\n * @param onProgress callback called while file is loading (if the server supports this mode)\n * @param offlineProvider defines the offline provider for caching\n * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n * @param onError callback called when the file fails to load\n * @param onOpened\n * @returns a file request object\n * @hidden\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport var LoadFile = function (fileOrUrl, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError, onOpened) {\n    if (fileOrUrl.name) {\n        return ReadFile(fileOrUrl, onSuccess, onProgress, useArrayBuffer, onError\n            ? function (error) {\n                onError(undefined, error);\n            }\n            : undefined);\n    }\n    var url = fileOrUrl;\n    // If file and file input are set\n    if (url.indexOf(\"file:\") !== -1) {\n        var fileName = decodeURIComponent(url.substring(5).toLowerCase());\n        if (fileName.indexOf(\"./\") === 0) {\n            fileName = fileName.substring(2);\n        }\n        var file = FilesInputStore.FilesToLoad[fileName];\n        if (file) {\n            return ReadFile(file, onSuccess, onProgress, useArrayBuffer, onError ? function (error) { return onError(undefined, new LoadFileError(error.message, error.file)); } : undefined);\n        }\n    }\n    // For a Base64 Data URL\n    if (IsBase64DataUrl(url)) {\n        var fileRequest_1 = {\n            onCompleteObservable: new Observable(),\n            abort: function () { return function () { }; }\n        };\n        try {\n            onSuccess(useArrayBuffer ? DecodeBase64UrlToBinary(url) : DecodeBase64UrlToString(url));\n        }\n        catch (error) {\n            if (onError) {\n                onError(undefined, error);\n            }\n            else {\n                Logger.Error(error.message || \"Failed to parse the Data URL\");\n            }\n        }\n        TimingTools.SetImmediate(function () {\n            fileRequest_1.onCompleteObservable.notifyObservers(fileRequest_1);\n        });\n        return fileRequest_1;\n    }\n    return RequestFile(url, function (data, request) {\n        onSuccess(data, request ? request.responseURL : undefined);\n    }, onProgress, offlineProvider, useArrayBuffer, onError\n        ? function (error) {\n            onError(error.request, new LoadFileError(error.message, error.request));\n        }\n        : undefined, onOpened);\n};\n/**\n * Loads a file from a url\n * @param url url to load\n * @param onSuccess callback called when the file successfully loads\n * @param onProgress callback called while file is loading (if the server supports this mode)\n * @param offlineProvider defines the offline provider for caching\n * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n * @param onError callback called when the file fails to load\n * @param onOpened callback called when the web request is opened\n * @returns a file request object\n * @hidden\n */\nexport var RequestFile = function (url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError, onOpened) {\n    url = _CleanUrl(url);\n    url = FileToolsOptions.PreprocessUrl(url);\n    var loadUrl = FileToolsOptions.BaseUrl + url;\n    var aborted = false;\n    var fileRequest = {\n        onCompleteObservable: new Observable(),\n        abort: function () { return (aborted = true); }\n    };\n    var requestFile = function () {\n        var request = new WebRequest();\n        var retryHandle = null;\n        var onReadyStateChange;\n        var unbindEvents = function () {\n            if (!request) {\n                return;\n            }\n            if (onProgress) {\n                request.removeEventListener(\"progress\", onProgress);\n            }\n            if (onReadyStateChange) {\n                request.removeEventListener(\"readystatechange\", onReadyStateChange);\n            }\n            request.removeEventListener(\"loadend\", onLoadEnd);\n        };\n        var onLoadEnd = function () {\n            unbindEvents();\n            fileRequest.onCompleteObservable.notifyObservers(fileRequest);\n            fileRequest.onCompleteObservable.clear();\n            onProgress = undefined;\n            onReadyStateChange = null;\n            onLoadEnd = null;\n            onError = undefined;\n            onOpened = undefined;\n            onSuccess = undefined;\n        };\n        fileRequest.abort = function () {\n            aborted = true;\n            if (onLoadEnd) {\n                onLoadEnd();\n            }\n            if (request && request.readyState !== (XMLHttpRequest.DONE || 4)) {\n                request.abort();\n            }\n            if (retryHandle !== null) {\n                clearTimeout(retryHandle);\n                retryHandle = null;\n            }\n            request = null;\n        };\n        var handleError = function (error) {\n            var message = error.message || \"Unknown error\";\n            if (onError && request) {\n                onError(new RequestFileError(message, request));\n            }\n            else {\n                Logger.Error(message);\n            }\n        };\n        var retryLoop = function (retryIndex) {\n            if (!request) {\n                return;\n            }\n            request.open(\"GET\", loadUrl);\n            if (onOpened) {\n                try {\n                    onOpened(request);\n                }\n                catch (e) {\n                    handleError(e);\n                    return;\n                }\n            }\n            if (useArrayBuffer) {\n                request.responseType = \"arraybuffer\";\n            }\n            if (onProgress) {\n                request.addEventListener(\"progress\", onProgress);\n            }\n            if (onLoadEnd) {\n                request.addEventListener(\"loadend\", onLoadEnd);\n            }\n            onReadyStateChange = function () {\n                if (aborted || !request) {\n                    return;\n                }\n                // In case of undefined state in some browsers.\n                if (request.readyState === (XMLHttpRequest.DONE || 4)) {\n                    // Some browsers have issues where onreadystatechange can be called multiple times with the same value.\n                    if (onReadyStateChange) {\n                        request.removeEventListener(\"readystatechange\", onReadyStateChange);\n                    }\n                    if ((request.status >= 200 && request.status < 300) || (request.status === 0 && (!IsWindowObjectExist() || IsFileURL()))) {\n                        try {\n                            if (onSuccess) {\n                                onSuccess(useArrayBuffer ? request.response : request.responseText, request);\n                            }\n                        }\n                        catch (e) {\n                            handleError(e);\n                        }\n                        return;\n                    }\n                    var retryStrategy = FileToolsOptions.DefaultRetryStrategy;\n                    if (retryStrategy) {\n                        var waitTime = retryStrategy(loadUrl, request, retryIndex);\n                        if (waitTime !== -1) {\n                            // Prevent the request from completing for retry.\n                            unbindEvents();\n                            request = new WebRequest();\n                            retryHandle = setTimeout(function () { return retryLoop(retryIndex + 1); }, waitTime);\n                            return;\n                        }\n                    }\n                    var error = new RequestFileError(\"Error status: \" + request.status + \" \" + request.statusText + \" - Unable to load \" + loadUrl, request);\n                    if (onError) {\n                        onError(error);\n                    }\n                }\n            };\n            request.addEventListener(\"readystatechange\", onReadyStateChange);\n            request.send();\n        };\n        retryLoop(0);\n    };\n    // Caching all files\n    if (offlineProvider && offlineProvider.enableSceneOffline) {\n        var noOfflineSupport_1 = function (request) {\n            if (request && request.status > 400) {\n                if (onError) {\n                    onError(request);\n                }\n            }\n            else {\n                requestFile();\n            }\n        };\n        var loadFromOfflineSupport = function () {\n            // TODO: database needs to support aborting and should return a IFileRequest\n            if (offlineProvider) {\n                offlineProvider.loadFile(FileToolsOptions.BaseUrl + url, function (data) {\n                    if (!aborted && onSuccess) {\n                        onSuccess(data);\n                    }\n                    fileRequest.onCompleteObservable.notifyObservers(fileRequest);\n                }, onProgress\n                    ? function (event) {\n                        if (!aborted && onProgress) {\n                            onProgress(event);\n                        }\n                    }\n                    : undefined, noOfflineSupport_1, useArrayBuffer);\n            }\n        };\n        offlineProvider.open(loadFromOfflineSupport, noOfflineSupport_1);\n    }\n    else {\n        requestFile();\n    }\n    return fileRequest;\n};\n/**\n * Checks if the loaded document was accessed via `file:`-Protocol.\n * @returns boolean\n * @hidden\n */\nexport var IsFileURL = function () {\n    return typeof location !== \"undefined\" && location.protocol === \"file:\";\n};\n/**\n * Test if the given uri is a valid base64 data url\n * @param uri The uri to test\n * @return True if the uri is a base64 data url or false otherwise\n * @hidden\n */\nexport var IsBase64DataUrl = function (uri) {\n    return Base64DataUrlRegEx.test(uri);\n};\n/**\n * Decode the given base64 uri.\n * @param uri The uri to decode\n * @return The decoded base64 data.\n * @hidden\n */\nexport function DecodeBase64UrlToBinary(uri) {\n    return DecodeBase64ToBinary(uri.split(\",\")[1]);\n}\n/**\n * Decode the given base64 uri into a UTF-8 encoded string.\n * @param uri The uri to decode\n * @return The decoded base64 data.\n * @hidden\n */\nexport var DecodeBase64UrlToString = function (uri) {\n    return DecodeBase64ToString(uri.split(\",\")[1]);\n};\n/**\n * This will be executed automatically for UMD and es5.\n * If esm dev wants the side effects to execute they will have to run it manually\n * Once we build native modules those need to be exported.\n * @hidden\n */\nvar initSideEffects = function () {\n    ThinEngine._FileToolsLoadImage = LoadImage;\n    ThinEngine._FileToolsLoadFile = LoadFile;\n    ShaderProcessor._FileToolsLoadFile = LoadFile;\n};\ninitSideEffects();\n/**\n* FileTools defined as any.\n* This should not be imported or used in future releases or in any module in the framework\n* @hidden\n* @deprecated import the needed function from fileTools.ts\n*/\nexport var FileTools;\n/**\n * @param DecodeBase64UrlToBinary\n * @param DecodeBase64UrlToString\n * @param FileToolsOptions\n * @param FileToolsOptions.DefaultRetryStrategy\n * @param FileToolsOptions.BaseUrl\n * @param FileToolsOptions.CorsBehavior\n * @param FileToolsOptions.PreprocessUrl\n * @param IsBase64DataUrl\n * @param IsFileURL\n * @param LoadFile\n * @param LoadImage\n * @param ReadFile\n * @param RequestFile\n * @param SetCorsBehavior\n * @hidden\n */\nexport var _injectLTSFileTools = function (DecodeBase64UrlToBinary, DecodeBase64UrlToString, FileToolsOptions, IsBase64DataUrl, IsFileURL, LoadFile, LoadImage, ReadFile, RequestFile, SetCorsBehavior) {\n    /**\n     * Backwards compatibility.\n     * @hidden\n     * @deprecated\n     */\n    FileTools = {\n        DecodeBase64UrlToBinary: DecodeBase64UrlToBinary,\n        DecodeBase64UrlToString: DecodeBase64UrlToString,\n        DefaultRetryStrategy: FileToolsOptions.DefaultRetryStrategy,\n        BaseUrl: FileToolsOptions.BaseUrl,\n        CorsBehavior: FileToolsOptions.CorsBehavior,\n        PreprocessUrl: FileToolsOptions.PreprocessUrl,\n        IsBase64DataUrl: IsBase64DataUrl,\n        IsFileURL: IsFileURL,\n        LoadFile: LoadFile,\n        LoadImage: LoadImage,\n        ReadFile: ReadFile,\n        RequestFile: RequestFile,\n        SetCorsBehavior: SetCorsBehavior\n    };\n    Object.defineProperty(FileTools, \"DefaultRetryStrategy\", {\n        get: function () {\n            return FileToolsOptions.DefaultRetryStrategy;\n        },\n        set: function (value) {\n            FileToolsOptions.DefaultRetryStrategy = value;\n        }\n    });\n    Object.defineProperty(FileTools, \"BaseUrl\", {\n        get: function () {\n            return FileToolsOptions.BaseUrl;\n        },\n        set: function (value) {\n            FileToolsOptions.BaseUrl = value;\n        }\n    });\n    Object.defineProperty(FileTools, \"PreprocessUrl\", {\n        get: function () {\n            return FileToolsOptions.PreprocessUrl;\n        },\n        set: function (value) {\n            FileToolsOptions.PreprocessUrl = value;\n        }\n    });\n    Object.defineProperty(FileTools, \"CorsBehavior\", {\n        get: function () {\n            return FileToolsOptions.CorsBehavior;\n        },\n        set: function (value) {\n            FileToolsOptions.CorsBehavior = value;\n        }\n    });\n};\n_injectLTSFileTools(DecodeBase64UrlToBinary, DecodeBase64UrlToString, FileToolsOptions, IsBase64DataUrl, IsFileURL, LoadFile, LoadImage, ReadFile, RequestFile, SetCorsBehavior);\n//# sourceMappingURL=fileTools.js.map","/**\n * Class used to help managing file picking and drag'n'drop\n * File Storage\n */\nvar FilesInputStore = /** @class */ (function () {\n    function FilesInputStore() {\n    }\n    /**\n     * List of files ready to be loaded\n     */\n    FilesInputStore.FilesToLoad = {};\n    return FilesInputStore;\n}());\nexport { FilesInputStore };\n//# sourceMappingURL=filesInputStore.js.map","import { Color4 } from \"../Maths/math.color.js\";\n/** Class used to store color4 gradient */\nvar ColorGradient = /** @class */ (function () {\n    /**\n     * Creates a new color4 gradient\n     * @param gradient gets or sets the gradient value (between 0 and 1)\n     * @param color1 gets or sets first associated color\n     * @param color2 gets or sets first second color\n     */\n    function ColorGradient(\n    /**\n     * Gets or sets the gradient value (between 0 and 1)\n     */\n    gradient, \n    /**\n     * Gets or sets first associated color\n     */\n    color1, \n    /**\n     * Gets or sets second associated color\n     */\n    color2) {\n        this.gradient = gradient;\n        this.color1 = color1;\n        this.color2 = color2;\n    }\n    /**\n     * Will get a color picked randomly between color1 and color2.\n     * If color2 is undefined then color1 will be used\n     * @param result defines the target Color4 to store the result in\n     */\n    ColorGradient.prototype.getColorToRef = function (result) {\n        if (!this.color2) {\n            result.copyFrom(this.color1);\n            return;\n        }\n        Color4.LerpToRef(this.color1, this.color2, Math.random(), result);\n    };\n    return ColorGradient;\n}());\nexport { ColorGradient };\n/** Class used to store color 3 gradient */\nvar Color3Gradient = /** @class */ (function () {\n    /**\n     * Creates a new color3 gradient\n     * @param gradient gets or sets the gradient value (between 0 and 1)\n     * @param color gets or sets associated color\n     */\n    function Color3Gradient(\n    /**\n     * Gets or sets the gradient value (between 0 and 1)\n     */\n    gradient, \n    /**\n     * Gets or sets the associated color\n     */\n    color) {\n        this.gradient = gradient;\n        this.color = color;\n    }\n    return Color3Gradient;\n}());\nexport { Color3Gradient };\n/** Class used to store factor gradient */\nvar FactorGradient = /** @class */ (function () {\n    /**\n     * Creates a new factor gradient\n     * @param gradient gets or sets the gradient value (between 0 and 1)\n     * @param factor1 gets or sets first associated factor\n     * @param factor2 gets or sets second associated factor\n     */\n    function FactorGradient(\n    /**\n     * Gets or sets the gradient value (between 0 and 1)\n     */\n    gradient, \n    /**\n     * Gets or sets first associated factor\n     */\n    factor1, \n    /**\n     * Gets or sets second associated factor\n     */\n    factor2) {\n        this.gradient = gradient;\n        this.factor1 = factor1;\n        this.factor2 = factor2;\n    }\n    /**\n     * Will get a number picked randomly between factor1 and factor2.\n     * If factor2 is undefined then factor1 will be used\n     * @returns the picked number\n     */\n    FactorGradient.prototype.getFactor = function () {\n        if (this.factor2 === undefined || this.factor2 === this.factor1) {\n            return this.factor1;\n        }\n        return this.factor1 + (this.factor2 - this.factor1) * Math.random();\n    };\n    return FactorGradient;\n}());\nexport { FactorGradient };\n/**\n * Helper used to simplify some generic gradient tasks\n */\nvar GradientHelper = /** @class */ (function () {\n    function GradientHelper() {\n    }\n    /**\n     * Gets the current gradient from an array of IValueGradient\n     * @param ratio defines the current ratio to get\n     * @param gradients defines the array of IValueGradient\n     * @param updateFunc defines the callback function used to get the final value from the selected gradients\n     */\n    GradientHelper.GetCurrentGradient = function (ratio, gradients, updateFunc) {\n        // Use last index if over\n        if (gradients[0].gradient > ratio) {\n            updateFunc(gradients[0], gradients[0], 1.0);\n            return;\n        }\n        for (var gradientIndex = 0; gradientIndex < gradients.length - 1; gradientIndex++) {\n            var currentGradient = gradients[gradientIndex];\n            var nextGradient = gradients[gradientIndex + 1];\n            if (ratio >= currentGradient.gradient && ratio <= nextGradient.gradient) {\n                var scale = (ratio - currentGradient.gradient) / (nextGradient.gradient - currentGradient.gradient);\n                updateFunc(currentGradient, nextGradient, scale);\n                return;\n            }\n        }\n        // Use last index if over\n        var lastIndex = gradients.length - 1;\n        updateFunc(gradients[lastIndex], gradients[lastIndex], 1.0);\n    };\n    return GradientHelper;\n}());\nexport { GradientHelper };\n//# sourceMappingURL=gradients.js.map","/**\n * Implementation from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#answer-2117523\n * Be aware Math.random() could cause collisions, but:\n * \"All but 6 of the 128 bits of the ID are randomly generated, which means that for any two ids, there's a 1 in 2^^122 (or 5.3x10^^36) chance they'll collide\"\n * @returns a pseudo random id\n */\nexport function RandomGUID() {\n    return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n        var r = (Math.random() * 16) | 0, v = c === \"x\" ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\n/**\n * Class used to manipulate GUIDs\n */\nexport var GUID = {\n    /**\n     * Implementation from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#answer-2117523\n     * Be aware Math.random() could cause collisions, but:\n     * \"All but 6 of the 128 bits of the ID are randomly generated, which means that for any two ids, there's a 1 in 2^^122 (or 5.3x10^^36) chance they'll collide\"\n     * @returns a pseudo random id\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    RandomId: RandomGUID,\n};\n//# sourceMappingURL=guid.js.map","import { __extends } from \"tslib\";\nimport { SceneLoader } from \"../Loading/sceneLoader.js\";\nimport { Tools } from \"./tools.js\";\nimport { Observable } from \"./observable.js\";\nimport { Texture } from \"../Materials/Textures/texture.js\";\nimport { CubeTexture } from \"../Materials/Textures/cubeTexture.js\";\nimport { HDRCubeTexture } from \"../Materials/Textures/hdrCubeTexture.js\";\nimport { EquiRectangularCubeTexture } from \"../Materials/Textures/equiRectangularCubeTexture.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { EngineStore } from \"../Engines/engineStore.js\";\n/**\n * Defines the list of states available for a task inside a AssetsManager\n */\nexport var AssetTaskState;\n(function (AssetTaskState) {\n    /**\n     * Initialization\n     */\n    AssetTaskState[AssetTaskState[\"INIT\"] = 0] = \"INIT\";\n    /**\n     * Running\n     */\n    AssetTaskState[AssetTaskState[\"RUNNING\"] = 1] = \"RUNNING\";\n    /**\n     * Done\n     */\n    AssetTaskState[AssetTaskState[\"DONE\"] = 2] = \"DONE\";\n    /**\n     * Error\n     */\n    AssetTaskState[AssetTaskState[\"ERROR\"] = 3] = \"ERROR\";\n})(AssetTaskState || (AssetTaskState = {}));\n/**\n * Define an abstract asset task used with a AssetsManager class to load assets into a scene\n */\nvar AbstractAssetTask = /** @class */ (function () {\n    /**\n     * Creates a new AssetsManager\n     * @param name defines the name of the task\n     */\n    function AbstractAssetTask(\n    /**\n     * Task name\n     */ name) {\n        this.name = name;\n        this._isCompleted = false;\n        this._taskState = AssetTaskState.INIT;\n    }\n    Object.defineProperty(AbstractAssetTask.prototype, \"isCompleted\", {\n        /**\n         * Get if the task is completed\n         */\n        get: function () {\n            return this._isCompleted;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(AbstractAssetTask.prototype, \"taskState\", {\n        /**\n         * Gets the current state of the task\n         */\n        get: function () {\n            return this._taskState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(AbstractAssetTask.prototype, \"errorObject\", {\n        /**\n         * Gets the current error object (if task is in error)\n         */\n        get: function () {\n            return this._errorObject;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Internal only\n     * @param message\n     * @param exception\n     * @hidden\n     */\n    AbstractAssetTask.prototype._setErrorObject = function (message, exception) {\n        if (this._errorObject) {\n            return;\n        }\n        this._errorObject = {\n            message: message,\n            exception: exception,\n        };\n    };\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    AbstractAssetTask.prototype.run = function (scene, onSuccess, onError) {\n        var _this = this;\n        this._taskState = AssetTaskState.RUNNING;\n        this.runTask(scene, function () {\n            _this._onDoneCallback(onSuccess, onError);\n        }, function (msg, exception) {\n            _this._onErrorCallback(onError, msg, exception);\n        });\n    };\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    AbstractAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        throw new Error(\"runTask is not implemented\");\n    };\n    /**\n     * Reset will set the task state back to INIT, so the next load call of the assets manager will execute this task again.\n     * This can be used with failed tasks that have the reason for failure fixed.\n     */\n    AbstractAssetTask.prototype.reset = function () {\n        this._taskState = AssetTaskState.INIT;\n    };\n    AbstractAssetTask.prototype._onErrorCallback = function (onError, message, exception) {\n        this._taskState = AssetTaskState.ERROR;\n        this._errorObject = {\n            message: message,\n            exception: exception,\n        };\n        if (this.onError) {\n            this.onError(this, message, exception);\n        }\n        onError();\n    };\n    AbstractAssetTask.prototype._onDoneCallback = function (onSuccess, onError) {\n        try {\n            this._taskState = AssetTaskState.DONE;\n            this._isCompleted = true;\n            if (this.onSuccess) {\n                this.onSuccess(this);\n            }\n            onSuccess();\n        }\n        catch (e) {\n            this._onErrorCallback(onError, \"Task is done, error executing success callback(s)\", e);\n        }\n    };\n    return AbstractAssetTask;\n}());\nexport { AbstractAssetTask };\n/**\n * Class used to share progress information about assets loading\n */\nvar AssetsProgressEvent = /** @class */ (function () {\n    /**\n     * Creates a AssetsProgressEvent\n     * @param remainingCount defines the number of remaining tasks to process\n     * @param totalCount defines the total number of tasks\n     * @param task defines the task that was just processed\n     */\n    function AssetsProgressEvent(remainingCount, totalCount, task) {\n        this.remainingCount = remainingCount;\n        this.totalCount = totalCount;\n        this.task = task;\n    }\n    return AssetsProgressEvent;\n}());\nexport { AssetsProgressEvent };\n/**\n * Define a task used by AssetsManager to load assets into a container\n */\nvar ContainerAssetTask = /** @class */ (function (_super) {\n    __extends(ContainerAssetTask, _super);\n    /**\n     * Creates a new ContainerAssetTask\n     * @param name defines the name of the task\n     * @param meshesNames defines the list of mesh's names you want to load\n     * @param rootUrl defines the root url to use as a base to load your meshes and associated resources\n     * @param sceneFilename defines the filename or File of the scene to load from\n     */\n    function ContainerAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the list of mesh's names you want to load\n     */\n    meshesNames, \n    /**\n     * Defines the root url to use as a base to load your meshes and associated resources\n     */\n    rootUrl, \n    /**\n     * Defines the filename or File of the scene to load from\n     */\n    sceneFilename) {\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.meshesNames = meshesNames;\n        _this.rootUrl = rootUrl;\n        _this.sceneFilename = sceneFilename;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    ContainerAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var _this = this;\n        SceneLoader.LoadAssetContainer(this.rootUrl, this.sceneFilename, scene, function (container) {\n            _this.loadedContainer = container;\n            _this.loadedMeshes = container.meshes;\n            _this.loadedParticleSystems = container.particleSystems;\n            _this.loadedSkeletons = container.skeletons;\n            _this.loadedAnimationGroups = container.animationGroups;\n            onSuccess();\n        }, null, function (scene, message, exception) {\n            onError(message, exception);\n        });\n    };\n    return ContainerAssetTask;\n}(AbstractAssetTask));\nexport { ContainerAssetTask };\n/**\n * Define a task used by AssetsManager to load meshes\n */\nvar MeshAssetTask = /** @class */ (function (_super) {\n    __extends(MeshAssetTask, _super);\n    /**\n     * Creates a new MeshAssetTask\n     * @param name defines the name of the task\n     * @param meshesNames defines the list of mesh's names you want to load\n     * @param rootUrl defines the root url to use as a base to load your meshes and associated resources\n     * @param sceneFilename defines the filename or File of the scene to load from\n     */\n    function MeshAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the list of mesh's names you want to load\n     */\n    meshesNames, \n    /**\n     * Defines the root url to use as a base to load your meshes and associated resources\n     */\n    rootUrl, \n    /**\n     * Defines the filename or File of the scene to load from\n     */\n    sceneFilename) {\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.meshesNames = meshesNames;\n        _this.rootUrl = rootUrl;\n        _this.sceneFilename = sceneFilename;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    MeshAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var _this = this;\n        SceneLoader.ImportMesh(this.meshesNames, this.rootUrl, this.sceneFilename, scene, function (meshes, particleSystems, skeletons, animationGroups) {\n            _this.loadedMeshes = meshes;\n            _this.loadedParticleSystems = particleSystems;\n            _this.loadedSkeletons = skeletons;\n            _this.loadedAnimationGroups = animationGroups;\n            onSuccess();\n        }, null, function (scene, message, exception) {\n            onError(message, exception);\n        });\n    };\n    return MeshAssetTask;\n}(AbstractAssetTask));\nexport { MeshAssetTask };\n/**\n * Define a task used by AssetsManager to load text content\n */\nvar TextFileAssetTask = /** @class */ (function (_super) {\n    __extends(TextFileAssetTask, _super);\n    /**\n     * Creates a new TextFileAssetTask object\n     * @param name defines the name of the task\n     * @param url defines the location of the file to load\n     */\n    function TextFileAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the file to load\n     */\n    url) {\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    TextFileAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var _this = this;\n        scene._loadFile(this.url, function (data) {\n            _this.text = data;\n            onSuccess();\n        }, undefined, false, false, function (request, exception) {\n            if (request) {\n                onError(request.status + \" \" + request.statusText, exception);\n            }\n        });\n    };\n    return TextFileAssetTask;\n}(AbstractAssetTask));\nexport { TextFileAssetTask };\n/**\n * Define a task used by AssetsManager to load binary data\n */\nvar BinaryFileAssetTask = /** @class */ (function (_super) {\n    __extends(BinaryFileAssetTask, _super);\n    /**\n     * Creates a new BinaryFileAssetTask object\n     * @param name defines the name of the new task\n     * @param url defines the location of the file to load\n     */\n    function BinaryFileAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the file to load\n     */\n    url) {\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    BinaryFileAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var _this = this;\n        scene._loadFile(this.url, function (data) {\n            _this.data = data;\n            onSuccess();\n        }, undefined, true, true, function (request, exception) {\n            if (request) {\n                onError(request.status + \" \" + request.statusText, exception);\n            }\n        });\n    };\n    return BinaryFileAssetTask;\n}(AbstractAssetTask));\nexport { BinaryFileAssetTask };\n/**\n * Define a task used by AssetsManager to load images\n */\nvar ImageAssetTask = /** @class */ (function (_super) {\n    __extends(ImageAssetTask, _super);\n    /**\n     * Creates a new ImageAssetTask\n     * @param name defines the name of the task\n     * @param url defines the location of the image to load\n     */\n    function ImageAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the image to load\n     */\n    url) {\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    ImageAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var _this = this;\n        var img = new Image();\n        Tools.SetCorsBehavior(this.url, img);\n        img.onload = function () {\n            _this.image = img;\n            onSuccess();\n        };\n        img.onerror = function (err) {\n            onError(\"Error loading image\", err);\n        };\n        img.src = this.url;\n    };\n    return ImageAssetTask;\n}(AbstractAssetTask));\nexport { ImageAssetTask };\n/**\n * Define a task used by AssetsManager to load 2D textures\n */\nvar TextureAssetTask = /** @class */ (function (_super) {\n    __extends(TextureAssetTask, _super);\n    /**\n     * Creates a new TextureAssetTask object\n     * @param name defines the name of the task\n     * @param url defines the location of the file to load\n     * @param noMipmap defines if mipmap should not be generated (default is false)\n     * @param invertY defines if texture must be inverted on Y axis (default is true)\n     * @param samplingMode defines the sampling mode to use (default is Texture.TRILINEAR_SAMPLINGMODE)\n     */\n    function TextureAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the file to load\n     */\n    url, \n    /**\n     * Defines if mipmap should not be generated (default is false)\n     */\n    noMipmap, \n    /**\n     * Defines if texture must be inverted on Y axis (default is true)\n     */\n    invertY, \n    /**\n     * Defines the sampling mode to use (default is Texture.TRILINEAR_SAMPLINGMODE)\n     */\n    samplingMode) {\n        if (invertY === void 0) { invertY = true; }\n        if (samplingMode === void 0) { samplingMode = Texture.TRILINEAR_SAMPLINGMODE; }\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        _this.noMipmap = noMipmap;\n        _this.invertY = invertY;\n        _this.samplingMode = samplingMode;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    TextureAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var onload = function () {\n            onSuccess();\n        };\n        var onerror = function (message, exception) {\n            onError(message, exception);\n        };\n        this.texture = new Texture(this.url, scene, this.noMipmap, this.invertY, this.samplingMode, onload, onerror);\n    };\n    return TextureAssetTask;\n}(AbstractAssetTask));\nexport { TextureAssetTask };\n/**\n * Define a task used by AssetsManager to load cube textures\n */\nvar CubeTextureAssetTask = /** @class */ (function (_super) {\n    __extends(CubeTextureAssetTask, _super);\n    /**\n     * Creates a new CubeTextureAssetTask\n     * @param name defines the name of the task\n     * @param url defines the location of the files to load (You have to specify the folder where the files are + filename with no extension)\n     * @param extensions defines the extensions to use to load files ([\"_px\", \"_py\", \"_pz\", \"_nx\", \"_ny\", \"_nz\"] by default)\n     * @param noMipmap defines if mipmaps should not be generated (default is false)\n     * @param files defines the explicit list of files (undefined by default)\n     * @param prefiltered\n     */\n    function CubeTextureAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the files to load (You have to specify the folder where the files are + filename with no extension)\n     */\n    url, \n    /**\n     * Defines the extensions to use to load files ([\"_px\", \"_py\", \"_pz\", \"_nx\", \"_ny\", \"_nz\"] by default)\n     */\n    extensions, \n    /**\n     * Defines if mipmaps should not be generated (default is false)\n     */\n    noMipmap, \n    /**\n     * Defines the explicit list of files (undefined by default)\n     */\n    files, \n    /**\n     * Defines the prefiltered texture option (default is false)\n     */\n    prefiltered) {\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        _this.extensions = extensions;\n        _this.noMipmap = noMipmap;\n        _this.files = files;\n        _this.prefiltered = prefiltered;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    CubeTextureAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var onload = function () {\n            onSuccess();\n        };\n        var onerror = function (message, exception) {\n            onError(message, exception);\n        };\n        this.texture = new CubeTexture(this.url, scene, this.extensions, this.noMipmap, this.files, onload, onerror, undefined, this.prefiltered);\n    };\n    return CubeTextureAssetTask;\n}(AbstractAssetTask));\nexport { CubeTextureAssetTask };\n/**\n * Define a task used by AssetsManager to load HDR cube textures\n */\nvar HDRCubeTextureAssetTask = /** @class */ (function (_super) {\n    __extends(HDRCubeTextureAssetTask, _super);\n    /**\n     * Creates a new HDRCubeTextureAssetTask object\n     * @param name defines the name of the task\n     * @param url defines the location of the file to load\n     * @param size defines the desired size (the more it increases the longer the generation will be) If the size is omitted this implies you are using a preprocessed cubemap.\n     * @param noMipmap defines if mipmaps should not be generated (default is false)\n     * @param generateHarmonics specifies whether you want to extract the polynomial harmonics during the generation process (default is true)\n     * @param gammaSpace specifies if the texture will be use in gamma or linear space (the PBR material requires those texture in linear space, but the standard material would require them in Gamma space) (default is false)\n     * @param reserved Internal use only\n     */\n    function HDRCubeTextureAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the file to load\n     */\n    url, \n    /**\n     * Defines the desired size (the more it increases the longer the generation will be)\n     */\n    size, \n    /**\n     * Defines if mipmaps should not be generated (default is false)\n     */\n    noMipmap, \n    /**\n     * Specifies whether you want to extract the polynomial harmonics during the generation process (default is true)\n     */\n    generateHarmonics, \n    /**\n     * Specifies if the texture will be use in gamma or linear space (the PBR material requires those texture in linear space, but the standard material would require them in Gamma space) (default is false)\n     */\n    gammaSpace, \n    /**\n     * Internal Use Only\n     */\n    reserved) {\n        if (noMipmap === void 0) { noMipmap = false; }\n        if (generateHarmonics === void 0) { generateHarmonics = true; }\n        if (gammaSpace === void 0) { gammaSpace = false; }\n        if (reserved === void 0) { reserved = false; }\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        _this.size = size;\n        _this.noMipmap = noMipmap;\n        _this.generateHarmonics = generateHarmonics;\n        _this.gammaSpace = gammaSpace;\n        _this.reserved = reserved;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    HDRCubeTextureAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var onload = function () {\n            onSuccess();\n        };\n        var onerror = function (message, exception) {\n            onError(message, exception);\n        };\n        this.texture = new HDRCubeTexture(this.url, scene, this.size, this.noMipmap, this.generateHarmonics, this.gammaSpace, this.reserved, onload, onerror);\n    };\n    return HDRCubeTextureAssetTask;\n}(AbstractAssetTask));\nexport { HDRCubeTextureAssetTask };\n/**\n * Define a task used by AssetsManager to load Equirectangular cube textures\n */\nvar EquiRectangularCubeTextureAssetTask = /** @class */ (function (_super) {\n    __extends(EquiRectangularCubeTextureAssetTask, _super);\n    /**\n     * Creates a new EquiRectangularCubeTextureAssetTask object\n     * @param name defines the name of the task\n     * @param url defines the location of the file to load\n     * @param size defines the desired size (the more it increases the longer the generation will be)\n     * If the size is omitted this implies you are using a preprocessed cubemap.\n     * @param noMipmap defines if mipmaps should not be generated (default is false)\n     * @param gammaSpace specifies if the texture will be used in gamma or linear space\n     * (the PBR material requires those texture in linear space, but the standard material would require them in Gamma space)\n     * (default is true)\n     */\n    function EquiRectangularCubeTextureAssetTask(\n    /**\n     * Defines the name of the task\n     */\n    name, \n    /**\n     * Defines the location of the file to load\n     */\n    url, \n    /**\n     * Defines the desired size (the more it increases the longer the generation will be)\n     */\n    size, \n    /**\n     * Defines if mipmaps should not be generated (default is false)\n     */\n    noMipmap, \n    /**\n     * Specifies if the texture will be use in gamma or linear space (the PBR material requires those texture in linear space,\n     * but the standard material would require them in Gamma space) (default is true)\n     */\n    gammaSpace) {\n        if (noMipmap === void 0) { noMipmap = false; }\n        if (gammaSpace === void 0) { gammaSpace = true; }\n        var _this = _super.call(this, name) || this;\n        _this.name = name;\n        _this.url = url;\n        _this.size = size;\n        _this.noMipmap = noMipmap;\n        _this.gammaSpace = gammaSpace;\n        return _this;\n    }\n    /**\n     * Execute the current task\n     * @param scene defines the scene where you want your assets to be loaded\n     * @param onSuccess is a callback called when the task is successfully executed\n     * @param onError is a callback called if an error occurs\n     */\n    EquiRectangularCubeTextureAssetTask.prototype.runTask = function (scene, onSuccess, onError) {\n        var onload = function () {\n            onSuccess();\n        };\n        var onerror = function (message, exception) {\n            onError(message, exception);\n        };\n        this.texture = new EquiRectangularCubeTexture(this.url, scene, this.size, this.noMipmap, this.gammaSpace, onload, onerror);\n    };\n    return EquiRectangularCubeTextureAssetTask;\n}(AbstractAssetTask));\nexport { EquiRectangularCubeTextureAssetTask };\n/**\n * This class can be used to easily import assets into a scene\n * @see https://doc.babylonjs.com/how_to/how_to_use_assetsmanager\n */\nvar AssetsManager = /** @class */ (function () {\n    /**\n     * Creates a new AssetsManager\n     * @param scene defines the scene to work on\n     */\n    function AssetsManager(scene) {\n        this._isLoading = false;\n        this._tasks = new Array();\n        this._waitingTasksCount = 0;\n        this._totalTasksCount = 0;\n        /**\n         * Observable called when all tasks are processed\n         */\n        this.onTaskSuccessObservable = new Observable();\n        /**\n         * Observable called when a task had an error\n         */\n        this.onTaskErrorObservable = new Observable();\n        /**\n         * Observable called when all tasks were executed\n         */\n        this.onTasksDoneObservable = new Observable();\n        /**\n         * Observable called when a task is done (whatever the result is)\n         */\n        this.onProgressObservable = new Observable();\n        /**\n         * Gets or sets a boolean defining if the AssetsManager should use the default loading screen\n         * @see https://doc.babylonjs.com/how_to/creating_a_custom_loading_screen\n         */\n        this.useDefaultLoadingScreen = true;\n        /**\n         * Gets or sets a boolean defining if the AssetsManager should automatically hide the loading screen\n         * when all assets have been downloaded.\n         * If set to false, you need to manually call in hideLoadingUI() once your scene is ready.\n         */\n        this.autoHideLoadingUI = true;\n        this._scene = scene || EngineStore.LastCreatedScene;\n    }\n    /**\n     * Add a ContainerAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param meshesNames defines the name of meshes to load\n     * @param rootUrl defines the root url to use to locate files\n     * @param sceneFilename defines the filename of the scene file or the File itself\n     * @returns a new ContainerAssetTask object\n     */\n    AssetsManager.prototype.addContainerTask = function (taskName, meshesNames, rootUrl, sceneFilename) {\n        var task = new ContainerAssetTask(taskName, meshesNames, rootUrl, sceneFilename);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Add a MeshAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param meshesNames defines the name of meshes to load\n     * @param rootUrl defines the root url to use to locate files\n     * @param sceneFilename defines the filename of the scene file or the File itself\n     * @returns a new MeshAssetTask object\n     */\n    AssetsManager.prototype.addMeshTask = function (taskName, meshesNames, rootUrl, sceneFilename) {\n        var task = new MeshAssetTask(taskName, meshesNames, rootUrl, sceneFilename);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Add a TextFileAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @returns a new TextFileAssetTask object\n     */\n    AssetsManager.prototype.addTextFileTask = function (taskName, url) {\n        var task = new TextFileAssetTask(taskName, url);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Add a BinaryFileAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @returns a new BinaryFileAssetTask object\n     */\n    AssetsManager.prototype.addBinaryFileTask = function (taskName, url) {\n        var task = new BinaryFileAssetTask(taskName, url);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Add a ImageAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @returns a new ImageAssetTask object\n     */\n    AssetsManager.prototype.addImageTask = function (taskName, url) {\n        var task = new ImageAssetTask(taskName, url);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Add a TextureAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @param noMipmap defines if the texture must not receive mipmaps (false by default)\n     * @param invertY defines if you want to invert Y axis of the loaded texture (false by default)\n     * @param samplingMode defines the sampling mode to use (Texture.TRILINEAR_SAMPLINGMODE by default)\n     * @returns a new TextureAssetTask object\n     */\n    AssetsManager.prototype.addTextureTask = function (taskName, url, noMipmap, invertY, samplingMode) {\n        if (samplingMode === void 0) { samplingMode = Texture.TRILINEAR_SAMPLINGMODE; }\n        var task = new TextureAssetTask(taskName, url, noMipmap, invertY, samplingMode);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Add a CubeTextureAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @param extensions defines the extension to use to load the cube map (can be null)\n     * @param noMipmap defines if the texture must not receive mipmaps (false by default)\n     * @param files defines the list of files to load (can be null)\n     * @param prefiltered defines the prefiltered texture option (default is false)\n     * @returns a new CubeTextureAssetTask object\n     */\n    AssetsManager.prototype.addCubeTextureTask = function (taskName, url, extensions, noMipmap, files, prefiltered) {\n        var task = new CubeTextureAssetTask(taskName, url, extensions, noMipmap, files, prefiltered);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     *\n     * Add a HDRCubeTextureAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @param size defines the size you want for the cubemap (can be null)\n     * @param noMipmap defines if the texture must not receive mipmaps (false by default)\n     * @param generateHarmonics defines if you want to automatically generate (true by default)\n     * @param gammaSpace specifies if the texture will be use in gamma or linear space (the PBR material requires those texture in linear space, but the standard material would require them in Gamma space) (default is false)\n     * @param reserved Internal use only\n     * @returns a new HDRCubeTextureAssetTask object\n     */\n    AssetsManager.prototype.addHDRCubeTextureTask = function (taskName, url, size, noMipmap, generateHarmonics, gammaSpace, reserved) {\n        if (noMipmap === void 0) { noMipmap = false; }\n        if (generateHarmonics === void 0) { generateHarmonics = true; }\n        if (gammaSpace === void 0) { gammaSpace = false; }\n        if (reserved === void 0) { reserved = false; }\n        var task = new HDRCubeTextureAssetTask(taskName, url, size, noMipmap, generateHarmonics, gammaSpace, reserved);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     *\n     * Add a EquiRectangularCubeTextureAssetTask to the list of active tasks\n     * @param taskName defines the name of the new task\n     * @param url defines the url of the file to load\n     * @param size defines the size you want for the cubemap (can be null)\n     * @param noMipmap defines if the texture must not receive mipmaps (false by default)\n     * @param gammaSpace Specifies if the texture will be used in gamma or linear space\n     * (the PBR material requires those textures in linear space, but the standard material would require them in Gamma space)\n     * @returns a new EquiRectangularCubeTextureAssetTask object\n     */\n    AssetsManager.prototype.addEquiRectangularCubeTextureAssetTask = function (taskName, url, size, noMipmap, gammaSpace) {\n        if (noMipmap === void 0) { noMipmap = false; }\n        if (gammaSpace === void 0) { gammaSpace = true; }\n        var task = new EquiRectangularCubeTextureAssetTask(taskName, url, size, noMipmap, gammaSpace);\n        this._tasks.push(task);\n        return task;\n    };\n    /**\n     * Remove a task from the assets manager.\n     * @param task the task to remove\n     */\n    AssetsManager.prototype.removeTask = function (task) {\n        var index = this._tasks.indexOf(task);\n        if (index > -1) {\n            this._tasks.splice(index, 1);\n        }\n    };\n    AssetsManager.prototype._decreaseWaitingTasksCount = function (task) {\n        this._waitingTasksCount--;\n        try {\n            if (this.onProgress) {\n                this.onProgress(this._waitingTasksCount, this._totalTasksCount, task);\n            }\n            this.onProgressObservable.notifyObservers(new AssetsProgressEvent(this._waitingTasksCount, this._totalTasksCount, task));\n        }\n        catch (e) {\n            Logger.Error(\"Error running progress callbacks.\");\n            console.log(e);\n        }\n        if (this._waitingTasksCount === 0) {\n            try {\n                var currentTasks = this._tasks.slice();\n                if (this.onFinish) {\n                    // Calling onFinish with immutable array of tasks\n                    this.onFinish(currentTasks);\n                }\n                // Let's remove successful tasks\n                for (var _i = 0, currentTasks_1 = currentTasks; _i < currentTasks_1.length; _i++) {\n                    var task_1 = currentTasks_1[_i];\n                    if (task_1.taskState === AssetTaskState.DONE) {\n                        var index = this._tasks.indexOf(task_1);\n                        if (index > -1) {\n                            this._tasks.splice(index, 1);\n                        }\n                    }\n                }\n                this.onTasksDoneObservable.notifyObservers(this._tasks);\n            }\n            catch (e) {\n                Logger.Error(\"Error running tasks-done callbacks.\");\n                console.log(e);\n            }\n            this._isLoading = false;\n            if (this.autoHideLoadingUI) {\n                this._scene.getEngine().hideLoadingUI();\n            }\n        }\n    };\n    AssetsManager.prototype._runTask = function (task) {\n        var _this = this;\n        var done = function () {\n            try {\n                if (_this.onTaskSuccess) {\n                    _this.onTaskSuccess(task);\n                }\n                _this.onTaskSuccessObservable.notifyObservers(task);\n                _this._decreaseWaitingTasksCount(task);\n            }\n            catch (e) {\n                error(\"Error executing task success callbacks\", e);\n            }\n        };\n        var error = function (message, exception) {\n            task._setErrorObject(message, exception);\n            if (_this.onTaskError) {\n                _this.onTaskError(task);\n            }\n            else if (!task.onError) {\n                Logger.Error(_this._formatTaskErrorMessage(task));\n            }\n            _this.onTaskErrorObservable.notifyObservers(task);\n            _this._decreaseWaitingTasksCount(task);\n        };\n        task.run(this._scene, done, error);\n    };\n    AssetsManager.prototype._formatTaskErrorMessage = function (task) {\n        var errorMessage = \"Unable to complete task \" + task.name;\n        if (task.errorObject.message) {\n            errorMessage += \": \".concat(task.errorObject.message);\n        }\n        if (task.errorObject.exception) {\n            errorMessage += \": \".concat(task.errorObject.exception);\n        }\n        return errorMessage;\n    };\n    /**\n     * Reset the AssetsManager and remove all tasks\n     * @return the current instance of the AssetsManager\n     */\n    AssetsManager.prototype.reset = function () {\n        this._isLoading = false;\n        this._tasks = new Array();\n        return this;\n    };\n    /**\n     * Start the loading process\n     * @return the current instance of the AssetsManager\n     */\n    AssetsManager.prototype.load = function () {\n        if (this._isLoading) {\n            return this;\n        }\n        this._isLoading = true;\n        this._waitingTasksCount = this._tasks.length;\n        this._totalTasksCount = this._tasks.length;\n        if (this._waitingTasksCount === 0) {\n            this._isLoading = false;\n            if (this.onFinish) {\n                this.onFinish(this._tasks);\n            }\n            this.onTasksDoneObservable.notifyObservers(this._tasks);\n            return this;\n        }\n        if (this.useDefaultLoadingScreen) {\n            this._scene.getEngine().displayLoadingUI();\n        }\n        for (var index = 0; index < this._tasks.length; index++) {\n            var task = this._tasks[index];\n            if (task.taskState === AssetTaskState.INIT) {\n                this._runTask(task);\n            }\n        }\n        return this;\n    };\n    /**\n     * Start the loading process as an async operation\n     * @return a promise returning the list of failed tasks\n     */\n    AssetsManager.prototype.loadAsync = function () {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (_this._isLoading) {\n                resolve();\n                return;\n            }\n            _this.onTasksDoneObservable.addOnce(function (remainingTasks) {\n                if (remainingTasks && remainingTasks.length) {\n                    reject(remainingTasks);\n                }\n                else {\n                    resolve();\n                }\n            });\n            _this.load();\n        });\n    };\n    return AssetsManager;\n}());\nexport { AssetsManager };\n//# sourceMappingURL=assetsManager.js.map","import { Vector3 } from \"../Maths/math.vector.js\";\n/**\n * Class used to explode meshes (ie. to have a center and move them away from that center to better see the overall organization)\n */\nvar MeshExploder = /** @class */ (function () {\n    /**\n     * Explodes meshes from a center mesh.\n     * @param meshes The meshes to explode.\n     * @param centerMesh The mesh to be center of explosion.\n     */\n    function MeshExploder(meshes, centerMesh) {\n        this._meshesOrigins = [];\n        this._toCenterVectors = [];\n        this._scaledDirection = Vector3.Zero();\n        this._newPosition = Vector3.Zero();\n        this._centerPosition = Vector3.Zero();\n        this._meshes = meshes.slice();\n        if (centerMesh) {\n            this._centerMesh = centerMesh;\n        }\n        else {\n            this._setCenterMesh();\n        }\n        var centerMeshIndex = this._meshes.indexOf(this._centerMesh);\n        if (centerMeshIndex >= 0) {\n            this._meshes.splice(centerMeshIndex, 1);\n        }\n        this._centerPosition = this._centerMesh.getAbsolutePosition().clone();\n        for (var index = 0; index < this._meshes.length; index++) {\n            if (this._meshes[index]) {\n                var mesh = this._meshes[index];\n                this._meshesOrigins[index] = mesh.getAbsolutePosition().clone();\n                this._toCenterVectors[index] = Vector3.Zero();\n                if (mesh.hasBoundingInfo && this._centerMesh.hasBoundingInfo) {\n                    mesh.getBoundingInfo().boundingBox.centerWorld.subtractToRef(this._centerMesh.getBoundingInfo().boundingBox.centerWorld, this._toCenterVectors[index]);\n                }\n            }\n        }\n    }\n    MeshExploder.prototype._setCenterMesh = function () {\n        var averageCenter = Vector3.Zero();\n        var totalCenters = Vector3.Zero();\n        var shortestToCenter = Number.MAX_VALUE;\n        for (var index = 0; index < this._meshes.length; index++) {\n            if (this._meshes[index]) {\n                var mesh = this._meshes[index];\n                var boundingInfo = mesh.getBoundingInfo();\n                if (boundingInfo) {\n                    totalCenters.addInPlace(boundingInfo.boundingBox.centerWorld);\n                }\n            }\n        }\n        averageCenter = totalCenters.scale(1 / this._meshes.length);\n        for (var index = 0; index < this._meshes.length; index++) {\n            if (this._meshes[index]) {\n                var mesh = this._meshes[index];\n                var boundingInfo = mesh.getBoundingInfo();\n                if (boundingInfo) {\n                    var distanceToCenter = boundingInfo.boundingBox.centerWorld.subtract(averageCenter).lengthSquared();\n                    if (distanceToCenter < shortestToCenter) {\n                        this._centerMesh = mesh;\n                        shortestToCenter = distanceToCenter;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get class name\n     * @returns \"MeshExploder\"\n     */\n    MeshExploder.prototype.getClassName = function () {\n        return \"MeshExploder\";\n    };\n    /**\n     * \"Exploded meshes\"\n     * @returns Array of meshes with the centerMesh at index 0.\n     */\n    MeshExploder.prototype.getMeshes = function () {\n        var meshArray = this._meshes.slice();\n        meshArray.unshift(this._centerMesh);\n        return meshArray;\n    };\n    /**\n     * Explodes meshes giving a specific direction\n     * @param direction Number to multiply distance of each mesh's origin from center. Use a negative number to implode, or zero to reset.\n     */\n    MeshExploder.prototype.explode = function (direction) {\n        if (direction === void 0) { direction = 1.0; }\n        for (var index = 0; index < this._meshes.length; index++) {\n            if (this._meshes[index] && this._meshesOrigins[index] && this._toCenterVectors[index]) {\n                this._toCenterVectors[index].scaleToRef(direction, this._scaledDirection);\n                this._meshesOrigins[index].addToRef(this._scaledDirection, this._newPosition);\n                this._meshes[index].setAbsolutePosition(this._newPosition);\n            }\n        }\n        this._centerMesh.setAbsolutePosition(this._centerPosition);\n    };\n    return MeshExploder;\n}());\nexport { MeshExploder };\n//# sourceMappingURL=meshExploder.js.map","import { SceneLoader } from \"../Loading/sceneLoader.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { FilesInputStore } from \"./filesInputStore.js\";\n/**\n * Class used to help managing file picking and drag-n-drop\n */\nvar FilesInput = /** @class */ (function () {\n    /**\n     * Creates a new FilesInput\n     * @param engine defines the rendering engine\n     * @param scene defines the hosting scene\n     * @param sceneLoadedCallback callback called when scene is loaded\n     * @param progressCallback callback called to track progress\n     * @param additionalRenderLoopLogicCallback callback called to add user logic to the rendering loop\n     * @param textureLoadingCallback callback called when a texture is loading\n     * @param startingProcessingFilesCallback callback called when the system is about to process all files\n     * @param onReloadCallback callback called when a reload is requested\n     * @param errorCallback callback call if an error occurs\n     */\n    function FilesInput(engine, scene, sceneLoadedCallback, progressCallback, additionalRenderLoopLogicCallback, textureLoadingCallback, startingProcessingFilesCallback, onReloadCallback, errorCallback) {\n        var _this = this;\n        /**\n         * Callback called when a file is processed\n         */\n        this.onProcessFileCallback = function () {\n            return true;\n        };\n        /**\n         * Function used when loading the scene file\n         * @param sceneFile\n         * @param onProgress\n         */\n        this.loadAsync = function (sceneFile, onProgress) {\n            return SceneLoader.LoadAsync(\"file:\", sceneFile, _this._engine, onProgress);\n        };\n        this._engine = engine;\n        this._currentScene = scene;\n        this._sceneLoadedCallback = sceneLoadedCallback;\n        this._progressCallback = progressCallback;\n        this._additionalRenderLoopLogicCallback = additionalRenderLoopLogicCallback;\n        this._textureLoadingCallback = textureLoadingCallback;\n        this._startingProcessingFilesCallback = startingProcessingFilesCallback;\n        this._onReloadCallback = onReloadCallback;\n        this._errorCallback = errorCallback;\n    }\n    Object.defineProperty(FilesInput, \"FilesToLoad\", {\n        /**\n         * List of files ready to be loaded\n         */\n        get: function () {\n            return FilesInputStore.FilesToLoad;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Calls this function to listen to drag'n'drop events on a specific DOM element\n     * @param elementToMonitor defines the DOM element to track\n     */\n    FilesInput.prototype.monitorElementForDragNDrop = function (elementToMonitor) {\n        var _this = this;\n        if (elementToMonitor) {\n            this._elementToMonitor = elementToMonitor;\n            this._dragEnterHandler = function (e) {\n                _this._drag(e);\n            };\n            this._dragOverHandler = function (e) {\n                _this._drag(e);\n            };\n            this._dropHandler = function (e) {\n                _this._drop(e);\n            };\n            this._elementToMonitor.addEventListener(\"dragenter\", this._dragEnterHandler, false);\n            this._elementToMonitor.addEventListener(\"dragover\", this._dragOverHandler, false);\n            this._elementToMonitor.addEventListener(\"drop\", this._dropHandler, false);\n        }\n    };\n    Object.defineProperty(FilesInput.prototype, \"filesToLoad\", {\n        /** Gets the current list of files to load */\n        get: function () {\n            return this._filesToLoad;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Release all associated resources\n     */\n    FilesInput.prototype.dispose = function () {\n        if (!this._elementToMonitor) {\n            return;\n        }\n        this._elementToMonitor.removeEventListener(\"dragenter\", this._dragEnterHandler);\n        this._elementToMonitor.removeEventListener(\"dragover\", this._dragOverHandler);\n        this._elementToMonitor.removeEventListener(\"drop\", this._dropHandler);\n    };\n    FilesInput.prototype._renderFunction = function () {\n        if (this._additionalRenderLoopLogicCallback) {\n            this._additionalRenderLoopLogicCallback();\n        }\n        if (this._currentScene) {\n            if (this._textureLoadingCallback) {\n                var remaining = this._currentScene.getWaitingItemsCount();\n                if (remaining > 0) {\n                    this._textureLoadingCallback(remaining);\n                }\n            }\n            this._currentScene.render();\n        }\n    };\n    FilesInput.prototype._drag = function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n    };\n    FilesInput.prototype._drop = function (eventDrop) {\n        eventDrop.stopPropagation();\n        eventDrop.preventDefault();\n        this.loadFiles(eventDrop);\n    };\n    FilesInput.prototype._traverseFolder = function (folder, files, remaining, callback) {\n        var _this = this;\n        var reader = folder.createReader();\n        var relativePath = folder.fullPath.replace(/^\\//, \"\").replace(/(.+?)\\/?$/, \"$1/\");\n        reader.readEntries(function (entries) {\n            remaining.count += entries.length;\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n                var entry = entries_1[_i];\n                if (entry.isFile) {\n                    entry.file(function (file) {\n                        file.correctName = relativePath + file.name;\n                        files.push(file);\n                        if (--remaining.count === 0) {\n                            callback();\n                        }\n                    });\n                }\n                else if (entry.isDirectory) {\n                    _this._traverseFolder(entry, files, remaining, callback);\n                }\n            }\n            if (--remaining.count === 0) {\n                callback();\n            }\n        });\n    };\n    FilesInput.prototype._processFiles = function (files) {\n        var _this = this;\n        for (var i = 0; i < files.length; i++) {\n            var name_1 = files[i].correctName.toLowerCase();\n            var extension = name_1.split(\".\").pop();\n            if (!this.onProcessFileCallback(files[i], name_1, extension, function (sceneFile) { return (_this._sceneFileToLoad = sceneFile); })) {\n                continue;\n            }\n            if (SceneLoader.IsPluginForExtensionAvailable(\".\" + extension)) {\n                this._sceneFileToLoad = files[i];\n            }\n            FilesInput.FilesToLoad[name_1] = files[i];\n        }\n    };\n    /**\n     * Load files from a drop event\n     * @param event defines the drop event to use as source\n     */\n    FilesInput.prototype.loadFiles = function (event) {\n        var _this = this;\n        // Handling data transfer via drag'n'drop\n        if (event && event.dataTransfer && event.dataTransfer.files) {\n            this._filesToLoad = event.dataTransfer.files;\n        }\n        // Handling files from input files\n        if (event && event.target && event.target.files) {\n            this._filesToLoad = event.target.files;\n        }\n        if (!this._filesToLoad || this._filesToLoad.length === 0) {\n            return;\n        }\n        if (this._startingProcessingFilesCallback) {\n            this._startingProcessingFilesCallback(this._filesToLoad);\n        }\n        if (this._filesToLoad && this._filesToLoad.length > 0) {\n            var files_1 = new Array();\n            var folders = [];\n            var items = event.dataTransfer ? event.dataTransfer.items : null;\n            for (var i = 0; i < this._filesToLoad.length; i++) {\n                var fileToLoad = this._filesToLoad[i];\n                var name_2 = fileToLoad.name.toLowerCase();\n                var entry = void 0;\n                fileToLoad.correctName = name_2;\n                if (items) {\n                    var item = items[i];\n                    if (item.getAsEntry) {\n                        entry = item.getAsEntry();\n                    }\n                    else if (item.webkitGetAsEntry) {\n                        entry = item.webkitGetAsEntry();\n                    }\n                }\n                if (!entry) {\n                    files_1.push(fileToLoad);\n                }\n                else {\n                    if (entry.isDirectory) {\n                        folders.push(entry);\n                    }\n                    else {\n                        files_1.push(fileToLoad);\n                    }\n                }\n            }\n            if (folders.length === 0) {\n                this._processFiles(files_1);\n                this._processReload();\n            }\n            else {\n                var remaining_1 = { count: folders.length };\n                for (var _i = 0, folders_1 = folders; _i < folders_1.length; _i++) {\n                    var folder = folders_1[_i];\n                    this._traverseFolder(folder, files_1, remaining_1, function () {\n                        _this._processFiles(files_1);\n                        if (remaining_1.count === 0) {\n                            _this._processReload();\n                        }\n                    });\n                }\n            }\n        }\n    };\n    FilesInput.prototype._processReload = function () {\n        if (this._onReloadCallback) {\n            this._onReloadCallback(this._sceneFileToLoad);\n        }\n        else {\n            this.reload();\n        }\n    };\n    /**\n     * Reload the current scene from the loaded files\n     */\n    FilesInput.prototype.reload = function () {\n        var _this = this;\n        // If a scene file has been provided\n        if (this._sceneFileToLoad) {\n            if (this._currentScene) {\n                if (Logger.errorsCount > 0) {\n                    Logger.ClearLogCache();\n                }\n                this._engine.stopRenderLoop();\n            }\n            SceneLoader.ShowLoadingScreen = false;\n            this._engine.displayLoadingUI();\n            this.loadAsync(this._sceneFileToLoad, this._progressCallback)\n                .then(function (scene) {\n                if (_this._currentScene) {\n                    _this._currentScene.dispose();\n                }\n                _this._currentScene = scene;\n                if (_this._sceneLoadedCallback) {\n                    _this._sceneLoadedCallback(_this._sceneFileToLoad, _this._currentScene);\n                }\n                // Wait for textures and shaders to be ready\n                _this._currentScene.executeWhenReady(function () {\n                    _this._engine.hideLoadingUI();\n                    _this._engine.runRenderLoop(function () {\n                        _this._renderFunction();\n                    });\n                });\n            })\n                .catch(function (error) {\n                _this._engine.hideLoadingUI();\n                if (_this._errorCallback) {\n                    _this._errorCallback(_this._sceneFileToLoad, _this._currentScene, error.message);\n                }\n            });\n        }\n        else {\n            Logger.Error(\"Please provide a valid .babylon file.\");\n        }\n    };\n    return FilesInput;\n}());\nexport { FilesInput };\n//# sourceMappingURL=filesInput.js.map","import { __extends } from \"tslib\";\nimport { EngineStore } from \"../Engines/engineStore.js\";\nimport { Mesh } from \"../Meshes/mesh.js\";\nimport { Observable } from \"./observable.js\";\n/**\n * Defines the root class used to create scene optimization to use with SceneOptimizer\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar SceneOptimization = /** @class */ (function () {\n    /**\n     * Creates the SceneOptimization object\n     * @param priority defines the priority of this optimization (0 by default which means first in the list)\n     */\n    function SceneOptimization(\n    /**\n     * Defines the priority of this optimization (0 by default which means first in the list)\n     */\n    priority) {\n        if (priority === void 0) { priority = 0; }\n        this.priority = priority;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @returns description string\n     */\n    SceneOptimization.prototype.getDescription = function () {\n        return \"\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    SceneOptimization.prototype.apply = function (scene, optimizer) {\n        return true;\n    };\n    return SceneOptimization;\n}());\nexport { SceneOptimization };\n/**\n * Defines an optimization used to reduce the size of render target textures\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar TextureOptimization = /** @class */ (function (_super) {\n    __extends(TextureOptimization, _super);\n    /**\n     * Creates the TextureOptimization object\n     * @param priority defines the priority of this optimization (0 by default which means first in the list)\n     * @param maximumSize defines the maximum sized allowed for textures (1024 is the default value). If a texture is bigger, it will be scaled down using a factor defined by the step parameter\n     * @param step defines the factor (0.5 by default) used to scale down textures bigger than maximum sized allowed.\n     */\n    function TextureOptimization(\n    /**\n     * Defines the priority of this optimization (0 by default which means first in the list)\n     */\n    priority, \n    /**\n     * Defines the maximum sized allowed for textures (1024 is the default value). If a texture is bigger, it will be scaled down using a factor defined by the step parameter\n     */\n    maximumSize, \n    /**\n     * Defines the factor (0.5 by default) used to scale down textures bigger than maximum sized allowed.\n     */\n    step) {\n        if (priority === void 0) { priority = 0; }\n        if (maximumSize === void 0) { maximumSize = 1024; }\n        if (step === void 0) { step = 0.5; }\n        var _this = _super.call(this, priority) || this;\n        _this.priority = priority;\n        _this.maximumSize = maximumSize;\n        _this.step = step;\n        return _this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @returns description string\n     */\n    TextureOptimization.prototype.getDescription = function () {\n        return \"Reducing render target texture size to \" + this.maximumSize;\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    TextureOptimization.prototype.apply = function (scene, optimizer) {\n        var allDone = true;\n        for (var index = 0; index < scene.textures.length; index++) {\n            var texture = scene.textures[index];\n            if (!texture.canRescale || texture.getContext) {\n                continue;\n            }\n            var currentSize = texture.getSize();\n            var maxDimension = Math.max(currentSize.width, currentSize.height);\n            if (maxDimension > this.maximumSize) {\n                texture.scale(this.step);\n                allDone = false;\n            }\n        }\n        return allDone;\n    };\n    return TextureOptimization;\n}(SceneOptimization));\nexport { TextureOptimization };\n/**\n * Defines an optimization used to increase or decrease the rendering resolution\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar HardwareScalingOptimization = /** @class */ (function (_super) {\n    __extends(HardwareScalingOptimization, _super);\n    /**\n     * Creates the HardwareScalingOptimization object\n     * @param priority defines the priority of this optimization (0 by default which means first in the list)\n     * @param maximumScale defines the maximum scale to use (2 by default)\n     * @param step defines the step to use between two passes (0.5 by default)\n     */\n    function HardwareScalingOptimization(\n    /**\n     * Defines the priority of this optimization (0 by default which means first in the list)\n     */\n    priority, \n    /**\n     * Defines the maximum scale to use (2 by default)\n     */\n    maximumScale, \n    /**\n     * Defines the step to use between two passes (0.5 by default)\n     */\n    step) {\n        if (priority === void 0) { priority = 0; }\n        if (maximumScale === void 0) { maximumScale = 2; }\n        if (step === void 0) { step = 0.25; }\n        var _this = _super.call(this, priority) || this;\n        _this.priority = priority;\n        _this.maximumScale = maximumScale;\n        _this.step = step;\n        _this._currentScale = -1;\n        _this._directionOffset = 1;\n        return _this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    HardwareScalingOptimization.prototype.getDescription = function () {\n        return \"Setting hardware scaling level to \" + this._currentScale;\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    HardwareScalingOptimization.prototype.apply = function (scene, optimizer) {\n        if (this._currentScale === -1) {\n            this._currentScale = scene.getEngine().getHardwareScalingLevel();\n            if (this._currentScale > this.maximumScale) {\n                this._directionOffset = -1;\n            }\n        }\n        this._currentScale += this._directionOffset * this.step;\n        scene.getEngine().setHardwareScalingLevel(this._currentScale);\n        return this._directionOffset === 1 ? this._currentScale >= this.maximumScale : this._currentScale <= this.maximumScale;\n    };\n    return HardwareScalingOptimization;\n}(SceneOptimization));\nexport { HardwareScalingOptimization };\n/**\n * Defines an optimization used to remove shadows\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar ShadowsOptimization = /** @class */ (function (_super) {\n    __extends(ShadowsOptimization, _super);\n    function ShadowsOptimization() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    ShadowsOptimization.prototype.getDescription = function () {\n        return \"Turning shadows on/off\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    ShadowsOptimization.prototype.apply = function (scene, optimizer) {\n        scene.shadowsEnabled = optimizer.isInImprovementMode;\n        return true;\n    };\n    return ShadowsOptimization;\n}(SceneOptimization));\nexport { ShadowsOptimization };\n/**\n * Defines an optimization used to turn post-processes off\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar PostProcessesOptimization = /** @class */ (function (_super) {\n    __extends(PostProcessesOptimization, _super);\n    function PostProcessesOptimization() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    PostProcessesOptimization.prototype.getDescription = function () {\n        return \"Turning post-processes on/off\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    PostProcessesOptimization.prototype.apply = function (scene, optimizer) {\n        scene.postProcessesEnabled = optimizer.isInImprovementMode;\n        return true;\n    };\n    return PostProcessesOptimization;\n}(SceneOptimization));\nexport { PostProcessesOptimization };\n/**\n * Defines an optimization used to turn lens flares off\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar LensFlaresOptimization = /** @class */ (function (_super) {\n    __extends(LensFlaresOptimization, _super);\n    function LensFlaresOptimization() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    LensFlaresOptimization.prototype.getDescription = function () {\n        return \"Turning lens flares on/off\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    LensFlaresOptimization.prototype.apply = function (scene, optimizer) {\n        scene.lensFlaresEnabled = optimizer.isInImprovementMode;\n        return true;\n    };\n    return LensFlaresOptimization;\n}(SceneOptimization));\nexport { LensFlaresOptimization };\n/**\n * Defines an optimization based on user defined callback.\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar CustomOptimization = /** @class */ (function (_super) {\n    __extends(CustomOptimization, _super);\n    function CustomOptimization() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @returns description string\n     */\n    CustomOptimization.prototype.getDescription = function () {\n        if (this.onGetDescription) {\n            return this.onGetDescription();\n        }\n        return \"Running user defined callback\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    CustomOptimization.prototype.apply = function (scene, optimizer) {\n        if (this.onApply) {\n            return this.onApply(scene, optimizer);\n        }\n        return true;\n    };\n    return CustomOptimization;\n}(SceneOptimization));\nexport { CustomOptimization };\n/**\n * Defines an optimization used to turn particles off\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar ParticlesOptimization = /** @class */ (function (_super) {\n    __extends(ParticlesOptimization, _super);\n    function ParticlesOptimization() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    ParticlesOptimization.prototype.getDescription = function () {\n        return \"Turning particles on/off\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    ParticlesOptimization.prototype.apply = function (scene, optimizer) {\n        scene.particlesEnabled = optimizer.isInImprovementMode;\n        return true;\n    };\n    return ParticlesOptimization;\n}(SceneOptimization));\nexport { ParticlesOptimization };\n/**\n * Defines an optimization used to turn render targets off\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar RenderTargetsOptimization = /** @class */ (function (_super) {\n    __extends(RenderTargetsOptimization, _super);\n    function RenderTargetsOptimization() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    RenderTargetsOptimization.prototype.getDescription = function () {\n        return \"Turning render targets off\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @returns true if everything that can be done was applied\n     */\n    RenderTargetsOptimization.prototype.apply = function (scene, optimizer) {\n        scene.renderTargetsEnabled = optimizer.isInImprovementMode;\n        return true;\n    };\n    return RenderTargetsOptimization;\n}(SceneOptimization));\nexport { RenderTargetsOptimization };\n/**\n * Defines an optimization used to merge meshes with compatible materials\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar MergeMeshesOptimization = /** @class */ (function (_super) {\n    __extends(MergeMeshesOptimization, _super);\n    function MergeMeshesOptimization() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._canBeMerged = function (abstractMesh) {\n            if (!(abstractMesh instanceof Mesh)) {\n                return false;\n            }\n            var mesh = abstractMesh;\n            if (mesh.isDisposed()) {\n                return false;\n            }\n            if (!mesh.isVisible || !mesh.isEnabled()) {\n                return false;\n            }\n            if (mesh.instances.length > 0) {\n                return false;\n            }\n            if (mesh.skeleton || mesh.hasLODLevels) {\n                return false;\n            }\n            return true;\n        };\n        return _this;\n    }\n    Object.defineProperty(MergeMeshesOptimization, \"UpdateSelectionTree\", {\n        /**\n         * Gets or sets a boolean which defines if optimization octree has to be updated\n         */\n        get: function () {\n            return MergeMeshesOptimization._UpdateSelectionTree;\n        },\n        /**\n         * Gets or sets a boolean which defines if optimization octree has to be updated\n         */\n        set: function (value) {\n            MergeMeshesOptimization._UpdateSelectionTree = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets a string describing the action executed by the current optimization\n     * @return description string\n     */\n    MergeMeshesOptimization.prototype.getDescription = function () {\n        return \"Merging similar meshes together\";\n    };\n    /**\n     * This function will be called by the SceneOptimizer when its priority is reached in order to apply the change required by the current optimization\n     * @param scene defines the current scene where to apply this optimization\n     * @param optimizer defines the current optimizer\n     * @param updateSelectionTree defines that the selection octree has to be updated (false by default)\n     * @returns true if everything that can be done was applied\n     */\n    MergeMeshesOptimization.prototype.apply = function (scene, optimizer, updateSelectionTree) {\n        var globalPool = scene.meshes.slice(0);\n        var globalLength = globalPool.length;\n        for (var index = 0; index < globalLength; index++) {\n            var currentPool = new Array();\n            var current = globalPool[index];\n            // Checks\n            if (!this._canBeMerged(current)) {\n                continue;\n            }\n            currentPool.push(current);\n            // Find compatible meshes\n            for (var subIndex = index + 1; subIndex < globalLength; subIndex++) {\n                var otherMesh = globalPool[subIndex];\n                if (!this._canBeMerged(otherMesh)) {\n                    continue;\n                }\n                if (otherMesh.material !== current.material) {\n                    continue;\n                }\n                if (otherMesh.checkCollisions !== current.checkCollisions) {\n                    continue;\n                }\n                currentPool.push(otherMesh);\n                globalLength--;\n                globalPool.splice(subIndex, 1);\n                subIndex--;\n            }\n            if (currentPool.length < 2) {\n                continue;\n            }\n            // Merge meshes\n            Mesh.MergeMeshes(currentPool, undefined, true);\n        }\n        // Call the octree system optimization if it is defined.\n        var sceneAsAny = scene;\n        if (sceneAsAny.createOrUpdateSelectionOctree) {\n            if (updateSelectionTree != undefined) {\n                if (updateSelectionTree) {\n                    sceneAsAny.createOrUpdateSelectionOctree();\n                }\n            }\n            else if (MergeMeshesOptimization.UpdateSelectionTree) {\n                sceneAsAny.createOrUpdateSelectionOctree();\n            }\n        }\n        return true;\n    };\n    MergeMeshesOptimization._UpdateSelectionTree = false;\n    return MergeMeshesOptimization;\n}(SceneOptimization));\nexport { MergeMeshesOptimization };\n/**\n * Defines a list of options used by SceneOptimizer\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar SceneOptimizerOptions = /** @class */ (function () {\n    /**\n     * Creates a new list of options used by SceneOptimizer\n     * @param targetFrameRate defines the target frame rate to reach (60 by default)\n     * @param trackerDuration defines the interval between two checks (2000ms by default)\n     */\n    function SceneOptimizerOptions(\n    /**\n     * Defines the target frame rate to reach (60 by default)\n     */\n    targetFrameRate, \n    /**\n     * Defines the interval between two checks (2000ms by default)\n     */\n    trackerDuration) {\n        if (targetFrameRate === void 0) { targetFrameRate = 60; }\n        if (trackerDuration === void 0) { trackerDuration = 2000; }\n        this.targetFrameRate = targetFrameRate;\n        this.trackerDuration = trackerDuration;\n        /**\n         * Gets the list of optimizations to apply\n         */\n        this.optimizations = new Array();\n    }\n    /**\n     * Add a new optimization\n     * @param optimization defines the SceneOptimization to add to the list of active optimizations\n     * @returns the current SceneOptimizerOptions\n     */\n    SceneOptimizerOptions.prototype.addOptimization = function (optimization) {\n        this.optimizations.push(optimization);\n        return this;\n    };\n    /**\n     * Add a new custom optimization\n     * @param onApply defines the callback called to apply the custom optimization (true if everything that can be done was applied)\n     * @param onGetDescription defines the callback called to get the description attached with the optimization.\n     * @param priority defines the priority of this optimization (0 by default which means first in the list)\n     * @returns the current SceneOptimizerOptions\n     */\n    SceneOptimizerOptions.prototype.addCustomOptimization = function (onApply, onGetDescription, priority) {\n        if (priority === void 0) { priority = 0; }\n        var optimization = new CustomOptimization(priority);\n        optimization.onApply = onApply;\n        optimization.onGetDescription = onGetDescription;\n        this.optimizations.push(optimization);\n        return this;\n    };\n    /**\n     * Creates a list of pre-defined optimizations aimed to reduce the visual impact on the scene\n     * @param targetFrameRate defines the target frame rate (60 by default)\n     * @returns a SceneOptimizerOptions object\n     */\n    SceneOptimizerOptions.LowDegradationAllowed = function (targetFrameRate) {\n        var result = new SceneOptimizerOptions(targetFrameRate);\n        var priority = 0;\n        result.addOptimization(new MergeMeshesOptimization(priority));\n        result.addOptimization(new ShadowsOptimization(priority));\n        result.addOptimization(new LensFlaresOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new PostProcessesOptimization(priority));\n        result.addOptimization(new ParticlesOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new TextureOptimization(priority, 1024));\n        return result;\n    };\n    /**\n     * Creates a list of pre-defined optimizations aimed to have a moderate impact on the scene visual\n     * @param targetFrameRate defines the target frame rate (60 by default)\n     * @returns a SceneOptimizerOptions object\n     */\n    SceneOptimizerOptions.ModerateDegradationAllowed = function (targetFrameRate) {\n        var result = new SceneOptimizerOptions(targetFrameRate);\n        var priority = 0;\n        result.addOptimization(new MergeMeshesOptimization(priority));\n        result.addOptimization(new ShadowsOptimization(priority));\n        result.addOptimization(new LensFlaresOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new PostProcessesOptimization(priority));\n        result.addOptimization(new ParticlesOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new TextureOptimization(priority, 512));\n        // Next priority\n        priority++;\n        result.addOptimization(new RenderTargetsOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new HardwareScalingOptimization(priority, 2));\n        return result;\n    };\n    /**\n     * Creates a list of pre-defined optimizations aimed to have a big impact on the scene visual\n     * @param targetFrameRate defines the target frame rate (60 by default)\n     * @returns a SceneOptimizerOptions object\n     */\n    SceneOptimizerOptions.HighDegradationAllowed = function (targetFrameRate) {\n        var result = new SceneOptimizerOptions(targetFrameRate);\n        var priority = 0;\n        result.addOptimization(new MergeMeshesOptimization(priority));\n        result.addOptimization(new ShadowsOptimization(priority));\n        result.addOptimization(new LensFlaresOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new PostProcessesOptimization(priority));\n        result.addOptimization(new ParticlesOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new TextureOptimization(priority, 256));\n        // Next priority\n        priority++;\n        result.addOptimization(new RenderTargetsOptimization(priority));\n        // Next priority\n        priority++;\n        result.addOptimization(new HardwareScalingOptimization(priority, 4));\n        return result;\n    };\n    return SceneOptimizerOptions;\n}());\nexport { SceneOptimizerOptions };\n/**\n * Class used to run optimizations in order to reach a target frame rate\n * @description More details at https://doc.babylonjs.com/how_to/how_to_use_sceneoptimizer\n */\nvar SceneOptimizer = /** @class */ (function () {\n    /**\n     * Creates a new SceneOptimizer\n     * @param scene defines the scene to work on\n     * @param options defines the options to use with the SceneOptimizer\n     * @param autoGeneratePriorities defines if priorities must be generated and not read from SceneOptimization property (true by default)\n     * @param improvementMode defines if the scene optimizer must run the maximum optimization while staying over a target frame instead of trying to reach the target framerate (false by default)\n     */\n    function SceneOptimizer(scene, options, autoGeneratePriorities, improvementMode) {\n        if (autoGeneratePriorities === void 0) { autoGeneratePriorities = true; }\n        if (improvementMode === void 0) { improvementMode = false; }\n        var _this = this;\n        this._isRunning = false;\n        this._currentPriorityLevel = 0;\n        this._targetFrameRate = 60;\n        this._trackerDuration = 2000;\n        this._currentFrameRate = 0;\n        this._improvementMode = false;\n        /**\n         * Defines an observable called when the optimizer reaches the target frame rate\n         */\n        this.onSuccessObservable = new Observable();\n        /**\n         * Defines an observable called when the optimizer enables an optimization\n         */\n        this.onNewOptimizationAppliedObservable = new Observable();\n        /**\n         * Defines an observable called when the optimizer is not able to reach the target frame rate\n         */\n        this.onFailureObservable = new Observable();\n        if (!options) {\n            this._options = new SceneOptimizerOptions();\n        }\n        else {\n            this._options = options;\n        }\n        if (this._options.targetFrameRate) {\n            this._targetFrameRate = this._options.targetFrameRate;\n        }\n        if (this._options.trackerDuration) {\n            this._trackerDuration = this._options.trackerDuration;\n        }\n        if (autoGeneratePriorities) {\n            var priority = 0;\n            for (var _i = 0, _a = this._options.optimizations; _i < _a.length; _i++) {\n                var optim = _a[_i];\n                optim.priority = priority++;\n            }\n        }\n        this._improvementMode = improvementMode;\n        this._scene = scene || EngineStore.LastCreatedScene;\n        this._sceneDisposeObserver = this._scene.onDisposeObservable.add(function () {\n            _this._sceneDisposeObserver = null;\n            _this.dispose();\n        });\n    }\n    Object.defineProperty(SceneOptimizer.prototype, \"isInImprovementMode\", {\n        /**\n         * Gets or sets a boolean indicating if the optimizer is in improvement mode\n         */\n        get: function () {\n            return this._improvementMode;\n        },\n        set: function (value) {\n            this._improvementMode = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SceneOptimizer.prototype, \"currentPriorityLevel\", {\n        /**\n         * Gets the current priority level (0 at start)\n         */\n        get: function () {\n            return this._currentPriorityLevel;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SceneOptimizer.prototype, \"currentFrameRate\", {\n        /**\n         * Gets the current frame rate checked by the SceneOptimizer\n         */\n        get: function () {\n            return this._currentFrameRate;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SceneOptimizer.prototype, \"targetFrameRate\", {\n        /**\n         * Gets or sets the current target frame rate (60 by default)\n         */\n        get: function () {\n            return this._targetFrameRate;\n        },\n        /**\n         * Gets or sets the current target frame rate (60 by default)\n         */\n        set: function (value) {\n            this._targetFrameRate = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SceneOptimizer.prototype, \"trackerDuration\", {\n        /**\n         * Gets or sets the current interval between two checks (every 2000ms by default)\n         */\n        get: function () {\n            return this._trackerDuration;\n        },\n        /**\n         * Gets or sets the current interval between two checks (every 2000ms by default)\n         */\n        set: function (value) {\n            this._trackerDuration = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SceneOptimizer.prototype, \"optimizations\", {\n        /**\n         * Gets the list of active optimizations\n         */\n        get: function () {\n            return this._options.optimizations;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Stops the current optimizer\n     */\n    SceneOptimizer.prototype.stop = function () {\n        this._isRunning = false;\n    };\n    /**\n     * Reset the optimizer to initial step (current priority level = 0)\n     */\n    SceneOptimizer.prototype.reset = function () {\n        this._currentPriorityLevel = 0;\n    };\n    /**\n     * Start the optimizer. By default it will try to reach a specific framerate\n     * but if the optimizer is set with improvementMode === true then it will run all optimization while frame rate is above the target frame rate\n     */\n    SceneOptimizer.prototype.start = function () {\n        var _this = this;\n        if (this._isRunning) {\n            return;\n        }\n        this._isRunning = true;\n        // Let's wait for the scene to be ready before running our check\n        this._scene.executeWhenReady(function () {\n            setTimeout(function () {\n                _this._checkCurrentState();\n            }, _this._trackerDuration);\n        });\n    };\n    SceneOptimizer.prototype._checkCurrentState = function () {\n        var _this = this;\n        if (!this._isRunning) {\n            return;\n        }\n        var scene = this._scene;\n        var options = this._options;\n        this._currentFrameRate = Math.round(scene.getEngine().getFps());\n        if ((this._improvementMode && this._currentFrameRate <= this._targetFrameRate) || (!this._improvementMode && this._currentFrameRate >= this._targetFrameRate)) {\n            this._isRunning = false;\n            this.onSuccessObservable.notifyObservers(this);\n            return;\n        }\n        // Apply current level of optimizations\n        var allDone = true;\n        var noOptimizationApplied = true;\n        for (var index = 0; index < options.optimizations.length; index++) {\n            var optimization = options.optimizations[index];\n            if (optimization.priority === this._currentPriorityLevel) {\n                noOptimizationApplied = false;\n                allDone = allDone && optimization.apply(scene, this);\n                this.onNewOptimizationAppliedObservable.notifyObservers(optimization);\n            }\n        }\n        // If no optimization was applied, this is a failure :(\n        if (noOptimizationApplied) {\n            this._isRunning = false;\n            this.onFailureObservable.notifyObservers(this);\n            return;\n        }\n        // If all optimizations were done, move to next level\n        if (allDone) {\n            this._currentPriorityLevel++;\n        }\n        // Let's the system running for a specific amount of time before checking FPS\n        scene.executeWhenReady(function () {\n            setTimeout(function () {\n                _this._checkCurrentState();\n            }, _this._trackerDuration);\n        });\n    };\n    /**\n     * Release all resources\n     */\n    SceneOptimizer.prototype.dispose = function () {\n        this.stop();\n        this.onSuccessObservable.clear();\n        this.onFailureObservable.clear();\n        this.onNewOptimizationAppliedObservable.clear();\n        if (this._sceneDisposeObserver) {\n            this._scene.onDisposeObservable.remove(this._sceneDisposeObserver);\n        }\n    };\n    /**\n     * Helper function to create a SceneOptimizer with one single line of code\n     * @param scene defines the scene to work on\n     * @param options defines the options to use with the SceneOptimizer\n     * @param onSuccess defines a callback to call on success\n     * @param onFailure defines a callback to call on failure\n     * @returns the new SceneOptimizer object\n     */\n    SceneOptimizer.OptimizeAsync = function (scene, options, onSuccess, onFailure) {\n        var optimizer = new SceneOptimizer(scene, options || SceneOptimizerOptions.ModerateDegradationAllowed(), false);\n        if (onSuccess) {\n            optimizer.onSuccessObservable.add(function () {\n                onSuccess();\n            });\n        }\n        if (onFailure) {\n            optimizer.onFailureObservable.add(function () {\n                onFailure();\n            });\n        }\n        optimizer.start();\n        return optimizer;\n    };\n    return SceneOptimizer;\n}());\nexport { SceneOptimizer };\n//# sourceMappingURL=sceneOptimizer.js.map","import { Mesh } from \"../Meshes/mesh.js\";\n\nimport { MultiMaterial } from \"../Materials/multiMaterial.js\";\nimport { SerializationHelper } from \"./decorators.js\";\nimport { Texture } from \"../Materials/Textures/texture.js\";\nvar serializedGeometries = [];\nvar SerializeGeometry = function (geometry, serializationGeometries) {\n    if (geometry.doNotSerialize) {\n        return;\n    }\n    serializationGeometries.vertexData.push(geometry.serializeVerticeData());\n    serializedGeometries[geometry.id] = true;\n};\nvar SerializeMesh = function (mesh, serializationScene) {\n    var serializationObject = {};\n    // Geometry\n    var geometry = mesh._geometry;\n    if (geometry) {\n        if (!mesh.getScene().getGeometryById(geometry.id)) {\n            // Geometry was in the memory but not added to the scene, nevertheless it's better to serialize to be able to reload the mesh with its geometry\n            SerializeGeometry(geometry, serializationScene.geometries);\n        }\n    }\n    // Custom\n    if (mesh.serialize) {\n        mesh.serialize(serializationObject);\n    }\n    return serializationObject;\n};\nvar FinalizeSingleMesh = function (mesh, serializationObject) {\n    //only works if the mesh is already loaded\n    if (mesh.delayLoadState === 1 || mesh.delayLoadState === 0) {\n        var serializeMaterial = function (material) {\n            serializationObject.materials = serializationObject.materials || [];\n            if (!serializationObject.materials.some(function (mat) { return mat.id === mesh.material.id; })) {\n                serializationObject.materials.push(material.serialize());\n            }\n        };\n        //serialize material\n        if (mesh.material && !mesh.material.doNotSerialize) {\n            if (mesh.material instanceof MultiMaterial) {\n                serializationObject.multiMaterials = serializationObject.multiMaterials || [];\n                if (!serializationObject.multiMaterials.some(function (mat) { return mat.id === mesh.material.id; })) {\n                    serializationObject.multiMaterials.push(mesh.material.serialize());\n                    for (var _i = 0, _a = mesh.material.subMaterials; _i < _a.length; _i++) {\n                        var submaterial = _a[_i];\n                        if (submaterial) {\n                            serializeMaterial(submaterial);\n                        }\n                    }\n                }\n            }\n            else {\n                serializeMaterial(mesh.material);\n            }\n        }\n        else if (!mesh.material) {\n            serializeMaterial(mesh.getScene().defaultMaterial);\n        }\n        //serialize geometry\n        var geometry = mesh._geometry;\n        if (geometry) {\n            if (!serializationObject.geometries) {\n                serializationObject.geometries = {};\n                serializationObject.geometries.boxes = [];\n                serializationObject.geometries.spheres = [];\n                serializationObject.geometries.cylinders = [];\n                serializationObject.geometries.toruses = [];\n                serializationObject.geometries.grounds = [];\n                serializationObject.geometries.planes = [];\n                serializationObject.geometries.torusKnots = [];\n                serializationObject.geometries.vertexData = [];\n            }\n            SerializeGeometry(geometry, serializationObject.geometries);\n        }\n        // Skeletons\n        if (mesh.skeleton && !mesh.skeleton.doNotSerialize) {\n            serializationObject.skeletons = serializationObject.skeletons || [];\n            serializationObject.skeletons.push(mesh.skeleton.serialize());\n        }\n        //serialize the actual mesh\n        serializationObject.meshes = serializationObject.meshes || [];\n        serializationObject.meshes.push(SerializeMesh(mesh, serializationObject));\n    }\n};\n/**\n * Class used to serialize a scene into a string\n */\nvar SceneSerializer = /** @class */ (function () {\n    function SceneSerializer() {\n    }\n    /**\n     * Clear cache used by a previous serialization\n     */\n    SceneSerializer.ClearCache = function () {\n        serializedGeometries = [];\n    };\n    /**\n     * Serialize a scene into a JSON compatible object\n     * Note that if the current engine does not support synchronous texture reading (like WebGPU), you should use SerializeAsync instead\n     * as else you may not retrieve the proper base64 encoded texture data (when using the Texture.ForceSerializeBuffers flag)\n     * @param scene defines the scene to serialize\n     * @returns a JSON compatible object\n     */\n    SceneSerializer.Serialize = function (scene) {\n        return SceneSerializer._Serialize(scene);\n    };\n    SceneSerializer._Serialize = function (scene, checkSyncReadSupported) {\n        if (checkSyncReadSupported === void 0) { checkSyncReadSupported = true; }\n        var serializationObject = {};\n        if (checkSyncReadSupported && !scene.getEngine()._features.supportSyncTextureRead && Texture.ForceSerializeBuffers) {\n            console.warn(\"The serialization object may not contain the proper base64 encoded texture data! You should use the SerializeAsync method instead.\");\n        }\n        SceneSerializer.ClearCache();\n        // Scene\n        serializationObject.useDelayedTextureLoading = scene.useDelayedTextureLoading;\n        serializationObject.autoClear = scene.autoClear;\n        serializationObject.clearColor = scene.clearColor.asArray();\n        serializationObject.ambientColor = scene.ambientColor.asArray();\n        serializationObject.gravity = scene.gravity.asArray();\n        serializationObject.collisionsEnabled = scene.collisionsEnabled;\n        serializationObject.useRightHandedSystem = scene.useRightHandedSystem;\n        // Fog\n        if (scene.fogMode && scene.fogMode !== 0) {\n            serializationObject.fogMode = scene.fogMode;\n            serializationObject.fogColor = scene.fogColor.asArray();\n            serializationObject.fogStart = scene.fogStart;\n            serializationObject.fogEnd = scene.fogEnd;\n            serializationObject.fogDensity = scene.fogDensity;\n        }\n        //Physics\n        if (scene.isPhysicsEnabled()) {\n            var physicEngine = scene.getPhysicsEngine();\n            if (physicEngine) {\n                serializationObject.physicsEnabled = true;\n                serializationObject.physicsGravity = physicEngine.gravity.asArray();\n                serializationObject.physicsEngine = physicEngine.getPhysicsPluginName();\n            }\n        }\n        // Metadata\n        if (scene.metadata) {\n            serializationObject.metadata = scene.metadata;\n        }\n        // Morph targets\n        serializationObject.morphTargetManagers = [];\n        for (var _i = 0, _a = scene.meshes; _i < _a.length; _i++) {\n            var abstractMesh = _a[_i];\n            var manager = abstractMesh.morphTargetManager;\n            if (manager) {\n                serializationObject.morphTargetManagers.push(manager.serialize());\n            }\n        }\n        // Lights\n        serializationObject.lights = [];\n        var index;\n        var light;\n        for (index = 0; index < scene.lights.length; index++) {\n            light = scene.lights[index];\n            if (!light.doNotSerialize) {\n                serializationObject.lights.push(light.serialize());\n            }\n        }\n        // Cameras\n        serializationObject.cameras = [];\n        for (index = 0; index < scene.cameras.length; index++) {\n            var camera = scene.cameras[index];\n            if (!camera.doNotSerialize) {\n                serializationObject.cameras.push(camera.serialize());\n            }\n        }\n        if (scene.activeCamera) {\n            serializationObject.activeCameraID = scene.activeCamera.id;\n        }\n        // Animations\n        SerializationHelper.AppendSerializedAnimations(scene, serializationObject);\n        // Animation Groups\n        if (scene.animationGroups && scene.animationGroups.length > 0) {\n            serializationObject.animationGroups = [];\n            for (var animationGroupIndex = 0; animationGroupIndex < scene.animationGroups.length; animationGroupIndex++) {\n                var animationGroup = scene.animationGroups[animationGroupIndex];\n                serializationObject.animationGroups.push(animationGroup.serialize());\n            }\n        }\n        // Reflection probes\n        if (scene.reflectionProbes && scene.reflectionProbes.length > 0) {\n            serializationObject.reflectionProbes = [];\n            for (index = 0; index < scene.reflectionProbes.length; index++) {\n                var reflectionProbe = scene.reflectionProbes[index];\n                serializationObject.reflectionProbes.push(reflectionProbe.serialize());\n            }\n        }\n        // Materials\n        serializationObject.materials = [];\n        serializationObject.multiMaterials = [];\n        var material;\n        for (index = 0; index < scene.materials.length; index++) {\n            material = scene.materials[index];\n            if (!material.doNotSerialize) {\n                serializationObject.materials.push(material.serialize());\n            }\n        }\n        // MultiMaterials\n        serializationObject.multiMaterials = [];\n        for (index = 0; index < scene.multiMaterials.length; index++) {\n            var multiMaterial = scene.multiMaterials[index];\n            serializationObject.multiMaterials.push(multiMaterial.serialize());\n        }\n        // Environment texture\n        if (scene.environmentTexture) {\n            if (scene.environmentTexture._files) {\n                serializationObject.environmentTexture = scene.environmentTexture.serialize();\n            }\n            else {\n                serializationObject.environmentTexture = scene.environmentTexture.name;\n                serializationObject.environmentTextureRotationY = scene.environmentTexture.rotationY;\n            }\n        }\n        // Environment Intensity\n        serializationObject.environmentIntensity = scene.environmentIntensity;\n        // Skeletons\n        serializationObject.skeletons = [];\n        for (index = 0; index < scene.skeletons.length; index++) {\n            var skeleton = scene.skeletons[index];\n            if (!skeleton.doNotSerialize) {\n                serializationObject.skeletons.push(skeleton.serialize());\n            }\n        }\n        // Transform nodes\n        serializationObject.transformNodes = [];\n        for (index = 0; index < scene.transformNodes.length; index++) {\n            if (!scene.transformNodes[index].doNotSerialize) {\n                serializationObject.transformNodes.push(scene.transformNodes[index].serialize());\n            }\n        }\n        // Geometries\n        serializationObject.geometries = {};\n        serializationObject.geometries.boxes = [];\n        serializationObject.geometries.spheres = [];\n        serializationObject.geometries.cylinders = [];\n        serializationObject.geometries.toruses = [];\n        serializationObject.geometries.grounds = [];\n        serializationObject.geometries.planes = [];\n        serializationObject.geometries.torusKnots = [];\n        serializationObject.geometries.vertexData = [];\n        serializedGeometries = [];\n        var geometries = scene.getGeometries();\n        for (index = 0; index < geometries.length; index++) {\n            var geometry = geometries[index];\n            if (geometry.isReady()) {\n                SerializeGeometry(geometry, serializationObject.geometries);\n            }\n        }\n        // Meshes\n        serializationObject.meshes = [];\n        for (index = 0; index < scene.meshes.length; index++) {\n            var abstractMesh = scene.meshes[index];\n            if (abstractMesh instanceof Mesh) {\n                var mesh = abstractMesh;\n                if (!mesh.doNotSerialize) {\n                    if (mesh.delayLoadState === 1 || mesh.delayLoadState === 0) {\n                        serializationObject.meshes.push(SerializeMesh(mesh, serializationObject));\n                    }\n                }\n            }\n        }\n        // Particles Systems\n        serializationObject.particleSystems = [];\n        for (index = 0; index < scene.particleSystems.length; index++) {\n            serializationObject.particleSystems.push(scene.particleSystems[index].serialize(false));\n        }\n        // Post processes\n        serializationObject.postProcesses = [];\n        for (index = 0; index < scene.postProcesses.length; index++) {\n            serializationObject.postProcesses.push(scene.postProcesses[index].serialize());\n        }\n        // Action Manager\n        if (scene.actionManager) {\n            serializationObject.actions = scene.actionManager.serialize(\"scene\");\n        }\n        // Components\n        for (var _b = 0, _c = scene._serializableComponents; _b < _c.length; _b++) {\n            var component = _c[_b];\n            component.serialize(serializationObject);\n        }\n        return serializationObject;\n    };\n    /**\n     * Serialize a scene into a JSON compatible object\n     * @param scene defines the scene to serialize\n     * @returns a JSON promise compatible object\n     */\n    SceneSerializer.SerializeAsync = function (scene) {\n        var serializationObject = SceneSerializer._Serialize(scene, false);\n        var promises = [];\n        this._CollectPromises(serializationObject, promises);\n        return Promise.all(promises).then(function () { return serializationObject; });\n    };\n    SceneSerializer._CollectPromises = function (obj, promises) {\n        if (Array.isArray(obj)) {\n            var _loop_1 = function (i) {\n                var o = obj[i];\n                if (o instanceof Promise) {\n                    promises.push(o.then(function (res) { return (obj[i] = res); }));\n                }\n                else if (o instanceof Object || Array.isArray(o)) {\n                    this_1._CollectPromises(o, promises);\n                }\n            };\n            var this_1 = this;\n            for (var i = 0; i < obj.length; ++i) {\n                _loop_1(i);\n            }\n        }\n        else if (obj instanceof Object) {\n            var _loop_2 = function (name_1) {\n                if (Object.prototype.hasOwnProperty.call(obj, name_1)) {\n                    var o = obj[name_1];\n                    if (o instanceof Promise) {\n                        promises.push(o.then(function (res) { return (obj[name_1] = res); }));\n                    }\n                    else if (o instanceof Object || Array.isArray(o)) {\n                        this_2._CollectPromises(o, promises);\n                    }\n                }\n            };\n            var this_2 = this;\n            for (var name_1 in obj) {\n                _loop_2(name_1);\n            }\n        }\n    };\n    /**\n     * Serialize a mesh into a JSON compatible object\n     * @param toSerialize defines the mesh to serialize\n     * @param withParents defines if parents must be serialized as well\n     * @param withChildren defines if children must be serialized as well\n     * @returns a JSON compatible object\n     */\n    SceneSerializer.SerializeMesh = function (toSerialize /* Mesh || Mesh[] */, withParents, withChildren) {\n        if (withParents === void 0) { withParents = false; }\n        if (withChildren === void 0) { withChildren = false; }\n        var serializationObject = {};\n        SceneSerializer.ClearCache();\n        toSerialize = toSerialize instanceof Array ? toSerialize : [toSerialize];\n        if (withParents || withChildren) {\n            //deliberate for loop! not for each, appended should be processed as well.\n            for (var i = 0; i < toSerialize.length; ++i) {\n                if (withChildren) {\n                    toSerialize[i].getDescendants().forEach(function (node) {\n                        if (node instanceof Mesh && toSerialize.indexOf(node) < 0 && !node.doNotSerialize) {\n                            toSerialize.push(node);\n                        }\n                    });\n                }\n                //make sure the array doesn't contain the object already\n                if (withParents && toSerialize[i].parent && toSerialize.indexOf(toSerialize[i].parent) < 0 && !toSerialize[i].parent.doNotSerialize) {\n                    toSerialize.push(toSerialize[i].parent);\n                }\n            }\n        }\n        toSerialize.forEach(function (mesh) {\n            FinalizeSingleMesh(mesh, serializationObject);\n        });\n        return serializationObject;\n    };\n    return SceneSerializer;\n}());\nexport { SceneSerializer };\n//# sourceMappingURL=sceneSerializer.js.map","import { __assign } from \"tslib\";\nimport { Tools } from \"./tools.js\";\n/**\n * This can help with recording videos from BabylonJS.\n * This is based on the available WebRTC functionalities of the browser.\n *\n * @see https://doc.babylonjs.com/how_to/render_scene_on_a_video\n */\nvar VideoRecorder = /** @class */ (function () {\n    /**\n     * Create a new VideoCapture object which can help converting what you see in Babylon to a video file.\n     * @param engine Defines the BabylonJS Engine you wish to record.\n     * @param options Defines options that can be used to customize the capture.\n     */\n    function VideoRecorder(engine, options) {\n        if (options === void 0) { options = {}; }\n        if (!VideoRecorder.IsSupported(engine)) {\n            throw \"Your browser does not support recording so far.\";\n        }\n        var canvas = engine.getRenderingCanvas();\n        if (!canvas) {\n            throw \"The babylon engine must have a canvas to be recorded\";\n        }\n        this._canvas = canvas;\n        this._canvas.isRecording = false;\n        this._options = __assign(__assign({}, VideoRecorder._DefaultOptions), options);\n        var stream = this._canvas.captureStream(this._options.fps);\n        if (this._options.audioTracks) {\n            for (var _i = 0, _a = this._options.audioTracks; _i < _a.length; _i++) {\n                var track = _a[_i];\n                stream.addTrack(track);\n            }\n        }\n        this._mediaRecorder = new MediaRecorder(stream, { mimeType: this._options.mimeType });\n        this._mediaRecorder.ondataavailable = this._handleDataAvailable.bind(this);\n        this._mediaRecorder.onerror = this._handleError.bind(this);\n        this._mediaRecorder.onstop = this._handleStop.bind(this);\n    }\n    /**\n     * Returns whether or not the VideoRecorder is available in your browser.\n     * @param engine Defines the Babylon Engine.\n     * @returns true if supported otherwise false.\n     */\n    VideoRecorder.IsSupported = function (engine) {\n        var canvas = engine.getRenderingCanvas();\n        return !!canvas && typeof canvas.captureStream === \"function\";\n    };\n    Object.defineProperty(VideoRecorder.prototype, \"isRecording\", {\n        /**\n         * True when a recording is already in progress.\n         */\n        get: function () {\n            return !!this._canvas && this._canvas.isRecording;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Stops the current recording before the default capture timeout passed in the startRecording function.\n     */\n    VideoRecorder.prototype.stopRecording = function () {\n        if (!this._canvas || !this._mediaRecorder) {\n            return;\n        }\n        if (!this.isRecording) {\n            return;\n        }\n        this._canvas.isRecording = false;\n        this._mediaRecorder.stop();\n    };\n    /**\n     * Starts recording the canvas for a max duration specified in parameters.\n     * @param fileName Defines the name of the file to be downloaded when the recording stop.\n     * If null no automatic download will start and you can rely on the promise to get the data back.\n     * @param maxDuration Defines the maximum recording time in seconds.\n     * It defaults to 7 seconds. A value of zero will not stop automatically, you would need to call stopRecording manually.\n     * @return A promise callback at the end of the recording with the video data in Blob.\n     */\n    VideoRecorder.prototype.startRecording = function (fileName, maxDuration) {\n        var _this = this;\n        if (fileName === void 0) { fileName = \"babylonjs.webm\"; }\n        if (maxDuration === void 0) { maxDuration = 7; }\n        if (!this._canvas || !this._mediaRecorder) {\n            throw \"Recorder has already been disposed\";\n        }\n        if (this.isRecording) {\n            throw \"Recording already in progress\";\n        }\n        if (maxDuration > 0) {\n            setTimeout(function () {\n                _this.stopRecording();\n            }, maxDuration * 1000);\n        }\n        this._fileName = fileName;\n        this._recordedChunks = [];\n        this._resolve = null;\n        this._reject = null;\n        this._canvas.isRecording = true;\n        this._mediaRecorder.start(this._options.recordChunckSize);\n        return new Promise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n    };\n    /**\n     * Releases internal resources used during the recording.\n     */\n    VideoRecorder.prototype.dispose = function () {\n        this._canvas = null;\n        this._mediaRecorder = null;\n        this._recordedChunks = [];\n        this._fileName = null;\n        this._resolve = null;\n        this._reject = null;\n    };\n    VideoRecorder.prototype._handleDataAvailable = function (event) {\n        if (event.data.size > 0) {\n            this._recordedChunks.push(event.data);\n        }\n    };\n    VideoRecorder.prototype._handleError = function (event) {\n        this.stopRecording();\n        if (this._reject) {\n            this._reject(event.error);\n        }\n        else {\n            throw new event.error();\n        }\n    };\n    VideoRecorder.prototype._handleStop = function () {\n        this.stopRecording();\n        var superBuffer = new Blob(this._recordedChunks);\n        if (this._resolve) {\n            this._resolve(superBuffer);\n        }\n        window.URL.createObjectURL(superBuffer);\n        if (this._fileName) {\n            Tools.Download(superBuffer, this._fileName);\n        }\n    };\n    VideoRecorder._DefaultOptions = {\n        mimeType: \"video/webm\",\n        fps: 25,\n        recordChunckSize: 3000,\n    };\n    return VideoRecorder;\n}());\nexport { VideoRecorder };\n//# sourceMappingURL=videoRecorder.js.map","import { Texture } from \"../Materials/Textures/texture.js\";\nimport { RenderTargetTexture } from \"../Materials/Textures/renderTargetTexture.js\";\nimport { FxaaPostProcess } from \"../PostProcesses/fxaaPostProcess.js\";\n\nimport { Logger } from \"./logger.js\";\nimport { Tools } from \"./tools.js\";\n/**\n * Captures a screenshot of the current rendering\n * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n * @param engine defines the rendering engine\n * @param camera defines the source camera\n * @param size This parameter can be set to a single number or to an object with the\n * following (optional) properties: precision, width, height. If a single number is passed,\n * it will be used for both width and height. If an object is passed, the screenshot size\n * will be derived from the parameters. The precision property is a multiplier allowing\n * rendering at a higher or lower resolution\n * @param successCallback defines the callback receives a single parameter which contains the\n * screenshot as a string of base64-encoded characters. This string can be assigned to the\n * src parameter of an <img> to display it\n * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n * Check your browser for supported MIME types\n * @param forceDownload force the system to download the image even if a successCallback is provided\n */\nexport function CreateScreenshot(engine, camera, size, successCallback, mimeType, forceDownload) {\n    if (mimeType === void 0) { mimeType = \"image/png\"; }\n    if (forceDownload === void 0) { forceDownload = false; }\n    var _a = _GetScreenshotSize(engine, camera, size), height = _a.height, width = _a.width;\n    if (!(height && width)) {\n        Logger.Error(\"Invalid 'size' parameter !\");\n        return;\n    }\n    if (!Tools._ScreenshotCanvas) {\n        Tools._ScreenshotCanvas = document.createElement(\"canvas\");\n    }\n    Tools._ScreenshotCanvas.width = width;\n    Tools._ScreenshotCanvas.height = height;\n    var renderContext = Tools._ScreenshotCanvas.getContext(\"2d\");\n    var ratio = engine.getRenderWidth() / engine.getRenderHeight();\n    var newWidth = width;\n    var newHeight = newWidth / ratio;\n    if (newHeight > height) {\n        newHeight = height;\n        newWidth = newHeight * ratio;\n    }\n    var offsetX = Math.max(0, width - newWidth) / 2;\n    var offsetY = Math.max(0, height - newHeight) / 2;\n    engine.onEndFrameObservable.addOnce(function () {\n        var renderingCanvas = engine.getRenderingCanvas();\n        if (renderContext && renderingCanvas) {\n            renderContext.drawImage(renderingCanvas, offsetX, offsetY, newWidth, newHeight);\n        }\n        if (forceDownload) {\n            Tools.EncodeScreenshotCanvasData(undefined, mimeType);\n            if (successCallback) {\n                successCallback(\"\");\n            }\n        }\n        else {\n            Tools.EncodeScreenshotCanvasData(successCallback, mimeType);\n        }\n    });\n}\n/**\n * Captures a screenshot of the current rendering\n * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n * @param engine defines the rendering engine\n * @param camera defines the source camera\n * @param size This parameter can be set to a single number or to an object with the\n * following (optional) properties: precision, width, height. If a single number is passed,\n * it will be used for both width and height. If an object is passed, the screenshot size\n * will be derived from the parameters. The precision property is a multiplier allowing\n * rendering at a higher or lower resolution\n * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n * Check your browser for supported MIME types\n * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n * to the src parameter of an <img> to display it\n */\nexport function CreateScreenshotAsync(engine, camera, size, mimeType) {\n    if (mimeType === void 0) { mimeType = \"image/png\"; }\n    return new Promise(function (resolve, reject) {\n        CreateScreenshot(engine, camera, size, function (data) {\n            if (typeof data !== \"undefined\") {\n                resolve(data);\n            }\n            else {\n                reject(new Error(\"Data is undefined\"));\n            }\n        }, mimeType);\n    });\n}\n/**\n * Captures a screenshot of the current rendering for a specific size. This will render the entire canvas but will generate a blink (due to canvas resize)\n * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n * @param engine defines the rendering engine\n * @param camera defines the source camera\n * @param width defines the expected width\n * @param height defines the expected height\n * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n * Check your browser for supported MIME types\n * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n * to the src parameter of an <img> to display it\n */\nexport function CreateScreenshotWithResizeAsync(engine, camera, width, height, mimeType) {\n    if (mimeType === void 0) { mimeType = \"image/png\"; }\n    return new Promise(function (resolve) {\n        CreateScreenshot(engine, camera, { width: width, height: height }, function () {\n            resolve();\n        }, mimeType, true);\n    });\n}\n/**\n * Generates an image screenshot from the specified camera.\n * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n * @param engine The engine to use for rendering\n * @param camera The camera to use for rendering\n * @param size This parameter can be set to a single number or to an object with the\n * following (optional) properties: precision, width, height. If a single number is passed,\n * it will be used for both width and height. If an object is passed, the screenshot size\n * will be derived from the parameters. The precision property is a multiplier allowing\n * rendering at a higher or lower resolution\n * @param successCallback The callback receives a single parameter which contains the\n * screenshot as a string of base64-encoded characters. This string can be assigned to the\n * src parameter of an <img> to display it\n * @param mimeType The MIME type of the screenshot image (default: image/png).\n * Check your browser for supported MIME types\n * @param samples Texture samples (default: 1)\n * @param antialiasing Whether antialiasing should be turned on or not (default: false)\n * @param fileName A name for for the downloaded file.\n * @param renderSprites Whether the sprites should be rendered or not (default: false)\n * @param enableStencilBuffer Whether the stencil buffer should be enabled or not (default: false)\n */\nexport function CreateScreenshotUsingRenderTarget(engine, camera, size, successCallback, mimeType, samples, antialiasing, fileName, renderSprites, enableStencilBuffer) {\n    if (mimeType === void 0) { mimeType = \"image/png\"; }\n    if (samples === void 0) { samples = 1; }\n    if (antialiasing === void 0) { antialiasing = false; }\n    if (renderSprites === void 0) { renderSprites = false; }\n    if (enableStencilBuffer === void 0) { enableStencilBuffer = false; }\n    var _a = _GetScreenshotSize(engine, camera, size), height = _a.height, width = _a.width;\n    var targetTextureSize = { width: width, height: height };\n    if (!(height && width)) {\n        Logger.Error(\"Invalid 'size' parameter !\");\n        return;\n    }\n    var scene = camera.getScene();\n    var previousCamera = null;\n    var previousCameras = scene.activeCameras;\n    scene.activeCameras = null;\n    if (scene.activeCamera !== camera) {\n        previousCamera = scene.activeCamera;\n        scene.activeCamera = camera;\n    }\n    scene.render(); // make sure the scene is ready to be rendered in the RTT with the right list of active meshes (which depends on the camera, that may have been changed above)\n    // At this point size can be a number, or an object (according to engine.prototype.createRenderTargetTexture method)\n    var texture = new RenderTargetTexture(\"screenShot\", targetTextureSize, scene, false, false, 0, false, Texture.NEAREST_SAMPLINGMODE, undefined, enableStencilBuffer, undefined, undefined, undefined, samples);\n    texture.renderList = null;\n    texture.samples = samples;\n    texture.renderSprites = renderSprites;\n    var renderToTexture = function () {\n        engine.onEndFrameObservable.addOnce(function () {\n            texture.readPixels(undefined, undefined, undefined, false).then(function (data) {\n                Tools.DumpData(width, height, data, successCallback, mimeType, fileName, true);\n                texture.dispose();\n            });\n        });\n        // render the RTT\n        scene.incrementRenderId();\n        scene.resetCachedMaterial();\n        texture.render(true);\n        // re-render the scene after the camera has been reset to the original camera to avoid a flicker that could occur\n        // if the camera used for the RTT rendering stays in effect for the next frame (and if that camera was different from the original camera)\n        scene.incrementRenderId();\n        scene.resetCachedMaterial();\n        if (previousCamera) {\n            scene.activeCamera = previousCamera;\n        }\n        scene.activeCameras = previousCameras;\n        camera.getProjectionMatrix(true); // Force cache refresh;\n        scene.render();\n    };\n    if (antialiasing) {\n        var fxaaPostProcess = new FxaaPostProcess(\"antialiasing\", 1.0, scene.activeCamera);\n        texture.addPostProcess(fxaaPostProcess);\n        // Async Shader Compilation can lead to none ready effects in synchronous code\n        if (!fxaaPostProcess.getEffect().isReady()) {\n            fxaaPostProcess.getEffect().onCompiled = function () {\n                renderToTexture();\n            };\n        }\n        // The effect is ready we can render\n        else {\n            renderToTexture();\n        }\n    }\n    else {\n        // No need to wait for extra resources to be ready\n        renderToTexture();\n    }\n}\n/**\n * Generates an image screenshot from the specified camera.\n * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n * @param engine The engine to use for rendering\n * @param camera The camera to use for rendering\n * @param size This parameter can be set to a single number or to an object with the\n * following (optional) properties: precision, width, height. If a single number is passed,\n * it will be used for both width and height. If an object is passed, the screenshot size\n * will be derived from the parameters. The precision property is a multiplier allowing\n * rendering at a higher or lower resolution\n * @param mimeType The MIME type of the screenshot image (default: image/png).\n * Check your browser for supported MIME types\n * @param samples Texture samples (default: 1)\n * @param antialiasing Whether antialiasing should be turned on or not (default: false)\n * @param fileName A name for for the downloaded file.\n * @param renderSprites Whether the sprites should be rendered or not (default: false)\n * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n * to the src parameter of an <img> to display it\n */\nexport function CreateScreenshotUsingRenderTargetAsync(engine, camera, size, mimeType, samples, antialiasing, fileName, renderSprites) {\n    if (mimeType === void 0) { mimeType = \"image/png\"; }\n    if (samples === void 0) { samples = 1; }\n    if (antialiasing === void 0) { antialiasing = false; }\n    if (renderSprites === void 0) { renderSprites = false; }\n    return new Promise(function (resolve, reject) {\n        CreateScreenshotUsingRenderTarget(engine, camera, size, function (data) {\n            if (typeof data !== \"undefined\") {\n                resolve(data);\n            }\n            else {\n                reject(new Error(\"Data is undefined\"));\n            }\n        }, mimeType, samples, antialiasing, fileName, renderSprites);\n    });\n}\n/**\n * Gets height and width for screenshot size\n * @param engine\n * @param camera\n * @param size\n * @private\n */\nfunction _GetScreenshotSize(engine, camera, size) {\n    var height = 0;\n    var width = 0;\n    //If a size value defined as object\n    if (typeof size === \"object\") {\n        var precision = size.precision\n            ? Math.abs(size.precision) // prevent GL_INVALID_VALUE : glViewport: negative width/height\n            : 1;\n        //If a width and height values is specified\n        if (size.width && size.height) {\n            height = size.height * precision;\n            width = size.width * precision;\n        }\n        //If passing only width, computing height to keep display canvas ratio.\n        else if (size.width && !size.height) {\n            width = size.width * precision;\n            height = Math.round(width / engine.getAspectRatio(camera));\n        }\n        //If passing only height, computing width to keep display canvas ratio.\n        else if (size.height && !size.width) {\n            height = size.height * precision;\n            width = Math.round(height * engine.getAspectRatio(camera));\n        }\n        else {\n            width = Math.round(engine.getRenderWidth() * precision);\n            height = Math.round(width / engine.getAspectRatio(camera));\n        }\n    }\n    //Assuming here that \"size\" parameter is a number\n    else if (!isNaN(size)) {\n        height = size;\n        width = size;\n    }\n    // When creating the image data from the CanvasRenderingContext2D, the width and height is clamped to the size of the _gl context\n    // On certain GPUs, it seems as if the _gl context truncates to an integer automatically. Therefore, if a user tries to pass the width of their canvas element\n    // and it happens to be a float (1000.5 x 600.5 px), the engine.readPixels will return a different size array than context.createImageData\n    // to resolve this, we truncate the floats here to ensure the same size\n    if (width) {\n        width = Math.floor(width);\n    }\n    if (height) {\n        height = Math.floor(height);\n    }\n    return { height: height | 0, width: width | 0 };\n}\n/**\n * Class containing a set of static utilities functions for screenshots\n */\nexport var ScreenshotTools = {\n    /**\n     * Captures a screenshot of the current rendering\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine defines the rendering engine\n     * @param camera defines the source camera\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param successCallback defines the callback receives a single parameter which contains the\n     * screenshot as a string of base64-encoded characters. This string can be assigned to the\n     * src parameter of an <img> to display it\n     * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @param forceDownload force the system to download the image even if a successCallback is provided\n     */\n    CreateScreenshot: CreateScreenshot,\n    /**\n     * Captures a screenshot of the current rendering\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine defines the rendering engine\n     * @param camera defines the source camera\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n     * to the src parameter of an <img> to display it\n     */\n    CreateScreenshotAsync: CreateScreenshotAsync,\n    /**\n     * Captures a screenshot of the current rendering for a specific size. This will render the entire canvas but will generate a blink (due to canvas resize)\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine defines the rendering engine\n     * @param camera defines the source camera\n     * @param width defines the expected width\n     * @param height defines the expected height\n     * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n     * to the src parameter of an <img> to display it\n     */\n    CreateScreenshotWithResizeAsync: CreateScreenshotWithResizeAsync,\n    /**\n     * Generates an image screenshot from the specified camera.\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine The engine to use for rendering\n     * @param camera The camera to use for rendering\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param successCallback The callback receives a single parameter which contains the\n     * screenshot as a string of base64-encoded characters. This string can be assigned to the\n     * src parameter of an <img> to display it\n     * @param mimeType The MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @param samples Texture samples (default: 1)\n     * @param antialiasing Whether antialiasing should be turned on or not (default: false)\n     * @param fileName A name for for the downloaded file.\n     * @param renderSprites Whether the sprites should be rendered or not (default: false)\n     * @param enableStencilBuffer Whether the stencil buffer should be enabled or not (default: false)\n     */\n    CreateScreenshotUsingRenderTarget: CreateScreenshotUsingRenderTarget,\n    /**\n     * Generates an image screenshot from the specified camera.\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine The engine to use for rendering\n     * @param camera The camera to use for rendering\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param mimeType The MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @param samples Texture samples (default: 1)\n     * @param antialiasing Whether antialiasing should be turned on or not (default: false)\n     * @param fileName A name for for the downloaded file.\n     * @param renderSprites Whether the sprites should be rendered or not (default: false)\n     * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n     * to the src parameter of an <img> to display it\n     */\n    CreateScreenshotUsingRenderTargetAsync: CreateScreenshotUsingRenderTargetAsync,\n};\n/**\n * This will be executed automatically for UMD and es5.\n * If esm dev wants the side effects to execute they will have to run it manually\n * Once we build native modules those need to be exported.\n * @hidden\n */\nvar initSideEffects = function () {\n    // References the dependencies.\n    Tools.CreateScreenshot = CreateScreenshot;\n    Tools.CreateScreenshotAsync = CreateScreenshotAsync;\n    Tools.CreateScreenshotUsingRenderTarget = CreateScreenshotUsingRenderTarget;\n    Tools.CreateScreenshotUsingRenderTargetAsync = CreateScreenshotUsingRenderTargetAsync;\n};\ninitSideEffects();\n//# sourceMappingURL=screenshotTools.js.map","/**\n * Enum that determines the text-wrapping mode to use.\n */\nexport var InspectableType;\n(function (InspectableType) {\n    /**\n     * Checkbox for booleans\n     */\n    InspectableType[InspectableType[\"Checkbox\"] = 0] = \"Checkbox\";\n    /**\n     * Sliders for numbers\n     */\n    InspectableType[InspectableType[\"Slider\"] = 1] = \"Slider\";\n    /**\n     * Vector3\n     */\n    InspectableType[InspectableType[\"Vector3\"] = 2] = \"Vector3\";\n    /**\n     * Quaternions\n     */\n    InspectableType[InspectableType[\"Quaternion\"] = 3] = \"Quaternion\";\n    /**\n     * Color3\n     */\n    InspectableType[InspectableType[\"Color3\"] = 4] = \"Color3\";\n    /**\n     * String\n     */\n    InspectableType[InspectableType[\"String\"] = 5] = \"String\";\n    /**\n     * Button\n     */\n    InspectableType[InspectableType[\"Button\"] = 6] = \"Button\";\n    /**\n     * Options\n     */\n    InspectableType[InspectableType[\"Options\"] = 7] = \"Options\";\n    /**\n     * Tab\n     */\n    InspectableType[InspectableType[\"Tab\"] = 8] = \"Tab\";\n})(InspectableType || (InspectableType = {}));\n//# sourceMappingURL=iInspectable.js.map","import { __spreadArray } from \"tslib\";\nimport { Matrix, Vector3 } from \"../Maths/math.vector.js\";\n// This implementation was based on the original MIT-licensed TRACE repository\n// from https://github.com/septagon/TRACE.\n/**\n * Generic implementation of Levenshtein distance.\n */\nvar Levenshtein;\n(function (Levenshtein) {\n    /**\n     * Alphabet from which to construct sequences to be compared using Levenshtein\n     * distance.\n     */\n    var Alphabet = /** @class */ (function () {\n        /**\n         * Create a new Alphabet.\n         * @param characters characters of the alphabet\n         * @param charToInsertionCost function mapping characters to insertion costs\n         * @param charToDeletionCost function mapping characters to deletion costs\n         * @param charsToSubstitutionCost function mapping character pairs to substitution costs\n         */\n        function Alphabet(characters, charToInsertionCost, charToDeletionCost, charsToSubstitutionCost) {\n            if (charToInsertionCost === void 0) { charToInsertionCost = null; }\n            if (charToDeletionCost === void 0) { charToDeletionCost = null; }\n            if (charsToSubstitutionCost === void 0) { charsToSubstitutionCost = null; }\n            charToInsertionCost = charToInsertionCost !== null && charToInsertionCost !== void 0 ? charToInsertionCost : (function () { return 1; });\n            charToDeletionCost = charToDeletionCost !== null && charToDeletionCost !== void 0 ? charToDeletionCost : (function () { return 1; });\n            charsToSubstitutionCost = charsToSubstitutionCost !== null && charsToSubstitutionCost !== void 0 ? charsToSubstitutionCost : (function (a, b) { return (a === b ? 0 : 1); });\n            this._characterToIdx = new Map();\n            this._insertionCosts = new Array(characters.length);\n            this._deletionCosts = new Array(characters.length);\n            this._substitutionCosts = new Array(characters.length);\n            var c;\n            for (var outerIdx = 0; outerIdx < characters.length; ++outerIdx) {\n                c = characters[outerIdx];\n                this._characterToIdx.set(c, outerIdx);\n                this._insertionCosts[outerIdx] = charToInsertionCost(c);\n                this._deletionCosts[outerIdx] = charToDeletionCost(c);\n                this._substitutionCosts[outerIdx] = new Array(characters.length);\n                for (var innerIdx = outerIdx; innerIdx < characters.length; ++innerIdx) {\n                    this._substitutionCosts[outerIdx][innerIdx] = charsToSubstitutionCost(c, characters[innerIdx]);\n                }\n            }\n        }\n        /**\n         * Serialize the Alphabet to JSON string.\n         * @returns JSON serialization\n         */\n        Alphabet.prototype.serialize = function () {\n            var jsonObject = {};\n            var characters = new Array(this._characterToIdx.size);\n            this._characterToIdx.forEach(function (v, k) {\n                characters[v] = k;\n            });\n            jsonObject[\"characters\"] = characters;\n            jsonObject[\"insertionCosts\"] = this._insertionCosts;\n            jsonObject[\"deletionCosts\"] = this._deletionCosts;\n            jsonObject[\"substitutionCosts\"] = this._substitutionCosts;\n            return JSON.stringify(jsonObject);\n        };\n        /**\n         * Parse an Alphabet from a JSON serialization.\n         * @param json JSON string to deserialize\n         * @returns deserialized Alphabet\n         */\n        Alphabet.Deserialize = function (json) {\n            var jsonObject = JSON.parse(json);\n            var alphabet = new Alphabet(jsonObject[\"characters\"]);\n            alphabet._insertionCosts = jsonObject[\"insertionCosts\"];\n            alphabet._deletionCosts = jsonObject[\"deletionCosts\"];\n            alphabet._substitutionCosts = jsonObject[\"substitutionCosts\"];\n            return alphabet;\n        };\n        /**\n         * Get the index (internally-assigned number) for a character.\n         * @param char character\n         * @returns index\n         */\n        Alphabet.prototype.getCharacterIdx = function (char) {\n            return this._characterToIdx.get(char);\n        };\n        /**\n         * Get the insertion cost of a character from its index.\n         * @param idx character index\n         * @returns insertion cost\n         */\n        Alphabet.prototype.getInsertionCost = function (idx) {\n            return this._insertionCosts[idx];\n        };\n        /**\n         * Get the deletion cost of a character from its index.\n         * @param idx character index\n         * @returns deletion cost\n         */\n        Alphabet.prototype.getDeletionCost = function (idx) {\n            return this._deletionCosts[idx];\n        };\n        /**\n         * Gets the cost to substitute two characters. NOTE: this cost is\n         * required to be bi-directional, meaning it cannot matter which of\n         * the provided characters is being removed and which is being inserted.\n         * @param idx1 the first character index\n         * @param idx2 the second character index\n         * @returns substitution cost\n         */\n        Alphabet.prototype.getSubstitutionCost = function (idx1, idx2) {\n            var min = Math.min(idx1, idx2);\n            var max = Math.max(idx1, idx2);\n            return this._substitutionCosts[min][max];\n        };\n        return Alphabet;\n    }());\n    Levenshtein.Alphabet = Alphabet;\n    /**\n     * Character sequence intended to be compared against other Sequences created\n     * with the same Alphabet in order to compute Levenshtein distance.\n     */\n    var Sequence = /** @class */ (function () {\n        /**\n         * Create a new Sequence.\n         * @param characters characters in the new Sequence\n         * @param alphabet Alphabet, which must include all used characters\n         */\n        function Sequence(characters, alphabet) {\n            var _this = this;\n            if (characters.length > Sequence._MAX_SEQUENCE_LENGTH) {\n                throw new Error(\"Sequences longer than \" + Sequence._MAX_SEQUENCE_LENGTH + \" not supported.\");\n            }\n            this._alphabet = alphabet;\n            this._characters = characters.map(function (c) { return _this._alphabet.getCharacterIdx(c); });\n        }\n        /**\n         * Serialize to JSON string. JSON representation does NOT include the Alphabet\n         * from which this Sequence was created; Alphabet must be independently\n         * serialized.\n         * @returns JSON string\n         */\n        Sequence.prototype.serialize = function () {\n            return JSON.stringify(this._characters);\n        };\n        /**\n         * Deserialize from JSON string and Alphabet. This should be the same Alphabet\n         * from which the Sequence was originally created, which must be serialized and\n         * deserialized independently so that it can be passed in here.\n         * @param json JSON string representation of Sequence\n         * @param alphabet Alphabet from which Sequence was originally created\n         * @returns Sequence\n         */\n        Sequence.Deserialize = function (json, alphabet) {\n            var sequence = new Sequence([], alphabet);\n            sequence._characters = JSON.parse(json);\n            return sequence;\n        };\n        /**\n         * Get the distance between this Sequence and another.\n         * @param other sequence to compare to\n         * @returns Levenshtein distance\n         */\n        Sequence.prototype.distance = function (other) {\n            return Sequence._Distance(this, other);\n        };\n        /**\n         * Compute the Levenshtein distance between two Sequences.\n         * @param a first Sequence\n         * @param b second Sequence\n         * @returns Levenshtein distance\n         */\n        Sequence._Distance = function (a, b) {\n            var alphabet = a._alphabet;\n            if (alphabet !== b._alphabet) {\n                throw new Error(\"Cannot Levenshtein compare Sequences built from different alphabets.\");\n            }\n            var aChars = a._characters;\n            var bChars = b._characters;\n            var aLength = aChars.length;\n            var bLength = bChars.length;\n            var costMatrix = Sequence._CostMatrix;\n            costMatrix[0][0] = 0;\n            for (var idx = 0; idx < aLength; ++idx) {\n                costMatrix[idx + 1][0] = costMatrix[idx][0] + alphabet.getInsertionCost(aChars[idx]);\n            }\n            for (var idx = 0; idx < bLength; ++idx) {\n                costMatrix[0][idx + 1] = costMatrix[0][idx] + alphabet.getInsertionCost(bChars[idx]);\n            }\n            for (var aIdx = 0; aIdx < aLength; ++aIdx) {\n                for (var bIdx = 0; bIdx < bLength; ++bIdx) {\n                    Sequence._InsertionCost = costMatrix[aIdx + 1][bIdx] + alphabet.getInsertionCost(bChars[bIdx]);\n                    Sequence._DeletionCost = costMatrix[aIdx][bIdx + 1] + alphabet.getDeletionCost(aChars[aIdx]);\n                    Sequence._SubstitutionCost = costMatrix[aIdx][bIdx] + alphabet.getSubstitutionCost(aChars[aIdx], bChars[bIdx]);\n                    costMatrix[aIdx + 1][bIdx + 1] = Math.min(Sequence._InsertionCost, Sequence._DeletionCost, Sequence._SubstitutionCost);\n                }\n            }\n            return costMatrix[aLength][bLength];\n        };\n        // Scratch values\n        Sequence._MAX_SEQUENCE_LENGTH = 256;\n        Sequence._CostMatrix = __spreadArray([], Array(Sequence._MAX_SEQUENCE_LENGTH + 1), true).map(function () { return new Array(Sequence._MAX_SEQUENCE_LENGTH + 1); });\n        return Sequence;\n    }());\n    Levenshtein.Sequence = Sequence;\n})(Levenshtein || (Levenshtein = {}));\n/**\n * A 3D trajectory consisting of an order list of vectors describing a\n * path of motion through 3D space.\n */\nvar Trajectory = /** @class */ (function () {\n    /**\n     * Create a new empty Trajectory.\n     * @param segmentLength radius of discretization for Trajectory points\n     */\n    function Trajectory(segmentLength) {\n        if (segmentLength === void 0) { segmentLength = 0.01; }\n        this._points = [];\n        this._segmentLength = segmentLength;\n    }\n    /**\n     * Serialize to JSON.\n     * @returns serialized JSON string\n     */\n    Trajectory.prototype.serialize = function () {\n        return JSON.stringify(this);\n    };\n    /**\n     * Deserialize from JSON.\n     * @param json serialized JSON string\n     * @returns deserialized Trajectory\n     */\n    Trajectory.Deserialize = function (json) {\n        var jsonObject = JSON.parse(json);\n        var trajectory = new Trajectory(jsonObject[\"_segmentLength\"]);\n        trajectory._points = jsonObject[\"_points\"].map(function (pt) {\n            return new Vector3(pt[\"_x\"], pt[\"_y\"], pt[\"_z\"]);\n        });\n        return trajectory;\n    };\n    /**\n     * Get the length of the Trajectory.\n     * @returns length of the Trajectory\n     */\n    Trajectory.prototype.getLength = function () {\n        return this._points.length * this._segmentLength;\n    };\n    /**\n     * Append a new point to the Trajectory.\n     * NOTE: This implementation has many allocations.\n     * @param point point to append to the Trajectory\n     */\n    Trajectory.prototype.add = function (point) {\n        var _this = this;\n        var numPoints = this._points.length;\n        if (numPoints === 0) {\n            this._points.push(point.clone());\n        }\n        else {\n            var getT = function () { return _this._segmentLength / Vector3.Distance(_this._points[numPoints - 1], point); };\n            for (var t = getT(); t <= 1.0; t = getT()) {\n                var newPoint = this._points[numPoints - 1].scale(1.0 - t);\n                point.scaleAndAddToRef(t, newPoint);\n                this._points.push(newPoint);\n                ++numPoints;\n            }\n        }\n    };\n    /**\n     * Create a new Trajectory with a segment length chosen to make it\n     * probable that the new Trajectory will have a specified number of\n     * segments. This operation is imprecise.\n     * @param targetResolution number of segments desired\n     * @returns new Trajectory with approximately the requested number of segments\n     */\n    Trajectory.prototype.resampleAtTargetResolution = function (targetResolution) {\n        var resampled = new Trajectory(this.getLength() / targetResolution);\n        this._points.forEach(function (pt) {\n            resampled.add(pt);\n        });\n        return resampled;\n    };\n    /**\n     * Convert Trajectory segments into tokenized representation. This\n     * representation is an array of numbers where each nth number is the\n     * index of the token which is most similar to the nth segment of the\n     * Trajectory.\n     * @param tokens list of vectors which serve as discrete tokens\n     * @returns list of indices of most similar token per segment\n     */\n    Trajectory.prototype.tokenize = function (tokens) {\n        var tokenization = [];\n        var segmentDir = new Vector3();\n        for (var idx = 2; idx < this._points.length; ++idx) {\n            if (Trajectory._TransformSegmentDirToRef(this._points[idx - 2], this._points[idx - 1], this._points[idx], segmentDir)) {\n                tokenization.push(Trajectory._TokenizeSegment(segmentDir, tokens));\n            }\n        }\n        return tokenization;\n    };\n    /**\n     * Transform the rotation (i.e., direction) of a segment to isolate\n     * the relative transformation represented by the segment. This operation\n     * may or may not succeed due to singularities in the equations that define\n     * motion relativity in this context.\n     * @param priorVec the origin of the prior segment\n     * @param fromVec the origin of the current segment\n     * @param toVec the destination of the current segment\n     * @param result reference to output variable\n     * @returns whether or not transformation was successful\n     */\n    Trajectory._TransformSegmentDirToRef = function (priorVec, fromVec, toVec, result) {\n        var DOT_PRODUCT_SAMPLE_REJECTION_THRESHOLD = 0.98;\n        fromVec.subtractToRef(priorVec, Trajectory._ForwardDir);\n        Trajectory._ForwardDir.normalize();\n        fromVec.scaleToRef(-1, Trajectory._InverseFromVec);\n        Trajectory._InverseFromVec.normalize();\n        if (Math.abs(Vector3.Dot(Trajectory._ForwardDir, Trajectory._InverseFromVec)) > DOT_PRODUCT_SAMPLE_REJECTION_THRESHOLD) {\n            return false;\n        }\n        Vector3.CrossToRef(Trajectory._ForwardDir, Trajectory._InverseFromVec, Trajectory._UpDir);\n        Trajectory._UpDir.normalize();\n        Matrix.LookAtLHToRef(priorVec, fromVec, Trajectory._UpDir, Trajectory._LookMatrix);\n        toVec.subtractToRef(fromVec, Trajectory._FromToVec);\n        Trajectory._FromToVec.normalize();\n        Vector3.TransformNormalToRef(Trajectory._FromToVec, Trajectory._LookMatrix, result);\n        return true;\n    };\n    /**\n     * Determine which token vector is most similar to the\n     * segment vector.\n     * @param segment segment vector\n     * @param tokens token vector list\n     * @returns index of the most similar token to the segment\n     */\n    Trajectory._TokenizeSegment = function (segment, tokens) {\n        Trajectory._BestMatch = 0;\n        Trajectory._Score = Vector3.Dot(segment, tokens[0]);\n        Trajectory._BestScore = Trajectory._Score;\n        for (var idx = 1; idx < tokens.length; ++idx) {\n            Trajectory._Score = Vector3.Dot(segment, tokens[idx]);\n            if (Trajectory._Score > Trajectory._BestScore) {\n                Trajectory._BestMatch = idx;\n                Trajectory._BestScore = Trajectory._Score;\n            }\n        }\n        return Trajectory._BestMatch;\n    };\n    Trajectory._ForwardDir = new Vector3();\n    Trajectory._InverseFromVec = new Vector3();\n    Trajectory._UpDir = new Vector3();\n    Trajectory._FromToVec = new Vector3();\n    Trajectory._LookMatrix = new Matrix();\n    return Trajectory;\n}());\nexport { Trajectory };\n/**\n * Collection of vectors intended to be used as the basis of Trajectory\n * tokenization for Levenshtein distance comparison. Canonically, a\n * Vector3Alphabet will resemble a \"spikeball\" of vectors distributed\n * roughly evenly over the surface of the unit sphere.\n */\nvar Vector3Alphabet = /** @class */ (function () {\n    function Vector3Alphabet(size) {\n        this.chars = new Array(size);\n    }\n    /**\n     * Helper method to create new \"spikeball\" Vector3Alphabets. Uses a naive\n     * optimize-from-random strategy to space points around the unit sphere\n     * surface as a simple alternative to really doing the math to tile the\n     * sphere.\n     * @param alphabetSize size of the desired alphabet\n     * @param iterations number of iterations over which to optimize the \"spikeball\"\n     * @param startingStepSize distance factor to move points in early optimization iterations\n     * @param endingStepSize distance factor to move points in late optimization iterations\n     * @param fixedValues alphabet \"characters\" that are required and cannot be moved by optimization\n     * @returns a new randomly generated and optimized Vector3Alphabet of the specified size\n     */\n    Vector3Alphabet.Generate = function (alphabetSize, iterations, startingStepSize, endingStepSize, fixedValues) {\n        if (alphabetSize === void 0) { alphabetSize = 64; }\n        if (iterations === void 0) { iterations = 256; }\n        if (startingStepSize === void 0) { startingStepSize = 0.1; }\n        if (endingStepSize === void 0) { endingStepSize = 0.001; }\n        if (fixedValues === void 0) { fixedValues = []; }\n        var EPSILON = 0.001;\n        var EPSILON_SQUARED = EPSILON * EPSILON;\n        var alphabet = new Vector3Alphabet(alphabetSize);\n        for (var idx = 0; idx < alphabetSize; ++idx) {\n            alphabet.chars[idx] = new Vector3(Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5);\n            alphabet.chars[idx].normalize();\n        }\n        for (var idx = 0; idx < fixedValues.length; ++idx) {\n            alphabet.chars[idx].copyFrom(fixedValues[idx]);\n        }\n        var stepSize;\n        var distSq;\n        var force = new Vector3();\n        var scratch = new Vector3();\n        var lerp = function (l, r, t) { return (1.0 - t) * l + t * r; };\n        for (var iteration = 0; iteration < iterations; ++iteration) {\n            stepSize = lerp(startingStepSize, endingStepSize, iteration / (iterations - 1));\n            var _loop_1 = function (idx) {\n                force.copyFromFloats(0, 0, 0);\n                alphabet.chars.forEach(function (pt) {\n                    alphabet.chars[idx].subtractToRef(pt, scratch);\n                    distSq = scratch.lengthSquared();\n                    if (distSq > EPSILON_SQUARED) {\n                        scratch.scaleAndAddToRef(1 / (scratch.lengthSquared() * distSq), force);\n                    }\n                });\n                force.scaleInPlace(stepSize);\n                alphabet.chars[idx].addInPlace(force);\n                alphabet.chars[idx].normalize();\n            };\n            for (var idx = fixedValues.length; idx < alphabet.chars.length; ++idx) {\n                _loop_1(idx);\n            }\n        }\n        return alphabet;\n    };\n    /**\n     * Serialize to JSON.\n     * @returns JSON serialization\n     */\n    Vector3Alphabet.prototype.serialize = function () {\n        return JSON.stringify(this.chars);\n    };\n    /**\n     * Deserialize from JSON.\n     * @param json JSON serialization\n     * @returns deserialized Vector3Alphabet\n     */\n    Vector3Alphabet.Deserialize = function (json) {\n        var jsonObject = JSON.parse(json);\n        var alphabet = new Vector3Alphabet(jsonObject.length);\n        for (var idx = 0; idx < jsonObject.length; ++idx) {\n            alphabet.chars[idx] = new Vector3(jsonObject[idx][\"_x\"], jsonObject[idx][\"_y\"], jsonObject[idx][\"_z\"]);\n        }\n        return alphabet;\n    };\n    return Vector3Alphabet;\n}());\n/**\n * Class which formalizes the manner in which a Vector3Alphabet is used to tokenize and\n * describe a Trajectory. This class houses the functionality which determines what\n * attributes of Trajectories are and are not considered important, such as scale.\n */\nvar TrajectoryDescriptor = /** @class */ (function () {\n    function TrajectoryDescriptor() {\n        this._sequences = [];\n    }\n    /**\n     * Serialize to JSON.\n     * @returns JSON serialization\n     */\n    TrajectoryDescriptor.prototype.serialize = function () {\n        return JSON.stringify(this._sequences.map(function (sequence) { return sequence.serialize(); }));\n    };\n    /**\n     * Deserialize from JSON string and Alphabet. This should be the same Alphabet\n     * from which the descriptor was originally created, which must be serialized and\n     * deserialized independently so that it can be passed in here.\n     * @param json JSON serialization\n     * @param alphabet Alphabet from which descriptor was originally created\n     * @returns deserialized TrajectoryDescriptor\n     */\n    TrajectoryDescriptor.Deserialize = function (json, alphabet) {\n        var descriptor = new TrajectoryDescriptor();\n        descriptor._sequences = JSON.parse(json).map(function (s) { return Levenshtein.Sequence.Deserialize(s, alphabet); });\n        return descriptor;\n    };\n    /**\n     * Create a new TrajectoryDescriptor to describe a provided Trajectory according\n     * to the provided alphabets.\n     * @param trajectory Trajectory to be described\n     * @param vector3Alphabet Vector3Alphabet to be used to tokenize the Trajectory\n     * @param levenshteinAlphabet Levenshtein.Alphabet to be used as basis for comparison with other descriptors\n     * @returns TrajectoryDescriptor describing provided Trajectory\n     */\n    TrajectoryDescriptor.CreateFromTrajectory = function (trajectory, vector3Alphabet, levenshteinAlphabet) {\n        return TrajectoryDescriptor.CreateFromTokenizationPyramid(TrajectoryDescriptor._GetTokenizationPyramid(trajectory, vector3Alphabet), levenshteinAlphabet);\n    };\n    /**\n     * Create a new TrajectoryDescriptor from a pre-existing pyramid of tokens.\n     * NOTE: This function exists to support an outdated serialization mechanism and should\n     * be deleted if it is no longer useful.\n     * @param pyramid tokenization pyramid\n     * @param levenshteinAlphabet Levenshtein.Alphabet to be uses as basis for comparison with other descriptors\n     * @returns TrajectoryDescriptor describing the Trajectory from which the pyramid was built\n     */\n    TrajectoryDescriptor.CreateFromTokenizationPyramid = function (pyramid, levenshteinAlphabet) {\n        var descriptor = new TrajectoryDescriptor();\n        descriptor._sequences = pyramid.map(function (tokens) { return new Levenshtein.Sequence(tokens, levenshteinAlphabet); });\n        return descriptor;\n    };\n    /**\n     * Create the tokenization pyramid for the provided Trajectory according to the given\n     * Vector3Alphabet.\n     * @param trajectory Trajectory to be tokenized\n     * @param alphabet Vector3Alphabet containing tokens\n     * @param targetResolution finest resolution of descriptor\n     * @returns tokenization pyramid for Trajectory\n     */\n    TrajectoryDescriptor._GetTokenizationPyramid = function (trajectory, alphabet, targetResolution) {\n        if (targetResolution === void 0) { targetResolution = TrajectoryDescriptor._FINEST_DESCRIPTOR_RESOLUTION; }\n        var pyramid = [];\n        for (var res = targetResolution; res > 4; res = Math.floor(res / 2)) {\n            pyramid.push(trajectory.resampleAtTargetResolution(res).tokenize(alphabet.chars));\n        }\n        return pyramid;\n    };\n    /**\n     * Calculate a distance metric between this TrajectoryDescriptor and another. This is\n     * essentially a similarity score and does not directly represent Euclidean distance,\n     * edit distance, or any other formal distance metric.\n     * @param other TrajectoryDescriptor from which to determine distance\n     * @returns distance, a nonnegative similarity score where larger values indicate dissimilarity\n     */\n    TrajectoryDescriptor.prototype.distance = function (other) {\n        var totalDistance = 0;\n        var weight;\n        for (var idx = 0; idx < this._sequences.length; ++idx) {\n            weight = Math.pow(2, idx);\n            totalDistance += weight * this._sequences[idx].distance(other._sequences[idx]);\n        }\n        return totalDistance;\n    };\n    TrajectoryDescriptor._FINEST_DESCRIPTOR_RESOLUTION = 32;\n    return TrajectoryDescriptor;\n}());\n/**\n * A set of TrajectoryDescriptors defined to be \"the same.\" This is essentially a helper\n * class to facilitate methods of Trajectory clustering.\n */\nvar TrajectoryClass = /** @class */ (function () {\n    /**\n     * Create a new DescribedTrajectory.\n     * @param descriptors currently-known TrajectoryDescriptors, if any\n     */\n    function TrajectoryClass(descriptors) {\n        if (descriptors === void 0) { descriptors = []; }\n        this._descriptors = descriptors;\n        this._centroidIdx = -1;\n        this._averageDistance = 0;\n        this._refreshDescription();\n    }\n    /**\n     * Serialize to JSON.\n     * @returns JSON serialization\n     */\n    TrajectoryClass.prototype.serialize = function () {\n        var jsonObject = {};\n        jsonObject.descriptors = this._descriptors.map(function (desc) { return desc.serialize(); });\n        jsonObject.centroidIdx = this._centroidIdx;\n        jsonObject.averageDistance = this._averageDistance;\n        return JSON.stringify(jsonObject);\n    };\n    /**\n     * Deserialize from JSON string and Alphabet. This should be the same Alphabet\n     * from which the descriptors were originally created, which must be serialized and\n     * deserialized independently so that it can be passed in here.\n     * @param json JSON string representation\n     * @param alphabet Alphabet from which TrajectoryDescriptors were originally created\n     * @returns deserialized TrajectoryDescriptor\n     */\n    TrajectoryClass.Deserialize = function (json, alphabet) {\n        var jsonObject = JSON.parse(json);\n        var described = new TrajectoryClass();\n        described._descriptors = jsonObject.descriptors.map(function (s) { return TrajectoryDescriptor.Deserialize(s, alphabet); });\n        described._centroidIdx = jsonObject.centroidIdx;\n        described._averageDistance = jsonObject.averageDistance;\n        return described;\n    };\n    /**\n     * Add a new TrajectoryDescriptor to the list of descriptors known to describe\n     * this same DescribedTrajectory.\n     * @param descriptor descriptor to be added\n     */\n    TrajectoryClass.prototype.add = function (descriptor) {\n        this._descriptors.push(descriptor);\n        this._refreshDescription();\n    };\n    /**\n     * Compute the cost, which is inversely related to the likelihood that the provided\n     * TrajectoryDescriptor describes a Trajectory that is considered to be the same as\n     * the class represented by this DescribedTrajectory.\n     * @param descriptor the descriptor to be costed\n     * @returns cost of the match, which is a nonnegative similarity metric where larger values indicate dissimilarity\n     */\n    TrajectoryClass.prototype.getMatchCost = function (descriptor) {\n        return descriptor.distance(this._descriptors[this._centroidIdx]) / this._averageDistance;\n    };\n    /**\n     * Compute the minimum distance between the queried TrajectoryDescriptor and a\n     * descriptor which is a member of this collection. This is an alternative way of\n     * conceptualizing match cost from getMatchCost(), and it serves a different function.\n     * @param descriptor the descriptor to find the minimum distance to\n     * @returns minimum descriptor distance to a member descriptor of this DescribedTrajectory\n     */\n    TrajectoryClass.prototype.getMatchMinimumDistance = function (descriptor) {\n        return Math.min.apply(Math, this._descriptors.map(function (desc) { return desc.distance(descriptor); }));\n    };\n    /**\n     * Refreshes the internal representation of this DescribedTrajectory.\n     */\n    TrajectoryClass.prototype._refreshDescription = function () {\n        var _this = this;\n        this._centroidIdx = -1;\n        var sum;\n        var distances = this._descriptors.map(function (a) {\n            sum = 0;\n            _this._descriptors.forEach(function (b) {\n                sum += a.distance(b);\n            });\n            return sum;\n        });\n        for (var idx = 0; idx < distances.length; ++idx) {\n            if (this._centroidIdx < 0 || distances[idx] < distances[this._centroidIdx]) {\n                this._centroidIdx = idx;\n            }\n        }\n        this._averageDistance = 0;\n        this._descriptors.forEach(function (desc) {\n            _this._averageDistance += desc.distance(_this._descriptors[_this._centroidIdx]);\n        });\n        if (this._descriptors.length > 0) {\n            this._averageDistance = Math.max(this._averageDistance / this._descriptors.length, TrajectoryClass._MIN_AVERAGE_DISTANCE);\n        }\n    };\n    TrajectoryClass._MIN_AVERAGE_DISTANCE = 1;\n    return TrajectoryClass;\n}());\n/**\n * Class representing a set of known, named trajectories to which Trajectories can be\n * added and using which Trajectories can be recognized.\n */\nvar TrajectoryClassifier = /** @class */ (function () {\n    function TrajectoryClassifier() {\n        this._maximumAllowableMatchCost = 4;\n        this._nameToDescribedTrajectory = new Map();\n    }\n    /**\n     * Serialize to JSON.\n     * @returns JSON serialization\n     */\n    TrajectoryClassifier.prototype.serialize = function () {\n        var jsonObject = {};\n        jsonObject.maximumAllowableMatchCost = this._maximumAllowableMatchCost;\n        jsonObject.vector3Alphabet = this._vector3Alphabet.serialize();\n        jsonObject.levenshteinAlphabet = this._levenshteinAlphabet.serialize();\n        jsonObject.nameToDescribedTrajectory = [];\n        this._nameToDescribedTrajectory.forEach(function (described, name) {\n            jsonObject.nameToDescribedTrajectory.push(name);\n            jsonObject.nameToDescribedTrajectory.push(described.serialize());\n        });\n        return JSON.stringify(jsonObject);\n    };\n    /**\n     * Deserialize from JSON.\n     * @param json JSON serialization\n     * @returns deserialized TrajectorySet\n     */\n    TrajectoryClassifier.Deserialize = function (json) {\n        var jsonObject = JSON.parse(json);\n        var classifier = new TrajectoryClassifier();\n        classifier._maximumAllowableMatchCost = jsonObject.maximumAllowableMatchCost;\n        classifier._vector3Alphabet = Vector3Alphabet.Deserialize(jsonObject.vector3Alphabet);\n        classifier._levenshteinAlphabet = Levenshtein.Alphabet.Deserialize(jsonObject.levenshteinAlphabet);\n        for (var idx = 0; idx < jsonObject.nameToDescribedTrajectory.length; idx += 2) {\n            classifier._nameToDescribedTrajectory.set(jsonObject.nameToDescribedTrajectory[idx], TrajectoryClass.Deserialize(jsonObject.nameToDescribedTrajectory[idx + 1], classifier._levenshteinAlphabet));\n        }\n        return classifier;\n    };\n    /**\n     * Initialize a new empty TrajectorySet with auto-generated Alphabets.\n     * VERY naive, need to be generating these things from known\n     * sets. Better version later, probably eliminating this one.\n     * @returns auto-generated TrajectorySet\n     */\n    TrajectoryClassifier.Generate = function () {\n        var vecs = Vector3Alphabet.Generate(64, 256, 0.1, 0.001, [Vector3.Forward()]);\n        var charIdxs = new Array(vecs.chars.length);\n        for (var idx = 0; idx < charIdxs.length; ++idx) {\n            charIdxs[idx] = idx;\n        }\n        var alphabet = new Levenshtein.Alphabet(charIdxs, function (idx) { return (idx === 0 ? 0 : 1); }, function (idx) { return (idx === 0 ? 0 : 1); }, function (a, b) { return Math.min(1 - Vector3.Dot(vecs.chars[a], vecs.chars[b]), 1); });\n        var trajectorySet = new TrajectoryClassifier();\n        trajectorySet._vector3Alphabet = vecs;\n        trajectorySet._levenshteinAlphabet = alphabet;\n        return trajectorySet;\n    };\n    /**\n     * Add a new Trajectory to the set with a given name.\n     * @param trajectory new Trajectory to be added\n     * @param classification name to which to add the Trajectory\n     */\n    TrajectoryClassifier.prototype.addTrajectoryToClassification = function (trajectory, classification) {\n        if (!this._nameToDescribedTrajectory.has(classification)) {\n            this._nameToDescribedTrajectory.set(classification, new TrajectoryClass());\n        }\n        this._nameToDescribedTrajectory.get(classification).add(TrajectoryDescriptor.CreateFromTrajectory(trajectory, this._vector3Alphabet, this._levenshteinAlphabet));\n    };\n    /**\n     * Remove a known named trajectory and all Trajectories associated with it.\n     * @param classification name to remove\n     * @returns whether anything was removed\n     */\n    TrajectoryClassifier.prototype.deleteClassification = function (classification) {\n        return this._nameToDescribedTrajectory.delete(classification);\n    };\n    /**\n     * Attempt to recognize a Trajectory from among all the classifications\n     * already known to the classifier.\n     * @param trajectory Trajectory to be recognized\n     * @returns classification of Trajectory if recognized, null otherwise\n     */\n    TrajectoryClassifier.prototype.classifyTrajectory = function (trajectory) {\n        var _this = this;\n        var descriptor = TrajectoryDescriptor.CreateFromTrajectory(trajectory, this._vector3Alphabet, this._levenshteinAlphabet);\n        var allowableMatches = [];\n        this._nameToDescribedTrajectory.forEach(function (trajectoryClass, classification) {\n            if (trajectoryClass.getMatchCost(descriptor) < _this._maximumAllowableMatchCost) {\n                allowableMatches.push(classification);\n            }\n        });\n        if (allowableMatches.length === 0) {\n            return null;\n        }\n        var bestIdx = 0;\n        var bestMatch = this._nameToDescribedTrajectory.get(allowableMatches[bestIdx]).getMatchMinimumDistance(descriptor);\n        var match;\n        for (var idx = 0; idx < allowableMatches.length; ++idx) {\n            match = this._nameToDescribedTrajectory.get(allowableMatches[idx]).getMatchMinimumDistance(descriptor);\n            if (match < bestMatch) {\n                bestMatch = match;\n                bestIdx = idx;\n            }\n        }\n        return allowableMatches[bestIdx];\n    };\n    return TrajectoryClassifier;\n}());\nexport { TrajectoryClassifier };\n//# sourceMappingURL=trajectoryClassifier.js.map","/**\n * Class for storing data to local storage if available or in-memory storage otherwise\n */\nvar DataStorage = /** @class */ (function () {\n    function DataStorage() {\n    }\n    DataStorage._GetStorage = function () {\n        try {\n            localStorage.setItem(\"test\", \"\");\n            localStorage.removeItem(\"test\");\n            return localStorage;\n        }\n        catch (_a) {\n            var inMemoryStorage_1 = {};\n            return {\n                getItem: function (key) {\n                    var value = inMemoryStorage_1[key];\n                    return value === undefined ? null : value;\n                },\n                setItem: function (key, value) {\n                    inMemoryStorage_1[key] = value;\n                },\n            };\n        }\n    };\n    /**\n     * Reads a string from the data storage\n     * @param key The key to read\n     * @param defaultValue The value if the key doesn't exist\n     * @returns The string value\n     */\n    DataStorage.ReadString = function (key, defaultValue) {\n        var value = this._Storage.getItem(key);\n        return value !== null ? value : defaultValue;\n    };\n    /**\n     * Writes a string to the data storage\n     * @param key The key to write\n     * @param value The value to write\n     */\n    DataStorage.WriteString = function (key, value) {\n        this._Storage.setItem(key, value);\n    };\n    /**\n     * Reads a boolean from the data storage\n     * @param key The key to read\n     * @param defaultValue The value if the key doesn't exist\n     * @returns The boolean value\n     */\n    DataStorage.ReadBoolean = function (key, defaultValue) {\n        var value = this._Storage.getItem(key);\n        return value !== null ? value === \"true\" : defaultValue;\n    };\n    /**\n     * Writes a boolean to the data storage\n     * @param key The key to write\n     * @param value The value to write\n     */\n    DataStorage.WriteBoolean = function (key, value) {\n        this._Storage.setItem(key, value ? \"true\" : \"false\");\n    };\n    /**\n     * Reads a number from the data storage\n     * @param key The key to read\n     * @param defaultValue The value if the key doesn't exist\n     * @returns The number value\n     */\n    DataStorage.ReadNumber = function (key, defaultValue) {\n        var value = this._Storage.getItem(key);\n        return value !== null ? parseFloat(value) : defaultValue;\n    };\n    /**\n     * Writes a number to the data storage\n     * @param key The key to write\n     * @param value The value to write\n     */\n    DataStorage.WriteNumber = function (key, value) {\n        this._Storage.setItem(key, value.toString());\n    };\n    DataStorage._Storage = DataStorage._GetStorage();\n    return DataStorage;\n}());\nexport { DataStorage };\n//# sourceMappingURL=dataStorage.js.map","import { SceneSerializer } from \"./sceneSerializer.js\";\nimport { Mesh } from \"../Meshes/mesh.js\";\nimport { Light } from \"../Lights/light.js\";\nimport { Camera } from \"../Cameras/camera.js\";\nimport { Skeleton } from \"../Bones/skeleton.js\";\nimport { Material } from \"../Materials/material.js\";\nimport { MultiMaterial } from \"../Materials/multiMaterial.js\";\nimport { TransformNode } from \"../Meshes/transformNode.js\";\nimport { ParticleSystem } from \"../Particles/particleSystem.js\";\nimport { MorphTargetManager } from \"../Morph/morphTargetManager.js\";\nimport { ShadowGenerator } from \"../Lights/Shadows/shadowGenerator.js\";\nimport { PostProcess } from \"../PostProcesses/postProcess.js\";\nimport { Texture } from \"../Materials/Textures/texture.js\";\nimport { SerializationHelper } from \"./decorators.js\";\n/**\n * Class used to record delta files between 2 scene states\n */\nvar SceneRecorder = /** @class */ (function () {\n    function SceneRecorder() {\n        this._trackedScene = null;\n    }\n    /**\n     * Track a given scene. This means the current scene state will be considered the original state\n     * @param scene defines the scene to track\n     */\n    SceneRecorder.prototype.track = function (scene) {\n        this._trackedScene = scene;\n        SerializationHelper.AllowLoadingUniqueId = true;\n        this._savedJSON = SceneSerializer.Serialize(scene);\n        SerializationHelper.AllowLoadingUniqueId = false;\n    };\n    /**\n     * Get the delta between current state and original state\n     * @returns a any containing the delta\n     */\n    SceneRecorder.prototype.getDelta = function () {\n        if (!this._trackedScene) {\n            return null;\n        }\n        var currentForceSerializeBuffers = Texture.ForceSerializeBuffers;\n        Texture.ForceSerializeBuffers = false;\n        SerializationHelper.AllowLoadingUniqueId = true;\n        var newJSON = SceneSerializer.Serialize(this._trackedScene);\n        SerializationHelper.AllowLoadingUniqueId = false;\n        var deltaJSON = {};\n        for (var node in newJSON) {\n            this._compareCollections(node, this._savedJSON[node], newJSON[node], deltaJSON);\n        }\n        Texture.ForceSerializeBuffers = currentForceSerializeBuffers;\n        return deltaJSON;\n    };\n    SceneRecorder.prototype._compareArray = function (key, original, current, deltaJSON) {\n        if (original.length === 0 && current.length === 0) {\n            return true;\n        }\n        // Numbers?\n        if ((original.length && !isNaN(original[0])) || (current.length && !isNaN(current[0]))) {\n            if (original.length !== current.length) {\n                return false;\n            }\n            if (original.length === 0) {\n                return true;\n            }\n            for (var index = 0; index < original.length; index++) {\n                if (original[index] !== current[index]) {\n                    deltaJSON[key] = current;\n                    return false;\n                }\n            }\n            return true;\n        }\n        // let's use uniqueId to find similar objects\n        var originalUniqueIds = [];\n        var _loop_1 = function (index) {\n            var originalObject = original[index];\n            var originalUniqueId = originalObject.uniqueId;\n            originalUniqueIds.push(originalUniqueId);\n            // Look for that object in current state\n            var currentObjects = current.filter(function (c) { return c.uniqueId === originalUniqueId; });\n            if (currentObjects.length) {\n                // We have a candidate\n                var currentObject = currentObjects[0];\n                var newObject = {};\n                if (!this_1._compareObjects(originalObject, currentObject, newObject)) {\n                    if (!deltaJSON[key]) {\n                        deltaJSON[key] = [];\n                    }\n                    newObject.__state = {\n                        id: currentObject.id || currentObject.name,\n                    };\n                    deltaJSON[key].push(newObject);\n                }\n            }\n            else {\n                // We need to delete\n                var newObject = {\n                    __state: {\n                        deleteId: originalObject.id || originalObject.name,\n                    },\n                };\n                deltaJSON[key].push(newObject);\n            }\n        };\n        var this_1 = this;\n        for (var index = 0; index < original.length; index++) {\n            _loop_1(index);\n        }\n        // Checking for new objects\n        for (var index = 0; index < current.length; index++) {\n            var currentObject = current[index];\n            var currentUniqueId = currentObject.uniqueId;\n            // Object was added\n            if (originalUniqueIds.indexOf(currentUniqueId) === -1) {\n                if (!deltaJSON[key]) {\n                    deltaJSON[key] = [];\n                }\n                deltaJSON[key].push(currentObject);\n            }\n        }\n        return true;\n    };\n    SceneRecorder.prototype._compareObjects = function (originalObjet, currentObject, deltaJSON) {\n        var aDifferenceWasFound = false;\n        for (var prop in originalObjet) {\n            if (!Object.prototype.hasOwnProperty.call(originalObjet, prop)) {\n                continue;\n            }\n            var originalValue = originalObjet[prop];\n            var currentValue = currentObject[prop];\n            var diffFound = false;\n            if (Array.isArray(originalValue)) {\n                diffFound = JSON.stringify(originalValue) !== JSON.stringify(currentValue);\n            }\n            else if (!isNaN(originalValue) || Object.prototype.toString.call(originalValue) == \"[object String]\") {\n                diffFound = originalValue !== currentValue;\n            }\n            else if (typeof originalValue === \"object\" && typeof currentValue === \"object\") {\n                var newObject = {};\n                if (!this._compareObjects(originalValue, currentValue, newObject)) {\n                    deltaJSON[prop] = newObject;\n                    aDifferenceWasFound = true;\n                }\n            }\n            if (diffFound) {\n                aDifferenceWasFound = true;\n                deltaJSON[prop] = currentValue;\n            }\n        }\n        return !aDifferenceWasFound;\n    };\n    SceneRecorder.prototype._compareCollections = function (key, original, current, deltaJSON) {\n        // Same ?\n        if (original === current) {\n            return;\n        }\n        if (original && current) {\n            // Array?\n            if (Array.isArray(original) && Array.isArray(current)) {\n                if (this._compareArray(key, original, current, deltaJSON)) {\n                    return;\n                }\n            }\n            else if (typeof original === \"object\" && typeof current === \"object\") {\n                // Object\n                var newObject = {};\n                if (!this._compareObjects(original, current, newObject)) {\n                    deltaJSON[key] = newObject;\n                }\n                return;\n            }\n        }\n    };\n    SceneRecorder.GetShadowGeneratorById = function (scene, id) {\n        var generators = scene.lights.map(function (l) { return l.getShadowGenerator(); });\n        for (var _i = 0, generators_1 = generators; _i < generators_1.length; _i++) {\n            var generator = generators_1[_i];\n            if (generator && generator.id === id) {\n                return generator;\n            }\n        }\n        return null;\n    };\n    /**\n     * Apply a given delta to a given scene\n     * @param deltaJSON defines the JSON containing the delta\n     * @param scene defines the scene to apply the delta to\n     */\n    SceneRecorder.ApplyDelta = function (deltaJSON, scene) {\n        var _this = this;\n        if (typeof deltaJSON === \"string\") {\n            deltaJSON = JSON.parse(deltaJSON);\n        }\n        // Scene\n        var anyScene = scene;\n        for (var prop in deltaJSON) {\n            var source = deltaJSON[prop];\n            var property = anyScene[prop];\n            if (Array.isArray(property) || prop === \"shadowGenerators\") {\n                // Restore array\n                switch (prop) {\n                    case \"cameras\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getCameraById.bind(scene), function (data) { return Camera.Parse(data, scene); });\n                        break;\n                    case \"lights\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getLightById.bind(scene), function (data) { return Light.Parse(data, scene); });\n                        break;\n                    case \"shadowGenerators\":\n                        this._ApplyDeltaForEntity(source, scene, function (id) { return _this.GetShadowGeneratorById(scene, id); }, function (data) { return ShadowGenerator.Parse(data, scene); });\n                        break;\n                    case \"meshes\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getMeshById.bind(scene), function (data) { return Mesh.Parse(data, scene, \"\"); });\n                        break;\n                    case \"skeletons\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getSkeletonById.bind(scene), function (data) { return Skeleton.Parse(data, scene); });\n                        break;\n                    case \"materials\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getMaterialById.bind(scene), function (data) { return Material.Parse(data, scene, \"\"); });\n                        break;\n                    case \"multiMaterials\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getMaterialById.bind(scene), function (data) { return MultiMaterial.Parse(data, scene, \"\"); });\n                        break;\n                    case \"transformNodes\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getTransformNodeById.bind(scene), function (data) { return TransformNode.Parse(data, scene, \"\"); });\n                        break;\n                    case \"particleSystems\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getParticleSystemById.bind(scene), function (data) { return ParticleSystem.Parse(data, scene, \"\"); });\n                        break;\n                    case \"morphTargetManagers\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getMorphTargetById.bind(scene), function (data) { return MorphTargetManager.Parse(data, scene); });\n                        break;\n                    case \"postProcesses\":\n                        this._ApplyDeltaForEntity(source, scene, scene.getPostProcessByName.bind(scene), function (data) { return PostProcess.Parse(data, scene, \"\"); });\n                        break;\n                }\n            }\n            else if (!isNaN(property)) {\n                anyScene[prop] = source;\n            }\n            else if (property.fromArray) {\n                property.fromArray(source);\n            }\n        }\n    };\n    SceneRecorder._ApplyPropertiesToEntity = function (deltaJSON, entity) {\n        for (var prop in deltaJSON) {\n            var source = deltaJSON[prop];\n            var property = entity[prop];\n            if (property === undefined) {\n                continue;\n            }\n            if (!isNaN(property) || Array.isArray(property)) {\n                entity[prop] = source;\n            }\n            else if (property.fromArray) {\n                property.fromArray(source);\n            }\n            else if (typeof property === \"object\" && property !== null) {\n                this._ApplyPropertiesToEntity(source, property);\n            }\n        }\n    };\n    SceneRecorder._ApplyDeltaForEntity = function (sources, scene, finder, addNew) {\n        for (var _i = 0, sources_1 = sources; _i < sources_1.length; _i++) {\n            var source = sources_1[_i];\n            // Update\n            if (source.__state && source.__state.id !== undefined) {\n                var targetEntity = finder(source.__state.id);\n                if (targetEntity) {\n                    this._ApplyPropertiesToEntity(source, targetEntity);\n                }\n            }\n            else if (source.__state && source.__state.deleteId !== undefined) {\n                var target = finder(source.__state.deleteId);\n                target === null || target === void 0 ? void 0 : target.dispose();\n            }\n            else {\n                // New\n                addNew(source);\n            }\n        }\n    };\n    return SceneRecorder;\n}());\nexport { SceneRecorder };\n//# sourceMappingURL=sceneRecorder.js.map","import { Logger } from \"./logger.js\";\nimport { SceneSerializer } from \"./sceneSerializer.js\";\n/**\n * Class used to connect with the reflector zone of the sandbox via the reflector bridge\n * @since 5.0.0\n */\nvar Reflector = /** @class */ (function () {\n    /**\n     * Constructs a reflector object.\n     * @param scene The scene to use\n     * @param hostname The hostname of the reflector bridge\n     * @param port The port of the reflector bridge\n     */\n    function Reflector(scene, hostname, port) {\n        var _this = this;\n        this._scene = scene;\n        Logger.Log(\"[Reflector] Connecting to ws://\".concat(hostname, \":\").concat(port));\n        this._webSocket = new WebSocket(\"ws://\".concat(hostname, \":\").concat(port));\n        this._webSocket.onmessage = function (event) {\n            var message = event.data;\n            if (message.startsWith(Reflector._SERVER_PREFIX)) {\n                var serverMessage = message.substr(Reflector._SERVER_PREFIX.length);\n                Logger.Log(\"[Reflector] Received server message: \".concat(serverMessage.substr(0, 64)));\n                _this._handleServerMessage(serverMessage);\n                return;\n            }\n            else {\n                Logger.Log(\"[Reflector] Received client message: \".concat(message.substr(0, 64)));\n                _this._handleClientMessage();\n            }\n        };\n        this._webSocket.onclose = function (event) {\n            Logger.Log(\"[Reflector] Disconnected \".concat(event.code, \" \").concat(event.reason));\n        };\n    }\n    /**\n     * Closes the reflector connection\n     */\n    Reflector.prototype.close = function () {\n        this._webSocket.close();\n    };\n    Reflector.prototype._handleServerMessage = function (message) {\n        var _this = this;\n        switch (message) {\n            case \"connected\": {\n                SceneSerializer.SerializeAsync(this._scene).then(function (serialized) {\n                    _this._webSocket.send(\"load|\".concat(JSON.stringify(serialized)));\n                });\n                break;\n            }\n        }\n    };\n    Reflector.prototype._handleClientMessage = function () {\n        // do nothing\n    };\n    Reflector._SERVER_PREFIX = \"$$\";\n    return Reflector;\n}());\nexport { Reflector };\n//# sourceMappingURL=reflector.js.map","var growthFactor = 1.5;\n/**\n * A class acting as a dynamic float32array used in the performance viewer\n */\nvar DynamicFloat32Array = /** @class */ (function () {\n    /**\n     * Creates a new DynamicFloat32Array with the desired item capacity.\n     * @param itemCapacity The initial item capacity you would like to set for the array.\n     */\n    function DynamicFloat32Array(itemCapacity) {\n        this._view = new Float32Array(itemCapacity);\n        this._itemLength = 0;\n    }\n    Object.defineProperty(DynamicFloat32Array.prototype, \"itemLength\", {\n        /**\n         * The number of items currently in the array.\n         */\n        get: function () {\n            return this._itemLength;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets value at index, NaN if no such index exists.\n     * @param index the index to get the value at.\n     * @returns the value at the index provided.\n     */\n    DynamicFloat32Array.prototype.at = function (index) {\n        if (index < 0 || index >= this._itemLength) {\n            return NaN;\n        }\n        return this._view[index];\n    };\n    /**\n     * Gets a view of the original array from start to end (exclusive of end).\n     * @param start starting index.\n     * @param end ending index.\n     * @returns a subarray of the original array.\n     */\n    DynamicFloat32Array.prototype.subarray = function (start, end) {\n        if (start >= end || start < 0) {\n            return new Float32Array(0);\n        }\n        if (end > this._itemLength) {\n            end = this._itemLength;\n        }\n        return this._view.subarray(start, end);\n    };\n    /**\n     * Pushes items to the end of the array.\n     * @param item The item to push into the array.\n     */\n    DynamicFloat32Array.prototype.push = function (item) {\n        this._view[this._itemLength] = item;\n        this._itemLength++;\n        if (this._itemLength >= this._view.length) {\n            this._growArray();\n        }\n    };\n    /**\n     * Grows the array by the growth factor when necessary.\n     */\n    DynamicFloat32Array.prototype._growArray = function () {\n        var newCapacity = Math.floor(this._view.length * growthFactor);\n        var view = new Float32Array(newCapacity);\n        view.set(this._view);\n        this._view = view;\n    };\n    return DynamicFloat32Array;\n}());\nexport { DynamicFloat32Array };\n//# sourceMappingURL=dynamicFloat32Array.js.map","import { EventState, Observable } from \"../observable.js\";\nimport { PrecisionDate } from \"../precisionDate.js\";\nimport { Tools } from \"../tools.js\";\nimport { DynamicFloat32Array } from \"./dynamicFloat32Array.js\";\n// the initial size of our array, should be a multiple of two!\nvar InitialArraySize = 1800;\n// three octets in a hexcode. #[AA][BB][CC], i.e. 24 bits of data.\nvar NumberOfBitsInHexcode = 24;\n// Allows single numeral hex numbers to be appended by a 0.\nvar HexPadding = \"0\";\n// header for the timestamp column\nvar TimestampColHeader = \"timestamp\";\n// header for the numPoints column\nvar NumPointsColHeader = \"numPoints\";\n// regex to capture all carriage returns in the string.\nvar CarriageReturnRegex = /\\r/g;\n// string to use as separator when exporting extra information along with the dataset id\nvar ExportedDataSeparator = \"@\";\n/**\n * The collector class handles the collection and storage of data into the appropriate array.\n * The collector also handles notifying any observers of any updates.\n */\nvar PerformanceViewerCollector = /** @class */ (function () {\n    /**\n     * Handles the creation of a performance viewer collector.\n     * @param _scene the scene to collect on.\n     * @param _enabledStrategyCallbacks the list of data to collect with callbacks for initialization purposes.\n     */\n    function PerformanceViewerCollector(_scene, _enabledStrategyCallbacks) {\n        var _this = this;\n        this._scene = _scene;\n        /**\n         * Collects data for every dataset by using the appropriate strategy. This is called every frame.\n         * This method will then notify all observers with the latest slice.\n         */\n        this._collectDataAtFrame = function () {\n            var timestamp = PrecisionDate.Now - _this._startingTimestamp;\n            var numPoints = _this.datasets.ids.length;\n            // add the starting index for the slice\n            var numberOfIndices = _this.datasets.startingIndices.itemLength;\n            var startingIndex = 0;\n            if (numberOfIndices > 0) {\n                var previousStartingIndex = _this.datasets.startingIndices.at(numberOfIndices - 1);\n                startingIndex =\n                    previousStartingIndex + _this.datasets.data.at(previousStartingIndex + PerformanceViewerCollector.NumberOfPointsOffset) + PerformanceViewerCollector.SliceDataOffset;\n            }\n            _this.datasets.startingIndices.push(startingIndex);\n            // add the first 2 items in our slice.\n            _this.datasets.data.push(timestamp);\n            _this.datasets.data.push(numPoints);\n            // add the values inside the slice.\n            _this.datasets.ids.forEach(function (id) {\n                var strategy = _this._strategies.get(id);\n                if (!strategy) {\n                    return;\n                }\n                _this.datasets.data.push(strategy.getData());\n            });\n            if (_this.datasetObservable.hasObservers()) {\n                var slice = [timestamp, numPoints];\n                for (var i = 0; i < numPoints; i++) {\n                    slice.push(_this.datasets.data.at(startingIndex + PerformanceViewerCollector.SliceDataOffset + i));\n                }\n                _this.datasetObservable.notifyObservers(slice);\n            }\n        };\n        this.datasets = {\n            ids: [],\n            data: new DynamicFloat32Array(InitialArraySize),\n            startingIndices: new DynamicFloat32Array(InitialArraySize),\n        };\n        this._strategies = new Map();\n        this._datasetMeta = new Map();\n        this._eventRestoreSet = new Set();\n        this._customEventObservable = new Observable();\n        this.datasetObservable = new Observable();\n        this.metadataObservable = new Observable(function (observer) { return observer.callback(_this._datasetMeta, new EventState(0)); });\n        if (_enabledStrategyCallbacks) {\n            this.addCollectionStrategies.apply(this, _enabledStrategyCallbacks);\n        }\n    }\n    Object.defineProperty(PerformanceViewerCollector, \"SliceDataOffset\", {\n        /**\n         * The offset for when actual data values start appearing inside a slice.\n         */\n        get: function () {\n            return 2;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerformanceViewerCollector, \"NumberOfPointsOffset\", {\n        /**\n         * The offset for the value of the number of points inside a slice.\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Registers a custom string event which will be callable via sendEvent. This method returns an event object which will contain the id of the event.\n     * The user can set a value optionally, which will be used in the sendEvent method. If the value is set, we will record this value at the end of each frame,\n     * if not we will increment our counter and record the value of the counter at the end of each frame. The value recorded is 0 if no sendEvent method is called, within a frame.\n     * @param name The name of the event to register\n     * @param forceUpdate if the code should force add an event, and replace the last one.\n     * @param category the category for that event\n     * @returns The event registered, used in sendEvent\n     */\n    PerformanceViewerCollector.prototype.registerEvent = function (name, forceUpdate, category) {\n        var _this = this;\n        var _a;\n        if (this._strategies.has(name) && !forceUpdate) {\n            return;\n        }\n        if (this._strategies.has(name) && forceUpdate) {\n            (_a = this._strategies.get(name)) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._strategies.delete(name);\n        }\n        var strategy = function (scene) {\n            var counter = 0;\n            var value = 0;\n            var afterRenderObserver = scene.onAfterRenderObservable.add(function () {\n                value = counter;\n                counter = 0;\n            });\n            var stringObserver = _this._customEventObservable.add(function (eventVal) {\n                if (name !== eventVal.name) {\n                    return;\n                }\n                if (eventVal.value !== undefined) {\n                    counter = eventVal.value;\n                }\n                else {\n                    counter++;\n                }\n            });\n            return {\n                id: name,\n                getData: function () { return value; },\n                dispose: function () {\n                    scene.onAfterRenderObservable.remove(afterRenderObserver);\n                    _this._customEventObservable.remove(stringObserver);\n                },\n            };\n        };\n        var event = {\n            name: name,\n        };\n        this._eventRestoreSet.add(name);\n        this.addCollectionStrategies({ strategyCallback: strategy, category: category });\n        return event;\n    };\n    /**\n     * Lets the perf collector handle an event, occurences or event value depending on if the event.value params is set.\n     * @param event the event to handle an occurence for\n     */\n    PerformanceViewerCollector.prototype.sendEvent = function (event) {\n        this._customEventObservable.notifyObservers(event);\n    };\n    /**\n     * This event restores all custom string events if necessary.\n     */\n    PerformanceViewerCollector.prototype._restoreStringEvents = function () {\n        var _this = this;\n        if (this._eventRestoreSet.size !== this._customEventObservable.observers.length) {\n            this._eventRestoreSet.forEach(function (event) {\n                _this.registerEvent(event, true);\n            });\n        }\n    };\n    /**\n     * This method adds additional collection strategies for data collection purposes.\n     * @param strategyCallbacks the list of data to collect with callbacks.\n     */\n    PerformanceViewerCollector.prototype.addCollectionStrategies = function () {\n        var strategyCallbacks = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            strategyCallbacks[_i] = arguments[_i];\n        }\n        // eslint-disable-next-line prefer-const\n        for (var _a = 0, strategyCallbacks_1 = strategyCallbacks; _a < strategyCallbacks_1.length; _a++) {\n            var _b = strategyCallbacks_1[_a], strategyCallback = _b.strategyCallback, category = _b.category, hidden = _b.hidden;\n            var strategy = strategyCallback(this._scene);\n            if (this._strategies.has(strategy.id)) {\n                strategy.dispose();\n                continue;\n            }\n            this.datasets.ids.push(strategy.id);\n            if (category) {\n                category = category.replace(new RegExp(ExportedDataSeparator, \"g\"), \"\");\n            }\n            this._datasetMeta.set(strategy.id, {\n                color: this._getHexColorFromId(strategy.id),\n                category: category,\n                hidden: hidden,\n            });\n            this._strategies.set(strategy.id, strategy);\n        }\n        this.metadataObservable.notifyObservers(this._datasetMeta);\n    };\n    /**\n     * Gets a 6 character hexcode representing the colour from a passed in string.\n     * @param id the string to get a hex code for.\n     * @returns a hexcode hashed from the id.\n     */\n    PerformanceViewerCollector.prototype._getHexColorFromId = function (id) {\n        // this first bit is just a known way of hashing a string.\n        var hash = 0;\n        for (var i = 0; i < id.length; i++) {\n            // (hash << 5) - hash is the same as hash * 31\n            hash = id.charCodeAt(i) + ((hash << 5) - hash);\n        }\n        // then we build the string octet by octet.\n        var hex = \"#\";\n        for (var i = 0; i < NumberOfBitsInHexcode; i += 8) {\n            var octet = (hash >> i) & 0xff;\n            hex += (HexPadding + octet.toString(16)).substr(-2);\n        }\n        return hex;\n    };\n    /**\n     * Collects and then sends the latest slice to any observers by using the appropriate strategy when the user wants.\n     * The slice will be of the form [timestamp, numberOfPoints, value1, value2...]\n     * This method does not add onto the collected data accessible via the datasets variable.\n     */\n    PerformanceViewerCollector.prototype.getCurrentSlice = function () {\n        var _this = this;\n        var timestamp = PrecisionDate.Now - this._startingTimestamp;\n        var numPoints = this.datasets.ids.length;\n        var slice = [timestamp, numPoints];\n        // add the values inside the slice.\n        this.datasets.ids.forEach(function (id) {\n            var strategy = _this._strategies.get(id);\n            if (!strategy) {\n                return;\n            }\n            if (_this.datasetObservable.hasObservers()) {\n                slice.push(strategy.getData());\n            }\n        });\n        if (this.datasetObservable.hasObservers()) {\n            this.datasetObservable.notifyObservers(slice);\n        }\n    };\n    /**\n     * Updates a property for a dataset's metadata with the value provided.\n     * @param id the id of the dataset which needs its metadata updated.\n     * @param prop the property to update.\n     * @param value the value to update the property with.\n     */\n    PerformanceViewerCollector.prototype.updateMetadata = function (id, prop, value) {\n        var meta = this._datasetMeta.get(id);\n        if (!meta) {\n            return;\n        }\n        meta[prop] = value;\n        this.metadataObservable.notifyObservers(this._datasetMeta);\n    };\n    /**\n     * Completely clear, data, ids, and strategies saved to this performance collector.\n     * @param preserveStringEventsRestore if it should preserve the string events, by default will clear string events registered when called.\n     */\n    PerformanceViewerCollector.prototype.clear = function (preserveStringEventsRestore) {\n        this.datasets.data = new DynamicFloat32Array(InitialArraySize);\n        this.datasets.ids.length = 0;\n        this.datasets.startingIndices = new DynamicFloat32Array(InitialArraySize);\n        this._datasetMeta.clear();\n        this._strategies.forEach(function (strategy) { return strategy.dispose(); });\n        this._strategies.clear();\n        if (!preserveStringEventsRestore) {\n            this._eventRestoreSet.clear();\n        }\n        this._hasLoadedData = false;\n    };\n    Object.defineProperty(PerformanceViewerCollector.prototype, \"hasLoadedData\", {\n        /**\n         * Accessor which lets the caller know if the performance collector has data loaded from a file or not!\n         * Call clear() to reset this value.\n         * @returns true if the data is loaded from a file, false otherwise.\n         */\n        get: function () {\n            return this._hasLoadedData;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Given a string containing file data, this function parses the file data into the datasets object.\n     * It returns a boolean to indicate if this object was successfully loaded with the data.\n     * @param data string content representing the file data.\n     * @param keepDatasetMeta if it should use reuse the existing dataset metadata\n     * @returns true if the data was successfully loaded, false otherwise.\n     */\n    PerformanceViewerCollector.prototype.loadFromFileData = function (data, keepDatasetMeta) {\n        var lines = data\n            .replace(CarriageReturnRegex, \"\")\n            .split(\"\\n\")\n            .map(function (line) { return line.split(\",\").filter(function (s) { return s.length > 0; }); })\n            .filter(function (line) { return line.length > 0; });\n        var timestampIndex = 0;\n        var numPointsIndex = PerformanceViewerCollector.NumberOfPointsOffset;\n        if (lines.length < 2) {\n            return false;\n        }\n        var parsedDatasets = {\n            ids: [],\n            data: new DynamicFloat32Array(InitialArraySize),\n            startingIndices: new DynamicFloat32Array(InitialArraySize),\n        };\n        // parse first line separately to populate ids!\n        var firstLine = lines[0], dataLines = lines.slice(1);\n        // make sure we have the correct beginning headers\n        if (firstLine.length < 2 || firstLine[timestampIndex] !== TimestampColHeader || firstLine[numPointsIndex] !== NumPointsColHeader) {\n            return false;\n        }\n        var idCategoryMap = new Map();\n        // populate the ids.\n        for (var i = PerformanceViewerCollector.SliceDataOffset; i < firstLine.length; i++) {\n            var _a = firstLine[i].split(ExportedDataSeparator), id = _a[0], category = _a[1];\n            parsedDatasets.ids.push(id);\n            idCategoryMap.set(id, category);\n        }\n        var startingIndex = 0;\n        for (var _i = 0, dataLines_1 = dataLines; _i < dataLines_1.length; _i++) {\n            var line = dataLines_1[_i];\n            if (line.length < 2) {\n                return false;\n            }\n            var timestamp = parseFloat(line[timestampIndex]);\n            var numPoints = parseInt(line[numPointsIndex]);\n            if (isNaN(numPoints) || isNaN(timestamp)) {\n                return false;\n            }\n            parsedDatasets.data.push(timestamp);\n            parsedDatasets.data.push(numPoints);\n            if (numPoints + PerformanceViewerCollector.SliceDataOffset !== line.length) {\n                return false;\n            }\n            for (var i = PerformanceViewerCollector.SliceDataOffset; i < line.length; i++) {\n                var val = parseFloat(line[i]);\n                if (isNaN(val)) {\n                    return false;\n                }\n                parsedDatasets.data.push(val);\n            }\n            parsedDatasets.startingIndices.push(startingIndex);\n            startingIndex += line.length;\n        }\n        this.datasets.ids = parsedDatasets.ids;\n        this.datasets.data = parsedDatasets.data;\n        this.datasets.startingIndices = parsedDatasets.startingIndices;\n        if (!keepDatasetMeta) {\n            this._datasetMeta.clear();\n        }\n        this._strategies.forEach(function (strategy) { return strategy.dispose(); });\n        this._strategies.clear();\n        // populate metadata.\n        if (!keepDatasetMeta) {\n            for (var _b = 0, _c = this.datasets.ids; _b < _c.length; _b++) {\n                var id = _c[_b];\n                var category = idCategoryMap.get(id);\n                this._datasetMeta.set(id, { category: category, color: this._getHexColorFromId(id) });\n            }\n        }\n        this.metadataObservable.notifyObservers(this._datasetMeta);\n        this._hasLoadedData = true;\n        return true;\n    };\n    /**\n     * Exports the datasets inside of the collector to a csv.\n     */\n    PerformanceViewerCollector.prototype.exportDataToCsv = function () {\n        var csvContent = \"\";\n        // create the header line.\n        csvContent += \"\".concat(TimestampColHeader, \",\").concat(NumPointsColHeader);\n        for (var i = 0; i < this.datasets.ids.length; i++) {\n            csvContent += \",\".concat(this.datasets.ids[i]);\n            if (this._datasetMeta) {\n                var meta = this._datasetMeta.get(this.datasets.ids[i]);\n                if (meta === null || meta === void 0 ? void 0 : meta.category) {\n                    csvContent += \"\".concat(ExportedDataSeparator).concat(meta.category);\n                }\n            }\n        }\n        csvContent += \"\\n\";\n        // create the data lines\n        for (var i = 0; i < this.datasets.startingIndices.itemLength; i++) {\n            var startingIndex = this.datasets.startingIndices.at(i);\n            var timestamp = this.datasets.data.at(startingIndex);\n            var numPoints = this.datasets.data.at(startingIndex + PerformanceViewerCollector.NumberOfPointsOffset);\n            csvContent += \"\".concat(timestamp, \",\").concat(numPoints);\n            for (var offset = 0; offset < numPoints; offset++) {\n                csvContent += \",\".concat(this.datasets.data.at(startingIndex + PerformanceViewerCollector.SliceDataOffset + offset));\n            }\n            // add extra commas.\n            for (var diff = 0; diff < this.datasets.ids.length - numPoints; diff++) {\n                csvContent += \",\";\n            }\n            csvContent += \"\\n\";\n        }\n        var fileName = \"\".concat(new Date().toISOString(), \"-perfdata.csv\");\n        Tools.Download(new Blob([csvContent], { type: \"text/csv\" }), fileName);\n    };\n    /**\n     * Starts the realtime collection of data.\n     * @param shouldPreserve optional boolean param, if set will preserve the dataset between calls of start.\n     */\n    PerformanceViewerCollector.prototype.start = function (shouldPreserve) {\n        if (!shouldPreserve) {\n            this.datasets.data = new DynamicFloat32Array(InitialArraySize);\n            this.datasets.startingIndices = new DynamicFloat32Array(InitialArraySize);\n            this._startingTimestamp = PrecisionDate.Now;\n        }\n        else if (this._startingTimestamp === undefined) {\n            this._startingTimestamp = PrecisionDate.Now;\n        }\n        this._scene.onAfterRenderObservable.add(this._collectDataAtFrame);\n        this._restoreStringEvents();\n        this._isStarted = true;\n    };\n    /**\n     * Stops the collection of data.\n     */\n    PerformanceViewerCollector.prototype.stop = function () {\n        this._scene.onAfterRenderObservable.removeCallback(this._collectDataAtFrame);\n        this._isStarted = false;\n    };\n    Object.defineProperty(PerformanceViewerCollector.prototype, \"isStarted\", {\n        /**\n         * Returns if the perf collector has been started or not.\n         */\n        get: function () {\n            return this._isStarted;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Disposes of the object\n     */\n    PerformanceViewerCollector.prototype.dispose = function () {\n        this._scene.onAfterRenderObservable.removeCallback(this._collectDataAtFrame);\n        this._datasetMeta.clear();\n        this._strategies.forEach(function (strategy) {\n            strategy.dispose();\n        });\n        this.datasetObservable.clear();\n        this.metadataObservable.clear();\n        this._isStarted = false;\n        this.datasets = null;\n    };\n    return PerformanceViewerCollector;\n}());\nexport { PerformanceViewerCollector };\n//# sourceMappingURL=performanceViewerCollector.js.map","import { EngineInstrumentation } from \"../../Instrumentation/engineInstrumentation.js\";\nimport { PrecisionDate } from \"../precisionDate.js\";\nimport { SceneInstrumentation } from \"../../Instrumentation/sceneInstrumentation.js\";\n// Dispose which does nothing.\nvar defaultDisposeImpl = function () { };\n/**\n * Defines the predefined strategies used in the performance viewer.\n */\nvar PerfCollectionStrategy = /** @class */ (function () {\n    function PerfCollectionStrategy() {\n    }\n    /**\n     * Gets the initializer for the strategy used for collection of fps metrics\n     * @returns the initializer for the fps strategy\n     */\n    PerfCollectionStrategy.FpsStrategy = function () {\n        return function (scene) {\n            var engine = scene.getEngine();\n            return {\n                id: \"FPS\",\n                getData: function () { return engine.getFps(); },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of cpu utilization metrics.\n     * Needs the experimental compute pressure API.\n     * @returns the initializer for the cpu utilization strategy\n     */\n    PerfCollectionStrategy.CpuStrategy = function () {\n        return function (scene) {\n            var value = 0;\n            var computePressureObserver = scene.onComputePressureChanged.add(function (update) {\n                value = update.cpuUtilization;\n            });\n            return {\n                id: \"CPU utilization\",\n                getData: function () { return value; },\n                dispose: function () { return scene.onComputePressureChanged.remove(computePressureObserver); },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of total meshes metrics.\n     * @returns the initializer for the total meshes strategy\n     */\n    PerfCollectionStrategy.TotalMeshesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Total meshes\",\n                getData: function () { return scene.meshes.length; },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of active meshes metrics.\n     * @returns the initializer for the active meshes strategy\n     */\n    PerfCollectionStrategy.ActiveMeshesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Active meshes\",\n                getData: function () { return scene.getActiveMeshes().length; },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of active indices metrics.\n     * @returns the initializer for the active indices strategy\n     */\n    PerfCollectionStrategy.ActiveIndicesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Active indices\",\n                getData: function () { return scene.getActiveIndices(); },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of active faces metrics.\n     * @returns the initializer for the active faces strategy\n     */\n    PerfCollectionStrategy.ActiveFacesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Active faces\",\n                getData: function () { return scene.getActiveIndices() / 3; },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of active bones metrics.\n     * @returns the initializer for the active bones strategy\n     */\n    PerfCollectionStrategy.ActiveBonesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Active bones\",\n                getData: function () { return scene.getActiveBones(); },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of active particles metrics.\n     * @returns the initializer for the active particles strategy\n     */\n    PerfCollectionStrategy.ActiveParticlesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Active particles\",\n                getData: function () { return scene.getActiveParticles(); },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of draw calls metrics.\n     * @returns the initializer for the draw calls strategy\n     */\n    PerfCollectionStrategy.DrawCallsStrategy = function () {\n        return function (scene) {\n            var drawCalls = 0;\n            var onBeforeAnimationsObserver = scene.onBeforeAnimationsObservable.add(function () {\n                scene.getEngine()._drawCalls.fetchNewFrame();\n            });\n            var onAfterRenderObserver = scene.onAfterRenderObservable.add(function () {\n                drawCalls = scene.getEngine()._drawCalls.current;\n            });\n            return {\n                id: \"Draw calls\",\n                getData: function () { return drawCalls; },\n                dispose: function () {\n                    scene.onBeforeAnimationsObservable.remove(onBeforeAnimationsObserver);\n                    scene.onAfterRenderObservable.remove(onAfterRenderObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of total lights metrics.\n     * @returns the initializer for the total lights strategy\n     */\n    PerfCollectionStrategy.TotalLightsStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Total lights\",\n                getData: function () { return scene.lights.length; },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of total vertices metrics.\n     * @returns the initializer for the total vertices strategy\n     */\n    PerfCollectionStrategy.TotalVerticesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Total vertices\",\n                getData: function () { return scene.getTotalVertices(); },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of total materials metrics.\n     * @returns the initializer for the total materials strategy\n     */\n    PerfCollectionStrategy.TotalMaterialsStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Total materials\",\n                getData: function () { return scene.materials.length; },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of total textures metrics.\n     * @returns the initializer for the total textures strategy\n     */\n    PerfCollectionStrategy.TotalTexturesStrategy = function () {\n        return function (scene) {\n            return {\n                id: \"Total textures\",\n                getData: function () { return scene.textures.length; },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of absolute fps metrics.\n     * @returns the initializer for the absolute fps strategy\n     */\n    PerfCollectionStrategy.AbsoluteFpsStrategy = function () {\n        return function (scene) {\n            var sceneInstrumentation = new SceneInstrumentation(scene);\n            sceneInstrumentation.captureFrameTime = true;\n            return {\n                id: \"Absolute FPS\",\n                getData: function () {\n                    return 1000.0 / sceneInstrumentation.frameTimeCounter.lastSecAverage;\n                },\n                dispose: defaultDisposeImpl,\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of meshes selection time metrics.\n     * @returns the initializer for the meshes selection time strategy\n     */\n    PerfCollectionStrategy.MeshesSelectionStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeActiveMeshesObserver = scene.onBeforeActiveMeshesEvaluationObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterActiveMeshesObserver = scene.onAfterActiveMeshesEvaluationObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Meshes Selection\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeActiveMeshesEvaluationObservable.remove(onBeforeActiveMeshesObserver);\n                    scene.onAfterActiveMeshesEvaluationObservable.remove(onAfterActiveMeshesObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of render targets time metrics.\n     * @returns the initializer for the render targets time strategy\n     */\n    PerfCollectionStrategy.RenderTargetsStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeRenderTargetsObserver = scene.onBeforeRenderTargetsRenderObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterRenderTargetsObserver = scene.onAfterRenderTargetsRenderObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Render Targets\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeRenderTargetsRenderObservable.remove(onBeforeRenderTargetsObserver);\n                    scene.onAfterRenderTargetsRenderObservable.remove(onAfterRenderTargetsObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of particles time metrics.\n     * @returns the initializer for the particles time strategy\n     */\n    PerfCollectionStrategy.ParticlesStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeParticlesObserver = scene.onBeforeParticlesRenderingObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterParticlesObserver = scene.onAfterParticlesRenderingObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Particles\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeParticlesRenderingObservable.remove(onBeforeParticlesObserver);\n                    scene.onAfterParticlesRenderingObservable.remove(onAfterParticlesObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of sprites time metrics.\n     * @returns the initializer for the sprites time strategy\n     */\n    PerfCollectionStrategy.SpritesStrategy = function () {\n        return function (scene) {\n            var _a, _b;\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeSpritesObserver = (_a = scene.onBeforeSpritesRenderingObservable) === null || _a === void 0 ? void 0 : _a.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterSpritesObserver = (_b = scene.onAfterSpritesRenderingObservable) === null || _b === void 0 ? void 0 : _b.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Sprites\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    var _a, _b;\n                    (_a = scene.onBeforeSpritesRenderingObservable) === null || _a === void 0 ? void 0 : _a.remove(onBeforeSpritesObserver);\n                    (_b = scene.onAfterSpritesRenderingObservable) === null || _b === void 0 ? void 0 : _b.remove(onAfterSpritesObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of animations time metrics.\n     * @returns the initializer for the animations time strategy\n     */\n    PerfCollectionStrategy.AnimationsStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeAnimationsObserver = scene.onBeforeAnimationsObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterAnimationsObserver = scene.onAfterAnimationsObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Animations\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeAnimationsObservable.remove(onBeforeAnimationsObserver);\n                    scene.onAfterAnimationsObservable.remove(onAfterAnimationsObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of physics time metrics.\n     * @returns the initializer for the physics time strategy\n     */\n    PerfCollectionStrategy.PhysicsStrategy = function () {\n        return function (scene) {\n            var _a, _b;\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforePhysicsObserver = (_a = scene.onBeforePhysicsObservable) === null || _a === void 0 ? void 0 : _a.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterPhysicsObserver = (_b = scene.onAfterPhysicsObservable) === null || _b === void 0 ? void 0 : _b.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Physics\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    var _a, _b;\n                    (_a = scene.onBeforePhysicsObservable) === null || _a === void 0 ? void 0 : _a.remove(onBeforePhysicsObserver);\n                    (_b = scene.onAfterPhysicsObservable) === null || _b === void 0 ? void 0 : _b.remove(onAfterPhysicsObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of render time metrics.\n     * @returns the initializer for the render time strategy\n     */\n    PerfCollectionStrategy.RenderStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeDrawPhaseObserver = scene.onBeforeDrawPhaseObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterDrawPhaseObserver = scene.onAfterDrawPhaseObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Render\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeDrawPhaseObservable.remove(onBeforeDrawPhaseObserver);\n                    scene.onAfterDrawPhaseObservable.remove(onAfterDrawPhaseObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of total frame time metrics.\n     * @returns the initializer for the total frame time strategy\n     */\n    PerfCollectionStrategy.FrameTotalStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeAnimationsObserver = scene.onBeforeAnimationsObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            var onAfterRenderObserver = scene.onAfterRenderObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            return {\n                id: \"Frame Total\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeAnimationsObservable.remove(onBeforeAnimationsObserver);\n                    scene.onAfterRenderObservable.remove(onAfterRenderObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of inter-frame time metrics.\n     * @returns the initializer for the inter-frame time strategy\n     */\n    PerfCollectionStrategy.InterFrameStrategy = function () {\n        return function (scene) {\n            var startTime = PrecisionDate.Now;\n            var timeTaken = 0;\n            var onBeforeAnimationsObserver = scene.onBeforeAnimationsObservable.add(function () {\n                timeTaken = PrecisionDate.Now - startTime;\n            });\n            var onAfterRenderObserver = scene.onAfterRenderObservable.add(function () {\n                startTime = PrecisionDate.Now;\n            });\n            return {\n                id: \"Inter-frame\",\n                getData: function () { return timeTaken; },\n                dispose: function () {\n                    scene.onBeforeAnimationsObservable.remove(onBeforeAnimationsObserver);\n                    scene.onAfterRenderObservable.remove(onAfterRenderObserver);\n                },\n            };\n        };\n    };\n    /**\n     * Gets the initializer for the strategy used for collection of gpu frame time metrics.\n     * @returns the initializer for the gpu frame time strategy\n     */\n    PerfCollectionStrategy.GpuFrameTimeStrategy = function () {\n        return function (scene) {\n            var engineInstrumentation = new EngineInstrumentation(scene.getEngine());\n            engineInstrumentation.captureGPUFrameTime = true;\n            return {\n                id: \"GPU frame time\",\n                getData: function () { return Math.max(engineInstrumentation.gpuFrameTimeCounter.current * 0.000001, 0); },\n                dispose: function () {\n                    engineInstrumentation.dispose();\n                },\n            };\n        };\n    };\n    return PerfCollectionStrategy;\n}());\nexport { PerfCollectionStrategy };\n//# sourceMappingURL=performanceViewerCollectionStrategies.js.map","import { Scene } from \"../../scene.js\";\nimport { PerformanceViewerCollector } from \"./performanceViewerCollector.js\";\nScene.prototype.getPerfCollector = function () {\n    if (!this._perfCollector) {\n        this._perfCollector = new PerformanceViewerCollector(this);\n    }\n    return this._perfCollector;\n};\n//# sourceMappingURL=performanceViewerSceneExtension.js.map","import { Observable } from \"./observable.js\";\nimport { runCoroutineAsync, inlineScheduler } from \"./coroutine.js\";\nfunction CreateObservableScheduler(observable) {\n    var coroutines = new Array();\n    var onSteps = new Array();\n    var onErrors = new Array();\n    var observer = observable.add(function () {\n        var count = coroutines.length;\n        for (var i = 0; i < count; i++) {\n            inlineScheduler(coroutines.shift(), onSteps.shift(), onErrors.shift());\n        }\n    });\n    var scheduler = function (coroutine, onStep, onError) {\n        coroutines.push(coroutine);\n        onSteps.push(onStep);\n        onErrors.push(onError);\n    };\n    return {\n        scheduler: scheduler,\n        dispose: function () {\n            observable.remove(observer);\n        },\n    };\n}\nObservable.prototype.runCoroutineAsync = function (coroutine) {\n    if (!this._coroutineScheduler) {\n        var schedulerAndDispose = CreateObservableScheduler(this);\n        this._coroutineScheduler = schedulerAndDispose.scheduler;\n        this._coroutineSchedulerDispose = schedulerAndDispose.dispose;\n    }\n    return runCoroutineAsync(coroutine, this._coroutineScheduler);\n};\nObservable.prototype.cancelAllCoroutines = function () {\n    if (this._coroutineSchedulerDispose) {\n        this._coroutineSchedulerDispose();\n    }\n    this._coroutineScheduler = undefined;\n    this._coroutineSchedulerDispose = undefined;\n};\n//# sourceMappingURL=observableCoroutine.js.map","import { Logger } from \"./logger.js\";\nimport { GetClass } from \"./typeStore.js\";\n/**\n * Class used to enable instantiation of objects by class name\n */\nvar InstantiationTools = /** @class */ (function () {\n    function InstantiationTools() {\n    }\n    /**\n     * Tries to instantiate a new object from a given class name\n     * @param className defines the class name to instantiate\n     * @returns the new object or null if the system was not able to do the instantiation\n     */\n    InstantiationTools.Instantiate = function (className) {\n        if (this.RegisteredExternalClasses && this.RegisteredExternalClasses[className]) {\n            return this.RegisteredExternalClasses[className];\n        }\n        var internalClass = GetClass(className);\n        if (internalClass) {\n            return internalClass;\n        }\n        Logger.Warn(className + \" not found, you may have missed an import.\");\n        var arr = className.split(\".\");\n        var fn = window || this;\n        for (var i = 0, len = arr.length; i < len; i++) {\n            fn = fn[arr[i]];\n        }\n        if (typeof fn !== \"function\") {\n            return null;\n        }\n        return fn;\n    };\n    /**\n     * Use this object to register external classes like custom textures or material\n     * to allow the loaders to instantiate them\n     */\n    InstantiationTools.RegisteredExternalClasses = {};\n    return InstantiationTools;\n}());\nexport { InstantiationTools };\n//# sourceMappingURL=instantiationTools.js.map","/* eslint-disable @typescript-eslint/naming-convention */\nimport { Logger } from \"../Misc/logger.js\";\n/**\n * for description see https://www.khronos.org/opengles/sdk/tools/KTX/\n * for file layout see https://www.khronos.org/opengles/sdk/tools/KTX/file_format_spec/\n */\nvar KhronosTextureContainer = /** @class */ (function () {\n    /**\n     * Creates a new KhronosTextureContainer\n     * @param data contents of the KTX container file\n     * @param facesExpected should be either 1 or 6, based whether a cube texture or or\n     */\n    function KhronosTextureContainer(\n    /** contents of the KTX container file */\n    data, facesExpected) {\n        this.data = data;\n        /**\n         * If the container has been made invalid (eg. constructor failed to correctly load array buffer)\n         */\n        this.isInvalid = false;\n        if (!KhronosTextureContainer.IsValid(data)) {\n            this.isInvalid = true;\n            Logger.Error(\"texture missing KTX identifier\");\n            return;\n        }\n        // load the reset of the header in native 32 bit uint\n        var dataSize = Uint32Array.BYTES_PER_ELEMENT;\n        var headerDataView = new DataView(this.data.buffer, this.data.byteOffset + 12, 13 * dataSize);\n        var endianness = headerDataView.getUint32(0, true);\n        var littleEndian = endianness === 0x04030201;\n        this.glType = headerDataView.getUint32(1 * dataSize, littleEndian); // must be 0 for compressed textures\n        this.glTypeSize = headerDataView.getUint32(2 * dataSize, littleEndian); // must be 1 for compressed textures\n        this.glFormat = headerDataView.getUint32(3 * dataSize, littleEndian); // must be 0 for compressed textures\n        this.glInternalFormat = headerDataView.getUint32(4 * dataSize, littleEndian); // the value of arg passed to gl.compressedTexImage2D(,,x,,,,)\n        this.glBaseInternalFormat = headerDataView.getUint32(5 * dataSize, littleEndian); // specify GL_RGB, GL_RGBA, GL_ALPHA, etc (un-compressed only)\n        this.pixelWidth = headerDataView.getUint32(6 * dataSize, littleEndian); // level 0 value of arg passed to gl.compressedTexImage2D(,,,x,,,)\n        this.pixelHeight = headerDataView.getUint32(7 * dataSize, littleEndian); // level 0 value of arg passed to gl.compressedTexImage2D(,,,,x,,)\n        this.pixelDepth = headerDataView.getUint32(8 * dataSize, littleEndian); // level 0 value of arg passed to gl.compressedTexImage3D(,,,,,x,,)\n        this.numberOfArrayElements = headerDataView.getUint32(9 * dataSize, littleEndian); // used for texture arrays\n        this.numberOfFaces = headerDataView.getUint32(10 * dataSize, littleEndian); // used for cubemap textures, should either be 1 or 6\n        this.numberOfMipmapLevels = headerDataView.getUint32(11 * dataSize, littleEndian); // number of levels; disregard possibility of 0 for compressed textures\n        this.bytesOfKeyValueData = headerDataView.getUint32(12 * dataSize, littleEndian); // the amount of space after the header for meta-data\n        // Make sure we have a compressed type.  Not only reduces work, but probably better to let dev know they are not compressing.\n        if (this.glType !== 0) {\n            Logger.Error(\"only compressed formats currently supported\");\n            return;\n        }\n        else {\n            // value of zero is an indication to generate mipmaps @ runtime.  Not usually allowed for compressed, so disregard.\n            this.numberOfMipmapLevels = Math.max(1, this.numberOfMipmapLevels);\n        }\n        if (this.pixelHeight === 0 || this.pixelDepth !== 0) {\n            Logger.Error(\"only 2D textures currently supported\");\n            return;\n        }\n        if (this.numberOfArrayElements !== 0) {\n            Logger.Error(\"texture arrays not currently supported\");\n            return;\n        }\n        if (this.numberOfFaces !== facesExpected) {\n            Logger.Error(\"number of faces expected\" + facesExpected + \", but found \" + this.numberOfFaces);\n            return;\n        }\n        // we now have a completely validated file, so could use existence of loadType as success\n        // would need to make this more elaborate & adjust checks above to support more than one load type\n        this.loadType = KhronosTextureContainer.COMPRESSED_2D;\n    }\n    /**\n     * Uploads KTX content to a Babylon Texture.\n     * It is assumed that the texture has already been created & is currently bound\n     * @param texture\n     * @param loadMipmaps\n     * @hidden\n     */\n    KhronosTextureContainer.prototype.uploadLevels = function (texture, loadMipmaps) {\n        switch (this.loadType) {\n            case KhronosTextureContainer.COMPRESSED_2D:\n                this._upload2DCompressedLevels(texture, loadMipmaps);\n                break;\n            case KhronosTextureContainer.TEX_2D:\n            case KhronosTextureContainer.COMPRESSED_3D:\n            case KhronosTextureContainer.TEX_3D:\n        }\n    };\n    KhronosTextureContainer.prototype._upload2DCompressedLevels = function (texture, loadMipmaps) {\n        // initialize width & height for level 1\n        var dataOffset = KhronosTextureContainer.HEADER_LEN + this.bytesOfKeyValueData;\n        var width = this.pixelWidth;\n        var height = this.pixelHeight;\n        var mipmapCount = loadMipmaps ? this.numberOfMipmapLevels : 1;\n        for (var level = 0; level < mipmapCount; level++) {\n            var imageSize = new Int32Array(this.data.buffer, this.data.byteOffset + dataOffset, 1)[0]; // size per face, since not supporting array cubemaps\n            dataOffset += 4; //image data starts from next multiple of 4 offset. Each face refers to same imagesize field above.\n            for (var face = 0; face < this.numberOfFaces; face++) {\n                var byteArray = new Uint8Array(this.data.buffer, this.data.byteOffset + dataOffset, imageSize);\n                var engine = texture.getEngine();\n                engine._uploadCompressedDataToTextureDirectly(texture, texture.format, width, height, byteArray, face, level);\n                dataOffset += imageSize; // add size of the image for the next face/mipmap\n                dataOffset += 3 - ((imageSize + 3) % 4); // add padding for odd sized image\n            }\n            width = Math.max(1.0, width * 0.5);\n            height = Math.max(1.0, height * 0.5);\n        }\n    };\n    /**\n     * Checks if the given data starts with a KTX file identifier.\n     * @param data the data to check\n     * @returns true if the data is a KTX file or false otherwise\n     */\n    KhronosTextureContainer.IsValid = function (data) {\n        if (data.byteLength >= 12) {\n            // '«', 'K', 'T', 'X', ' ', '1', '1', '»', '\\r', '\\n', '\\x1A', '\\n'\n            var identifier = new Uint8Array(data.buffer, data.byteOffset, 12);\n            if (identifier[0] === 0xab &&\n                identifier[1] === 0x4b &&\n                identifier[2] === 0x54 &&\n                identifier[3] === 0x58 &&\n                identifier[4] === 0x20 &&\n                identifier[5] === 0x31 &&\n                identifier[6] === 0x31 &&\n                identifier[7] === 0xbb &&\n                identifier[8] === 0x0d &&\n                identifier[9] === 0x0a &&\n                identifier[10] === 0x1a &&\n                identifier[11] === 0x0a) {\n                return true;\n            }\n        }\n        return false;\n    };\n    KhronosTextureContainer.HEADER_LEN = 12 + 13 * 4; // identifier + header elements (not including key value meta-data pairs)\n    // load types\n    KhronosTextureContainer.COMPRESSED_2D = 0; // uses a gl.compressedTexImage2D()\n    KhronosTextureContainer.COMPRESSED_3D = 1; // uses a gl.compressedTexImage3D()\n    KhronosTextureContainer.TEX_2D = 2; // uses a gl.texImage2D()\n    KhronosTextureContainer.TEX_3D = 3; // uses a gl.texImage3D()\n    return KhronosTextureContainer;\n}());\nexport { KhronosTextureContainer };\n//# sourceMappingURL=khronosTextureContainer.js.map","\nimport { AutoReleaseWorkerPool } from \"./workerPool.js\";\nimport { Tools } from \"./tools.js\";\n/**\n * Class for loading KTX2 files\n */\nvar KhronosTextureContainer2 = /** @class */ (function () {\n    /**\n     * Constructor\n     * @param engine The engine to use\n     * @param numWorkers The number of workers for async operations. Specify `0` to disable web workers and run synchronously in the current context.\n     */\n    function KhronosTextureContainer2(engine, numWorkers) {\n        if (numWorkers === void 0) { numWorkers = KhronosTextureContainer2.DefaultNumWorkers; }\n        this._engine = engine;\n        KhronosTextureContainer2._Initialize(numWorkers);\n    }\n    KhronosTextureContainer2.GetDefaultNumWorkers = function () {\n        if (typeof navigator !== \"object\" || !navigator.hardwareConcurrency) {\n            return 1;\n        }\n        // Use 50% of the available logical processors but capped at 4.\n        return Math.min(Math.floor(navigator.hardwareConcurrency * 0.5), 4);\n    };\n    KhronosTextureContainer2._Initialize = function (numWorkers) {\n        if (KhronosTextureContainer2._WorkerPoolPromise || KhronosTextureContainer2._DecoderModulePromise) {\n            return;\n        }\n        if (numWorkers && typeof Worker === \"function\") {\n            KhronosTextureContainer2._WorkerPoolPromise = new Promise(function (resolve) {\n                var workerContent = \"(\".concat(workerFunc, \")()\");\n                var workerBlobUrl = URL.createObjectURL(new Blob([workerContent], { type: \"application/javascript\" }));\n                resolve(new AutoReleaseWorkerPool(numWorkers, function () {\n                    return new Promise(function (resolve, reject) {\n                        var worker = new Worker(workerBlobUrl);\n                        var onError = function (error) {\n                            worker.removeEventListener(\"error\", onError);\n                            worker.removeEventListener(\"message\", onMessage);\n                            reject(error);\n                        };\n                        var onMessage = function (message) {\n                            if (message.data.action === \"init\") {\n                                worker.removeEventListener(\"error\", onError);\n                                worker.removeEventListener(\"message\", onMessage);\n                                resolve(worker);\n                            }\n                        };\n                        worker.addEventListener(\"error\", onError);\n                        worker.addEventListener(\"message\", onMessage);\n                        worker.postMessage({\n                            action: \"init\",\n                            urls: KhronosTextureContainer2.URLConfig,\n                        });\n                    });\n                }));\n            });\n        }\n        else if (typeof KTX2DECODER === \"undefined\") {\n            KhronosTextureContainer2._DecoderModulePromise = Tools.LoadScriptAsync(KhronosTextureContainer2.URLConfig.jsDecoderModule).then(function () {\n                KTX2DECODER.MSCTranscoder.UseFromWorkerThread = false;\n                KTX2DECODER.WASMMemoryManager.LoadBinariesFromCurrentThread = true;\n                var urls = KhronosTextureContainer2.URLConfig;\n                if (urls.wasmUASTCToASTC !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_ASTC.WasmModuleURL = urls.wasmUASTCToASTC;\n                }\n                if (urls.wasmUASTCToBC7 !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_BC7.WasmModuleURL = urls.wasmUASTCToBC7;\n                }\n                if (urls.wasmUASTCToRGBA_UNORM !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_RGBA_UNORM.WasmModuleURL = urls.wasmUASTCToRGBA_UNORM;\n                }\n                if (urls.wasmUASTCToRGBA_SRGB !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_RGBA_SRGB.WasmModuleURL = urls.wasmUASTCToRGBA_SRGB;\n                }\n                if (urls.jsMSCTranscoder !== null) {\n                    KTX2DECODER.MSCTranscoder.JSModuleURL = urls.jsMSCTranscoder;\n                }\n                if (urls.wasmMSCTranscoder !== null) {\n                    KTX2DECODER.MSCTranscoder.WasmModuleURL = urls.wasmMSCTranscoder;\n                }\n                if (urls.wasmZSTDDecoder !== null) {\n                    KTX2DECODER.ZSTDDecoder.WasmModuleURL = urls.wasmZSTDDecoder;\n                }\n                return new KTX2DECODER.KTX2Decoder();\n            });\n        }\n        else {\n            KTX2DECODER.MSCTranscoder.UseFromWorkerThread = false;\n            KTX2DECODER.WASMMemoryManager.LoadBinariesFromCurrentThread = true;\n            KhronosTextureContainer2._DecoderModulePromise = Promise.resolve(new KTX2DECODER.KTX2Decoder());\n        }\n    };\n    /**\n     * @param data\n     * @param internalTexture\n     * @param options\n     * @hidden\n     */\n    KhronosTextureContainer2.prototype.uploadAsync = function (data, internalTexture, options) {\n        var _this = this;\n        var caps = this._engine.getCaps();\n        var compressedTexturesCaps = {\n            astc: !!caps.astc,\n            bptc: !!caps.bptc,\n            s3tc: !!caps.s3tc,\n            pvrtc: !!caps.pvrtc,\n            etc2: !!caps.etc2,\n            etc1: !!caps.etc1,\n        };\n        if (KhronosTextureContainer2._WorkerPoolPromise) {\n            return KhronosTextureContainer2._WorkerPoolPromise.then(function (workerPool) {\n                return new Promise(function (resolve, reject) {\n                    workerPool.push(function (worker, onComplete) {\n                        var onError = function (error) {\n                            worker.removeEventListener(\"error\", onError);\n                            worker.removeEventListener(\"message\", onMessage);\n                            reject(error);\n                            onComplete();\n                        };\n                        var onMessage = function (message) {\n                            if (message.data.action === \"decoded\") {\n                                worker.removeEventListener(\"error\", onError);\n                                worker.removeEventListener(\"message\", onMessage);\n                                if (!message.data.success) {\n                                    reject({ message: message.data.msg });\n                                }\n                                else {\n                                    try {\n                                        _this._createTexture(message.data.decodedData, internalTexture, options);\n                                        resolve();\n                                    }\n                                    catch (err) {\n                                        reject({ message: err });\n                                    }\n                                }\n                                onComplete();\n                            }\n                        };\n                        worker.addEventListener(\"error\", onError);\n                        worker.addEventListener(\"message\", onMessage);\n                        var dataCopy = new Uint8Array(data.byteLength);\n                        dataCopy.set(new Uint8Array(data.buffer, data.byteOffset, data.byteLength));\n                        worker.postMessage({ action: \"decode\", data: dataCopy, caps: compressedTexturesCaps, options: options }, [dataCopy.buffer]);\n                    });\n                });\n            });\n        }\n        else if (KhronosTextureContainer2._DecoderModulePromise) {\n            return KhronosTextureContainer2._DecoderModulePromise.then(function (decoder) {\n                return new Promise(function (resolve, reject) {\n                    decoder\n                        .decode(data, caps)\n                        .then(function (data) {\n                        _this._createTexture(data, internalTexture);\n                        resolve();\n                    })\n                        .catch(function (reason) {\n                        reject({ message: reason });\n                    });\n                });\n            });\n        }\n        throw new Error(\"KTX2 decoder module is not available\");\n    };\n    KhronosTextureContainer2.prototype._createTexture = function (data /* IEncodedData */, internalTexture, options) {\n        var oglTexture2D = 3553; // gl.TEXTURE_2D\n        this._engine._bindTextureDirectly(oglTexture2D, internalTexture);\n        if (options) {\n            // return back some information about the decoded data\n            options.transcodedFormat = data.transcodedFormat;\n            options.isInGammaSpace = data.isInGammaSpace;\n            options.hasAlpha = data.hasAlpha;\n            options.transcoderName = data.transcoderName;\n        }\n        if (data.transcodedFormat === 0x8058 /* RGBA8 */) {\n            internalTexture.type = 0;\n            internalTexture.format = 5;\n        }\n        else {\n            internalTexture.format = data.transcodedFormat;\n        }\n        internalTexture._gammaSpace = data.isInGammaSpace;\n        internalTexture.generateMipMaps = data.mipmaps.length > 1;\n        if (data.errors) {\n            throw new Error(\"KTX2 container - could not transcode the data. \" + data.errors);\n        }\n        for (var t = 0; t < data.mipmaps.length; ++t) {\n            var mipmap = data.mipmaps[t];\n            if (!mipmap || !mipmap.data) {\n                throw new Error(\"KTX2 container - could not transcode one of the image\");\n            }\n            if (data.transcodedFormat === 0x8058 /* RGBA8 */) {\n                // uncompressed RGBA\n                internalTexture.width = mipmap.width; // need to set width/height so that the call to _uploadDataToTextureDirectly uses the right dimensions\n                internalTexture.height = mipmap.height;\n                this._engine._uploadDataToTextureDirectly(internalTexture, mipmap.data, 0, t, undefined, true);\n            }\n            else {\n                this._engine._uploadCompressedDataToTextureDirectly(internalTexture, data.transcodedFormat, mipmap.width, mipmap.height, mipmap.data, 0, t);\n            }\n        }\n        internalTexture._extension = \".ktx2\";\n        internalTexture.width = data.mipmaps[0].width;\n        internalTexture.height = data.mipmaps[0].height;\n        internalTexture.isReady = true;\n        this._engine._bindTextureDirectly(oglTexture2D, null);\n    };\n    /**\n     * Checks if the given data starts with a KTX2 file identifier.\n     * @param data the data to check\n     * @returns true if the data is a KTX2 file or false otherwise\n     */\n    KhronosTextureContainer2.IsValid = function (data) {\n        if (data.byteLength >= 12) {\n            // '«', 'K', 'T', 'X', ' ', '2', '0', '»', '\\r', '\\n', '\\x1A', '\\n'\n            var identifier = new Uint8Array(data.buffer, data.byteOffset, 12);\n            if (identifier[0] === 0xab &&\n                identifier[1] === 0x4b &&\n                identifier[2] === 0x54 &&\n                identifier[3] === 0x58 &&\n                identifier[4] === 0x20 &&\n                identifier[5] === 0x32 &&\n                identifier[6] === 0x30 &&\n                identifier[7] === 0xbb &&\n                identifier[8] === 0x0d &&\n                identifier[9] === 0x0a &&\n                identifier[10] === 0x1a &&\n                identifier[11] === 0x0a) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * URLs to use when loading the KTX2 decoder module as well as its dependencies\n     * If a url is null, the default url is used (pointing to https://preview.babylonjs.com)\n     * Note that jsDecoderModule can't be null and that the other dependencies will only be loaded if necessary\n     * Urls you can change:\n     *     URLConfig.jsDecoderModule\n     *     URLConfig.wasmUASTCToASTC\n     *     URLConfig.wasmUASTCToBC7\n     *     URLConfig.wasmUASTCToRGBA_UNORM\n     *     URLConfig.wasmUASTCToRGBA_SRGB\n     *     URLConfig.jsMSCTranscoder\n     *     URLConfig.wasmMSCTranscoder\n     *     URLConfig.wasmZSTDDecoder\n     * You can see their default values in this PG: https://playground.babylonjs.com/#EIJH8L#29\n     */\n    KhronosTextureContainer2.URLConfig = {\n        jsDecoderModule: \"https://preview.babylonjs.com/babylon.ktx2Decoder.js\",\n        wasmUASTCToASTC: null,\n        wasmUASTCToBC7: null,\n        wasmUASTCToRGBA_UNORM: null,\n        wasmUASTCToRGBA_SRGB: null,\n        jsMSCTranscoder: null,\n        wasmMSCTranscoder: null,\n        wasmZSTDDecoder: null,\n    };\n    /**\n     * Default number of workers used to handle data decoding\n     */\n    KhronosTextureContainer2.DefaultNumWorkers = KhronosTextureContainer2.GetDefaultNumWorkers();\n    return KhronosTextureContainer2;\n}());\nexport { KhronosTextureContainer2 };\nfunction workerFunc() {\n    var ktx2Decoder;\n    onmessage = function (event) {\n        if (!event.data) {\n            return;\n        }\n        switch (event.data.action) {\n            case \"init\": {\n                var urls = event.data.urls;\n                importScripts(urls.jsDecoderModule);\n                if (urls.wasmUASTCToASTC !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_ASTC.WasmModuleURL = urls.wasmUASTCToASTC;\n                }\n                if (urls.wasmUASTCToBC7 !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_BC7.WasmModuleURL = urls.wasmUASTCToBC7;\n                }\n                if (urls.wasmUASTCToRGBA_UNORM !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_RGBA_UNORM.WasmModuleURL = urls.wasmUASTCToRGBA_UNORM;\n                }\n                if (urls.wasmUASTCToRGBA_SRGB !== null) {\n                    KTX2DECODER.LiteTranscoder_UASTC_RGBA_SRGB.WasmModuleURL = urls.wasmUASTCToRGBA_SRGB;\n                }\n                if (urls.jsMSCTranscoder !== null) {\n                    KTX2DECODER.MSCTranscoder.JSModuleURL = urls.jsMSCTranscoder;\n                }\n                if (urls.wasmMSCTranscoder !== null) {\n                    KTX2DECODER.MSCTranscoder.WasmModuleURL = urls.wasmMSCTranscoder;\n                }\n                if (urls.wasmZSTDDecoder !== null) {\n                    KTX2DECODER.ZSTDDecoder.WasmModuleURL = urls.wasmZSTDDecoder;\n                }\n                ktx2Decoder = new KTX2DECODER.KTX2Decoder();\n                postMessage({ action: \"init\" });\n                break;\n            }\n            case \"decode\":\n                ktx2Decoder\n                    .decode(event.data.data, event.data.caps, event.data.options)\n                    .then(function (data) {\n                    var buffers = [];\n                    for (var mip = 0; mip < data.mipmaps.length; ++mip) {\n                        var mipmap = data.mipmaps[mip];\n                        if (mipmap && mipmap.data) {\n                            buffers.push(mipmap.data.buffer);\n                        }\n                    }\n                    postMessage({ action: \"decoded\", success: true, decodedData: data }, buffers);\n                })\n                    .catch(function (reason) {\n                    postMessage({ action: \"decoded\", success: false, msg: reason });\n                });\n                break;\n        }\n    };\n}\n//# sourceMappingURL=khronosTextureContainer2.js.map","/**\n * Logger used throughout the application to allow configuration of\n * the log level required for the messages.\n */\nvar Logger = /** @class */ (function () {\n    function Logger() {\n    }\n    Logger._CheckLimit = function (message, limit) {\n        var entry = Logger._LogLimitOutputs[message];\n        if (!entry) {\n            entry = { limit: limit, current: 1 };\n            Logger._LogLimitOutputs[message] = entry;\n        }\n        else {\n            entry.current++;\n        }\n        return entry.current <= entry.limit;\n    };\n    Logger._GenerateLimitMessage = function (message, messageType) {\n        var entry = Logger._LogLimitOutputs[message];\n        if (!entry || !Logger.MessageLimitReached) {\n            return;\n        }\n        if (entry.current === entry.limit) {\n            switch (messageType) {\n                case 0:\n                    Logger.Log(Logger.MessageLimitReached.replace(/%LIMIT%/g, \"\" + entry.limit).replace(/%TYPE%/g, \"log\"));\n                    break;\n                case 1:\n                    Logger.Warn(Logger.MessageLimitReached.replace(/%LIMIT%/g, \"\" + entry.limit).replace(/%TYPE%/g, \"warning\"));\n                    break;\n                case 2:\n                    Logger.Error(Logger.MessageLimitReached.replace(/%LIMIT%/g, \"\" + entry.limit).replace(/%TYPE%/g, \"error\"));\n                    break;\n            }\n        }\n    };\n    Logger._AddLogEntry = function (entry) {\n        Logger._LogCache = entry + Logger._LogCache;\n        if (Logger.OnNewCacheEntry) {\n            Logger.OnNewCacheEntry(entry);\n        }\n    };\n    Logger._FormatMessage = function (message) {\n        var padStr = function (i) { return (i < 10 ? \"0\" + i : \"\" + i); };\n        var date = new Date();\n        return \"[\" + padStr(date.getHours()) + \":\" + padStr(date.getMinutes()) + \":\" + padStr(date.getSeconds()) + \"]: \" + message;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Logger._LogDisabled = function (message, limit) {\n        // nothing to do\n    };\n    Logger._LogEnabled = function (message, limit) {\n        if (limit !== undefined && !Logger._CheckLimit(message, limit)) {\n            return;\n        }\n        var formattedMessage = Logger._FormatMessage(message);\n        console.log(\"BJS - \" + formattedMessage);\n        var entry = \"<div style='color:white'>\" + formattedMessage + \"</div><br>\";\n        Logger._AddLogEntry(entry);\n        Logger._GenerateLimitMessage(message, 0);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Logger._WarnDisabled = function (message, limit) {\n        // nothing to do\n    };\n    Logger._WarnEnabled = function (message, limit) {\n        if (limit !== undefined && !Logger._CheckLimit(message, limit)) {\n            return;\n        }\n        var formattedMessage = Logger._FormatMessage(message);\n        console.warn(\"BJS - \" + formattedMessage);\n        var entry = \"<div style='color:orange'>\" + message + \"</div><br>\";\n        Logger._AddLogEntry(entry);\n        Logger._GenerateLimitMessage(message, 1);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Logger._ErrorDisabled = function (message, limit) {\n        // nothing to do\n    };\n    Logger._ErrorEnabled = function (message, limit) {\n        if (limit !== undefined && !Logger._CheckLimit(message, limit)) {\n            return;\n        }\n        var formattedMessage = Logger._FormatMessage(message);\n        Logger.errorsCount++;\n        console.error(\"BJS - \" + formattedMessage);\n        var entry = \"<div style='color:red'>\" + formattedMessage + \"</div><br>\";\n        Logger._AddLogEntry(entry);\n        Logger._GenerateLimitMessage(message, 2);\n    };\n    Object.defineProperty(Logger, \"LogCache\", {\n        /**\n         * Gets current log cache (list of logs)\n         */\n        get: function () {\n            return Logger._LogCache;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Clears the log cache\n     */\n    Logger.ClearLogCache = function () {\n        Logger._LogCache = \"\";\n        Logger._LogLimitOutputs = {};\n        Logger.errorsCount = 0;\n    };\n    Object.defineProperty(Logger, \"LogLevels\", {\n        /**\n         * Sets the current log level (MessageLogLevel / WarningLogLevel / ErrorLogLevel)\n         */\n        set: function (level) {\n            if ((level & Logger.MessageLogLevel) === Logger.MessageLogLevel) {\n                Logger.Log = Logger._LogEnabled;\n            }\n            else {\n                Logger.Log = Logger._LogDisabled;\n            }\n            if ((level & Logger.WarningLogLevel) === Logger.WarningLogLevel) {\n                Logger.Warn = Logger._WarnEnabled;\n            }\n            else {\n                Logger.Warn = Logger._WarnDisabled;\n            }\n            if ((level & Logger.ErrorLogLevel) === Logger.ErrorLogLevel) {\n                Logger.Error = Logger._ErrorEnabled;\n            }\n            else {\n                Logger.Error = Logger._ErrorDisabled;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * No log\n     */\n    Logger.NoneLogLevel = 0;\n    /**\n     * Only message logs\n     */\n    Logger.MessageLogLevel = 1;\n    /**\n     * Only warning logs\n     */\n    Logger.WarningLogLevel = 2;\n    /**\n     * Only error logs\n     */\n    Logger.ErrorLogLevel = 4;\n    /**\n     * All logs\n     */\n    Logger.AllLogLevel = 7;\n    /**\n     * Message to display when a message has been logged too many times\n     */\n    Logger.MessageLimitReached = \"Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.\";\n    Logger._LogCache = \"\";\n    Logger._LogLimitOutputs = {};\n    /**\n     * Gets a value indicating the number of loading errors\n     * @ignorenaming\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Logger.errorsCount = 0;\n    /**\n     * Log a message to the console\n     */\n    Logger.Log = Logger._LogEnabled;\n    /**\n     * Write a warning message to the console\n     */\n    Logger.Warn = Logger._WarnEnabled;\n    /**\n     * Write an error message to the console\n     */\n    Logger.Error = Logger._ErrorEnabled;\n    return Logger;\n}());\nexport { Logger };\n//# sourceMappingURL=logger.js.map","\nimport { Observable } from \"./observable.js\";\nimport { PostProcess } from \"../PostProcesses/postProcess.js\";\nimport { PostProcessManager } from \"../PostProcesses/postProcessManager.js\";\nimport \"../Shaders/minmaxRedux.fragment.js\";\n/**\n * This class computes a min/max reduction from a texture: it means it computes the minimum\n * and maximum values from all values of the texture.\n * It is performed on the GPU for better performances, thanks to a succession of post processes.\n * The source values are read from the red channel of the texture.\n */\nvar MinMaxReducer = /** @class */ (function () {\n    /**\n     * Creates a min/max reducer\n     * @param camera The camera to use for the post processes\n     */\n    function MinMaxReducer(camera) {\n        var _this = this;\n        /**\n         * Observable triggered when the computation has been performed\n         */\n        this.onAfterReductionPerformed = new Observable();\n        this._forceFullscreenViewport = true;\n        this._activated = false;\n        this._camera = camera;\n        this._postProcessManager = new PostProcessManager(camera.getScene());\n        this._onContextRestoredObserver = camera.getEngine().onContextRestoredObservable.add(function () {\n            _this._postProcessManager._rebuild();\n        });\n    }\n    Object.defineProperty(MinMaxReducer.prototype, \"sourceTexture\", {\n        /**\n         * Gets the texture used to read the values from.\n         */\n        get: function () {\n            return this._sourceTexture;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Sets the source texture to read the values from.\n     * One must indicate if the texture is a depth texture or not through the depthRedux parameter\n     * because in such textures '1' value must not be taken into account to compute the maximum\n     * as this value is used to clear the texture.\n     * Note that the computation is not activated by calling this function, you must call activate() for that!\n     * @param sourceTexture The texture to read the values from. The values should be in the red channel.\n     * @param depthRedux Indicates if the texture is a depth texture or not\n     * @param type The type of the textures created for the reduction (defaults to TEXTURETYPE_HALF_FLOAT)\n     * @param forceFullscreenViewport Forces the post processes used for the reduction to be applied without taking into account viewport (defaults to true)\n     */\n    MinMaxReducer.prototype.setSourceTexture = function (sourceTexture, depthRedux, type, forceFullscreenViewport) {\n        var _this = this;\n        if (type === void 0) { type = 2; }\n        if (forceFullscreenViewport === void 0) { forceFullscreenViewport = true; }\n        if (sourceTexture === this._sourceTexture) {\n            return;\n        }\n        this.dispose(false);\n        this._sourceTexture = sourceTexture;\n        this._reductionSteps = [];\n        this._forceFullscreenViewport = forceFullscreenViewport;\n        var scene = this._camera.getScene();\n        // create the first step\n        var reductionInitial = new PostProcess(\"Initial reduction phase\", \"minmaxRedux\", // shader\n        [\"texSize\"], [\"sourceTexture\"], // textures\n        1.0, // options\n        null, // camera\n        1, // sampling\n        scene.getEngine(), // engine\n        false, // reusable\n        \"#define INITIAL\" + (depthRedux ? \"\\n#define DEPTH_REDUX\" : \"\"), // defines\n        type, undefined, undefined, undefined, 7);\n        reductionInitial.autoClear = false;\n        reductionInitial.forceFullscreenViewport = forceFullscreenViewport;\n        var w = this._sourceTexture.getRenderWidth(), h = this._sourceTexture.getRenderHeight();\n        reductionInitial.onApply = (function (w, h) {\n            return function (effect) {\n                effect.setTexture(\"sourceTexture\", _this._sourceTexture);\n                effect.setFloat2(\"texSize\", w, h);\n            };\n        })(w, h);\n        this._reductionSteps.push(reductionInitial);\n        var index = 1;\n        // create the additional steps\n        while (w > 1 || h > 1) {\n            w = Math.max(Math.round(w / 2), 1);\n            h = Math.max(Math.round(h / 2), 1);\n            var reduction = new PostProcess(\"Reduction phase \" + index, \"minmaxRedux\", // shader\n            [\"texSize\"], null, { width: w, height: h }, // options\n            null, // camera\n            1, // sampling\n            scene.getEngine(), // engine\n            false, // reusable\n            \"#define \" + (w == 1 && h == 1 ? \"LAST\" : w == 1 || h == 1 ? \"ONEBEFORELAST\" : \"MAIN\"), // defines\n            type, undefined, undefined, undefined, 7);\n            reduction.autoClear = false;\n            reduction.forceFullscreenViewport = forceFullscreenViewport;\n            reduction.onApply = (function (w, h) {\n                return function (effect) {\n                    if (w == 1 || h == 1) {\n                        effect.setInt2(\"texSize\", w, h);\n                    }\n                    else {\n                        effect.setFloat2(\"texSize\", w, h);\n                    }\n                };\n            })(w, h);\n            this._reductionSteps.push(reduction);\n            index++;\n            if (w == 1 && h == 1) {\n                var func = function (w, h, reduction) {\n                    var buffer = new Float32Array(4 * w * h), minmax = { min: 0, max: 0 };\n                    return function () {\n                        scene.getEngine()._readTexturePixels(reduction.inputTexture.texture, w, h, -1, 0, buffer, false);\n                        minmax.min = buffer[0];\n                        minmax.max = buffer[1];\n                        _this.onAfterReductionPerformed.notifyObservers(minmax);\n                    };\n                };\n                reduction.onAfterRenderObservable.add(func(w, h, reduction));\n            }\n        }\n    };\n    Object.defineProperty(MinMaxReducer.prototype, \"refreshRate\", {\n        /**\n         * Defines the refresh rate of the computation.\n         * Use 0 to compute just once, 1 to compute on every frame, 2 to compute every two frames and so on...\n         */\n        get: function () {\n            return this._sourceTexture ? this._sourceTexture.refreshRate : -1;\n        },\n        set: function (value) {\n            if (this._sourceTexture) {\n                this._sourceTexture.refreshRate = value;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MinMaxReducer.prototype, \"activated\", {\n        /**\n         * Gets the activation status of the reducer\n         */\n        get: function () {\n            return this._activated;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Activates the reduction computation.\n     * When activated, the observers registered in onAfterReductionPerformed are\n     * called after the computation is performed\n     */\n    MinMaxReducer.prototype.activate = function () {\n        var _this = this;\n        if (this._onAfterUnbindObserver || !this._sourceTexture) {\n            return;\n        }\n        this._onAfterUnbindObserver = this._sourceTexture.onAfterUnbindObservable.add(function () {\n            var _a, _b;\n            var engine = _this._camera.getScene().getEngine();\n            (_a = engine._debugPushGroup) === null || _a === void 0 ? void 0 : _a.call(engine, \"min max reduction\", 1);\n            _this._reductionSteps[0].activate(_this._camera);\n            _this._postProcessManager.directRender(_this._reductionSteps, _this._reductionSteps[0].inputTexture, _this._forceFullscreenViewport);\n            engine.unBindFramebuffer(_this._reductionSteps[0].inputTexture, false);\n            (_b = engine._debugPopGroup) === null || _b === void 0 ? void 0 : _b.call(engine, 1);\n        });\n        this._activated = true;\n    };\n    /**\n     * Deactivates the reduction computation.\n     */\n    MinMaxReducer.prototype.deactivate = function () {\n        if (!this._onAfterUnbindObserver || !this._sourceTexture) {\n            return;\n        }\n        this._sourceTexture.onAfterUnbindObservable.remove(this._onAfterUnbindObserver);\n        this._onAfterUnbindObserver = null;\n        this._activated = false;\n    };\n    /**\n     * Disposes the min/max reducer\n     * @param disposeAll true to dispose all the resources. You should always call this function with true as the parameter (or without any parameter as it is the default one). This flag is meant to be used internally.\n     */\n    MinMaxReducer.prototype.dispose = function (disposeAll) {\n        if (disposeAll === void 0) { disposeAll = true; }\n        if (disposeAll) {\n            this.onAfterReductionPerformed.clear();\n            if (this._onContextRestoredObserver) {\n                this._camera.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver);\n                this._onContextRestoredObserver = null;\n            }\n        }\n        this.deactivate();\n        if (this._reductionSteps) {\n            for (var i = 0; i < this._reductionSteps.length; ++i) {\n                this._reductionSteps[i].dispose();\n            }\n            this._reductionSteps = null;\n        }\n        if (this._postProcessManager && disposeAll) {\n            this._postProcessManager.dispose();\n        }\n        this._sourceTexture = null;\n    };\n    return MinMaxReducer;\n}());\nexport { MinMaxReducer };\n//# sourceMappingURL=minMaxReducer.js.map","/**\n * A class serves as a medium between the observable and its observers\n */\nvar EventState = /** @class */ (function () {\n    /**\n     * Create a new EventState\n     * @param mask defines the mask associated with this state\n     * @param skipNextObservers defines a flag which will instruct the observable to skip following observers when set to true\n     * @param target defines the original target of the state\n     * @param currentTarget defines the current target of the state\n     */\n    function EventState(mask, skipNextObservers, target, currentTarget) {\n        if (skipNextObservers === void 0) { skipNextObservers = false; }\n        this.initialize(mask, skipNextObservers, target, currentTarget);\n    }\n    /**\n     * Initialize the current event state\n     * @param mask defines the mask associated with this state\n     * @param skipNextObservers defines a flag which will instruct the observable to skip following observers when set to true\n     * @param target defines the original target of the state\n     * @param currentTarget defines the current target of the state\n     * @returns the current event state\n     */\n    EventState.prototype.initialize = function (mask, skipNextObservers, target, currentTarget) {\n        if (skipNextObservers === void 0) { skipNextObservers = false; }\n        this.mask = mask;\n        this.skipNextObservers = skipNextObservers;\n        this.target = target;\n        this.currentTarget = currentTarget;\n        return this;\n    };\n    return EventState;\n}());\nexport { EventState };\n/**\n * Represent an Observer registered to a given Observable object.\n */\nvar Observer = /** @class */ (function () {\n    /**\n     * Creates a new observer\n     * @param callback defines the callback to call when the observer is notified\n     * @param mask defines the mask of the observer (used to filter notifications)\n     * @param scope defines the current scope used to restore the JS context\n     */\n    function Observer(\n    /**\n     * Defines the callback to call when the observer is notified\n     */\n    callback, \n    /**\n     * Defines the mask of the observer (used to filter notifications)\n     */\n    mask, \n    /**\n     * Defines the current scope used to restore the JS context\n     */\n    scope) {\n        if (scope === void 0) { scope = null; }\n        this.callback = callback;\n        this.mask = mask;\n        this.scope = scope;\n        /** @hidden */\n        this._willBeUnregistered = false;\n        /**\n         * Gets or sets a property defining that the observer as to be unregistered after the next notification\n         */\n        this.unregisterOnNextCall = false;\n    }\n    return Observer;\n}());\nexport { Observer };\n/**\n * Represent a list of observers registered to multiple Observables object.\n */\nvar MultiObserver = /** @class */ (function () {\n    function MultiObserver() {\n    }\n    /**\n     * Release associated resources\n     */\n    MultiObserver.prototype.dispose = function () {\n        if (this._observers && this._observables) {\n            for (var index = 0; index < this._observers.length; index++) {\n                this._observables[index].remove(this._observers[index]);\n            }\n        }\n        this._observers = null;\n        this._observables = null;\n    };\n    /**\n     * Raise a callback when one of the observable will notify\n     * @param observables defines a list of observables to watch\n     * @param callback defines the callback to call on notification\n     * @param mask defines the mask used to filter notifications\n     * @param scope defines the current scope used to restore the JS context\n     * @returns the new MultiObserver\n     */\n    MultiObserver.Watch = function (observables, callback, mask, scope) {\n        if (mask === void 0) { mask = -1; }\n        if (scope === void 0) { scope = null; }\n        var result = new MultiObserver();\n        result._observers = new Array();\n        result._observables = observables;\n        for (var _i = 0, observables_1 = observables; _i < observables_1.length; _i++) {\n            var observable = observables_1[_i];\n            var observer = observable.add(callback, mask, false, scope);\n            if (observer) {\n                result._observers.push(observer);\n            }\n        }\n        return result;\n    };\n    return MultiObserver;\n}());\nexport { MultiObserver };\n/**\n * The Observable class is a simple implementation of the Observable pattern.\n *\n * There's one slight particularity though: a given Observable can notify its observer using a particular mask value, only the Observers registered with this mask value will be notified.\n * This enable a more fine grained execution without having to rely on multiple different Observable objects.\n * For instance you may have a given Observable that have four different types of notifications: Move (mask = 0x01), Stop (mask = 0x02), Turn Right (mask = 0X04), Turn Left (mask = 0X08).\n * A given observer can register itself with only Move and Stop (mask = 0x03), then it will only be notified when one of these two occurs and will never be for Turn Left/Right.\n */\nvar Observable = /** @class */ (function () {\n    /**\n     * Creates a new observable\n     * @param onObserverAdded defines a callback to call when a new observer is added\n     */\n    function Observable(onObserverAdded) {\n        this._observers = new Array();\n        this._eventState = new EventState(0);\n        if (onObserverAdded) {\n            this._onObserverAdded = onObserverAdded;\n        }\n    }\n    /**\n     * Create an observable from a Promise.\n     * @param promise a promise to observe for fulfillment.\n     * @param onErrorObservable an observable to notify if a promise was rejected.\n     * @returns the new Observable\n     */\n    Observable.FromPromise = function (promise, onErrorObservable) {\n        var observable = new Observable();\n        promise\n            .then(function (ret) {\n            observable.notifyObservers(ret);\n        })\n            .catch(function (err) {\n            if (onErrorObservable) {\n                onErrorObservable.notifyObservers(err);\n            }\n            else {\n                throw err;\n            }\n        });\n        return observable;\n    };\n    Object.defineProperty(Observable.prototype, \"observers\", {\n        /**\n         * Gets the list of observers\n         */\n        get: function () {\n            return this._observers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Create a new Observer with the specified callback\n     * @param callback the callback that will be executed for that Observer\n     * @param mask the mask used to filter observers\n     * @param insertFirst if true the callback will be inserted at the first position, hence executed before the others ones. If false (default behavior) the callback will be inserted at the last position, executed after all the others already present.\n     * @param scope optional scope for the callback to be called from\n     * @param unregisterOnFirstCall defines if the observer as to be unregistered after the next notification\n     * @returns the new observer created for the callback\n     */\n    Observable.prototype.add = function (callback, mask, insertFirst, scope, unregisterOnFirstCall) {\n        if (mask === void 0) { mask = -1; }\n        if (insertFirst === void 0) { insertFirst = false; }\n        if (scope === void 0) { scope = null; }\n        if (unregisterOnFirstCall === void 0) { unregisterOnFirstCall = false; }\n        if (!callback) {\n            return null;\n        }\n        var observer = new Observer(callback, mask, scope);\n        observer.unregisterOnNextCall = unregisterOnFirstCall;\n        if (insertFirst) {\n            this._observers.unshift(observer);\n        }\n        else {\n            this._observers.push(observer);\n        }\n        if (this._onObserverAdded) {\n            this._onObserverAdded(observer);\n        }\n        return observer;\n    };\n    /**\n     * Create a new Observer with the specified callback and unregisters after the next notification\n     * @param callback the callback that will be executed for that Observer\n     * @returns the new observer created for the callback\n     */\n    Observable.prototype.addOnce = function (callback) {\n        return this.add(callback, undefined, undefined, undefined, true);\n    };\n    /**\n     * Remove an Observer from the Observable object\n     * @param observer the instance of the Observer to remove\n     * @returns false if it doesn't belong to this Observable\n     */\n    Observable.prototype.remove = function (observer) {\n        if (!observer) {\n            return false;\n        }\n        var index = this._observers.indexOf(observer);\n        if (index !== -1) {\n            this._deferUnregister(observer);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Remove a callback from the Observable object\n     * @param callback the callback to remove\n     * @param scope optional scope. If used only the callbacks with this scope will be removed\n     * @returns false if it doesn't belong to this Observable\n     */\n    Observable.prototype.removeCallback = function (callback, scope) {\n        for (var index = 0; index < this._observers.length; index++) {\n            var observer = this._observers[index];\n            if (observer._willBeUnregistered) {\n                continue;\n            }\n            if (observer.callback === callback && (!scope || scope === observer.scope)) {\n                this._deferUnregister(observer);\n                return true;\n            }\n        }\n        return false;\n    };\n    Observable.prototype._deferUnregister = function (observer) {\n        var _this = this;\n        observer.unregisterOnNextCall = false;\n        observer._willBeUnregistered = true;\n        setTimeout(function () {\n            _this._remove(observer);\n        }, 0);\n    };\n    // This should only be called when not iterating over _observers to avoid callback skipping.\n    // Removes an observer from the _observer Array.\n    Observable.prototype._remove = function (observer) {\n        if (!observer) {\n            return false;\n        }\n        var index = this._observers.indexOf(observer);\n        if (index !== -1) {\n            this._observers.splice(index, 1);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Moves the observable to the top of the observer list making it get called first when notified\n     * @param observer the observer to move\n     */\n    Observable.prototype.makeObserverTopPriority = function (observer) {\n        this._remove(observer);\n        this._observers.unshift(observer);\n    };\n    /**\n     * Moves the observable to the bottom of the observer list making it get called last when notified\n     * @param observer the observer to move\n     */\n    Observable.prototype.makeObserverBottomPriority = function (observer) {\n        this._remove(observer);\n        this._observers.push(observer);\n    };\n    /**\n     * Notify all Observers by calling their respective callback with the given data\n     * Will return true if all observers were executed, false if an observer set skipNextObservers to true, then prevent the subsequent ones to execute\n     * @param eventData defines the data to send to all observers\n     * @param mask defines the mask of the current notification (observers with incompatible mask (ie mask & observer.mask === 0) will not be notified)\n     * @param target defines the original target of the state\n     * @param currentTarget defines the current target of the state\n     * @param userInfo defines any user info to send to observers\n     * @returns false if the complete observer chain was not processed (because one observer set the skipNextObservers to true)\n     */\n    Observable.prototype.notifyObservers = function (eventData, mask, target, currentTarget, userInfo) {\n        if (mask === void 0) { mask = -1; }\n        if (!this._observers.length) {\n            return true;\n        }\n        var state = this._eventState;\n        state.mask = mask;\n        state.target = target;\n        state.currentTarget = currentTarget;\n        state.skipNextObservers = false;\n        state.lastReturnValue = eventData;\n        state.userInfo = userInfo;\n        for (var _i = 0, _a = this._observers; _i < _a.length; _i++) {\n            var obs = _a[_i];\n            if (obs._willBeUnregistered) {\n                continue;\n            }\n            if (obs.mask & mask) {\n                if (obs.scope) {\n                    state.lastReturnValue = obs.callback.apply(obs.scope, [eventData, state]);\n                }\n                else {\n                    state.lastReturnValue = obs.callback(eventData, state);\n                }\n                if (obs.unregisterOnNextCall) {\n                    this._deferUnregister(obs);\n                }\n            }\n            if (state.skipNextObservers) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Calling this will execute each callback, expecting it to be a promise or return a value.\n     * If at any point in the chain one function fails, the promise will fail and the execution will not continue.\n     * This is useful when a chain of events (sometimes async events) is needed to initialize a certain object\n     * and it is crucial that all callbacks will be executed.\n     * The order of the callbacks is kept, callbacks are not executed parallel.\n     *\n     * @param eventData The data to be sent to each callback\n     * @param mask is used to filter observers defaults to -1\n     * @param target defines the callback target (see EventState)\n     * @param currentTarget defines he current object in the bubbling phase\n     * @param userInfo defines any user info to send to observers\n     * @returns {Promise<T>} will return a Promise than resolves when all callbacks executed successfully.\n     */\n    Observable.prototype.notifyObserversWithPromise = function (eventData, mask, target, currentTarget, userInfo) {\n        var _this = this;\n        if (mask === void 0) { mask = -1; }\n        // create an empty promise\n        var p = Promise.resolve(eventData);\n        // no observers? return this promise.\n        if (!this._observers.length) {\n            return p;\n        }\n        var state = this._eventState;\n        state.mask = mask;\n        state.target = target;\n        state.currentTarget = currentTarget;\n        state.skipNextObservers = false;\n        state.userInfo = userInfo;\n        // execute one callback after another (not using Promise.all, the order is important)\n        this._observers.forEach(function (obs) {\n            if (state.skipNextObservers) {\n                return;\n            }\n            if (obs._willBeUnregistered) {\n                return;\n            }\n            if (obs.mask & mask) {\n                if (obs.scope) {\n                    p = p.then(function (lastReturnedValue) {\n                        state.lastReturnValue = lastReturnedValue;\n                        return obs.callback.apply(obs.scope, [eventData, state]);\n                    });\n                }\n                else {\n                    p = p.then(function (lastReturnedValue) {\n                        state.lastReturnValue = lastReturnedValue;\n                        return obs.callback(eventData, state);\n                    });\n                }\n                if (obs.unregisterOnNextCall) {\n                    _this._deferUnregister(obs);\n                }\n            }\n        });\n        // return the eventData\n        return p.then(function () {\n            return eventData;\n        });\n    };\n    /**\n     * Notify a specific observer\n     * @param observer defines the observer to notify\n     * @param eventData defines the data to be sent to each callback\n     * @param mask is used to filter observers defaults to -1\n     */\n    Observable.prototype.notifyObserver = function (observer, eventData, mask) {\n        if (mask === void 0) { mask = -1; }\n        if (observer._willBeUnregistered) {\n            return;\n        }\n        var state = this._eventState;\n        state.mask = mask;\n        state.skipNextObservers = false;\n        observer.callback(eventData, state);\n        if (observer.unregisterOnNextCall) {\n            this._deferUnregister(observer);\n        }\n    };\n    /**\n     * Gets a boolean indicating if the observable has at least one observer\n     * @returns true is the Observable has at least one Observer registered\n     */\n    Observable.prototype.hasObservers = function () {\n        return this._observers.length > 0;\n    };\n    /**\n     * Clear the list of observers\n     */\n    Observable.prototype.clear = function () {\n        this._observers = new Array();\n        this._onObserverAdded = null;\n    };\n    /**\n     * Clone the current observable\n     * @returns a new observable\n     */\n    Observable.prototype.clone = function () {\n        var result = new Observable();\n        result._observers = this._observers.slice(0);\n        return result;\n    };\n    /**\n     * Does this observable handles observer registered with a given mask\n     * @param mask defines the mask to be tested\n     * @return whether or not one observer registered with the given mask is handled\n     **/\n    Observable.prototype.hasSpecificMask = function (mask) {\n        if (mask === void 0) { mask = -1; }\n        for (var _i = 0, _a = this._observers; _i < _a.length; _i++) {\n            var obs = _a[_i];\n            if (obs.mask & mask || obs.mask === mask) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return Observable;\n}());\nexport { Observable };\n//# sourceMappingURL=observable.js.map","import { PrecisionDate } from \"./precisionDate.js\";\n/**\n * This class is used to track a performance counter which is number based.\n * The user has access to many properties which give statistics of different nature.\n *\n * The implementer can track two kinds of Performance Counter: time and count.\n * For time you can optionally call fetchNewFrame() to notify the start of a new frame to monitor, then call beginMonitoring() to start and endMonitoring() to record the lapsed time. endMonitoring takes a newFrame parameter for you to specify if the monitored time should be set for a new frame or accumulated to the current frame being monitored.\n * For count you first have to call fetchNewFrame() to notify the start of a new frame to monitor, then call addCount() how many time required to increment the count value you monitor.\n */\nvar PerfCounter = /** @class */ (function () {\n    /**\n     * Creates a new counter\n     */\n    function PerfCounter() {\n        this._startMonitoringTime = 0;\n        this._min = 0;\n        this._max = 0;\n        this._average = 0;\n        this._lastSecAverage = 0;\n        this._current = 0;\n        this._totalValueCount = 0;\n        this._totalAccumulated = 0;\n        this._lastSecAccumulated = 0;\n        this._lastSecTime = 0;\n        this._lastSecValueCount = 0;\n    }\n    Object.defineProperty(PerfCounter.prototype, \"min\", {\n        /**\n         * Returns the smallest value ever\n         */\n        get: function () {\n            return this._min;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerfCounter.prototype, \"max\", {\n        /**\n         * Returns the biggest value ever\n         */\n        get: function () {\n            return this._max;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerfCounter.prototype, \"average\", {\n        /**\n         * Returns the average value since the performance counter is running\n         */\n        get: function () {\n            return this._average;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerfCounter.prototype, \"lastSecAverage\", {\n        /**\n         * Returns the average value of the last second the counter was monitored\n         */\n        get: function () {\n            return this._lastSecAverage;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerfCounter.prototype, \"current\", {\n        /**\n         * Returns the current value\n         */\n        get: function () {\n            return this._current;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerfCounter.prototype, \"total\", {\n        /**\n         * Gets the accumulated total\n         */\n        get: function () {\n            return this._totalAccumulated;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerfCounter.prototype, \"count\", {\n        /**\n         * Gets the total value count\n         */\n        get: function () {\n            return this._totalValueCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Call this method to start monitoring a new frame.\n     * This scenario is typically used when you accumulate monitoring time many times for a single frame, you call this method at the start of the frame, then beginMonitoring to start recording and endMonitoring(false) to accumulated the recorded time to the PerfCounter or addCount() to accumulate a monitored count.\n     */\n    PerfCounter.prototype.fetchNewFrame = function () {\n        this._totalValueCount++;\n        this._current = 0;\n        this._lastSecValueCount++;\n    };\n    /**\n     * Call this method to monitor a count of something (e.g. mesh drawn in viewport count)\n     * @param newCount the count value to add to the monitored count\n     * @param fetchResult true when it's the last time in the frame you add to the counter and you wish to update the statistics properties (min/max/average), false if you only want to update statistics.\n     */\n    PerfCounter.prototype.addCount = function (newCount, fetchResult) {\n        if (!PerfCounter.Enabled) {\n            return;\n        }\n        this._current += newCount;\n        if (fetchResult) {\n            this._fetchResult();\n        }\n    };\n    /**\n     * Start monitoring this performance counter\n     */\n    PerfCounter.prototype.beginMonitoring = function () {\n        if (!PerfCounter.Enabled) {\n            return;\n        }\n        this._startMonitoringTime = PrecisionDate.Now;\n    };\n    /**\n     * Compute the time lapsed since the previous beginMonitoring() call.\n     * @param newFrame true by default to fetch the result and monitor a new frame, if false the time monitored will be added to the current frame counter\n     */\n    PerfCounter.prototype.endMonitoring = function (newFrame) {\n        if (newFrame === void 0) { newFrame = true; }\n        if (!PerfCounter.Enabled) {\n            return;\n        }\n        if (newFrame) {\n            this.fetchNewFrame();\n        }\n        var currentTime = PrecisionDate.Now;\n        this._current = currentTime - this._startMonitoringTime;\n        if (newFrame) {\n            this._fetchResult();\n        }\n    };\n    PerfCounter.prototype._fetchResult = function () {\n        this._totalAccumulated += this._current;\n        this._lastSecAccumulated += this._current;\n        // Min/Max update\n        this._min = Math.min(this._min, this._current);\n        this._max = Math.max(this._max, this._current);\n        this._average = this._totalAccumulated / this._totalValueCount;\n        // Reset last sec?\n        var now = PrecisionDate.Now;\n        if (now - this._lastSecTime > 1000) {\n            this._lastSecAverage = this._lastSecAccumulated / this._lastSecValueCount;\n            this._lastSecTime = now;\n            this._lastSecAccumulated = 0;\n            this._lastSecValueCount = 0;\n        }\n    };\n    /**\n     * Gets or sets a global boolean to turn on and off all the counters\n     */\n    PerfCounter.Enabled = true;\n    return PerfCounter;\n}());\nexport { PerfCounter };\n//# sourceMappingURL=perfCounter.js.map","import { PrecisionDate } from \"./precisionDate.js\";\n/**\n * Performance monitor tracks rolling average frame-time and frame-time variance over a user defined sliding-window\n */\nvar PerformanceMonitor = /** @class */ (function () {\n    /**\n     * constructor\n     * @param frameSampleSize The number of samples required to saturate the sliding window\n     */\n    function PerformanceMonitor(frameSampleSize) {\n        if (frameSampleSize === void 0) { frameSampleSize = 30; }\n        this._enabled = true;\n        this._rollingFrameTime = new RollingAverage(frameSampleSize);\n    }\n    /**\n     * Samples current frame\n     * @param timeMs A timestamp in milliseconds of the current frame to compare with other frames\n     */\n    PerformanceMonitor.prototype.sampleFrame = function (timeMs) {\n        if (timeMs === void 0) { timeMs = PrecisionDate.Now; }\n        if (!this._enabled) {\n            return;\n        }\n        if (this._lastFrameTimeMs != null) {\n            var dt = timeMs - this._lastFrameTimeMs;\n            this._rollingFrameTime.add(dt);\n        }\n        this._lastFrameTimeMs = timeMs;\n    };\n    Object.defineProperty(PerformanceMonitor.prototype, \"averageFrameTime\", {\n        /**\n         * Returns the average frame time in milliseconds over the sliding window (or the subset of frames sampled so far)\n         */\n        get: function () {\n            return this._rollingFrameTime.average;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerformanceMonitor.prototype, \"averageFrameTimeVariance\", {\n        /**\n         * Returns the variance frame time in milliseconds over the sliding window (or the subset of frames sampled so far)\n         */\n        get: function () {\n            return this._rollingFrameTime.variance;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerformanceMonitor.prototype, \"instantaneousFrameTime\", {\n        /**\n         * Returns the frame time of the most recent frame\n         */\n        get: function () {\n            return this._rollingFrameTime.history(0);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerformanceMonitor.prototype, \"averageFPS\", {\n        /**\n         * Returns the average framerate in frames per second over the sliding window (or the subset of frames sampled so far)\n         */\n        get: function () {\n            return 1000.0 / this._rollingFrameTime.average;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerformanceMonitor.prototype, \"instantaneousFPS\", {\n        /**\n         * Returns the average framerate in frames per second using the most recent frame time\n         */\n        get: function () {\n            var history = this._rollingFrameTime.history(0);\n            if (history === 0) {\n                return 0;\n            }\n            return 1000.0 / history;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PerformanceMonitor.prototype, \"isSaturated\", {\n        /**\n         * Returns true if enough samples have been taken to completely fill the sliding window\n         */\n        get: function () {\n            return this._rollingFrameTime.isSaturated();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Enables contributions to the sliding window sample set\n     */\n    PerformanceMonitor.prototype.enable = function () {\n        this._enabled = true;\n    };\n    /**\n     * Disables contributions to the sliding window sample set\n     * Samples will not be interpolated over the disabled period\n     */\n    PerformanceMonitor.prototype.disable = function () {\n        this._enabled = false;\n        //clear last sample to avoid interpolating over the disabled period when next enabled\n        this._lastFrameTimeMs = null;\n    };\n    Object.defineProperty(PerformanceMonitor.prototype, \"isEnabled\", {\n        /**\n         * Returns true if sampling is enabled\n         */\n        get: function () {\n            return this._enabled;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Resets performance monitor\n     */\n    PerformanceMonitor.prototype.reset = function () {\n        //clear last sample to avoid interpolating over the disabled period when next enabled\n        this._lastFrameTimeMs = null;\n        //wipe record\n        this._rollingFrameTime.reset();\n    };\n    return PerformanceMonitor;\n}());\nexport { PerformanceMonitor };\n/**\n * RollingAverage\n *\n * Utility to efficiently compute the rolling average and variance over a sliding window of samples\n */\nvar RollingAverage = /** @class */ (function () {\n    /**\n     * constructor\n     * @param length The number of samples required to saturate the sliding window\n     */\n    function RollingAverage(length) {\n        this._samples = new Array(length);\n        this.reset();\n    }\n    /**\n     * Adds a sample to the sample set\n     * @param v The sample value\n     */\n    RollingAverage.prototype.add = function (v) {\n        //http://en.wikipedia.org/wiki/Algorithms_for_calculating_variance\n        var delta;\n        //we need to check if we've already wrapped round\n        if (this.isSaturated()) {\n            //remove bottom of stack from mean\n            var bottomValue = this._samples[this._pos];\n            delta = bottomValue - this.average;\n            this.average -= delta / (this._sampleCount - 1);\n            this._m2 -= delta * (bottomValue - this.average);\n        }\n        else {\n            this._sampleCount++;\n        }\n        //add new value to mean\n        delta = v - this.average;\n        this.average += delta / this._sampleCount;\n        this._m2 += delta * (v - this.average);\n        //set the new variance\n        this.variance = this._m2 / (this._sampleCount - 1);\n        this._samples[this._pos] = v;\n        this._pos++;\n        this._pos %= this._samples.length; //positive wrap around\n    };\n    /**\n     * Returns previously added values or null if outside of history or outside the sliding window domain\n     * @param i Index in history. For example, pass 0 for the most recent value and 1 for the value before that\n     * @return Value previously recorded with add() or null if outside of range\n     */\n    RollingAverage.prototype.history = function (i) {\n        if (i >= this._sampleCount || i >= this._samples.length) {\n            return 0;\n        }\n        var i0 = this._wrapPosition(this._pos - 1.0);\n        return this._samples[this._wrapPosition(i0 - i)];\n    };\n    /**\n     * Returns true if enough samples have been taken to completely fill the sliding window\n     * @return true if sample-set saturated\n     */\n    RollingAverage.prototype.isSaturated = function () {\n        return this._sampleCount >= this._samples.length;\n    };\n    /**\n     * Resets the rolling average (equivalent to 0 samples taken so far)\n     */\n    RollingAverage.prototype.reset = function () {\n        this.average = 0;\n        this.variance = 0;\n        this._sampleCount = 0;\n        this._pos = 0;\n        this._m2 = 0;\n    };\n    /**\n     * Wraps a value around the sample range boundaries\n     * @param i Position in sample range, for example if the sample length is 5, and i is -3, then 2 will be returned.\n     * @return Wrapped position in sample range\n     */\n    RollingAverage.prototype._wrapPosition = function (i) {\n        var max = this._samples.length;\n        return ((i % max) + max) % max;\n    };\n    return RollingAverage;\n}());\nexport { RollingAverage };\n//# sourceMappingURL=performanceMonitor.js.map","import { Vector3, Matrix } from \"../Maths/math.vector.js\";\n/**\n * Class containing a set of static utilities functions for managing Pivots\n * @hidden\n */\nvar PivotTools = /** @class */ (function () {\n    function PivotTools() {\n    }\n    /**\n     * @param mesh\n     * @hidden\n     */\n    PivotTools._RemoveAndStorePivotPoint = function (mesh) {\n        if (mesh && PivotTools._PivotCached === 0) {\n            // Save old pivot and set pivot to 0,0,0\n            mesh.getPivotPointToRef(PivotTools._OldPivotPoint);\n            PivotTools._PivotPostMultiplyPivotMatrix = mesh._postMultiplyPivotMatrix;\n            if (!PivotTools._OldPivotPoint.equalsToFloats(0, 0, 0)) {\n                mesh.setPivotMatrix(Matrix.IdentityReadOnly);\n                PivotTools._OldPivotPoint.subtractToRef(mesh.getPivotPoint(), PivotTools._PivotTranslation);\n                PivotTools._PivotTmpVector.copyFromFloats(1, 1, 1);\n                PivotTools._PivotTmpVector.subtractInPlace(mesh.scaling);\n                PivotTools._PivotTmpVector.multiplyInPlace(PivotTools._PivotTranslation);\n                mesh.position.addInPlace(PivotTools._PivotTmpVector);\n            }\n        }\n        PivotTools._PivotCached++;\n    };\n    /**\n     * @param mesh\n     * @hidden\n     */\n    PivotTools._RestorePivotPoint = function (mesh) {\n        if (mesh && !PivotTools._OldPivotPoint.equalsToFloats(0, 0, 0) && PivotTools._PivotCached === 1) {\n            mesh.setPivotPoint(PivotTools._OldPivotPoint);\n            mesh._postMultiplyPivotMatrix = PivotTools._PivotPostMultiplyPivotMatrix;\n            PivotTools._PivotTmpVector.copyFromFloats(1, 1, 1);\n            PivotTools._PivotTmpVector.subtractInPlace(mesh.scaling);\n            PivotTools._PivotTmpVector.multiplyInPlace(PivotTools._PivotTranslation);\n            mesh.position.subtractInPlace(PivotTools._PivotTmpVector);\n        }\n        this._PivotCached--;\n    };\n    // Stores the state of the pivot cache (_oldPivotPoint, _pivotTranslation)\n    // store/remove pivot point should only be applied during their outermost calls\n    PivotTools._PivotCached = 0;\n    PivotTools._OldPivotPoint = new Vector3();\n    PivotTools._PivotTranslation = new Vector3();\n    PivotTools._PivotTmpVector = new Vector3();\n    PivotTools._PivotPostMultiplyPivotMatrix = false;\n    return PivotTools;\n}());\nexport { PivotTools };\n//# sourceMappingURL=pivotTools.js.map","import { DomManagement } from \"./domManagement.js\";\n/**\n * Class containing a set of static utilities functions for precision date\n */\nvar PrecisionDate = /** @class */ (function () {\n    function PrecisionDate() {\n    }\n    Object.defineProperty(PrecisionDate, \"Now\", {\n        /**\n         * Gets either window.performance.now() if supported or Date.now() else\n         */\n        get: function () {\n            if (DomManagement.IsWindowObjectExist() && window.performance && window.performance.now) {\n                return window.performance.now();\n            }\n            return Date.now();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return PrecisionDate;\n}());\nexport { PrecisionDate };\n//# sourceMappingURL=precisionDate.js.map","/**\n * Class used to define a retry strategy when error happens while loading assets\n */\nvar RetryStrategy = /** @class */ (function () {\n    function RetryStrategy() {\n    }\n    /**\n     * Function used to defines an exponential back off strategy\n     * @param maxRetries defines the maximum number of retries (3 by default)\n     * @param baseInterval defines the interval between retries\n     * @returns the strategy function to use\n     */\n    RetryStrategy.ExponentialBackoff = function (maxRetries, baseInterval) {\n        if (maxRetries === void 0) { maxRetries = 3; }\n        if (baseInterval === void 0) { baseInterval = 500; }\n        return function (url, request, retryIndex) {\n            if (request.status !== 0 || retryIndex >= maxRetries || url.indexOf(\"file:\") !== -1) {\n                return -1;\n            }\n            return Math.pow(2, retryIndex) * baseInterval;\n        };\n    };\n    return RetryStrategy;\n}());\nexport { RetryStrategy };\n//# sourceMappingURL=retryStrategy.js.map","\nimport { PostProcess } from \"../PostProcesses/postProcess.js\";\nimport \"../Shaders/rgbdDecode.fragment.js\";\nimport \"../Engines/Extensions/engine.renderTarget.js\";\nimport { ApplyPostProcess } from \"./textureTools.js\";\n/**\n * Class used to host RGBD texture specific utilities\n */\nvar RGBDTextureTools = /** @class */ (function () {\n    function RGBDTextureTools() {\n    }\n    /**\n     * Expand the RGBD Texture from RGBD to Half Float if possible.\n     * @param texture the texture to expand.\n     */\n    RGBDTextureTools.ExpandRGBDTexture = function (texture) {\n        var internalTexture = texture._texture;\n        if (!internalTexture || !texture.isRGBD) {\n            return;\n        }\n        // Gets everything ready.\n        var engine = internalTexture.getEngine();\n        var caps = engine.getCaps();\n        var isReady = internalTexture.isReady;\n        var expandTexture = false;\n        // If half float available we can uncompress the texture\n        if (caps.textureHalfFloatRender && caps.textureHalfFloatLinearFiltering) {\n            expandTexture = true;\n            internalTexture.type = 2;\n        }\n        // If full float available we can uncompress the texture\n        else if (caps.textureFloatRender && caps.textureFloatLinearFiltering) {\n            expandTexture = true;\n            internalTexture.type = 1;\n        }\n        if (expandTexture) {\n            // Do not use during decode.\n            internalTexture.isReady = false;\n            internalTexture._isRGBD = false;\n            internalTexture.invertY = false;\n        }\n        var expandRGBDTexture = function () {\n            // Expand the texture if possible\n            if (expandTexture) {\n                // Simply run through the decode PP.\n                var rgbdPostProcess_1 = new PostProcess(\"rgbdDecode\", \"rgbdDecode\", null, null, 1, null, 3, engine, false, undefined, internalTexture.type, undefined, null, false);\n                rgbdPostProcess_1.externalTextureSamplerBinding = true;\n                // Hold the output of the decoding.\n                var expandedTexture_1 = engine.createRenderTargetTexture(internalTexture.width, {\n                    generateDepthBuffer: false,\n                    generateMipMaps: false,\n                    generateStencilBuffer: false,\n                    samplingMode: internalTexture.samplingMode,\n                    type: internalTexture.type,\n                    format: 5,\n                });\n                rgbdPostProcess_1.getEffect().executeWhenCompiled(function () {\n                    // PP Render Pass\n                    rgbdPostProcess_1.onApply = function (effect) {\n                        effect._bindTexture(\"textureSampler\", internalTexture);\n                        effect.setFloat2(\"scale\", 1, 1);\n                    };\n                    texture.getScene().postProcessManager.directRender([rgbdPostProcess_1], expandedTexture_1, true);\n                    // Cleanup\n                    engine.restoreDefaultFramebuffer();\n                    engine._releaseTexture(internalTexture);\n                    if (rgbdPostProcess_1) {\n                        rgbdPostProcess_1.dispose();\n                    }\n                    // Internal Swap\n                    expandedTexture_1._swapAndDie(internalTexture);\n                    // Ready to get rolling again.\n                    internalTexture.isReady = true;\n                });\n            }\n        };\n        if (isReady) {\n            expandRGBDTexture();\n        }\n        else {\n            texture.onLoadObservable.addOnce(expandRGBDTexture);\n        }\n    };\n    /**\n     * Encode the texture to RGBD if possible.\n     * @param internalTexture the texture to encode\n     * @param scene the scene hosting the texture\n     * @param outputTextureType type of the texture in which the encoding is performed\n     * @return a promise with the internalTexture having its texture replaced by the result of the processing\n     */\n    RGBDTextureTools.EncodeTextureToRGBD = function (internalTexture, scene, outputTextureType) {\n        if (outputTextureType === void 0) { outputTextureType = 0; }\n        return ApplyPostProcess(\"rgbdEncode\", internalTexture, scene, outputTextureType, 1, 5);\n    };\n    return RGBDTextureTools;\n}());\nexport { RGBDTextureTools };\n//# sourceMappingURL=rgbdTextureTools.js.map","import { __extends } from \"tslib\";\n/**\n * Defines an GC Friendly array where the backfield array do not shrink to prevent over allocations.\n */\nvar SmartArray = /** @class */ (function () {\n    /**\n     * Instantiates a Smart Array.\n     * @param capacity defines the default capacity of the array.\n     */\n    function SmartArray(capacity) {\n        /**\n         * The active length of the array.\n         */\n        this.length = 0;\n        this.data = new Array(capacity);\n        this._id = SmartArray._GlobalId++;\n    }\n    /**\n     * Pushes a value at the end of the active data.\n     * @param value defines the object to push in the array.\n     */\n    SmartArray.prototype.push = function (value) {\n        this.data[this.length++] = value;\n        if (this.length > this.data.length) {\n            this.data.length *= 2;\n        }\n    };\n    /**\n     * Iterates over the active data and apply the lambda to them.\n     * @param func defines the action to apply on each value.\n     */\n    SmartArray.prototype.forEach = function (func) {\n        for (var index = 0; index < this.length; index++) {\n            func(this.data[index]);\n        }\n    };\n    /**\n     * Sorts the full sets of data.\n     * @param compareFn defines the comparison function to apply.\n     */\n    SmartArray.prototype.sort = function (compareFn) {\n        this.data.sort(compareFn);\n    };\n    /**\n     * Resets the active data to an empty array.\n     */\n    SmartArray.prototype.reset = function () {\n        this.length = 0;\n    };\n    /**\n     * Releases all the data from the array as well as the array.\n     */\n    SmartArray.prototype.dispose = function () {\n        this.reset();\n        if (this.data) {\n            this.data.length = 0;\n            this.data = [];\n        }\n    };\n    /**\n     * Concats the active data with a given array.\n     * @param array defines the data to concatenate with.\n     */\n    SmartArray.prototype.concat = function (array) {\n        if (array.length === 0) {\n            return;\n        }\n        if (this.length + array.length > this.data.length) {\n            this.data.length = (this.length + array.length) * 2;\n        }\n        for (var index = 0; index < array.length; index++) {\n            this.data[this.length++] = (array.data || array)[index];\n        }\n    };\n    /**\n     * Returns the position of a value in the active data.\n     * @param value defines the value to find the index for\n     * @returns the index if found in the active data otherwise -1\n     */\n    SmartArray.prototype.indexOf = function (value) {\n        var position = this.data.indexOf(value);\n        if (position >= this.length) {\n            return -1;\n        }\n        return position;\n    };\n    /**\n     * Returns whether an element is part of the active data.\n     * @param value defines the value to look for\n     * @returns true if found in the active data otherwise false\n     */\n    SmartArray.prototype.contains = function (value) {\n        return this.indexOf(value) !== -1;\n    };\n    // Statics\n    SmartArray._GlobalId = 0;\n    return SmartArray;\n}());\nexport { SmartArray };\n/**\n * Defines an GC Friendly array where the backfield array do not shrink to prevent over allocations.\n * The data in this array can only be present once\n */\nvar SmartArrayNoDuplicate = /** @class */ (function (_super) {\n    __extends(SmartArrayNoDuplicate, _super);\n    function SmartArrayNoDuplicate() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._duplicateId = 0;\n        return _this;\n    }\n    /**\n     * Pushes a value at the end of the active data.\n     * THIS DOES NOT PREVENT DUPPLICATE DATA\n     * @param value defines the object to push in the array.\n     */\n    SmartArrayNoDuplicate.prototype.push = function (value) {\n        _super.prototype.push.call(this, value);\n        if (!value.__smartArrayFlags) {\n            value.__smartArrayFlags = {};\n        }\n        value.__smartArrayFlags[this._id] = this._duplicateId;\n    };\n    /**\n     * Pushes a value at the end of the active data.\n     * If the data is already present, it won t be added again\n     * @param value defines the object to push in the array.\n     * @returns true if added false if it was already present\n     */\n    SmartArrayNoDuplicate.prototype.pushNoDuplicate = function (value) {\n        if (value.__smartArrayFlags && value.__smartArrayFlags[this._id] === this._duplicateId) {\n            return false;\n        }\n        this.push(value);\n        return true;\n    };\n    /**\n     * Resets the active data to an empty array.\n     */\n    SmartArrayNoDuplicate.prototype.reset = function () {\n        _super.prototype.reset.call(this);\n        this._duplicateId++;\n    };\n    /**\n     * Concats the active data with a given array.\n     * This ensures no duplicate will be present in the result.\n     * @param array defines the data to concatenate with.\n     */\n    SmartArrayNoDuplicate.prototype.concatWithNoDuplicate = function (array) {\n        if (array.length === 0) {\n            return;\n        }\n        if (this.length + array.length > this.data.length) {\n            this.data.length = (this.length + array.length) * 2;\n        }\n        for (var index = 0; index < array.length; index++) {\n            var item = (array.data || array)[index];\n            this.pushNoDuplicate(item);\n        }\n    };\n    return SmartArrayNoDuplicate;\n}(SmartArray));\nexport { SmartArrayNoDuplicate };\n//# sourceMappingURL=smartArray.js.map","/**\n * This class implement a typical dictionary using a string as key and the generic type T as value.\n * The underlying implementation relies on an associative array to ensure the best performances.\n * The value can be anything including 'null' but except 'undefined'\n */\nvar StringDictionary = /** @class */ (function () {\n    function StringDictionary() {\n        this._count = 0;\n        this._data = {};\n    }\n    /**\n     * This will clear this dictionary and copy the content from the 'source' one.\n     * If the T value is a custom object, it won't be copied/cloned, the same object will be used\n     * @param source the dictionary to take the content from and copy to this dictionary\n     */\n    StringDictionary.prototype.copyFrom = function (source) {\n        var _this = this;\n        this.clear();\n        source.forEach(function (t, v) { return _this.add(t, v); });\n    };\n    /**\n     * Get a value based from its key\n     * @param key the given key to get the matching value from\n     * @return the value if found, otherwise undefined is returned\n     */\n    StringDictionary.prototype.get = function (key) {\n        var val = this._data[key];\n        if (val !== undefined) {\n            return val;\n        }\n        return undefined;\n    };\n    /**\n     * Get a value from its key or add it if it doesn't exist.\n     * This method will ensure you that a given key/data will be present in the dictionary.\n     * @param key the given key to get the matching value from\n     * @param factory the factory that will create the value if the key is not present in the dictionary.\n     * The factory will only be invoked if there's no data for the given key.\n     * @return the value corresponding to the key.\n     */\n    StringDictionary.prototype.getOrAddWithFactory = function (key, factory) {\n        var val = this.get(key);\n        if (val !== undefined) {\n            return val;\n        }\n        val = factory(key);\n        if (val) {\n            this.add(key, val);\n        }\n        return val;\n    };\n    /**\n     * Get a value from its key if present in the dictionary otherwise add it\n     * @param key the key to get the value from\n     * @param val if there's no such key/value pair in the dictionary add it with this value\n     * @return the value corresponding to the key\n     */\n    StringDictionary.prototype.getOrAdd = function (key, val) {\n        var curVal = this.get(key);\n        if (curVal !== undefined) {\n            return curVal;\n        }\n        this.add(key, val);\n        return val;\n    };\n    /**\n     * Check if there's a given key in the dictionary\n     * @param key the key to check for\n     * @return true if the key is present, false otherwise\n     */\n    StringDictionary.prototype.contains = function (key) {\n        return this._data[key] !== undefined;\n    };\n    /**\n     * Add a new key and its corresponding value\n     * @param key the key to add\n     * @param value the value corresponding to the key\n     * @return true if the operation completed successfully, false if we couldn't insert the key/value because there was already this key in the dictionary\n     */\n    StringDictionary.prototype.add = function (key, value) {\n        if (this._data[key] !== undefined) {\n            return false;\n        }\n        this._data[key] = value;\n        ++this._count;\n        return true;\n    };\n    /**\n     * Update a specific value associated to a key\n     * @param key defines the key to use\n     * @param value defines the value to store\n     * @returns true if the value was updated (or false if the key was not found)\n     */\n    StringDictionary.prototype.set = function (key, value) {\n        if (this._data[key] === undefined) {\n            return false;\n        }\n        this._data[key] = value;\n        return true;\n    };\n    /**\n     * Get the element of the given key and remove it from the dictionary\n     * @param key defines the key to search\n     * @returns the value associated with the key or null if not found\n     */\n    StringDictionary.prototype.getAndRemove = function (key) {\n        var val = this.get(key);\n        if (val !== undefined) {\n            delete this._data[key];\n            --this._count;\n            return val;\n        }\n        return null;\n    };\n    /**\n     * Remove a key/value from the dictionary.\n     * @param key the key to remove\n     * @return true if the item was successfully deleted, false if no item with such key exist in the dictionary\n     */\n    StringDictionary.prototype.remove = function (key) {\n        if (this.contains(key)) {\n            delete this._data[key];\n            --this._count;\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Clear the whole content of the dictionary\n     */\n    StringDictionary.prototype.clear = function () {\n        this._data = {};\n        this._count = 0;\n    };\n    Object.defineProperty(StringDictionary.prototype, \"count\", {\n        /**\n         * Gets the current count\n         */\n        get: function () {\n            return this._count;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Execute a callback on each key/val of the dictionary.\n     * Note that you can remove any element in this dictionary in the callback implementation\n     * @param callback the callback to execute on a given key/value pair\n     */\n    StringDictionary.prototype.forEach = function (callback) {\n        for (var cur in this._data) {\n            var val = this._data[cur];\n            callback(cur, val);\n        }\n    };\n    /**\n     * Execute a callback on every occurrence of the dictionary until it returns a valid TRes object.\n     * If the callback returns null or undefined the method will iterate to the next key/value pair\n     * Note that you can remove any element in this dictionary in the callback implementation\n     * @param callback the callback to execute, if it return a valid T instanced object the enumeration will stop and the object will be returned\n     * @returns the first item\n     */\n    StringDictionary.prototype.first = function (callback) {\n        for (var cur in this._data) {\n            var val = this._data[cur];\n            var res = callback(cur, val);\n            if (res) {\n                return res;\n            }\n        }\n        return null;\n    };\n    return StringDictionary;\n}());\nexport { StringDictionary };\n//# sourceMappingURL=stringDictionary.js.map","/* eslint-disable @typescript-eslint/naming-convention */\n/**\n * Checks for a matching suffix at the end of a string (for ES5 and lower)\n * @param str Source string\n * @param suffix Suffix to search for in the source string\n * @returns Boolean indicating whether the suffix was found (true) or not (false)\n * @deprecated Please use native string function instead\n */\nexport var EndsWith = function (str, suffix) {\n    return str.endsWith(suffix);\n};\n/**\n * Checks for a matching suffix at the beginning of a string (for ES5 and lower)\n * @param str Source string\n * @param suffix Suffix to search for in the source string\n * @returns Boolean indicating whether the suffix was found (true) or not (false)\n * @deprecated Please use native string function instead\n */\nexport var StartsWith = function (str, suffix) {\n    if (!str) {\n        return false;\n    }\n    return str.startsWith(suffix);\n};\n/**\n * Decodes a buffer into a string\n * @param buffer The buffer to decode\n * @returns The decoded string\n */\nexport var Decode = function (buffer) {\n    if (typeof TextDecoder !== \"undefined\") {\n        return new TextDecoder().decode(buffer);\n    }\n    var result = \"\";\n    for (var i = 0; i < buffer.byteLength; i++) {\n        result += String.fromCharCode(buffer[i]);\n    }\n    return result;\n};\n/**\n * Encode a buffer to a base64 string\n * @param buffer defines the buffer to encode\n * @returns the encoded string\n */\nexport var EncodeArrayBufferToBase64 = function (buffer) {\n    var keyStr = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n    var output = \"\";\n    var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n    var i = 0;\n    var bytes = ArrayBuffer.isView(buffer) ? new Uint8Array(buffer.buffer, buffer.byteOffset, buffer.byteLength) : new Uint8Array(buffer);\n    while (i < bytes.length) {\n        chr1 = bytes[i++];\n        chr2 = i < bytes.length ? bytes[i++] : Number.NaN;\n        chr3 = i < bytes.length ? bytes[i++] : Number.NaN;\n        enc1 = chr1 >> 2;\n        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n        enc4 = chr3 & 63;\n        if (isNaN(chr2)) {\n            enc3 = enc4 = 64;\n        }\n        else if (isNaN(chr3)) {\n            enc4 = 64;\n        }\n        output += keyStr.charAt(enc1) + keyStr.charAt(enc2) + keyStr.charAt(enc3) + keyStr.charAt(enc4);\n    }\n    return output;\n};\n/**\n * Converts a given base64 string as an ASCII encoded stream of data\n * @param base64Data The base64 encoded string to decode\n * @returns Decoded ASCII string\n */\nexport var DecodeBase64ToString = function (base64Data) {\n    return atob(base64Data);\n};\n/**\n * Converts a given base64 string into an ArrayBuffer of raw byte data\n * @param base64Data The base64 encoded string to decode\n * @returns ArrayBuffer of byte data\n */\nexport var DecodeBase64ToBinary = function (base64Data) {\n    var decodedString = DecodeBase64ToString(base64Data);\n    var bufferLength = decodedString.length;\n    var bufferView = new Uint8Array(new ArrayBuffer(bufferLength));\n    for (var i = 0; i < bufferLength; i++) {\n        bufferView[i] = decodedString.charCodeAt(i);\n    }\n    return bufferView.buffer;\n};\n/**\n * Converts a number to string and pads with preceding zeroes until it is of specified length.\n * @param num the number to convert and pad\n * @param length the expected length of the string\n * @returns the padded string\n */\nexport var PadNumber = function (num, length) {\n    var str = String(num);\n    while (str.length < length) {\n        str = \"0\" + str;\n    }\n    return str;\n};\n/**\n * Helper to manipulate strings\n */\nexport var StringTools = {\n    EndsWith: EndsWith,\n    StartsWith: StartsWith,\n    Decode: Decode,\n    EncodeArrayBufferToBase64: EncodeArrayBufferToBase64,\n    DecodeBase64ToString: DecodeBase64ToString,\n    DecodeBase64ToBinary: DecodeBase64ToBinary,\n    PadNumber: PadNumber,\n};\n//# sourceMappingURL=stringTools.js.map","import { AndOrNotEvaluator } from \"./andOrNotEvaluator.js\";\n/**\n * Class used to store custom tags\n */\nvar Tags = /** @class */ (function () {\n    function Tags() {\n    }\n    /**\n     * Adds support for tags on the given object\n     * @param obj defines the object to use\n     */\n    Tags.EnableFor = function (obj) {\n        obj._tags = obj._tags || {};\n        obj.hasTags = function () {\n            return Tags.HasTags(obj);\n        };\n        obj.addTags = function (tagsString) {\n            return Tags.AddTagsTo(obj, tagsString);\n        };\n        obj.removeTags = function (tagsString) {\n            return Tags.RemoveTagsFrom(obj, tagsString);\n        };\n        obj.matchesTagsQuery = function (tagsQuery) {\n            return Tags.MatchesQuery(obj, tagsQuery);\n        };\n    };\n    /**\n     * Removes tags support\n     * @param obj defines the object to use\n     */\n    Tags.DisableFor = function (obj) {\n        delete obj._tags;\n        delete obj.hasTags;\n        delete obj.addTags;\n        delete obj.removeTags;\n        delete obj.matchesTagsQuery;\n    };\n    /**\n     * Gets a boolean indicating if the given object has tags\n     * @param obj defines the object to use\n     * @returns a boolean\n     */\n    Tags.HasTags = function (obj) {\n        if (!obj._tags) {\n            return false;\n        }\n        var tags = obj._tags;\n        for (var i in tags) {\n            if (Object.prototype.hasOwnProperty.call(tags, i)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Gets the tags available on a given object\n     * @param obj defines the object to use\n     * @param asString defines if the tags must be returned as a string instead of an array of strings\n     * @returns the tags\n     */\n    Tags.GetTags = function (obj, asString) {\n        if (asString === void 0) { asString = true; }\n        if (!obj._tags) {\n            return null;\n        }\n        if (asString) {\n            var tagsArray = [];\n            for (var tag in obj._tags) {\n                if (Object.prototype.hasOwnProperty.call(obj._tags, tag) && obj._tags[tag] === true) {\n                    tagsArray.push(tag);\n                }\n            }\n            return tagsArray.join(\" \");\n        }\n        else {\n            return obj._tags;\n        }\n    };\n    /**\n     * Adds tags to an object\n     * @param obj defines the object to use\n     * @param tagsString defines the tag string. The tags 'true' and 'false' are reserved and cannot be used as tags.\n     * A tag cannot start with '||', '&&', and '!'. It cannot contain whitespaces\n     */\n    Tags.AddTagsTo = function (obj, tagsString) {\n        if (!tagsString) {\n            return;\n        }\n        if (typeof tagsString !== \"string\") {\n            return;\n        }\n        var tags = tagsString.split(\" \");\n        tags.forEach(function (tag) {\n            Tags._AddTagTo(obj, tag);\n        });\n    };\n    /**\n     * @param obj\n     * @param tag\n     * @hidden\n     */\n    Tags._AddTagTo = function (obj, tag) {\n        tag = tag.trim();\n        if (tag === \"\" || tag === \"true\" || tag === \"false\") {\n            return;\n        }\n        if (tag.match(/[\\s]/) || tag.match(/^([!]|([|]|[&]){2})/)) {\n            return;\n        }\n        Tags.EnableFor(obj);\n        obj._tags[tag] = true;\n    };\n    /**\n     * Removes specific tags from a specific object\n     * @param obj defines the object to use\n     * @param tagsString defines the tags to remove\n     */\n    Tags.RemoveTagsFrom = function (obj, tagsString) {\n        if (!Tags.HasTags(obj)) {\n            return;\n        }\n        var tags = tagsString.split(\" \");\n        for (var t in tags) {\n            Tags._RemoveTagFrom(obj, tags[t]);\n        }\n    };\n    /**\n     * @param obj\n     * @param tag\n     * @hidden\n     */\n    Tags._RemoveTagFrom = function (obj, tag) {\n        delete obj._tags[tag];\n    };\n    /**\n     * Defines if tags hosted on an object match a given query\n     * @param obj defines the object to use\n     * @param tagsQuery defines the tag query\n     * @returns a boolean\n     */\n    Tags.MatchesQuery = function (obj, tagsQuery) {\n        if (tagsQuery === undefined) {\n            return true;\n        }\n        if (tagsQuery === \"\") {\n            return Tags.HasTags(obj);\n        }\n        return AndOrNotEvaluator.Eval(tagsQuery, function (r) { return Tags.HasTags(obj) && obj._tags[r]; });\n    };\n    return Tags;\n}());\nexport { Tags };\n//# sourceMappingURL=tags.js.map","import { Texture } from \"../Materials/Textures/texture.js\";\nimport { RenderTargetTexture } from \"../Materials/Textures/renderTargetTexture.js\";\nimport { PassPostProcess } from \"../PostProcesses/passPostProcess.js\";\n\nimport { PostProcess } from \"../PostProcesses/postProcess.js\";\n/**\n * Uses the GPU to create a copy texture rescaled at a given size\n * @param texture Texture to copy from\n * @param width defines the desired width\n * @param height defines the desired height\n * @param useBilinearMode defines if bilinear mode has to be used\n * @return the generated texture\n */\nexport function CreateResizedCopy(texture, width, height, useBilinearMode) {\n    if (useBilinearMode === void 0) { useBilinearMode = true; }\n    var scene = texture.getScene();\n    var engine = scene.getEngine();\n    var rtt = new RenderTargetTexture(\"resized\" + texture.name, { width: width, height: height }, scene, !texture.noMipmap, true, texture._texture.type, false, texture.samplingMode, false);\n    rtt.wrapU = texture.wrapU;\n    rtt.wrapV = texture.wrapV;\n    rtt.uOffset = texture.uOffset;\n    rtt.vOffset = texture.vOffset;\n    rtt.uScale = texture.uScale;\n    rtt.vScale = texture.vScale;\n    rtt.uAng = texture.uAng;\n    rtt.vAng = texture.vAng;\n    rtt.wAng = texture.wAng;\n    rtt.coordinatesIndex = texture.coordinatesIndex;\n    rtt.level = texture.level;\n    rtt.anisotropicFilteringLevel = texture.anisotropicFilteringLevel;\n    rtt._texture.isReady = false;\n    texture.wrapU = Texture.CLAMP_ADDRESSMODE;\n    texture.wrapV = Texture.CLAMP_ADDRESSMODE;\n    var passPostProcess = new PassPostProcess(\"pass\", 1, null, useBilinearMode ? Texture.BILINEAR_SAMPLINGMODE : Texture.NEAREST_SAMPLINGMODE, engine, false, 0);\n    passPostProcess.externalTextureSamplerBinding = true;\n    passPostProcess.getEffect().executeWhenCompiled(function () {\n        passPostProcess.onApply = function (effect) {\n            effect.setTexture(\"textureSampler\", texture);\n        };\n        var internalTexture = rtt.renderTarget;\n        if (internalTexture) {\n            scene.postProcessManager.directRender([passPostProcess], internalTexture);\n            engine.unBindFramebuffer(internalTexture);\n            rtt.disposeFramebufferObjects();\n            passPostProcess.dispose();\n            rtt.getInternalTexture().isReady = true;\n        }\n    });\n    return rtt;\n}\n/**\n * Apply a post process to a texture\n * @param postProcessName name of the fragment post process\n * @param internalTexture the texture to encode\n * @param scene the scene hosting the texture\n * @param type type of the output texture. If not provided, use the one from internalTexture\n * @param samplingMode sampling mode to use to sample the source texture. If not provided, use the one from internalTexture\n * @param format format of the output texture. If not provided, use the one from internalTexture\n * @return a promise with the internalTexture having its texture replaced by the result of the processing\n */\nexport function ApplyPostProcess(postProcessName, internalTexture, scene, type, samplingMode, format) {\n    // Gets everything ready.\n    var engine = internalTexture.getEngine();\n    internalTexture.isReady = false;\n    samplingMode = samplingMode !== null && samplingMode !== void 0 ? samplingMode : internalTexture.samplingMode;\n    type = type !== null && type !== void 0 ? type : internalTexture.type;\n    format = format !== null && format !== void 0 ? format : internalTexture.format;\n    if (type === -1) {\n        type = 0;\n    }\n    return new Promise(function (resolve) {\n        // Create the post process\n        var postProcess = new PostProcess(\"postprocess\", postProcessName, null, null, 1, null, samplingMode, engine, false, undefined, type, undefined, null, false, format);\n        postProcess.externalTextureSamplerBinding = true;\n        // Hold the output of the decoding.\n        var encodedTexture = engine.createRenderTargetTexture({ width: internalTexture.width, height: internalTexture.height }, {\n            generateDepthBuffer: false,\n            generateMipMaps: false,\n            generateStencilBuffer: false,\n            samplingMode: samplingMode,\n            type: type,\n            format: format,\n        });\n        postProcess.getEffect().executeWhenCompiled(function () {\n            // PP Render Pass\n            postProcess.onApply = function (effect) {\n                effect._bindTexture(\"textureSampler\", internalTexture);\n                effect.setFloat2(\"scale\", 1, 1);\n            };\n            scene.postProcessManager.directRender([postProcess], encodedTexture, true);\n            // Cleanup\n            engine.restoreDefaultFramebuffer();\n            engine._releaseTexture(internalTexture);\n            if (postProcess) {\n                postProcess.dispose();\n            }\n            // Internal Swap\n            encodedTexture._swapAndDie(internalTexture);\n            // Ready to get rolling again.\n            internalTexture.type = type;\n            internalTexture.format = 5;\n            internalTexture.isReady = true;\n            resolve(internalTexture);\n        });\n    });\n}\n// ref: http://stackoverflow.com/questions/32633585/how-do-you-convert-to-half-floats-in-javascript\nvar floatView;\nvar int32View;\n/**\n * Converts a number to half float\n * @param value number to convert\n * @returns converted number\n */\nexport function ToHalfFloat(value) {\n    if (!floatView) {\n        floatView = new Float32Array(1);\n        int32View = new Int32Array(floatView.buffer);\n    }\n    floatView[0] = value;\n    var x = int32View[0];\n    var bits = (x >> 16) & 0x8000; /* Get the sign */\n    var m = (x >> 12) & 0x07ff; /* Keep one extra bit for rounding */\n    var e = (x >> 23) & 0xff; /* Using int is faster here */\n    /* If zero, or denormal, or exponent underflows too much for a denormal\n     * half, return signed zero. */\n    if (e < 103) {\n        return bits;\n    }\n    /* If NaN, return NaN. If Inf or exponent overflow, return Inf. */\n    if (e > 142) {\n        bits |= 0x7c00;\n        /* If exponent was 0xff and one mantissa bit was set, it means NaN,\n         * not Inf, so make sure we set one mantissa bit too. */\n        bits |= (e == 255 ? 0 : 1) && x & 0x007fffff;\n        return bits;\n    }\n    /* If exponent underflows but not too much, return a denormal */\n    if (e < 113) {\n        m |= 0x0800;\n        /* Extra rounding may overflow and set mantissa to 0 and exponent\n         * to 1, which is OK. */\n        bits |= (m >> (114 - e)) + ((m >> (113 - e)) & 1);\n        return bits;\n    }\n    bits |= ((e - 112) << 10) | (m >> 1);\n    bits += m & 1;\n    return bits;\n}\n/**\n * Converts a half float to a number\n * @param value half float to convert\n * @returns converted half float\n */\nexport function FromHalfFloat(value) {\n    var s = (value & 0x8000) >> 15;\n    var e = (value & 0x7c00) >> 10;\n    var f = value & 0x03ff;\n    if (e === 0) {\n        return (s ? -1 : 1) * Math.pow(2, -14) * (f / Math.pow(2, 10));\n    }\n    else if (e == 0x1f) {\n        return f ? NaN : (s ? -1 : 1) * Infinity;\n    }\n    return (s ? -1 : 1) * Math.pow(2, e - 15) * (1 + f / Math.pow(2, 10));\n}\n/**\n * Class used to host texture specific utilities\n */\nexport var TextureTools = {\n    /**\n     * Uses the GPU to create a copy texture rescaled at a given size\n     * @param texture Texture to copy from\n     * @param width defines the desired width\n     * @param height defines the desired height\n     * @param useBilinearMode defines if bilinear mode has to be used\n     * @return the generated texture\n     */\n    CreateResizedCopy: CreateResizedCopy,\n    /**\n     * Apply a post process to a texture\n     * @param postProcessName name of the fragment post process\n     * @param internalTexture the texture to encode\n     * @param scene the scene hosting the texture\n     * @param type type of the output texture. If not provided, use the one from internalTexture\n     * @param samplingMode sampling mode to use to sample the source texture. If not provided, use the one from internalTexture\n     * @param format format of the output texture. If not provided, use the one from internalTexture\n     * @return a promise with the internalTexture having its texture replaced by the result of the processing\n     */\n    ApplyPostProcess: ApplyPostProcess,\n    /**\n     * Converts a number to half float\n     * @param value number to convert\n     * @returns converted number\n     */\n    ToHalfFloat: ToHalfFloat,\n    /**\n     * Converts a half float to a number\n     * @param value half float to convert\n     * @returns converted half float\n     */\n    FromHalfFloat: FromHalfFloat,\n};\n//# sourceMappingURL=textureTools.js.map","import { Logger } from \"../Misc/logger.js\";\n//private static _TYPE_NO_DATA = 0;\nvar _TYPE_INDEXED = 1;\nvar _TYPE_RGB = 2;\nvar _TYPE_GREY = 3;\nvar _TYPE_RLE_INDEXED = 9;\nvar _TYPE_RLE_RGB = 10;\nvar _TYPE_RLE_GREY = 11;\nvar _ORIGIN_MASK = 0x30;\nvar _ORIGIN_SHIFT = 0x04;\nvar _ORIGIN_BL = 0x00;\nvar _ORIGIN_BR = 0x01;\nvar _ORIGIN_UL = 0x02;\nvar _ORIGIN_UR = 0x03;\n/**\n * Gets the header of a TGA file\n * @param data defines the TGA data\n * @returns the header\n */\nexport function GetTGAHeader(data) {\n    var offset = 0;\n    var header = {\n        id_length: data[offset++],\n        colormap_type: data[offset++],\n        image_type: data[offset++],\n        colormap_index: data[offset++] | (data[offset++] << 8),\n        colormap_length: data[offset++] | (data[offset++] << 8),\n        colormap_size: data[offset++],\n        origin: [data[offset++] | (data[offset++] << 8), data[offset++] | (data[offset++] << 8)],\n        width: data[offset++] | (data[offset++] << 8),\n        height: data[offset++] | (data[offset++] << 8),\n        pixel_size: data[offset++],\n        flags: data[offset++],\n    };\n    return header;\n}\n/**\n * Uploads TGA content to a Babylon Texture\n * @param texture\n * @param data\n * @hidden\n */\nexport function UploadContent(texture, data) {\n    // Not enough data to contain header ?\n    if (data.length < 19) {\n        Logger.Error(\"Unable to load TGA file - Not enough data to contain header\");\n        return;\n    }\n    // Read Header\n    var offset = 18;\n    var header = GetTGAHeader(data);\n    // Assume it's a valid Targa file.\n    if (header.id_length + offset > data.length) {\n        Logger.Error(\"Unable to load TGA file - Not enough data\");\n        return;\n    }\n    // Skip not needed data\n    offset += header.id_length;\n    var use_rle = false;\n    var use_pal = false;\n    var use_grey = false;\n    // Get some informations.\n    switch (header.image_type) {\n        case _TYPE_RLE_INDEXED:\n            use_rle = true;\n        // eslint-disable-next-line no-fallthrough\n        case _TYPE_INDEXED:\n            use_pal = true;\n            break;\n        case _TYPE_RLE_RGB:\n            use_rle = true;\n        // eslint-disable-next-line no-fallthrough\n        case _TYPE_RGB:\n            // use_rgb = true;\n            break;\n        case _TYPE_RLE_GREY:\n            use_rle = true;\n        // eslint-disable-next-line no-fallthrough\n        case _TYPE_GREY:\n            use_grey = true;\n            break;\n    }\n    var pixel_data;\n    // var numAlphaBits = header.flags & 0xf;\n    var pixel_size = header.pixel_size >> 3;\n    var pixel_total = header.width * header.height * pixel_size;\n    // Read palettes\n    var palettes;\n    if (use_pal) {\n        palettes = data.subarray(offset, (offset += header.colormap_length * (header.colormap_size >> 3)));\n    }\n    // Read LRE\n    if (use_rle) {\n        pixel_data = new Uint8Array(pixel_total);\n        var c = void 0, count = void 0, i = void 0;\n        var localOffset = 0;\n        var pixels = new Uint8Array(pixel_size);\n        while (offset < pixel_total && localOffset < pixel_total) {\n            c = data[offset++];\n            count = (c & 0x7f) + 1;\n            // RLE pixels\n            if (c & 0x80) {\n                // Bind pixel tmp array\n                for (i = 0; i < pixel_size; ++i) {\n                    pixels[i] = data[offset++];\n                }\n                // Copy pixel array\n                for (i = 0; i < count; ++i) {\n                    pixel_data.set(pixels, localOffset + i * pixel_size);\n                }\n                localOffset += pixel_size * count;\n            }\n            // Raw pixels\n            else {\n                count *= pixel_size;\n                for (i = 0; i < count; ++i) {\n                    pixel_data[localOffset + i] = data[offset++];\n                }\n                localOffset += count;\n            }\n        }\n    }\n    // RAW Pixels\n    else {\n        pixel_data = data.subarray(offset, (offset += use_pal ? header.width * header.height : pixel_total));\n    }\n    // Load to texture\n    var x_start, y_start, x_step, y_step, y_end, x_end;\n    switch ((header.flags & _ORIGIN_MASK) >> _ORIGIN_SHIFT) {\n        default:\n        case _ORIGIN_UL:\n            x_start = 0;\n            x_step = 1;\n            x_end = header.width;\n            y_start = 0;\n            y_step = 1;\n            y_end = header.height;\n            break;\n        case _ORIGIN_BL:\n            x_start = 0;\n            x_step = 1;\n            x_end = header.width;\n            y_start = header.height - 1;\n            y_step = -1;\n            y_end = -1;\n            break;\n        case _ORIGIN_UR:\n            x_start = header.width - 1;\n            x_step = -1;\n            x_end = -1;\n            y_start = 0;\n            y_step = 1;\n            y_end = header.height;\n            break;\n        case _ORIGIN_BR:\n            x_start = header.width - 1;\n            x_step = -1;\n            x_end = -1;\n            y_start = header.height - 1;\n            y_step = -1;\n            y_end = -1;\n            break;\n    }\n    // Load the specify method\n    var func = \"_getImageData\" + (use_grey ? \"Grey\" : \"\") + header.pixel_size + \"bits\";\n    var imageData = TGATools[func](header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end);\n    var engine = texture.getEngine();\n    engine._uploadDataToTextureDirectly(texture, imageData);\n}\n/**\n * @param header\n * @param palettes\n * @param pixel_data\n * @param y_start\n * @param y_step\n * @param y_end\n * @param x_start\n * @param x_step\n * @param x_end\n * @hidden\n */\nfunction _getImageData8bits(header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end) {\n    var image = pixel_data, colormap = palettes;\n    var width = header.width, height = header.height;\n    var color, i = 0, x, y;\n    var imageData = new Uint8Array(width * height * 4);\n    for (y = y_start; y !== y_end; y += y_step) {\n        for (x = x_start; x !== x_end; x += x_step, i++) {\n            color = image[i];\n            imageData[(x + width * y) * 4 + 3] = 255;\n            imageData[(x + width * y) * 4 + 2] = colormap[color * 3 + 0];\n            imageData[(x + width * y) * 4 + 1] = colormap[color * 3 + 1];\n            imageData[(x + width * y) * 4 + 0] = colormap[color * 3 + 2];\n        }\n    }\n    return imageData;\n}\n/**\n * @param header\n * @param palettes\n * @param pixel_data\n * @param y_start\n * @param y_step\n * @param y_end\n * @param x_start\n * @param x_step\n * @param x_end\n * @hidden\n */\nfunction _getImageData16bits(header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end) {\n    var image = pixel_data;\n    var width = header.width, height = header.height;\n    var color, i = 0, x, y;\n    var imageData = new Uint8Array(width * height * 4);\n    for (y = y_start; y !== y_end; y += y_step) {\n        for (x = x_start; x !== x_end; x += x_step, i += 2) {\n            color = image[i + 0] + (image[i + 1] << 8); // Inversed ?\n            var r = ((((color & 0x7c00) >> 10) * 255) / 0x1f) | 0;\n            var g = ((((color & 0x03e0) >> 5) * 255) / 0x1f) | 0;\n            var b = (((color & 0x001f) * 255) / 0x1f) | 0;\n            imageData[(x + width * y) * 4 + 0] = r;\n            imageData[(x + width * y) * 4 + 1] = g;\n            imageData[(x + width * y) * 4 + 2] = b;\n            imageData[(x + width * y) * 4 + 3] = color & 0x8000 ? 0 : 255;\n        }\n    }\n    return imageData;\n}\n/**\n * @param header\n * @param palettes\n * @param pixel_data\n * @param y_start\n * @param y_step\n * @param y_end\n * @param x_start\n * @param x_step\n * @param x_end\n * @hidden\n */\nfunction _getImageData24bits(header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end) {\n    var image = pixel_data;\n    var width = header.width, height = header.height;\n    var i = 0, x, y;\n    var imageData = new Uint8Array(width * height * 4);\n    for (y = y_start; y !== y_end; y += y_step) {\n        for (x = x_start; x !== x_end; x += x_step, i += 3) {\n            imageData[(x + width * y) * 4 + 3] = 255;\n            imageData[(x + width * y) * 4 + 2] = image[i + 0];\n            imageData[(x + width * y) * 4 + 1] = image[i + 1];\n            imageData[(x + width * y) * 4 + 0] = image[i + 2];\n        }\n    }\n    return imageData;\n}\n/**\n * @param header\n * @param palettes\n * @param pixel_data\n * @param y_start\n * @param y_step\n * @param y_end\n * @param x_start\n * @param x_step\n * @param x_end\n * @hidden\n */\nfunction _getImageData32bits(header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end) {\n    var image = pixel_data;\n    var width = header.width, height = header.height;\n    var i = 0, x, y;\n    var imageData = new Uint8Array(width * height * 4);\n    for (y = y_start; y !== y_end; y += y_step) {\n        for (x = x_start; x !== x_end; x += x_step, i += 4) {\n            imageData[(x + width * y) * 4 + 2] = image[i + 0];\n            imageData[(x + width * y) * 4 + 1] = image[i + 1];\n            imageData[(x + width * y) * 4 + 0] = image[i + 2];\n            imageData[(x + width * y) * 4 + 3] = image[i + 3];\n        }\n    }\n    return imageData;\n}\n/**\n * @param header\n * @param palettes\n * @param pixel_data\n * @param y_start\n * @param y_step\n * @param y_end\n * @param x_start\n * @param x_step\n * @param x_end\n * @hidden\n */\nfunction _getImageDataGrey8bits(header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end) {\n    var image = pixel_data;\n    var width = header.width, height = header.height;\n    var color, i = 0, x, y;\n    var imageData = new Uint8Array(width * height * 4);\n    for (y = y_start; y !== y_end; y += y_step) {\n        for (x = x_start; x !== x_end; x += x_step, i++) {\n            color = image[i];\n            imageData[(x + width * y) * 4 + 0] = color;\n            imageData[(x + width * y) * 4 + 1] = color;\n            imageData[(x + width * y) * 4 + 2] = color;\n            imageData[(x + width * y) * 4 + 3] = 255;\n        }\n    }\n    return imageData;\n}\n/**\n * @param header\n * @param palettes\n * @param pixel_data\n * @param y_start\n * @param y_step\n * @param y_end\n * @param x_start\n * @param x_step\n * @param x_end\n * @hidden\n */\nfunction _getImageDataGrey16bits(header, palettes, pixel_data, y_start, y_step, y_end, x_start, x_step, x_end) {\n    var image = pixel_data;\n    var width = header.width, height = header.height;\n    var i = 0, x, y;\n    var imageData = new Uint8Array(width * height * 4);\n    for (y = y_start; y !== y_end; y += y_step) {\n        for (x = x_start; x !== x_end; x += x_step, i += 2) {\n            imageData[(x + width * y) * 4 + 0] = image[i + 0];\n            imageData[(x + width * y) * 4 + 1] = image[i + 0];\n            imageData[(x + width * y) * 4 + 2] = image[i + 0];\n            imageData[(x + width * y) * 4 + 3] = image[i + 1];\n        }\n    }\n    return imageData;\n}\n/**\n * Based on jsTGALoader - Javascript loader for TGA file\n * By Vincent Thibault\n * @see http://blog.robrowser.com/javascript-tga-loader.html\n */\nexport var TGATools = {\n    /**\n     * Gets the header of a TGA file\n     * @param data defines the TGA data\n     * @returns the header\n     */\n    GetTGAHeader: GetTGAHeader,\n    /**\n     * Uploads TGA content to a Babylon Texture\n     * @hidden\n     */\n    UploadContent: UploadContent,\n    /** @hidden */\n    _getImageData8bits: _getImageData8bits,\n    /** @hidden */\n    _getImageData16bits: _getImageData16bits,\n    /** @hidden */\n    _getImageData24bits: _getImageData24bits,\n    /** @hidden */\n    _getImageData32bits: _getImageData32bits,\n    /** @hidden */\n    _getImageDataGrey8bits: _getImageDataGrey8bits,\n    /** @hidden */\n    _getImageDataGrey16bits: _getImageDataGrey16bits,\n};\n//# sourceMappingURL=tga.js.map","import { Observable } from \"../Misc/observable.js\";\n/**\n * The current state of the timer\n */\nexport var TimerState;\n(function (TimerState) {\n    /**\n     * Timer initialized, not yet started\n     */\n    TimerState[TimerState[\"INIT\"] = 0] = \"INIT\";\n    /**\n     * Timer started and counting\n     */\n    TimerState[TimerState[\"STARTED\"] = 1] = \"STARTED\";\n    /**\n     * Timer ended (whether aborted or time reached)\n     */\n    TimerState[TimerState[\"ENDED\"] = 2] = \"ENDED\";\n})(TimerState || (TimerState = {}));\n/**\n * A simple version of the timer. Will take options and start the timer immediately after calling it\n *\n * @param options options with which to initialize this timer\n */\nexport function setAndStartTimer(options) {\n    var _a;\n    var timer = 0;\n    var startTime = Date.now();\n    options.observableParameters = (_a = options.observableParameters) !== null && _a !== void 0 ? _a : {};\n    var observer = options.contextObservable.add(function (payload) {\n        var now = Date.now();\n        timer = now - startTime;\n        var data = {\n            startTime: startTime,\n            currentTime: now,\n            deltaTime: timer,\n            completeRate: timer / options.timeout,\n            payload: payload,\n        };\n        options.onTick && options.onTick(data);\n        if (options.breakCondition && options.breakCondition()) {\n            options.contextObservable.remove(observer);\n            options.onAborted && options.onAborted(data);\n        }\n        if (timer >= options.timeout) {\n            options.contextObservable.remove(observer);\n            options.onEnded && options.onEnded(data);\n        }\n    }, options.observableParameters.mask, options.observableParameters.insertFirst, options.observableParameters.scope);\n    return observer;\n}\n/**\n * An advanced implementation of a timer class\n */\nvar AdvancedTimer = /** @class */ (function () {\n    /**\n     * Will construct a new advanced timer based on the options provided. Timer will not start until start() is called.\n     * @param options construction options for this advanced timer\n     */\n    function AdvancedTimer(options) {\n        var _this = this;\n        var _a, _b;\n        /**\n         * Will notify each time the timer calculates the remaining time\n         */\n        this.onEachCountObservable = new Observable();\n        /**\n         * Will trigger when the timer was aborted due to the break condition\n         */\n        this.onTimerAbortedObservable = new Observable();\n        /**\n         * Will trigger when the timer ended successfully\n         */\n        this.onTimerEndedObservable = new Observable();\n        /**\n         * Will trigger when the timer state has changed\n         */\n        this.onStateChangedObservable = new Observable();\n        this._observer = null;\n        this._breakOnNextTick = false;\n        this._tick = function (payload) {\n            var now = Date.now();\n            _this._timer = now - _this._startTime;\n            var data = {\n                startTime: _this._startTime,\n                currentTime: now,\n                deltaTime: _this._timer,\n                completeRate: _this._timer / _this._timeToEnd,\n                payload: payload,\n            };\n            var shouldBreak = _this._breakOnNextTick || _this._breakCondition(data);\n            if (shouldBreak || _this._timer >= _this._timeToEnd) {\n                _this._stop(data, shouldBreak);\n            }\n            else {\n                _this.onEachCountObservable.notifyObservers(data);\n            }\n        };\n        this._setState(TimerState.INIT);\n        this._contextObservable = options.contextObservable;\n        this._observableParameters = (_a = options.observableParameters) !== null && _a !== void 0 ? _a : {};\n        this._breakCondition = (_b = options.breakCondition) !== null && _b !== void 0 ? _b : (function () { return false; });\n        this._timeToEnd = options.timeout;\n        if (options.onEnded) {\n            this.onTimerEndedObservable.add(options.onEnded);\n        }\n        if (options.onTick) {\n            this.onEachCountObservable.add(options.onTick);\n        }\n        if (options.onAborted) {\n            this.onTimerAbortedObservable.add(options.onAborted);\n        }\n    }\n    Object.defineProperty(AdvancedTimer.prototype, \"breakCondition\", {\n        /**\n         * set a breaking condition for this timer. Default is to never break during count\n         * @param predicate the new break condition. Returns true to break, false otherwise\n         */\n        set: function (predicate) {\n            this._breakCondition = predicate;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Reset ALL associated observables in this advanced timer\n     */\n    AdvancedTimer.prototype.clearObservables = function () {\n        this.onEachCountObservable.clear();\n        this.onTimerAbortedObservable.clear();\n        this.onTimerEndedObservable.clear();\n        this.onStateChangedObservable.clear();\n    };\n    /**\n     * Will start a new iteration of this timer. Only one instance of this timer can run at a time.\n     *\n     * @param timeToEnd how much time to measure until timer ended\n     */\n    AdvancedTimer.prototype.start = function (timeToEnd) {\n        if (timeToEnd === void 0) { timeToEnd = this._timeToEnd; }\n        if (this._state === TimerState.STARTED) {\n            throw new Error(\"Timer already started. Please stop it before starting again\");\n        }\n        this._timeToEnd = timeToEnd;\n        this._startTime = Date.now();\n        this._timer = 0;\n        this._observer = this._contextObservable.add(this._tick, this._observableParameters.mask, this._observableParameters.insertFirst, this._observableParameters.scope);\n        this._setState(TimerState.STARTED);\n    };\n    /**\n     * Will force a stop on the next tick.\n     */\n    AdvancedTimer.prototype.stop = function () {\n        if (this._state !== TimerState.STARTED) {\n            return;\n        }\n        this._breakOnNextTick = true;\n    };\n    /**\n     * Dispose this timer, clearing all resources\n     */\n    AdvancedTimer.prototype.dispose = function () {\n        if (this._observer) {\n            this._contextObservable.remove(this._observer);\n        }\n        this.clearObservables();\n    };\n    AdvancedTimer.prototype._setState = function (newState) {\n        this._state = newState;\n        this.onStateChangedObservable.notifyObservers(this._state);\n    };\n    AdvancedTimer.prototype._stop = function (data, aborted) {\n        if (aborted === void 0) { aborted = false; }\n        this._contextObservable.remove(this._observer);\n        this._setState(TimerState.ENDED);\n        if (aborted) {\n            this.onTimerAbortedObservable.notifyObservers(data);\n        }\n        else {\n            this.onTimerEndedObservable.notifyObservers(data);\n        }\n    };\n    return AdvancedTimer;\n}());\nexport { AdvancedTimer };\n//# sourceMappingURL=timer.js.map","import { IsWindowObjectExist } from \"./domManagement.js\";\n/**\n * Class used to provide helper for timing\n */\nvar TimingTools = /** @class */ (function () {\n    function TimingTools() {\n    }\n    /**\n     * Polyfill for setImmediate\n     * @param action defines the action to execute after the current execution block\n     */\n    TimingTools.SetImmediate = function (action) {\n        if (IsWindowObjectExist() && window.setImmediate) {\n            window.setImmediate(action);\n        }\n        else {\n            setTimeout(action, 1);\n        }\n    };\n    return TimingTools;\n}());\nexport { TimingTools };\n//# sourceMappingURL=timingTools.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { Observable } from \"./observable.js\";\nimport { GetDOMTextContent, IsNavigatorAvailable, IsWindowObjectExist } from \"./domManagement.js\";\nimport { Logger } from \"./logger.js\";\nimport { DeepCopier } from \"./deepCopier.js\";\nimport { PrecisionDate } from \"./precisionDate.js\";\nimport { _WarnImport } from \"./devTools.js\";\nimport { WebRequest } from \"./webRequest.js\";\nimport { EngineStore } from \"../Engines/engineStore.js\";\nimport { FileToolsOptions, DecodeBase64UrlToBinary, IsBase64DataUrl, LoadFile as FileToolsLoadFile, LoadImage as FileToolLoadImage, ReadFile as FileToolsReadFile, SetCorsBehavior, } from \"./fileTools.js\";\nimport { TimingTools } from \"./timingTools.js\";\nimport { InstantiationTools } from \"./instantiationTools.js\";\nimport { RandomGUID } from \"./guid.js\";\n/**\n * Class containing a set of static utilities functions\n */\nvar Tools = /** @class */ (function () {\n    function Tools() {\n    }\n    Object.defineProperty(Tools, \"BaseUrl\", {\n        /**\n         * Gets or sets the base URL to use to load assets\n         */\n        get: function () {\n            return FileToolsOptions.BaseUrl;\n        },\n        set: function (value) {\n            FileToolsOptions.BaseUrl = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Tools, \"DefaultRetryStrategy\", {\n        /**\n         * Gets or sets the retry strategy to apply when an error happens while loading an asset\n         */\n        get: function () {\n            return FileToolsOptions.DefaultRetryStrategy;\n        },\n        set: function (strategy) {\n            FileToolsOptions.DefaultRetryStrategy = strategy;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Tools, \"CorsBehavior\", {\n        /**\n         * Default behaviour for cors in the application.\n         * It can be a string if the expected behavior is identical in the entire app.\n         * Or a callback to be able to set it per url or on a group of them (in case of Video source for instance)\n         */\n        get: function () {\n            return FileToolsOptions.CorsBehavior;\n        },\n        set: function (value) {\n            FileToolsOptions.CorsBehavior = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Tools, \"UseFallbackTexture\", {\n        /**\n         * Gets or sets a global variable indicating if fallback texture must be used when a texture cannot be loaded\n         * @ignorenaming\n         */\n        get: function () {\n            return EngineStore.UseFallbackTexture;\n        },\n        set: function (value) {\n            EngineStore.UseFallbackTexture = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Tools, \"RegisteredExternalClasses\", {\n        /**\n         * Use this object to register external classes like custom textures or material\n         * to allow the loaders to instantiate them\n         */\n        get: function () {\n            return InstantiationTools.RegisteredExternalClasses;\n        },\n        set: function (classes) {\n            InstantiationTools.RegisteredExternalClasses = classes;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Tools, \"fallbackTexture\", {\n        /**\n         * Texture content used if a texture cannot loaded\n         * @ignorenaming\n         */\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        get: function () {\n            return EngineStore.FallbackTexture;\n        },\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        set: function (value) {\n            EngineStore.FallbackTexture = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Read the content of a byte array at a specified coordinates (taking in account wrapping)\n     * @param u defines the coordinate on X axis\n     * @param v defines the coordinate on Y axis\n     * @param width defines the width of the source data\n     * @param height defines the height of the source data\n     * @param pixels defines the source byte array\n     * @param color defines the output color\n     */\n    Tools.FetchToRef = function (u, v, width, height, pixels, color) {\n        var wrappedU = (Math.abs(u) * width) % width | 0;\n        var wrappedV = (Math.abs(v) * height) % height | 0;\n        var position = (wrappedU + wrappedV * width) * 4;\n        color.r = pixels[position] / 255;\n        color.g = pixels[position + 1] / 255;\n        color.b = pixels[position + 2] / 255;\n        color.a = pixels[position + 3] / 255;\n    };\n    /**\n     * Interpolates between a and b via alpha\n     * @param a The lower value (returned when alpha = 0)\n     * @param b The upper value (returned when alpha = 1)\n     * @param alpha The interpolation-factor\n     * @return The mixed value\n     */\n    Tools.Mix = function (a, b, alpha) {\n        return a * (1 - alpha) + b * alpha;\n    };\n    /**\n     * Tries to instantiate a new object from a given class name\n     * @param className defines the class name to instantiate\n     * @returns the new object or null if the system was not able to do the instantiation\n     */\n    Tools.Instantiate = function (className) {\n        return InstantiationTools.Instantiate(className);\n    };\n    /**\n     * Polyfill for setImmediate\n     * @param action defines the action to execute after the current execution block\n     */\n    Tools.SetImmediate = function (action) {\n        TimingTools.SetImmediate(action);\n    };\n    /**\n     * Function indicating if a number is an exponent of 2\n     * @param value defines the value to test\n     * @returns true if the value is an exponent of 2\n     */\n    Tools.IsExponentOfTwo = function (value) {\n        var count = 1;\n        do {\n            count *= 2;\n        } while (count < value);\n        return count === value;\n    };\n    /**\n     * Returns the nearest 32-bit single precision float representation of a Number\n     * @param value A Number.  If the parameter is of a different type, it will get converted\n     * to a number or to NaN if it cannot be converted\n     * @returns number\n     */\n    Tools.FloatRound = function (value) {\n        if (Math.fround) {\n            return Math.fround(value);\n        }\n        return (Tools._TmpFloatArray[0] = value), Tools._TmpFloatArray[0];\n    };\n    /**\n     * Extracts the filename from a path\n     * @param path defines the path to use\n     * @returns the filename\n     */\n    Tools.GetFilename = function (path) {\n        var index = path.lastIndexOf(\"/\");\n        if (index < 0) {\n            return path;\n        }\n        return path.substring(index + 1);\n    };\n    /**\n     * Extracts the \"folder\" part of a path (everything before the filename).\n     * @param uri The URI to extract the info from\n     * @param returnUnchangedIfNoSlash Do not touch the URI if no slashes are present\n     * @returns The \"folder\" part of the path\n     */\n    Tools.GetFolderPath = function (uri, returnUnchangedIfNoSlash) {\n        if (returnUnchangedIfNoSlash === void 0) { returnUnchangedIfNoSlash = false; }\n        var index = uri.lastIndexOf(\"/\");\n        if (index < 0) {\n            if (returnUnchangedIfNoSlash) {\n                return uri;\n            }\n            return \"\";\n        }\n        return uri.substring(0, index + 1);\n    };\n    /**\n     * Convert an angle in radians to degrees\n     * @param angle defines the angle to convert\n     * @returns the angle in degrees\n     */\n    Tools.ToDegrees = function (angle) {\n        return (angle * 180) / Math.PI;\n    };\n    /**\n     * Convert an angle in degrees to radians\n     * @param angle defines the angle to convert\n     * @returns the angle in radians\n     */\n    Tools.ToRadians = function (angle) {\n        return (angle * Math.PI) / 180;\n    };\n    /**\n     * Returns an array if obj is not an array\n     * @param obj defines the object to evaluate as an array\n     * @param allowsNullUndefined defines a boolean indicating if obj is allowed to be null or undefined\n     * @returns either obj directly if obj is an array or a new array containing obj\n     */\n    Tools.MakeArray = function (obj, allowsNullUndefined) {\n        if (allowsNullUndefined !== true && (obj === undefined || obj == null)) {\n            return null;\n        }\n        return Array.isArray(obj) ? obj : [obj];\n    };\n    /**\n     * Gets the pointer prefix to use\n     * @param engine defines the engine we are finding the prefix for\n     * @returns \"pointer\" if touch is enabled. Else returns \"mouse\"\n     */\n    Tools.GetPointerPrefix = function (engine) {\n        var eventPrefix = \"pointer\";\n        // Check if pointer events are supported\n        if (IsWindowObjectExist() && !window.PointerEvent) {\n            eventPrefix = \"mouse\";\n        }\n        // Special Fallback MacOS Safari...\n        if (engine._badDesktopOS &&\n            !engine._badOS &&\n            // And not ipad pros who claim to be macs...\n            !(document && \"ontouchend\" in document)) {\n            eventPrefix = \"mouse\";\n        }\n        return eventPrefix;\n    };\n    /**\n     * Sets the cors behavior on a dom element. This will add the required Tools.CorsBehavior to the element.\n     * @param url define the url we are trying\n     * @param element define the dom element where to configure the cors policy\n     * @param element.crossOrigin\n     */\n    Tools.SetCorsBehavior = function (url, element) {\n        SetCorsBehavior(url, element);\n    };\n    // External files\n    /**\n     * Removes unwanted characters from an url\n     * @param url defines the url to clean\n     * @returns the cleaned url\n     */\n    Tools.CleanUrl = function (url) {\n        url = url.replace(/#/gm, \"%23\");\n        return url;\n    };\n    Object.defineProperty(Tools, \"PreprocessUrl\", {\n        /**\n         * Gets or sets a function used to pre-process url before using them to load assets\n         */\n        get: function () {\n            return FileToolsOptions.PreprocessUrl;\n        },\n        set: function (processor) {\n            FileToolsOptions.PreprocessUrl = processor;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Loads an image as an HTMLImageElement.\n     * @param input url string, ArrayBuffer, or Blob to load\n     * @param onLoad callback called when the image successfully loads\n     * @param onError callback called when the image fails to load\n     * @param offlineProvider offline provider for caching\n     * @param mimeType optional mime type\n     * @param imageBitmapOptions optional the options to use when creating an ImageBitmap\n     * @returns the HTMLImageElement of the loaded image\n     */\n    Tools.LoadImage = function (input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions) {\n        return FileToolLoadImage(input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions);\n    };\n    /**\n     * Loads a file from a url\n     * @param url url string, ArrayBuffer, or Blob to load\n     * @param onSuccess callback called when the file successfully loads\n     * @param onProgress callback called while file is loading (if the server supports this mode)\n     * @param offlineProvider defines the offline provider for caching\n     * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n     * @param onError callback called when the file fails to load\n     * @returns a file request object\n     */\n    Tools.LoadFile = function (url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n        return FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError);\n    };\n    /**\n     * Loads a file from a url\n     * @param url the file url to load\n     * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n     * @returns a promise containing an ArrayBuffer corresponding to the loaded file\n     */\n    Tools.LoadFileAsync = function (url, useArrayBuffer) {\n        if (useArrayBuffer === void 0) { useArrayBuffer = true; }\n        return new Promise(function (resolve, reject) {\n            FileToolsLoadFile(url, function (data) {\n                resolve(data);\n            }, undefined, undefined, useArrayBuffer, function (request, exception) {\n                reject(exception);\n            });\n        });\n    };\n    /**\n     * Load a script (identified by an url). When the url returns, the\n     * content of this file is added into a new script element, attached to the DOM (body element)\n     * @param scriptUrl defines the url of the script to laod\n     * @param onSuccess defines the callback called when the script is loaded\n     * @param onError defines the callback to call if an error occurs\n     * @param scriptId defines the id of the script element\n     */\n    Tools.LoadScript = function (scriptUrl, onSuccess, onError, scriptId) {\n        if (!IsWindowObjectExist()) {\n            return;\n        }\n        var head = document.getElementsByTagName(\"head\")[0];\n        var script = document.createElement(\"script\");\n        script.setAttribute(\"type\", \"text/javascript\");\n        script.setAttribute(\"src\", scriptUrl);\n        if (scriptId) {\n            script.id = scriptId;\n        }\n        script.onload = function () {\n            if (onSuccess) {\n                onSuccess();\n            }\n        };\n        script.onerror = function (e) {\n            if (onError) {\n                onError(\"Unable to load script '\".concat(scriptUrl, \"'\"), e);\n            }\n        };\n        head.appendChild(script);\n    };\n    /**\n     * Load an asynchronous script (identified by an url). When the url returns, the\n     * content of this file is added into a new script element, attached to the DOM (body element)\n     * @param scriptUrl defines the url of the script to laod\n     * @returns a promise request object\n     */\n    Tools.LoadScriptAsync = function (scriptUrl) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.LoadScript(scriptUrl, function () {\n                resolve();\n            }, function (message, exception) {\n                reject(exception);\n            });\n        });\n    };\n    /**\n     * Loads a file from a blob\n     * @param fileToLoad defines the blob to use\n     * @param callback defines the callback to call when data is loaded\n     * @param progressCallback defines the callback to call during loading process\n     * @returns a file request object\n     */\n    Tools.ReadFileAsDataURL = function (fileToLoad, callback, progressCallback) {\n        var reader = new FileReader();\n        var request = {\n            onCompleteObservable: new Observable(),\n            abort: function () { return reader.abort(); },\n        };\n        reader.onloadend = function () {\n            request.onCompleteObservable.notifyObservers(request);\n        };\n        reader.onload = function (e) {\n            //target doesn't have result from ts 1.3\n            callback(e.target[\"result\"]);\n        };\n        reader.onprogress = progressCallback;\n        reader.readAsDataURL(fileToLoad);\n        return request;\n    };\n    /**\n     * Reads a file from a File object\n     * @param file defines the file to load\n     * @param onSuccess defines the callback to call when data is loaded\n     * @param onProgress defines the callback to call during loading process\n     * @param useArrayBuffer defines a boolean indicating that data must be returned as an ArrayBuffer\n     * @param onError defines the callback to call when an error occurs\n     * @returns a file request object\n     */\n    Tools.ReadFile = function (file, onSuccess, onProgress, useArrayBuffer, onError) {\n        return FileToolsReadFile(file, onSuccess, onProgress, useArrayBuffer, onError);\n    };\n    /**\n     * Creates a data url from a given string content\n     * @param content defines the content to convert\n     * @returns the new data url link\n     */\n    Tools.FileAsURL = function (content) {\n        var fileBlob = new Blob([content]);\n        var url = window.URL || window.webkitURL;\n        var link = url.createObjectURL(fileBlob);\n        return link;\n    };\n    /**\n     * Format the given number to a specific decimal format\n     * @param value defines the number to format\n     * @param decimals defines the number of decimals to use\n     * @returns the formatted string\n     */\n    Tools.Format = function (value, decimals) {\n        if (decimals === void 0) { decimals = 2; }\n        return value.toFixed(decimals);\n    };\n    /**\n     * Tries to copy an object by duplicating every property\n     * @param source defines the source object\n     * @param destination defines the target object\n     * @param doNotCopyList defines a list of properties to avoid\n     * @param mustCopyList defines a list of properties to copy (even if they start with _)\n     */\n    Tools.DeepCopy = function (source, destination, doNotCopyList, mustCopyList) {\n        DeepCopier.DeepCopy(source, destination, doNotCopyList, mustCopyList);\n    };\n    /**\n     * Gets a boolean indicating if the given object has no own property\n     * @param obj defines the object to test\n     * @returns true if object has no own property\n     */\n    Tools.IsEmpty = function (obj) {\n        for (var i in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, i)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Function used to register events at window level\n     * @param windowElement defines the Window object to use\n     * @param events defines the events to register\n     */\n    Tools.RegisterTopRootEvents = function (windowElement, events) {\n        for (var index = 0; index < events.length; index++) {\n            var event_1 = events[index];\n            windowElement.addEventListener(event_1.name, event_1.handler, false);\n            try {\n                if (window.parent) {\n                    window.parent.addEventListener(event_1.name, event_1.handler, false);\n                }\n            }\n            catch (e) {\n                // Silently fails...\n            }\n        }\n    };\n    /**\n     * Function used to unregister events from window level\n     * @param windowElement defines the Window object to use\n     * @param events defines the events to unregister\n     */\n    Tools.UnregisterTopRootEvents = function (windowElement, events) {\n        for (var index = 0; index < events.length; index++) {\n            var event_2 = events[index];\n            windowElement.removeEventListener(event_2.name, event_2.handler);\n            try {\n                if (windowElement.parent) {\n                    windowElement.parent.removeEventListener(event_2.name, event_2.handler);\n                }\n            }\n            catch (e) {\n                // Silently fails...\n            }\n        }\n    };\n    /**\n     * Dumps the current bound framebuffer\n     * @param width defines the rendering width\n     * @param height defines the rendering height\n     * @param engine defines the hosting engine\n     * @param successCallback defines the callback triggered once the data are available\n     * @param mimeType defines the mime type of the result\n     * @param fileName defines the filename to download. If present, the result will automatically be downloaded\n     * @return a void promise\n     */\n    Tools.DumpFramebuffer = function (width, height, engine, successCallback, mimeType, fileName) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        return __awaiter(this, void 0, void 0, function () {\n            var bufferView, data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, engine.readPixels(0, 0, width, height)];\n                    case 1:\n                        bufferView = _a.sent();\n                        data = new Uint8Array(bufferView.buffer);\n                        Tools.DumpData(width, height, data, successCallback, mimeType, fileName, true);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Dumps an array buffer\n     * @param width defines the rendering width\n     * @param height defines the rendering height\n     * @param data the data array\n     * @param successCallback defines the callback triggered once the data are available\n     * @param mimeType defines the mime type of the result\n     * @param fileName defines the filename to download. If present, the result will automatically be downloaded\n     * @param invertY true to invert the picture in the Y dimension\n     * @param toArrayBuffer true to convert the data to an ArrayBuffer (encoded as `mimeType`) instead of a base64 string\n     * @param quality defines the quality of the result\n     */\n    Tools.DumpData = function (width, height, data, successCallback, mimeType, fileName, invertY, toArrayBuffer, quality) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        if (invertY === void 0) { invertY = false; }\n        if (toArrayBuffer === void 0) { toArrayBuffer = false; }\n        // Create a 2D canvas to store the result\n        if (!Tools._ScreenshotCanvas) {\n            Tools._ScreenshotCanvas = document.createElement(\"canvas\");\n        }\n        Tools._ScreenshotCanvas.width = width;\n        Tools._ScreenshotCanvas.height = height;\n        var context = Tools._ScreenshotCanvas.getContext(\"2d\");\n        if (context) {\n            // Convert if data are float32\n            if (data instanceof Float32Array) {\n                var data2 = new Uint8Array(data.length);\n                var n = data.length;\n                while (n--) {\n                    var v = data[n];\n                    data2[n] = v < 0 ? 0 : v > 1 ? 1 : Math.round(v * 255);\n                }\n                data = data2;\n            }\n            // Copy the pixels to a 2D canvas\n            var imageData = context.createImageData(width, height);\n            var castData = imageData.data;\n            castData.set(data);\n            context.putImageData(imageData, 0, 0);\n            var canvas = Tools._ScreenshotCanvas;\n            if (invertY) {\n                var canvas2 = document.createElement(\"canvas\");\n                canvas2.width = width;\n                canvas2.height = height;\n                var ctx2 = canvas2.getContext(\"2d\");\n                if (!ctx2) {\n                    return;\n                }\n                ctx2.translate(0, height);\n                ctx2.scale(1, -1);\n                ctx2.drawImage(Tools._ScreenshotCanvas, 0, 0);\n                canvas = canvas2;\n            }\n            if (toArrayBuffer) {\n                Tools.ToBlob(canvas, function (blob) {\n                    var fileReader = new FileReader();\n                    fileReader.onload = function (event) {\n                        var arrayBuffer = event.target.result;\n                        if (successCallback) {\n                            successCallback(arrayBuffer);\n                        }\n                    };\n                    fileReader.readAsArrayBuffer(blob);\n                }, mimeType, quality);\n            }\n            else {\n                Tools.EncodeScreenshotCanvasData(successCallback, mimeType, fileName, canvas, quality);\n            }\n        }\n    };\n    /**\n     * Dumps an array buffer\n     * @param width defines the rendering width\n     * @param height defines the rendering height\n     * @param data the data array\n     * @param mimeType defines the mime type of the result\n     * @param fileName defines the filename to download. If present, the result will automatically be downloaded\n     * @param invertY true to invert the picture in the Y dimension\n     * @param toArrayBuffer true to convert the data to an ArrayBuffer (encoded as `mimeType`) instead of a base64 string\n     * @param quality defines the quality of the result\n     * @return a promise that resolve to the final data\n     */\n    Tools.DumpDataAsync = function (width, height, data, mimeType, fileName, invertY, toArrayBuffer, quality) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        if (invertY === void 0) { invertY = false; }\n        if (toArrayBuffer === void 0) { toArrayBuffer = false; }\n        return new Promise(function (resolve) {\n            Tools.DumpData(width, height, data, function (result) { return resolve(result); }, mimeType, fileName, invertY, toArrayBuffer, quality);\n        });\n    };\n    /**\n     * Converts the canvas data to blob.\n     * This acts as a polyfill for browsers not supporting the to blob function.\n     * @param canvas Defines the canvas to extract the data from\n     * @param successCallback Defines the callback triggered once the data are available\n     * @param mimeType Defines the mime type of the result\n     * @param quality defines the quality of the result\n     */\n    Tools.ToBlob = function (canvas, successCallback, mimeType, quality) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        // We need HTMLCanvasElement.toBlob for HD screenshots\n        if (!canvas.toBlob) {\n            //  low performance polyfill based on toDataURL (https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob)\n            canvas.toBlob = function (callback, type, quality) {\n                var _this = this;\n                setTimeout(function () {\n                    var binStr = atob(_this.toDataURL(type, quality).split(\",\")[1]), len = binStr.length, arr = new Uint8Array(len);\n                    for (var i = 0; i < len; i++) {\n                        arr[i] = binStr.charCodeAt(i);\n                    }\n                    callback(new Blob([arr]));\n                });\n            };\n        }\n        canvas.toBlob(function (blob) {\n            successCallback(blob);\n        }, mimeType, quality);\n    };\n    /**\n     * Encodes the canvas data to base 64 or automatically download the result if filename is defined\n     * @param successCallback defines the callback triggered once the data are available\n     * @param mimeType defines the mime type of the result\n     * @param fileName defines he filename to download. If present, the result will automatically be downloaded\n     * @param canvas canvas to get the data from. If not provided, use the default screenshot canvas\n     * @param quality defines the quality of the result\n     */\n    Tools.EncodeScreenshotCanvasData = function (successCallback, mimeType, fileName, canvas, quality) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        if (successCallback) {\n            var base64Image = (canvas !== null && canvas !== void 0 ? canvas : Tools._ScreenshotCanvas).toDataURL(mimeType, quality);\n            successCallback(base64Image);\n        }\n        else {\n            this.ToBlob(canvas !== null && canvas !== void 0 ? canvas : Tools._ScreenshotCanvas, function (blob) {\n                //Creating a link if the browser have the download attribute on the a tag, to automatically start download generated image.\n                if (\"download\" in document.createElement(\"a\")) {\n                    if (!fileName) {\n                        var date = new Date();\n                        var stringDate = (date.getFullYear() + \"-\" + (date.getMonth() + 1)).slice(2) +\n                            \"-\" +\n                            date.getDate() +\n                            \"_\" +\n                            date.getHours() +\n                            \"-\" +\n                            (\"0\" + date.getMinutes()).slice(-2);\n                        fileName = \"screenshot_\" + stringDate + \".png\";\n                    }\n                    Tools.Download(blob, fileName);\n                }\n                else {\n                    if (blob) {\n                        var url_1 = URL.createObjectURL(blob);\n                        var newWindow = window.open(\"\");\n                        if (!newWindow) {\n                            return;\n                        }\n                        var img = newWindow.document.createElement(\"img\");\n                        img.onload = function () {\n                            // no longer need to read the blob so it's revoked\n                            URL.revokeObjectURL(url_1);\n                        };\n                        img.src = url_1;\n                        newWindow.document.body.appendChild(img);\n                    }\n                }\n            }, mimeType, quality);\n        }\n    };\n    /**\n     * Downloads a blob in the browser\n     * @param blob defines the blob to download\n     * @param fileName defines the name of the downloaded file\n     */\n    Tools.Download = function (blob, fileName) {\n        if (navigator && navigator.msSaveBlob) {\n            navigator.msSaveBlob(blob, fileName);\n            return;\n        }\n        var url = window.URL.createObjectURL(blob);\n        var a = document.createElement(\"a\");\n        document.body.appendChild(a);\n        a.style.display = \"none\";\n        a.href = url;\n        a.download = fileName;\n        a.addEventListener(\"click\", function () {\n            if (a.parentElement) {\n                a.parentElement.removeChild(a);\n            }\n        });\n        a.click();\n        window.URL.revokeObjectURL(url);\n    };\n    /**\n     * Will return the right value of the noPreventDefault variable\n     * Needed to keep backwards compatibility to the old API.\n     *\n     * @param args arguments passed to the attachControl function\n     * @returns the correct value for noPreventDefault\n     */\n    Tools.BackCompatCameraNoPreventDefault = function (args) {\n        // is it used correctly?\n        if (typeof args[0] === \"boolean\") {\n            return args[0];\n        }\n        else if (typeof args[1] === \"boolean\") {\n            return args[1];\n        }\n        return false;\n    };\n    /**\n     * Captures a screenshot of the current rendering\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine defines the rendering engine\n     * @param camera defines the source camera\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param successCallback defines the callback receives a single parameter which contains the\n     * screenshot as a string of base64-encoded characters. This string can be assigned to the\n     * src parameter of an <img> to display it\n     * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Tools.CreateScreenshot = function (engine, camera, size, successCallback, mimeType) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        throw _WarnImport(\"ScreenshotTools\");\n    };\n    /**\n     * Captures a screenshot of the current rendering\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine defines the rendering engine\n     * @param camera defines the source camera\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param mimeType defines the MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n     * to the src parameter of an <img> to display it\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Tools.CreateScreenshotAsync = function (engine, camera, size, mimeType) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        throw _WarnImport(\"ScreenshotTools\");\n    };\n    /**\n     * Generates an image screenshot from the specified camera.\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine The engine to use for rendering\n     * @param camera The camera to use for rendering\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param successCallback The callback receives a single parameter which contains the\n     * screenshot as a string of base64-encoded characters. This string can be assigned to the\n     * src parameter of an <img> to display it\n     * @param mimeType The MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @param samples Texture samples (default: 1)\n     * @param antialiasing Whether antialiasing should be turned on or not (default: false)\n     * @param fileName A name for for the downloaded file.\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Tools.CreateScreenshotUsingRenderTarget = function (engine, camera, size, successCallback, mimeType, samples, antialiasing, fileName) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        if (samples === void 0) { samples = 1; }\n        if (antialiasing === void 0) { antialiasing = false; }\n        throw _WarnImport(\"ScreenshotTools\");\n    };\n    /**\n     * Generates an image screenshot from the specified camera.\n     * @see https://doc.babylonjs.com/how_to/render_scene_on_a_png\n     * @param engine The engine to use for rendering\n     * @param camera The camera to use for rendering\n     * @param size This parameter can be set to a single number or to an object with the\n     * following (optional) properties: precision, width, height. If a single number is passed,\n     * it will be used for both width and height. If an object is passed, the screenshot size\n     * will be derived from the parameters. The precision property is a multiplier allowing\n     * rendering at a higher or lower resolution\n     * @param mimeType The MIME type of the screenshot image (default: image/png).\n     * Check your browser for supported MIME types\n     * @param samples Texture samples (default: 1)\n     * @param antialiasing Whether antialiasing should be turned on or not (default: false)\n     * @param fileName A name for for the downloaded file.\n     * @returns screenshot as a string of base64-encoded characters. This string can be assigned\n     * to the src parameter of an <img> to display it\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Tools.CreateScreenshotUsingRenderTargetAsync = function (engine, camera, size, mimeType, samples, antialiasing, fileName) {\n        if (mimeType === void 0) { mimeType = \"image/png\"; }\n        if (samples === void 0) { samples = 1; }\n        if (antialiasing === void 0) { antialiasing = false; }\n        throw _WarnImport(\"ScreenshotTools\");\n    };\n    /**\n     * Implementation from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#answer-2117523\n     * Be aware Math.random() could cause collisions, but:\n     * \"All but 6 of the 128 bits of the ID are randomly generated, which means that for any two ids, there's a 1 in 2^^122 (or 5.3x10^^36) chance they'll collide\"\n     * @returns a pseudo random id\n     */\n    Tools.RandomId = function () {\n        return RandomGUID();\n    };\n    /**\n     * Test if the given uri is a base64 string\n     * @deprecated Please use FileTools.IsBase64DataUrl instead.\n     * @param uri The uri to test\n     * @return True if the uri is a base64 string or false otherwise\n     */\n    Tools.IsBase64 = function (uri) {\n        return IsBase64DataUrl(uri);\n    };\n    /**\n     * Decode the given base64 uri.\n     * @deprecated Please use FileTools.DecodeBase64UrlToBinary instead.\n     * @param uri The uri to decode\n     * @return The decoded base64 data.\n     */\n    Tools.DecodeBase64 = function (uri) {\n        return DecodeBase64UrlToBinary(uri);\n    };\n    Object.defineProperty(Tools, \"errorsCount\", {\n        /**\n         * Gets a value indicating the number of loading errors\n         * @ignorenaming\n         */\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        get: function () {\n            return Logger.errorsCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Log a message to the console\n     * @param message defines the message to log\n     */\n    Tools.Log = function (message) {\n        Logger.Log(message);\n    };\n    /**\n     * Write a warning message to the console\n     * @param message defines the message to log\n     */\n    Tools.Warn = function (message) {\n        Logger.Warn(message);\n    };\n    /**\n     * Write an error message to the console\n     * @param message defines the message to log\n     */\n    Tools.Error = function (message) {\n        Logger.Error(message);\n    };\n    Object.defineProperty(Tools, \"LogCache\", {\n        /**\n         * Gets current log cache (list of logs)\n         */\n        get: function () {\n            return Logger.LogCache;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Clears the log cache\n     */\n    Tools.ClearLogCache = function () {\n        Logger.ClearLogCache();\n    };\n    Object.defineProperty(Tools, \"LogLevels\", {\n        /**\n         * Sets the current log level (MessageLogLevel / WarningLogLevel / ErrorLogLevel)\n         */\n        set: function (level) {\n            Logger.LogLevels = level;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Tools, \"PerformanceLogLevel\", {\n        /**\n         * Sets the current performance log level\n         */\n        set: function (level) {\n            if ((level & Tools.PerformanceUserMarkLogLevel) === Tools.PerformanceUserMarkLogLevel) {\n                Tools.StartPerformanceCounter = Tools._StartUserMark;\n                Tools.EndPerformanceCounter = Tools._EndUserMark;\n                return;\n            }\n            if ((level & Tools.PerformanceConsoleLogLevel) === Tools.PerformanceConsoleLogLevel) {\n                Tools.StartPerformanceCounter = Tools._StartPerformanceConsole;\n                Tools.EndPerformanceCounter = Tools._EndPerformanceConsole;\n                return;\n            }\n            Tools.StartPerformanceCounter = Tools._StartPerformanceCounterDisabled;\n            Tools.EndPerformanceCounter = Tools._EndPerformanceCounterDisabled;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Tools._StartPerformanceCounterDisabled = function (counterName, condition) { };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Tools._EndPerformanceCounterDisabled = function (counterName, condition) { };\n    Tools._StartUserMark = function (counterName, condition) {\n        if (condition === void 0) { condition = true; }\n        if (!Tools._Performance) {\n            if (!IsWindowObjectExist()) {\n                return;\n            }\n            Tools._Performance = window.performance;\n        }\n        if (!condition || !Tools._Performance.mark) {\n            return;\n        }\n        Tools._Performance.mark(counterName + \"-Begin\");\n    };\n    Tools._EndUserMark = function (counterName, condition) {\n        if (condition === void 0) { condition = true; }\n        if (!condition || !Tools._Performance.mark) {\n            return;\n        }\n        Tools._Performance.mark(counterName + \"-End\");\n        Tools._Performance.measure(counterName, counterName + \"-Begin\", counterName + \"-End\");\n    };\n    Tools._StartPerformanceConsole = function (counterName, condition) {\n        if (condition === void 0) { condition = true; }\n        if (!condition) {\n            return;\n        }\n        Tools._StartUserMark(counterName, condition);\n        if (console.time) {\n            console.time(counterName);\n        }\n    };\n    Tools._EndPerformanceConsole = function (counterName, condition) {\n        if (condition === void 0) { condition = true; }\n        if (!condition) {\n            return;\n        }\n        Tools._EndUserMark(counterName, condition);\n        console.timeEnd(counterName);\n    };\n    Object.defineProperty(Tools, \"Now\", {\n        /**\n         * Gets either window.performance.now() if supported or Date.now() else\n         */\n        get: function () {\n            return PrecisionDate.Now;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * This method will return the name of the class used to create the instance of the given object.\n     * It will works only on Javascript basic data types (number, string, ...) and instance of class declared with the @className decorator.\n     * @param object the object to get the class name from\n     * @param isType defines if the object is actually a type\n     * @returns the name of the class, will be \"object\" for a custom data type not using the @className decorator\n     */\n    Tools.GetClassName = function (object, isType) {\n        if (isType === void 0) { isType = false; }\n        var name = null;\n        if (!isType && object.getClassName) {\n            name = object.getClassName();\n        }\n        else {\n            if (object instanceof Object) {\n                var classObj = isType ? object : Object.getPrototypeOf(object);\n                name = classObj.constructor[\"__bjsclassName__\"];\n            }\n            if (!name) {\n                name = typeof object;\n            }\n        }\n        return name;\n    };\n    /**\n     * Gets the first element of an array satisfying a given predicate\n     * @param array defines the array to browse\n     * @param predicate defines the predicate to use\n     * @returns null if not found or the element\n     */\n    Tools.First = function (array, predicate) {\n        for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\n            var el = array_1[_i];\n            if (predicate(el)) {\n                return el;\n            }\n        }\n        return null;\n    };\n    /**\n     * This method will return the name of the full name of the class, including its owning module (if any).\n     * It will works only on Javascript basic data types (number, string, ...) and instance of class declared with the @className decorator or implementing a method getClassName():string (in which case the module won't be specified).\n     * @param object the object to get the class name from\n     * @param isType defines if the object is actually a type\n     * @return a string that can have two forms: \"moduleName.className\" if module was specified when the class' Name was registered or \"className\" if there was not module specified.\n     * @ignorenaming\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Tools.getFullClassName = function (object, isType) {\n        if (isType === void 0) { isType = false; }\n        var className = null;\n        var moduleName = null;\n        if (!isType && object.getClassName) {\n            className = object.getClassName();\n        }\n        else {\n            if (object instanceof Object) {\n                var classObj = isType ? object : Object.getPrototypeOf(object);\n                className = classObj.constructor[\"__bjsclassName__\"];\n                moduleName = classObj.constructor[\"__bjsmoduleName__\"];\n            }\n            if (!className) {\n                className = typeof object;\n            }\n        }\n        if (!className) {\n            return null;\n        }\n        return (moduleName != null ? moduleName + \".\" : \"\") + className;\n    };\n    /**\n     * Returns a promise that resolves after the given amount of time.\n     * @param delay Number of milliseconds to delay\n     * @returns Promise that resolves after the given amount of time\n     */\n    Tools.DelayAsync = function (delay) {\n        return new Promise(function (resolve) {\n            setTimeout(function () {\n                resolve();\n            }, delay);\n        });\n    };\n    /**\n     * Utility function to detect if the current user agent is Safari\n     * @returns whether or not the current user agent is safari\n     */\n    Tools.IsSafari = function () {\n        if (!IsNavigatorAvailable()) {\n            return false;\n        }\n        return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n    };\n    /**\n     * Enable/Disable Custom HTTP Request Headers globally.\n     * default = false\n     * @see CustomRequestHeaders\n     */\n    Tools.UseCustomRequestHeaders = false;\n    /**\n     * Custom HTTP Request Headers to be sent with XMLHttpRequests\n     * i.e. when loading files, where the server/service expects an Authorization header\n     */\n    Tools.CustomRequestHeaders = WebRequest.CustomRequestHeaders;\n    Tools._TmpFloatArray = new Float32Array(1);\n    /**\n     * Extracts text content from a DOM element hierarchy\n     * Back Compat only, please use GetDOMTextContent instead.\n     */\n    Tools.GetDOMTextContent = GetDOMTextContent;\n    Tools.GetAbsoluteUrl = typeof document === \"object\"\n        ? function (url) {\n            var a = document.createElement(\"a\");\n            a.href = url;\n            return a.href;\n        }\n        : typeof URL === \"function\" && typeof location === \"object\"\n            ? function (url) { return new URL(url, location.origin).href; }\n            : function () {\n                throw new Error(\"Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.\");\n            };\n    // Logs\n    /**\n     * No log\n     */\n    Tools.NoneLogLevel = Logger.NoneLogLevel;\n    /**\n     * Only message logs\n     */\n    Tools.MessageLogLevel = Logger.MessageLogLevel;\n    /**\n     * Only warning logs\n     */\n    Tools.WarningLogLevel = Logger.WarningLogLevel;\n    /**\n     * Only error logs\n     */\n    Tools.ErrorLogLevel = Logger.ErrorLogLevel;\n    /**\n     * All logs\n     */\n    Tools.AllLogLevel = Logger.AllLogLevel;\n    /**\n     * Checks if the window object exists\n     * Back Compat only, please use IsWindowObjectExist instead.\n     */\n    Tools.IsWindowObjectExist = IsWindowObjectExist;\n    // Performances\n    /**\n     * No performance log\n     */\n    Tools.PerformanceNoneLogLevel = 0;\n    /**\n     * Use user marks to log performance\n     */\n    Tools.PerformanceUserMarkLogLevel = 1;\n    /**\n     * Log performance to the console\n     */\n    Tools.PerformanceConsoleLogLevel = 2;\n    /**\n     * Starts a performance counter\n     */\n    Tools.StartPerformanceCounter = Tools._StartPerformanceCounterDisabled;\n    /**\n     * Ends a specific performance counter\n     */\n    Tools.EndPerformanceCounter = Tools._EndPerformanceCounterDisabled;\n    return Tools;\n}());\nexport { Tools };\n/**\n * Use this className as a decorator on a given class definition to add it a name and optionally its module.\n * You can then use the Tools.getClassName(obj) on an instance to retrieve its class name.\n * This method is the only way to get it done in all cases, even if the .js file declaring the class is minified\n * @param name The name of the class, case should be preserved\n * @param module The name of the Module hosting the class, optional, but strongly recommended to specify if possible. Case should be preserved.\n */\nexport function className(name, module) {\n    return function (target) {\n        target[\"__bjsclassName__\"] = name;\n        target[\"__bjsmoduleName__\"] = module != null ? module : null;\n    };\n}\n/**\n * An implementation of a loop for asynchronous functions.\n */\nvar AsyncLoop = /** @class */ (function () {\n    /**\n     * Constructor.\n     * @param iterations the number of iterations.\n     * @param func the function to run each iteration\n     * @param successCallback the callback that will be called upon successful execution\n     * @param offset starting offset.\n     */\n    function AsyncLoop(\n    /**\n     * Defines the number of iterations for the loop\n     */\n    iterations, func, successCallback, offset) {\n        if (offset === void 0) { offset = 0; }\n        this.iterations = iterations;\n        this.index = offset - 1;\n        this._done = false;\n        this._fn = func;\n        this._successCallback = successCallback;\n    }\n    /**\n     * Execute the next iteration. Must be called after the last iteration was finished.\n     */\n    AsyncLoop.prototype.executeNext = function () {\n        if (!this._done) {\n            if (this.index + 1 < this.iterations) {\n                ++this.index;\n                this._fn(this);\n            }\n            else {\n                this.breakLoop();\n            }\n        }\n    };\n    /**\n     * Break the loop and run the success callback.\n     */\n    AsyncLoop.prototype.breakLoop = function () {\n        this._done = true;\n        this._successCallback();\n    };\n    /**\n     * Create and run an async loop.\n     * @param iterations the number of iterations.\n     * @param fn the function to run each iteration\n     * @param successCallback the callback that will be called upon successful execution\n     * @param offset starting offset.\n     * @returns the created async loop object\n     */\n    AsyncLoop.Run = function (iterations, fn, successCallback, offset) {\n        if (offset === void 0) { offset = 0; }\n        var loop = new AsyncLoop(iterations, fn, successCallback, offset);\n        loop.executeNext();\n        return loop;\n    };\n    /**\n     * A for-loop that will run a given number of iterations synchronous and the rest async.\n     * @param iterations total number of iterations\n     * @param syncedIterations number of synchronous iterations in each async iteration.\n     * @param fn the function to call each iteration.\n     * @param callback a success call back that will be called when iterating stops.\n     * @param breakFunction a break condition (optional)\n     * @param timeout timeout settings for the setTimeout function. default - 0.\n     * @returns the created async loop object\n     */\n    AsyncLoop.SyncAsyncForLoop = function (iterations, syncedIterations, fn, callback, breakFunction, timeout) {\n        if (timeout === void 0) { timeout = 0; }\n        return AsyncLoop.Run(Math.ceil(iterations / syncedIterations), function (loop) {\n            if (breakFunction && breakFunction()) {\n                loop.breakLoop();\n            }\n            else {\n                setTimeout(function () {\n                    for (var i = 0; i < syncedIterations; ++i) {\n                        var iteration = loop.index * syncedIterations + i;\n                        if (iteration >= iterations) {\n                            break;\n                        }\n                        fn(iteration);\n                        if (breakFunction && breakFunction()) {\n                            loop.breakLoop();\n                            break;\n                        }\n                    }\n                    loop.executeNext();\n                }, timeout);\n            }\n        }, callback);\n    };\n    return AsyncLoop;\n}());\nexport { AsyncLoop };\n// Will only be define if Tools is imported freeing up some space when only engine is required\nEngineStore.FallbackTexture =\n    \"data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z\";\n//# sourceMappingURL=tools.js.map","/** @hidden */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nvar _RegisteredTypes = {};\n/**\n * @param className\n * @param type\n * @hidden\n */\nexport function RegisterClass(className, type) {\n    _RegisteredTypes[className] = type;\n}\n/**\n * @param fqdn\n * @hidden\n */\nexport function GetClass(fqdn) {\n    return _RegisteredTypes[fqdn];\n}\n//# sourceMappingURL=typeStore.js.map","/**\n * Helper class used to generate session unique ID\n */\nvar UniqueIdGenerator = /** @class */ (function () {\n    function UniqueIdGenerator() {\n    }\n    Object.defineProperty(UniqueIdGenerator, \"UniqueId\", {\n        /**\n         * Gets an unique (relatively to the current scene) Id\n         */\n        get: function () {\n            var result = this._UniqueIdCounter;\n            this._UniqueIdCounter++;\n            return result;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    // Statics\n    UniqueIdGenerator._UniqueIdCounter = 1;\n    return UniqueIdGenerator;\n}());\nexport { UniqueIdGenerator };\n//# sourceMappingURL=uniqueIdGenerator.js.map","import { __assign } from \"tslib\";\nimport { Vector3, Vector2 } from \"../Maths/math.vector.js\";\nimport { StringDictionary } from \"./stringDictionary.js\";\n// Mainly based on these 2 articles :\n// Creating an universal virtual touch joystick working for all Touch models thanks to Hand.JS : http://blogs.msdn.com/b/davrous/archive/2013/02/22/creating-an-universal-virtual-touch-joystick-working-for-all-touch-models-thanks-to-hand-js.aspx\n// & on Seb Lee-Delisle original work: http://seb.ly/2011/04/multi-touch-game-controller-in-javascripthtml5-for-ipad/\n/**\n * Defines the potential axis of a Joystick\n */\nexport var JoystickAxis;\n(function (JoystickAxis) {\n    /** X axis */\n    JoystickAxis[JoystickAxis[\"X\"] = 0] = \"X\";\n    /** Y axis */\n    JoystickAxis[JoystickAxis[\"Y\"] = 1] = \"Y\";\n    /** Z axis */\n    JoystickAxis[JoystickAxis[\"Z\"] = 2] = \"Z\";\n})(JoystickAxis || (JoystickAxis = {}));\n/**\n * Class used to define virtual joystick (used in touch mode)\n */\nvar VirtualJoystick = /** @class */ (function () {\n    /**\n     * Creates a new virtual joystick\n     * @param leftJoystick defines that the joystick is for left hand (false by default)\n     * @param customizations Defines the options we want to customize the VirtualJoystick\n     */\n    function VirtualJoystick(leftJoystick, customizations) {\n        var _this = this;\n        var options = __assign(__assign({}, VirtualJoystick._GetDefaultOptions()), customizations);\n        if (leftJoystick) {\n            this._leftJoystick = true;\n        }\n        else {\n            this._leftJoystick = false;\n        }\n        VirtualJoystick._GlobalJoystickIndex++;\n        // By default left & right arrow keys are moving the X\n        // and up & down keys are moving the Y\n        this._axisTargetedByLeftAndRight = JoystickAxis.X;\n        this._axisTargetedByUpAndDown = JoystickAxis.Y;\n        this.reverseLeftRight = false;\n        this.reverseUpDown = false;\n        // collections of pointers\n        this._touches = new StringDictionary();\n        this.deltaPosition = Vector3.Zero();\n        this._joystickSensibility = 25;\n        this._inversedSensibility = 1 / (this._joystickSensibility / 1000);\n        this._onResize = function () {\n            VirtualJoystick._VJCanvasWidth = window.innerWidth;\n            VirtualJoystick._VJCanvasHeight = window.innerHeight;\n            if (VirtualJoystick.Canvas) {\n                VirtualJoystick.Canvas.width = VirtualJoystick._VJCanvasWidth;\n                VirtualJoystick.Canvas.height = VirtualJoystick._VJCanvasHeight;\n            }\n            VirtualJoystick._HalfWidth = VirtualJoystick._VJCanvasWidth / 2;\n        };\n        // injecting a canvas element on top of the canvas 3D game\n        if (!VirtualJoystick.Canvas) {\n            window.addEventListener(\"resize\", this._onResize, false);\n            VirtualJoystick.Canvas = document.createElement(\"canvas\");\n            VirtualJoystick._VJCanvasWidth = window.innerWidth;\n            VirtualJoystick._VJCanvasHeight = window.innerHeight;\n            VirtualJoystick.Canvas.width = window.innerWidth;\n            VirtualJoystick.Canvas.height = window.innerHeight;\n            VirtualJoystick.Canvas.style.width = \"100%\";\n            VirtualJoystick.Canvas.style.height = \"100%\";\n            VirtualJoystick.Canvas.style.position = \"absolute\";\n            VirtualJoystick.Canvas.style.backgroundColor = \"transparent\";\n            VirtualJoystick.Canvas.style.top = \"0px\";\n            VirtualJoystick.Canvas.style.left = \"0px\";\n            VirtualJoystick.Canvas.style.zIndex = \"5\";\n            VirtualJoystick.Canvas.style.msTouchAction = \"none\";\n            VirtualJoystick.Canvas.style.touchAction = \"none\"; // fix https://forum.babylonjs.com/t/virtualjoystick-needs-to-set-style-touch-action-none-explicitly/9562\n            // Support for jQuery PEP polyfill\n            VirtualJoystick.Canvas.setAttribute(\"touch-action\", \"none\");\n            var context_1 = VirtualJoystick.Canvas.getContext(\"2d\");\n            if (!context_1) {\n                throw new Error(\"Unable to create canvas for virtual joystick\");\n            }\n            VirtualJoystick._VJCanvasContext = context_1;\n            VirtualJoystick._VJCanvasContext.strokeStyle = \"#ffffff\";\n            VirtualJoystick._VJCanvasContext.lineWidth = 2;\n            document.body.appendChild(VirtualJoystick.Canvas);\n        }\n        VirtualJoystick._HalfWidth = VirtualJoystick.Canvas.width / 2;\n        this.pressed = false;\n        this.limitToContainer = options.limitToContainer;\n        // default joystick color\n        this._joystickColor = options.color;\n        // default joystick size\n        this.containerSize = options.containerSize;\n        this.puckSize = options.puckSize;\n        if (options.position) {\n            this.setPosition(options.position.x, options.position.y);\n        }\n        if (options.puckImage) {\n            this.setPuckImage(options.puckImage);\n        }\n        if (options.containerImage) {\n            this.setContainerImage(options.containerImage);\n        }\n        if (options.alwaysVisible) {\n            VirtualJoystick._AlwaysVisibleSticks++;\n        }\n        // must come after position potentially set\n        this.alwaysVisible = options.alwaysVisible;\n        this._joystickPointerId = -1;\n        // current joystick position\n        this._joystickPointerPos = new Vector2(0, 0);\n        this._joystickPreviousPointerPos = new Vector2(0, 0);\n        // origin joystick position\n        this._joystickPointerStartPos = new Vector2(0, 0);\n        this._deltaJoystickVector = new Vector2(0, 0);\n        this._onPointerDownHandlerRef = function (evt) {\n            _this._onPointerDown(evt);\n        };\n        this._onPointerMoveHandlerRef = function (evt) {\n            _this._onPointerMove(evt);\n        };\n        this._onPointerUpHandlerRef = function (evt) {\n            _this._onPointerUp(evt);\n        };\n        VirtualJoystick.Canvas.addEventListener(\"pointerdown\", this._onPointerDownHandlerRef, false);\n        VirtualJoystick.Canvas.addEventListener(\"pointermove\", this._onPointerMoveHandlerRef, false);\n        VirtualJoystick.Canvas.addEventListener(\"pointerup\", this._onPointerUpHandlerRef, false);\n        VirtualJoystick.Canvas.addEventListener(\"pointerout\", this._onPointerUpHandlerRef, false);\n        VirtualJoystick.Canvas.addEventListener(\"contextmenu\", function (evt) {\n            evt.preventDefault(); // Disables system menu\n        }, false);\n        requestAnimationFrame(function () {\n            _this._drawVirtualJoystick();\n        });\n    }\n    VirtualJoystick._GetDefaultOptions = function () {\n        return {\n            puckSize: 40,\n            containerSize: 60,\n            color: \"cyan\",\n            puckImage: undefined,\n            containerImage: undefined,\n            position: undefined,\n            alwaysVisible: false,\n            limitToContainer: false,\n        };\n    };\n    /**\n     * Defines joystick sensibility (ie. the ratio between a physical move and virtual joystick position change)\n     * @param newJoystickSensibility defines the new sensibility\n     */\n    VirtualJoystick.prototype.setJoystickSensibility = function (newJoystickSensibility) {\n        this._joystickSensibility = newJoystickSensibility;\n        this._inversedSensibility = 1 / (this._joystickSensibility / 1000);\n    };\n    VirtualJoystick.prototype._onPointerDown = function (e) {\n        var positionOnScreenCondition;\n        e.preventDefault();\n        if (this._leftJoystick === true) {\n            positionOnScreenCondition = e.clientX < VirtualJoystick._HalfWidth;\n        }\n        else {\n            positionOnScreenCondition = e.clientX > VirtualJoystick._HalfWidth;\n        }\n        if (positionOnScreenCondition && this._joystickPointerId < 0) {\n            // First contact will be dedicated to the virtual joystick\n            this._joystickPointerId = e.pointerId;\n            if (this._joystickPosition) {\n                this._joystickPointerStartPos = this._joystickPosition.clone();\n                this._joystickPointerPos = this._joystickPosition.clone();\n                this._joystickPreviousPointerPos = this._joystickPosition.clone();\n                // in case the user only clicks down && doesn't move:\n                // this ensures the delta is properly set\n                this._onPointerMove(e);\n            }\n            else {\n                this._joystickPointerStartPos.x = e.clientX;\n                this._joystickPointerStartPos.y = e.clientY;\n                this._joystickPointerPos = this._joystickPointerStartPos.clone();\n                this._joystickPreviousPointerPos = this._joystickPointerStartPos.clone();\n            }\n            this._deltaJoystickVector.x = 0;\n            this._deltaJoystickVector.y = 0;\n            this.pressed = true;\n            this._touches.add(e.pointerId.toString(), e);\n        }\n        else {\n            // You can only trigger the action buttons with a joystick declared\n            if (VirtualJoystick._GlobalJoystickIndex < 2 && this._action) {\n                this._action();\n                this._touches.add(e.pointerId.toString(), { x: e.clientX, y: e.clientY, prevX: e.clientX, prevY: e.clientY });\n            }\n        }\n    };\n    VirtualJoystick.prototype._onPointerMove = function (e) {\n        // If the current pointer is the one associated to the joystick (first touch contact)\n        if (this._joystickPointerId == e.pointerId) {\n            // limit to container if need be\n            if (this.limitToContainer) {\n                var vector = new Vector2(e.clientX - this._joystickPointerStartPos.x, e.clientY - this._joystickPointerStartPos.y);\n                var distance = vector.length();\n                if (distance > this.containerSize) {\n                    vector.scaleInPlace(this.containerSize / distance);\n                }\n                this._joystickPointerPos.x = this._joystickPointerStartPos.x + vector.x;\n                this._joystickPointerPos.y = this._joystickPointerStartPos.y + vector.y;\n            }\n            else {\n                this._joystickPointerPos.x = e.clientX;\n                this._joystickPointerPos.y = e.clientY;\n            }\n            // create delta vector\n            this._deltaJoystickVector = this._joystickPointerPos.clone();\n            this._deltaJoystickVector = this._deltaJoystickVector.subtract(this._joystickPointerStartPos);\n            // if a joystick is always visible, there will be clipping issues if\n            // you drag the puck from one over the container of the other\n            if (0 < VirtualJoystick._AlwaysVisibleSticks) {\n                if (this._leftJoystick) {\n                    this._joystickPointerPos.x = Math.min(VirtualJoystick._HalfWidth, this._joystickPointerPos.x);\n                }\n                else {\n                    this._joystickPointerPos.x = Math.max(VirtualJoystick._HalfWidth, this._joystickPointerPos.x);\n                }\n            }\n            var directionLeftRight = this.reverseLeftRight ? -1 : 1;\n            var deltaJoystickX = (directionLeftRight * this._deltaJoystickVector.x) / this._inversedSensibility;\n            switch (this._axisTargetedByLeftAndRight) {\n                case JoystickAxis.X:\n                    this.deltaPosition.x = Math.min(1, Math.max(-1, deltaJoystickX));\n                    break;\n                case JoystickAxis.Y:\n                    this.deltaPosition.y = Math.min(1, Math.max(-1, deltaJoystickX));\n                    break;\n                case JoystickAxis.Z:\n                    this.deltaPosition.z = Math.min(1, Math.max(-1, deltaJoystickX));\n                    break;\n            }\n            var directionUpDown = this.reverseUpDown ? 1 : -1;\n            var deltaJoystickY = (directionUpDown * this._deltaJoystickVector.y) / this._inversedSensibility;\n            switch (this._axisTargetedByUpAndDown) {\n                case JoystickAxis.X:\n                    this.deltaPosition.x = Math.min(1, Math.max(-1, deltaJoystickY));\n                    break;\n                case JoystickAxis.Y:\n                    this.deltaPosition.y = Math.min(1, Math.max(-1, deltaJoystickY));\n                    break;\n                case JoystickAxis.Z:\n                    this.deltaPosition.z = Math.min(1, Math.max(-1, deltaJoystickY));\n                    break;\n            }\n        }\n        else {\n            var data = this._touches.get(e.pointerId.toString());\n            if (data) {\n                data.x = e.clientX;\n                data.y = e.clientY;\n            }\n        }\n    };\n    VirtualJoystick.prototype._onPointerUp = function (e) {\n        if (this._joystickPointerId == e.pointerId) {\n            this._clearPreviousDraw();\n            this._joystickPointerId = -1;\n            this.pressed = false;\n        }\n        else {\n            var touch = this._touches.get(e.pointerId.toString());\n            if (touch) {\n                VirtualJoystick._VJCanvasContext.clearRect(touch.prevX - 44, touch.prevY - 44, 88, 88);\n            }\n        }\n        this._deltaJoystickVector.x = 0;\n        this._deltaJoystickVector.y = 0;\n        this._touches.remove(e.pointerId.toString());\n    };\n    /**\n     * Change the color of the virtual joystick\n     * @param newColor a string that must be a CSS color value (like \"red\") or the hexa value (like \"#FF0000\")\n     */\n    VirtualJoystick.prototype.setJoystickColor = function (newColor) {\n        this._joystickColor = newColor;\n    };\n    Object.defineProperty(VirtualJoystick.prototype, \"containerSize\", {\n        get: function () {\n            return this._joystickContainerSize;\n        },\n        /**\n         * Size of the joystick's container\n         */\n        set: function (newSize) {\n            this._joystickContainerSize = newSize;\n            this._clearContainerSize = ~~(this._joystickContainerSize * 2.1);\n            this._clearContainerSizeOffset = ~~(this._clearContainerSize / 2);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(VirtualJoystick.prototype, \"puckSize\", {\n        get: function () {\n            return this._joystickPuckSize;\n        },\n        /**\n         * Size of the joystick's puck\n         */\n        set: function (newSize) {\n            this._joystickPuckSize = newSize;\n            this._clearPuckSize = ~~(this._joystickPuckSize * 2.1);\n            this._clearPuckSizeOffset = ~~(this._clearPuckSize / 2);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Clears the set position of the joystick\n     */\n    VirtualJoystick.prototype.clearPosition = function () {\n        this.alwaysVisible = false;\n        this._joystickPosition = null;\n    };\n    Object.defineProperty(VirtualJoystick.prototype, \"alwaysVisible\", {\n        get: function () {\n            return this._alwaysVisible;\n        },\n        /**\n         * Defines whether or not the joystick container is always visible\n         */\n        set: function (value) {\n            if (this._alwaysVisible === value) {\n                return;\n            }\n            if (value && this._joystickPosition) {\n                VirtualJoystick._AlwaysVisibleSticks++;\n                this._alwaysVisible = true;\n            }\n            else {\n                VirtualJoystick._AlwaysVisibleSticks--;\n                this._alwaysVisible = false;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Sets the constant position of the Joystick container\n     * @param x X axis coordinate\n     * @param y Y axis coordinate\n     */\n    VirtualJoystick.prototype.setPosition = function (x, y) {\n        // just in case position is moved while the container is visible\n        if (this._joystickPointerStartPos) {\n            this._clearPreviousDraw();\n        }\n        this._joystickPosition = new Vector2(x, y);\n    };\n    /**\n     * Defines a callback to call when the joystick is touched\n     * @param action defines the callback\n     */\n    VirtualJoystick.prototype.setActionOnTouch = function (action) {\n        this._action = action;\n    };\n    /**\n     * Defines which axis you'd like to control for left & right\n     * @param axis defines the axis to use\n     */\n    VirtualJoystick.prototype.setAxisForLeftRight = function (axis) {\n        switch (axis) {\n            case JoystickAxis.X:\n            case JoystickAxis.Y:\n            case JoystickAxis.Z:\n                this._axisTargetedByLeftAndRight = axis;\n                break;\n            default:\n                this._axisTargetedByLeftAndRight = JoystickAxis.X;\n                break;\n        }\n    };\n    /**\n     * Defines which axis you'd like to control for up & down\n     * @param axis defines the axis to use\n     */\n    VirtualJoystick.prototype.setAxisForUpDown = function (axis) {\n        switch (axis) {\n            case JoystickAxis.X:\n            case JoystickAxis.Y:\n            case JoystickAxis.Z:\n                this._axisTargetedByUpAndDown = axis;\n                break;\n            default:\n                this._axisTargetedByUpAndDown = JoystickAxis.Y;\n                break;\n        }\n    };\n    /**\n     * Clears the canvas from the previous puck / container draw\n     */\n    VirtualJoystick.prototype._clearPreviousDraw = function () {\n        var jp = this._joystickPosition || this._joystickPointerStartPos;\n        // clear container pixels\n        VirtualJoystick._VJCanvasContext.clearRect(jp.x - this._clearContainerSizeOffset, jp.y - this._clearContainerSizeOffset, this._clearContainerSize, this._clearContainerSize);\n        // clear puck pixels\n        VirtualJoystick._VJCanvasContext.clearRect(this._joystickPreviousPointerPos.x - this._clearPuckSizeOffset, this._joystickPreviousPointerPos.y - this._clearPuckSizeOffset, this._clearPuckSize, this._clearPuckSize);\n    };\n    /**\n     * Loads `urlPath` to be used for the container's image\n     * @param urlPath defines the urlPath of an image to use\n     */\n    VirtualJoystick.prototype.setContainerImage = function (urlPath) {\n        var _this = this;\n        var image = new Image();\n        image.src = urlPath;\n        image.onload = function () { return (_this._containerImage = image); };\n    };\n    /**\n     * Loads `urlPath` to be used for the puck's image\n     * @param urlPath defines the urlPath of an image to use\n     */\n    VirtualJoystick.prototype.setPuckImage = function (urlPath) {\n        var _this = this;\n        var image = new Image();\n        image.src = urlPath;\n        image.onload = function () { return (_this._puckImage = image); };\n    };\n    /**\n     * Draws the Virtual Joystick's container\n     */\n    VirtualJoystick.prototype._drawContainer = function () {\n        var jp = this._joystickPosition || this._joystickPointerStartPos;\n        this._clearPreviousDraw();\n        if (this._containerImage) {\n            VirtualJoystick._VJCanvasContext.drawImage(this._containerImage, jp.x - this.containerSize, jp.y - this.containerSize, this.containerSize * 2, this.containerSize * 2);\n        }\n        else {\n            // outer container\n            VirtualJoystick._VJCanvasContext.beginPath();\n            VirtualJoystick._VJCanvasContext.strokeStyle = this._joystickColor;\n            VirtualJoystick._VJCanvasContext.lineWidth = 2;\n            VirtualJoystick._VJCanvasContext.arc(jp.x, jp.y, this.containerSize, 0, Math.PI * 2, true);\n            VirtualJoystick._VJCanvasContext.stroke();\n            VirtualJoystick._VJCanvasContext.closePath();\n            // inner container\n            VirtualJoystick._VJCanvasContext.beginPath();\n            VirtualJoystick._VJCanvasContext.lineWidth = 6;\n            VirtualJoystick._VJCanvasContext.strokeStyle = this._joystickColor;\n            VirtualJoystick._VJCanvasContext.arc(jp.x, jp.y, this.puckSize, 0, Math.PI * 2, true);\n            VirtualJoystick._VJCanvasContext.stroke();\n            VirtualJoystick._VJCanvasContext.closePath();\n        }\n    };\n    /**\n     * Draws the Virtual Joystick's puck\n     */\n    VirtualJoystick.prototype._drawPuck = function () {\n        if (this._puckImage) {\n            VirtualJoystick._VJCanvasContext.drawImage(this._puckImage, this._joystickPointerPos.x - this.puckSize, this._joystickPointerPos.y - this.puckSize, this.puckSize * 2, this.puckSize * 2);\n        }\n        else {\n            VirtualJoystick._VJCanvasContext.beginPath();\n            VirtualJoystick._VJCanvasContext.strokeStyle = this._joystickColor;\n            VirtualJoystick._VJCanvasContext.lineWidth = 2;\n            VirtualJoystick._VJCanvasContext.arc(this._joystickPointerPos.x, this._joystickPointerPos.y, this.puckSize, 0, Math.PI * 2, true);\n            VirtualJoystick._VJCanvasContext.stroke();\n            VirtualJoystick._VJCanvasContext.closePath();\n        }\n    };\n    VirtualJoystick.prototype._drawVirtualJoystick = function () {\n        var _this = this;\n        if (this.alwaysVisible) {\n            this._drawContainer();\n        }\n        if (this.pressed) {\n            this._touches.forEach(function (key, touch) {\n                if (touch.pointerId === _this._joystickPointerId) {\n                    if (!_this.alwaysVisible) {\n                        _this._drawContainer();\n                    }\n                    _this._drawPuck();\n                    // store current pointer for next clear\n                    _this._joystickPreviousPointerPos = _this._joystickPointerPos.clone();\n                }\n                else {\n                    VirtualJoystick._VJCanvasContext.clearRect(touch.prevX - 44, touch.prevY - 44, 88, 88);\n                    VirtualJoystick._VJCanvasContext.beginPath();\n                    VirtualJoystick._VJCanvasContext.fillStyle = \"white\";\n                    VirtualJoystick._VJCanvasContext.beginPath();\n                    VirtualJoystick._VJCanvasContext.strokeStyle = \"red\";\n                    VirtualJoystick._VJCanvasContext.lineWidth = 6;\n                    VirtualJoystick._VJCanvasContext.arc(touch.x, touch.y, 40, 0, Math.PI * 2, true);\n                    VirtualJoystick._VJCanvasContext.stroke();\n                    VirtualJoystick._VJCanvasContext.closePath();\n                    touch.prevX = touch.x;\n                    touch.prevY = touch.y;\n                }\n            });\n        }\n        requestAnimationFrame(function () {\n            _this._drawVirtualJoystick();\n        });\n    };\n    /**\n     * Release internal HTML canvas\n     */\n    VirtualJoystick.prototype.releaseCanvas = function () {\n        if (VirtualJoystick.Canvas) {\n            VirtualJoystick.Canvas.removeEventListener(\"pointerdown\", this._onPointerDownHandlerRef);\n            VirtualJoystick.Canvas.removeEventListener(\"pointermove\", this._onPointerMoveHandlerRef);\n            VirtualJoystick.Canvas.removeEventListener(\"pointerup\", this._onPointerUpHandlerRef);\n            VirtualJoystick.Canvas.removeEventListener(\"pointerout\", this._onPointerUpHandlerRef);\n            window.removeEventListener(\"resize\", this._onResize);\n            document.body.removeChild(VirtualJoystick.Canvas);\n            VirtualJoystick.Canvas = null;\n        }\n    };\n    // Used to draw the virtual joystick inside a 2D canvas on top of the WebGL rendering canvas\n    VirtualJoystick._GlobalJoystickIndex = 0;\n    VirtualJoystick._AlwaysVisibleSticks = 0;\n    return VirtualJoystick;\n}());\nexport { VirtualJoystick };\n//# sourceMappingURL=virtualJoystick.js.map","/** @hidden */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction createXMLHttpRequest() {\n    // If running in Babylon Native, then defer to the native XMLHttpRequest, which has the same public contract\n    if (typeof _native !== \"undefined\" && _native.XMLHttpRequest) {\n        return new _native.XMLHttpRequest();\n    }\n    else {\n        return new XMLHttpRequest();\n    }\n}\n/**\n * Extended version of XMLHttpRequest with support for customizations (headers, ...)\n */\nvar WebRequest = /** @class */ (function () {\n    function WebRequest() {\n        this._xhr = createXMLHttpRequest();\n        this._requestURL = \"\";\n    }\n    WebRequest.prototype._injectCustomRequestHeaders = function () {\n        if (this._shouldSkipRequestModifications(this._requestURL)) {\n            return;\n        }\n        for (var key in WebRequest.CustomRequestHeaders) {\n            var val = WebRequest.CustomRequestHeaders[key];\n            if (val) {\n                this._xhr.setRequestHeader(key, val);\n            }\n        }\n    };\n    WebRequest.prototype._shouldSkipRequestModifications = function (url) {\n        return WebRequest.SkipRequestModificationForBabylonCDN && (url.includes(\"preview.babylonjs.com\") || url.includes(\"cdn.babylonjs.com\"));\n    };\n    Object.defineProperty(WebRequest.prototype, \"onprogress\", {\n        /**\n         * Gets or sets a function to be called when loading progress changes\n         */\n        get: function () {\n            return this._xhr.onprogress;\n        },\n        set: function (value) {\n            this._xhr.onprogress = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"readyState\", {\n        /**\n         * Returns client's state\n         */\n        get: function () {\n            return this._xhr.readyState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"status\", {\n        /**\n         * Returns client's status\n         */\n        get: function () {\n            return this._xhr.status;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"statusText\", {\n        /**\n         * Returns client's status as a text\n         */\n        get: function () {\n            return this._xhr.statusText;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"response\", {\n        /**\n         * Returns client's response\n         */\n        get: function () {\n            return this._xhr.response;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"responseURL\", {\n        /**\n         * Returns client's response url\n         */\n        get: function () {\n            return this._xhr.responseURL;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"responseText\", {\n        /**\n         * Returns client's response as text\n         */\n        get: function () {\n            return this._xhr.responseText;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"responseType\", {\n        /**\n         * Gets or sets the expected response type\n         */\n        get: function () {\n            return this._xhr.responseType;\n        },\n        set: function (value) {\n            this._xhr.responseType = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebRequest.prototype, \"timeout\", {\n        /**\n         * Gets or sets the timeout value in milliseconds\n         */\n        get: function () {\n            return this._xhr.timeout;\n        },\n        set: function (value) {\n            this._xhr.timeout = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    WebRequest.prototype.addEventListener = function (type, listener, options) {\n        this._xhr.addEventListener(type, listener, options);\n    };\n    WebRequest.prototype.removeEventListener = function (type, listener, options) {\n        this._xhr.removeEventListener(type, listener, options);\n    };\n    /**\n     * Cancels any network activity\n     */\n    WebRequest.prototype.abort = function () {\n        this._xhr.abort();\n    };\n    /**\n     * Initiates the request. The optional argument provides the request body. The argument is ignored if request method is GET or HEAD\n     * @param body defines an optional request body\n     */\n    WebRequest.prototype.send = function (body) {\n        if (WebRequest.CustomRequestHeaders) {\n            this._injectCustomRequestHeaders();\n        }\n        this._xhr.send(body);\n    };\n    /**\n     * Sets the request method, request URL\n     * @param method defines the method to use (GET, POST, etc..)\n     * @param url defines the url to connect with\n     */\n    WebRequest.prototype.open = function (method, url) {\n        for (var _i = 0, _a = WebRequest.CustomRequestModifiers; _i < _a.length; _i++) {\n            var update = _a[_i];\n            if (this._shouldSkipRequestModifications(url)) {\n                return;\n            }\n            update(this._xhr, url);\n        }\n        // Clean url\n        url = url.replace(\"file:http:\", \"http:\");\n        url = url.replace(\"file:https:\", \"https:\");\n        this._requestURL = url;\n        return this._xhr.open(method, url, true);\n    };\n    /**\n     * Sets the value of a request header.\n     * @param name The name of the header whose value is to be set\n     * @param value The value to set as the body of the header\n     */\n    WebRequest.prototype.setRequestHeader = function (name, value) {\n        this._xhr.setRequestHeader(name, value);\n    };\n    /**\n     * Get the string containing the text of a particular header's value.\n     * @param name The name of the header\n     * @returns The string containing the text of the given header name\n     */\n    WebRequest.prototype.getResponseHeader = function (name) {\n        return this._xhr.getResponseHeader(name);\n    };\n    /**\n     * Custom HTTP Request Headers to be sent with XMLHttpRequests\n     * i.e. when loading files, where the server/service expects an Authorization header\n     */\n    WebRequest.CustomRequestHeaders = {};\n    /**\n     * Add callback functions in this array to update all the requests before they get sent to the network\n     */\n    WebRequest.CustomRequestModifiers = new Array();\n    WebRequest.SkipRequestModificationForBabylonCDN = true;\n    return WebRequest;\n}());\nexport { WebRequest };\n//# sourceMappingURL=webRequest.js.map","import { __extends } from \"tslib\";\n/**\n * Helper class to push actions to a pool of workers.\n */\nvar WorkerPool = /** @class */ (function () {\n    /**\n     * Constructor\n     * @param workers Array of workers to use for actions\n     */\n    function WorkerPool(workers) {\n        this._pendingActions = new Array();\n        this._workerInfos = workers.map(function (worker) { return ({\n            workerPromise: Promise.resolve(worker),\n            idle: true,\n        }); });\n    }\n    /**\n     * Terminates all workers and clears any pending actions.\n     */\n    WorkerPool.prototype.dispose = function () {\n        for (var _i = 0, _a = this._workerInfos; _i < _a.length; _i++) {\n            var workerInfo = _a[_i];\n            workerInfo.workerPromise.then(function (worker) {\n                worker.terminate();\n            });\n        }\n        this._workerInfos.length = 0;\n        this._pendingActions.length = 0;\n    };\n    /**\n     * Pushes an action to the worker pool. If all the workers are active, the action will be\n     * pended until a worker has completed its action.\n     * @param action The action to perform. Call onComplete when the action is complete.\n     */\n    WorkerPool.prototype.push = function (action) {\n        if (!this._executeOnIdleWorker(action)) {\n            this._pendingActions.push(action);\n        }\n    };\n    WorkerPool.prototype._executeOnIdleWorker = function (action) {\n        for (var _i = 0, _a = this._workerInfos; _i < _a.length; _i++) {\n            var workerInfo = _a[_i];\n            if (workerInfo.idle) {\n                this._execute(workerInfo, action);\n                return true;\n            }\n        }\n        return false;\n    };\n    WorkerPool.prototype._execute = function (workerInfo, action) {\n        var _this = this;\n        workerInfo.idle = false;\n        workerInfo.workerPromise.then(function (worker) {\n            action(worker, function () {\n                var nextAction = _this._pendingActions.shift();\n                if (nextAction) {\n                    _this._execute(workerInfo, nextAction);\n                }\n                else {\n                    workerInfo.idle = true;\n                }\n            });\n        });\n    };\n    return WorkerPool;\n}());\nexport { WorkerPool };\n/**\n * Similar to the WorkerPool class except it creates and destroys workers automatically with a maximum of `maxWorkers` workers.\n * Workers are terminated when it is idle for at least `idleTimeElapsedBeforeRelease` milliseconds.\n */\nvar AutoReleaseWorkerPool = /** @class */ (function (_super) {\n    __extends(AutoReleaseWorkerPool, _super);\n    function AutoReleaseWorkerPool(maxWorkers, createWorkerAsync, options) {\n        if (options === void 0) { options = AutoReleaseWorkerPool.DefaultOptions; }\n        var _this = _super.call(this, []) || this;\n        _this._maxWorkers = maxWorkers;\n        _this._createWorkerAsync = createWorkerAsync;\n        _this._options = options;\n        return _this;\n    }\n    AutoReleaseWorkerPool.prototype.push = function (action) {\n        if (!this._executeOnIdleWorker(action)) {\n            if (this._workerInfos.length < this._maxWorkers) {\n                var workerInfo = {\n                    workerPromise: this._createWorkerAsync(),\n                    idle: false,\n                };\n                this._workerInfos.push(workerInfo);\n                this._execute(workerInfo, action);\n            }\n            else {\n                this._pendingActions.push(action);\n            }\n        }\n    };\n    AutoReleaseWorkerPool.prototype._execute = function (workerInfo, action) {\n        var _this = this;\n        // Reset the idle timeout.\n        if (workerInfo.timeoutId) {\n            clearTimeout(workerInfo.timeoutId);\n            delete workerInfo.timeoutId;\n        }\n        _super.prototype._execute.call(this, workerInfo, function (worker, onComplete) {\n            action(worker, function () {\n                onComplete();\n                if (workerInfo.idle) {\n                    // Schedule the worker to be terminated after the elapsed time.\n                    workerInfo.timeoutId = setTimeout(function () {\n                        workerInfo.workerPromise.then(function (worker) {\n                            worker.terminate();\n                        });\n                        var indexOf = _this._workerInfos.indexOf(workerInfo);\n                        if (indexOf !== -1) {\n                            _this._workerInfos.splice(indexOf, 1);\n                        }\n                    }, _this._options.idleTimeElapsedBeforeRelease);\n                }\n            });\n        });\n    };\n    /**\n     * Default options for the constructor.\n     * Override to change the defaults.\n     */\n    AutoReleaseWorkerPool.DefaultOptions = {\n        idleTimeElapsedBeforeRelease: 1000,\n    };\n    return AutoReleaseWorkerPool;\n}(WorkerPool));\nexport { AutoReleaseWorkerPool };\n//# sourceMappingURL=workerPool.js.map","import { __decorate } from \"tslib\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { EngineStore } from \"../Engines/engineStore.js\";\nimport { VertexBuffer } from \"../Buffers/buffer.js\";\nimport { serialize, SerializationHelper } from \"../Misc/decorators.js\";\nimport { GetClass } from \"../Misc/typeStore.js\";\n/**\n * Defines a target to use with MorphTargetManager\n * @see https://doc.babylonjs.com/how_to/how_to_use_morphtargets\n */\nvar MorphTarget = /** @class */ (function () {\n    /**\n     * Creates a new MorphTarget\n     * @param name defines the name of the target\n     * @param influence defines the influence to use\n     * @param scene defines the scene the morphtarget belongs to\n     */\n    function MorphTarget(\n    /** defines the name of the target */\n    name, influence, scene) {\n        if (influence === void 0) { influence = 0; }\n        if (scene === void 0) { scene = null; }\n        this.name = name;\n        /**\n         * Gets or sets the list of animations\n         */\n        this.animations = new Array();\n        this._positions = null;\n        this._normals = null;\n        this._tangents = null;\n        this._uvs = null;\n        this._uniqueId = 0;\n        /**\n         * Observable raised when the influence changes\n         */\n        this.onInfluenceChanged = new Observable();\n        /** @hidden */\n        this._onDataLayoutChanged = new Observable();\n        this._animationPropertiesOverride = null;\n        this._scene = scene || EngineStore.LastCreatedScene;\n        this.influence = influence;\n        if (this._scene) {\n            this._uniqueId = this._scene.getUniqueId();\n        }\n    }\n    Object.defineProperty(MorphTarget.prototype, \"influence\", {\n        /**\n         * Gets or sets the influence of this target (ie. its weight in the overall morphing)\n         */\n        get: function () {\n            return this._influence;\n        },\n        set: function (influence) {\n            if (this._influence === influence) {\n                return;\n            }\n            var previous = this._influence;\n            this._influence = influence;\n            if (this.onInfluenceChanged.hasObservers()) {\n                this.onInfluenceChanged.notifyObservers(previous === 0 || influence === 0);\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTarget.prototype, \"animationPropertiesOverride\", {\n        /**\n         * Gets or sets the animation properties override\n         */\n        get: function () {\n            if (!this._animationPropertiesOverride && this._scene) {\n                return this._scene.animationPropertiesOverride;\n            }\n            return this._animationPropertiesOverride;\n        },\n        set: function (value) {\n            this._animationPropertiesOverride = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTarget.prototype, \"uniqueId\", {\n        /**\n         * Gets the unique ID of this manager\n         */\n        get: function () {\n            return this._uniqueId;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTarget.prototype, \"hasPositions\", {\n        /**\n         * Gets a boolean defining if the target contains position data\n         */\n        get: function () {\n            return !!this._positions;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTarget.prototype, \"hasNormals\", {\n        /**\n         * Gets a boolean defining if the target contains normal data\n         */\n        get: function () {\n            return !!this._normals;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTarget.prototype, \"hasTangents\", {\n        /**\n         * Gets a boolean defining if the target contains tangent data\n         */\n        get: function () {\n            return !!this._tangents;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTarget.prototype, \"hasUVs\", {\n        /**\n         * Gets a boolean defining if the target contains texture coordinates data\n         */\n        get: function () {\n            return !!this._uvs;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Affects position data to this target\n     * @param data defines the position data to use\n     */\n    MorphTarget.prototype.setPositions = function (data) {\n        var hadPositions = this.hasPositions;\n        this._positions = data;\n        if (hadPositions !== this.hasPositions) {\n            this._onDataLayoutChanged.notifyObservers(undefined);\n        }\n    };\n    /**\n     * Gets the position data stored in this target\n     * @returns a FloatArray containing the position data (or null if not present)\n     */\n    MorphTarget.prototype.getPositions = function () {\n        return this._positions;\n    };\n    /**\n     * Affects normal data to this target\n     * @param data defines the normal data to use\n     */\n    MorphTarget.prototype.setNormals = function (data) {\n        var hadNormals = this.hasNormals;\n        this._normals = data;\n        if (hadNormals !== this.hasNormals) {\n            this._onDataLayoutChanged.notifyObservers(undefined);\n        }\n    };\n    /**\n     * Gets the normal data stored in this target\n     * @returns a FloatArray containing the normal data (or null if not present)\n     */\n    MorphTarget.prototype.getNormals = function () {\n        return this._normals;\n    };\n    /**\n     * Affects tangent data to this target\n     * @param data defines the tangent data to use\n     */\n    MorphTarget.prototype.setTangents = function (data) {\n        var hadTangents = this.hasTangents;\n        this._tangents = data;\n        if (hadTangents !== this.hasTangents) {\n            this._onDataLayoutChanged.notifyObservers(undefined);\n        }\n    };\n    /**\n     * Gets the tangent data stored in this target\n     * @returns a FloatArray containing the tangent data (or null if not present)\n     */\n    MorphTarget.prototype.getTangents = function () {\n        return this._tangents;\n    };\n    /**\n     * Affects texture coordinates data to this target\n     * @param data defines the texture coordinates data to use\n     */\n    MorphTarget.prototype.setUVs = function (data) {\n        var hadUVs = this.hasUVs;\n        this._uvs = data;\n        if (hadUVs !== this.hasUVs) {\n            this._onDataLayoutChanged.notifyObservers(undefined);\n        }\n    };\n    /**\n     * Gets the texture coordinates data stored in this target\n     * @returns a FloatArray containing the texture coordinates data (or null if not present)\n     */\n    MorphTarget.prototype.getUVs = function () {\n        return this._uvs;\n    };\n    /**\n     * Clone the current target\n     * @returns a new MorphTarget\n     */\n    MorphTarget.prototype.clone = function () {\n        var _this = this;\n        var newOne = SerializationHelper.Clone(function () { return new MorphTarget(_this.name, _this.influence, _this._scene); }, this);\n        newOne._positions = this._positions;\n        newOne._normals = this._normals;\n        newOne._tangents = this._tangents;\n        newOne._uvs = this._uvs;\n        return newOne;\n    };\n    /**\n     * Serializes the current target into a Serialization object\n     * @returns the serialized object\n     */\n    MorphTarget.prototype.serialize = function () {\n        var serializationObject = {};\n        serializationObject.name = this.name;\n        serializationObject.influence = this.influence;\n        serializationObject.positions = Array.prototype.slice.call(this.getPositions());\n        if (this.id != null) {\n            serializationObject.id = this.id;\n        }\n        if (this.hasNormals) {\n            serializationObject.normals = Array.prototype.slice.call(this.getNormals());\n        }\n        if (this.hasTangents) {\n            serializationObject.tangents = Array.prototype.slice.call(this.getTangents());\n        }\n        if (this.hasUVs) {\n            serializationObject.uvs = Array.prototype.slice.call(this.getUVs());\n        }\n        // Animations\n        SerializationHelper.AppendSerializedAnimations(this, serializationObject);\n        return serializationObject;\n    };\n    /**\n     * Returns the string \"MorphTarget\"\n     * @returns \"MorphTarget\"\n     */\n    MorphTarget.prototype.getClassName = function () {\n        return \"MorphTarget\";\n    };\n    // Statics\n    /**\n     * Creates a new target from serialized data\n     * @param serializationObject defines the serialized data to use\n     * @param scene defines the hosting scene\n     * @returns a new MorphTarget\n     */\n    MorphTarget.Parse = function (serializationObject, scene) {\n        var result = new MorphTarget(serializationObject.name, serializationObject.influence);\n        result.setPositions(serializationObject.positions);\n        if (serializationObject.id != null) {\n            result.id = serializationObject.id;\n        }\n        if (serializationObject.normals) {\n            result.setNormals(serializationObject.normals);\n        }\n        if (serializationObject.tangents) {\n            result.setTangents(serializationObject.tangents);\n        }\n        if (serializationObject.uvs) {\n            result.setUVs(serializationObject.uvs);\n        }\n        // Animations\n        if (serializationObject.animations) {\n            for (var animationIndex = 0; animationIndex < serializationObject.animations.length; animationIndex++) {\n                var parsedAnimation = serializationObject.animations[animationIndex];\n                var internalClass = GetClass(\"BABYLON.Animation\");\n                if (internalClass) {\n                    result.animations.push(internalClass.Parse(parsedAnimation));\n                }\n            }\n            if (serializationObject.autoAnimate && scene) {\n                scene.beginAnimation(result, serializationObject.autoAnimateFrom, serializationObject.autoAnimateTo, serializationObject.autoAnimateLoop, serializationObject.autoAnimateSpeed || 1.0);\n            }\n        }\n        return result;\n    };\n    /**\n     * Creates a MorphTarget from mesh data\n     * @param mesh defines the source mesh\n     * @param name defines the name to use for the new target\n     * @param influence defines the influence to attach to the target\n     * @returns a new MorphTarget\n     */\n    MorphTarget.FromMesh = function (mesh, name, influence) {\n        if (!name) {\n            name = mesh.name;\n        }\n        var result = new MorphTarget(name, influence, mesh.getScene());\n        result.setPositions(mesh.getVerticesData(VertexBuffer.PositionKind));\n        if (mesh.isVerticesDataPresent(VertexBuffer.NormalKind)) {\n            result.setNormals(mesh.getVerticesData(VertexBuffer.NormalKind));\n        }\n        if (mesh.isVerticesDataPresent(VertexBuffer.TangentKind)) {\n            result.setTangents(mesh.getVerticesData(VertexBuffer.TangentKind));\n        }\n        if (mesh.isVerticesDataPresent(VertexBuffer.UVKind)) {\n            result.setUVs(mesh.getVerticesData(VertexBuffer.UVKind));\n        }\n        return result;\n    };\n    __decorate([\n        serialize()\n    ], MorphTarget.prototype, \"id\", void 0);\n    return MorphTarget;\n}());\nexport { MorphTarget };\n//# sourceMappingURL=morphTarget.js.map","import { SmartArray } from \"../Misc/smartArray.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { EngineStore } from \"../Engines/engineStore.js\";\nimport { MorphTarget } from \"./morphTarget.js\";\n\nimport { RawTexture2DArray } from \"../Materials/Textures/rawTexture2DArray.js\";\n/**\n * This class is used to deform meshes using morphing between different targets\n * @see https://doc.babylonjs.com/how_to/how_to_use_morphtargets\n */\nvar MorphTargetManager = /** @class */ (function () {\n    /**\n     * Creates a new MorphTargetManager\n     * @param scene defines the current scene\n     */\n    function MorphTargetManager(scene) {\n        if (scene === void 0) { scene = null; }\n        this._targets = new Array();\n        this._targetInfluenceChangedObservers = new Array();\n        this._targetDataLayoutChangedObservers = new Array();\n        this._activeTargets = new SmartArray(16);\n        this._supportsNormals = false;\n        this._supportsTangents = false;\n        this._supportsUVs = false;\n        this._vertexCount = 0;\n        this._textureVertexStride = 0;\n        this._textureWidth = 0;\n        this._textureHeight = 1;\n        this._uniqueId = 0;\n        this._tempInfluences = new Array();\n        this._canUseTextureForTargets = false;\n        this._blockCounter = 0;\n        /** @hidden */\n        this._parentContainer = null;\n        /**\n         * Gets or sets a boolean indicating if influencers must be optimized (eg. recompiling the shader if less influencers are used)\n         */\n        this.optimizeInfluencers = true;\n        /**\n         * Gets or sets a boolean indicating if normals must be morphed\n         */\n        this.enableNormalMorphing = true;\n        /**\n         * Gets or sets a boolean indicating if tangents must be morphed\n         */\n        this.enableTangentMorphing = true;\n        /**\n         * Gets or sets a boolean indicating if UV must be morphed\n         */\n        this.enableUVMorphing = true;\n        this._useTextureToStoreTargets = true;\n        if (!scene) {\n            scene = EngineStore.LastCreatedScene;\n        }\n        this._scene = scene;\n        if (this._scene) {\n            this._scene.morphTargetManagers.push(this);\n            this._uniqueId = this._scene.getUniqueId();\n            var engineCaps = this._scene.getEngine().getCaps();\n            this._canUseTextureForTargets =\n                engineCaps.canUseGLVertexID && engineCaps.textureFloat && engineCaps.maxVertexTextureImageUnits > 0 && engineCaps.texture2DArrayMaxLayerCount > 1;\n        }\n    }\n    Object.defineProperty(MorphTargetManager.prototype, \"areUpdatesFrozen\", {\n        get: function () {\n            return this._blockCounter > 0;\n        },\n        /**\n         * Sets a boolean indicating that adding new target or updating an existing target will not update the underlying data buffers\n         */\n        set: function (block) {\n            if (block) {\n                this._blockCounter++;\n            }\n            else {\n                this._blockCounter--;\n                if (this._blockCounter <= 0) {\n                    this._blockCounter = 0;\n                    this._syncActiveTargets(true);\n                }\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"uniqueId\", {\n        /**\n         * Gets the unique ID of this manager\n         */\n        get: function () {\n            return this._uniqueId;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"vertexCount\", {\n        /**\n         * Gets the number of vertices handled by this manager\n         */\n        get: function () {\n            return this._vertexCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"supportsNormals\", {\n        /**\n         * Gets a boolean indicating if this manager supports morphing of normals\n         */\n        get: function () {\n            return this._supportsNormals && this.enableNormalMorphing;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"supportsTangents\", {\n        /**\n         * Gets a boolean indicating if this manager supports morphing of tangents\n         */\n        get: function () {\n            return this._supportsTangents && this.enableTangentMorphing;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"supportsUVs\", {\n        /**\n         * Gets a boolean indicating if this manager supports morphing of texture coordinates\n         */\n        get: function () {\n            return this._supportsUVs && this.enableUVMorphing;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"numTargets\", {\n        /**\n         * Gets the number of targets stored in this manager\n         */\n        get: function () {\n            return this._targets.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"numInfluencers\", {\n        /**\n         * Gets the number of influencers (ie. the number of targets with influences > 0)\n         */\n        get: function () {\n            return this._activeTargets.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"influences\", {\n        /**\n         * Gets the list of influences (one per target)\n         */\n        get: function () {\n            return this._influences;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"useTextureToStoreTargets\", {\n        /**\n         * Gets or sets a boolean indicating that targets should be stored as a texture instead of using vertex attributes (default is true).\n         * Please note that this option is not available if the hardware does not support it\n         */\n        get: function () {\n            return this._useTextureToStoreTargets;\n        },\n        set: function (value) {\n            this._useTextureToStoreTargets = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MorphTargetManager.prototype, \"isUsingTextureForTargets\", {\n        /**\n         * Gets a boolean indicating that the targets are stored into a texture (instead of as attributes)\n         */\n        get: function () {\n            return MorphTargetManager.EnableTextureStorage && this.useTextureToStoreTargets && this._canUseTextureForTargets;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets the active target at specified index. An active target is a target with an influence > 0\n     * @param index defines the index to check\n     * @returns the requested target\n     */\n    MorphTargetManager.prototype.getActiveTarget = function (index) {\n        return this._activeTargets.data[index];\n    };\n    /**\n     * Gets the target at specified index\n     * @param index defines the index to check\n     * @returns the requested target\n     */\n    MorphTargetManager.prototype.getTarget = function (index) {\n        return this._targets[index];\n    };\n    /**\n     * Add a new target to this manager\n     * @param target defines the target to add\n     */\n    MorphTargetManager.prototype.addTarget = function (target) {\n        var _this = this;\n        this._targets.push(target);\n        this._targetInfluenceChangedObservers.push(target.onInfluenceChanged.add(function (needUpdate) {\n            _this._syncActiveTargets(needUpdate);\n        }));\n        this._targetDataLayoutChangedObservers.push(target._onDataLayoutChanged.add(function () {\n            _this._syncActiveTargets(true);\n        }));\n        this._syncActiveTargets(true);\n    };\n    /**\n     * Removes a target from the manager\n     * @param target defines the target to remove\n     */\n    MorphTargetManager.prototype.removeTarget = function (target) {\n        var index = this._targets.indexOf(target);\n        if (index >= 0) {\n            this._targets.splice(index, 1);\n            target.onInfluenceChanged.remove(this._targetInfluenceChangedObservers.splice(index, 1)[0]);\n            target._onDataLayoutChanged.remove(this._targetDataLayoutChangedObservers.splice(index, 1)[0]);\n            this._syncActiveTargets(true);\n        }\n    };\n    /**\n     * @param effect\n     * @hidden\n     */\n    MorphTargetManager.prototype._bind = function (effect) {\n        effect.setFloat3(\"morphTargetTextureInfo\", this._textureVertexStride, this._textureWidth, this._textureHeight);\n        effect.setFloatArray(\"morphTargetTextureIndices\", this._morphTargetTextureIndices);\n        effect.setTexture(\"morphTargets\", this._targetStoreTexture);\n    };\n    /**\n     * Clone the current manager\n     * @returns a new MorphTargetManager\n     */\n    MorphTargetManager.prototype.clone = function () {\n        var copy = new MorphTargetManager(this._scene);\n        for (var _i = 0, _a = this._targets; _i < _a.length; _i++) {\n            var target = _a[_i];\n            copy.addTarget(target.clone());\n        }\n        copy.enableNormalMorphing = this.enableNormalMorphing;\n        copy.enableTangentMorphing = this.enableTangentMorphing;\n        copy.enableUVMorphing = this.enableUVMorphing;\n        return copy;\n    };\n    /**\n     * Serializes the current manager into a Serialization object\n     * @returns the serialized object\n     */\n    MorphTargetManager.prototype.serialize = function () {\n        var serializationObject = {};\n        serializationObject.id = this.uniqueId;\n        serializationObject.targets = [];\n        for (var _i = 0, _a = this._targets; _i < _a.length; _i++) {\n            var target = _a[_i];\n            serializationObject.targets.push(target.serialize());\n        }\n        return serializationObject;\n    };\n    MorphTargetManager.prototype._syncActiveTargets = function (needUpdate) {\n        if (this.areUpdatesFrozen) {\n            return;\n        }\n        var influenceCount = 0;\n        this._activeTargets.reset();\n        this._supportsNormals = true;\n        this._supportsTangents = true;\n        this._supportsUVs = true;\n        this._vertexCount = 0;\n        if (!this._morphTargetTextureIndices || this._morphTargetTextureIndices.length !== this._targets.length) {\n            this._morphTargetTextureIndices = new Float32Array(this._targets.length);\n        }\n        var targetIndex = -1;\n        for (var _i = 0, _a = this._targets; _i < _a.length; _i++) {\n            var target = _a[_i];\n            targetIndex++;\n            if (target.influence === 0 && this.optimizeInfluencers) {\n                continue;\n            }\n            this._activeTargets.push(target);\n            this._morphTargetTextureIndices[influenceCount] = targetIndex;\n            this._tempInfluences[influenceCount++] = target.influence;\n            this._supportsNormals = this._supportsNormals && target.hasNormals;\n            this._supportsTangents = this._supportsTangents && target.hasTangents;\n            this._supportsUVs = this._supportsUVs && target.hasUVs;\n            var positions = target.getPositions();\n            if (positions) {\n                var vertexCount = positions.length / 3;\n                if (this._vertexCount === 0) {\n                    this._vertexCount = vertexCount;\n                }\n                else if (this._vertexCount !== vertexCount) {\n                    Logger.Error(\"Incompatible target. Targets must all have the same vertices count.\");\n                    return;\n                }\n            }\n        }\n        if (!this._influences || this._influences.length !== influenceCount) {\n            this._influences = new Float32Array(influenceCount);\n        }\n        for (var index = 0; index < influenceCount; index++) {\n            this._influences[index] = this._tempInfluences[index];\n        }\n        if (needUpdate) {\n            this.synchronize();\n        }\n    };\n    /**\n     * Synchronize the targets with all the meshes using this morph target manager\n     */\n    MorphTargetManager.prototype.synchronize = function () {\n        if (!this._scene || this.areUpdatesFrozen) {\n            return;\n        }\n        if (this.isUsingTextureForTargets && this._vertexCount) {\n            this._textureVertexStride = 1;\n            if (this._supportsNormals) {\n                this._textureVertexStride++;\n            }\n            if (this._supportsTangents) {\n                this._textureVertexStride++;\n            }\n            if (this._supportsUVs) {\n                this._textureVertexStride++;\n            }\n            this._textureWidth = this._vertexCount * this._textureVertexStride;\n            this._textureHeight = 1;\n            var maxTextureSize = this._scene.getEngine().getCaps().maxTextureSize;\n            if (this._textureWidth > maxTextureSize) {\n                this._textureHeight = Math.ceil(this._textureWidth / maxTextureSize);\n                this._textureWidth = maxTextureSize;\n            }\n            var mustUpdateTexture = true;\n            if (this._targetStoreTexture) {\n                var textureSize = this._targetStoreTexture.getSize();\n                if (textureSize.width === this._textureWidth && textureSize.height === this._textureHeight && this._targetStoreTexture.depth === this._targets.length) {\n                    mustUpdateTexture = false;\n                }\n            }\n            if (mustUpdateTexture) {\n                if (this._targetStoreTexture) {\n                    this._targetStoreTexture.dispose();\n                }\n                var targetCount = this._targets.length;\n                var data = new Float32Array(targetCount * this._textureWidth * this._textureHeight * 4);\n                var offset = 0;\n                for (var index = 0; index < targetCount; index++) {\n                    var target = this._targets[index];\n                    var positions = target.getPositions();\n                    var normals = target.getNormals();\n                    var uvs = target.getUVs();\n                    var tangents = target.getTangents();\n                    if (!positions) {\n                        if (index === 0) {\n                            Logger.Error(\"Invalid morph target. Target must have positions.\");\n                        }\n                        return;\n                    }\n                    offset = index * this._textureWidth * this._textureHeight * 4;\n                    for (var vertex = 0; vertex < this._vertexCount; vertex++) {\n                        data[offset] = positions[vertex * 3];\n                        data[offset + 1] = positions[vertex * 3 + 1];\n                        data[offset + 2] = positions[vertex * 3 + 2];\n                        offset += 4;\n                        if (normals) {\n                            data[offset] = normals[vertex * 3];\n                            data[offset + 1] = normals[vertex * 3 + 1];\n                            data[offset + 2] = normals[vertex * 3 + 2];\n                            offset += 4;\n                        }\n                        if (uvs) {\n                            data[offset] = uvs[vertex * 2];\n                            data[offset + 1] = uvs[vertex * 2 + 1];\n                            offset += 4;\n                        }\n                        if (tangents) {\n                            data[offset] = tangents[vertex * 3];\n                            data[offset + 1] = tangents[vertex * 3 + 1];\n                            data[offset + 2] = tangents[vertex * 3 + 2];\n                            offset += 4;\n                        }\n                    }\n                }\n                this._targetStoreTexture = RawTexture2DArray.CreateRGBATexture(data, this._textureWidth, this._textureHeight, targetCount, this._scene, false, false, 1, 1);\n            }\n        }\n        // Flag meshes as dirty to resync with the active targets\n        for (var _i = 0, _a = this._scene.meshes; _i < _a.length; _i++) {\n            var mesh = _a[_i];\n            if (mesh.morphTargetManager === this) {\n                mesh._syncGeometryWithMorphTargetManager();\n            }\n        }\n    };\n    /**\n     * Release all resources\n     */\n    MorphTargetManager.prototype.dispose = function () {\n        if (this._targetStoreTexture) {\n            this._targetStoreTexture.dispose();\n        }\n        this._targetStoreTexture = null;\n        // Remove from scene\n        if (this._scene) {\n            this._scene.removeMorphTargetManager(this);\n            if (this._parentContainer) {\n                var index = this._parentContainer.morphTargetManagers.indexOf(this);\n                if (index > -1) {\n                    this._parentContainer.morphTargetManagers.splice(index, 1);\n                }\n                this._parentContainer = null;\n            }\n        }\n    };\n    // Statics\n    /**\n     * Creates a new MorphTargetManager from serialized data\n     * @param serializationObject defines the serialized data\n     * @param scene defines the hosting scene\n     * @returns the new MorphTargetManager\n     */\n    MorphTargetManager.Parse = function (serializationObject, scene) {\n        var result = new MorphTargetManager(scene);\n        result._uniqueId = serializationObject.id;\n        for (var _i = 0, _a = serializationObject.targets; _i < _a.length; _i++) {\n            var targetData = _a[_i];\n            result.addTarget(MorphTarget.Parse(targetData, scene));\n        }\n        return result;\n    };\n    /** Enable storing morph target data into textures when set to true (true by default) */\n    MorphTargetManager.EnableTextureStorage = true;\n    return MorphTargetManager;\n}());\nexport { MorphTargetManager };\n//# sourceMappingURL=morphTargetManager.js.map","import { Logger } from \"../../Misc/logger.js\";\nimport { VertexData } from \"../../Meshes/mesh.vertexData.js\";\nimport { Mesh } from \"../../Meshes/mesh.js\";\nimport { Epsilon, Vector3, Matrix } from \"../../Maths/math.js\";\nimport { Observable } from \"../../Misc/observable.js\";\nimport { VertexBuffer } from \"../../Buffers/buffer.js\";\n/**\n * RecastJS navigation plugin\n */\nvar RecastJSPlugin = /** @class */ (function () {\n    /**\n     * Initializes the recastJS plugin\n     * @param recastInjection can be used to inject your own recast reference\n     */\n    function RecastJSPlugin(recastInjection) {\n        if (recastInjection === void 0) { recastInjection = Recast; }\n        /**\n         * Reference to the Recast library\n         */\n        this.bjsRECAST = {};\n        /**\n         * plugin name\n         */\n        this.name = \"RecastJSPlugin\";\n        this._maximumSubStepCount = 10;\n        this._timeStep = 1 / 60;\n        this._worker = null;\n        if (typeof recastInjection === \"function\") {\n            Logger.Error(\"RecastJS is not ready. Please make sure you await Recast() before using the plugin.\");\n        }\n        else {\n            this.bjsRECAST = recastInjection;\n        }\n        if (!this.isSupported()) {\n            Logger.Error(\"RecastJS is not available. Please make sure you included the js file.\");\n            return;\n        }\n        this.setTimeStep();\n        this._tempVec1 = new this.bjsRECAST.Vec3();\n        this._tempVec2 = new this.bjsRECAST.Vec3();\n    }\n    /**\n     * Set worker URL to be used when generating a new navmesh\n     * @param workerURL url string\n     * @returns boolean indicating if worker is created\n     */\n    RecastJSPlugin.prototype.setWorkerURL = function (workerURL) {\n        if (window && window.Worker) {\n            this._worker = new Worker(workerURL);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Set the time step of the navigation tick update.\n     * Default is 1/60.\n     * A value of 0 will disable fixed time update\n     * @param newTimeStep the new timestep to apply to this world.\n     */\n    RecastJSPlugin.prototype.setTimeStep = function (newTimeStep) {\n        if (newTimeStep === void 0) { newTimeStep = 1 / 60; }\n        this._timeStep = newTimeStep;\n    };\n    /**\n     * Get the time step of the navigation tick update.\n     * @returns the current time step\n     */\n    RecastJSPlugin.prototype.getTimeStep = function () {\n        return this._timeStep;\n    };\n    /**\n     * If delta time in navigation tick update is greater than the time step\n     * a number of sub iterations are done. If more iterations are need to reach deltatime\n     * they will be discarded.\n     * A value of 0 will set to no maximum and update will use as many substeps as needed\n     * @param newStepCount the maximum number of iterations\n     */\n    RecastJSPlugin.prototype.setMaximumSubStepCount = function (newStepCount) {\n        if (newStepCount === void 0) { newStepCount = 10; }\n        this._maximumSubStepCount = newStepCount;\n    };\n    /**\n     * Get the maximum number of iterations per navigation tick update\n     * @returns the maximum number of iterations\n     */\n    RecastJSPlugin.prototype.getMaximumSubStepCount = function () {\n        return this._maximumSubStepCount;\n    };\n    /**\n     * Creates a navigation mesh\n     * @param meshes array of all the geometry used to compute the navigation mesh\n     * @param parameters bunch of parameters used to filter geometry\n     * @param completion callback when data is available from the worker. Not used without a worker\n     */\n    RecastJSPlugin.prototype.createNavMesh = function (meshes, parameters, completion) {\n        if (this._worker && !completion) {\n            console.warn(\"A worker is avaible but no completion callback. Defaulting to blocking navmesh creation\");\n        }\n        else if (!this._worker && completion) {\n            console.warn(\"A completion callback is avaible but no worker. Defaulting to blocking navmesh creation\");\n        }\n        this.navMesh = new this.bjsRECAST.NavMesh();\n        var index;\n        var tri;\n        var pt;\n        var indices = [];\n        var positions = [];\n        var offset = 0;\n        for (index = 0; index < meshes.length; index++) {\n            if (meshes[index]) {\n                var mesh = meshes[index];\n                var meshIndices = mesh.getIndices();\n                if (!meshIndices) {\n                    continue;\n                }\n                var meshPositions = mesh.getVerticesData(VertexBuffer.PositionKind, false, false);\n                if (!meshPositions) {\n                    continue;\n                }\n                var worldMatrices = [];\n                var worldMatrix = mesh.computeWorldMatrix(true);\n                if (mesh.hasThinInstances) {\n                    var thinMatrices = mesh.thinInstanceGetWorldMatrices();\n                    for (var instanceIndex = 0; instanceIndex < thinMatrices.length; instanceIndex++) {\n                        var tmpMatrix = new Matrix();\n                        var thinMatrix = thinMatrices[instanceIndex];\n                        thinMatrix.multiplyToRef(worldMatrix, tmpMatrix);\n                        worldMatrices.push(tmpMatrix);\n                    }\n                }\n                else {\n                    worldMatrices.push(worldMatrix);\n                }\n                for (var matrixIndex = 0; matrixIndex < worldMatrices.length; matrixIndex++) {\n                    var wm = worldMatrices[matrixIndex];\n                    for (tri = 0; tri < meshIndices.length; tri++) {\n                        indices.push(meshIndices[tri] + offset);\n                    }\n                    var transformed = Vector3.Zero();\n                    var position = Vector3.Zero();\n                    for (pt = 0; pt < meshPositions.length; pt += 3) {\n                        Vector3.FromArrayToRef(meshPositions, pt, position);\n                        Vector3.TransformCoordinatesToRef(position, wm, transformed);\n                        positions.push(transformed.x, transformed.y, transformed.z);\n                    }\n                    offset += meshPositions.length / 3;\n                }\n            }\n        }\n        if (this._worker && completion) {\n            // spawn worker and send message\n            this._worker.postMessage([positions, offset, indices, indices.length, parameters]);\n            this._worker.onmessage = function (e) {\n                completion(e.data);\n            };\n        }\n        else {\n            // blocking calls\n            var rc = new this.bjsRECAST.rcConfig();\n            rc.cs = parameters.cs;\n            rc.ch = parameters.ch;\n            rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;\n            rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;\n            rc.walkableSlopeAngle = parameters.walkableSlopeAngle;\n            rc.walkableHeight = parameters.walkableHeight;\n            rc.walkableClimb = parameters.walkableClimb;\n            rc.walkableRadius = parameters.walkableRadius;\n            rc.maxEdgeLen = parameters.maxEdgeLen;\n            rc.maxSimplificationError = parameters.maxSimplificationError;\n            rc.minRegionArea = parameters.minRegionArea;\n            rc.mergeRegionArea = parameters.mergeRegionArea;\n            rc.maxVertsPerPoly = parameters.maxVertsPerPoly;\n            rc.detailSampleDist = parameters.detailSampleDist;\n            rc.detailSampleMaxError = parameters.detailSampleMaxError;\n            this.navMesh.build(positions, offset, indices, indices.length, rc);\n        }\n    };\n    /**\n     * Create a navigation mesh debug mesh\n     * @param scene is where the mesh will be added\n     * @returns debug display mesh\n     */\n    RecastJSPlugin.prototype.createDebugNavMesh = function (scene) {\n        var tri;\n        var pt;\n        var debugNavMesh = this.navMesh.getDebugNavMesh();\n        var triangleCount = debugNavMesh.getTriangleCount();\n        var indices = [];\n        var positions = [];\n        for (tri = 0; tri < triangleCount * 3; tri++) {\n            indices.push(tri);\n        }\n        for (tri = 0; tri < triangleCount; tri++) {\n            for (pt = 0; pt < 3; pt++) {\n                var point = debugNavMesh.getTriangle(tri).getPoint(pt);\n                positions.push(point.x, point.y, point.z);\n            }\n        }\n        var mesh = new Mesh(\"NavMeshDebug\", scene);\n        var vertexData = new VertexData();\n        vertexData.indices = indices;\n        vertexData.positions = positions;\n        vertexData.applyToMesh(mesh, false);\n        return mesh;\n    };\n    /**\n     * Get a navigation mesh constrained position, closest to the parameter position\n     * @param position world position\n     * @returns the closest point to position constrained by the navigation mesh\n     */\n    RecastJSPlugin.prototype.getClosestPoint = function (position) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        var ret = this.navMesh.getClosestPoint(this._tempVec1);\n        var pr = new Vector3(ret.x, ret.y, ret.z);\n        return pr;\n    };\n    /**\n     * Get a navigation mesh constrained position, closest to the parameter position\n     * @param position world position\n     * @param result output the closest point to position constrained by the navigation mesh\n     */\n    RecastJSPlugin.prototype.getClosestPointToRef = function (position, result) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        var ret = this.navMesh.getClosestPoint(this._tempVec1);\n        result.set(ret.x, ret.y, ret.z);\n    };\n    /**\n     * Get a navigation mesh constrained position, within a particular radius\n     * @param position world position\n     * @param maxRadius the maximum distance to the constrained world position\n     * @returns the closest point to position constrained by the navigation mesh\n     */\n    RecastJSPlugin.prototype.getRandomPointAround = function (position, maxRadius) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        var ret = this.navMesh.getRandomPointAround(this._tempVec1, maxRadius);\n        var pr = new Vector3(ret.x, ret.y, ret.z);\n        return pr;\n    };\n    /**\n     * Get a navigation mesh constrained position, within a particular radius\n     * @param position world position\n     * @param maxRadius the maximum distance to the constrained world position\n     * @param result output the closest point to position constrained by the navigation mesh\n     */\n    RecastJSPlugin.prototype.getRandomPointAroundToRef = function (position, maxRadius, result) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        var ret = this.navMesh.getRandomPointAround(this._tempVec1, maxRadius);\n        result.set(ret.x, ret.y, ret.z);\n    };\n    /**\n     * Compute the final position from a segment made of destination-position\n     * @param position world position\n     * @param destination world position\n     * @returns the resulting point along the navmesh\n     */\n    RecastJSPlugin.prototype.moveAlong = function (position, destination) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        this._tempVec2.x = destination.x;\n        this._tempVec2.y = destination.y;\n        this._tempVec2.z = destination.z;\n        var ret = this.navMesh.moveAlong(this._tempVec1, this._tempVec2);\n        var pr = new Vector3(ret.x, ret.y, ret.z);\n        return pr;\n    };\n    /**\n     * Compute the final position from a segment made of destination-position\n     * @param position world position\n     * @param destination world position\n     * @param result output the resulting point along the navmesh\n     */\n    RecastJSPlugin.prototype.moveAlongToRef = function (position, destination, result) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        this._tempVec2.x = destination.x;\n        this._tempVec2.y = destination.y;\n        this._tempVec2.z = destination.z;\n        var ret = this.navMesh.moveAlong(this._tempVec1, this._tempVec2);\n        result.set(ret.x, ret.y, ret.z);\n    };\n    /**\n     * Compute a navigation path from start to end. Returns an empty array if no path can be computed\n     * @param start world position\n     * @param end world position\n     * @returns array containing world position composing the path\n     */\n    RecastJSPlugin.prototype.computePath = function (start, end) {\n        var pt;\n        this._tempVec1.x = start.x;\n        this._tempVec1.y = start.y;\n        this._tempVec1.z = start.z;\n        this._tempVec2.x = end.x;\n        this._tempVec2.y = end.y;\n        this._tempVec2.z = end.z;\n        var navPath = this.navMesh.computePath(this._tempVec1, this._tempVec2);\n        var pointCount = navPath.getPointCount();\n        var positions = [];\n        for (pt = 0; pt < pointCount; pt++) {\n            var p = navPath.getPoint(pt);\n            positions.push(new Vector3(p.x, p.y, p.z));\n        }\n        return positions;\n    };\n    /**\n     * Create a new Crowd so you can add agents\n     * @param maxAgents the maximum agent count in the crowd\n     * @param maxAgentRadius the maximum radius an agent can have\n     * @param scene to attach the crowd to\n     * @returns the crowd you can add agents to\n     */\n    RecastJSPlugin.prototype.createCrowd = function (maxAgents, maxAgentRadius, scene) {\n        var crowd = new RecastJSCrowd(this, maxAgents, maxAgentRadius, scene);\n        return crowd;\n    };\n    /**\n     * Set the Bounding box extent for doing spatial queries (getClosestPoint, getRandomPointAround, ...)\n     * The queries will try to find a solution within those bounds\n     * default is (1,1,1)\n     * @param extent x,y,z value that define the extent around the queries point of reference\n     */\n    RecastJSPlugin.prototype.setDefaultQueryExtent = function (extent) {\n        this._tempVec1.x = extent.x;\n        this._tempVec1.y = extent.y;\n        this._tempVec1.z = extent.z;\n        this.navMesh.setDefaultQueryExtent(this._tempVec1);\n    };\n    /**\n     * Get the Bounding box extent specified by setDefaultQueryExtent\n     * @returns the box extent values\n     */\n    RecastJSPlugin.prototype.getDefaultQueryExtent = function () {\n        var p = this.navMesh.getDefaultQueryExtent();\n        return new Vector3(p.x, p.y, p.z);\n    };\n    /**\n     * build the navmesh from a previously saved state using getNavmeshData\n     * @param data the Uint8Array returned by getNavmeshData\n     */\n    RecastJSPlugin.prototype.buildFromNavmeshData = function (data) {\n        var nDataBytes = data.length * data.BYTES_PER_ELEMENT;\n        var dataPtr = this.bjsRECAST._malloc(nDataBytes);\n        var dataHeap = new Uint8Array(this.bjsRECAST.HEAPU8.buffer, dataPtr, nDataBytes);\n        dataHeap.set(data);\n        var buf = new this.bjsRECAST.NavmeshData();\n        buf.dataPointer = dataHeap.byteOffset;\n        buf.size = data.length;\n        this.navMesh = new this.bjsRECAST.NavMesh();\n        this.navMesh.buildFromNavmeshData(buf);\n        // Free memory\n        this.bjsRECAST._free(dataHeap.byteOffset);\n    };\n    /**\n     * returns the navmesh data that can be used later. The navmesh must be built before retrieving the data\n     * @returns data the Uint8Array that can be saved and reused\n     */\n    RecastJSPlugin.prototype.getNavmeshData = function () {\n        var navmeshData = this.navMesh.getNavmeshData();\n        var arrView = new Uint8Array(this.bjsRECAST.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);\n        var ret = new Uint8Array(navmeshData.size);\n        ret.set(arrView);\n        this.navMesh.freeNavmeshData(navmeshData);\n        return ret;\n    };\n    /**\n     * Get the Bounding box extent result specified by setDefaultQueryExtent\n     * @param result output the box extent values\n     */\n    RecastJSPlugin.prototype.getDefaultQueryExtentToRef = function (result) {\n        var p = this.navMesh.getDefaultQueryExtent();\n        result.set(p.x, p.y, p.z);\n    };\n    /**\n     * Disposes\n     */\n    RecastJSPlugin.prototype.dispose = function () { };\n    /**\n     * Creates a cylinder obstacle and add it to the navigation\n     * @param position world position\n     * @param radius cylinder radius\n     * @param height cylinder height\n     * @returns the obstacle freshly created\n     */\n    RecastJSPlugin.prototype.addCylinderObstacle = function (position, radius, height) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        return this.navMesh.addCylinderObstacle(this._tempVec1, radius, height);\n    };\n    /**\n     * Creates an oriented box obstacle and add it to the navigation\n     * @param position world position\n     * @param extent box size\n     * @param angle angle in radians of the box orientation on Y axis\n     * @returns the obstacle freshly created\n     */\n    RecastJSPlugin.prototype.addBoxObstacle = function (position, extent, angle) {\n        this._tempVec1.x = position.x;\n        this._tempVec1.y = position.y;\n        this._tempVec1.z = position.z;\n        this._tempVec2.x = extent.x;\n        this._tempVec2.y = extent.y;\n        this._tempVec2.z = extent.z;\n        return this.navMesh.addBoxObstacle(this._tempVec1, this._tempVec2, angle);\n    };\n    /**\n     * Removes an obstacle created by addCylinderObstacle or addBoxObstacle\n     * @param obstacle obstacle to remove from the navigation\n     */\n    RecastJSPlugin.prototype.removeObstacle = function (obstacle) {\n        this.navMesh.removeObstacle(obstacle);\n    };\n    /**\n     * If this plugin is supported\n     * @returns true if plugin is supported\n     */\n    RecastJSPlugin.prototype.isSupported = function () {\n        return this.bjsRECAST !== undefined;\n    };\n    return RecastJSPlugin;\n}());\nexport { RecastJSPlugin };\n/**\n * Recast detour crowd implementation\n */\nvar RecastJSCrowd = /** @class */ (function () {\n    /**\n     * Constructor\n     * @param plugin recastJS plugin\n     * @param maxAgents the maximum agent count in the crowd\n     * @param maxAgentRadius the maximum radius an agent can have\n     * @param scene to attach the crowd to\n     * @returns the crowd you can add agents to\n     */\n    function RecastJSCrowd(plugin, maxAgents, maxAgentRadius, scene) {\n        var _this = this;\n        /**\n         * Link to the detour crowd\n         */\n        this.recastCrowd = {};\n        /**\n         * One transform per agent\n         */\n        this.transforms = new Array();\n        /**\n         * All agents created\n         */\n        this.agents = new Array();\n        /**\n         * agents reach radius\n         */\n        this.reachRadii = new Array();\n        /**\n         * true when a destination is active for an agent and notifier hasn't been notified of reach\n         */\n        this._agentDestinationArmed = new Array();\n        /**\n         * agent current target\n         */\n        this._agentDestination = new Array();\n        /**\n         * Observer for crowd updates\n         */\n        this._onBeforeAnimationsObserver = null;\n        /**\n         * Fires each time an agent is in reach radius of its destination\n         */\n        this.onReachTargetObservable = new Observable();\n        this.bjsRECASTPlugin = plugin;\n        this.recastCrowd = new this.bjsRECASTPlugin.bjsRECAST.Crowd(maxAgents, maxAgentRadius, this.bjsRECASTPlugin.navMesh.getNavMesh());\n        this._scene = scene;\n        this._onBeforeAnimationsObserver = scene.onBeforeAnimationsObservable.add(function () {\n            _this.update(scene.getEngine().getDeltaTime() * 0.001);\n        });\n    }\n    /**\n     * Add a new agent to the crowd with the specified parameter a corresponding transformNode.\n     * You can attach anything to that node. The node position is updated in the scene update tick.\n     * @param pos world position that will be constrained by the navigation mesh\n     * @param parameters agent parameters\n     * @param transform hooked to the agent that will be update by the scene\n     * @returns agent index\n     */\n    RecastJSCrowd.prototype.addAgent = function (pos, parameters, transform) {\n        var agentParams = new this.bjsRECASTPlugin.bjsRECAST.dtCrowdAgentParams();\n        agentParams.radius = parameters.radius;\n        agentParams.height = parameters.height;\n        agentParams.maxAcceleration = parameters.maxAcceleration;\n        agentParams.maxSpeed = parameters.maxSpeed;\n        agentParams.collisionQueryRange = parameters.collisionQueryRange;\n        agentParams.pathOptimizationRange = parameters.pathOptimizationRange;\n        agentParams.separationWeight = parameters.separationWeight;\n        agentParams.updateFlags = 7;\n        agentParams.obstacleAvoidanceType = 0;\n        agentParams.queryFilterType = 0;\n        agentParams.userData = 0;\n        var agentIndex = this.recastCrowd.addAgent(new this.bjsRECASTPlugin.bjsRECAST.Vec3(pos.x, pos.y, pos.z), agentParams);\n        this.transforms.push(transform);\n        this.agents.push(agentIndex);\n        this.reachRadii.push(parameters.reachRadius ? parameters.reachRadius : parameters.radius);\n        this._agentDestinationArmed.push(false);\n        this._agentDestination.push(new Vector3(0, 0, 0));\n        return agentIndex;\n    };\n    /**\n     * Returns the agent position in world space\n     * @param index agent index returned by addAgent\n     * @returns world space position\n     */\n    RecastJSCrowd.prototype.getAgentPosition = function (index) {\n        var agentPos = this.recastCrowd.getAgentPosition(index);\n        return new Vector3(agentPos.x, agentPos.y, agentPos.z);\n    };\n    /**\n     * Returns the agent position result in world space\n     * @param index agent index returned by addAgent\n     * @param result output world space position\n     */\n    RecastJSCrowd.prototype.getAgentPositionToRef = function (index, result) {\n        var agentPos = this.recastCrowd.getAgentPosition(index);\n        result.set(agentPos.x, agentPos.y, agentPos.z);\n    };\n    /**\n     * Returns the agent velocity in world space\n     * @param index agent index returned by addAgent\n     * @returns world space velocity\n     */\n    RecastJSCrowd.prototype.getAgentVelocity = function (index) {\n        var agentVel = this.recastCrowd.getAgentVelocity(index);\n        return new Vector3(agentVel.x, agentVel.y, agentVel.z);\n    };\n    /**\n     * Returns the agent velocity result in world space\n     * @param index agent index returned by addAgent\n     * @param result output world space velocity\n     */\n    RecastJSCrowd.prototype.getAgentVelocityToRef = function (index, result) {\n        var agentVel = this.recastCrowd.getAgentVelocity(index);\n        result.set(agentVel.x, agentVel.y, agentVel.z);\n    };\n    /**\n     * Returns the agent next target point on the path\n     * @param index agent index returned by addAgent\n     * @returns world space position\n     */\n    RecastJSCrowd.prototype.getAgentNextTargetPath = function (index) {\n        var pathTargetPos = this.recastCrowd.getAgentNextTargetPath(index);\n        return new Vector3(pathTargetPos.x, pathTargetPos.y, pathTargetPos.z);\n    };\n    /**\n     * Returns the agent next target point on the path\n     * @param index agent index returned by addAgent\n     * @param result output world space position\n     */\n    RecastJSCrowd.prototype.getAgentNextTargetPathToRef = function (index, result) {\n        var pathTargetPos = this.recastCrowd.getAgentNextTargetPath(index);\n        result.set(pathTargetPos.x, pathTargetPos.y, pathTargetPos.z);\n    };\n    /**\n     * Gets the agent state\n     * @param index agent index returned by addAgent\n     * @returns agent state\n     */\n    RecastJSCrowd.prototype.getAgentState = function (index) {\n        return this.recastCrowd.getAgentState(index);\n    };\n    /**\n     * returns true if the agent in over an off mesh link connection\n     * @param index agent index returned by addAgent\n     * @returns true if over an off mesh link connection\n     */\n    RecastJSCrowd.prototype.overOffmeshConnection = function (index) {\n        return this.recastCrowd.overOffmeshConnection(index);\n    };\n    /**\n     * Asks a particular agent to go to a destination. That destination is constrained by the navigation mesh\n     * @param index agent index returned by addAgent\n     * @param destination targeted world position\n     */\n    RecastJSCrowd.prototype.agentGoto = function (index, destination) {\n        this.recastCrowd.agentGoto(index, new this.bjsRECASTPlugin.bjsRECAST.Vec3(destination.x, destination.y, destination.z));\n        // arm observer\n        var item = this.agents.indexOf(index);\n        if (item > -1) {\n            this._agentDestinationArmed[item] = true;\n            this._agentDestination[item].set(destination.x, destination.y, destination.z);\n        }\n    };\n    /**\n     * Teleport the agent to a new position\n     * @param index agent index returned by addAgent\n     * @param destination targeted world position\n     */\n    RecastJSCrowd.prototype.agentTeleport = function (index, destination) {\n        this.recastCrowd.agentTeleport(index, new this.bjsRECASTPlugin.bjsRECAST.Vec3(destination.x, destination.y, destination.z));\n    };\n    /**\n     * Update agent parameters\n     * @param index agent index returned by addAgent\n     * @param parameters agent parameters\n     */\n    RecastJSCrowd.prototype.updateAgentParameters = function (index, parameters) {\n        var agentParams = this.recastCrowd.getAgentParameters(index);\n        if (parameters.radius !== undefined) {\n            agentParams.radius = parameters.radius;\n        }\n        if (parameters.height !== undefined) {\n            agentParams.height = parameters.height;\n        }\n        if (parameters.maxAcceleration !== undefined) {\n            agentParams.maxAcceleration = parameters.maxAcceleration;\n        }\n        if (parameters.maxSpeed !== undefined) {\n            agentParams.maxSpeed = parameters.maxSpeed;\n        }\n        if (parameters.collisionQueryRange !== undefined) {\n            agentParams.collisionQueryRange = parameters.collisionQueryRange;\n        }\n        if (parameters.pathOptimizationRange !== undefined) {\n            agentParams.pathOptimizationRange = parameters.pathOptimizationRange;\n        }\n        if (parameters.separationWeight !== undefined) {\n            agentParams.separationWeight = parameters.separationWeight;\n        }\n        this.recastCrowd.setAgentParameters(index, agentParams);\n    };\n    /**\n     * remove a particular agent previously created\n     * @param index agent index returned by addAgent\n     */\n    RecastJSCrowd.prototype.removeAgent = function (index) {\n        this.recastCrowd.removeAgent(index);\n        var item = this.agents.indexOf(index);\n        if (item > -1) {\n            this.agents.splice(item, 1);\n            this.transforms.splice(item, 1);\n            this.reachRadii.splice(item, 1);\n            this._agentDestinationArmed.splice(item, 1);\n            this._agentDestination.splice(item, 1);\n        }\n    };\n    /**\n     * get the list of all agents attached to this crowd\n     * @returns list of agent indices\n     */\n    RecastJSCrowd.prototype.getAgents = function () {\n        return this.agents;\n    };\n    /**\n     * Tick update done by the Scene. Agent position/velocity/acceleration is updated by this function\n     * @param deltaTime in seconds\n     */\n    RecastJSCrowd.prototype.update = function (deltaTime) {\n        // update obstacles\n        this.bjsRECASTPlugin.navMesh.update();\n        // update crowd\n        var timeStep = this.bjsRECASTPlugin.getTimeStep();\n        var maxStepCount = this.bjsRECASTPlugin.getMaximumSubStepCount();\n        if (timeStep <= Epsilon) {\n            this.recastCrowd.update(deltaTime);\n        }\n        else {\n            var iterationCount = Math.floor(deltaTime / timeStep);\n            if (maxStepCount && iterationCount > maxStepCount) {\n                iterationCount = maxStepCount;\n            }\n            if (iterationCount < 1) {\n                iterationCount = 1;\n            }\n            var step = deltaTime / iterationCount;\n            for (var i = 0; i < iterationCount; i++) {\n                this.recastCrowd.update(step);\n            }\n        }\n        // update transforms\n        for (var index = 0; index < this.agents.length; index++) {\n            // update transform position\n            var agentIndex = this.agents[index];\n            var agentPosition = this.getAgentPosition(agentIndex);\n            this.transforms[index].position = agentPosition;\n            // check agent reach destination\n            if (this._agentDestinationArmed[index]) {\n                var dx = agentPosition.x - this._agentDestination[index].x;\n                var dz = agentPosition.z - this._agentDestination[index].z;\n                var radius = this.reachRadii[index];\n                var groundY = this._agentDestination[index].y - this.reachRadii[index];\n                var ceilingY = this._agentDestination[index].y + this.reachRadii[index];\n                var distanceXZSquared = dx * dx + dz * dz;\n                if (agentPosition.y > groundY && agentPosition.y < ceilingY && distanceXZSquared < radius * radius) {\n                    this.onReachTargetObservable.notifyObservers({ agentIndex: agentIndex, destination: this._agentDestination[index] });\n                    this._agentDestinationArmed[index] = false;\n                }\n            }\n        }\n    };\n    /**\n     * Set the Bounding box extent for doing spatial queries (getClosestPoint, getRandomPointAround, ...)\n     * The queries will try to find a solution within those bounds\n     * default is (1,1,1)\n     * @param extent x,y,z value that define the extent around the queries point of reference\n     */\n    RecastJSCrowd.prototype.setDefaultQueryExtent = function (extent) {\n        var ext = new this.bjsRECASTPlugin.bjsRECAST.Vec3(extent.x, extent.y, extent.z);\n        this.recastCrowd.setDefaultQueryExtent(ext);\n    };\n    /**\n     * Get the Bounding box extent specified by setDefaultQueryExtent\n     * @returns the box extent values\n     */\n    RecastJSCrowd.prototype.getDefaultQueryExtent = function () {\n        var p = this.recastCrowd.getDefaultQueryExtent();\n        return new Vector3(p.x, p.y, p.z);\n    };\n    /**\n     * Get the Bounding box extent result specified by setDefaultQueryExtent\n     * @param result output the box extent values\n     */\n    RecastJSCrowd.prototype.getDefaultQueryExtentToRef = function (result) {\n        var p = this.recastCrowd.getDefaultQueryExtent();\n        result.set(p.x, p.y, p.z);\n    };\n    /**\n     * Get the next corner points composing the path (max 4 points)\n     * @param index agent index returned by addAgent\n     * @returns array containing world position composing the path\n     */\n    RecastJSCrowd.prototype.getCorners = function (index) {\n        var pt;\n        var navPath = this.recastCrowd.getCorners(index);\n        var pointCount = navPath.getPointCount();\n        var positions = [];\n        for (pt = 0; pt < pointCount; pt++) {\n            var p = navPath.getPoint(pt);\n            positions.push(new Vector3(p.x, p.y, p.z));\n        }\n        return positions;\n    };\n    /**\n     * Release all resources\n     */\n    RecastJSCrowd.prototype.dispose = function () {\n        this.recastCrowd.destroy();\n        this._scene.onBeforeAnimationsObservable.remove(this._onBeforeAnimationsObserver);\n        this._onBeforeAnimationsObserver = null;\n        this.onReachTargetObservable.clear();\n    };\n    return RecastJSCrowd;\n}());\nexport { RecastJSCrowd };\n//# sourceMappingURL=recastJSPlugin.js.map","import { Tools } from \"../Misc/tools.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { GetTGAHeader } from \"../Misc/tga.js\";\nimport { Engine } from \"../Engines/engine.js\";\nimport { WebRequest } from \"../Misc/webRequest.js\";\n// Sets the default offline provider to Babylon.js\nEngine.OfflineProviderFactory = function (urlToScene, callbackManifestChecked, disableManifestCheck) {\n    if (disableManifestCheck === void 0) { disableManifestCheck = false; }\n    return new Database(urlToScene, callbackManifestChecked, disableManifestCheck);\n};\n/**\n * Class used to enable access to IndexedDB\n * @see https://doc.babylonjs.com/how_to/caching_resources_in_indexeddb\n */\nvar Database = /** @class */ (function () {\n    /**\n     * Creates a new Database\n     * @param urlToScene defines the url to load the scene\n     * @param callbackManifestChecked defines the callback to use when manifest is checked\n     * @param disableManifestCheck defines a boolean indicating that we want to skip the manifest validation (it will be considered validated and up to date)\n     */\n    function Database(urlToScene, callbackManifestChecked, disableManifestCheck) {\n        if (disableManifestCheck === void 0) { disableManifestCheck = false; }\n        // Handling various flavors of prefixed version of IndexedDB\n        this._idbFactory = (typeof window !== \"undefined\" ? window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB : indexedDB);\n        this._currentSceneUrl = Database._ReturnFullUrlLocation(urlToScene);\n        this._db = null;\n        this._enableSceneOffline = false;\n        this._enableTexturesOffline = false;\n        this._manifestVersionFound = 0;\n        this._mustUpdateRessources = false;\n        this._hasReachedQuota = false;\n        if (!Database.IDBStorageEnabled) {\n            callbackManifestChecked(true);\n        }\n        else {\n            if (disableManifestCheck) {\n                this._enableSceneOffline = true;\n                this._enableTexturesOffline = true;\n                this._manifestVersionFound = 1;\n                Tools.SetImmediate(function () {\n                    callbackManifestChecked(true);\n                });\n            }\n            else {\n                this._checkManifestFile(callbackManifestChecked);\n            }\n        }\n    }\n    Object.defineProperty(Database.prototype, \"enableSceneOffline\", {\n        /**\n         * Gets a boolean indicating if scene must be saved in the database\n         */\n        get: function () {\n            return this._enableSceneOffline;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Database.prototype, \"enableTexturesOffline\", {\n        /**\n         * Gets a boolean indicating if textures must be saved in the database\n         */\n        get: function () {\n            return this._enableTexturesOffline;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Database.prototype._checkManifestFile = function (callbackManifestChecked) {\n        var _this = this;\n        var noManifestFile = function () {\n            _this._enableSceneOffline = false;\n            _this._enableTexturesOffline = false;\n            callbackManifestChecked(false);\n        };\n        var createManifestURL = function () {\n            try {\n                // make sure we have a valid URL.\n                if (typeof URL === \"function\" && _this._currentSceneUrl.indexOf(\"http\") === 0) {\n                    // we don't have the base url, so the URL string must have a protocol\n                    var url = new URL(_this._currentSceneUrl);\n                    url.pathname += \".manifest\";\n                    return url.toString();\n                }\n            }\n            catch (e) {\n                // defensive - if this fails for any reason, fall back to the older method\n            }\n            return \"\".concat(_this._currentSceneUrl, \".manifest\");\n        };\n        var timeStampUsed = false;\n        var manifestURL = createManifestURL();\n        var xhr = new WebRequest();\n        if (navigator.onLine) {\n            // Adding a timestamp to by-pass browsers' cache\n            timeStampUsed = true;\n            manifestURL = manifestURL + (manifestURL.match(/\\?/) == null ? \"?\" : \"&\") + Date.now();\n        }\n        xhr.open(\"GET\", manifestURL);\n        xhr.addEventListener(\"load\", function () {\n            if (xhr.status === 200 || Database._ValidateXHRData(xhr, 1)) {\n                try {\n                    var manifestFile = JSON.parse(xhr.response);\n                    _this._enableSceneOffline = manifestFile.enableSceneOffline;\n                    _this._enableTexturesOffline = manifestFile.enableTexturesOffline && Database._IsUASupportingBlobStorage;\n                    if (manifestFile.version && !isNaN(parseInt(manifestFile.version))) {\n                        _this._manifestVersionFound = manifestFile.version;\n                    }\n                    callbackManifestChecked(true);\n                }\n                catch (ex) {\n                    noManifestFile();\n                }\n            }\n            else {\n                noManifestFile();\n            }\n        }, false);\n        xhr.addEventListener(\"error\", function () {\n            if (timeStampUsed) {\n                timeStampUsed = false;\n                // Let's retry without the timeStamp\n                // It could fail when coupled with HTML5 Offline API\n                var retryManifestURL = createManifestURL();\n                xhr.open(\"GET\", retryManifestURL);\n                xhr.send();\n            }\n            else {\n                noManifestFile();\n            }\n        }, false);\n        try {\n            xhr.send();\n        }\n        catch (ex) {\n            Logger.Error(\"Error on XHR send request.\");\n            callbackManifestChecked(false);\n        }\n    };\n    /**\n     * Open the database and make it available\n     * @param successCallback defines the callback to call on success\n     * @param errorCallback defines the callback to call on error\n     */\n    Database.prototype.open = function (successCallback, errorCallback) {\n        var _this = this;\n        var handleError = function () {\n            _this._isSupported = false;\n            if (errorCallback) {\n                errorCallback();\n            }\n        };\n        if (!this._idbFactory || !(this._enableSceneOffline || this._enableTexturesOffline)) {\n            // Your browser doesn't support IndexedDB\n            this._isSupported = false;\n            if (errorCallback) {\n                errorCallback();\n            }\n        }\n        else {\n            // If the DB hasn't been opened or created yet\n            if (!this._db) {\n                this._hasReachedQuota = false;\n                this._isSupported = true;\n                var request_1 = this._idbFactory.open(\"babylonjs\", 1);\n                // Could occur if user is blocking the quota for the DB and/or doesn't grant access to IndexedDB\n                request_1.onerror = function () {\n                    handleError();\n                };\n                // executes when a version change transaction cannot complete due to other active transactions\n                request_1.onblocked = function () {\n                    Logger.Error(\"IDB request blocked. Please reload the page.\");\n                    handleError();\n                };\n                // DB has been opened successfully\n                request_1.onsuccess = function () {\n                    _this._db = request_1.result;\n                    successCallback();\n                };\n                // Initialization of the DB. Creating Scenes & Textures stores\n                request_1.onupgradeneeded = function (event) {\n                    _this._db = event.target.result;\n                    if (_this._db) {\n                        try {\n                            _this._db.createObjectStore(\"scenes\", { keyPath: \"sceneUrl\" });\n                            _this._db.createObjectStore(\"versions\", { keyPath: \"sceneUrl\" });\n                            _this._db.createObjectStore(\"textures\", { keyPath: \"textureUrl\" });\n                        }\n                        catch (ex) {\n                            Logger.Error(\"Error while creating object stores. Exception: \" + ex.message);\n                            handleError();\n                        }\n                    }\n                };\n            }\n            // DB has already been created and opened\n            else {\n                if (successCallback) {\n                    successCallback();\n                }\n            }\n        }\n    };\n    /**\n     * Loads an image from the database\n     * @param url defines the url to load from\n     * @param image defines the target DOM image\n     */\n    Database.prototype.loadImage = function (url, image) {\n        var _this = this;\n        var completeURL = Database._ReturnFullUrlLocation(url);\n        var saveAndLoadImage = function () {\n            if (!_this._hasReachedQuota && _this._db !== null) {\n                // the texture is not yet in the DB, let's try to save it\n                _this._saveImageIntoDBAsync(completeURL, image);\n            }\n            // If the texture is not in the DB and we've reached the DB quota limit\n            // let's load it directly from the web\n            else {\n                image.src = url;\n            }\n        };\n        if (!this._mustUpdateRessources) {\n            this._loadImageFromDBAsync(completeURL, image, saveAndLoadImage);\n        }\n        // First time we're download the images or update requested in the manifest file by a version change\n        else {\n            saveAndLoadImage();\n        }\n    };\n    Database.prototype._loadImageFromDBAsync = function (url, image, notInDBCallback) {\n        if (this._isSupported && this._db !== null) {\n            var texture_1;\n            var transaction = this._db.transaction([\"textures\"]);\n            transaction.onabort = function () {\n                image.src = url;\n            };\n            transaction.oncomplete = function () {\n                var blobTextureURL;\n                if (texture_1) {\n                    var URL_1 = window.URL || window.webkitURL;\n                    blobTextureURL = URL_1.createObjectURL(texture_1.data);\n                    image.onerror = function () {\n                        Logger.Error(\"Error loading image from blob URL: \" + blobTextureURL + \" switching back to web url: \" + url);\n                        image.src = url;\n                    };\n                    image.src = blobTextureURL;\n                }\n                else {\n                    notInDBCallback();\n                }\n            };\n            var getRequest = transaction.objectStore(\"textures\").get(url);\n            getRequest.onsuccess = function (event) {\n                texture_1 = event.target.result;\n            };\n            getRequest.onerror = function () {\n                Logger.Error(\"Error loading texture \" + url + \" from DB.\");\n                image.src = url;\n            };\n        }\n        else {\n            Logger.Error(\"Error: IndexedDB not supported by your browser or BabylonJS Database is not open.\");\n            image.src = url;\n        }\n    };\n    Database.prototype._saveImageIntoDBAsync = function (url, image) {\n        var _this = this;\n        var blob;\n        if (this._isSupported) {\n            // In case of error (type not supported or quota exceeded), we're at least sending back XHR data to allow texture loading later on\n            var generateBlobUrl_1 = function () {\n                var blobTextureURL;\n                if (blob) {\n                    var URL_2 = window.URL || window.webkitURL;\n                    try {\n                        blobTextureURL = URL_2.createObjectURL(blob);\n                    }\n                    catch (ex) {\n                        // Chrome is raising a type error if we're setting the oneTimeOnly parameter\n                        blobTextureURL = URL_2.createObjectURL(blob);\n                    }\n                }\n                if (blobTextureURL) {\n                    image.src = blobTextureURL;\n                }\n            };\n            if (Database._IsUASupportingBlobStorage) {\n                // Create XHR\n                var xhr_1 = new WebRequest();\n                xhr_1.open(\"GET\", url);\n                xhr_1.responseType = \"blob\";\n                xhr_1.addEventListener(\"load\", function () {\n                    if (xhr_1.status === 200 && _this._db) {\n                        // Blob as response\n                        blob = xhr_1.response;\n                        var transaction = _this._db.transaction([\"textures\"], \"readwrite\");\n                        // the transaction could abort because of a QuotaExceededError error\n                        transaction.onabort = function (event) {\n                            try {\n                                //backwards compatibility with ts 1.0, srcElement doesn't have an \"error\" according to ts 1.3\n                                var srcElement = (event.srcElement || event.target);\n                                var error = srcElement.error;\n                                if (error && error.name === \"QuotaExceededError\") {\n                                    _this._hasReachedQuota = true;\n                                }\n                            }\n                            catch (ex) { }\n                            generateBlobUrl_1();\n                        };\n                        transaction.oncomplete = function () {\n                            generateBlobUrl_1();\n                        };\n                        var newTexture = { textureUrl: url, data: blob };\n                        try {\n                            // Put the blob into the dabase\n                            var addRequest = transaction.objectStore(\"textures\").put(newTexture);\n                            addRequest.onsuccess = function () { };\n                            addRequest.onerror = function () {\n                                generateBlobUrl_1();\n                            };\n                        }\n                        catch (ex) {\n                            // \"DataCloneError\" generated by Chrome when you try to inject blob into IndexedDB\n                            if (ex.code === 25) {\n                                Database._IsUASupportingBlobStorage = false;\n                                _this._enableTexturesOffline = false;\n                            }\n                            image.src = url;\n                        }\n                    }\n                    else {\n                        image.src = url;\n                    }\n                }, false);\n                xhr_1.addEventListener(\"error\", function () {\n                    Logger.Error(\"Error in XHR request in BABYLON.Database.\");\n                    image.src = url;\n                }, false);\n                xhr_1.send();\n            }\n            else {\n                image.src = url;\n            }\n        }\n        else {\n            Logger.Error(\"Error: IndexedDB not supported by your browser or Babylon.js database is not open.\");\n            image.src = url;\n        }\n    };\n    Database.prototype._checkVersionFromDB = function (url, versionLoaded) {\n        var _this = this;\n        var updateVersion = function () {\n            // the version is not yet in the DB or we need to update it\n            _this._saveVersionIntoDBAsync(url, versionLoaded);\n        };\n        this._loadVersionFromDBAsync(url, versionLoaded, updateVersion);\n    };\n    Database.prototype._loadVersionFromDBAsync = function (url, callback, updateInDBCallback) {\n        var _this = this;\n        if (this._isSupported && this._db) {\n            var version_1;\n            try {\n                var transaction = this._db.transaction([\"versions\"]);\n                transaction.oncomplete = function () {\n                    if (version_1) {\n                        // If the version in the JSON file is different from the version in DB\n                        if (_this._manifestVersionFound !== version_1.data) {\n                            _this._mustUpdateRessources = true;\n                            updateInDBCallback();\n                        }\n                        else {\n                            callback(version_1.data);\n                        }\n                    }\n                    // version was not found in DB\n                    else {\n                        _this._mustUpdateRessources = true;\n                        updateInDBCallback();\n                    }\n                };\n                transaction.onabort = function () {\n                    callback(-1);\n                };\n                var getRequest = transaction.objectStore(\"versions\").get(url);\n                getRequest.onsuccess = function (event) {\n                    version_1 = event.target.result;\n                };\n                getRequest.onerror = function () {\n                    Logger.Error(\"Error loading version for scene \" + url + \" from DB.\");\n                    callback(-1);\n                };\n            }\n            catch (ex) {\n                Logger.Error(\"Error while accessing 'versions' object store (READ OP). Exception: \" + ex.message);\n                callback(-1);\n            }\n        }\n        else {\n            Logger.Error(\"Error: IndexedDB not supported by your browser or Babylon.js database is not open.\");\n            callback(-1);\n        }\n    };\n    Database.prototype._saveVersionIntoDBAsync = function (url, callback) {\n        var _this = this;\n        if (this._isSupported && !this._hasReachedQuota && this._db) {\n            try {\n                // Open a transaction to the database\n                var transaction = this._db.transaction([\"versions\"], \"readwrite\");\n                // the transaction could abort because of a QuotaExceededError error\n                transaction.onabort = function (event) {\n                    try {\n                        //backwards compatibility with ts 1.0, srcElement doesn't have an \"error\" according to ts 1.3\n                        var error = event.srcElement[\"error\"];\n                        if (error && error.name === \"QuotaExceededError\") {\n                            _this._hasReachedQuota = true;\n                        }\n                    }\n                    catch (ex) { }\n                    callback(-1);\n                };\n                transaction.oncomplete = function () {\n                    callback(_this._manifestVersionFound);\n                };\n                var newVersion = { sceneUrl: url, data: this._manifestVersionFound };\n                // Put the scene into the database\n                var addRequest = transaction.objectStore(\"versions\").put(newVersion);\n                addRequest.onsuccess = function () { };\n                addRequest.onerror = function () {\n                    Logger.Error(\"Error in DB add version request in BABYLON.Database.\");\n                };\n            }\n            catch (ex) {\n                Logger.Error(\"Error while accessing 'versions' object store (WRITE OP). Exception: \" + ex.message);\n                callback(-1);\n            }\n        }\n        else {\n            callback(-1);\n        }\n    };\n    /**\n     * Loads a file from database\n     * @param url defines the URL to load from\n     * @param sceneLoaded defines a callback to call on success\n     * @param progressCallBack defines a callback to call when progress changed\n     * @param errorCallback defines a callback to call on error\n     * @param useArrayBuffer defines a boolean to use array buffer instead of text string\n     */\n    Database.prototype.loadFile = function (url, sceneLoaded, progressCallBack, errorCallback, useArrayBuffer) {\n        var _this = this;\n        var completeUrl = Database._ReturnFullUrlLocation(url);\n        var saveAndLoadFile = function () {\n            // the scene is not yet in the DB, let's try to save it\n            _this._saveFileAsync(completeUrl, sceneLoaded, progressCallBack, useArrayBuffer, errorCallback);\n        };\n        this._checkVersionFromDB(completeUrl, function (version) {\n            if (version !== -1) {\n                if (!_this._mustUpdateRessources) {\n                    _this._loadFileAsync(completeUrl, sceneLoaded, saveAndLoadFile);\n                }\n                else {\n                    _this._saveFileAsync(completeUrl, sceneLoaded, progressCallBack, useArrayBuffer, errorCallback);\n                }\n            }\n            else {\n                if (errorCallback) {\n                    errorCallback();\n                }\n            }\n        });\n    };\n    Database.prototype._loadFileAsync = function (url, callback, notInDBCallback) {\n        if (this._isSupported && this._db) {\n            var targetStore = void 0;\n            if (url.indexOf(\".babylon\") !== -1) {\n                targetStore = \"scenes\";\n            }\n            else {\n                targetStore = \"textures\";\n            }\n            var file_1;\n            var transaction = this._db.transaction([targetStore]);\n            transaction.oncomplete = function () {\n                if (file_1) {\n                    callback(file_1.data);\n                }\n                // file was not found in DB\n                else {\n                    notInDBCallback();\n                }\n            };\n            transaction.onabort = function () {\n                notInDBCallback();\n            };\n            var getRequest = transaction.objectStore(targetStore).get(url);\n            getRequest.onsuccess = function (event) {\n                file_1 = event.target.result;\n            };\n            getRequest.onerror = function () {\n                Logger.Error(\"Error loading file \" + url + \" from DB.\");\n                notInDBCallback();\n            };\n        }\n        else {\n            Logger.Error(\"Error: IndexedDB not supported by your browser or BabylonJS Database is not open.\");\n            callback();\n        }\n    };\n    Database.prototype._saveFileAsync = function (url, callback, progressCallback, useArrayBuffer, errorCallback) {\n        var _this = this;\n        if (this._isSupported) {\n            var targetStore_1;\n            if (url.indexOf(\".babylon\") !== -1) {\n                targetStore_1 = \"scenes\";\n            }\n            else {\n                targetStore_1 = \"textures\";\n            }\n            // Create XHR\n            var xhr_2 = new WebRequest();\n            var fileData_1;\n            xhr_2.open(\"GET\", url + (url.match(/\\?/) == null ? \"?\" : \"&\") + Date.now());\n            if (useArrayBuffer) {\n                xhr_2.responseType = \"arraybuffer\";\n            }\n            if (progressCallback) {\n                xhr_2.onprogress = progressCallback;\n            }\n            xhr_2.addEventListener(\"load\", function () {\n                if (xhr_2.status === 200 || (xhr_2.status < 400 && Database._ValidateXHRData(xhr_2, !useArrayBuffer ? 1 : 6))) {\n                    // Blob as response\n                    fileData_1 = !useArrayBuffer ? xhr_2.responseText : xhr_2.response;\n                    if (!_this._hasReachedQuota && _this._db) {\n                        // Open a transaction to the database\n                        var transaction = _this._db.transaction([targetStore_1], \"readwrite\");\n                        // the transaction could abort because of a QuotaExceededError error\n                        transaction.onabort = function (event) {\n                            try {\n                                //backwards compatibility with ts 1.0, srcElement doesn't have an \"error\" according to ts 1.3\n                                var error = event.srcElement[\"error\"];\n                                if (error && error.name === \"QuotaExceededError\") {\n                                    _this._hasReachedQuota = true;\n                                }\n                            }\n                            catch (ex) { }\n                            callback(fileData_1);\n                        };\n                        transaction.oncomplete = function () {\n                            callback(fileData_1);\n                        };\n                        var newFile = void 0;\n                        if (targetStore_1 === \"scenes\") {\n                            newFile = { sceneUrl: url, data: fileData_1, version: _this._manifestVersionFound };\n                        }\n                        else {\n                            newFile = { textureUrl: url, data: fileData_1 };\n                        }\n                        try {\n                            // Put the scene into the database\n                            var addRequest = transaction.objectStore(targetStore_1).put(newFile);\n                            addRequest.onsuccess = function () { };\n                            addRequest.onerror = function () {\n                                Logger.Error(\"Error in DB add file request in BABYLON.Database.\");\n                            };\n                        }\n                        catch (ex) {\n                            callback(fileData_1);\n                        }\n                    }\n                    else {\n                        callback(fileData_1);\n                    }\n                }\n                else {\n                    if (xhr_2.status >= 400 && errorCallback) {\n                        errorCallback(xhr_2);\n                    }\n                    else {\n                        callback();\n                    }\n                }\n            }, false);\n            xhr_2.addEventListener(\"error\", function () {\n                Logger.Error(\"error on XHR request.\");\n                errorCallback && errorCallback();\n            }, false);\n            xhr_2.send();\n        }\n        else {\n            Logger.Error(\"Error: IndexedDB not supported by your browser or Babylon.js database is not open.\");\n            errorCallback && errorCallback();\n        }\n    };\n    /**\n     * Validates if xhr data is correct\n     * @param xhr defines the request to validate\n     * @param dataType defines the expected data type\n     * @returns true if data is correct\n     */\n    Database._ValidateXHRData = function (xhr, dataType) {\n        // 1 for text (.babylon, manifest and shaders), 2 for TGA, 4 for DDS, 7 for all\n        if (dataType === void 0) { dataType = 7; }\n        try {\n            if (dataType & 1) {\n                if (xhr.responseText && xhr.responseText.length > 0) {\n                    return true;\n                }\n                else if (dataType === 1) {\n                    return false;\n                }\n            }\n            if (dataType & 2) {\n                // Check header width and height since there is no \"TGA\" magic number\n                var tgaHeader = GetTGAHeader(xhr.response);\n                if (tgaHeader.width && tgaHeader.height && tgaHeader.width > 0 && tgaHeader.height > 0) {\n                    return true;\n                }\n                else if (dataType === 2) {\n                    return false;\n                }\n            }\n            if (dataType & 4) {\n                // Check for the \"DDS\" magic number\n                var ddsHeader = new Uint8Array(xhr.response, 0, 3);\n                if (ddsHeader[0] === 68 && ddsHeader[1] === 68 && ddsHeader[2] === 83) {\n                    return true;\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n        catch (e) {\n            // Global protection\n        }\n        return false;\n    };\n    /** Gets a boolean indicating if the user agent supports blob storage (this value will be updated after creating the first Database object) */\n    Database._IsUASupportingBlobStorage = true;\n    /**\n     * Gets a boolean indicating if Database storage is enabled (off by default)\n     */\n    Database.IDBStorageEnabled = false;\n    Database._ParseURL = function (url) {\n        var a = document.createElement(\"a\");\n        a.href = url;\n        var urlWithoutHash = url.substring(0, url.lastIndexOf(\"#\"));\n        var fileName = url.substring(urlWithoutHash.lastIndexOf(\"/\") + 1, url.length);\n        var absLocation = url.substring(0, url.indexOf(fileName, 0));\n        return absLocation;\n    };\n    Database._ReturnFullUrlLocation = function (url) {\n        if (url.indexOf(\"http:/\") === -1 && url.indexOf(\"https:/\") === -1 && typeof window !== \"undefined\") {\n            return Database._ParseURL(window.location.href) + url;\n        }\n        else {\n            return url;\n        }\n    };\n    return Database;\n}());\nexport { Database };\n//# sourceMappingURL=database.js.map"],"names":["FileFaceOrientation","name","worldAxisForNormal","worldAxisForFileX","worldAxisForFileY","this","CubeMapToSphericalPolynomialTools","ConvertCubeMapTextureToSphericalPolynomial","texture","_a","_this","isCube","getScene","getEngine","flushFramebuffer","upPromise","downPromise","size","getSize","width","rightPromise","readPixels","undefined","leftPromise","isRenderTarget","frontPromise","backPromise","gammaSpace","type","textureType","Promise","resolve","all","then","left","right","up","down","front","back","cubeInfo","format","ConvertCubeMapToSphericalPolynomial","_AreaElement","x","y","Math","atan2","sqrt","sphericalHarmonics","totalSolidAngle","du","dv","halfTexel","minUV","faceIndex","fileFace","_FileFaces","dataArray","v","stride","u","worldDirection","scale","add","normalize","deltaSolidAngle","r","g","b","isNaN","pow","max","color","addLight","correctionFactor","PI","scaleInPlace","convertIncidentRadianceToIrradiance","convertIrradianceToLambertianRadiance","HDRTools","_Ldexp","mantissa","exponent","_Rgbe2float","float32array","red","green","blue","index","_ReadStringLine","uint8array","startIndex","line","character","i","length","String","fromCharCode","RGBE_ReadHeader","height","endOfHeader","findFormat","lineIndex","match","exec","parseInt","dataPosition","GetCubeMapTextureData","buffer","Uint8Array","hdrInfo","data","RGBE_ReadPixels","_RGBEReadPixelsRLE","a","c","d","count","num_scanlines","scanline_width","dataIndex","endIndex","scanLineArrayBuffer","ArrayBuffer","scanLineArray","resultBuffer","resultArray","Float32Array","_RGBEReadPixelsNOTRLE","j","PanoramaToCubeMapTools","ConvertPanoramaToCubemap","float32Array","inputWidth","inputHeight","CreateCubemapTexture","FACE_FRONT","FACE_BACK","FACE_LEFT","FACE_RIGHT","FACE_UP","FACE_DOWN","texSize","faceData","textureArray","rotDX1","subtract","rotDX2","dy","fy","xv1","xv2","CalcProjectionSpherical","vDir","theta","z","phi","acos","dx","px","round","py","inputY","AndOrNotEvaluator","Eval","query","evaluateCallback","replace","slice","_HandleParenthesisContent","parenthesisContent","result","or","split","Object","prototype","hasOwnProperty","call","ori","_SimplifyNegation","trim","and","andj","substring","booleanString","ArrayTools","BuildArray","itemBuilder","push","BuildTuple","BASIS_FORMATS","BasisTranscodeConfiguration","BasisToolsOptions","JSModuleURL","WasmModuleURL","GetInternalFormatFromBasisFormat","basisFormat","engine","cTFETC1","cTFBC1","cTFBC4","_WorkerPromise","_Worker","_actionId","TranscodeAsync","config","dataView","res","rej","reject","wasmBinary","workerBlobUrl","URL","createObjectURL","Blob","concat","workerFunc","Worker","initHandler","msg","action","removeEventListener","error","addEventListener","postMessage","url","catch","actionId","messageHandler","id","success","dataViewCopy","byteLength","set","byteOffset","imageData","ignoreSupportedFormats","LoadTextureFromTranscodeResult","transcodeResult","_loop_1","rootImage","fileInfo","images","levels","_invertVScale","invertY","_features","basisNeedsPOT","_uploadDataToTextureDirectly","transcodedPixels","source_1","_bindTextureDirectly","_gl","TEXTURE_2D","_rescaleTexture","scenes","_getInternalFormat","_releaseTexture","generateMipMaps","forEach","level","_uploadCompressedDataToTextureDirectly","BasisTools","_cachedWrapU","_cachedWrapV","_BASIS_FORMAT","transcoderModulePromise","TranscodeLevel","loadedFile","imageIndex","levelIndex","convertToRgb565","dstSize","getImageTranscodedSizeInBytes","dst","transcodeImage","src","srcByteOffset","Uint16Array","blockWidth","blockHeight","blockY","blockX","row","m","dstI","ConvertDxtToRgb565","getImageWidth","getImageHeight","onmessage","event","Module","importScripts","e","onRuntimeInitialized","initializeBasis","imgData","BasisFile","basisFile","hasAlpha","getHasAlpha","imageCount","getNumImages","imageInfo","levelCount","getNumLevels","levelInfo","GetFileInfo","supportedCompressionFormats","etc1","s3tc","pvrtc","etc2","GetSupportedTranscodeFormat","needsConversion","startTranscoding","buffers","image","loadSingleImage","mipCount","loadMipmapLevels","pixels","close","delete","defineProperty","get","value","_instanceNumber","GetEnvironmentBRDFTexture","scene","environmentBRDFTexture","useDelayedTextureLoading","previousState","_blockEntityCollection","texture_1","texturesCache","getLoadedTexturesCache","indexOf","getInternalTexture","splice","isRGBD","wrapU","wrapV","observer_1","onContextRestoredObservable","checkReady","isReady","onDisposeObservable","remove","BRDFTextureTools","ExtractBetweenMarkers","markerOpen","markerClose","block","currPos","openMarkers","waitForChar","currChar","charAt","nextChar","SkipWhitespaces","s","IsIdentifierChar","charCodeAt","RemoveComments","inComments","join","FindBackward","EscapeRegExp","ComputePressureObserverWrapper","callback","thresholds","IsAvailable","_observer","window","ComputePressureObserver","enumerable","configurable","observe","_b","unobserve","GenerateBase64StringFromPixelData","len","BYTES_PER_ELEMENT","npixels","val","canvas","document","createElement","ctx","getContext","createImageData","putImageData","canvas2","ctx2","translate","drawImage","toDataURL","GenerateBase64StringFromTexture","internalTexture","_readPixelsSync","GenerateBase64StringFromTextureAsync","label","sent","CopyTools","inlineScheduler","coroutine","onStep","onError","step_1","next","done","createYieldingScheduler","yieldAfterMS","startTime","currentTime","performance","now","setTimeout","runCoroutine","scheduler","onSuccess","abortSignal","resume","reschedule","stepResult","aborted","Error","runCoroutineSync","runCoroutineAsync","makeSyncFunction","coroutineFactory","params","_i","arguments","apply","makeAsyncFunction","DataReader","loadAsync","readAsync","_dataView","DataView","_dataByteOffset","readUint32","getUint32","readUint8Array","readString","skipBytes","DDSD_MIPMAPCOUNT","DDPF_LUMINANCE","FourCCToInt32","FOURCC_DXT1","FOURCC_DXT3","FOURCC_DXT5","FOURCC_DX10","DDSTools","GetDDSInfo","header","Int32Array","extendedHeader","headerLengthInt","mipmapCount","fourCC","dxgiFormat","isFourCC","isRGB","isLuminance","isCompressed","_GetHalfFloatAsFloatRGBAArrayBuffer","dataOffset","dataLength","arrayBuffer","lod","destArray","srcData","srcPos","StoreLODInAlphaChannel","_GetHalfFloatRGBAArrayBuffer","_GetFloatRGBAArrayBuffer","_GetFloatAsHalfFloatRGBAArrayBuffer","_GetFloatAsUIntRGBAArrayBuffer","_GetHalfFloatAsUIntRGBAArrayBuffer","_GetRGBAArrayBuffer","rOffset","gOffset","bOffset","aOffset","byteArray","_ExtractLongWordOrder","_GetRGBArrayBuffer","_GetLuminanceArrayBuffer","UploadDDSLevels","info","loadMipmaps","faces","lodIndex","currentFace","destTypeMustBeFilterable","sphericalPolynomialFaces","sphericalPolynomial","Array","ext","getCaps","mip","internalCompressedFormat","blockBytes","bpp","computeFormats","supported","_getRGBABufferInternalSizedFormat","startFace","caps","face","floatArray","_badOS","_badDesktopOS","textureHalfFloat","textureFloat","floatAvailable","textureFloatLinearFiltering","halfFloatAvailable","textureHalfFloatLinearFiltering","destType","dataGetter","dataGetterPolynomial","unpackAlignment","_getUnpackAlignement","unpaddedRowSize","floor","rootUrl","lodScale","lodOffset","onLoad","forcedExtension","createPolynomials","createCubeTexture","loadData","_sphericalPolynomial","_source","textureLOD","gl","textures","roughness","minLODIndex","maxLODIndex","mipmapIndex","min","glTextureFromLod","TEXTURE_CUBE_MAP","samplingMode","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","isDDS","_unpackFlipY","lodTexture","_texture","_lodTextureHigh","_lodTextureMid","_lodTextureLow","__decoratorInitialStore","__mergedStore","_copySource","creationFunction","source","instanciate","destination","tags","classStore","getMergedStore","property","propertyDescriptor","sourceProperty","propertyType","SerializationHelper","AllowLoadingUniqueId","clone","target","classKey","getClassName","store","currentTarget","currentKey","initialStore","parent_1","getPrototypeOf","generateSerializableMember","sourceName","propertyKey","getDirectStore","expandToProperty","targetKey","setCallback","key","equals","generateExpandMember","serialize","serializeAsTexture","serializeAsColor3","serializeAsFresnelParameters","serializeAsVector2","serializeAsVector3","serializeAsMeshReference","serializeAsColorCurves","serializeAsColor4","serializeAsImageProcessingConfiguration","serializeAsQuaternion","serializeAsMatrix","serializeAsCameraReference","AppendSerializedAnimations","animations","animationIndex","animation","Serialize","entity","serializationObject","serializedProperties","targetPropertyName","asArray","Parse","dest","_TextureParser","_FresnelParametersParser","getLastMeshById","_ColorCurvesParser","_ImageProcessingConfigurationParser","getCameraById","Clone","Instanciate","nativeOverride","descriptor","predicate","jsFunc","func","_native","nativeFunc_1","filter","CloneValue","destinationObject","DeepCopier","DeepCopy","doNotCopyList","mustCopyList","properties","obj","props","getOwnPropertyNames","prop","GetAllPropertyNames","properties_1","endsWith","sourceValue","typeOfSourceValue","clonedValue","message","Deferred","promise","_resolve","_reject","DepthReducer","_super","camera","_depthRenderer","setDepthRenderer","depthRenderer","forceFullscreenViewport","_camera","_depthRendererId","dispose","enabled","setSourceTexture","getDepthMap","sourceTexture","depthRedux","activate","deactivate","disposeAll","_WarnImport","IsWindowObjectExist","IsNavigatorAvailable","navigator","IsDocumentAvailable","GetDOMTextContent","element","child","firstChild","nodeType","textContent","nextSibling","DomManagement","DefaultEnvironmentTextureImageType","MagicBytes","GetEnvInfo","pos","getUint8","manifestString","charCode","manifest","JSON","parse","normalizeEnvInfo","specular","specularDataPosition","lodGenerationScale","version","imageType","CreateEnvTextureAsync","options","cubeWidth","hostingScene","specularTextures","mipmapsCount","faceWidth","faceDataFloat","i_1","tempTexture","rgbdEncodedData","imageEncodedData","position","infoString","infoBuffer","infoView","strLen","totalSize","finalBuffer","finalBufferView","dataBuffer","textureFloatRender","textureHalfFloatRender","createRawTexture","_readTexturePixels","imageQuality","irradiance","_CreateEnvTextureIrradiance","mipmaps","stringify","setUint8","polynmials","xx","yy","zz","yz","zx","xy","CreateImageDataArrayBufferViews","specularInfo","UploadEnvLevelsAsync","_lodGenerationScale","UploadLevelsAsync","_OnImageReadyAsync","expandTexture","rgbdPostProcess","generateNonLODTextures","lodTextures","cubeRtt","tempTexture_1","createTexture","getEffect","executeWhenCompiled","externalTextureSamplerBinding","onApply","effect","_bindTexture","setFloat2","needsInvertingBitmap","ImageBitmap","postProcessManager","directRender","restoreDefaultFramebuffer","revokeObjectURL","_uploadImageToTexture","_cachedAnisotropicFilteringLevel","updateTextureSamplingMode","supportRenderAndCopyToLodForFloatTextures","_isRGBD","createRenderTargetCubeTexture","generateDepthBuffer","generateStencilBuffer","offset","_lodGenerationOffset","promises","_loop_2","bytes","blob","Image","forceBitmapOverHTMLImageElement","createImageBitmap","premultiplyAlpha","img","image_1","onload","reason","onerror","_uploadArrayBufferViewToTexture","_swapAndDie","UploadEnvSpherical","irradianceInfo","sp","_UpdateRGBDAsync","proxyPromise","createRawCubeTexture","_compression","onRebuildCallback","_internalTexture","proxy","isAsync","_bufferViewArrayArray","EnvironmentTextureTools","BaseError","_setPrototypeOf","setPrototypeOf","o","proto","__proto__","ErrorCodes","MeshInvalidPositionsError","UnsupportedTextureError","GLTFLoaderUnexpectedMagicError","SceneLoaderError","LoadFileError","RequestFileError","ReadFileError","RuntimeError","errorCode","innerError","Base64DataUrlRegEx","RegExp","object","request","file","FileToolsOptions","DefaultRetryStrategy","BaseUrl","CorsBehavior","PreprocessUrl","_CleanUrl","SetCorsBehavior","crossOrigin","LoadImage","input","offlineProvider","mimeType","imageBitmapOptions","usingObjectURL","isView","onErrorHandler","exception","inputText","toString","LoadFile","imgBmp","loadHandler","errorHandler","err","noOfflineSupport","substr","enableTexturesOffline","open","loadImage","textureName","decodeURIComponent","toLowerCase","blobURL","ex","ReadFile","onProgress","useArrayBuffer","reader","FileReader","fileRequest","onCompleteObservable","abort","onloadend","notifyObservers","onprogress","readAsArrayBuffer","readAsText","fileOrUrl","onOpened","fileName","IsBase64DataUrl","fileRequest_1","DecodeBase64UrlToBinary","DecodeBase64UrlToString","RequestFile","responseURL","loadUrl","requestFile","onReadyStateChange","retryHandle","unbindEvents","onLoadEnd","clear","readyState","XMLHttpRequest","DONE","clearTimeout","handleError","retryLoop","retryIndex","responseType","status","IsFileURL","response","responseText","retryStrategy","waitTime","statusText","send","enableSceneOffline","noOfflineSupport_1","loadFile","location","protocol","uri","test","FileTools","_injectLTSFileTools","FilesInputStore","FilesToLoad","ColorGradient","gradient","color1","color2","getColorToRef","random","copyFrom","Color3Gradient","FactorGradient","factor1","factor2","getFactor","GradientHelper","GetCurrentGradient","ratio","gradients","updateFunc","gradientIndex","currentGradient","nextGradient","lastIndex","RandomGUID","GUID","RandomId","AssetTaskState","AbstractAssetTask","_isCompleted","_taskState","INIT","_errorObject","_setErrorObject","run","RUNNING","runTask","_onDoneCallback","_onErrorCallback","reset","ERROR","AssetsProgressEvent","remainingCount","totalCount","task","ContainerAssetTask","meshesNames","sceneFilename","container","loadedContainer","loadedMeshes","meshes","loadedParticleSystems","particleSystems","loadedSkeletons","skeletons","loadedAnimationGroups","animationGroups","MeshAssetTask","TextFileAssetTask","_loadFile","text","BinaryFileAssetTask","ImageAssetTask","TextureAssetTask","noMipmap","CubeTextureAssetTask","extensions","files","prefiltered","HDRCubeTextureAssetTask","generateHarmonics","reserved","EquiRectangularCubeTextureAssetTask","AssetsManager","_isLoading","_tasks","_waitingTasksCount","_totalTasksCount","onTaskSuccessObservable","onTaskErrorObservable","onTasksDoneObservable","onProgressObservable","useDefaultLoadingScreen","autoHideLoadingUI","_scene","addContainerTask","taskName","addMeshTask","addTextFileTask","addBinaryFileTask","addImageTask","addTextureTask","addCubeTextureTask","addHDRCubeTextureTask","addEquiRectangularCubeTextureAssetTask","removeTask","_decreaseWaitingTasksCount","currentTasks","onFinish","currentTasks_1","task_1","taskState","hideLoadingUI","_runTask","onTaskError","_formatTaskErrorMessage","onTaskSuccess","errorMessage","errorObject","load","displayLoadingUI","addOnce","remainingTasks","MeshExploder","centerMesh","_meshesOrigins","_toCenterVectors","_scaledDirection","_newPosition","_centerPosition","_meshes","_centerMesh","_setCenterMesh","centerMeshIndex","getAbsolutePosition","mesh","hasBoundingInfo","getBoundingInfo","boundingBox","centerWorld","subtractToRef","averageCenter","totalCenters","shortestToCenter","Number","MAX_VALUE","boundingInfo","addInPlace","distanceToCenter","lengthSquared","getMeshes","meshArray","unshift","explode","direction","scaleToRef","addToRef","setAbsolutePosition","FilesInput","sceneLoadedCallback","progressCallback","additionalRenderLoopLogicCallback","textureLoadingCallback","startingProcessingFilesCallback","onReloadCallback","errorCallback","onProcessFileCallback","sceneFile","_engine","_currentScene","_sceneLoadedCallback","_progressCallback","_additionalRenderLoopLogicCallback","_textureLoadingCallback","_startingProcessingFilesCallback","_onReloadCallback","_errorCallback","monitorElementForDragNDrop","elementToMonitor","_elementToMonitor","_dragEnterHandler","_drag","_dragOverHandler","_dropHandler","_drop","_filesToLoad","_renderFunction","remaining","getWaitingItemsCount","render","stopPropagation","preventDefault","eventDrop","loadFiles","_traverseFolder","folder","createReader","relativePath","fullPath","readEntries","entries","entries_1","entry","isFile","correctName","isDirectory","_processFiles","name_1","extension","pop","_sceneFileToLoad","dataTransfer","files_1","folders","items","fileToLoad","name_2","item","getAsEntry","webkitGetAsEntry","_processReload","remaining_1","folders_1","reload","stopRenderLoop","executeWhenReady","runRenderLoop","SceneOptimization","priority","getDescription","optimizer","TextureOptimization","maximumSize","step","allDone","canRescale","currentSize","HardwareScalingOptimization","maximumScale","_currentScale","_directionOffset","getHardwareScalingLevel","setHardwareScalingLevel","ShadowsOptimization","shadowsEnabled","isInImprovementMode","PostProcessesOptimization","postProcessesEnabled","LensFlaresOptimization","lensFlaresEnabled","CustomOptimization","onGetDescription","ParticlesOptimization","particlesEnabled","RenderTargetsOptimization","renderTargetsEnabled","MergeMeshesOptimization","_canBeMerged","abstractMesh","isDisposed","isVisible","isEnabled","instances","skeleton","hasLODLevels","_UpdateSelectionTree","updateSelectionTree","globalPool","globalLength","currentPool","current","subIndex","otherMesh","material","checkCollisions","sceneAsAny","createOrUpdateSelectionOctree","UpdateSelectionTree","SceneOptimizerOptions","targetFrameRate","trackerDuration","optimizations","addOptimization","optimization","addCustomOptimization","LowDegradationAllowed","ModerateDegradationAllowed","HighDegradationAllowed","SceneOptimizer","autoGeneratePriorities","improvementMode","_isRunning","_currentPriorityLevel","_targetFrameRate","_trackerDuration","_currentFrameRate","_improvementMode","onSuccessObservable","onNewOptimizationAppliedObservable","onFailureObservable","_options","_sceneDisposeObserver","stop","start","_checkCurrentState","getFps","noOptimizationApplied","OptimizeAsync","onFailure","serializedGeometries","SerializeGeometry","geometry","serializationGeometries","doNotSerialize","vertexData","serializeVerticeData","SerializeMesh","serializationScene","_geometry","getGeometryById","geometries","SceneSerializer","ClearCache","_Serialize","checkSyncReadSupported","light","supportSyncTextureRead","autoClear","clearColor","ambientColor","gravity","collisionsEnabled","useRightHandedSystem","fogMode","fogColor","fogStart","fogEnd","fogDensity","isPhysicsEnabled","physicEngine","getPhysicsEngine","physicsEnabled","physicsGravity","physicsEngine","getPhysicsPluginName","metadata","morphTargetManagers","manager","morphTargetManager","lights","cameras","activeCamera","activeCameraID","animationGroupIndex","animationGroup","reflectionProbes","reflectionProbe","materials","multiMaterials","multiMaterial","environmentTexture","_files","environmentTextureRotationY","rotationY","environmentIntensity","transformNodes","boxes","spheres","cylinders","toruses","grounds","planes","torusKnots","getGeometries","delayLoadState","postProcesses","actionManager","actions","_c","_serializableComponents","SerializeAsync","_CollectPromises","isArray","this_1","this_2","toSerialize","withParents","withChildren","getDescendants","node","parent","serializeMaterial","some","mat","subMaterials","submaterial","defaultMaterial","FinalizeSingleMesh","VideoRecorder","IsSupported","getRenderingCanvas","_canvas","isRecording","_DefaultOptions","stream","captureStream","fps","audioTracks","track","addTrack","_mediaRecorder","MediaRecorder","ondataavailable","_handleDataAvailable","bind","_handleError","onstop","_handleStop","stopRecording","startRecording","maxDuration","_fileName","_recordedChunks","recordChunckSize","superBuffer","CreateScreenshot","successCallback","forceDownload","_GetScreenshotSize","renderContext","getRenderWidth","getRenderHeight","newWidth","newHeight","offsetX","offsetY","onEndFrameObservable","renderingCanvas","CreateScreenshotAsync","CreateScreenshotWithResizeAsync","CreateScreenshotUsingRenderTarget","samples","antialiasing","renderSprites","enableStencilBuffer","targetTextureSize","previousCamera","previousCameras","activeCameras","renderList","renderToTexture","incrementRenderId","resetCachedMaterial","getProjectionMatrix","fxaaPostProcess","addPostProcess","onCompiled","CreateScreenshotUsingRenderTargetAsync","precision","abs","getAspectRatio","ScreenshotTools","InspectableType","Levenshtein","DataStorage","_GetStorage","localStorage","setItem","removeItem","inMemoryStorage_1","getItem","ReadString","defaultValue","_Storage","WriteString","ReadBoolean","WriteBoolean","ReadNumber","parseFloat","WriteNumber","SceneRecorder","_trackedScene","_savedJSON","getDelta","currentForceSerializeBuffers","newJSON","deltaJSON","_compareCollections","_compareArray","original","originalUniqueIds","originalObject","originalUniqueId","uniqueId","currentObjects","currentObject","newObject","_compareObjects","__state","deleteId","currentUniqueId","originalObjet","aDifferenceWasFound","originalValue","currentValue","diffFound","GetShadowGeneratorById","generators_1","map","l","getShadowGenerator","generator","ApplyDelta","anyScene","_ApplyDeltaForEntity","getLightById","getMeshById","getSkeletonById","getMaterialById","getTransformNodeById","getParticleSystemById","getMorphTargetById","getPostProcessByName","fromArray","_ApplyPropertiesToEntity","sources","finder","addNew","sources_1","targetEntity","Alphabet","characters","charToInsertionCost","charToDeletionCost","charsToSubstitutionCost","_characterToIdx","Map","_insertionCosts","_deletionCosts","_substitutionCosts","outerIdx","innerIdx","jsonObject","k","Deserialize","json","alphabet","getCharacterIdx","char","getInsertionCost","idx","getDeletionCost","getSubstitutionCost","idx1","idx2","Sequence","_MAX_SEQUENCE_LENGTH","_alphabet","_characters","sequence","distance","other","_Distance","aChars","bChars","aLength","bLength","costMatrix","_CostMatrix","aIdx","bIdx","_InsertionCost","_DeletionCost","_SubstitutionCost","Trajectory","segmentLength","_points","_segmentLength","trajectory","pt","getLength","point","numPoints","getT","t","newPoint","scaleAndAddToRef","resampleAtTargetResolution","targetResolution","resampled","tokenize","tokens","tokenization","segmentDir","_TransformSegmentDirToRef","_TokenizeSegment","priorVec","fromVec","toVec","_ForwardDir","_InverseFromVec","_UpDir","_LookMatrix","_FromToVec","segment","_BestMatch","_Score","_BestScore","Vector3Alphabet","chars","Generate","alphabetSize","iterations","startingStepSize","endingStepSize","fixedValues","stepSize","distSq","force","scratch","iteration","copyFromFloats","EPSILON","TrajectoryDescriptor","_sequences","CreateFromTrajectory","vector3Alphabet","levenshteinAlphabet","CreateFromTokenizationPyramid","_GetTokenizationPyramid","pyramid","_FINEST_DESCRIPTOR_RESOLUTION","totalDistance","TrajectoryClass","descriptors","_descriptors","_centroidIdx","_averageDistance","_refreshDescription","desc","centroidIdx","averageDistance","described","getMatchCost","getMatchMinimumDistance","sum","distances","_MIN_AVERAGE_DISTANCE","TrajectoryClassifier","_maximumAllowableMatchCost","_nameToDescribedTrajectory","maximumAllowableMatchCost","_vector3Alphabet","_levenshteinAlphabet","nameToDescribedTrajectory","classifier","vecs","charIdxs","trajectorySet","addTrajectoryToClassification","classification","has","deleteClassification","classifyTrajectory","allowableMatches","trajectoryClass","bestIdx","bestMatch","Reflector","hostname","port","Log","_webSocket","WebSocket","startsWith","_SERVER_PREFIX","serverMessage","_handleServerMessage","_handleClientMessage","onclose","code","serialized","DynamicFloat32Array","itemCapacity","_view","_itemLength","at","NaN","subarray","end","_growArray","newCapacity","view","InitialArraySize","TimestampColHeader","NumPointsColHeader","CarriageReturnRegex","ExportedDataSeparator","PerformanceViewerCollector","_enabledStrategyCallbacks","_collectDataAtFrame","timestamp","_startingTimestamp","datasets","ids","numberOfIndices","startingIndices","itemLength","startingIndex","previousStartingIndex","NumberOfPointsOffset","SliceDataOffset","strategy","_strategies","getData","datasetObservable","hasObservers","_datasetMeta","_eventRestoreSet","Set","_customEventObservable","metadataObservable","observer","addCollectionStrategies","registerEvent","forceUpdate","category","strategyCallback","counter","afterRenderObserver","onAfterRenderObservable","stringObserver","eventVal","sendEvent","_restoreStringEvents","observers","strategyCallbacks","strategyCallbacks_1","hidden","_getHexColorFromId","hash","hex","getCurrentSlice","updateMetadata","meta","preserveStringEventsRestore","_hasLoadedData","loadFromFileData","keepDatasetMeta","lines","numPointsIndex","parsedDatasets","firstLine","dataLines","idCategoryMap","dataLines_1","exportDataToCsv","csvContent","diff","Date","toISOString","shouldPreserve","_isStarted","removeCallback","defaultDisposeImpl","PerfCollectionStrategy","FpsStrategy","CpuStrategy","computePressureObserver","onComputePressureChanged","update","cpuUtilization","TotalMeshesStrategy","ActiveMeshesStrategy","getActiveMeshes","ActiveIndicesStrategy","getActiveIndices","ActiveFacesStrategy","ActiveBonesStrategy","getActiveBones","ActiveParticlesStrategy","getActiveParticles","DrawCallsStrategy","drawCalls","onBeforeAnimationsObserver","onBeforeAnimationsObservable","_drawCalls","fetchNewFrame","onAfterRenderObserver","TotalLightsStrategy","TotalVerticesStrategy","getTotalVertices","TotalMaterialsStrategy","TotalTexturesStrategy","AbsoluteFpsStrategy","sceneInstrumentation","captureFrameTime","frameTimeCounter","lastSecAverage","MeshesSelectionStrategy","timeTaken","onBeforeActiveMeshesObserver","onBeforeActiveMeshesEvaluationObservable","onAfterActiveMeshesObserver","onAfterActiveMeshesEvaluationObservable","RenderTargetsStrategy","onBeforeRenderTargetsObserver","onBeforeRenderTargetsRenderObservable","onAfterRenderTargetsObserver","onAfterRenderTargetsRenderObservable","ParticlesStrategy","onBeforeParticlesObserver","onBeforeParticlesRenderingObservable","onAfterParticlesObserver","onAfterParticlesRenderingObservable","SpritesStrategy","onBeforeSpritesObserver","onBeforeSpritesRenderingObservable","onAfterSpritesObserver","onAfterSpritesRenderingObservable","AnimationsStrategy","onAfterAnimationsObserver","onAfterAnimationsObservable","PhysicsStrategy","onBeforePhysicsObserver","onBeforePhysicsObservable","onAfterPhysicsObserver","onAfterPhysicsObservable","RenderStrategy","onBeforeDrawPhaseObserver","onBeforeDrawPhaseObservable","onAfterDrawPhaseObserver","onAfterDrawPhaseObservable","FrameTotalStrategy","InterFrameStrategy","GpuFrameTimeStrategy","engineInstrumentation","captureGPUFrameTime","gpuFrameTimeCounter","_perfCollector","_coroutineScheduler","schedulerAndDispose","observable","coroutines","onSteps","onErrors","shift","CreateObservableScheduler","_coroutineSchedulerDispose","InstantiationTools","Instantiate","className","RegisteredExternalClasses","internalClass","arr","fn","KhronosTextureContainer","facesExpected","isInvalid","IsValid","dataSize","Uint32Array","headerDataView","littleEndian","glType","glTypeSize","glFormat","glInternalFormat","glBaseInternalFormat","pixelWidth","pixelHeight","pixelDepth","numberOfArrayElements","numberOfFaces","numberOfMipmapLevels","bytesOfKeyValueData","loadType","COMPRESSED_2D","uploadLevels","_upload2DCompressedLevels","TEX_2D","COMPRESSED_3D","TEX_3D","HEADER_LEN","imageSize","identifier","KhronosTextureContainer2","numWorkers","DefaultNumWorkers","_Initialize","GetDefaultNumWorkers","hardwareConcurrency","_WorkerPoolPromise","_DecoderModulePromise","workerContent","worker","onMessage","urls","URLConfig","KTX2DECODER","jsDecoderModule","MSCTranscoder","UseFromWorkerThread","WASMMemoryManager","LoadBinariesFromCurrentThread","wasmUASTCToASTC","LiteTranscoder_UASTC_ASTC","wasmUASTCToBC7","LiteTranscoder_UASTC_BC7","wasmUASTCToRGBA_UNORM","LiteTranscoder_UASTC_RGBA_UNORM","wasmUASTCToRGBA_SRGB","LiteTranscoder_UASTC_RGBA_SRGB","jsMSCTranscoder","wasmMSCTranscoder","wasmZSTDDecoder","ZSTDDecoder","KTX2Decoder","uploadAsync","compressedTexturesCaps","astc","bptc","workerPool","onComplete","_createTexture","decodedData","dataCopy","decoder","decode","transcodedFormat","isInGammaSpace","transcoderName","_gammaSpace","errors","mipmap","_extension","ktx2Decoder","Logger","_CheckLimit","limit","_LogLimitOutputs","_GenerateLimitMessage","messageType","MessageLimitReached","Warn","_AddLogEntry","_LogCache","OnNewCacheEntry","_FormatMessage","padStr","date","getHours","getMinutes","getSeconds","_LogDisabled","_LogEnabled","_WarnDisabled","_WarnEnabled","_ErrorDisabled","_ErrorEnabled","formattedMessage","errorsCount","ClearLogCache","MessageLogLevel","WarningLogLevel","ErrorLogLevel","NoneLogLevel","AllLogLevel","MinMaxReducer","onAfterReductionPerformed","_forceFullscreenViewport","_activated","_postProcessManager","_onContextRestoredObserver","_rebuild","_sourceTexture","_reductionSteps","reductionInitial","w","h","setTexture","reduction","setInt2","minmax","inputTexture","refreshRate","_onAfterUnbindObserver","onAfterUnbindObservable","_debugPushGroup","unBindFramebuffer","_debugPopGroup","EventState","mask","skipNextObservers","initialize","Observer","scope","_willBeUnregistered","unregisterOnNextCall","MultiObserver","_observers","_observables","Watch","observables","observables_1","Observable","onObserverAdded","_eventState","_onObserverAdded","FromPromise","onErrorObservable","ret","insertFirst","unregisterOnFirstCall","_deferUnregister","_remove","makeObserverTopPriority","makeObserverBottomPriority","eventData","userInfo","state","lastReturnValue","obs","notifyObserversWithPromise","p","lastReturnedValue","notifyObserver","hasSpecificMask","PerfCounter","_startMonitoringTime","_min","_max","_average","_lastSecAverage","_current","_totalValueCount","_totalAccumulated","_lastSecAccumulated","_lastSecTime","_lastSecValueCount","addCount","newCount","fetchResult","Enabled","_fetchResult","beginMonitoring","endMonitoring","newFrame","PerformanceMonitor","frameSampleSize","_enabled","_rollingFrameTime","RollingAverage","sampleFrame","timeMs","_lastFrameTimeMs","dt","average","variance","history","isSaturated","enable","disable","_samples","delta","bottomValue","_pos","_sampleCount","_m2","i0","_wrapPosition","PivotTools","_RemoveAndStorePivotPoint","_PivotCached","getPivotPointToRef","_OldPivotPoint","_PivotPostMultiplyPivotMatrix","_postMultiplyPivotMatrix","equalsToFloats","setPivotMatrix","getPivotPoint","_PivotTranslation","_PivotTmpVector","subtractInPlace","scaling","multiplyInPlace","_RestorePivotPoint","setPivotPoint","PrecisionDate","RetryStrategy","ExponentialBackoff","maxRetries","baseInterval","RGBDTextureTools","ExpandRGBDTexture","expandRGBDTexture","rgbdPostProcess_1","expandedTexture_1","createRenderTargetTexture","onLoadObservable","EncodeTextureToRGBD","outputTextureType","SmartArray","capacity","_id","_GlobalId","sort","compareFn","array","contains","SmartArrayNoDuplicate","_duplicateId","__smartArrayFlags","pushNoDuplicate","concatWithNoDuplicate","StringDictionary","_count","_data","getOrAddWithFactory","factory","getOrAdd","curVal","getAndRemove","cur","first","EndsWith","str","suffix","StartsWith","Decode","TextDecoder","EncodeArrayBufferToBase64","chr1","chr2","chr3","enc1","enc2","enc3","enc4","keyStr","output","DecodeBase64ToString","base64Data","atob","DecodeBase64ToBinary","decodedString","bufferLength","bufferView","PadNumber","num","StringTools","Tags","EnableFor","_tags","hasTags","HasTags","addTags","tagsString","AddTagsTo","removeTags","RemoveTagsFrom","matchesTagsQuery","tagsQuery","MatchesQuery","DisableFor","GetTags","asString","tagsArray","tag","_AddTagTo","_RemoveTagFrom","floatView","int32View","CreateResizedCopy","useBilinearMode","rtt","uOffset","vOffset","uScale","vScale","uAng","vAng","wAng","coordinatesIndex","anisotropicFilteringLevel","passPostProcess","renderTarget","disposeFramebufferObjects","ApplyPostProcess","postProcessName","postProcess","encodedTexture","ToHalfFloat","bits","FromHalfFloat","f","Infinity","TextureTools","GetTGAHeader","id_length","colormap_type","image_type","colormap_index","colormap_length","colormap_size","origin","pixel_size","flags","UploadContent","pixel_data","use_rle","use_pal","use_grey","palettes","x_start","y_start","x_step","y_step","y_end","x_end","pixel_total","localOffset","TGATools","_getImageData8bits","colormap","_getImageData16bits","_getImageData24bits","_getImageData32bits","_getImageDataGrey8bits","_getImageDataGrey16bits","TimerState","setAndStartTimer","timer","observableParameters","contextObservable","payload","deltaTime","completeRate","timeout","onTick","breakCondition","onAborted","onEnded","AdvancedTimer","onEachCountObservable","onTimerAbortedObservable","onTimerEndedObservable","onStateChangedObservable","_breakOnNextTick","_tick","_timer","_startTime","_timeToEnd","shouldBreak","_breakCondition","_stop","_setState","_contextObservable","_observableParameters","clearObservables","timeToEnd","_state","STARTED","newState","ENDED","TimingTools","SetImmediate","setImmediate","Tools","classes","FetchToRef","Mix","alpha","IsExponentOfTwo","FloatRound","fround","_TmpFloatArray","GetFilename","path","lastIndexOf","GetFolderPath","returnUnchangedIfNoSlash","ToDegrees","angle","ToRadians","MakeArray","allowsNullUndefined","GetPointerPrefix","eventPrefix","PointerEvent","CleanUrl","processor","LoadFileAsync","LoadScript","scriptUrl","scriptId","head","getElementsByTagName","script","setAttribute","appendChild","LoadScriptAsync","ReadFileAsDataURL","readAsDataURL","FileAsURL","content","fileBlob","webkitURL","Format","decimals","toFixed","IsEmpty","RegisterTopRootEvents","windowElement","events","event_1","handler","UnregisterTopRootEvents","event_2","DumpFramebuffer","DumpData","toArrayBuffer","quality","_ScreenshotCanvas","context","data2","n","ToBlob","fileReader","EncodeScreenshotCanvasData","DumpDataAsync","toBlob","binStr","stringDate","getFullYear","getMonth","getDate","Download","url_1","newWindow","body","msSaveBlob","style","display","href","download","parentElement","removeChild","click","BackCompatCameraNoPreventDefault","args","IsBase64","DecodeBase64","PerformanceUserMarkLogLevel","StartPerformanceCounter","_StartUserMark","EndPerformanceCounter","_EndUserMark","PerformanceConsoleLogLevel","_StartPerformanceConsole","_EndPerformanceConsole","_StartPerformanceCounterDisabled","_EndPerformanceCounterDisabled","counterName","condition","_Performance","mark","measure","console","time","GetClassName","isType","constructor","First","array_1","el","getFullClassName","moduleName","classObj","DelayAsync","delay","IsSafari","userAgent","UseCustomRequestHeaders","CustomRequestHeaders","GetAbsoluteUrl","PerformanceNoneLogLevel","module","AsyncLoop","_done","_fn","_successCallback","executeNext","breakLoop","Run","loop","SyncAsyncForLoop","syncedIterations","breakFunction","ceil","_RegisteredTypes","RegisterClass","GetClass","fqdn","UniqueIdGenerator","_UniqueIdCounter","JoystickAxis","VirtualJoystick","leftJoystick","customizations","_GetDefaultOptions","_leftJoystick","_GlobalJoystickIndex","_axisTargetedByLeftAndRight","X","_axisTargetedByUpAndDown","Y","reverseLeftRight","reverseUpDown","_touches","deltaPosition","_joystickSensibility","_inversedSensibility","_onResize","_VJCanvasWidth","innerWidth","_VJCanvasHeight","innerHeight","Canvas","_HalfWidth","backgroundColor","top","zIndex","msTouchAction","touchAction","context_1","_VJCanvasContext","strokeStyle","lineWidth","pressed","limitToContainer","_joystickColor","containerSize","puckSize","setPosition","puckImage","setPuckImage","containerImage","setContainerImage","alwaysVisible","_AlwaysVisibleSticks","_joystickPointerId","_joystickPointerPos","_joystickPreviousPointerPos","_joystickPointerStartPos","_deltaJoystickVector","_onPointerDownHandlerRef","evt","_onPointerDown","_onPointerMoveHandlerRef","_onPointerMove","_onPointerUpHandlerRef","_onPointerUp","requestAnimationFrame","_drawVirtualJoystick","setJoystickSensibility","newJoystickSensibility","clientX","pointerId","_joystickPosition","clientY","_action","prevX","prevY","vector","deltaJoystickX","Z","deltaJoystickY","_clearPreviousDraw","touch","clearRect","setJoystickColor","newColor","_joystickContainerSize","newSize","_clearContainerSize","_clearContainerSizeOffset","_joystickPuckSize","_clearPuckSize","_clearPuckSizeOffset","clearPosition","_alwaysVisible","setActionOnTouch","setAxisForLeftRight","axis","setAxisForUpDown","jp","urlPath","_containerImage","_puckImage","_drawContainer","beginPath","arc","stroke","closePath","_drawPuck","fillStyle","releaseCanvas","WebRequest","_xhr","_requestURL","_injectCustomRequestHeaders","_shouldSkipRequestModifications","setRequestHeader","SkipRequestModificationForBabylonCDN","includes","listener","method","CustomRequestModifiers","getResponseHeader","WorkerPool","workers","_pendingActions","_workerInfos","workerPromise","idle","terminate","_executeOnIdleWorker","workerInfo","_execute","nextAction","AutoReleaseWorkerPool","maxWorkers","createWorkerAsync","DefaultOptions","_maxWorkers","_createWorkerAsync","timeoutId","idleTimeElapsedBeforeRelease","MorphTarget","influence","_positions","_normals","_tangents","_uvs","_uniqueId","onInfluenceChanged","_onDataLayoutChanged","_animationPropertiesOverride","getUniqueId","_influence","previous","animationPropertiesOverride","setPositions","hadPositions","hasPositions","getPositions","setNormals","hadNormals","hasNormals","getNormals","setTangents","hadTangents","hasTangents","getTangents","setUVs","hadUVs","hasUVs","getUVs","newOne","positions","normals","tangents","uvs","parsedAnimation","autoAnimate","beginAnimation","autoAnimateFrom","autoAnimateTo","autoAnimateLoop","autoAnimateSpeed","FromMesh","getVerticesData","isVerticesDataPresent","MorphTargetManager","_targets","_targetInfluenceChangedObservers","_targetDataLayoutChangedObservers","_activeTargets","_supportsNormals","_supportsTangents","_supportsUVs","_vertexCount","_textureVertexStride","_textureWidth","_textureHeight","_tempInfluences","_canUseTextureForTargets","_blockCounter","_parentContainer","optimizeInfluencers","enableNormalMorphing","enableTangentMorphing","enableUVMorphing","_useTextureToStoreTargets","engineCaps","canUseGLVertexID","maxVertexTextureImageUnits","texture2DArrayMaxLayerCount","_syncActiveTargets","_influences","EnableTextureStorage","useTextureToStoreTargets","getActiveTarget","getTarget","addTarget","needUpdate","removeTarget","_bind","setFloat3","setFloatArray","_morphTargetTextureIndices","_targetStoreTexture","copy","targets","areUpdatesFrozen","influenceCount","targetIndex","vertexCount","synchronize","isUsingTextureForTargets","maxTextureSize","mustUpdateTexture","textureSize","depth","targetCount","vertex","_syncGeometryWithMorphTargetManager","removeMorphTargetManager","targetData","RecastJSPlugin","recastInjection","Recast","bjsRECAST","_maximumSubStepCount","_timeStep","_worker","isSupported","setTimeStep","_tempVec1","Vec3","_tempVec2","setWorkerURL","workerURL","newTimeStep","getTimeStep","setMaximumSubStepCount","newStepCount","getMaximumSubStepCount","createNavMesh","parameters","completion","tri","navMesh","NavMesh","indices","meshIndices","getIndices","meshPositions","worldMatrices","worldMatrix","computeWorldMatrix","hasThinInstances","thinMatrices","thinInstanceGetWorldMatrices","instanceIndex","tmpMatrix","multiplyToRef","matrixIndex","wm","transformed","rc","rcConfig","cs","ch","borderSize","tileSize","walkableSlopeAngle","walkableHeight","walkableClimb","walkableRadius","maxEdgeLen","maxSimplificationError","minRegionArea","mergeRegionArea","maxVertsPerPoly","detailSampleDist","detailSampleMaxError","build","createDebugNavMesh","debugNavMesh","getDebugNavMesh","triangleCount","getTriangleCount","getTriangle","getPoint","applyToMesh","getClosestPoint","getClosestPointToRef","getRandomPointAround","maxRadius","getRandomPointAroundToRef","moveAlong","moveAlongToRef","computePath","navPath","pointCount","getPointCount","createCrowd","maxAgents","maxAgentRadius","RecastJSCrowd","setDefaultQueryExtent","extent","getDefaultQueryExtent","buildFromNavmeshData","nDataBytes","dataPtr","_malloc","dataHeap","HEAPU8","buf","NavmeshData","dataPointer","_free","getNavmeshData","navmeshData","arrView","freeNavmeshData","getDefaultQueryExtentToRef","addCylinderObstacle","radius","addBoxObstacle","removeObstacle","obstacle","plugin","recastCrowd","transforms","agents","reachRadii","_agentDestinationArmed","_agentDestination","_onBeforeAnimationsObserver","onReachTargetObservable","bjsRECASTPlugin","Crowd","getNavMesh","getDeltaTime","addAgent","transform","agentParams","dtCrowdAgentParams","maxAcceleration","maxSpeed","collisionQueryRange","pathOptimizationRange","separationWeight","updateFlags","obstacleAvoidanceType","queryFilterType","userData","agentIndex","reachRadius","getAgentPosition","agentPos","getAgentPositionToRef","getAgentVelocity","agentVel","getAgentVelocityToRef","getAgentNextTargetPath","pathTargetPos","getAgentNextTargetPathToRef","getAgentState","overOffmeshConnection","agentGoto","agentTeleport","updateAgentParameters","getAgentParameters","setAgentParameters","removeAgent","getAgents","timeStep","maxStepCount","iterationCount","agentPosition","dz","groundY","ceilingY","distanceXZSquared","getCorners","destroy","urlToScene","callbackManifestChecked","disableManifestCheck","Database","_idbFactory","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","_currentSceneUrl","_ReturnFullUrlLocation","_db","_enableSceneOffline","_enableTexturesOffline","_manifestVersionFound","_mustUpdateRessources","_hasReachedQuota","IDBStorageEnabled","_checkManifestFile","noManifestFile","createManifestURL","pathname","timeStampUsed","manifestURL","xhr","onLine","_ValidateXHRData","manifestFile","_IsUASupportingBlobStorage","retryManifestURL","_isSupported","request_1","onblocked","onsuccess","onupgradeneeded","createObjectStore","keyPath","completeURL","saveAndLoadImage","_saveImageIntoDBAsync","_loadImageFromDBAsync","notInDBCallback","transaction","onabort","oncomplete","blobTextureURL","URL_1","getRequest","objectStore","generateBlobUrl_1","URL_2","xhr_1","srcElement","newTexture","textureUrl","addRequest","put","_checkVersionFromDB","versionLoaded","_loadVersionFromDBAsync","_saveVersionIntoDBAsync","updateInDBCallback","version_1","newVersion","sceneUrl","sceneLoaded","progressCallBack","completeUrl","saveAndLoadFile","_saveFileAsync","_loadFileAsync","file_1","targetStore","targetStore_1","fileData_1","xhr_2","newFile","dataType","tgaHeader","ddsHeader","_ParseURL","urlWithoutHash"],"sourceRoot":""}