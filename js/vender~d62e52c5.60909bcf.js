"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3577],{92728:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(17497),r=n(55077),o=n(54485),s=n(20176),a=n(8754);const u={};function c(e){i.Z.typeOf.number.greaterThan("options.count",e.count,0),i.Z.typeOf.object("options.properties",e.properties),this._count=e.count,this._properties=(0,r.Z)(e.properties,!0)}c.prototype.hasProperty=function(e){return a.Z.hasProperty(e,this._properties,u)},c.prototype.getPropertyIds=function(e){return a.Z.getPropertyIds(this._properties,u,e)},c.prototype.getProperty=function(e,t){if(i.Z.typeOf.number("index",e),i.Z.typeOf.string("propertyId",t),e<0||e>=this._count)throw new s.Z(`index must be in the range [0, ${this._count})`);const n=this._properties[t];if((0,o.Z)(n))return(0,r.Z)(n[e],!0)},c.prototype.setProperty=function(e,t,n){if(i.Z.typeOf.number("index",e),i.Z.typeOf.string("propertyId",t),e<0||e>=this._count)throw new s.Z(`index must be in the range [0, ${this._count})`);const a=this._properties[t];return!!(0,o.Z)(a)&&(a[e]=(0,r.Z)(n,!0),!0)}},51402:(e,t,n)=>{n.d(t,{Z:()=>w});var i=n(23114),r=n(59015),o=n(93517),s=n(6785),a=n(88779),u=n(54485),c=n(20176),l=n(51178),d=n(14633),h=n(72720),p=n(16272),f=n(72293),_=n(36164),m=n(53102),T=n(49824);const Z={};let y=0;const g=new s.Z(.165,.165,.165,.8),I=new r.Z(7,5),A=Object.freeze({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function b(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function E(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function S(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function N(e){let t=Z[e._font];if(!(0,u.Z)(t)){const n=document.createElement("div");n.style.position="absolute",n.style.opacity=0,n.style.font=e._font,document.body.appendChild(n);let i=parseFloat(S(n,"line-height"));isNaN(i)&&(i=void 0),t={family:S(n,"font-family"),size:S(n,"font-size").replace("px",""),style:S(n,"font-style"),weight:S(n,"font-weight"),lineHeight:i},document.body.removeChild(n),y<256&&(Z[e._font]=t,y++)}e._fontFamily=t.family,e._fontSize=t.size,e._fontStyle=t.style,e._fontWeight=t.weight,e._lineHeight=t.lineHeight}function O(e,t){if(e=(0,a.Z)(e,a.Z.EMPTY_OBJECT),(0,u.Z)(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new c.Z("disableDepthTestDistance must be greater than 0.0.");let n=e.translucencyByDistance,i=e.pixelOffsetScaleByDistance,h=e.scaleByDistance,m=e.distanceDisplayCondition;if((0,u.Z)(n)){if(n.far<=n.near)throw new c.Z("translucencyByDistance.far must be greater than translucencyByDistance.near.");n=d.Z.clone(n)}if((0,u.Z)(i)){if(i.far<=i.near)throw new c.Z("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.");i=d.Z.clone(i)}if((0,u.Z)(h)){if(h.far<=h.near)throw new c.Z("scaleByDistance.far must be greater than scaleByDistance.near.");h=d.Z.clone(h)}if((0,u.Z)(m)){if(m.far<=m.near)throw new c.Z("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");m=l.Z.clone(m)}this._renderedText=void 0,this._text=void 0,this._show=(0,a.Z)(e.show,!0),this._font=(0,a.Z)(e.font,"30px sans-serif"),this._fillColor=s.Z.clone((0,a.Z)(e.fillColor,s.Z.WHITE)),this._outlineColor=s.Z.clone((0,a.Z)(e.outlineColor,s.Z.BLACK)),this._outlineWidth=(0,a.Z)(e.outlineWidth,1),this._showBackground=(0,a.Z)(e.showBackground,!1),this._backgroundColor=s.Z.clone((0,a.Z)(e.backgroundColor,g)),this._backgroundPadding=r.Z.clone((0,a.Z)(e.backgroundPadding,I)),this._style=(0,a.Z)(e.style,_.Z.FILL),this._verticalOrigin=(0,a.Z)(e.verticalOrigin,T.Z.BASELINE),this._horizontalOrigin=(0,a.Z)(e.horizontalOrigin,f.Z.LEFT),this._pixelOffset=r.Z.clone((0,a.Z)(e.pixelOffset,r.Z.ZERO)),this._eyeOffset=o.Z.clone((0,a.Z)(e.eyeOffset,o.Z.ZERO)),this._position=o.Z.clone((0,a.Z)(e.position,o.Z.ZERO)),this._scale=(0,a.Z)(e.scale,1),this._id=e.id,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=i,this._scaleByDistance=h,this._heightReference=(0,a.Z)(e.heightReference,p.Z.NONE),this._distanceDisplayCondition=m,this._disableDepthTestDistance=e.disableDepthTestDistance,this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=(0,a.Z)(e.text,""),this._relativeSize=1,N(this),this._updateClamping()}function C(e,t){const n=/[a-zA-Z0-9]/,i=/[()[\]{}<>]/,r=[];let o="",s=A.LTR,a="";const u=e.length;for(let c=0;c<u;++c){const u=e.charAt(c);a=t.test(u)?A.RTL:n.test(u)?A.LTR:i.test(u)?A.BRACKETS:A.WEAK,0===c&&(s=a),s===a&&a!==A.BRACKETS?o+=u:(""!==o&&r.push({Type:s,Word:o}),s=a,o=u)}return r.push({Type:a,Word:o}),r}function v(e){return e.split("").reverse().join("")}function D(e,t,n){return e.slice(0,t)+n+e.slice(t)}function M(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}Object.defineProperties(O.prototype,{show:{get:function(){return this._show},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");if(this._show!==e){this._show=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n].billboard;(0,u.Z)(i)&&(i.show=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.show=e)}}},position:{get:function(){return this._position},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._position;if(!o.Z.equals(t,e)){o.Z.clone(e,t);const n=this._glyphs;for(let t=0,i=n.length;t<i;t++){const i=n[t].billboard;(0,u.Z)(i)&&(i.position=e)}const i=this._backgroundBillboard;(0,u.Z)(i)&&(i.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");if(e!==this._heightReference){this._heightReference=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n].billboard;(0,u.Z)(i)&&(i.heightReference=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.heightReference=e),E(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");if(this._text!==e){this._text=e;const t=e.replace(/\u00ad/g,"");this._renderedText=O.enableRightToLeftDetection?function(e){const t=e.split("\n");let n="";for(let e=0;e<t.length;e++){const i=t[e],r=x.test(i.charAt(0)),o=C(i,x);let s=0,a="";for(let e=0;e<o.length;++e){const t=o[e],n=t.Type===A.BRACKETS?M(t.Word):v(t.Word);r?t.Type===A.RTL?(a=n+a,s=0):t.Type===A.LTR?(a=D(a,s,t.Word),s+=t.Word.length):t.Type!==A.WEAK&&t.Type!==A.BRACKETS||(t.Type===A.WEAK&&o[e-1].Type===A.BRACKETS?a=n+a:o[e-1].Type===A.RTL?(a=n+a,s=0):o.length>e+1?o[e+1].Type===A.RTL?(a=n+a,s=0):(a=D(a,s,t.Word),s+=t.Word.length):a=D(a,0,n)):t.Type===A.RTL?a=D(a,s,n):t.Type===A.LTR?(a+=t.Word,s=a.length):t.Type!==A.WEAK&&t.Type!==A.BRACKETS||(e>0&&o[e-1].Type===A.RTL?o.length>e+1?o[e+1].Type===A.RTL?a=D(a,s,n):(a+=t.Word,s=a.length):a+=t.Word:(a+=t.Word,s=a.length))}n+=a,e<t.length-1&&(n+="\n")}return n}(t):t,b(this)}}},font:{get:function(){return this._font},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");this._font!==e&&(this._font=e,b(this),N(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._fillColor;s.Z.equals(t,e)||(s.Z.clone(e,t),b(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._outlineColor;s.Z.equals(t,e)||(s.Z.clone(e,t),b(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");this._outlineWidth!==e&&(this._outlineWidth=e,b(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");this._showBackground!==e&&(this._showBackground=e,b(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._backgroundColor;if(!s.Z.equals(t,e)){s.Z.clone(e,t);const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._backgroundPadding;r.Z.equals(t,e)||(r.Z.clone(e,t),E(this))}},style:{get:function(){return this._style},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");this._style!==e&&(this._style=e,b(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._pixelOffset;if(!r.Z.equals(t,e)){r.Z.clone(e,t);const n=this._glyphs;for(let t=0,i=n.length;t<i;t++){const i=n[t];(0,u.Z)(i.billboard)&&(i.billboard.pixelOffset=e)}const i=this._backgroundBillboard;(0,u.Z)(i)&&(i.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if((0,u.Z)(e)&&e.far<=e.near)throw new c.Z("far distance must be greater than near distance.");const t=this._translucencyByDistance;if(!d.Z.equals(t,e)){this._translucencyByDistance=d.Z.clone(e,t);const n=this._glyphs;for(let t=0,i=n.length;t<i;t++){const i=n[t];(0,u.Z)(i.billboard)&&(i.billboard.translucencyByDistance=e)}const i=this._backgroundBillboard;(0,u.Z)(i)&&(i.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if((0,u.Z)(e)&&e.far<=e.near)throw new c.Z("far distance must be greater than near distance.");const t=this._pixelOffsetScaleByDistance;if(!d.Z.equals(t,e)){this._pixelOffsetScaleByDistance=d.Z.clone(e,t);const n=this._glyphs;for(let t=0,i=n.length;t<i;t++){const i=n[t];(0,u.Z)(i.billboard)&&(i.billboard.pixelOffsetScaleByDistance=e)}const i=this._backgroundBillboard;(0,u.Z)(i)&&(i.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if((0,u.Z)(e)&&e.far<=e.near)throw new c.Z("far distance must be greater than near distance.");const t=this._scaleByDistance;if(!d.Z.equals(t,e)){this._scaleByDistance=d.Z.clone(e,t);const n=this._glyphs;for(let t=0,i=n.length;t<i;t++){const i=n[t];(0,u.Z)(i.billboard)&&(i.billboard.scaleByDistance=e)}const i=this._backgroundBillboard;(0,u.Z)(i)&&(i.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");const t=this._eyeOffset;if(!o.Z.equals(t,e)){o.Z.clone(e,t);const n=this._glyphs;for(let t=0,i=n.length;t<i;t++){const i=n[t];(0,u.Z)(i.billboard)&&(i.billboard.eyeOffset=e)}const i=this._backgroundBillboard;(0,u.Z)(i)&&(i.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");this._horizontalOrigin!==e&&(this._horizontalOrigin=e,E(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");if(this._verticalOrigin!==e){this._verticalOrigin=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard.verticalOrigin=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.verticalOrigin=e),E(this)}}},scale:{get:function(){return this._scale},set:function(e){if(!(0,u.Z)(e))throw new c.Z("value is required.");if(this._scale!==e){this._scale=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard.scale=e*this._relativeSize)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.scale=e*this._relativeSize),E(this)}}},totalScale:{get:function(){return this._scale*this._relativeSize}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if((0,u.Z)(e)&&e.far<=e.near)throw new c.Z("far must be greater than near");if(!l.Z.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=l.Z.clone(e,this._distanceDisplayCondition);const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard.distanceDisplayCondition=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if((0,u.Z)(e)&&e<0)throw new c.Z("disableDepthTestDistance must be greater than 0.0.");this._disableDepthTestDistance=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard.disableDepthTestDistance=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard.id=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.id=e)}}},pickId:{get:function(){if(0!==this._glyphs.length&&(0,u.Z)(this._glyphs[0].billboard))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=o.Z.clone(e,this._actualClampedPosition);const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard._clampedPosition=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;const t=this._glyphs;for(let n=0,i=t.length;n<i;n++){const i=t[n];(0,u.Z)(i.billboard)&&(i.billboard.clusterShow=e)}const n=this._backgroundBillboard;(0,u.Z)(n)&&(n.clusterShow=e)}}}}),O.prototype._updateClamping=function(){h.Z._updateClamping(this._labelCollection,this)},O.prototype.computeScreenSpacePosition=function(e,t){if(!(0,u.Z)(e))throw new c.Z("scene is required.");(0,u.Z)(t)||(t=new r.Z);const n=this._labelCollection.modelMatrix,i=(0,u.Z)(this._actualClampedPosition)?this._actualClampedPosition:this._position;return h.Z._computeScreenSpacePosition(n,i,this._eyeOffset,this._pixelOffset,e,t)},O.getScreenSpaceBoundingBox=function(e,t,n){let r=0,o=0,s=0,a=0;const c=e.totalScale,l=e._backgroundBillboard;if((0,u.Z)(l))r=t.x+l._translate.x,o=t.y-l._translate.y,s=l.width*c,a=l.height*c,e.verticalOrigin===T.Z.BOTTOM||e.verticalOrigin===T.Z.BASELINE?o-=a:e.verticalOrigin===T.Z.CENTER&&(o-=.5*a);else{r=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;let n=0,i=0;const l=e._glyphs,d=l.length;for(let s=0;s<d;++s){const a=l[s],d=a.billboard;if(!(0,u.Z)(d))continue;const h=t.x+d._translate.x;let p=t.y-d._translate.y;const f=a.dimensions.width*c,_=a.dimensions.height*c;e.verticalOrigin===T.Z.BOTTOM||e.verticalOrigin===T.Z.BASELINE?p-=_:e.verticalOrigin===T.Z.CENTER&&(p-=.5*_),e._verticalOrigin===T.Z.TOP?p+=m.Z.PADDING*c:e._verticalOrigin!==T.Z.BOTTOM&&e._verticalOrigin!==T.Z.BASELINE||(p-=m.Z.PADDING*c),r=Math.min(r,h),o=Math.min(o,p),n=Math.max(n,h+f),i=Math.max(i,p+_)}s=n-r,a=i-o}return(0,u.Z)(n)||(n=new i.Z),n.x=r,n.y=o,n.width=s,n.height=a,n},O.prototype.equals=function(e){return this===e||(0,u.Z)(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&o.Z.equals(this._position,e._position)&&s.Z.equals(this._fillColor,e._fillColor)&&s.Z.equals(this._outlineColor,e._outlineColor)&&s.Z.equals(this._backgroundColor,e._backgroundColor)&&r.Z.equals(this._backgroundPadding,e._backgroundPadding)&&r.Z.equals(this._pixelOffset,e._pixelOffset)&&o.Z.equals(this._eyeOffset,e._eyeOffset)&&d.Z.equals(this._translucencyByDistance,e._translucencyByDistance)&&d.Z.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&d.Z.equals(this._scaleByDistance,e._scaleByDistance)&&l.Z.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id},O.prototype.isDestroyed=function(){return!1},O.enableRightToLeftDetection=!1;const x=new RegExp("[\u05d0-\u05ea\u0600-\u06ff\u0750-\u077f\u08a0-\u08ff]");const w=O},77819:(e,t,n)=>{n.d(t,{Z:()=>G});var i=n(23114),r=n(59015),o=n(6785),s=n(88779),a=n(54485),u=n(90332),c=n(20176),l=n(71118),d=n(13940),h=n(80047),p=n(64764),f=n(12471),_=n(16272),m=n(72293),T=n(51402),Z=n(36164),y=n(53102),g=n(79670),I=n(49824),A=n(47291);function b(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function E(e,t,n){this.labelCollection=e,this.index=t,this.dimensions=n}const S="ID_WHITE_PIXEL",N=new r.Z(4,4),O=new i.Z(1,1,1,1);const C={};function v(e,t,n,i,r,s,a){return C.font=t,C.fillColor=n,C.strokeColor=i,C.strokeWidth=r,C.padding=y.Z.PADDING,a===I.Z.CENTER?C.textBaseline="middle":a===I.Z.TOP?C.textBaseline="top":C.textBaseline="bottom",C.fill=s===Z.Z.FILL||s===Z.Z.FILL_AND_OUTLINE,C.stroke=s===Z.Z.OUTLINE||s===Z.Z.FILL_AND_OUTLINE,C.backgroundColor=o.Z.BLACK,(0,d.Z)(e,C)}function D(e,t){t.textureInfo=void 0,t.dimensions=void 0;const n=t.billboard;(0,a.Z)(n)&&(n.show=!1,n.image=void 0,(0,a.Z)(n._removeCallbackFunc)&&(n._removeCallbackFunc(),n._removeCallbackFunc=void 0),e._spareBillboards.push(n),t.billboard=void 0)}function M(e,t,n,i){i.index=e.addImageSync(t,n)}const x=new A.Z;function w(e,t){const n=t._renderedText,i=x.splitGraphemes(n),s=i.length,u=t._glyphs,c=u.length;let l,d,p;if(t._relativeSize=t._fontSize/y.Z.FONT_SIZE,s<c)for(d=s;d<c;++d)D(e,u[d]);u.length=s;const f=t._showBackground&&n.split("\n").join("").length>0;let _=t._backgroundBillboard;const T=e._backgroundBillboardCollection;f?((0,a.Z)(_)||(_=T.add({collection:e,image:S,imageSubRegion:O}),t._backgroundBillboard=_),_.color=t._backgroundColor,_.show=t._show,_.position=t._position,_.eyeOffset=t._eyeOffset,_.pixelOffset=t._pixelOffset,_.horizontalOrigin=m.Z.LEFT,_.verticalOrigin=t._verticalOrigin,_.heightReference=t._heightReference,_.scale=t.totalScale,_.pickPrimitive=t,_.id=t._id,_.translucencyByDistance=t._translucencyByDistance,_.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,_.scaleByDistance=t._scaleByDistance,_.distanceDisplayCondition=t._distanceDisplayCondition,_.disableDepthTestDistance=t._disableDepthTestDistance):(0,a.Z)(_)&&(T.remove(_),t._backgroundBillboard=_=void 0);const g=e._glyphTextureCache;for(p=0;p<s;++p){const n=i[p],s=t._verticalOrigin,c=JSON.stringify([n,t._fontFamily,t._fontStyle,t._fontWeight,+s]);let d=g[c];if(!(0,a.Z)(d)){const i=v(n,`${t._fontStyle} ${t._fontWeight} ${y.Z.FONT_SIZE}px ${t._fontFamily}`,o.Z.WHITE,o.Z.WHITE,0,Z.Z.FILL,s);if(d=new E(e,-1,i.dimensions),g[c]=d,i.width>0&&i.height>0){const t=(0,h.Z)(i,{cutoff:y.Z.CUTOFF,radius:y.Z.RADIUS}),r=i.getContext("2d"),o=i.width,s=i.height,a=r.getImageData(0,0,o,s);for(let e=0;e<o;e++)for(let n=0;n<s;n++){const i=n*o+e,r=255*t[i],s=4*i;a.data[s+0]=r,a.data[s+1]=r,a.data[s+2]=r,a.data[s+3]=r}r.putImageData(a,0,0)," "!==n&&M(e._textureAtlas,c,i,d)}}if(l=u[p],(0,a.Z)(l)?-1===d.index?D(e,l):(0,a.Z)(l.textureInfo)&&(l.textureInfo=void 0):(l=new b,u[p]=l),l.textureInfo=d,l.dimensions=d.dimensions,-1!==d.index){let n=l.billboard;const i=e._spareBillboards;(0,a.Z)(n)||(i.length>0?n=i.pop():(n=e._billboardCollection.add({collection:e}),n._labelDimensions=new r.Z,n._labelTranslate=new r.Z),l.billboard=n),n.show=t._show,n.position=t._position,n.eyeOffset=t._eyeOffset,n.pixelOffset=t._pixelOffset,n.horizontalOrigin=m.Z.LEFT,n.verticalOrigin=t._verticalOrigin,n.heightReference=t._heightReference,n.scale=t.totalScale,n.pickPrimitive=t,n.id=t._id,n.image=c,n.translucencyByDistance=t._translucencyByDistance,n.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,n.scaleByDistance=t._scaleByDistance,n.distanceDisplayCondition=t._distanceDisplayCondition,n.disableDepthTestDistance=t._disableDepthTestDistance,n._batchIndex=t._batchIndex,n.outlineColor=t.outlineColor,t.style===Z.Z.FILL_AND_OUTLINE?(n.color=t._fillColor,n.outlineWidth=t.outlineWidth):t.style===Z.Z.FILL?(n.color=t._fillColor,n.outlineWidth=0):t.style===Z.Z.OUTLINE&&(n.color=o.Z.TRANSPARENT,n.outlineWidth=t.outlineWidth)}}t._repositionAllGlyphs=!0}function R(e,t,n){return t===m.Z.CENTER?-e/2:t===m.Z.RIGHT?-(e+n.x):n.x}const F=new r.Z,L=new r.Z;function P(e){const t=e._glyphs,n=e._renderedText;let i,o,s=0,u=0;const c=[];let l,d=Number.NEGATIVE_INFINITY,h=0,p=1;const f=t.length,T=e._backgroundBillboard,Z=r.Z.clone((0,a.Z)(T)?e._backgroundPadding:r.Z.ZERO,L);for(Z.x/=e._relativeSize,Z.y/=e._relativeSize,l=0;l<f;++l)"\n"===n.charAt(l)?(c.push(s),++p,s=0):(i=t[l],o=i.dimensions,h=Math.max(h,o.height-o.descent),d=Math.max(d,o.descent),s+=o.width-o.minx,l<f-1&&(s+=t[l+1].dimensions.minx),u=Math.max(u,s));c.push(s);const g=h+d,A=e.totalScale,b=e._horizontalOrigin,E=e._verticalOrigin;let S=0,N=c[S],O=R(N,b,Z);const C=((0,a.Z)(e._lineHeight)?e._lineHeight:1.2*e._fontSize)/e._relativeSize,v=C*(p-1);let D=u,M=g+v;(0,a.Z)(T)&&(D+=2*Z.x,M+=2*Z.y,T._labelHorizontalOrigin=b),F.x=O*A,F.y=0;let x=!0,w=0;for(l=0;l<f;++l)if("\n"===n.charAt(l))++S,w+=C,N=c[S],O=R(N,b,Z),F.x=O*A,x=!0;else if(i=t[l],o=i.dimensions,E===I.Z.TOP?(F.y=o.height-h-Z.y,F.y+=y.Z.PADDING):E===I.Z.CENTER?F.y=(v+o.height-h)/2:E===I.Z.BASELINE?(F.y=v,F.y-=y.Z.PADDING):(F.y=v+d+Z.y,F.y-=y.Z.PADDING),F.y=(F.y-o.descent-w)*A,x&&(F.x-=y.Z.PADDING*A,x=!1),(0,a.Z)(i.billboard)&&(i.billboard._setTranslate(F),i.billboard._labelDimensions.x=D,i.billboard._labelDimensions.y=M,i.billboard._labelHorizontalOrigin=b),l<f-1){const e=t[l+1];F.x+=(o.width-o.minx+e.dimensions.minx)*A}if((0,a.Z)(T)&&n.split("\n").join("").length>0&&(O=b===m.Z.CENTER?-u/2-Z.x:b===m.Z.RIGHT?-(u+2*Z.x):0,F.x=O*A,E===I.Z.TOP?F.y=g-h-d:E===I.Z.CENTER?F.y=(g-h)/2-d:E===I.Z.BASELINE?F.y=-Z.y-d:F.y=0,F.y=F.y*A,T.width=D,T.height=M,T._setTranslate(F),T._labelTranslate=r.Z.clone(F,T._labelTranslate)),e.heightReference===_.Z.CLAMP_TO_GROUND)for(l=0;l<f;++l){i=t[l];const e=i.billboard;(0,a.Z)(e)&&(e._labelTranslate=r.Z.clone(F,e._labelTranslate))}}function U(e,t){const n=t._glyphs;for(let t=0,i=n.length;t<i;++t)D(e,n[t]);(0,a.Z)(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,(0,a.Z)(t._removeCallbackFunc)&&t._removeCallbackFunc(),(0,u.Z)(t)}function B(e){e=(0,s.Z)(e,s.Z.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._backgroundBillboardCollection=new p.Z({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new p.Z({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._billboardCollection._sdf=!0,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._highlightColor=o.Z.clone(o.Z.WHITE),this.show=(0,s.Z)(e.show,!0),this.modelMatrix=l.Z.clone((0,s.Z)(e.modelMatrix,l.Z.IDENTITY)),this.debugShowBoundingVolume=(0,s.Z)(e.debugShowBoundingVolume,!1),this.blendOption=(0,s.Z)(e.blendOption,f.Z.OPAQUE_AND_TRANSLUCENT)}Object.defineProperties(B.prototype,{length:{get:function(){return this._labels.length}}}),B.prototype.add=function(e){const t=new T.Z(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t},B.prototype.remove=function(e){if((0,a.Z)(e)&&e._labelCollection===this){const t=this._labels.indexOf(e);if(-1!==t)return this._labels.splice(t,1),U(this,e),!0}return!1},B.prototype.removeAll=function(){const e=this._labels;for(let t=0,n=e.length;t<n;++t)U(this,e[t]);e.length=0},B.prototype.contains=function(e){return(0,a.Z)(e)&&e._labelCollection===this},B.prototype.get=function(e){if(!(0,a.Z)(e))throw new c.Z("index is required.");return this._labels[e]},B.prototype.update=function(e){if(!this.show)return;const t=this._billboardCollection,n=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,n.modelMatrix=this.modelMatrix,n.debugShowBoundingVolume=this.debugShowBoundingVolume;const i=e.context;(0,a.Z)(this._textureAtlas)||(this._textureAtlas=new g.Z({context:i}),t.textureAtlas=this._textureAtlas),(0,a.Z)(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new g.Z({context:i,initialSize:N}),n.textureAtlas=this._backgroundTextureAtlas,function(e){const t=document.createElement("canvas");t.width=N.x,t.height=N.y;const n=t.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,t.width,t.height),e.addImage(S,t)}(this._backgroundTextureAtlas));const r=this._labelsToUpdate.length;for(let e=0;e<r;++e){const t=this._labelsToUpdate[e];if(t.isDestroyed())continue;const n=t._glyphs.length;t._rebindAllGlyphs&&(w(this,t),t._rebindAllGlyphs=!1),t._repositionAllGlyphs&&(P(t),t._repositionAllGlyphs=!1);const i=t._glyphs.length-n;this._totalGlyphCount+=i}const o=n.length>0?f.Z.TRANSLUCENT:this.blendOption;t.blendOption=o,n.blendOption=o,t._highlightColor=this._highlightColor,n._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,n.update(e),t.update(e)},B.prototype.isDestroyed=function(){return!1},B.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),(0,u.Z)(this)};const G=B},36164:(e,t,n)=>{n.d(t,{Z:()=>i});const i=Object.freeze({FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2})},55657:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(20176);function r(){}Object.defineProperties(r.prototype,{color:{get:i.Z.throwInstantiationError},intensity:{get:i.Z.throwInstantiationError}});const o=r},50445:(e,t,n)=>{n.d(t,{Z:()=>i});const i=Object.freeze({ROTATE:0,INFINITE_SCROLL:1})},28678:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(78505),r=n(88779),o=n(54485),s=n(20176),a=n(67197),u=n(85933);const c=/\/$/,l=new i.Z('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function d(e){const t=(e=(0,r.Z)(e,r.Z.EMPTY_OBJECT)).mapId;if(!(0,o.Z)(t))throw new s.Z("options.mapId is required.");const n=e.accessToken;if(!(0,o.Z)(n))throw new s.Z("options.accessToken is required.");this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;const d=a.Z.createIfNeeded((0,r.Z)(e.url,"https://{s}.tiles.mapbox.com/v4/"));this._mapId=t,this._accessToken=n;let h=(0,r.Z)(e.format,"png");/\./.test(h)||(h=`.${h}`),this._format=h;let p,f=d.getUrlComponent();c.test(f)||(f+="/"),f+=`${t}/{z}/{x}/{y}${this._format}`,d.url=f,d.setQueryParameters({access_token:n}),(0,o.Z)(e.credit)?(p=e.credit,"string"==typeof p&&(p=new i.Z(p))):p=l,this._resource=d,this._imageryProvider=new u.Z({url:d,credit:p,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(d.prototype,{url:{get:function(){return this._imageryProvider.url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),d.prototype.getTileCredits=function(e,t,n){},d.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)},d.prototype.pickFeatures=function(e,t,n,i,r){return this._imageryProvider.pickFeatures(e,t,n,i,r)},d._defaultCredit=l;const h=d},26676:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(78505),r=n(88779),o=n(54485),s=n(20176),a=n(67197),u=n(85933);const c=/\/$/,l=new i.Z('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function d(e){const t=(e=(0,r.Z)(e,r.Z.EMPTY_OBJECT)).styleId;if(!(0,o.Z)(t))throw new s.Z("options.styleId is required.");const n=e.accessToken;if(!(0,o.Z)(n))throw new s.Z("options.accessToken is required.");this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;const d=a.Z.createIfNeeded((0,r.Z)(e.url,"https://api.mapbox.com/styles/v1/"));this._styleId=t,this._accessToken=n;const h=(0,r.Z)(e.tilesize,512);this._tilesize=h;const p=(0,r.Z)(e.username,"mapbox");this._username=p;const f=(0,o.Z)(e.scaleFactor)?"@2x":"";let _,m=d.getUrlComponent();c.test(m)||(m+="/"),m+=`${this._username}/${t}/tiles/${this._tilesize}/{z}/{x}/{y}${f}`,d.url=m,d.setQueryParameters({access_token:n}),(0,o.Z)(e.credit)?(_=e.credit,"string"==typeof _&&(_=new i.Z(_))):_=l,this._resource=d,this._imageryProvider=new u.Z({url:d,credit:_,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(d.prototype,{url:{get:function(){return this._imageryProvider.url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),d.prototype.getTileCredits=function(e,t,n){},d.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)},d.prototype.pickFeatures=function(e,t,n,i,r){return this._imageryProvider.pickFeatures(e,t,n,i,r)},d._defaultCredit=l;const h=d},7063:(e,t,n)=>{n.d(t,{Z:()=>J});var i=n(59015),r=n(55077),o=n(6785),s=n(51138),a=n(93737),u=n(88779),c=n(54485),l=n(90332),d=n(20176),h=n(22260),p=n(40734),f=n(39109),_=n(71118),m=n(67197),T=n(83159),Z=n(47334),y=n(25730),g=n(16468),I=n(62266),A=n(62658),b=n(99399),E=n(58214),S=n(56173),N=n(72378),O=n(49751),C=n(37741),v=n(23010),D=n(47511),M=n(3886),x=n(6493),w=n(52650),R=n(28696),F=n(47811),L=n(14160),P=n(92106),U=n(48867),B=n(97499);function G(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=(0,u.Z)(e.minificationFilter,U.Z.LINEAR),this._magnificationFilter=(0,u.Z)(e.magnificationFilter,P.Z.LINEAR),this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,function(e,t){let n;e=(0,u.Z)(e,u.Z.EMPTY_OBJECT),t._strict=(0,u.Z)(e.strict,!1),t._count=(0,u.Z)(e.count,0),t._template=(0,r.Z)((0,u.Z)(e.fabric,u.Z.EMPTY_OBJECT)),t._template.uniforms=(0,r.Z)((0,u.Z)(t._template.uniforms,u.Z.EMPTY_OBJECT)),t._template.materials=(0,r.Z)((0,u.Z)(t._template.materials,u.Z.EMPTY_OBJECT)),t.type=(0,c.Z)(t._template.type)?t._template.type:(0,a.Z)(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];const i=G._materialCache.getMaterial(t.type);if((0,c.Z)(i)){const e=(0,r.Z)(i.fabric,!0);t._template=(0,s.Z)(t._template,e,!0),n=i.translucent}(function(e){const t=e._template,n=t.uniforms,i=t.materials,r=t.components;if((0,c.Z)(r)&&(0,c.Z)(t.source))throw new d.Z("fabric: cannot have source and components in the same template.");V(t,$,k,!0),V(r,H,k,!0);const o=[];for(const e in i)i.hasOwnProperty(e)&&o.push(e);V(n,o,z,!1)})(t),(0,c.Z)(i)||G._materialCache.addMaterial(t.type,t);(function(e){const t=e._template.components,n=e._template.source;if((0,c.Z)(n))e.shaderSource+=`${n}\n`;else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",(0,c.Z)(t)){const n=Object.keys(e._template.materials).length>0;for(const i in t)if(t.hasOwnProperty(i))if("diffuse"===i||"emission"===i){const r=n&&j(t[i],e)?t[i]:`czm_gammaCorrect(${t[i]})`;e.shaderSource+=`material.${i} = ${r}; \n`}else e.shaderSource+="alpha"===i?`material.alpha = ${t.alpha}; \n`:`material.${i} = ${t[i]};\n`}e.shaderSource+="return material;\n}\n"}})(t),function(e){const t=e._template.uniforms;for(const n in t)t.hasOwnProperty(n)&&Y(e,n)}(t),function(e){const t=e._strict,n=e._template.materials;for(const i in n)if(n.hasOwnProperty(i)){const r=new G({strict:t,fabric:n[i],count:e._count});e._count=r._count,e._uniforms=(0,s.Z)(e._uniforms,r._uniforms,!0),e.materials[i]=r,e._translucentFunctions=e._translucentFunctions.concat(r._translucentFunctions);const o="czm_getMaterial",a=`${o}_${e._count++}`;X(r,o,a),e.shaderSource=r.shaderSource+e.shaderSource;if(0===X(e,i,`${a}(materialInput)`)&&t)throw new d.Z(`strict: shader source does not use material '${i}'.`)}}(t);const o=0===t._translucentFunctions.length||void 0;if(n=(0,u.Z)(n,o),n=(0,u.Z)(e.translucent,n),(0,c.Z)(n))if("function"==typeof n){const e=function(){return n(t)};t._translucentFunctions.push(e)}else t._translucentFunctions.push(n)}(e,this),Object.defineProperties(this,{type:{value:this.type,writable:!1}}),(0,c.Z)(G._uniformList[this.type])||(G._uniformList[this.type]=Object.keys(this._uniforms))}function V(e,t,n,i){if((0,c.Z)(e))for(const r in e)if(e.hasOwnProperty(r)){const e=-1!==t.indexOf(r);(i&&!e||!i&&e)&&n(r,t)}}function k(e,t){let n=`fabric: property name '${e}' is not valid. It should be `;for(let e=0;e<t.length;e++){const i=`'${t[e]}'`;n+=e===t.length-1?`or ${i}.`:`${i}, `}throw new d.Z(n)}function z(e,t){const n=`fabric: uniforms and materials cannot share the same property '${e}'`;throw new d.Z(n)}G._uniformList={},G.fromType=function(e,t){if(!(0,c.Z)(G._materialCache.getMaterial(e)))throw new d.Z(`material with type '${e}' does not exist.`);const n=new G({fabric:{type:e}});if((0,c.Z)(t))for(const e in t)t.hasOwnProperty(e)&&(n.uniforms[e]=t[e]);return n},G.prototype.isTranslucent=function(){if((0,c.Z)(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;let e=!0;const t=this._translucentFunctions,n=t.length;for(let i=0;i<n;++i){const n=t[i];if(e="function"==typeof n?e&&n():e&&n,!e)break}return e},G.prototype.update=function(e){let t,n;this._defaultTexture=e.defaultTexture;const i=this._loadedImages;let r=i.length;for(t=0;t<r;++t){const r=i[t];n=r.id;let o,s=r.image;Array.isArray(s)&&(o=s.slice(1,s.length).map((function(e){return e.bufferView})),s=s[0]);const a=new R.Z({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter});let u;u=(0,c.Z)(s.internalFormat)?new Z.Z({context:e,pixelFormat:s.internalFormat,width:s.width,height:s.height,source:{arrayBufferView:s.bufferView,mipLevels:o},sampler:a}):new Z.Z({context:e,source:s,sampler:a});const l=this._textures[n];(0,c.Z)(l)&&l!==this._defaultTexture&&l.destroy(),this._textures[n]=u;const d=`${n}Dimensions`;if(this.uniforms.hasOwnProperty(d)){const e=this.uniforms[d];e.x=u._width,e.y=u._height}}i.length=0;const o=this._loadedCubeMaps;for(r=o.length,t=0;t<r;++t){const i=o[t];n=i.id;const r=i.images,s=new T.Z({context:e,source:{positiveX:r[0],negativeX:r[1],positiveY:r[2],negativeY:r[3],positiveZ:r[4],negativeZ:r[5]},sampler:new R.Z({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[n]=s}o.length=0;const s=this._updateFunctions;for(r=s.length,t=0;t<r;++t)s[t](this,e);const a=this.materials;for(const t in a)a.hasOwnProperty(t)&&a[t].update(e)},G.prototype.isDestroyed=function(){return!1},G.prototype.destroy=function(){const e=this._textures;for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];n!==this._defaultTexture&&n.destroy()}const t=this.materials;for(const e in t)t.hasOwnProperty(e)&&t[e].destroy();return(0,l.Z)(this)};const $=["type","materials","uniforms","components","source"],H=["diffuse","specular","shininess","normal","emission","alpha"];function j(e,t){const n=t._template.materials;for(const t in n)if(n.hasOwnProperty(t)&&e.indexOf(t)>-1)return!0;return!1}const W={mat2:p.Z,mat3:f.Z,mat4:_.Z},q=/\.ktx2$/i;function Y(e,t){const n=e._strict,i=e._template.uniforms,r=i[t],o=function(e){let t=e.type;if(!(0,c.Z)(t)){const n=typeof e;if("number"===n)t="float";else if("boolean"===n)t="bool";else if("string"===n||e instanceof m.Z||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===G.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===n)if(Array.isArray(e))4!==e.length&&9!==e.length&&16!==e.length||(t=`mat${Math.sqrt(e.length)}`);else{let n=0;for(const t in e)e.hasOwnProperty(t)&&(n+=1);n>=2&&n<=4?t=`vec${n}`:6===n&&(t="samplerCube")}}return t}(r);if(!(0,c.Z)(o))throw new d.Z(`fabric: uniform '${t}' has invalid type.`);let s;if("channels"===o){if(s=X(e,t,r,!1),0===s&&n)throw new d.Z(`strict: shader source does not use channels '${t}'.`)}else{if("sampler2D"===o){const n=`${t}Dimensions`;(function(e,t,n){return X(e,t,t,n)})(e,n)>0&&(i[n]={type:"ivec3",x:1,y:1},Y(e,n))}if(!new RegExp(`uniform\\s+${o}\\s+${t}\\s*;`).test(e.shaderSource)){const n=`uniform ${o} ${t};`;e.shaderSource=n+e.shaderSource}const a=`${t}_${e._count++}`;if(s=X(e,t,a),1===s&&n)throw new d.Z(`strict: shader source does not use uniform '${t}'.`);if(e.uniforms[t]=r,"sampler2D"===o)e._uniforms[a]=function(){return e._textures[t]},e._updateFunctions.push(function(e){let t;return function(n,i){const r=n.uniforms,o=r[e],s=t!==o,a=!(0,c.Z)(o)||o===G.DefaultImageId;t=o;let u,l,d=n._textures[e];if(o instanceof HTMLVideoElement){if(o.readyState>=2){if(s&&(0,c.Z)(d)&&(d!==i.defaultTexture&&d.destroy(),d=void 0),!(0,c.Z)(d)||d===i.defaultTexture){const t=new R.Z({minificationFilter:n._minificationFilter,magnificationFilter:n._magnificationFilter});return d=new Z.Z({context:i,source:o,sampler:t}),void(n._textures[e]=d)}d.copyFrom({source:o})}else(0,c.Z)(d)||(n._textures[e]=i.defaultTexture);return}if(o instanceof Z.Z&&o!==d){n._texturePaths[e]=void 0;const t=n._textures[e];return(0,c.Z)(t)&&t!==n._defaultTexture&&t.destroy(),n._textures[e]=o,u=`${e}Dimensions`,void(r.hasOwnProperty(u)&&(l=r[u],l.x=o._width,l.y=o._height))}if(s&&(0,c.Z)(d)&&a&&(d!==n._defaultTexture&&d.destroy(),d=void 0),(0,c.Z)(d)||(n._texturePaths[e]=void 0,d=n._textures[e]=n._defaultTexture,u=`${e}Dimensions`,r.hasOwnProperty(u)&&(l=r[u],l.x=d._width,l.y=d._height)),a)return;const p=o instanceof m.Z;if(!(0,c.Z)(n._texturePaths[e])||p&&o.url!==n._texturePaths[e].url||!p&&o!==n._texturePaths[e]){if("string"==typeof o||p){const t=p?o:m.Z.createIfNeeded(o);let i;i=q.test(t.url)?(0,h.Z)(t.url):t.fetchImage(),Promise.resolve(i).then((function(t){n._loadedImages.push({id:e,image:t})})).catch((function(){(0,c.Z)(d)&&d!==n._defaultTexture&&d.destroy(),n._textures[e]=n._defaultTexture}))}else(o instanceof HTMLCanvasElement||o instanceof HTMLImageElement)&&n._loadedImages.push({id:e,image:o});n._texturePaths[e]=o}}}(t));else if("samplerCube"===o)e._uniforms[a]=function(){return e._textures[t]},e._updateFunctions.push(function(e){return function(t,n){const i=t.uniforms[e];if(i instanceof T.Z){const n=t._textures[e];return n!==t._defaultTexture&&n.destroy(),t._texturePaths[e]=void 0,void(t._textures[e]=i)}if((0,c.Z)(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=n.defaultCubeMap),i===G.DefaultCubeMapId)return;const r=i.positiveX+i.negativeX+i.positiveY+i.negativeY+i.positiveZ+i.negativeZ;if(r!==t._texturePaths[e]){const n=[m.Z.createIfNeeded(i.positiveX).fetchImage(),m.Z.createIfNeeded(i.negativeX).fetchImage(),m.Z.createIfNeeded(i.positiveY).fetchImage(),m.Z.createIfNeeded(i.negativeY).fetchImage(),m.Z.createIfNeeded(i.positiveZ).fetchImage(),m.Z.createIfNeeded(i.negativeZ).fetchImage()];Promise.all(n).then((function(n){t._loadedCubeMaps.push({id:e,images:n})})),t._texturePaths[e]=r}}}(t));else if(-1!==o.indexOf("mat")){const n=new W[o];e._uniforms[a]=function(){return W[o].fromColumnMajorArray(e.uniforms[t],n)}}else e._uniforms[a]=function(){return e.uniforms[t]}}}function X(e,t,n,i){i=(0,u.Z)(i,!0);let r=0;const o=new RegExp(`([\\w${i?".":""}])?`+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(o,(function(e,t,i){return t||i?e:(r+=1,n)})),r}G._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},G.DefaultImageId="czm_defaultImage",G.DefaultCubeMapId="czm_defaultCubeMap",G.ColorType="Color",G._materialCache.addMaterial(G.ColorType,{fabric:{type:G.ColorType,uniforms:{color:new o.Z(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),G.ImageType="Image",G._materialCache.addMaterial(G.ImageType,{fabric:{type:G.ImageType,uniforms:{image:G.DefaultImageId,repeat:new i.Z(1,1),color:new o.Z(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),G.DiffuseMapType="DiffuseMap",G._materialCache.addMaterial(G.DiffuseMapType,{fabric:{type:G.DiffuseMapType,uniforms:{image:G.DefaultImageId,channels:"rgb",repeat:new i.Z(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),G.AlphaMapType="AlphaMap",G._materialCache.addMaterial(G.AlphaMapType,{fabric:{type:G.AlphaMapType,uniforms:{image:G.DefaultImageId,channel:"a",repeat:new i.Z(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),G.SpecularMapType="SpecularMap",G._materialCache.addMaterial(G.SpecularMapType,{fabric:{type:G.SpecularMapType,uniforms:{image:G.DefaultImageId,channel:"r",repeat:new i.Z(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),G.EmissionMapType="EmissionMap",G._materialCache.addMaterial(G.EmissionMapType,{fabric:{type:G.EmissionMapType,uniforms:{image:G.DefaultImageId,channels:"rgb",repeat:new i.Z(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),G.BumpMapType="BumpMap",G._materialCache.addMaterial(G.BumpMapType,{fabric:{type:G.BumpMapType,uniforms:{image:G.DefaultImageId,channel:"r",strength:.8,repeat:new i.Z(1,1)},source:g.Z},translucent:!1}),G.NormalMapType="NormalMap",G._materialCache.addMaterial(G.NormalMapType,{fabric:{type:G.NormalMapType,uniforms:{image:G.DefaultImageId,channels:"rgb",strength:.8,repeat:new i.Z(1,1)},source:C.Z},translucent:!1}),G.GridType="Grid",G._materialCache.addMaterial(G.GridType,{fabric:{type:G.GridType,uniforms:{color:new o.Z(0,1,0,1),cellAlpha:.1,lineCount:new i.Z(8,8),lineThickness:new i.Z(1,1),lineOffset:new i.Z(0,0)},source:O.Z},translucent:function(e){const t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),G.StripeType="Stripe",G._materialCache.addMaterial(G.StripeType,{fabric:{type:G.StripeType,uniforms:{horizontal:!0,evenColor:new o.Z(1,1,1,.5),oddColor:new o.Z(0,0,1,.5),offset:0,repeat:5},source:L.Z},translucent:function(e){const t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),G.CheckerboardType="Checkerboard",G._materialCache.addMaterial(G.CheckerboardType,{fabric:{type:G.CheckerboardType,uniforms:{lightColor:new o.Z(1,1,1,.5),darkColor:new o.Z(0,0,0,.5),repeat:new i.Z(5,5)},source:I.Z},translucent:function(e){const t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),G.DotType="Dot",G._materialCache.addMaterial(G.DotType,{fabric:{type:G.DotType,uniforms:{lightColor:new o.Z(1,1,0,.75),darkColor:new o.Z(0,1,1,.75),repeat:new i.Z(5,5)},source:A.Z},translucent:function(e){const t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),G.WaterType="Water",G._materialCache.addMaterial(G.WaterType,{fabric:{type:G.WaterType,uniforms:{baseWaterColor:new o.Z(.2,.3,.6,1),blendColor:new o.Z(0,1,.699,1),specularMap:G.DefaultImageId,normalMap:G.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:B.Z},translucent:function(e){const t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),G.RimLightingType="RimLighting",G._materialCache.addMaterial(G.RimLightingType,{fabric:{type:G.RimLightingType,uniforms:{color:new o.Z(1,0,0,.7),rimColor:new o.Z(1,1,1,.4),width:.3},source:w.Z},translucent:function(e){const t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),G.FadeType="Fade",G._materialCache.addMaterial(G.FadeType,{fabric:{type:G.FadeType,uniforms:{fadeInColor:new o.Z(1,0,0,1),fadeOutColor:new o.Z(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new i.Z(.5,.5)},source:N.Z},translucent:function(e){const t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),G.PolylineArrowType="PolylineArrow",G._materialCache.addMaterial(G.PolylineArrowType,{fabric:{type:G.PolylineArrowType,uniforms:{color:new o.Z(1,1,1,1)},source:v.Z},translucent:!0}),G.PolylineDashType="PolylineDash",G._materialCache.addMaterial(G.PolylineDashType,{fabric:{type:G.PolylineDashType,uniforms:{color:new o.Z(1,0,1,1),gapColor:new o.Z(0,0,0,0),dashLength:16,dashPattern:255},source:D.Z},translucent:!0}),G.PolylineGlowType="PolylineGlow",G._materialCache.addMaterial(G.PolylineGlowType,{fabric:{type:G.PolylineGlowType,uniforms:{color:new o.Z(0,.5,1,1),glowPower:.25,taperPower:1},source:M.Z},translucent:!0}),G.PolylineOutlineType="PolylineOutline",G._materialCache.addMaterial(G.PolylineOutlineType,{fabric:{type:G.PolylineOutlineType,uniforms:{color:new o.Z(1,1,1,1),outlineColor:new o.Z(1,0,0,1),outlineWidth:1},source:x.Z},translucent:function(e){const t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),G.ElevationContourType="ElevationContour",G._materialCache.addMaterial(G.ElevationContourType,{fabric:{type:G.ElevationContourType,uniforms:{spacing:100,color:new o.Z(1,0,0,1),width:1},source:E.Z},translucent:!1}),G.ElevationRampType="ElevationRamp",G._materialCache.addMaterial(G.ElevationRampType,{fabric:{type:G.ElevationRampType,uniforms:{image:G.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:S.Z},translucent:!1}),G.SlopeRampMaterialType="SlopeRamp",G._materialCache.addMaterial(G.SlopeRampMaterialType,{fabric:{type:G.SlopeRampMaterialType,uniforms:{image:G.DefaultImageId},source:F.Z},translucent:!1}),G.AspectRampMaterialType="AspectRamp",G._materialCache.addMaterial(G.AspectRampMaterialType,{fabric:{type:G.AspectRampMaterialType,uniforms:{image:G.DefaultImageId},source:y.Z},translucent:!1}),G.ElevationBandType="ElevationBand",G._materialCache.addMaterial(G.ElevationBandType,{fabric:{type:G.ElevationBandType,uniforms:{heights:G.DefaultImageId,colors:G.DefaultImageId},source:b.Z},translucent:!0});const J=G},41656:(e,t,n)=>{n.d(t,{Z:()=>_});var i=n(88779),r=n(54485),o=n(25225),s=n(69001),a=n(76852),u=n(54343),c=n(73777),l=n(87973),d=n(89809),h=n(58466),p=n(7063);function f(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT);const t=(0,i.Z)(e.translucent,!0),n=(0,i.Z)(e.closed,!1),o=(0,i.Z)(e.materialSupport,f.MaterialSupport.TEXTURED);this.material=(0,r.Z)(e.material)?e.material:p.Z.fromType(p.Z.ColorType),this.translucent=t,this._vertexShaderSource=(0,i.Z)(e.vertexShaderSource,o.vertexShaderSource),this._fragmentShaderSource=(0,i.Z)(e.fragmentShaderSource,o.fragmentShaderSource),this._renderState=h.Z.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._materialSupport=o,this._vertexFormat=o.vertexFormat,this._flat=(0,i.Z)(e.flat,!1),this._faceForward=(0,i.Z)(e.faceForward,!n)}Object.defineProperties(f.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),f.prototype.getFragmentShaderSource=h.Z.prototype.getFragmentShaderSource,f.prototype.isTranslucent=h.Z.prototype.isTranslucent,f.prototype.getRenderState=h.Z.prototype.getRenderState,f.MaterialSupport={BASIC:Object.freeze({vertexFormat:o.Z.POSITION_AND_NORMAL,vertexShaderSource:c.Z,fragmentShaderSource:u.Z}),TEXTURED:Object.freeze({vertexFormat:o.Z.POSITION_NORMAL_AND_ST,vertexShaderSource:d.Z,fragmentShaderSource:l.Z}),ALL:Object.freeze({vertexFormat:o.Z.ALL,vertexShaderSource:a.Z,fragmentShaderSource:s.Z})};const _=f},41519:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(17497),r=n(88779),o=n(54485),s=n(81072);function a(e){const t=(e=(0,r.Z)(e,r.Z.EMPTY_OBJECT)).id,n=e.class;i.Z.typeOf.string("options.id",t),i.Z.typeOf.object("options.class",n);const a={},u={};for(const t in n.properties)if(n.properties.hasOwnProperty(t)){const i=new s.Z({id:t,property:n.properties[t],enums:e.enums});a[t]=i,(0,o.Z)(i.semantic)&&(u[i.semantic]=i)}this._properties=a,this._propertiesBySemantic=u,this._id=t,this._name=n.name,this._description=n.description,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(a.prototype,{properties:{get:function(){return this._properties}},propertiesBySemantic:{get:function(){return this._propertiesBySemantic}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.BATCH_TABLE_CLASS_NAME="_batchTable";const u=a},81072:(e,t,n)=>{n.d(t,{Z:()=>b});var i=n(59015),r=n(93517),o=n(90868),s=n(17497),a=n(88779),u=n(54485),c=n(20176),l=n(40734),d=n(39109),h=n(71118),p=n(82837),f=n(76336);function _(e){const t=(e=(0,a.Z)(e,a.Z.EMPTY_OBJECT)).id,n=e.property;s.Z.typeOf.string("options.id",t),s.Z.typeOf.object("options.property",n),s.Z.typeOf.string("options.property.type",n.type);const i=function(e){if("ARRAY"===e.type)return!0;const t=e.type;if(t===p.Z.SCALAR||p.Z.isMatrixType(t)||p.Z.isVectorType(t))return!1;if(f.Z.isNumericType(t))return!0;if((0,u.Z)(e.noData)||(0,u.Z)(e.scale)||(0,u.Z)(e.offset)||(0,u.Z)(e.required)||(0,u.Z)(e.count)||(0,u.Z)(e.array))return!1;if((0,u.Z)(e.optional))return!1;return}(n),r=function(e,t){const n=e.type,i=e.componentType,r="ARRAY"===n;let o,s,a,l;r?(o=!0,s=e.componentCount,a=!(0,u.Z)(s)):e.array?(o=!0,s=e.count,a=!(0,u.Z)(e.count)):(o=!1,s=void 0,a=!1);(0,u.Z)(e.enumType)&&(l=t[e.enumType]);if(n===p.Z.ENUM)return{type:n,componentType:void 0,enumType:l,valueType:l.valueType,isArray:o,isVariableLengthArray:a,arrayLength:s};if(r&&i===p.Z.ENUM)return{type:i,componentType:void 0,enumType:l,valueType:l.valueType,isArray:o,isVariableLengthArray:a,arrayLength:s};if(n===p.Z.SCALAR||p.Z.isMatrixType(n)||p.Z.isVectorType(n))return{type:n,componentType:i,enumType:void 0,valueType:i,isArray:o,isVariableLengthArray:a,arrayLength:s};if(n===p.Z.BOOLEAN||n===p.Z.STRING)return{type:n,componentType:void 0,enumType:void 0,valueType:void 0,isArray:o,isVariableLengthArray:a,arrayLength:s};if(r&&(i===p.Z.BOOLEAN||i===p.Z.STRING))return{type:i,componentType:void 0,enumType:void 0,valueType:void 0,isArray:o,isVariableLengthArray:a,arrayLength:s};if((0,u.Z)(i)&&f.Z.isNumericType(i))return{type:p.Z.SCALAR,componentType:i,enumType:void 0,valueType:i,isArray:o,isVariableLengthArray:a,arrayLength:s};if(f.Z.isNumericType(n))return{type:p.Z.SCALAR,componentType:n,enumType:void 0,valueType:n,isArray:o,isVariableLengthArray:a,arrayLength:s};throw new c.Z(`unknown metadata type {type: ${n}, componentType: ${i})`)}(n,e.enums),o=r.componentType,l=(0,u.Z)(o)&&f.Z.isIntegerType(o)&&(0,a.Z)(n.normalized,!1);this._id=t,this._name=n.name,this._description=n.description,this._semantic=n.semantic,this._isLegacyExtension=i,this._type=r.type,this._componentType=o,this._enumType=r.enumType,this._valueType=r.valueType,this._isArray=r.isArray,this._isVariableLengthArray=r.isVariableLengthArray,this._arrayLength=r.arrayLength,this._min=n.min,this._max=n.max,this._normalized=l;let d=n.offset,h=n.scale;const _=(0,u.Z)(d)||(0,u.Z)(h);let m;(0,u.Z)(d)||(d=this.expandConstant(0,true)),(0,u.Z)(h)||(h=this.expandConstant(1,true)),this._offset=d,this._scale=h,this._hasValueTransform=_,this._noData=n.noData,this._default=n.default,m=!!(0,u.Z)(i)&&(i?!(0,u.Z)(n.optional)||!n.optional:(0,a.Z)(n.required,!1)),this._required=m,this._extras=n.extras,this._extensions=n.extensions}function m(e,t){if(!Array.isArray(e))return e===t;if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!m(e[n],t[n]))return!1;return!0}function T(e,t){const n=e._type,s=e._componentType,a=e._enumType,c=e._normalized;return p.Z.isVectorType(n)?function(e,t,n){if(!f.Z.isVectorCompatible(n))return`componentType ${n} is incompatible with vector type ${t}`;if(t===p.Z.VEC2&&!(e instanceof i.Z))return`vector value ${e} must be a Cartesian2`;if(t===p.Z.VEC3&&!(e instanceof r.Z))return`vector value ${e} must be a Cartesian3`;if(t===p.Z.VEC4&&!(e instanceof o.Z))return`vector value ${e} must be a Cartesian4`}(t,n,s):p.Z.isMatrixType(n)?function(e,t,n){if(!f.Z.isVectorCompatible(n))return`componentType ${n} is incompatible with matrix type ${t}`;if(t===p.Z.MAT2&&!(e instanceof l.Z))return`matrix value ${e} must be a Matrix2`;if(t===p.Z.MAT3&&!(e instanceof d.Z))return`matrix value ${e} must be a Matrix3`;if(t===p.Z.MAT4&&!(e instanceof h.Z))return`matrix value ${e} must be a Matrix4`}(t,n,s):n===p.Z.STRING?function(e){if("string"!=typeof e)return Z(e,p.Z.STRING)}(t):n===p.Z.BOOLEAN?function(e){if("boolean"!=typeof e)return Z(e,p.Z.BOOLEAN)}(t):n===p.Z.ENUM?function(e,t){const n=typeof e;if((0,u.Z)(t))return"string"===n&&(0,u.Z)(t.valuesByName[e])?void 0:`value ${e} is not a valid enum name for ${t.id}`}(t,a):function(e,t,n){const i=typeof e;switch(t){case f.Z.INT8:case f.Z.UINT8:case f.Z.INT16:case f.Z.UINT16:case f.Z.INT32:case f.Z.UINT32:case f.Z.FLOAT32:case f.Z.FLOAT64:return"number"!==i?Z(e,t):isFinite(e)?g(e,t,n):I(e,t);case f.Z.INT64:case f.Z.UINT64:return"number"!==i&&"bigint"!==i?Z(e,t):"number"!==i||isFinite(e)?g(e,t,n):I(e,t)}}(t,s,c)}function Z(e,t){return`value ${e} does not match type ${t}`}function y(e,t,n){let i=`value ${e} is out of range for type ${t}`;return n&&(i+=" (normalized)"),i}function g(e,t,n){if(n){const i=1;return e<(f.Z.isUnsignedIntegerType(t)?0:-1)||e>i?y(e,t,n):void 0}if(e<f.Z.getMinimum(t)||e>f.Z.getMaximum(t))return y(e,t,n)}function I(e,t){return`value ${e} of type ${t} must be finite`}function A(e,t,n){if(!Array.isArray(e))return n(e,t);for(let i=0;i<e.length;i++)e[i]=A(e[i],t,n);return e}Object.defineProperties(_.prototype,{id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},type:{get:function(){return this._type}},enumType:{get:function(){return this._enumType}},componentType:{get:function(){return this._componentType}},valueType:{get:function(){return this._valueType}},isArray:{get:function(){return this._isArray}},isVariableLengthArray:{get:function(){return this._isVariableLengthArray}},arrayLength:{get:function(){return this._arrayLength}},normalized:{get:function(){return this._normalized}},max:{get:function(){return this._max}},min:{get:function(){return this._min}},noData:{get:function(){return this._noData}},default:{get:function(){return this._default}},required:{get:function(){return this._required}},semantic:{get:function(){return this._semantic}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),_.prototype.normalize=function(e){return this._normalized?A(e,this._valueType,f.Z.normalize):e},_.prototype.unnormalize=function(e){return this._normalized?A(e,this._valueType,f.Z.unnormalize):e},_.prototype.applyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:_.valueTransformInPlace(e,this._offset,this._scale,f.Z.applyValueTransform)},_.prototype.unapplyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:_.valueTransformInPlace(e,this._offset,this._scale,f.Z.unapplyValueTransform)},_.prototype.expandConstant=function(e,t){t=(0,a.Z)(t,!1);const n=this._isArray,i=this._arrayLength,r=p.Z.getComponentCount(this._type),o=n&&r>1;if(!n&&1===r)return e;if(!n)return new Array(r).fill(e);if(!o)return new Array(i).fill(e);if(!t)return new Array(this._arrayLength*r).fill(e);const s=new Array(r).fill(e);return new Array(this._arrayLength).fill(s)},_.prototype.handleNoData=function(e){const t=this._noData;return(0,u.Z)(t)&&m(e,t)?void 0:e},_.prototype.unpackVectorAndMatrixTypes=function(e,t){t=(0,a.Z)(t,!1);const n=p.Z.getMathType(this._type),i=this._isArray,r=p.Z.getComponentCount(this._type),o=i&&r>1;return(0,u.Z)(n)?t&&o?e.map((function(e){return n.unpack(e)})):i?n.unpackArray(e):n.unpack(e):e},_.prototype.packVectorAndMatrixTypes=function(e,t){t=(0,a.Z)(t,!1);const n=p.Z.getMathType(this._type),i=this._isArray,r=p.Z.getComponentCount(this._type),o=i&&r>1;return(0,u.Z)(n)?t&&o?e.map((function(e){return n.pack(e,[])})):i?n.packArray(e,[]):n.pack(e,[]):e},_.prototype.validate=function(e){if((0,u.Z)(e)||!(0,u.Z)(this._default))return this._required&&!(0,u.Z)(e)?"required property must have a value":this._isArray?function(e,t){if(!Array.isArray(t))return`value ${t} must be an array`;const n=t.length;if(!e._isVariableLengthArray&&n!==e._arrayLength)return"Array length does not match property.arrayLength";for(let i=0;i<n;i++){const n=T(e,t[i]);if((0,u.Z)(n))return n}}(this,e):T(this,e)},_.valueTransformInPlace=function(e,t,n,i){if(!Array.isArray(e))return i(e,t,n);for(let r=0;r<e.length;r++)e[r]=_.valueTransformInPlace(e[r],t[r],n[r],i);return e};const b=_},76336:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(22874),r=n(17497),o=n(20176),s=n(74834);const a={INT8:"INT8",UINT8:"UINT8",INT16:"INT16",UINT16:"UINT16",INT32:"INT32",UINT32:"UINT32",INT64:"INT64",UINT64:"UINT64",FLOAT32:"FLOAT32",FLOAT64:"FLOAT64",getMinimum:function(e){if(!a.isNumericType(e))throw new o.Z("type must be a numeric type");switch(e){case a.INT8:return-128;case a.UINT8:return 0;case a.INT16:return-32768;case a.UINT16:return 0;case a.INT32:return-2147483648;case a.UINT32:return 0;case a.INT64:return s.Z.supportsBigInt()?BigInt("-9223372036854775808"):-Math.pow(2,63);case a.UINT64:return s.Z.supportsBigInt()?BigInt(0):0;case a.FLOAT32:return-34028234663852886e22;case a.FLOAT64:return-Number.MAX_VALUE}},getMaximum:function(e){if(!a.isNumericType(e))throw new o.Z("type must be a numeric type");switch(e){case a.INT8:return 127;case a.UINT8:return 255;case a.INT16:return 32767;case a.UINT16:return 65535;case a.INT32:return 2147483647;case a.UINT32:return 4294967295;case a.INT64:return s.Z.supportsBigInt()?BigInt("9223372036854775807"):Math.pow(2,63)-1;case a.UINT64:return s.Z.supportsBigInt()?BigInt("18446744073709551615"):Math.pow(2,64)-1;case a.FLOAT32:return 34028234663852886e22;case a.FLOAT64:return Number.MAX_VALUE}},isNumericType:function(e){switch(r.Z.typeOf.string("type",e),e){case a.INT8:case a.UINT8:case a.INT16:case a.UINT16:case a.INT32:case a.UINT32:case a.INT64:case a.UINT64:case a.FLOAT32:case a.FLOAT64:return!0;default:return!1}},isIntegerType:function(e){switch(r.Z.typeOf.string("type",e),e){case a.INT8:case a.UINT8:case a.INT16:case a.UINT16:case a.INT32:case a.UINT32:case a.INT64:case a.UINT64:return!0;default:return!1}},isUnsignedIntegerType:function(e){switch(r.Z.typeOf.string("type",e),e){case a.UINT8:case a.UINT16:case a.UINT32:case a.UINT64:return!0;default:return!1}},isVectorCompatible:function(e){switch(r.Z.typeOf.string("type",e),e){case a.INT8:case a.UINT8:case a.INT16:case a.UINT16:case a.INT32:case a.UINT32:case a.FLOAT32:case a.FLOAT64:return!0;default:return!1}},normalize:function(e,t){if("number"!=typeof e&&"bigint"!=typeof e)throw new o.Z("value must be a number or a BigInt");if(!a.isIntegerType(t))throw new o.Z("type must be an integer type");return Math.max(Number(e)/Number(a.getMaximum(t)),-1)},unnormalize:function(e,t){if(r.Z.typeOf.number("value",e),!a.isIntegerType(t))throw new o.Z("type must be an integer type");const n=a.getMaximum(t),u=a.isUnsignedIntegerType(t)?0:-n;return e=i.Z.sign(e)*Math.round(Math.abs(e)*Number(n)),t!==a.INT64&&t!==a.UINT64||!s.Z.supportsBigInt()||(e=BigInt(e)),e>n?n:e<u?u:e},applyValueTransform:function(e,t,n){return n*e+t},unapplyValueTransform:function(e,t,n){return 0===n?0:(e-t)/n},getSizeInBytes:function(e){if(!a.isNumericType(e))throw new o.Z("type must be a numeric type");switch(e){case a.INT8:case a.UINT8:return 1;case a.INT16:case a.UINT16:return 2;case a.INT32:case a.UINT32:return 4;case a.INT64:case a.UINT64:return 8;case a.FLOAT32:return 4;case a.FLOAT64:return 8}}},u=Object.freeze(a)},8754:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(17497),r=n(55077),o=n(54485),s=n(20176);function a(){}Object.defineProperties(a.prototype,{class:{get:function(){s.Z.throwInstantiationError()}}}),a.prototype.hasProperty=function(e){s.Z.throwInstantiationError()},a.prototype.hasPropertyBySemantic=function(e){s.Z.throwInstantiationError()},a.prototype.getPropertyIds=function(e){s.Z.throwInstantiationError()},a.prototype.getProperty=function(e){s.Z.throwInstantiationError()},a.prototype.setProperty=function(e,t){s.Z.throwInstantiationError()},a.prototype.getPropertyBySemantic=function(e){s.Z.throwInstantiationError()},a.prototype.setPropertyBySemantic=function(e,t){s.Z.throwInstantiationError()},a.hasProperty=function(e,t,n){if(i.Z.typeOf.string("propertyId",e),i.Z.typeOf.object("properties",t),i.Z.typeOf.object("classDefinition",n),(0,o.Z)(t[e]))return!0;const r=n.properties;if(!(0,o.Z)(r))return!1;const s=r[e];return!(!(0,o.Z)(s)||!(0,o.Z)(s.default))},a.hasPropertyBySemantic=function(e,t,n){i.Z.typeOf.string("semantic",e),i.Z.typeOf.object("properties",t),i.Z.typeOf.object("classDefinition",n);const r=n.propertiesBySemantic;if(!(0,o.Z)(r))return!1;const s=r[e];return(0,o.Z)(s)},a.getPropertyIds=function(e,t,n){i.Z.typeOf.object("properties",e),i.Z.typeOf.object("classDefinition",t),(n=(0,o.Z)(n)?n:[]).length=0;for(const t in e)e.hasOwnProperty(t)&&(0,o.Z)(e[t])&&n.push(t);const r=t.properties;if((0,o.Z)(r))for(const t in r)r.hasOwnProperty(t)&&!(0,o.Z)(e[t])&&(0,o.Z)(r[t].default)&&n.push(t);return n},a.getProperty=function(e,t,n){if(i.Z.typeOf.string("propertyId",e),i.Z.typeOf.object("properties",t),i.Z.typeOf.object("classDefinition",n),!(0,o.Z)(n.properties[e]))throw new s.Z(`Class definition missing property ${e}`);const a=n.properties[e];let u=t[e];Array.isArray(u)&&(u=u.slice());return u=a.handleNoData(u),!(0,o.Z)(u)&&(0,o.Z)(a.default)?(u=(0,r.Z)(a.default,!0),a.unpackVectorAndMatrixTypes(u,true)):(0,o.Z)(u)?(u=a.normalize(u),u=a.applyValueTransform(u),a.unpackVectorAndMatrixTypes(u,true)):void 0},a.setProperty=function(e,t,n,r){if(i.Z.typeOf.string("propertyId",e),i.Z.defined("value",t),i.Z.typeOf.object("properties",n),i.Z.typeOf.object("classDefinition",r),!(0,o.Z)(n[e]))return!1;let s;Array.isArray(t)&&(t=t.slice());const a=r.properties;(0,o.Z)(a)&&(s=a[e]);return(0,o.Z)(s)&&(t=s.packVectorAndMatrixTypes(t,true),t=s.unapplyValueTransform(t),t=s.unnormalize(t)),n[e]=t,!0},a.getPropertyBySemantic=function(e,t,n){i.Z.typeOf.string("semantic",e),i.Z.typeOf.object("properties",t),i.Z.typeOf.object("classDefinition",n);const r=n.propertiesBySemantic;if(!(0,o.Z)(r))return;const s=r[e];return(0,o.Z)(s)?a.getProperty(s.id,t,n):void 0},a.setPropertyBySemantic=function(e,t,n,r){i.Z.typeOf.string("semantic",e),i.Z.defined("value",t),i.Z.typeOf.object("properties",n),i.Z.typeOf.object("classDefinition",r);const s=r.propertiesBySemantic;if(!(0,o.Z)(s))return!1;const u=r.propertiesBySemantic[e];return!!(0,o.Z)(u)&&a.setProperty(u.id,t,n,r)};const u=a},86351:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(17497),r=n(88779),o=n(77482),s=n(76336);function a(e){const t=(e=(0,r.Z)(e,r.Z.EMPTY_OBJECT)).id,n=e.enum;i.Z.typeOf.string("options.id",t),i.Z.typeOf.object("options.enum",n);const a={},u={},c=n.values.map((function(e){return a[e.value]=e.name,u[e.name]=e.value,new o.Z(e)})),l=(0,r.Z)(s.Z[n.valueType],s.Z.UINT16);this._values=c,this._namesByValue=a,this._valuesByName=u,this._valueType=l,this._id=t,this._name=n.name,this._description=n.description,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(a.prototype,{values:{get:function(){return this._values}},namesByValue:{get:function(){return this._namesByValue}},valuesByName:{get:function(){return this._valuesByName}},valueType:{get:function(){return this._valueType}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const u=a},77482:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(17497);function r(e){i.Z.typeOf.object("value",e),this._value=e.value,this._name=e.name,this._description=e.description,this._extras=e.extras,this._extensions=e.extensions}Object.defineProperties(r.prototype,{value:{get:function(){return this._value}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const o=r},45262:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(17497),r=n(54485),o=n(41519),s=n(86351);function a(e){i.Z.typeOf.object("schema",e);const t={};if((0,r.Z)(e.enums))for(const n in e.enums)e.enums.hasOwnProperty(n)&&(t[n]=new s.Z({id:n,enum:e.enums[n]}));const n={};if((0,r.Z)(e.classes))for(const i in e.classes)e.classes.hasOwnProperty(i)&&(n[i]=new o.Z({id:i,class:e.classes[i],enums:t}));this._classes=n,this._enums=t,this._id=e.id,this._name=e.name,this._description=e.description,this._version=e.version,this._extras=e.extras,this._extensions=e.extensions}Object.defineProperties(a.prototype,{classes:{get:function(){return this._classes}},enums:{get:function(){return this._enums}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},version:{get:function(){return this._version}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const u=a},26593:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(88779),r=n(54485),o=n(20176),s=n(45262),a=n(39226),u=n(5955);function c(e){const t=(e=(0,i.Z)(e,i.Z.EMPTY_OBJECT)).schema,n=e.resource,a=e.cacheKey;if((0,r.Z)(t)===(0,r.Z)(n))throw new o.Z("One of options.schema and options.resource must be defined.");this._schema=(0,r.Z)(t)?new s.Z(t):void 0,this._resource=n,this._cacheKey=a,this._state=u.Z.UNLOADED,this._promise=void 0}(0,r.Z)(Object.create)&&(c.prototype=Object.create(a.Z.prototype),c.prototype.constructor=c),Object.defineProperties(c.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},schema:{get:function(){return this._schema}}}),c.prototype.load=function(){return(0,r.Z)(this._schema)?this._promise=Promise.resolve(this):this._promise=function(e){const t=e._resource;return e._state=u.Z.LOADING,t.fetchJson().then((function(t){if(!e.isDestroyed())return e._schema=new s.Z(t),e._state=u.Z.READY,e})).catch((function(n){if(e.isDestroyed())return;e._state=u.Z.FAILED;const i=`Failed to load schema: ${t.url}`;return Promise.reject(e.getError(i,n))}))}(this),this._promise},c.prototype.unload=function(){this._schema=void 0}},98686:(e,t,n)=>{n.d(t,{Z:()=>i});const i=Object.freeze({ID:"ID",NAME:"NAME",DESCRIPTION:"DESCRIPTION",TILE_BOUNDING_BOX:"TILE_BOUNDING_BOX",TILE_BOUNDING_REGION:"TILE_BOUNDING_REGION",TILE_BOUNDING_SPHERE:"TILE_BOUNDING_SPHERE",TILE_MINIMUM_HEIGHT:"TILE_MINIMUM_HEIGHT",TILE_MAXIMUM_HEIGHT:"TILE_MAXIMUM_HEIGHT",TILE_HORIZON_OCCLUSION_POINT:"TILE_HORIZON_OCCLUSION_POINT",TILE_GEOMETRIC_ERROR:"TILE_GEOMETRIC_ERROR",CONTENT_BOUNDING_BOX:"CONTENT_BOUNDING_BOX",CONTENT_BOUNDING_REGION:"CONTENT_BOUNDING_REGION",CONTENT_BOUNDING_SPHERE:"CONTENT_BOUNDING_SPHERE",CONTENT_MINIMUM_HEIGHT:"CONTENT_MINIMUM_HEIGHT",CONTENT_MAXIMUM_HEIGHT:"CONTENT_MAXIMUM_HEIGHT",CONTENT_HORIZON_OCCLUSION_POINT:"CONTENT_HORIZON_OCCLUSION_POINT"})},24206:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(17497),r=n(55077),o=n(88779),s=n(54485),a=n(8754),u=n(77085);function c(e){const t=(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT)).count,n=e.class;i.Z.typeOf.number.greaterThan("options.count",t,0),i.Z.typeOf.object("options.class",n);const r={};if((0,s.Z)(e.properties))for(const i in e.properties)e.properties.hasOwnProperty(i)&&(r[i]=new u.Z({count:t,property:e.properties[i],classProperty:n.properties[i],bufferViews:e.bufferViews}));this._count=t,this._class=n,this._properties=r}Object.defineProperties(c.prototype,{count:{get:function(){return this._count}},class:{get:function(){return this._class}}}),c.prototype.hasProperty=function(e){return a.Z.hasProperty(e,this._properties,this._class)},c.prototype.hasPropertyBySemantic=function(e){return a.Z.hasPropertyBySemantic(e,this._properties,this._class)},c.prototype.getPropertyIds=function(e){return a.Z.getPropertyIds(this._properties,this._class,e)},c.prototype.getProperty=function(e,t){i.Z.typeOf.string("propertyId",t);const n=this._properties[t];let o;return o=(0,s.Z)(n)?n.get(e):function(e,t){const n=e.properties;if(!(0,s.Z)(n))return;const i=n[t];if((0,s.Z)(i)&&(0,s.Z)(i.default)){let e=i.default;return i.isArray&&(e=(0,r.Z)(e,!0)),e=i.normalize(e),i.unpackVectorAndMatrixTypes(e)}}(this._class,t),o},c.prototype.setProperty=function(e,t,n){i.Z.typeOf.string("propertyId",t);const r=this._properties[t];return!!(0,s.Z)(r)&&(r.set(e,n),!0)},c.prototype.getPropertyBySemantic=function(e,t){let n;i.Z.typeOf.string("semantic",t);const r=this._class.propertiesBySemantic;if((0,s.Z)(r)&&(n=r[t]),(0,s.Z)(n))return this.getProperty(e,n.id)},c.prototype.setPropertyBySemantic=function(e,t,n){let r;i.Z.typeOf.string("semantic",t);const o=this._class.propertiesBySemantic;return(0,s.Z)(o)&&(r=o[t]),!!(0,s.Z)(r)&&this.setProperty(e,r.id,n)},c.prototype.getPropertyTypedArray=function(e){i.Z.typeOf.string("propertyId",e);const t=this._properties[e];if((0,s.Z)(t))return t.getTypedArray()},c.prototype.getPropertyTypedArrayBySemantic=function(e){let t;i.Z.typeOf.string("semantic",e);const n=this._class.propertiesBySemantic;if((0,s.Z)(n)&&(t=n[e]),(0,s.Z)(t))return this.getPropertyTypedArray(t.id)};const l=c},77085:(e,t,n)=>{n.d(t,{Z:()=>A});var i=n(17497),r=n(55077),o=n(44990),s=n(88779),a=n(54485),u=n(20176),c=n(74834),l=n(16383),d=n(53513),h=n(76336),p=n(81072),f=n(82837);function _(e){const t=(e=(0,s.Z)(e,s.Z.EMPTY_OBJECT)).count,n=e.property,r=e.classProperty,o=e.bufferViews;i.Z.typeOf.number.greaterThan("options.count",t,0),i.Z.typeOf.object("options.property",n),i.Z.typeOf.object("options.classProperty",r),i.Z.typeOf.object("options.bufferViews",o);const u=r.type,c=r.isArray,d=r.isVariableLengthArray;let p=r.valueType;const _=r.enumType,T=u===f.Z.STRING,Z=u===f.Z.BOOLEAN;let y;if(d){let e=(0,s.Z)(n.arrayOffsetType,n.offsetType);e=(0,s.Z)(h.Z[e],h.Z.UINT32);y=new I(o[(0,s.Z)(n.arrayOffsets,n.arrayOffsetBufferView)],e,t+1)}const g=f.Z.getComponentCount(u);let A;A=d?y.get(t)-y.get(0):c?t*r.arrayLength:t;const b=g*A;let E,S;if(T){let e=(0,s.Z)(n.stringOffsetType,n.offsetType);e=(0,s.Z)(h.Z[e],h.Z.UINT32);E=new I(o[(0,s.Z)(n.stringOffsets,n.stringOffsetBufferView)],e,b+1)}(T||Z)&&(p=h.Z.UINT8),S=T?E.get(b)-E.get(0):Z?Math.ceil(b/8):b;const N=new I(o[(0,s.Z)(n.values,n.bufferView)],p,S);let O=n.offset,C=n.scale;const v=r.hasValueTransform||(0,a.Z)(O)||(0,a.Z)(C);let D,M;O=(0,s.Z)(O,r.offset),C=(0,s.Z)(C,r.scale),O=m(O),C=m(C);const x=this;T?D=function(e){return function(e,t,n){const i=n.get(e),r=n.get(e+1)-i;return(0,l.Z)(t.typedArray,i,r)}(e,x._values,x._stringOffsets)}:Z?(D=function(e){return function(e,t){const n=e>>3,i=e%8;return 1==(t.typedArray[n]>>i&1)}(e,x._values)},M=function(e,t){!function(e,t,n){const i=e>>3,r=e%8;n?t.typedArray[i]|=1<<r:t.typedArray[i]&=~(1<<r)}(e,x._values,t)}):(0,a.Z)(_)?(D=function(e){const t=x._values.get(e);return _.namesByValue[t]},M=function(e,t){const n=_.valuesByName[t];x._values.set(e,n)}):(D=function(e){return x._values.get(e)},M=function(e,t){x._values.set(e,t)}),this._arrayOffsets=y,this._stringOffsets=E,this._values=N,this._classProperty=r,this._count=t,this._vectorComponentCount=g,this._min=n.min,this._max=n.max,this._offset=O,this._scale=C,this._hasValueTransform=v,this._getValue=D,this._setValue=M,this._unpackedValues=void 0,this._extras=n.extras,this._extensions=n.extensions}function m(e){if(!Array.isArray(e))return e;const t=[];for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)?t.push.apply(t,i):t.push(i)}return t}function T(e,t){const n=e._count;if(!(0,a.Z)(t)||t<0||t>=n){const e=n-1;throw new u.Z(`index is required and between zero and count - 1. Actual value: ${e}`)}}function Z(e,t,n){let i,r;if(t.isVariableLengthArray){i=e._arrayOffsets.get(n),r=e._arrayOffsets.get(n+1)-i;const o=f.Z.getComponentCount(t.type);i*=o,r*=o}else{const o=(0,s.Z)(t.arrayLength,1)*e._vectorComponentCount;i=n*o,r=o}const o=new Array(r);for(let t=0;t<r;t++)o[t]=e._getValue(i+t);return o}function y(e){if((0,a.Z)(e._unpackedValues))return!1;const t=e._classProperty,n=t.type,i=t.valueType;return n===f.Z.STRING||(i===h.Z.INT64&&!c.Z.supportsBigInt64Array()||i===h.Z.UINT64&&!c.Z.supportsBigUint64Array())}function g(e){e._unpackedValues=function(e){const t=e._count,n=new Array(t),i=e._classProperty,r=i.isArray,o=i.type,s=f.Z.getComponentCount(o);if(!r&&1===s){for(let i=0;i<t;++i)n[i]=e._getValue(i);return n}for(let r=0;r<t;r++)n[r]=Z(e,i,r);return n}(e),e._arrayOffsets=void 0,e._stringOffsets=void 0,e._values=void 0}function I(e,t,n){const i=this;let r,s,u;if(t===h.Z.INT64)c.Z.supportsBigInt()?c.Z.supportsBigInt64Array()?(r=new BigInt64Array(e.buffer,e.byteOffset,n),u=function(e,t){i.typedArray[e]=BigInt(t)}):(r=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e;let r=BigInt(0);const o=(128&n.getUint8(i+7))>0;let s=!0;for(let e=0;e<8;++e){let t=n.getUint8(i+e);o&&(s?0!==t&&(t=255&~(t-1),s=!1):t=255&~t),r+=BigInt(t)*(BigInt(1)<<BigInt(8*e))}return o&&(r=-r),r}(e,i)}):((0,d.Z)("INT64 type is not fully supported on this platform. Values greater than 2^53 - 1 or less than -(2^53 - 1) may lose precision when read."),r=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e;let r=0;const o=(128&n.getUint8(i+7))>0;let s=!0;for(let e=0;e<8;++e){let t=n.getUint8(i+e);o&&(s?0!==t&&(t=255&~(t-1),s=!1):t=255&~t),r+=t*Math.pow(256,e)}return o&&(r=-r),r}(e,i)});else if(t===h.Z.UINT64)c.Z.supportsBigInt()?c.Z.supportsBigUint64Array()?(r=new BigUint64Array(e.buffer,e.byteOffset,n),u=function(e,t){i.typedArray[e]=BigInt(t)}):(r=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e,r=BigInt(n.getUint32(i,!0)),o=BigInt(n.getUint32(i+4,!0));return r+BigInt(4294967296)*o}(e,i)}):((0,d.Z)("UINT64 type is not fully supported on this platform. Values greater than 2^53 - 1 may lose precision when read."),r=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e;return n.getUint32(i,!0)+4294967296*n.getUint32(i+4,!0)}(e,i)});else{const s=function(e){switch(e){case h.Z.INT8:return o.Z.BYTE;case h.Z.UINT8:return o.Z.UNSIGNED_BYTE;case h.Z.INT16:return o.Z.SHORT;case h.Z.UINT16:return o.Z.UNSIGNED_SHORT;case h.Z.INT32:return o.Z.INT;case h.Z.UINT32:return o.Z.UNSIGNED_INT;case h.Z.FLOAT32:return o.Z.FLOAT;case h.Z.FLOAT64:return o.Z.DOUBLE}}(t);r=o.Z.createArrayBufferView(s,e.buffer,e.byteOffset,n),u=function(e,t){i.typedArray[e]=t}}(0,a.Z)(s)||(s=function(e){return i.typedArray[e]}),this.typedArray=r,this.dataView=new DataView(r.buffer,r.byteOffset),this.get=s,this.set=u,this._componentType=t}Object.defineProperties(_.prototype,{hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),_.prototype.get=function(e){T(this,e);let t=function(e,t){y(e)&&g(e);const n=e._classProperty,i=n.isArray,o=n.type,s=f.Z.getComponentCount(o);if((0,a.Z)(e._unpackedValues)){const n=e._unpackedValues[t];return i?(0,r.Z)(n,!0):n}if(!i&&1===s)return e._getValue(t);return Z(e,n,t)}(this,e);return t=this._classProperty.handleNoData(t),(0,a.Z)(t)?(t=this._classProperty.normalize(t),t=function(e,t){const n=e._classProperty.isVariableLengthArray;if(!e._hasValueTransform||n)return t;return p.Z.valueTransformInPlace(t,e._offset,e._scale,h.Z.applyValueTransform)}(this,t),this._classProperty.unpackVectorAndMatrixTypes(t)):(t=this._classProperty.default,this._classProperty.unpackVectorAndMatrixTypes(t))},_.prototype.set=function(e,t){const n=this._classProperty;i.Z.defined("value",t),T(this,e);const o=n.validate(t);if((0,a.Z)(o))throw new u.Z(o);t=function(e,t){const n=e._classProperty.isVariableLengthArray;if(!e._hasValueTransform||n)return t;return p.Z.valueTransformInPlace(t,e._offset,e._scale,h.Z.unapplyValueTransform)}(this,t=n.packVectorAndMatrixTypes(t)),function(e,t,n){(function(e,t,n){if(y(e))return!0;const i=e._arrayOffsets;if((0,a.Z)(i)){if(i.get(t+1)-i.get(t)!==n.length)return!0}return!1})(e,t,n)&&g(e);const i=e._classProperty,o=i.isArray,u=i.type,c=f.Z.getComponentCount(u);if((0,a.Z)(e._unpackedValues))return i.isArray&&(n=(0,r.Z)(n,!0)),void(e._unpackedValues[t]=n);if(!o&&1===c)return void e._setValue(t,n);let l,d;if(i.isVariableLengthArray)l=e._arrayOffsets.get(t),d=e._arrayOffsets.get(t+1)-l;else{const n=(0,s.Z)(i.arrayLength,1)*e._vectorComponentCount;l=t*n,d=n}for(let t=0;t<d;++t)e._setValue(l+t,n[t])}(this,e,t=n.unnormalize(t))},_.prototype.getTypedArray=function(){if((0,a.Z)(this._values))return this._values.typedArray};const A=_},82837:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(17497),r=n(59015),o=n(93517),s=n(90868),a=n(20176),u=n(40734),c=n(39109),l=n(71118);const d={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",BOOLEAN:"BOOLEAN",STRING:"STRING",ENUM:"ENUM",isVectorType:function(e){switch(i.Z.typeOf.string("type",e),e){case d.VEC2:case d.VEC3:case d.VEC4:return!0;default:return!1}},isMatrixType:function(e){switch(i.Z.typeOf.string("type",e),e){case d.MAT2:case d.MAT3:case d.MAT4:return!0;default:return!1}},getComponentCount:function(e){switch(i.Z.typeOf.string("type",e),e){case d.SCALAR:case d.STRING:case d.ENUM:case d.BOOLEAN:return 1;case d.VEC2:return 2;case d.VEC3:return 3;case d.VEC4:case d.MAT2:return 4;case d.MAT3:return 9;case d.MAT4:return 16;default:throw new a.Z(`Invalid metadata type ${e}`)}},getMathType:function(e){switch(e){case d.VEC2:return r.Z;case d.VEC3:return o.Z;case d.VEC4:return s.Z;case d.MAT2:return u.Z;case d.MAT3:return c.Z;case d.MAT4:return l.Z;default:return}}},h=Object.freeze(d)},28598:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(88779),r=n(92893),o=n(97262),s=n(13715),a=n(42279);function u(e,t,n){this._name=n.name,this._startTime=o.Z.clone(e.startTime),this._delay=(0,i.Z)(e.delay,0),this._stopTime=e.stopTime,this.removeOnStop=(0,i.Z)(e.removeOnStop,!1),this._multiplier=(0,i.Z)(e.multiplier,1),this._reverse=(0,i.Z)(e.reverse,!1),this._loop=(0,i.Z)(e.loop,s.Z.NONE),this._animationTime=e.animationTime,this._prevAnimationDelta=void 0,this.start=new r.Z,this.update=new r.Z,this.stop=new r.Z,this._state=a.Z.STOPPED,this._runtimeAnimation=n,this._computedStartTime=void 0,this._duration=void 0;const u=this;this._raiseStartEvent=function(){u.start.raiseEvent(t,u)},this._updateEventTime=0,this._raiseUpdateEvent=function(){u.update.raiseEvent(t,u,u._updateEventTime)},this._raiseStopEvent=function(){u.stop.raiseEvent(t,u)}}Object.defineProperties(u.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}});const c=u},43344:(e,t,n)=>{n.d(t,{Z:()=>S});var i=n(93517),r=n(44990),o=n(7317),s=n(88779),a=n(54485),u=n(94292),c=n(71118),l=n(99949),d=n(20291),h=n(49273),p=n(69070),f=n(95411),_=n(47428),m=n(57727),T=n(91257);function Z(){}const y=/^data\:/i;function g(e,t){const n=e.gltfInternal,i=n.buffers,r=n.bufferViews[t.bufferView],o=i[r.buffer],s=r.byteOffset+t.byteOffset,a=t.count*(0,m.Z)(t.type),u=y.test(o.uri)?"":o.uri;return`${e.cacheKey}//${u}/${s}/${a}`}const I={};Z.getAnimationParameterValues=function(e,t){const n=g(e,t);let o=I[n];if(!(0,a.Z)(o)){const u=e.gltfInternal,c=u.buffers,l=u.bufferViews[t.bufferView],h=c[l.buffer].extras._pipeline.source,p=t.componentType,f=t.type,T=(0,m.Z)(f),Z=t.count,y=(0,_.Z)(u,t);o=new Array(Z);const g=(0,s.Z)(t.byteOffset,0);let A=l.byteOffset+g;for(let e=0;e<Z;e++){const t=r.Z.createArrayBufferView(p,h.buffer,h.byteOffset+A,T);"SCALAR"===f?o[e]=t[0]:"VEC3"===f?o[e]=i.Z.fromArray(t):"VEC4"===f&&(o[e]=d.Z.unpack(t)),A+=y}(0,a.Z)(e.cacheKey)&&(I[n]=o)}return o};const A={};function b(e){this._spline=e,this._lastTimeIndex=0}b.prototype.findTimeInterval=p.Z.prototype.findTimeInterval,b.prototype.evaluate=function(e,t){const n=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),i=this._spline.times,r=e>=i[n+1]?i[n+1]:i[n];return this._spline.evaluate(r,t)},Object.defineProperties(b.prototype,{times:{get:function(){return this._spline.times}}}),b.prototype.wrapTime=function(e){return this._spline.wrapTime(e)},b.prototype.clampTime=function(e){return this._spline.clampTime(e)},Z.getAnimationSpline=function(e,t,n,i,r,s,c,d){const p=function(e,t,n){return`${e.cacheKey}//${t}/${n}`}(e,t,i);let f=A[p];if(!(0,a.Z)(f)){const t=s,n=d;1===t.length&&1===n.length?f=new o.Z(n[0]):"LINEAR"!==r.interpolation&&"STEP"!==r.interpolation||("translation"===c||"scale"===c?f=new u.Z({times:t,points:n}):"rotation"===c?f=new h.Z({times:t,points:n}):"weights"===c&&(f=new l.Z({times:t,weights:n})),(0,a.Z)(f)&&"STEP"===r.interpolation&&(f=new b(f))),(0,a.Z)(e.cacheKey)&&(A[p]=f)}return f};const E={};Z.getSkinInverseBindMatrices=function(e,t){const n=g(e,t);let i=E[n];if(!(0,a.Z)(i)){const o=e.gltfInternal,s=o.buffers,a=o.bufferViews[t.bufferView],u=s[a.buffer].extras._pipeline.source,l=t.componentType,d=t.type,h=t.count,p=(0,_.Z)(o,t);let Z=a.byteOffset+t.byteOffset;const y=(0,m.Z)(d);if(i=new Array(h),l===f.Z.FLOAT&&d===T.Z.MAT4)for(let e=0;e<h;++e){const t=r.Z.createArrayBufferView(l,u.buffer,u.byteOffset+Z,y);i[e]=c.Z.fromArray(t),Z+=p}E[n]=i}return i};const S=Z},25308:(e,t,n)=>{n.d(t,{Z:()=>T});var i=n(88779),r=n(54485),o=n(20176),s=n(92893),a=n(97262),u=n(22874),c=n(28598),l=n(13715),d=n(42279);function h(e){this.animationAdded=new s.Z,this.animationRemoved=new s.Z,this.animateWhilePaused=!1,this._model=e,this._scheduledAnimations=[],this._previousTime=void 0}function p(e,t,n){const i=e._model,r=i._runtime.animations[t],o=new c.Z(n,i,r);return e._scheduledAnimations.push(o),e.animationAdded.raiseEvent(i,o),o}function f(e,t){const n=e.channelEvaluators,i=n.length;for(let e=0;e<i;++e)n[e](t)}Object.defineProperties(h.prototype,{length:{get:function(){return this._scheduledAnimations.length}}}),h.prototype.add=function(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT);const t=this._model._runtime.animations;if(!(0,r.Z)(t))throw new o.Z("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if(!(0,r.Z)(e.name)&&!(0,r.Z)(e.index))throw new o.Z("Either options.name or options.index must be defined.");if((0,r.Z)(e.multiplier)&&e.multiplier<=0)throw new o.Z("options.multiplier must be greater than zero.");if((0,r.Z)(e.index)&&(e.index>=t.length||e.index<0))throw new o.Z("options.index must be a valid animation index.");if((0,r.Z)(e.index))return p(this,e.index,e);let n;const s=t.length;for(let i=0;i<s;++i)if(t[i].name===e.name){n=i;break}if(!(0,r.Z)(n))throw new o.Z("options.name must be a valid animation name.");return p(this,n,e)},h.prototype.addAll=function(e){if(e=(0,i.Z)(e,i.Z.EMPTY_OBJECT),!(0,r.Z)(this._model._runtime.animations))throw new o.Z("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if((0,r.Z)(e.multiplier)&&e.multiplier<=0)throw new o.Z("options.multiplier must be greater than zero.");const t=[],n=this._model._runtime.animations.length;for(let i=0;i<n;++i)t.push(p(this,i,e));return t},h.prototype.remove=function(e){if((0,r.Z)(e)){const t=this._scheduledAnimations,n=t.indexOf(e);if(-1!==n)return t.splice(n,1),this.animationRemoved.raiseEvent(this._model,e),!0}return!1},h.prototype.removeAll=function(){const e=this._model,t=this._scheduledAnimations,n=t.length;this._scheduledAnimations=[];for(let i=0;i<n;++i)this.animationRemoved.raiseEvent(e,t[i])},h.prototype.contains=function(e){return!!(0,r.Z)(e)&&-1!==this._scheduledAnimations.indexOf(e)},h.prototype.get=function(e){if(!(0,r.Z)(e))throw new o.Z("index is required.");return this._scheduledAnimations[e]};const _=[];function m(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}h.prototype.update=function(e){const t=this._scheduledAnimations;let n=t.length;if(0===n)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&a.Z.equals(e.time,this._previousTime))return!1;this._previousTime=a.Z.clone(e.time,this._previousTime);let o=!1;const s=e.time,c=this._model;for(let c=0;c<n;++c){const n=t[c],h=n._runtimeAnimation;(0,r.Z)(n._computedStartTime)||(n._computedStartTime=a.Z.addSeconds((0,i.Z)(n.startTime,s),n.delay,new a.Z)),(0,r.Z)(n._duration)||(n._duration=h.stopTime*(1/n.multiplier));const p=n._computedStartTime,m=n._duration,T=n.stopTime,Z=a.Z.lessThanOrEquals(p,s),y=(0,r.Z)(T)&&a.Z.greaterThan(s,T);let g=0;if(0!==m){const e=a.Z.secondsDifference(y?T:s,p);g=(0,r.Z)(n._animationTime)?n._animationTime(m,e):e/m}const I=n.loop===l.Z.REPEAT||n.loop===l.Z.MIRRORED_REPEAT,A=(Z||I&&!(0,r.Z)(n.startTime))&&(g<=1||I)&&!y;if(g===n._prevAnimationDelta){if(A!==(n._state===d.Z.STOPPED))continue}if(n._prevAnimationDelta=g,A||n._state===d.Z.ANIMATING){if(A&&n._state===d.Z.STOPPED&&(n._state=d.Z.ANIMATING,n.start.numberOfListeners>0&&e.afterRender.push(n._raiseStartEvent)),n.loop===l.Z.REPEAT)g-=Math.floor(g);else if(n.loop===l.Z.MIRRORED_REPEAT){const e=Math.floor(g),t=g-e;g=e%2==1?1-t:t}n.reverse&&(g=1-g);let t=g*m*n.multiplier;t=u.Z.clamp(t,h.startTime,h.stopTime),f(h,t),n.update.numberOfListeners>0&&(n._updateEventTime=t,e.afterRender.push(n._raiseUpdateEvent)),o=!0,A||(n._state=d.Z.STOPPED,n.stop.numberOfListeners>0&&e.afterRender.push(n._raiseStopEvent),n.removeOnStop&&_.push(n))}}n=_.length;for(let i=0;i<n;++i){const n=_[i];t.splice(t.indexOf(n),1),e.afterRender.push(m(this,c,n))}return _.length=0,o};const T=h},13715:(e,t,n)=>{n.d(t,{Z:()=>i});const i=Object.freeze({NONE:0,REPEAT:1,MIRRORED_REPEAT:2})},42279:(e,t,n)=>{n.d(t,{Z:()=>i});const i=Object.freeze({STOPPED:0,ANIMATING:1})},53839:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(46959),r=n(93517),o=n(90868),s=n(39109),a=n(71118);const u={};function c(){this.credits=[]}function l(){this.baseColorTexture=void 0,this.metallicRoughnessTexture=void 0,this.baseColorFactor=o.Z.clone(l.DEFAULT_BASE_COLOR_FACTOR),this.metallicFactor=l.DEFAULT_METALLIC_FACTOR,this.roughnessFactor=l.DEFAULT_ROUGHNESS_FACTOR}function d(){this.diffuseTexture=void 0,this.specularGlossinessTexture=void 0,this.diffuseFactor=o.Z.clone(d.DEFAULT_DIFFUSE_FACTOR),this.specularFactor=r.Z.clone(d.DEFAULT_SPECULAR_FACTOR),this.glossinessFactor=d.DEFAULT_GLOSSINESS_FACTOR}function h(){this.metallicRoughness=new l,this.specularGlossiness=void 0,this.emissiveTexture=void 0,this.normalTexture=void 0,this.occlusionTexture=void 0,this.emissiveFactor=r.Z.clone(h.DEFAULT_EMISSIVE_FACTOR),this.alphaMode=i.Z.OPAQUE,this.alphaCutoff=.5,this.doubleSided=!1,this.unlit=!1}l.DEFAULT_BASE_COLOR_FACTOR=o.Z.ONE,l.DEFAULT_METALLIC_FACTOR=1,l.DEFAULT_ROUGHNESS_FACTOR=1,d.DEFAULT_DIFFUSE_FACTOR=o.Z.ONE,d.DEFAULT_SPECULAR_FACTOR=r.Z.ONE,d.DEFAULT_GLOSSINESS_FACTOR=1,h.DEFAULT_EMISSIVE_FACTOR=r.Z.ZERO,u.Quantization=function(){this.octEncoded=!1,this.octEncodedZXY=!1,this.normalizationRange=void 0,this.quantizedVolumeOffset=void 0,this.quantizedVolumeDimensions=void 0,this.quantizedVolumeStepSize=void 0,this.componentDatatype=void 0,this.type=void 0},u.Attribute=function(){this.name=void 0,this.semantic=void 0,this.setIndex=void 0,this.componentDatatype=void 0,this.type=void 0,this.normalized=!1,this.count=void 0,this.min=void 0,this.max=void 0,this.constant=void 0,this.quantization=void 0,this.packedTypedArray=void 0,this.buffer=void 0,this.typedArray=void 0,this.byteOffset=0,this.byteStride=void 0},u.Indices=function(){this.indexDatatype=void 0,this.count=void 0,this.buffer=void 0,this.typedArray=void 0},u.FeatureIdAttribute=function(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.setIndex=void 0,this.label=void 0,this.positionalLabel=void 0},u.FeatureIdTexture=function(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.textureReader=void 0,this.label=void 0,this.positionalLabel=void 0},u.FeatureIdImplicitRange=function(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.offset=0,this.repeat=void 0,this.label=void 0,this.positionalLabel=void 0},u.MorphTarget=function(){this.attributes=[]},u.Primitive=function(){this.attributes=[],this.morphTargets=[],this.indices=void 0,this.material=void 0,this.primitiveType=void 0,this.featureIds=[],this.propertyTextureIds=[],this.propertyAttributeIds=[]},u.Instances=function(){this.attributes=[],this.featureIds=[],this.transformInWorldSpace=!1},u.Skin=function(){this.index=void 0,this.joints=[],this.inverseBindMatrices=[]},u.Node=function(){this.name=void 0,this.index=void 0,this.children=[],this.primitives=[],this.instances=void 0,this.skin=void 0,this.matrix=void 0,this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.morphWeights=[]},u.Scene=function(){this.nodes=[]},u.AnimatedPropertyType=Object.freeze({TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"}),u.AnimationSampler=function(){this.input=[],this.interpolation=void 0,this.output=[]},u.AnimationTarget=function(){this.node=void 0,this.path=void 0},u.AnimationChannel=function(){this.sampler=void 0,this.target=void 0},u.Animation=function(){this.name=void 0,this.samplers=[],this.channels=[]},u.Asset=c,u.Components=function(){this.asset=new c,this.scene=void 0,this.nodes=[],this.skins=[],this.animations=[],this.structuralMetadata=void 0,this.upAxis=void 0,this.forwardAxis=void 0,this.transform=a.Z.clone(a.Z.IDENTITY)},u.TextureReader=function(){this.texture=void 0,this.index=void 0,this.texCoord=0,this.transform=s.Z.clone(s.Z.IDENTITY),this.channels=void 0},u.MetallicRoughness=l,u.SpecularGlossiness=d,u.Material=h;const p=u},13052:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(88779),r=n(83567),o=n(46959),s=n(995),a=n(1577);const u={name:"AlphaPipelineStage",process:function(e,t,n){const u=e.alphaOptions,c=e.model;u.pass=(0,i.Z)(u.pass,c.opaquePass);const l=e.renderStateOptions;u.pass===a.Z.TRANSLUCENT?l.blending=s.Z.ALPHA_BLEND:l.blending=s.Z.DISABLED;const d=e.shaderBuilder,h=e.uniformMap,p=u.alphaMode;p===o.Z.MASK?(d.addDefine("ALPHA_MODE_MASK",void 0,r.Z.FRAGMENT),d.addUniform("float","u_alphaCutoff",r.Z.FRAGMENT),h.u_alphaCutoff=function(){return u.alphaCutoff}):p===o.Z.BLEND?d.addDefine("ALPHA_MODE_BLEND",void 0,r.Z.FRAGMENT):d.addDefine("ALPHA_MODE_OPAQUE",void 0,r.Z.FRAGMENT)}},c=u},42042:(e,t,n)=>{n.d(t,{Z:()=>v});var i=n(81737),r=n(71743),o=n(93517),s=n(73673),a=n(17497),u=n(44990),c=n(88779),l=n(54485),d=n(2087),h=n(94335),p=n(71118),f=n(41519),_=n(53839),m=n(59137),T=n(62524),Z=n(41184),y=n(39226),g=n(34240);const I=0,A=1,b=2,E=3,S=4,N=_.Z.FeatureIdAttribute;function O(e){const t=(e=(0,c.Z)(e,c.Z.EMPTY_OBJECT)).b3dmResource;let n=e.baseResource;const r=e.arrayBuffer,o=(0,c.Z)(e.byteOffset,0),s=(0,c.Z)(e.releaseGltfJson,!1),u=(0,c.Z)(e.asynchronous,!0),d=(0,c.Z)(e.incrementallyLoadTextures,!0),h=(0,c.Z)(e.upAxis,i.Z.Y),f=(0,c.Z)(e.forwardAxis,i.Z.X),_=(0,c.Z)(e.loadAttributesAsTypedArray,!1),m=(0,c.Z)(e.loadPositionsFor2D,!1),T=(0,c.Z)(e.loadIndicesForWireframe,!1);a.Z.typeOf.object("options.b3dmResource",t),a.Z.typeOf.object("options.arrayBuffer",r),n=(0,l.Z)(n)?n:t.clone(),this._b3dmResource=t,this._baseResource=n,this._arrayBuffer=r,this._byteOffset=o,this._releaseGltfJson=s,this._asynchronous=u,this._incrementallyLoadTextures=d,this._upAxis=h,this._forwardAxis=f,this._loadAttributesAsTypedArray=_,this._loadPositionsFor2D=m,this._loadIndicesForWireframe=T,this._state=I,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=p.Z.IDENTITY}function C(e){const t=e.children.length;for(let n=0;n<t;n++)C(e.children[n]);const n=e.primitives.length;for(let t=0;t<n;t++){const n=e.primitives[t],i=m.Z.getAttributeBySemantic(n,g.Z.FEATURE_ID);if((0,l.Z)(i)){i.setIndex=0;const e=new N;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",n.featureIds.push(e)}}}(0,l.Z)(Object.create)&&(O.prototype=Object.create(y.Z.prototype),O.prototype.constructor=O),Object.defineProperties(O.prototype,{promise:{get:function(){return this._promise}},texturesLoadedPromise:{get:function(){return this._gltfLoader.texturesLoadedPromise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),O.prototype.load=function(){const e=r.Z.parse(this._arrayBuffer,this._byteOffset);let t=e.batchLength;const n=e.featureTableJson,i=e.featureTableBinary,a=e.batchTableJson,c=e.batchTableBinary,_=new s.Z(n,i);t=_.getGlobalProperty("BATCH_LENGTH"),this._batchLength=t;const m=_.getGlobalProperty("RTC_CENTER",u.Z.FLOAT,3);(0,l.Z)(m)&&(this._transform=p.Z.fromTranslation(o.Z.fromArray(m))),this._batchTable={json:a,binary:c};const y=new h.Z({typedArray:e.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadPositionsFor2D:this._loadPositionsFor2D,loadIndicesForWireframe:this._loadIndicesForWireframe,renameBatchIdSemantic:!0});this._gltfLoader=y,this._state=A;const g=this;return y.load(),this._promise=y.promise.then((function(){if(g.isDestroyed())return;const e=y.components;return e.transform=g._transform,function(e,t){const n=e._batchTable,i=e._batchLength;if(0===i)return;let r;if((0,l.Z)(n.json))r=(0,T.Z)({count:i,batchTable:n.json,binaryBody:n.binary});else{const e=new Z.Z({name:f.Z.BATCH_TABLE_CLASS_NAME,count:i});r=new d.Z({schema:{},propertyTables:[e]})}const o=t.scene.nodes,s=o.length;for(let e=0;e<s;e++)C(o[e]);t.structuralMetadata=r}(g,e),g._components=e,g._state=E,g})).catch((function(e){if(!g.isDestroyed())return function(e,t){e.unload(),e._state=S;const n="Failed to load b3dm";return t=e.getError(n,t),Promise.reject(t)}(g,e)})),this._promise},O.prototype.process=function(e){a.Z.typeOf.object("frameState",e),this._state===A&&(this._state=b),this._state===b&&this._gltfLoader.process(e)},O.prototype.unload=function(){(0,l.Z)(this._gltfLoader)&&this._gltfLoader.unload(),this._components=void 0};const v=O},89639:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(51138),r=n(88779);const o={name:"BatchTexturePipelineStage",process:function(e,t,n){const o=e.shaderBuilder,s={},a=e.model,u=a.featureTables[a.featureTableId],c=u.featuresLength;o.addUniform("int","model_featuresLength"),s.model_featuresLength=function(){return c};const l=u.batchTexture;o.addUniform("sampler2D","model_batchTexture"),s.model_batchTexture=function(){return(0,r.Z)(l.batchTexture,l.defaultTexture)},o.addUniform("vec4","model_textureStep"),s.model_textureStep=function(){return l.textureStep},l.textureDimensions.y>1&&(o.addDefine("MULTILINE_BATCH_TEXTURE"),o.addUniform("vec2","model_textureDimensions"),s.model_textureDimensions=function(){return l.textureDimensions}),e.uniformMap=(0,i.Z)(s,e.uniformMap)}},s=o},94452:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(36123),r=n(88359),o=n(1577),s=n(30562),a=n(83567),u=n(59964),c=n(61610),l=n(46959),d=n(54485);const h={name:"CPUStylingPipelineStage",process:function(e,t,n){const h=e.model,p=e.shaderBuilder;p.addVertexLines([i.Z]),p.addFragmentLines([r.Z]),p.addDefine("USE_CPU_STYLING",void 0,a.Z.BOTH),(0,d.Z)(h.color)||(p.addUniform("float",c.Z.COLOR_BLEND_UNIFORM_NAME,a.Z.FRAGMENT),e.uniformMap[c.Z.COLOR_BLEND_UNIFORM_NAME]=function(){return s.Z.getColorBlend(h.colorBlendMode,h.colorBlendAmount)}),p.addUniform("bool","model_commandTranslucent",a.Z.BOTH),e.uniformMap.model_commandTranslucent=function(){return e.alphaOptions.pass===o.Z.TRANSLUCENT};const f=h.featureTables[h.featureTableId],_=u.Z.getStyleCommandsNeeded(f.featuresLength,f.batchTexture.translucentFeaturesLength);_!==u.Z.ALL_OPAQUE&&(e.alphaOptions.alphaMode=l.Z.BLEND),e.styleCommandsNeeded=_}},p=h},82060:(e,t,n)=>{n.d(t,{Z:()=>d});var i=n(17497),r=n(88779),o=n(54485),s=n(90332),a=n(20176),u=n(32347),c=n(74495),l=n(12691);function d(e){e=(0,r.Z)(e,r.Z.EMPTY_OBJECT),this.mode=(0,r.Z)(e.mode,u.Z.MODIFY_MATERIAL),this.lightingModel=e.lightingModel,this.uniforms=(0,r.Z)(e.uniforms,r.Z.EMPTY_OBJECT),this.varyings=(0,r.Z)(e.varyings,r.Z.EMPTY_OBJECT),this.vertexShaderText=e.vertexShaderText,this.fragmentShaderText=e.fragmentShaderText,this.isTranslucent=(0,r.Z)(e.isTranslucent,!1),this._textureManager=new l.Z,this._defaultTexture=void 0,this.uniformMap=function(e){const t=e.uniforms,n={};for(const i in t)if(t.hasOwnProperty(i)){const r=t[i],o=r.type;if(o===c.Z.SAMPLER_CUBE)throw new a.Z("CustomShader does not support samplerCube uniforms");o===c.Z.SAMPLER_2D?(e._textureManager.loadTexture2D(i,r.value),n[i]=h(e,i)):n[i]=p(e,i)}return n}(this),this.usedVariablesVertex={attributeSet:{},featureIdSet:{},metadataSet:{}},this.usedVariablesFragment={attributeSet:{},featureIdSet:{},metadataSet:{},materialSet:{}},function(e){const t=/[vf]sInput\.attributes\.(\w+)/g,n=/[vf]sInput\.featureIds\.(\w+)/g,i=/[vf]sInput\.metadata.(\w+)/g;let r;const s=e.vertexShaderText;(0,o.Z)(s)&&(r=e.usedVariablesVertex.attributeSet,f(s,t,r),r=e.usedVariablesVertex.featureIdSet,f(s,n,r),r=e.usedVariablesVertex.metadataSet,f(s,i,r));const a=e.fragmentShaderText;if((0,o.Z)(a)){r=e.usedVariablesFragment.attributeSet,f(a,t,r),r=e.usedVariablesFragment.featureIdSet,f(a,n,r),r=e.usedVariablesFragment.metadataSet,f(a,i,r);f(a,/material\.(\w+)/g,e.usedVariablesFragment.materialSet)}}(this),function(e){const t=e.usedVariablesVertex.attributeSet;m(t,"position","positionMC","vertex"),m(t,"normal","normalMC","vertex"),m(t,"tangent","tangentMC","vertex"),m(t,"bitangent","bitangentMC","vertex"),m(t,"positionWC","positionMC","vertex"),m(t,"positionEC","positionMC","vertex"),m(t,"normalEC","normalMC","vertex"),m(t,"tangentEC","tangentMC","vertex"),m(t,"bitangentEC","bitangentMC","vertex");const n=e.usedVariablesFragment.attributeSet;m(n,"position","positionEC","fragment"),m(n,"normal","normalEC","fragment"),m(n,"tangent","tangentEC","fragment"),m(n,"bitangent","bitangentEC","fragment"),m(n,"normalMC","normalEC","fragment"),m(n,"tangentMC","tangentEC","fragment"),m(n,"bitangentMC","bitangentEC","fragment")}(this)}function h(e,t){return function(){return(0,r.Z)(e._textureManager.getTexture(t),e._defaultTexture)}}function p(e,t){return function(){return e.uniforms[t].value}}function f(e,t,n){let i;for(;null!==(i=t.exec(e));){n[i[1]]=!0}}function _(e){return/^.*MC$/.test(e)?`${e} (model coordinates)`:/^.*WC$/.test(e)?`${e} (Cartesian world coordinates)`:/^.*EC$/.test(e)?`${e} (eye coordinates)`:e}function m(e,t,n,i){if(e.hasOwnProperty(t)){const e=`${_(t)} is not available in the ${i} shader. Did you mean ${_(n)} instead?`;throw new a.Z(e)}}d.prototype.setUniform=function(e,t){if(i.Z.typeOf.string("uniformName",e),i.Z.defined("value",t),!(0,o.Z)(this.uniforms[e]))throw new a.Z(`Uniform ${e} must be declared in the CustomShader constructor.`);const n=this.uniforms[e];n.type===c.Z.SAMPLER_2D?this._textureManager.loadTexture2D(e,t):(0,o.Z)(t.clone)?n.value=t.clone(n.value):n.value=t},d.prototype.update=function(e){this._defaultTexture=e.context.defaultTexture,this._textureManager.update(e)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){this._textureManager=this._textureManager&&this._textureManager.destroy(),(0,s.Z)(this)}},32347:(e,t,n)=>{n.d(t,{Z:()=>r});const i={MODIFY_MATERIAL:"MODIFY_MATERIAL",REPLACE_MATERIAL:"REPLACE_MATERIAL",getDefineName:function(e){return`CUSTOM_SHADER_${e}`}},r=Object.freeze(i)},86461:(e,t,n)=>{n.d(t,{Z:()=>I});var i=n(51138),r=n(54485),o=n(53513),s=n(83567),a=n(1577),u=n(87289),c=n(9434),l=n(46959),d=n(32347),h=n(92885),p=n(37463),f=n(59137);const _={};_.name="CustomShaderPipelineStage",_.STRUCT_ID_ATTRIBUTES_VS="AttributesVS",_.STRUCT_ID_ATTRIBUTES_FS="AttributesFS",_.STRUCT_NAME_ATTRIBUTES="Attributes",_.STRUCT_ID_VERTEX_INPUT="VertexInput",_.STRUCT_NAME_VERTEX_INPUT="VertexInput",_.STRUCT_ID_FRAGMENT_INPUT="FragmentInput",_.STRUCT_NAME_FRAGMENT_INPUT="FragmentInput",_.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS="initializeInputStructVS",_.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS="void initializeInputStruct(out VertexInput vsInput, ProcessedAttributes attributes)",_.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS="initializeInputStructFS",_.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS="void initializeInputStruct(out FragmentInput fsInput, ProcessedAttributes attributes)",_.process=function(e,t,n){const o=e.shaderBuilder,m=e.model.customShader;(0,r.Z)(m.lightingModel)&&(e.lightingOptions.lightingModel=m.lightingModel);const T=e.alphaOptions;m.isTranslucent?(T.pass=a.Z.TRANSLUCENT,T.alphaMode=l.Z.BLEND):(T.pass=void 0,T.alphaMode=l.Z.OPAQUE);const y=function(e,t){const n={enabled:!1},i={enabled:!1},o=function(e){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=f.Z.getAttributeInfo(i);t[r.variableName]=r}return t}(t.attributes);(0,r.Z)(e.vertexShaderText)&&function(e,t,n){const i=g(t,e.usedVariablesVertex.attributeSet,!1),o=i.addToShader,s=i.missingAttributes;let a,u;const c=[],l=[];for(a in o)if(o.hasOwnProperty(a)){const e=[o[a].glslType,a];c.push(e),u=`vsInput.attributes.${a} = attributes.${a};`,l.push(u)}for(let e=0;e<s.length;e++){a=s[e];const t=Z(a);if(!(0,r.Z)(t))return void _._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveVS",`Primitive is missing attribute ${a}, disabling custom vertex shader`);c.push(t.attributeField),u=`vsInput.attributes.${a} = ${t.value};`,l.push(u)}n.enabled=!0,n.attributeFields=c,n.initializationLines=l}(e,o,n);(0,r.Z)(e.fragmentShaderText)&&function(e,t,n){const i=g(t,e.usedVariablesFragment.attributeSet,!0),o=i.addToShader,s=i.missingAttributes;let a,u;const c=[],l=[];for(a in o)if(o.hasOwnProperty(a)){const e=[o[a].glslType,a];c.push(e),u=`fsInput.attributes.${a} = attributes.${a};`,l.push(u)}for(let e=0;e<s.length;e++){a=s[e];const t=Z(a);if(!(0,r.Z)(t))return void _._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveFS",`Primitive is missing attribute ${a}, disabling custom fragment shader.`);c.push(t.attributeField),u=`fsInput.attributes.${a} = ${t.value};`,l.push(u)}const d=function(e){const t=[],n=[],i=e.usedVariablesFragment.attributeSet;i.hasOwnProperty("positionWC")&&(t.push(["vec3","positionWC"]),n.push("fsInput.attributes.positionWC = attributes.positionWC;"));i.hasOwnProperty("positionEC")&&(t.push(["vec3","positionEC"]),n.push("fsInput.attributes.positionEC = attributes.positionEC;"));return{attributeFields:t,initializationLines:n}}(e);n.enabled=!0,n.attributeFields=c.concat(d.attributeFields),n.initializationLines=d.initializationLines.concat(l)}(e,o,i);const s=e.usedVariablesFragment.attributeSet.hasOwnProperty("positionWC")&&i.enabled;return{vertexLines:n,fragmentLines:i,vertexLinesEnabled:n.enabled,fragmentLinesEnabled:i.enabled,customShaderEnabled:n.enabled||i.enabled,shouldComputePositionWC:s}}(m,t);if(!y.customShaderEnabled)return;if(function(e,t,n){const i=n.vertexLines;i.enabled&&(!function(e,t){let n,i=_.STRUCT_ID_ATTRIBUTES_VS;e.addStruct(i,_.STRUCT_NAME_ATTRIBUTES,s.Z.VERTEX);const r=t.attributeFields;for(n=0;n<r.length;n++){const t=r[n],o=t[0],s=t[1];e.addStructField(i,o,s)}i=_.STRUCT_ID_VERTEX_INPUT,e.addStruct(i,_.STRUCT_NAME_VERTEX_INPUT,s.Z.VERTEX),e.addStructField(i,_.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(i,h.Z.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(i,p.Z.STRUCT_NAME_METADATA,"metadata");const o=_.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS;e.addFunction(o,_.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS,s.Z.VERTEX);const a=t.initializationLines;e.addFunctionLines(o,a)}(e,i),e.addVertexLines(["#line 0",t.vertexShaderText,u.Z]));const r=n.fragmentLines;r.enabled&&(!function(e,t){let n,i,r,o,a=_.STRUCT_ID_ATTRIBUTES_FS;e.addStruct(a,_.STRUCT_NAME_ATTRIBUTES,s.Z.FRAGMENT);const u=t.attributeFields;for(n=0;n<u.length;n++)i=u[n],r=i[0],o=i[1],e.addStructField(a,r,o);a=_.STRUCT_ID_FRAGMENT_INPUT,e.addStruct(a,_.STRUCT_NAME_FRAGMENT_INPUT,s.Z.FRAGMENT),e.addStructField(a,_.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(a,h.Z.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(a,p.Z.STRUCT_NAME_METADATA,"metadata");const c=_.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS;e.addFunction(c,_.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS,s.Z.FRAGMENT);const l=t.initializationLines;e.addFunctionLines(c,l)}(e,r),e.addFragmentLines(["#line 0",t.fragmentShaderText,c.Z]))}(o,m,y),y.shouldComputePositionWC&&o.addDefine("COMPUTE_POSITION_WC",void 0,s.Z.BOTH),(0,r.Z)(m.vertexShaderText)&&o.addDefine("HAS_CUSTOM_VERTEX_SHADER",void 0,s.Z.VERTEX),(0,r.Z)(m.fragmentShaderText)){o.addDefine("HAS_CUSTOM_FRAGMENT_SHADER",void 0,s.Z.FRAGMENT);const e=d.Z.getDefineName(m.mode);o.addDefine(e,void 0,s.Z.FRAGMENT)}const I=m.uniforms;for(const e in I)if(I.hasOwnProperty(e)){const t=I[e];o.addUniform(t.type,e)}const A=m.varyings;for(const e in A)if(A.hasOwnProperty(e)){const t=A[e];o.addVarying(t,e)}e.uniformMap=(0,i.Z)(e.uniformMap,m.uniformMap)};const m={position:"vec3",normal:"vec3",tangent:"vec3",bitangent:"vec3",texCoord:"vec2",color:"vec4",joints:"ivec4",weights:"vec4"},T={position:"vec3(0.0)",normal:"vec3(0.0, 0.0, 1.0)",tangent:"vec3(1.0, 0.0, 0.0)",bitangent:"vec3(0.0, 1.0, 0.0)",texCoord:"vec2(0.0)",color:"vec4(1.0)",joints:"ivec4(0)",weights:"vec4(0.0)"};function Z(e){let t=e.replace(/_[0-9]+$/,"");t=t.replace(/(MC|EC)$/,"");const n=m[t],i=T[t];if((0,r.Z)(n))return{attributeField:[n,e],value:i}}const y={positionWC:!0,positionEC:!0};function g(e,t,n){let i,r;const o={};for(r in e)if(e.hasOwnProperty(r)){const s=e[r];i=r,n&&"normalMC"===r?i="normalEC":n&&"tangentMC"===r&&(i="tangentEC"),t.hasOwnProperty(i)&&(o[i]=s)}const s=[];for(r in t)if(t.hasOwnProperty(r)){if(y.hasOwnProperty(r))continue;i=r,n&&"normalEC"===r?i="normalMC":n&&"tangentEC"===r&&(i="tangentMC"),e.hasOwnProperty(i)||s.push(r)}return{addToShader:o,missingAttributes:s}}_._oneTimeWarning=o.Z;const I=_},13679:(e,t,n)=>{n.d(t,{Z:()=>d});var i=n(54485),r=n(90868),o=n(83567),s=n(59137);const a={};function u(e,t){const n=e.shaderBuilder,i=e.uniformMap,r=t.variableName,s=t.attribute.quantization;if(s.octEncoded){const e=`model_normalizationRange_${r}`;n.addUniform("float",e,o.Z.VERTEX),i[e]=function(){return s.normalizationRange}}else{const e=`model_quantizedVolumeOffset_${r}`,a=`model_quantizedVolumeStepSize_${r}`,u=t.glslType;n.addUniform(u,e,o.Z.VERTEX),n.addUniform(u,a,o.Z.VERTEX);let l=s.quantizedVolumeOffset,d=s.quantizedVolumeStepSize;/^color_\d+$/.test(r)&&(l=c(l,0),d=c(d,1)),i[e]=function(){return l},i[a]=function(){return d}}}function c(e,t){return e instanceof r.Z?e:new r.Z(e.x,e.y,e.z,t)}function l(e,t){const n=t.variableName,i=t.attribute.quantization;let r;r=i.octEncoded?function(e,t){const n=`attributes.${e}`,i=`a_quantized_${e}`,r=`model_normalizationRange_${e}`,o=t.octEncodedZXY?".zxy":".xyz";return`${n} = czm_octDecode(${i}, ${r})${o};`}(n,i):function(e){return`attributes.${e} = model_quantizedVolumeOffset_${e} + a_quantized_${e} * model_quantizedVolumeStepSize_${e};`}(n),e.addFunctionLines(a.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,[r])}a.name="DequantizationPipelineStage",a.FUNCTION_ID_DEQUANTIZATION_STAGE_VS="dequantizationStage",a.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS="void dequantizationStage(inout ProcessedAttributes attributes)",a.process=function(e,t,n){const r=e.shaderBuilder;r.addFunction(a.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,a.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS,o.Z.VERTEX),r.addDefine("USE_DEQUANTIZATION",void 0,o.Z.VERTEX);const c=t.attributes;for(let t=0;t<c.length;t++){const n=c[t],o=n.quantization;if(!(0,i.Z)(o))continue;const a=s.Z.getAttributeInfo(n);l(r,a),u(e,a)}};const d=a},92885:(e,t,n)=>{n.d(t,{Z:()=>g});var i=n(44990),r=n(88779),o=n(54485),s=n(83567),a=n(31328),u=n(36627),c=n(59137),l=n(34240),d=n(53839),h=n(35598),p=n(60073);const f={};function _(e,t,n){const i=e.shaderBuilder;i.addStructField(f.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(f.STRUCT_ID_FEATURE_IDS_FS,"int",n);const r=t.setIndex,o=n.replace(/_\d+$/,"_"),s=`a_${o}${r}`,a=`v_${o}${r}`,u=`featureIds.${n} = int(czm_round(${s}));`,c=`featureIds.${n} = int(czm_round(${a}));`;i.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[u]),i.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[c]),i.addVarying("float",a),i.addFunctionLines(f.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${a} = ${s};`])}function m(e,t,n){const i=e.shaderBuilder;i.addStructField(f.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(f.STRUCT_ID_FEATURE_IDS_FS,"int",n);const r=t.setIndex,o=n.replace(/_\d+$/,"_"),s=[`featureIds.${n} = int(czm_round(attributes.${o}${r}));`];i.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,s),i.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,s)}function T(e,t,n,r,s,c){!function(e,t,n,r,s){const c=e.model;let l,d;if((0,o.Z)(t.repeat)){const e=function(e,t){const n=e.offset,i=e.repeat,r=new Float32Array(t);for(let e=0;e<t;e++)r[e]=n+Math.floor(e/i);return r}(t,n);l=a.Z.createVertexBuffer({context:s.context,typedArray:e,usage:u.Z.STATIC_DRAW}),l.vertexArrayDestroyable=!1,c._resources.push(l)}else d=[t.offset];const h={index:e.attributeIndex++,instanceDivisor:r,value:d,vertexBuffer:l,normalize:!1,componentsPerAttribute:1,componentDatatype:i.Z.FLOAT,strideInBytes:i.Z.getSizeInBytes(i.Z.FLOAT),offsetInBytes:0};e.attributes.push(h)}(e,t,r,s,c);const l=e.shaderBuilder,d=`a_implicit_${n}`;l.addAttribute("float",d);const h=`v_implicit_${n}`;l.addVarying("float",h),l.addStructField(f.STRUCT_ID_FEATURE_IDS_VS,"int",n),l.addStructField(f.STRUCT_ID_FEATURE_IDS_FS,"int",n),l.addFunctionLines(f.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${h} = ${d};`]),l.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[`featureIds.${n} = int(czm_round(${d}));`]),l.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[`featureIds.${n} = int(czm_round(${h}));`])}function Z(e,t,n,i,o){const a=`u_featureIdTexture_${i}`,u=e.uniformMap,c=t.textureReader;u[a]=function(){return(0,r.Z)(c.texture,o.context.defaultTexture)};const l=c.channels,d=e.shaderBuilder;d.addStructField(f.STRUCT_ID_FEATURE_IDS_FS,"int",n),d.addUniform("sampler2D",a,s.Z.FRAGMENT);const h=`featureIds.${n} = czm_unpackUint(${`texture2D(${a}, ${`v_texCoord_${c.texCoord}`}).${l}`});`;d.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[h])}function y(e,t,n,i){const r=e.shaderBuilder,o=s.Z.includesVertexShader(i);o&&r.addStructField(f.STRUCT_ID_FEATURE_IDS_VS,"int",n),r.addStructField(f.STRUCT_ID_FEATURE_IDS_FS,"int",n);const a=[`featureIds.${n} = featureIds.${t};`];o&&r.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,a),r.addFunctionLines(f.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,a)}f.name="FeatureIdPipelineStage",f.STRUCT_ID_FEATURE_IDS_VS="FeatureIdsVS",f.STRUCT_ID_FEATURE_IDS_FS="FeatureIdsFS",f.STRUCT_NAME_FEATURE_IDS="FeatureIds",f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS="initializeFeatureIdsVS",f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS="initializeFeatureIdsFS",f.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS="initializeFeatureIdAliasesVS",f.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS="initializeFeatureIdAliasesFS",f.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS="void initializeFeatureIds(out FeatureIds featureIds, ProcessedAttributes attributes)",f.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES="void initializeFeatureIdAliases(inout FeatureIds featureIds)",f.FUNCTION_ID_SET_FEATURE_ID_VARYINGS="setFeatureIdVaryings",f.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS="void setFeatureIdVaryings()",f.process=function(e,t,n){const i=e.shaderBuilder;!function(e){e.addStruct(f.STRUCT_ID_FEATURE_IDS_VS,f.STRUCT_NAME_FEATURE_IDS,s.Z.VERTEX),e.addStruct(f.STRUCT_ID_FEATURE_IDS_FS,f.STRUCT_NAME_FEATURE_IDS,s.Z.FRAGMENT),e.addFunction(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,f.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,s.Z.VERTEX),e.addFunction(f.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,f.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,s.Z.FRAGMENT),e.addFunction(f.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,f.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,s.Z.VERTEX),e.addFunction(f.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,f.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,s.Z.FRAGMENT),e.addFunction(f.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,f.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS,s.Z.VERTEX)}(i);const r=e.runtimeNode.node.instances;(0,o.Z)(r)&&function(e,t,n){const i=t.featureIds,r=t.attributes[0].count;for(let t=0;t<i.length;t++){const a=i[t],u=a.positionalLabel;if(a instanceof d.Z.FeatureIdAttribute)_(e,a,u);else{T(e,a,u,r,1,n)}const c=a.label;(0,o.Z)(c)&&y(e,u,c,s.Z.BOTH)}}(e,r,n),function(e,t,n){const i=t.featureIds,r=c.Z.getAttributeBySemantic(t,l.Z.POSITION).count;for(let t=0;t<i.length;t++){const a=i[t],u=a.positionalLabel;let c=s.Z.BOTH;a instanceof d.Z.FeatureIdAttribute?m(e,a,u):a instanceof d.Z.FeatureIdImplicitRange?T(e,a,u,r,void 0,n):(Z(e,a,u,t,n),c=s.Z.FRAGMENT);const l=a.label;(0,o.Z)(l)&&y(e,u,l,c)}}(e,t,n),i.addVertexLines([p.Z]),i.addFragmentLines([h.Z])};const g=f},85645:(e,t,n)=>{n.d(t,{Z:()=>E});var i=n(93517),r=n(17497),o=n(44990),s=n(88779),a=n(54485),u=n(99996),c=n(39172),l=n(71118),d=n(84473),h=n(21514),p=n(7004),f=n(91257),_=n(92728),m=n(45262),T=n(53839),Z=n(41184),y=n(39226),g=n(2087),I=n(34240),A=n(31328),b=n(36627);function E(e){e=(0,s.Z)(e,s.Z.EMPTY_OBJECT),r.Z.typeOf.object("options.geoJson",e.geoJson),this._geoJson=e.geoJson,this._promise=void 0,this._process=function(e,t){},this._components=void 0}function S(){this.lines=void 0,this.properties=void 0}function N(){this.features=[]}function O(e){const t=e[0],n=e[1],r=(0,s.Z)(e[2],0);return new i.Z(t,n,r)}function C(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=O(e[i]);return[n]}function v(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=C(e[i])[0];return n}(0,a.Z)(Object.create)&&(E.prototype=Object.create(y.Z.prototype),E.prototype.constructor=E),Object.defineProperties(E.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),E.prototype.load=function(){const e=this,t=new Promise((function(t){e._process=function(e,n){(0,a.Z)(e._components)||(e._components=function(e,t){const n=new N,r=x[e.type];(0,a.Z)(r)&&r(e,n);const y=n.features.length;if(0===y)throw new h.Z("GeoJSON must have at least one feature");const E={};for(let e=0;e<y;e++){const t=n.features[e],i=(0,s.Z)(t.properties,s.Z.EMPTY_OBJECT);for(const e in i)i.hasOwnProperty(e)&&((0,a.Z)(E[e])||(E[e]=new Array(y)))}for(let e=0;e<y;e++){const t=n.features[e];for(const n in E)if(E.hasOwnProperty(n)){const i=(0,s.Z)(t.properties[n],"");E[n][e]=i}}const S=new _.Z({count:y,properties:E}),O=[new Z.Z({id:0,count:y,jsonMetadataTable:S})],C=new m.Z({}),v=new g.Z({schema:C,propertyTables:O}),D=new i.Z(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),M=new i.Z(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let e=0;e<y;e++){const t=n.features[e],r=t.lines.length;for(let e=0;e<r;e++){const n=t.lines[e],r=n.length;for(let e=0;e<r;e++)i.Z.minimumByComponent(D,n[e],D),i.Z.maximumByComponent(M,n[e],M)}}const R=i.Z.midpoint(D,M,new i.Z),F=i.Z.fromDegrees(R.x,R.y,R.z,u.Z.WGS84,new i.Z),L=p.Z.eastNorthUpToFixedFrame(F,u.Z.WGS84,new l.Z),P=l.Z.inverseTransformation(L,new l.Z);let U=0,B=0;for(let e=0;e<y;e++){const t=n.features[e],i=t.lines.length;for(let e=0;e<i;e++){const n=t.lines[e];U+=n.length,B+=2*(n.length-1)}}const G=new Float32Array(3*U),V=new Float32Array(U),k=c.Z.createTypedArray(U,B),z=c.Z.fromTypedArray(k),$=new i.Z(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),H=new i.Z(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);let j=0,W=0;for(let e=0;e<y;e++){const t=n.features[e],r=t.lines.length;for(let n=0;n<r;n++){const r=t.lines[n],o=r.length;for(let t=0;t<o;t++){const n=r[t],s=i.Z.fromDegrees(n.x,n.y,n.z,u.Z.WGS84,w),a=l.Z.multiplyByPoint(P,s,w);i.Z.minimumByComponent($,a,$),i.Z.maximumByComponent(H,a,H),i.Z.pack(a,G,3*j),V[j]=e,t<o-1&&(k[2*W]=j,k[2*W+1]=j+1,W++),j++}}}const q=A.Z.createVertexBuffer({typedArray:G,context:t.context,usage:b.Z.STATIC_DRAW});q.vertexArrayDestroyable=!1;const Y=A.Z.createVertexBuffer({typedArray:V,context:t.context,usage:b.Z.STATIC_DRAW});Y.vertexArrayDestroyable=!1;const X=A.Z.createIndexBuffer({typedArray:k,context:t.context,usage:b.Z.STATIC_DRAW,indexDatatype:z});X.vertexArrayDestroyable=!1;const J=new T.Z.Attribute;J.semantic=I.Z.POSITION,J.componentDatatype=o.Z.FLOAT,J.type=f.Z.VEC3,J.count=U,J.min=$,J.max=H,J.buffer=q;const Q=new T.Z.Attribute;Q.semantic=I.Z.FEATURE_ID,Q.setIndex=0,Q.componentDatatype=o.Z.FLOAT,Q.type=f.Z.SCALAR,Q.count=U,Q.buffer=Y;const K=[J,Q],ee=new T.Z.Material;ee.unlit=!0;const te=new T.Z.Indices;te.indexDatatype=z,te.count=k.length,te.buffer=X;const ne=new T.Z.FeatureIdAttribute;ne.featureCount=y,ne.propertyTableId=0,ne.setIndex=0,ne.positionalLabel="featureId_0";const ie=[ne],re=new T.Z.Primitive;re.attributes=K,re.indices=te,re.featureIds=ie,re.primitiveType=d.Z.LINES,re.material=ee;const oe=[re],se=new T.Z.Node;se.index=0,se.primitives=oe;const ae=[se],ue=new T.Z.Scene;ue.nodes=ae;const ce=new T.Z.Components;return ce.scene=ue,ce.nodes=ae,ce.transform=L,ce.structuralMetadata=v,ce}(e._geoJson,n),e._geoJson=void 0,t(e))}}));return this._promise=t,t},E.prototype.process=function(e){r.Z.typeOf.object("frameState",e),this._process(this,e)};const D={LineString:C,MultiLineString:function(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=C(e[i])[0];return n},MultiPolygon:function(e){const t=e.length,n=[];for(let i=0;i<t;i++)Array.prototype.push.apply(n,v(e[i]));return n},Polygon:v};function M(e,t){if(!(0,a.Z)(e.geometry))return;const n=e.geometry.type,i=D[n],r=e.geometry.coordinates;if(!(0,a.Z)(i))return;if(!(0,a.Z)(r))return;const o=new S;o.lines=i(r),o.properties=e.properties,t.features.push(o)}const x={FeatureCollection:function(e,t){const n=e.features,i=n.length;for(let e=0;e<i;e++)M(n[e],t)},Feature:M},w=new i.Z;E.prototype.unload=function(){this._components=void 0}},80249:(e,t,n)=>{n.d(t,{Z:()=>T});var i=n(91257),r=n(44990),o=n(54485),s=n(24195),a=n(28085),u=n(59137),c=n(12361),l=n(84473),d=n(18061),h=n(93435),p=n(83567),f=n(34240);const _={};function m(e,t,n,s,a){const c=e.shaderBuilder,l=u.Z.getAttributeInfo(t);s>1?function(e,t,n,s){const a=t.quantization;let u,c;(0,o.Z)(a)?(u=a.type,c=a.componentDatatype):(u=t.type,c=t.componentDatatype);const l=t.normalized,d=i.Z.getNumberOfComponents(u)/s,h=r.Z.getSizeInBytes(c),p=d*h,f=t.byteStride;for(let i=0;i<s;i++){const r=t.byteOffset+i*p,o={index:n+i,vertexBuffer:t.buffer,componentsPerAttribute:d,componentDatatype:c,offsetInBytes:r,strideInBytes:f,normalize:l};e.attributes.push(o)}}(e,t,n,s):function(e,t,n,s){const a=t.quantization;let u,c;(0,o.Z)(a)?(u=a.type,c=a.componentDatatype):(u=t.type,c=t.componentDatatype);const l=t.semantic,d=t.setIndex;l===f.Z.FEATURE_ID&&d>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=d+1);const h=l===f.Z.POSITION,p=h?0:n,_=i.Z.getNumberOfComponents(u),m={index:p,value:(0,o.Z)(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,count:t.count,componentsPerAttribute:_,componentDatatype:c,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};if(e.attributes.push(m),!h||!s)return;const T=e.runtimePrimitive.positionBuffer2D,Z={index:n,vertexBuffer:T,count:t.count,componentsPerAttribute:_,componentDatatype:r.Z.FLOAT,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};e.attributes.push(Z)}(e,t,n,a),function(e,t,n){const i=t.attribute.semantic,r=t.variableName;let o,s;t.isQuantized?(o=`a_quantized_${r}`,s=t.quantizedGlslType):(o=`a_${r}`,s=t.glslType);const a=i===f.Z.POSITION;a?e.setPositionAttribute(s,o):e.addAttribute(s,o);a&&n&&e.addAttribute("vec3","a_position2D")}(c,l,a),function(e,t){const n=t.variableName;let i,r=`v_${n}`;"normalMC"===n?(r="v_normalEC",i=t.glslType):"tangentMC"===n?(i="vec3",r="v_tangentEC"):i=t.glslType;e.addVarying(i,r)}(c,l),(0,o.Z)(t.semantic)&&function(e,t){const n=t.semantic,i=t.setIndex;switch(n){case f.Z.NORMAL:e.addDefine("HAS_NORMALS");break;case f.Z.TANGENT:e.addDefine("HAS_TANGENTS");break;case f.Z.FEATURE_ID:e.addDefine(`HAS${n}_${i}`);break;case f.Z.TEXCOORD:case f.Z.COLOR:e.addDefine(`HAS_${n}_${i}`)}}(c,t),function(e,t,n){const i=_.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,r=_.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,o=t.variableName;"tangentMC"===o?(e.addStructField(i,"vec3","tangentMC"),e.addStructField(i,"float","tangentSignMC"),e.addStructField(r,"vec3","tangentEC")):"normalMC"===o?(e.addStructField(i,"vec3","normalMC"),e.addStructField(r,"vec3","normalEC")):(e.addStructField(i,t.glslType,o),e.addStructField(r,t.glslType,o));"positionMC"===o&&n&&e.addStructField(i,"vec3","position2D")}(c,l,a),function(e,t,n){const i=_.FUNCTION_ID_INITIALIZE_ATTRIBUTES,r=t.variableName;if("positionMC"===r&&n){const t="attributes.position2D = a_position2D;";e.addFunctionLines(i,[t])}if(t.isQuantized)return;const o=[];"tangentMC"===r?(o.push("attributes.tangentMC = a_tangentMC.xyz;"),o.push("attributes.tangentSignMC = a_tangentMC.w;")):o.push(`attributes.${r} = a_${r};`);e.addFunctionLines(i,o)}(c,l,a),function(e,t){const n=t.attribute.semantic,i=t.attribute.setIndex;if((0,o.Z)(n)&&!(0,o.Z)(i))return;let r=_.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS;const s=t.variableName;let a=`v_${s} = attributes.${s};`;e.addFunctionLines(r,[a]),r=_.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,a=`attributes.${s} = v_${s};`,e.addFunctionLines(r,[a])}(c,l)}_.name="GeometryPipelineStage",_.STRUCT_ID_PROCESSED_ATTRIBUTES_VS="ProcessedAttributesVS",_.STRUCT_ID_PROCESSED_ATTRIBUTES_FS="ProcessedAttributesFS",_.STRUCT_NAME_PROCESSED_ATTRIBUTES="ProcessedAttributes",_.FUNCTION_ID_INITIALIZE_ATTRIBUTES="initializeAttributes",_.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES="void initializeAttributes(out ProcessedAttributes attributes)",_.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS="setDynamicVaryingsVS",_.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS="setDynamicVaryingsFS",_.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS="void setDynamicVaryings(inout ProcessedAttributes attributes)",_.process=function(e,t,n){const r=e.shaderBuilder;r.addStruct(_.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"ProcessedAttributes",p.Z.VERTEX),r.addStruct(_.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"ProcessedAttributes",p.Z.FRAGMENT),r.addStruct(h.Z.STRUCT_ID_SELECTED_FEATURE,h.Z.STRUCT_NAME_SELECTED_FEATURE,p.Z.BOTH),r.addFunction(_.FUNCTION_ID_INITIALIZE_ATTRIBUTES,_.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES,p.Z.VERTEX),r.addVarying("vec3","v_positionWC"),r.addVarying("vec3","v_positionEC"),r.addStructField(_.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionWC"),r.addStructField(_.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionEC"),r.addFunction(_.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,_.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,p.Z.VERTEX),r.addFunction(_.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,_.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,p.Z.FRAGMENT);const o=e.model;o.type===c.Z.TILE_PNTS&&r.addDefine("HAS_SRGB_COLOR",void 0,p.Z.FRAGMENT);const u=n.mode!==d.Z.SCENE3D&&!n.scene3DOnly&&o._projectTo2D;for(let n=0;n<t.attributes.length;n++){const r=t.attributes[n],o=i.Z.getAttributeLocationCount(r.type),s=r.semantic===f.Z.POSITION;let a;o>1?(a=e.attributeIndex,e.attributeIndex+=o):a=s&&!u?0:e.attributeIndex++,m(e,r,a,o,u)}!function(e,t){let n=!1,i=!1;for(let e=0;e<t.length;e++){const r=t[e];r.semantic===f.Z.NORMAL?n=!0:r.semantic===f.Z.TANGENT&&(i=!0)}if(!n||!i)return;e.addDefine("HAS_BITANGENTS"),e.addVarying("vec3","v_bitangentEC"),e.addStructField(_.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"vec3","bitangentMC"),e.addStructField(_.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","bitangentEC")}(r,t.attributes),t.primitiveType===l.Z.POINTS&&r.addDefine("PRIMITIVE_TYPE_POINTS"),r.addVertexLines([a.Z]),r.addFragmentLines([s.Z])};const T=_},6389:(e,t,n)=>{n.d(t,{Z:()=>z});var i=n(69310),r=n(81737),o=n(93517),s=n(73673),a=n(17497),u=n(44990),c=n(88779),l=n(54485),d=n(99996),h=n(2087),p=n(16383),f=n(94335),_=n(5797),m=n(39109),T=n(71118),Z=n(41519),y=n(53839),g=n(62524),I=n(41184),A=n(20291),b=n(39226),E=n(21514),S=n(7004),N=n(84599),O=n(91257),C=n(52351);const v=0,D=1,M=2,x=3,w=4,R=y.Z.Attribute,F=y.Z.FeatureIdAttribute,L=y.Z.Instances;function P(e){const t=(e=(0,c.Z)(e,c.Z.EMPTY_OBJECT)).i3dmResource,n=e.arrayBuffer;let i=e.baseResource;const o=(0,c.Z)(e.byteOffset,0),s=(0,c.Z)(e.releaseGltfJson,!1),u=(0,c.Z)(e.asynchronous,!0),d=(0,c.Z)(e.incrementallyLoadTextures,!0),h=(0,c.Z)(e.upAxis,r.Z.Y),p=(0,c.Z)(e.forwardAxis,r.Z.X),f=(0,c.Z)(e.loadAttributesAsTypedArray,!1),_=(0,c.Z)(e.loadIndicesForWireframe,!1);a.Z.typeOf.object("options.i3dmResource",t),a.Z.typeOf.object("options.arrayBuffer",n),i=(0,l.Z)(i)?i:t.clone(),this._i3dmResource=t,this._baseResource=i,this._arrayBuffer=n,this._byteOffset=o,this._releaseGltfJson=s,this._asynchronous=u,this._incrementallyLoadTextures=d,this._upAxis=h,this._forwardAxis=p,this._loadAttributesAsTypedArray=f,this._loadIndicesForWireframe=_,this._state=v,this._promise=void 0,this._gltfLoader=void 0,this._transform=T.Z.IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}(0,l.Z)(Object.create)&&(P.prototype=Object.create(b.Z.prototype),P.prototype.constructor=P),Object.defineProperties(P.prototype,{promise:{get:function(){return this._promise}},texturesLoadedPromise:{get:function(){return this._gltfLoader.texturesLoadedPromise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),P.prototype.load=function(){const e=_.Z.parse(this._arrayBuffer,this._byteOffset),t=e.featureTableJson,n=e.featureTableBinary,i=e.batchTableJson,r=e.batchTableBinary,a=e.gltfFormat,c=new s.Z(t,n);this._featureTable=c;const d=c.getGlobalProperty("INSTANCES_LENGTH");if(c.featuresLength=d,!(0,l.Z)(d))throw new E.Z("Feature table global property: INSTANCES_LENGTH must be defined");this._instancesLength=d;const y=c.getGlobalProperty("RTC_CENTER",u.Z.FLOAT,3);(0,l.Z)(y)&&(this._transform=T.Z.fromTranslation(o.Z.fromArray(y))),this._batchTable={json:i,binary:r};const b={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadIndicesForWireframe:this._loadIndicesForWireframe};if(0===a){let t=(0,p.Z)(e.gltf);t=t.replace(/[\s\0]+$/,"");const n=this._baseResource.getDerivedResource({url:t});b.gltfResource=n,b.baseResource=n}else b.gltfResource=this._i3dmResource,b.typedArray=e.gltf;const S=new f.Z(b);this._gltfLoader=S,this._state=D;const v=this;return S.load(),this._promise=S.promise.then((function(){if(v.isDestroyed())return;const e=S.components;return e.transform=v._transform,function(e,t){let n;const i=e._featureTable,r=e._instancesLength;if(0===r)return;const s=i.getGlobalProperty("RTC_CENTER",u.Z.FLOAT,3),a=i.getGlobalProperty("EAST_NORTH_UP"),c=i.hasProperty("NORMAL_UP")||i.hasProperty("NORMAL_UP_OCT32P")||a,d=i.hasProperty("SCALE")||i.hasProperty("SCALE_NON_UNIFORM"),h=function(e,t){if(e.hasProperty("POSITION"))return e.getPropertyArray("POSITION",u.Z.FLOAT,3);if(e.hasProperty("POSITION_QUANTIZED")){const t=e.getPropertyArray("POSITION_QUANTIZED",u.Z.UNSIGNED_SHORT,3),n=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",u.Z.FLOAT,3);if(!(0,l.Z)(n))throw new E.Z("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",u.Z.FLOAT,3);if(!(0,l.Z)(i))throw new E.Z("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(let e=0;e<t.length/3;e++){const r=t[e];for(let o=0;o<3;o++)t[3*e+o]=r[o]/65535*i[o]+n[o]}return t}throw new E.Z("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}(i);let p,f;c&&(p=new Float32Array(4*r));d&&(f=new Float32Array(3*r));const _=new Float32Array(r),Z=o.Z.unpackArray(h);let y=new o.Z;const g=new o.Z,I=new o.Z,b=new o.Z,S=new m.Z,v=new A.Z,D=new Array(4),M=new o.Z,x=new Array(3),w=new T.Z;if(!(0,l.Z)(s)){const e=C.Z.fromPoints(Z);for(n=0;n<Z.length;n++)o.Z.subtract(Z[n],e.center,U),h[3*n+0]=U.x,h[3*n+1]=U.y,h[3*n+2]=U.z;t.transform=T.Z.fromTranslation(e.center)}for(n=0;n<r;n++){y=o.Z.clone(Z[n]),(0,l.Z)(s)&&o.Z.add(y,o.Z.unpack(s),y),c&&(V(i,a,n,v,y,I,g,b,S,w),A.Z.pack(v,D,0),p[4*n+0]=D[0],p[4*n+1]=D[1],p[4*n+2]=D[2],p[4*n+3]=D[3]),d&&(k(i,n,M),o.Z.pack(M,x,0),f[3*n+0]=x[0],f[3*n+1]=x[1],f[3*n+2]=x[2]);let e=i.getProperty("BATCH_ID",u.Z.UNSIGNED_SHORT,1,n);(0,l.Z)(e)||(e=n),_[n]=e}const P=new L;P.transformInWorldSpace=!0;const B=new R;if(B.name="Instance Translation",B.semantic=N.Z.TRANSLATION,B.componentDatatype=u.Z.FLOAT,B.type=O.Z.VEC3,B.count=r,B.packedTypedArray=h,P.attributes.push(B),c){const e=new R;e.name="Instance Rotation",e.semantic=N.Z.ROTATION,e.componentDatatype=u.Z.FLOAT,e.type=O.Z.VEC4,e.count=r,e.packedTypedArray=p,P.attributes.push(e)}if(d){const e=new R;e.name="Instance Scale",e.semantic=N.Z.SCALE,e.componentDatatype=u.Z.FLOAT,e.type=O.Z.VEC3,e.count=r,e.packedTypedArray=f,P.attributes.push(e)}const G=new R;G.name="Instance Feature ID",G.setIndex=0,G.semantic=N.Z.FEATURE_ID,G.componentDatatype=u.Z.FLOAT,G.type=O.Z.SCALAR,G.count=r,G.packedTypedArray=_,P.attributes.push(G);const z=new F;for(z.propertyTableId=0,z.setIndex=0,z.positionalLabel="instanceFeatureId_0",P.featureIds.push(z),n=0;n<t.nodes.length;n++){const e=t.nodes[n];e.primitives.length>0&&(e.instances=P)}}(v,e),function(e,t){const n=e._batchTable,i=e._instancesLength;if(0===i)return;let r;if((0,l.Z)(n.json))r=(0,g.Z)({count:i,batchTable:n.json,binaryBody:n.binary});else{const e=new I.Z({name:Z.Z.BATCH_TABLE_CLASS_NAME,count:i});r=new h.Z({schema:{},propertyTables:[e]})}t.structuralMetadata=r}(v,e),v._components=e,v._state=x,v})).catch((function(e){if(!v.isDestroyed())return function(e,t){e.unload(),e._state=w;const n="Failed to load i3dm";return t=e.getError(n,t),Promise.reject(t)}(v,e)})),this._promise},P.prototype.process=function(e){a.Z.typeOf.object("frameState",e),this._state===D&&(this._state=M),this._state===M&&this._gltfLoader.process(e)};const U=new o.Z,B=new Array(4);const G=new Array(4);function V(e,t,n,r,s,a,c,h,p,f){const _=e.getProperty("NORMAL_UP",u.Z.FLOAT,3,n,B),Z=e.getProperty("NORMAL_RIGHT",u.Z.FLOAT,3,n,G);let y=!1;if((0,l.Z)(_)){if(!(0,l.Z)(Z))throw new E.Z("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");o.Z.unpack(_,0,a),o.Z.unpack(Z,0,c),y=!0}else{const r=e.getProperty("NORMAL_UP_OCT32P",u.Z.UNSIGNED_SHORT,2,n,B),o=e.getProperty("NORMAL_RIGHT_OCT32P",u.Z.UNSIGNED_SHORT,2,n,G);if((0,l.Z)(r)){if(!(0,l.Z)(o))throw new E.Z("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");i.Z.octDecodeInRange(r[0],r[1],65535,a),i.Z.octDecodeInRange(o[0],o[1],65535,c),y=!0}else t?(S.Z.eastNorthUpToFixedFrame(s,d.Z.WGS84,f),T.Z.getMatrix3(f,p)):m.Z.clone(m.Z.IDENTITY,p)}y&&(o.Z.cross(c,a,h),o.Z.normalize(h,h),m.Z.setColumn(p,0,c,p),m.Z.setColumn(p,1,a,p),m.Z.setColumn(p,2,h,p)),A.Z.fromRotationMatrix(p,r)}function k(e,t,n){n=o.Z.fromElements(1,1,1,n);const i=e.getProperty("SCALE",u.Z.FLOAT,1,t);(0,l.Z)(i)&&o.Z.multiplyByScalar(n,i,n);const r=e.getProperty("SCALE_NON_UNIFORM",u.Z.FLOAT,3,t,B);(0,l.Z)(r)&&(n.x*=r[0],n.y*=r[1],n.z*=r[2])}P.prototype.unload=function(){(0,l.Z)(this._gltfLoader)&&this._gltfLoader.unload(),this._components=void 0};const z=P},31412:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(51138),r=n(54485),o=n(19411),s=n(83567),a=n(9257);const u={name:"ImageBasedLightingPipelineStage",process:function(e,t,n){const u=t.imageBasedLighting,c=e.shaderBuilder;if(c.addDefine("USE_IBL_LIGHTING",void 0,s.Z.FRAGMENT),c.addUniform("vec2","model_iblFactor",s.Z.FRAGMENT),a.Z.isSupported(n.context)){(u.useSphericalHarmonics||u.useSpecularEnvironmentMaps||u.enabled)&&c.addUniform("mat3","model_iblReferenceFrameMatrix",s.Z.FRAGMENT),(0,r.Z)(u.sphericalHarmonicCoefficients)?(c.addDefine("DIFFUSE_IBL",void 0,s.Z.FRAGMENT),c.addDefine("CUSTOM_SPHERICAL_HARMONICS",void 0,s.Z.FRAGMENT),c.addUniform("vec3","model_sphericalHarmonicCoefficients[9]",s.Z.FRAGMENT)):u.useDefaultSphericalHarmonics&&c.addDefine("DIFFUSE_IBL",void 0,s.Z.FRAGMENT),(0,r.Z)(u.specularEnvironmentMapAtlas)&&u.specularEnvironmentMapAtlas.ready?(c.addDefine("SPECULAR_IBL",void 0,s.Z.FRAGMENT),c.addDefine("CUSTOM_SPECULAR_IBL",void 0,s.Z.FRAGMENT),c.addUniform("sampler2D","model_specularEnvironmentMaps",s.Z.FRAGMENT),c.addUniform("vec2","model_specularEnvironmentMapsSize",s.Z.FRAGMENT),c.addUniform("float","model_specularEnvironmentMapsMaximumLOD",s.Z.FRAGMENT)):t.useDefaultSpecularMaps&&c.addDefine("SPECULAR_IBL",void 0,s.Z.FRAGMENT)}(0,r.Z)(u.luminanceAtZenith)&&(c.addDefine("USE_SUN_LUMINANCE",void 0,s.Z.FRAGMENT),c.addUniform("float","model_luminanceAtZenith",s.Z.FRAGMENT)),c.addFragmentLines([o.Z]);const l={model_iblFactor:function(){return u.imageBasedLightingFactor},model_iblReferenceFrameMatrix:function(){return t._iblReferenceFrameMatrix},model_luminanceAtZenith:function(){return u.luminanceAtZenith},model_sphericalHarmonicCoefficients:function(){return u.sphericalHarmonicCoefficients},model_specularEnvironmentMaps:function(){return u.specularEnvironmentMapAtlas.texture},model_specularEnvironmentMapsSize:function(){return u.specularEnvironmentMapAtlas.texture.dimensions},model_specularEnvironmentMapsMaximumLOD:function(){return u.specularEnvironmentMapAtlas.maximumMipmapLevel}};e.uniformMap=(0,i.Z)(l,e.uniformMap)}},c=u},49742:(e,t,n)=>{n.d(t,{Z:()=>S});var i=n(93517),r=n(44990),o=n(54485),s=n(71118),a=n(91257),u=n(20291),c=n(31328),l=n(36627),d=n(84599),h=n(59137),p=n(21393),f=n(25799),_=n(32458),m=n(83567);const T=new s.Z,Z=new s.Z,y={name:"InstancingPipelineStage"};y.process=function(e,t,n){const i=t.instances,u=i.attributes[0].count;let y=[];const g=e.model.sceneGraph,I=e.shaderBuilder;I.addDefine("HAS_INSTANCING"),I.addVertexLines([p.Z]);const A=h.Z.getAttributeBySemantic(i,d.Z.TRANSLATION);let b,S;(0,o.Z)(A)&&(b=A.max,S=A.min);const N=h.Z.getAttributeBySemantic(i,d.Z.ROTATION);if(!(0,o.Z)(N)&&(0,o.Z)(b)&&(0,o.Z)(S)){(0,o.Z)(A)&&(y.push({index:e.attributeIndex++,vertexBuffer:A.buffer,componentsPerAttribute:a.Z.getNumberOfComponents(A.type),componentDatatype:A.componentDatatype,normalize:!1,offsetInBytes:A.byteOffset,strideInBytes:A.byteStride,instanceDivisor:1}),e.instancingTranslationMax=b,e.instancingTranslationMin=S,I.addDefine("HAS_INSTANCE_TRANSLATION"),I.addAttribute("vec3","a_instanceTranslation"));const t=h.Z.getAttributeBySemantic(i,d.Z.SCALE);(0,o.Z)(t)&&(y.push({index:e.attributeIndex++,vertexBuffer:t.buffer,componentsPerAttribute:a.Z.getNumberOfComponents(t.type),componentDatatype:t.componentDatatype,normalize:!1,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,instanceDivisor:1}),I.addDefine("HAS_INSTANCE_SCALE"),I.addAttribute("vec3","a_instanceScale"))}else y=function(e,t,n,i){const o=E(e.instances,t,n),s=c.Z.createVertexBuffer({context:i.context,typedArray:o,usage:l.Z.STATIC_DRAW});s.vertexArrayDestroyable=!1,n.model._resources.push(s);const a=12,u=r.Z.getSizeInBytes(r.Z.FLOAT),d=u*a,h=[{index:n.attributeIndex++,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:r.Z.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:d,instanceDivisor:1},{index:n.attributeIndex++,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:r.Z.FLOAT,normalize:!1,offsetInBytes:4*u,strideInBytes:d,instanceDivisor:1},{index:n.attributeIndex++,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:r.Z.FLOAT,normalize:!1,offsetInBytes:8*u,strideInBytes:d,instanceDivisor:1}],p=n.shaderBuilder;return p.addDefine("HAS_INSTANCE_MATRICES"),p.addAttribute("vec4","a_instancingTransformRow0"),p.addAttribute("vec4","a_instancingTransformRow1"),p.addAttribute("vec4","a_instancingTransformRow2"),h}(t,u,e,n);if(function(e,t,n,i){const r=n.attributes,o=e.model,s=e.shaderBuilder;for(let n=0;n<r.length;n++){const u=r[n];if(u.semantic!==d.Z.FEATURE_ID)continue;u.setIndex>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=u.setIndex+1);const h=c.Z.createVertexBuffer({context:t.context,typedArray:u.packedTypedArray,usage:l.Z.STATIC_DRAW});h.vertexArrayDestroyable=!1,o._resources.push(h),i.push({index:e.attributeIndex++,vertexBuffer:h,componentsPerAttribute:a.Z.getNumberOfComponents(u.type),componentDatatype:u.componentDatatype,normalize:!1,offsetInBytes:u.byteOffset,strideInBytes:u.byteStride,instanceDivisor:1}),s.addAttribute("float",`a_instanceFeatureId_${u.setIndex}`)}}(e,n,i,y),i.transformInWorldSpace){const t=e.uniformMap;I.addDefine("USE_LEGACY_INSTANCING",void 0,m.Z.VERTEX),I.addUniform("mat4","u_instance_modifiedModelView",m.Z.VERTEX),I.addUniform("mat4","u_instance_nodeTransform",m.Z.VERTEX),t.u_instance_modifiedModelView=function(){const t=s.Z.multiplyTransformation(e.model.modelMatrix,g.components.transform,T);return s.Z.multiplyTransformation(n.context.uniformState.view,t,T)},t.u_instance_nodeTransform=function(){return s.Z.multiplyTransformation(g.axisCorrectionMatrix,e.runtimeNode.computedTransform,Z)},I.addVertexLines([_.Z])}else I.addVertexLines([f.Z]);e.instanceCount=u,e.attributes.push.apply(e.attributes,y)};const g=new i.Z,I=new u.Z,A=new i.Z,b=new s.Z;function E(e,t,n){const r=new Float32Array(12*t),a=h.Z.getAttributeBySemantic(e,d.Z.TRANSLATION),c=h.Z.getAttributeBySemantic(e,d.Z.ROTATION),l=h.Z.getAttributeBySemantic(e,d.Z.SCALE),p=new i.Z(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),f=new i.Z(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),_=(0,o.Z)(a),m=(0,o.Z)(c),T=(0,o.Z)(l),Z=_?a.packedTypedArray:new Float32Array(3*t),y=m?c.packedTypedArray:new Float32Array(4*t);let E;T?E=l.packedTypedArray:(E=new Float32Array(3*t),E.fill(1));for(let e=0;e<t;e++){const t=new i.Z(Z[3*e],Z[3*e+1],Z[3*e+2],g);i.Z.maximumByComponent(p,t,p),i.Z.minimumByComponent(f,t,f);const o=new u.Z(y[4*e],y[4*e+1],y[4*e+2],m?y[4*e+3]:1,I),a=new i.Z(E[3*e],E[3*e+1],E[3*e+2],A),c=s.Z.fromTranslationQuaternionRotationScale(t,o,a,b),l=12*e;r[l+0]=c[0],r[l+1]=c[4],r[l+2]=c[8],r[l+3]=c[12],r[l+4]=c[1],r[l+5]=c[5],r[l+6]=c[9],r[l+7]=c[13],r[l+8]=c[2],r[l+9]=c[6],r[l+10]=c[10],r[l+11]=c[14],n.instancingTranslationMax=p,n.instancingTranslationMin=f}return r}y._getInstanceTransformsTypedArray=E;const S=y},65961:(e,t,n)=>{n.d(t,{Z:()=>i});const i=Object.freeze({UNLIT:0,PBR:1})},99491:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(54485),r=n(83567),o=n(80634),s=n(65961);const a={name:"LightingPipelineStage",process:function(e,t){const n=e.model,a=e.lightingOptions,u=e.shaderBuilder;if((0,i.Z)(n.lightColor)){u.addDefine("USE_CUSTOM_LIGHT_COLOR",void 0,r.Z.FRAGMENT),u.addUniform("vec3","model_lightColorHdr",r.Z.FRAGMENT);e.uniformMap.model_lightColorHdr=function(){return n.lightColor}}a.lightingModel===s.Z.PBR?u.addDefine("LIGHTING_PBR",void 0,r.Z.FRAGMENT):u.addDefine("LIGHTING_UNLIT",void 0,r.Z.FRAGMENT),u.addFragmentLines([o.Z])}},u=a},18291:(e,t,n)=>{n.d(t,{Z:()=>A});var i=n(54485),r=n(88779),o=n(83567),s=n(46959),a=n(65961),u=n(84681),c=n(1577),l=n(39109),d=n(93517),h=n(90868),p=n(53839),f=n(34240),_=n(59137);const m=p.Z.Material,T=p.Z.MetallicRoughness,Z=p.Z.SpecularGlossiness,y={};function g(e,t,n,i,r){const s=`HAS_${r}_TEXTURE_TRANSFORM`;e.addDefine(s,void 0,o.Z.FRAGMENT);const a=`${i}Transform`;e.addUniform("mat3",a,o.Z.FRAGMENT),t[a]=function(){return n.transform}}function I(e,t,n,s,a,u){e.addUniform("sampler2D",s,o.Z.FRAGMENT),t[s]=function(){return(0,r.Z)(n.texture,u)};const c=`HAS_${a}_TEXTURE`;e.addDefine(c,void 0,o.Z.FRAGMENT);const d=`v_texCoord_${n.texCoord}`,h=`TEXCOORD_${a}`;e.addDefine(h,d,o.Z.FRAGMENT);const p=n.transform;(0,i.Z)(p)&&!l.Z.equals(p,l.Z.IDENTITY)&&g(e,t,n,s,a)}y.name="MaterialPipelineStage",y.process=function(e,t,n){const r=t.material,l=e.uniformMap,p=e.shaderBuilder,y=n.context.defaultTexture;!function(e,t,n,r,s,a){const u=e.emissiveTexture;(0,i.Z)(u)&&I(n,t,u,"u_emissiveTexture","EMISSIVE",a);const c=e.emissiveFactor;(0,i.Z)(c)&&!d.Z.equals(c,m.DEFAULT_EMISSIVE_FACTOR)&&(n.addUniform("vec3","u_emissiveFactor",o.Z.FRAGMENT),t.u_emissiveFactor=function(){return e.emissiveFactor},n.addDefine("HAS_EMISSIVE_FACTOR",void 0,o.Z.FRAGMENT));const l=e.normalTexture;(0,i.Z)(l)&&I(n,t,l,"u_normalTexture","NORMAL",s);const h=e.occlusionTexture;(0,i.Z)(h)&&I(n,t,h,"u_occlusionTexture","OCCLUSION",r)}(r,l,p,y,n.context.defaultNormalTexture,n.context.defaultEmissiveTexture),(0,i.Z)(r.specularGlossiness)?function(e,t,n,r){const s=e.specularGlossiness;n.addDefine("USE_SPECULAR_GLOSSINESS",void 0,o.Z.FRAGMENT);const a=s.diffuseTexture;(0,i.Z)(a)&&I(n,t,a,"u_diffuseTexture","DIFFUSE",r);const u=s.diffuseFactor;(0,i.Z)(u)&&!h.Z.equals(u,Z.DEFAULT_DIFFUSE_FACTOR)&&(n.addUniform("vec4","u_diffuseFactor",o.Z.FRAGMENT),t.u_diffuseFactor=function(){return s.diffuseFactor},n.addDefine("HAS_DIFFUSE_FACTOR",void 0,o.Z.FRAGMENT));const c=s.specularGlossinessTexture;(0,i.Z)(c)&&I(n,t,c,"u_specularGlossinessTexture","SPECULAR_GLOSSINESS",r);const l=s.specularFactor;(0,i.Z)(l)&&!d.Z.equals(l,Z.DEFAULT_SPECULAR_FACTOR)&&(n.addUniform("vec3","u_specularFactor",o.Z.FRAGMENT),t.u_specularFactor=function(){return s.specularFactor},n.addDefine("HAS_SPECULAR_FACTOR",void 0,o.Z.FRAGMENT));const p=s.glossinessFactor;(0,i.Z)(p)&&p!==Z.DEFAULT_GLOSSINESS_FACTOR&&(n.addUniform("float","u_glossinessFactor",o.Z.FRAGMENT),t.u_glossinessFactor=function(){return s.glossinessFactor},n.addDefine("HAS_GLOSSINESS_FACTOR",void 0,o.Z.FRAGMENT))}(r,l,p,y):function(e,t,n,r){const s=e.metallicRoughness;n.addDefine("USE_METALLIC_ROUGHNESS",void 0,o.Z.FRAGMENT);const a=s.baseColorTexture;(0,i.Z)(a)&&I(n,t,a,"u_baseColorTexture","BASE_COLOR",r);const u=s.baseColorFactor;(0,i.Z)(u)&&!h.Z.equals(u,T.DEFAULT_BASE_COLOR_FACTOR)&&(n.addUniform("vec4","u_baseColorFactor",o.Z.FRAGMENT),t.u_baseColorFactor=function(){return s.baseColorFactor},n.addDefine("HAS_BASE_COLOR_FACTOR",void 0,o.Z.FRAGMENT));const c=s.metallicRoughnessTexture;(0,i.Z)(c)&&I(n,t,c,"u_metallicRoughnessTexture","METALLIC_ROUGHNESS",r);const l=s.metallicFactor;(0,i.Z)(l)&&l!==T.DEFAULT_METALLIC_FACTOR&&(n.addUniform("float","u_metallicFactor",o.Z.FRAGMENT),t.u_metallicFactor=function(){return s.metallicFactor},n.addDefine("HAS_METALLIC_FACTOR",void 0,o.Z.FRAGMENT));const d=s.roughnessFactor;(0,i.Z)(d)&&d!==T.DEFAULT_ROUGHNESS_FACTOR&&(n.addUniform("float","u_roughnessFactor",o.Z.FRAGMENT),t.u_roughnessFactor=function(){return s.roughnessFactor},n.addDefine("HAS_ROUGHNESS_FACTOR",void 0,o.Z.FRAGMENT))}(r,l,p,y);const g=_.Z.getAttributeBySemantic(t,f.Z.NORMAL),A=e.lightingOptions;r.unlit||!g?A.lightingModel=a.Z.UNLIT:A.lightingModel=a.Z.PBR;const b=e.model,E=b.backFaceCulling&&!r.doubleSided,S=(0,i.Z)(b.color)&&b.color.alpha<1;e.renderStateOptions.cull={enabled:E&&!S};const N=e.alphaOptions;(0,i.Z)(N.alphaMode)||(N.alphaMode=r.alphaMode,r.alphaMode===s.Z.BLEND?N.pass=c.Z.TRANSLUCENT:r.alphaMode===s.Z.MASK&&(N.alphaCutoff=r.alphaCutoff)),p.addFragmentLines([u.Z]),b.debugWireframe&&p.addDefine("USE_WIREFRAME",void 0,o.Z.FRAGMENT)},y._processTexture=I,y._processTextureTransform=g;const A=y},37463:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(54485),r=n(83567),o=n(67917),s=n(12209),a=n(59137);const u={};function c(e,t,n,i){const o=h(n),s=t.variableName,a=t.glslType,c=e.shaderBuilder;c.addStructField(u.STRUCT_ID_METADATA_VS,a,o),c.addStructField(u.STRUCT_ID_METADATA_FS,a,o);let l=`attributes.${s}`;i.hasValueTransform&&(l=d(l,{renderResources:e,glslType:a,metadataVariable:o,shaderDestination:r.Z.BOTH,offset:i.offset,scale:i.scale}));const p=`metadata.${o} = ${l};`;c.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_VS,[p]),c.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_FS,[p])}function l(e,t,n){const i=n.textureReader,o=`u_propertyTexture_${i.index}`;e.uniformMap.hasOwnProperty(o)||function(e,t,n){e.shaderBuilder.addUniform("sampler2D",t,r.Z.FRAGMENT);e.uniformMap[t]=function(){return n.texture}}(e,o,i);const s=h(t),a=n.getGlslType(),c=e.shaderBuilder;c.addStructField(u.STRUCT_ID_METADATA_FS,a,s);let l=`texture2D(${o}, ${`attributes.texCoord_${i.texCoord}`}).${i.channels}`;l=n.unpackInShader(l),n.hasValueTransform&&(l=d(l,{renderResources:e,glslType:a,metadataVariable:s,shaderDestination:r.Z.FRAGMENT,offset:n.offset,scale:n.scale}));const p=`metadata.${s} = ${l};`;c.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_FS,[p])}function d(e,t){const n=t.metadataVariable,i=`u_${n}_offset`,r=`u_${n}_scale`,o=t.renderResources,s=o.shaderBuilder,a=t.glslType,u=t.shaderDestination;s.addUniform(a,i,u),s.addUniform(a,r,u);const c=o.uniformMap;return c[i]=function(){return t.offset},c[r]=function(){return t.scale},`czm_valueTransform(${i}, ${r}, ${e})`}function h(e){return e.replaceAll(/[^_a-zA-Z0-9]+/g,"_")}u.name="MetadataPipelineStage",u.STRUCT_ID_METADATA_VS="MetadataVS",u.STRUCT_ID_METADATA_FS="MetadataFS",u.STRUCT_NAME_METADATA="Metadata",u.FUNCTION_ID_INITIALIZE_METADATA_VS="initializeMetadataVS",u.FUNCTION_ID_INITIALIZE_METADATA_FS="initializeMetadataFS",u.FUNCTION_SIGNATURE_INITIALIZE_METADATA="void initializeMetadata(out Metadata metadata, ProcessedAttributes attributes)",u.FUNCTION_ID_SET_METADATA_VARYINGS="setMetadataVaryings",u.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS="void setMetadataVaryings()",u.process=function(e,t,n){const d=e.shaderBuilder;!function(e){e.addStruct(u.STRUCT_ID_METADATA_VS,u.STRUCT_NAME_METADATA,r.Z.VERTEX),e.addStruct(u.STRUCT_ID_METADATA_FS,u.STRUCT_NAME_METADATA,r.Z.FRAGMENT),e.addFunction(u.FUNCTION_ID_INITIALIZE_METADATA_VS,u.FUNCTION_SIGNATURE_INITIALIZE_METADATA,r.Z.VERTEX),e.addFunction(u.FUNCTION_ID_INITIALIZE_METADATA_FS,u.FUNCTION_SIGNATURE_INITIALIZE_METADATA,r.Z.FRAGMENT),e.addFunction(u.FUNCTION_ID_SET_METADATA_VARYINGS,u.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS,r.Z.VERTEX)}(d),d.addVertexLines([s.Z]),d.addFragmentLines([o.Z]);const h=e.model.structuralMetadata;(0,i.Z)(h)&&(function(e,t,n){const r=n.propertyAttributes;if(!(0,i.Z)(r))return;for(let n=0;n<r.length;n++){const i=r[n].properties;for(const n in i)if(i.hasOwnProperty(n)){const r=i[n],o=a.Z.getAttributeByName(t,r.attribute);c(e,a.Z.getAttributeInfo(o),n,r)}}}(e,t,h),function(e,t){const n=t.propertyTextures;if(!(0,i.Z)(n))return;for(let t=0;t<n.length;t++){const i=n[t].properties;for(const t in i)if(i.hasOwnProperty(t)){const n=i[t];n.isGpuCompatible()&&l(e,t,n)}}}(e,h))};const p=u},8840:(e,t,n)=>{function i(){this.pass=void 0,this.alphaMode=void 0,this.alphaCutoff=void 0}n.d(t,{Z:()=>i})},57622:(e,t,n)=>{n.d(t,{Z:()=>d});var i=n(59015),r=n(53425),o=n(51138),s=n(6785),a=n(16023),u=n(83567);const c={name:"ModelClippingPlanesPipelineStage"},l=new i.Z;c.process=function(e,t,n){const i=t.clippingPlanes,c=n.context,d=e.shaderBuilder;d.addDefine("HAS_CLIPPING_PLANES",void 0,u.Z.FRAGMENT),d.addDefine("CLIPPING_PLANES_LENGTH",i.length,u.Z.FRAGMENT),i.unionClippingRegions&&d.addDefine("UNION_CLIPPING_REGIONS",void 0,u.Z.FRAGMENT),r.Z.useFloatTexture(c)&&d.addDefine("USE_CLIPPING_PLANES_FLOAT_TEXTURE",void 0,u.Z.FRAGMENT);const h=r.Z.getTextureResolution(i,c,l);d.addDefine("CLIPPING_PLANES_TEXTURE_WIDTH",h.x,u.Z.FRAGMENT),d.addDefine("CLIPPING_PLANES_TEXTURE_HEIGHT",h.y,u.Z.FRAGMENT),d.addUniform("sampler2D","model_clippingPlanes",u.Z.FRAGMENT),d.addUniform("vec4","model_clippingPlanesEdgeStyle",u.Z.FRAGMENT),d.addUniform("mat4","model_clippingPlanesMatrix",u.Z.FRAGMENT),d.addFragmentLines([a.Z]);const p={model_clippingPlanes:function(){return i.texture},model_clippingPlanesEdgeStyle:function(){const e=s.Z.clone(i.edgeColor);return e.alpha=i.edgeWidth,e},model_clippingPlanesMatrix:function(){return t._clippingPlanesMatrix}};e.uniformMap=(0,o.Z)(p,e.uniformMap)};const d=c},61610:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(46959),r=n(30562),o=n(51138),s=n(63873),a=n(1577),u=n(83567);const c={name:"ModelColorPipelineStage",COLOR_UNIFORM_NAME:"model_color",COLOR_BLEND_UNIFORM_NAME:"model_colorBlend",process:function(e,t,n){const l=e.shaderBuilder;l.addDefine("HAS_MODEL_COLOR",void 0,u.Z.FRAGMENT),l.addFragmentLines([s.Z]);const d={},h=t.color,p=e.renderStateOptions;0===h.alpha?(p.colorMask={red:!1,green:!1,blue:!1,alpha:!1},p.depthMask=!1):h.alpha<1&&(e.alphaOptions.pass=a.Z.TRANSLUCENT,e.alphaOptions.alphaMode=i.Z.BLEND),l.addUniform("vec4",c.COLOR_UNIFORM_NAME,u.Z.FRAGMENT),d[c.COLOR_UNIFORM_NAME]=function(){return t.color},l.addUniform("float",c.COLOR_BLEND_UNIFORM_NAME,u.Z.FRAGMENT),d[c.COLOR_BLEND_UNIFORM_NAME]=function(){return r.Z.getColorBlend(t.colorBlendMode,t.colorBlendAmount)},e.uniformMap=(0,o.Z)(d,e.uniformMap)}},l=c},85003:(e,t,n)=>{n.d(t,{Z:()=>w});var i=n(52351),r=n(93517),o=n(66866),s=n(17497),a=n(30562),u=n(53425),c=n(54485),l=n(88779),d=n(20176),h=n(94335),p=n(98140),f=n(9469),_=n(86667),m=n(12361),T=n(59137),Z=n(1577),y=n(67197),g=n(90332),I=n(39109),A=n(71118),b=n(60472),E=n(85803),S=n(42042),N=n(85645),O=n(6389),C=n(14797),v=n(6785),D=n(18061),M=n(49616),x=n(77493);function w(e){e=(0,l.Z)(e,l.Z.EMPTY_OBJECT),s.Z.typeOf.object("options.loader",e.loader),s.Z.typeOf.object("options.resource",e.resource),this._loader=e.loader,this._resource=e.resource,this.type=(0,l.Z)(e.type,m.Z.GLTF),this.modelMatrix=A.Z.clone((0,l.Z)(e.modelMatrix,A.Z.IDENTITY)),this._modelMatrix=A.Z.clone(this.modelMatrix),this._scale=(0,l.Z)(e.scale,1),this._minimumPixelSize=(0,l.Z)(e.minimumPixelSize,0),this._maximumScale=e.maximumScale,this._clampedScale=(0,c.Z)(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._computedScale=this._clampedScale,this._updateModelMatrix=!1,this.referenceMatrix=void 0,this._iblReferenceFrameMatrix=I.Z.clone(I.Z.IDENTITY),this._resourcesLoaded=!1,this._drawCommandsBuilt=!1,this._ready=!1,this._customShader=e.customShader,this._content=e.content,this._texturesLoaded=!1,this._defaultTexture=void 0,this._activeAnimations=new f.Z(this),this._clampAnimations=(0,l.Z)(e.clampAnimations,!0);const t=e.color;this._color=(0,l.Z)(t)?v.Z.clone(t):void 0,this._colorBlendMode=(0,l.Z)(e.colorBlendMode,a.Z.HIGHLIGHT),this._colorBlendAmount=(0,l.Z)(e.colorBlendAmount,.5),this._cull=(0,l.Z)(e.cull,!0),this._opaquePass=(0,l.Z)(e.opaquePass,Z.Z.OPAQUE),this._allowPicking=(0,l.Z)(e.allowPicking,!0),this._show=(0,l.Z)(e.show,!0),this._style=void 0;let n=(0,l.Z)(e.featureIdLabel,"featureId_0");"number"==typeof n&&(n=`featureId_${n}`),this._featureIdLabel=n;let o=(0,l.Z)(e.instanceFeatureIdLabel,"instanceFeatureId_0");"number"==typeof o&&(o=`instanceFeatureId_${o}`),this._instanceFeatureIdLabel=o,this._featureTables=[],this._featureTableId=void 0,this._featureTableIdDirty=!0,this._resources=[],this._modelResources=[],this._boundingSphere=new i.Z,this._initialRadius=void 0;const d=new E.Z(e.pointCloudShading);this._attenuation=d.attenuation,this._pointCloudShading=d;const h=e.clippingPlanes;(0,c.Z)(h)&&void 0===h.owner?u.Z.setOwner(h,this,"_clippingPlanes"):this._clippingPlanes=h,this._clippingPlanesState=0,this._clippingPlanesMatrix=A.Z.clone(A.Z.IDENTITY),this._lightColor=r.Z.clone(e.lightColor),this._imageBasedLighting=(0,c.Z)(e.imageBasedLighting)?e.imageBasedLighting:new p.Z,this._shouldDestroyImageBasedLighting=!(0,c.Z)(e.imageBasedLighting),this._backFaceCulling=(0,l.Z)(e.backFaceCulling,!0),this._backFaceCullingDirty=!1,this._shadows=(0,l.Z)(e.shadows,M.Z.ENABLED),this._shadowsDirty=!1,this._debugShowBoundingVolumeDirty=!1,this._debugShowBoundingVolume=(0,l.Z)(e.debugShowBoundingVolume,!1),this._enableDebugWireframe=(0,l.Z)(e.enableDebugWireframe,!1),this._debugWireframe=(0,l.Z)(e.debugWireframe,!1),this._showCreditsOnScreen=(0,l.Z)(e.showCreditsOnScreen,!1),this._splitDirection=(0,l.Z)(e.splitDirection,x.Z.NONE),this._sceneMode=void 0,this._projectTo2D=(0,l.Z)(e.projectTo2D,!1),this._completeLoad=function(e,t){},this._texturesLoadedPromise=void 0,this._readyPromise=function(e){const t=e._loader,n=e._resource;t.load();const i=t.promise.then((function(t){const n=t.components,i=n.structuralMetadata;(0,c.Z)(i)&&i.propertyTableCount>0&&function(e,t){const n=e._featureTables,i=t.propertyTables;for(let t=0;t<i.length;t++){const r=i[t],o=new b.Z({model:e,propertyTable:r});n.push(o)}}(e,i),e._sceneGraph=new _.Z({model:e,modelComponents:n}),e._resourcesLoaded=!0})),r=(0,l.Z)(t.texturesLoadedPromise,Promise.resolve());e._texturesLoadedPromise=r.then((function(){e._texturesLoaded=!0})).catch(T.Z.getFailedLoadFunction(e,"model",n));const o=new Promise((function(t,n){e._completeLoad=function(e,n){n.afterRender.push((function(){e._ready=!0,t(e)}))}}));return i.then((function(){return o})).catch(T.Z.getFailedLoadFunction(e,"model",n))}(this)}Object.defineProperties(w.prototype,{ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},texturesLoadedPromise:{get:function(){return this._texturesLoadedPromise}},loader:{get:function(){return this._loader}},activeAnimations:{get:function(){return this._activeAnimations}},clampAnimations:{get:function(){return this._clampAnimations},set:function(e){this._clampAnimations=e}},cull:{get:function(){return this._cull}},opaquePass:{get:function(){return this._opaquePass}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){s.Z.defined("pointCloudShading",e),e!==this._pointCloudShading&&this.resetDrawCommands(),this._pointCloudShading=e}},customShader:{get:function(){return this._customShader},set:function(e){e!==this._customShader&&this.resetDrawCommands(),this._customShader=e}},sceneGraph:{get:function(){return this._sceneGraph}},content:{get:function(){return this._content}},structuralMetadata:{get:function(){return this._sceneGraph.components.structuralMetadata}},featureTableId:{get:function(){return this._featureTableId},set:function(e){this._featureTableId=e}},featureTables:{get:function(){return this._featureTables},set:function(e){this._featureTables=e}},allowPicking:{get:function(){return this._allowPicking}},style:{get:function(){return this._style},set:function(e){e!==this._style&&this.applyStyle(e),this._style=e}},color:{get:function(){return this._color},set:function(e){v.Z.equals(this._color,e)||this.resetDrawCommands(),this._color=v.Z.clone(e,this._color)}},colorBlendMode:{get:function(){return this._colorBlendMode},set:function(e){this._colorBlendMode=e}},colorBlendAmount:{get:function(){return this._colorBlendAmount},set:function(e){this._colorBlendAmount=e}},boundingSphere:{get:function(){if(!this._ready)throw new d.Z("The model is not loaded. Use ModelExperimental.readyPromise or wait for ModelExperimental.ready to be true.");return this._boundingSphere}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolumeDirty=!0),this._debugShowBoundingVolume=e}},debugWireframe:{get:function(){return this._debugWireframe},set:function(e){this._debugWireframe!==e&&this.resetDrawCommands(),this._debugWireframe=e}},show:{get:function(){return this._show},set:function(e){this._show=e}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){"number"==typeof e&&(e=`featureId_${e}`),s.Z.typeOf.string("value",e),e!==this._featureIdLabel&&(this._featureTableIdDirty=!0),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){"number"==typeof e&&(e=`instanceFeatureId_${e}`),s.Z.typeOf.string("value",e),e!==this._instanceFeatureIdLabel&&(this._featureTableIdDirty=!0),this._instanceFeatureIdLabel=e}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&(u.Z.setOwner(e,this,"_clippingPlanes"),this.resetDrawCommands())}},lightColor:{get:function(){return this._lightColor},set:function(e){(0,c.Z)(e)!==(0,c.Z)(this._lightColor)&&this.resetDrawCommands(),this._lightColor=r.Z.clone(e,this._lightColor)}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){s.Z.typeOf.object("imageBasedLighting",this._imageBasedLighting),e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this.resetDrawCommands())}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){e!==this._backFaceCulling&&(this._backFaceCullingDirty=!0),this._backFaceCulling=e}},scale:{get:function(){return this._scale},set:function(e){e!==this._scale&&(this._updateModelMatrix=!0),this._scale=e}},computedScale:{get:function(){return this._computedScale}},minimumPixelSize:{get:function(){return this._minimumPixelSize},set:function(e){e!==this._minimumPixelSize&&(this._updateModelMatrix=!0),this._minimumPixelSize=e}},maximumScale:{get:function(){return this._maximumScale},set:function(e){e!==this._maximumScale&&(this._updateModelMatrix=!0),this._maximumScale=e}},shadows:{get:function(){return this._shadows},set:function(e){e!==this._shadows&&(this._shadowsDirty=!0),this._shadows=e}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen=e}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&this.resetDrawCommands(),this._splitDirection=e}}}),w.prototype.resetDrawCommands=function(){this._drawCommandsBuilt&&(this.destroyResources(),this._drawCommandsBuilt=!1)};const R=new A.Z,F=new I.Z,L=new A.Z;w.prototype.update=function(e){this._resourcesLoaded&&this._texturesLoaded||this._loader.process(e),(0,c.Z)(this._customShader)&&this._customShader.update(e),this.pointCloudShading.attenuation!==this._attenuation&&(this.resetDrawCommands(),this._attenuation=this.pointCloudShading.attenuation);const t=e.context,n=(0,l.Z)(this.referenceMatrix,this.modelMatrix);if(this._imageBasedLighting.update(e),this._imageBasedLighting.useSphericalHarmonicCoefficients||this._imageBasedLighting.useSpecularEnvironmentMaps){let e=F,i=R;i=A.Z.multiply(t.uniformState.view3D,n,i),e=A.Z.getMatrix3(i,e),e=I.Z.getRotation(e,e),this._iblReferenceFrameMatrix=I.Z.transpose(e,this._iblReferenceFrameMatrix)}this._imageBasedLighting.shouldRegenerateShaders&&this.resetDrawCommands();let o=0;if(this.isClippingEnabled()){this._clippingPlanes.owner===this&&this._clippingPlanes.update(e);let i=L;i=A.Z.multiply(t.uniformState.view3D,n,i),i=A.Z.multiply(i,this._clippingPlanes.modelMatrix,i),this._clippingPlanesMatrix=A.Z.inverseTranspose(i,this._clippingPlanesMatrix),o=this._clippingPlanes.clippingPlanesState}if(o!==this._clippingPlanesState&&(this.resetDrawCommands(),this._clippingPlanesState=o),this._defaultTexture=t.defaultTexture,!this._resourcesLoaded||e.mode===D.Z.MORPHING)return;e.mode!==this._sceneMode&&(this._projectTo2D?this.resetDrawCommands():this._updateModelMatrix=!0,this._sceneMode=e.mode),this._featureTableIdDirty&&(!function(e){const t=e._sceneGraph.components,n=t.structuralMetadata;(0,c.Z)(n)&&n.propertyTableCount>0&&(e.featureTableId=function(e,t){const n=t._featureIdLabel,i=t._instanceFeatureIdLabel;let r,o,s,a;for(r=0;r<e.nodes.length;r++)if(a=e.nodes[r],(0,c.Z)(a.instances)&&(s=T.Z.getFeatureIdsByLabel(a.instances.featureIds,i),(0,c.Z)(s)&&(0,c.Z)(s.propertyTableId)))return s.propertyTableId;for(r=0;r<e.nodes.length;r++)for(a=e.nodes[r],o=0;o<a.primitives.length;o++){const e=a.primitives[o],t=T.Z.getFeatureIdsByLabel(e.featureIds,n);if((0,c.Z)(t))return t.propertyTableId}}(t,e),e.applyStyle(e._style))}(this),this._featureTableIdDirty=!1);const s=this._featureTables;for(let t=0;t<s.length;t++)s[t].update(e),s[t].styleCommandsNeededDirty&&this.resetDrawCommands();if(!this._drawCommandsBuilt){this._sceneGraph.buildDrawCommands(e),this._drawCommandsBuilt=!0;const t=this;if(!t._ready)return void t._completeLoad(t,e)}if(!A.Z.equals(this.modelMatrix,this._modelMatrix)){if(e.mode!==D.Z.SCENE3D&&this._projectTo2D)throw new d.Z("ModelExperimental.modelMatrix cannot be changed in 2D or Columbus View if projectTo2D is true.");this._updateModelMatrix=!0,this._modelMatrix=A.Z.clone(this.modelMatrix,this._modelMatrix),this._boundingSphere=i.Z.transform(this._sceneGraph.boundingSphere,this.modelMatrix,this._boundingSphere)}(this._updateModelMatrix||0!==this._minimumPixelSize)&&(this._clampedScale=(0,c.Z)(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._boundingSphere.radius=this._initialRadius*this._clampedScale,this._computedScale=function(e,t){let n=e.scale;if(0!==e.minimumPixelSize&&!e._projectTo2D){const i=t.context,o=Math.max(i.drawingBufferWidth,i.drawingBufferHeight),s=e.modelMatrix;if(U.x=s[12],U.y=s[13],U.z=s[14],e._sceneMode!==D.Z.SCENE3D){const e=t.mapProjection,n=e.ellipsoid.cartesianToCartographic(U,B);e.project(n,U),r.Z.fromElements(U.z,U.x,U.y,U)}const a=e._boundingSphere.radius,u=function(e,t,n){return P.center=e,P.radius=t,n.camera.getPixelSize(P,n.context.drawingBufferWidth,n.context.drawingBufferHeight)}(U,a,t),c=1/u;Math.min(c*(2*a),o)<e.minimumPixelSize&&(n=e.minimumPixelSize*u/(2*e._initialRadius))}return(0,c.Z)(e.maximumScale)?Math.min(e.maximumScale,n):n}(this,e),this._sceneGraph.updateModelMatrix(e),this._updateModelMatrix=!1),this._backFaceCullingDirty&&(this.sceneGraph.updateBackFaceCulling(this._backFaceCulling),this._backFaceCullingDirty=!1),this._shadowsDirty&&(this.sceneGraph.updateShadows(this._shadows),this._shadowsDirty=!1),this._debugShowBoundingVolumeDirty&&(this._sceneGraph.updateShowBoundingVolume(this._debugShowBoundingVolume),this._debugShowBoundingVolumeDirty=!1);const a=this._activeAnimations.update(e);if(this._sceneGraph.update(e,a),this._show&&0!==this._computedScale){const t=this._sceneGraph.components.asset.credits,n=t.length;for(let i=0;i<n;i++){const n=t[i];n.showOnScreen=this._showCreditsOnScreen,e.creditDisplay.addCredit(n)}const i=this._sceneGraph.getDrawCommands(e);e.commandList.push.apply(e.commandList,i)}};const P=new i.Z;const U=new r.Z,B=new o.Z;function G(e,t,n){return{loader:e,type:t,resource:n.resource,modelMatrix:n.modelMatrix,scale:n.scale,minimumPixelSize:n.minimumPixelSize,maximumScale:n.maximumScale,debugShowBoundingVolume:n.debugShowBoundingVolume,enableDebugWireframe:n.enableDebugWireframe,debugWireframe:n.debugWireframe,cull:n.cull,opaquePass:n.opaquePass,allowPicking:n.allowPicking,customShader:n.customShader,content:n.content,show:n.show,color:n.color,colorBlendAmount:n.colorBlendAmount,colorBlendMode:n.colorBlendMode,featureIdLabel:n.featureIdLabel,instanceFeatureIdLabel:n.instanceFeatureIdLabel,pointCloudShading:n.pointCloudShading,clippingPlanes:n.clippingPlanes,lightColor:n.lightColor,imageBasedLighting:n.imageBasedLighting,backFaceCulling:n.backFaceCulling,shadows:n.shadows,showCreditsOnScreen:n.showCreditsOnScreen,splitDirection:n.splitDirection,projectTo2D:n.projectTo2D}}w.prototype.isClippingEnabled=function(){const e=this._clippingPlanes;return(0,c.Z)(e)&&e.enabled&&0!==e.length},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){const e=this._loader;(0,c.Z)(e)&&e.destroy();const t=this._featureTables;if((0,c.Z)(t))for(let e=0;e<t.length;e++)t[e].destroy();this.destroyResources(),this.destroyModelResources();const n=this._clippingPlanes;(0,c.Z)(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,(0,g.Z)(this)},w.prototype.destroyResources=function(){const e=this._resources;for(let t=0;t<e.length;t++)e[t].destroy();this._resources=[]},w.prototype.destroyModelResources=function(){const e=this._modelResources;for(let t=0;t<e.length;t++)e[t].destroy();this._modelResources=[]},w.fromGltf=function(e){if(e=(0,l.Z)(e,l.Z.EMPTY_OBJECT),!(0,c.Z)(e.url)&&!(0,c.Z)(e.gltf))throw new d.Z("options.url is required.");const t=(0,l.Z)(e.url,e.gltf),n={releaseGltfJson:e.releaseGltfJson,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadPositionsFor2D:e.projectTo2D,loadIndicesForWireframe:e.enableDebugWireframe},i=(0,l.Z)(e.basePath,""),r=y.Z.createIfNeeded(i);(0,c.Z)(t.asset)?(n.gltfJson=t,n.baseResource=r,n.gltfResource=r):t instanceof Uint8Array?(n.typedArray=t,n.baseResource=r,n.gltfResource=r):n.gltfResource=y.Z.createIfNeeded(t);const o=G(new h.Z(n),(0,c.Z)(e.content)?m.Z.TILE_GLTF:m.Z.GLTF,e);o.resource=n.gltfResource;return new w(o)},w.fromB3dm=function(e){const t={b3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadPositionsFor2D:e.projectTo2D,loadIndicesForWireframe:e.enableDebugWireframe};return new w(G(new S.Z(t),m.Z.TILE_B3DM,e))},w.fromPnts=function(e){const t={arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset};return new w(G(new C.Z(t),m.Z.TILE_PNTS,e))},w.fromI3dm=function(e){const t={i3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadIndicesForWireframe:e.enableDebugWireframe};return new w(G(new O.Z(t),m.Z.TILE_I3DM,e))},w.fromGeoJson=function(e){const t={geoJson:e.geoJson};return new w(G(new N.Z(t),m.Z.TILE_GEOJSON,e))},w.prototype.applyColorAndShow=function(e){const t=(0,c.Z)(e)&&(0,c.Z)(e.color),n=(0,c.Z)(e)&&(0,c.Z)(e.show);this._color=t?e.color.evaluateColor(void 0,this._color):v.Z.clone(v.Z.WHITE,this._color),this._show=!n||e.show.evaluate(void 0)},w.prototype.applyStyle=function(e){if((0,c.Z)(this.featureTableId)&&this.featureTables[this.featureTableId].featuresLength>0){this.featureTables[this.featureTableId].applyStyle(e)}else this.applyColorAndShow(e);this.resetDrawCommands()}},72190:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(81737),r=n(6785),o=n(51138),s=n(54485),a=n(90332),u=n(1577),c=n(85003);function l(e,t,n){this._tileset=e,this._tile=t,this._resource=n,this._model=void 0,this._metadata=void 0,this._group=void 0}function d(e,t,n,r){const s={cull:!1,releaseGltfJson:!0,opaquePass:u.Z.CESIUM_3D_TILE,modelMatrix:t.computedTransform,upAxis:e._gltfUpAxis,forwardAxis:i.Z.X,incrementallyLoadTextures:!1,customShader:e.customShader,content:n,show:e.show,colorBlendMode:e.colorBlendMode,colorBlendAmount:e.colorBlendAmount,lightColor:e.lightColor,imageBasedLighting:e.imageBasedLighting,featureIdLabel:e.featureIdLabel,instanceFeatureIdLabel:e.instanceFeatureIdLabel,pointCloudShading:e.pointCloudShading,clippingPlanes:e.clippingPlanes,backFaceCulling:e.backFaceCulling,shadows:e.shadows,showCreditsOnScreen:e.showCreditsOnScreen,splitDirection:e.splitDirection,enableDebugWireframe:e._enableDebugWireframe,debugWireframe:e.debugWireframe,projectTo2D:!0};return(0,o.Z)(r,s)}Object.defineProperties(l.prototype,{featuresLength:{get:function(){const e=this._model,t=e.featureTables,n=e.featureTableId;return(0,s.Z)(t)&&(0,s.Z)(t[n])?t[n].featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){const e=this._model,t=e.featureTables,n=e.featureTableId;if((0,s.Z)(t)&&(0,s.Z)(t[n]))return t[n]}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),l.prototype.getFeature=function(e){const t=this._model,n=t.featureTableId;if(!(0,s.Z)(n))return;return t.featureTables[n].getFeature(e)},l.prototype.hasProperty=function(e,t){const n=this._model,i=n.featureTableId;if(!(0,s.Z)(i))return!1;return n.featureTables[i].hasProperty(e,t)},l.prototype.applyDebugSettings=function(e,t){t=e?t:r.Z.WHITE,0===this.featuresLength?this._model.color=t:(0,s.Z)(this.batchTable)&&this.batchTable.setAllColor(t)},l.prototype.applyStyle=function(e){this._model.style=e},l.prototype.update=function(e,t){const n=this._model,i=this._tile;n.colorBlendAmount=e.colorBlendAmount,n.colorBlendMode=e.colorBlendMode,n.modelMatrix=i.computedTransform,n.customShader=e.customShader,n.pointCloudShading=e.pointCloudShading,n.featureIdLabel=e.featureIdLabel,n.instanceFeatureIdLabel=e.instanceFeatureIdLabel,n.lightColor=e.lightColor,n.imageBasedLighting=e.imageBasedLighting,n.backFaceCulling=e.backFaceCulling,n.shadows=e.shadows,n.showCreditsOnScreen=e.showCreditsOnScreen,n.splitDirection=e.splitDirection,n.debugWireframe=e.debugWireframe;const r=e.clippingPlanes;n.referenceMatrix=e.clippingPlanesOriginMatrix,(0,s.Z)(r)&&i.clippingPlanesDirty&&(n._clippingPlanes=r.enabled&&i._isClipped?r:void 0),(0,s.Z)(r)&&(0,s.Z)(n._clippingPlanes)&&n._clippingPlanes!==r&&(n._clippingPlanes=r),n.update(t)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),(0,a.Z)(this)},l.fromGltf=function(e,t,n,i){const r=new l(e,t,n),o=d(e,t,r,{gltf:i,basePath:n});return r._model=c.Z.fromGltf(o),r},l.fromB3dm=function(e,t,n,i,r){const o=new l(e,t,n),s=d(e,t,o,{arrayBuffer:i,byteOffset:r,resource:n});return o._model=c.Z.fromB3dm(s),o},l.fromI3dm=function(e,t,n,i,r){const o=new l(e,t,n),s=d(e,t,o,{arrayBuffer:i,byteOffset:r,resource:n});return o._model=c.Z.fromI3dm(s),o},l.fromPnts=function(e,t,n,i,r){const o=new l(e,t,n),s=d(e,t,o,{arrayBuffer:i,byteOffset:r,resource:n});return o._model=c.Z.fromPnts(s),o},l.fromGeoJson=function(e,t,n,i){const r=new l(e,t,n),o=d(e,t,r,{geoJson:i,resource:n});return r._model=c.Z.fromGeoJson(o),r}},30189:(e,t,n)=>{n.d(t,{Z:()=>d});var i=n(88779),r=n(54485),o=n(92893),s=n(97262),a=n(13715),u=n(42279),c=n(19726);function l(e,t,n){this._animation=t,this._name=t.name,this._runtimeChannels=void 0,this._startTime=s.Z.clone(n.startTime),this._delay=(0,i.Z)(n.delay,0),this._stopTime=s.Z.clone(n.stopTime),this.removeOnStop=(0,i.Z)(n.removeOnStop,!1),this._multiplier=(0,i.Z)(n.multiplier,1),this._reverse=(0,i.Z)(n.reverse,!1),this._loop=(0,i.Z)(n.loop,a.Z.NONE),this._animationTime=n.animationTime,this._prevAnimationDelta=void 0,this.start=new o.Z,this.update=new o.Z,this.stop=new o.Z,this._state=u.Z.STOPPED,this._computedStartTime=void 0,this._duration=void 0;const l=this;this._raiseStartEvent=function(){l.start.raiseEvent(e,l)},this._updateEventTime=0,this._raiseUpdateEvent=function(){l.update.raiseEvent(e,l,l._updateEventTime)},this._raiseStopEvent=function(){l.stop.raiseEvent(e,l)},this._model=e,this._localStartTime=void 0,this._localStopTime=void 0,function(e){let t=Number.MAX_VALUE,n=-Number.MAX_VALUE;const i=e._model.sceneGraph,o=e._animation.channels,s=o.length,a=[];for(let u=0;u<s;u++){const s=o[u],l=s.target;if(!(0,r.Z)(l))continue;const d=l.node.index,h=i._runtimeNodes[d],p=new c.Z({channel:s,runtimeAnimation:e,runtimeNode:h}),f=s.sampler.input;t=Math.min(t,f[0]),n=Math.max(n,f[f.length-1]),a.push(p)}e._runtimeChannels=a,e._localStartTime=t,e._localStopTime=n}(this)}Object.defineProperties(l.prototype,{animation:{get:function(){return this._animation}},name:{get:function(){return this._name}},runtimeChannels:{get:function(){return this._runtimeChannels}},model:{get:function(){return this._model}},localStartTime:{get:function(){return this._localStartTime}},localStopTime:{get:function(){return this._localStopTime}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}}),l.prototype.animate=function(e){const t=this._runtimeChannels,n=t.length;for(let i=0;i<n;i++)t[i].animate(e)};const d=l},19726:(e,t,n)=>{n.d(t,{Z:()=>y});var i=n(93517),r=n(17497),o=n(7317),s=n(88779),a=n(54485),u=n(29695),c=n(26092),l=n(94292),d=n(53839),h=n(17937),p=n(20291),f=n(49273);const _=d.Z.AnimatedPropertyType;function m(e){const t=(e=(0,s.Z)(e,s.Z.EMPTY_OBJECT)).channel,n=e.runtimeAnimation,o=e.runtimeNode;r.Z.typeOf.object("options.channel",t),r.Z.typeOf.object("options.runtimeAnimation",n),r.Z.typeOf.object("options.runtimeNode",o),this._channel=t,this._runtimeAnimation=n,this._runtimeNode=o,this._splines=[],this._path=void 0,function(e){const t=e._channel,n=t.sampler,r=n.input,o=n.output,s=n.interpolation,u=t.target.path,l=e._runtimeNode,d=(0,a.Z)(l.morphWeights)?l.morphWeights.length:1,h=function(e,t,n,i,r){const o=[];if(i===_.WEIGHTS){const s=t.length/r;let a,u;for(a=0;a<r;a++){const l=new Array(s);let d=a;if(n===c.Z.CUBICSPLINE)for(u=0;u<s;u+=3)l[u]=t[d],l[u+1]=t[d+r],l[u+2]=t[d+2*r],d+=3*r;else for(u=0;u<s;u++)l[u]=t[d],d+=r;o.push(T(e,l,n,i))}}else o.push(T(e,t,n,i));return o}(r,o,s,u,d);switch(e._splines=h,e._path=u,u){case _.TRANSLATION:case _.SCALE:Z=new i.Z;break;case _.ROTATION:Z=new p.Z;case _.WEIGHTS:}}(this)}function T(e,t,n,i){if(1===e.length&&1===t.length)return new o.Z(t[0]);switch(n){case c.Z.STEP:return new h.Z({times:e,points:t});case c.Z.CUBICSPLINE:return function(e,t){const n=[],i=[],r=[],o=t.length;for(let e=0;e<o;e+=3)i.push(t[e]),n.push(t[e+1]),r.push(t[e+2]);return i.splice(0,1),r.length=r.length-1,new u.Z({times:e,points:n,inTangents:i,outTangents:r})}(e,t);case c.Z.LINEAR:return i===_.ROTATION?new f.Z({times:e,points:t}):new l.Z({times:e,points:t})}}let Z;Object.defineProperties(m.prototype,{channel:{get:function(){return this._channel}},runtimeAnimation:{get:function(){return this._runtimeAnimation}},runtimeNode:{get:function(){return this._runtimeNode}},splines:{get:function(){return this._splines}}}),m.prototype.animate=function(e){const t=this._splines,n=this._path,i=this._runtimeAnimation.model;if(n===_.WEIGHTS){const n=this._runtimeNode.morphWeights,r=n.length;for(let o=0;o<r;o++){const r=t[o],s=i.clampAnimations?r.clampTime(e):r.wrapTime(e);n[o]=r.evaluate(s)}}else{const r=t[0],o=i.clampAnimations?r.clampTime(e):r.wrapTime(e);this._runtimeNode[n]=r.evaluate(o,Z)}};const y=m},9469:(e,t,n)=>{n.d(t,{Z:()=>m});var i=n(88779),r=n(54485),o=n(20176),s=n(92893),a=n(97262),u=n(22874),c=n(30189),l=n(13715),d=n(42279);function h(e){this.animationAdded=new s.Z,this.animationRemoved=new s.Z,this.animateWhilePaused=!1,this._model=e,this._runtimeAnimations=[],this._previousTime=void 0}function p(e,t,n){const i=e._model,r=new c.Z(i,t,n);return e._runtimeAnimations.push(r),e.animationAdded.raiseEvent(i,r),r}Object.defineProperties(h.prototype,{length:{get:function(){return this._runtimeAnimations.length}},model:{get:function(){return this._model}}}),h.prototype.add=function(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT);const t=this._model;if(!t.ready)throw new o.Z("Animations are not loaded.  Wait for ModelExperimental.readyPromise to resolve.");const n=t.sceneGraph.components.animations;if(!(0,r.Z)(e.name)&&!(0,r.Z)(e.index))throw new o.Z("Either options.name or options.index must be defined.");if((0,r.Z)(e.multiplier)&&e.multiplier<=0)throw new o.Z("options.multiplier must be greater than zero.");if((0,r.Z)(e.index)&&(e.index>=n.length||e.index<0))throw new o.Z("options.index must be a valid animation index.");let s=e.index;if((0,r.Z)(s))return p(this,n[s],e);const a=n.length;for(let t=0;t<a;++t)if(n[t].name===e.name){s=t;break}if(!(0,r.Z)(s))throw new o.Z("options.name must be a valid animation name.");return p(this,n[s],e)},h.prototype.addAll=function(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT);const t=this._model;if(!t.ready)throw new o.Z("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if((0,r.Z)(e.multiplier)&&e.multiplier<=0)throw new o.Z("options.multiplier must be greater than zero.");const n=t.sceneGraph.components.animations,s=[],a=n.length;for(let t=0;t<a;++t){const i=p(this,n[t],e);s.push(i)}return s},h.prototype.remove=function(e){if(!(0,r.Z)(e))return!1;const t=this._runtimeAnimations,n=t.indexOf(e);return-1!==n&&(t.splice(n,1),this.animationRemoved.raiseEvent(this._model,e),!0)},h.prototype.removeAll=function(){const e=this._model,t=this._runtimeAnimations,n=t.length;this._runtimeAnimations.length=0;for(let i=0;i<n;++i)this.animationRemoved.raiseEvent(e,t[i])},h.prototype.contains=function(e){return!!(0,r.Z)(e)&&-1!==this._runtimeAnimations.indexOf(e)},h.prototype.get=function(e){if(!(0,r.Z)(e))throw new o.Z("index is required.");if(e>=this._runtimeAnimations.length||e<0)throw new o.Z("index must be valid within the range of the collection");return this._runtimeAnimations[e]};const f=[];function _(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}h.prototype.update=function(e){const t=this._runtimeAnimations;let n=t.length;if(0===n)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&a.Z.equals(e.time,this._previousTime))return!1;this._previousTime=a.Z.clone(e.time,this._previousTime);let o=!1;const s=e.time,c=this._model;for(let c=0;c<n;++c){const n=t[c];(0,r.Z)(n._computedStartTime)||(n._computedStartTime=a.Z.addSeconds((0,i.Z)(n.startTime,s),n.delay,new a.Z)),(0,r.Z)(n._duration)||(n._duration=n.localStopTime*(1/n.multiplier));const h=n._computedStartTime,p=n._duration,_=n.stopTime,m=a.Z.lessThanOrEquals(h,s),T=(0,r.Z)(_)&&a.Z.greaterThan(s,_);let Z=0;if(0!==p){const e=a.Z.secondsDifference(T?_:s,h);Z=(0,r.Z)(n._animationTime)?n._animationTime(p,e):e/p}const y=n.loop===l.Z.REPEAT||n.loop===l.Z.MIRRORED_REPEAT,g=(m||y&&!(0,r.Z)(n.startTime))&&(Z<=1||y)&&!T;if(Z===n._prevAnimationDelta){if(g!==(n._state===d.Z.STOPPED))continue}if(n._prevAnimationDelta=Z,g||n._state===d.Z.ANIMATING){if(g&&n._state===d.Z.STOPPED&&(n._state=d.Z.ANIMATING,n.start.numberOfListeners>0&&e.afterRender.push(n._raiseStartEvent)),n.loop===l.Z.REPEAT)Z-=Math.floor(Z);else if(n.loop===l.Z.MIRRORED_REPEAT){const e=Math.floor(Z),t=Z-e;Z=e%2==1?1-t:t}n.reverse&&(Z=1-Z);let t=Z*p*n.multiplier;t=u.Z.clamp(t,n.localStartTime,n.localStopTime),n.animate(t),n.update.numberOfListeners>0&&(n._updateEventTime=t,e.afterRender.push(n._raiseUpdateEvent)),o=!0,g||(n._state=d.Z.STOPPED,n.stop.numberOfListeners>0&&e.afterRender.push(n._raiseStopEvent),n.removeOnStop&&f.push(n))}}n=f.length;for(let i=0;i<n;++i){const n=f[i];t.splice(t.indexOf(n),1),e.afterRender.push(_(this,c,n))}return f.length=0,o};const m=h},28901:(e,t,n)=>{n.d(t,{Z:()=>A});var i=n(995),r=n(52351),o=n(22874),s=n(17497),a=n(55077),u=n(88779),c=n(54485),l=n(71087),d=n(71118),h=n(1577),p=n(74064),f=n(21514),_=n(18061),m=n(49616),T=n(59964);function Z(e){const t=(e=(0,u.Z)(e,u.Z.EMPTY_OBJECT)).command,n=e.primitiveRenderResources;s.Z.typeOf.object("options.command",t),s.Z.typeOf.object("options.primitiveRenderResources",n),this._command=t,this._modelMatrix=d.Z.clone(t.modelMatrix,new d.Z),this._modelMatrix2DDirty=!1,this._styleCommandsNeeded=n.styleCommandsNeeded,this._backFaceCulling=t.renderState.cull.enabled,this._cullFace=t.renderState.cull.face,this._shadows=n.model.shadows,this._debugShowBoundingVolume=t.debugShowBoundingVolume,this._commandList=[],this._commandList2D=[],this._runtimePrimitive=n.runtimePrimitive,this._model=n.model,function(e,t){const n=e._commandList,r=e._command,o=e._styleCommandsNeeded;if((0,c.Z)(o)&&r.pass!==h.Z.TRANSLUCENT){const e=function(e){const t=l.Z.shallowClone(e);t.pass=h.Z.TRANSLUCENT;const n=(0,a.Z)(e.renderState,!0);return n.cull.enabled=!1,n.depthTest.enabled=!0,n.depthMask=!1,n.blending=i.Z.ALPHA_BLEND,t.renderState=p.Z.fromCache(n),t}(r);switch(o){case T.Z.ALL_OPAQUE:n.push(r);break;case T.Z.ALL_TRANSLUCENT:n.push(e);break;case T.Z.OPAQUE_AND_TRANSLUCENT:n.push(r,e);break;default:throw new f.Z("styleCommandsNeeded is not a valid value.")}}else n.push(r)}(this)}function y(e){const t=[];return t.push.apply(t,e._commandList),t.push.apply(t,e._commandList2D),t}Object.defineProperties(Z.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},model:{get:function(){return this._model}},primitiveType:{get:function(){return this._command.primitiveType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=d.Z.clone(e,this._modelMatrix),this._modelMatrix2DDirty=!0,function(e){const t=e.modelMatrix,n=e.runtimePrimitive.boundingSphere,i=e._commandList,o=i.length;for(let e=0;e<o;e++){const o=i[e];o.modelMatrix=d.Z.clone(t,o.modelMatrix),o.boundingVolume=r.Z.transform(n,o.modelMatrix,o.boundingVolume)}}(this)}},boundingVolume:{get:function(){return this._command.boundingVolume}},shadows:{get:function(){return this._shadows},set:function(e){this._shadows=e,function(e){const t=e.shadows,n=m.Z.castShadows(t),i=m.Z.receiveShadows(t),r=y(e),o=r.length;for(let e=0;e<o;e++){const t=r[e];t.castShadows=n,t.receiveShadows=i}}(this)}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){const t=this.runtimePrimitive.primitive.material.doubleSided,n=(0,c.Z)(this._model.color)&&this._model.color.alpha<1,i=e&&!t&&!n;this._backFaceCulling!==i&&(this._backFaceCulling=i,function(e){const t=e.backFaceCulling,n=y(e),i=n.length;for(let e=0;e<i;e++){const i=n[e];if(i.pass===h.Z.TRANSLUCENT)continue;const r=(0,a.Z)(i.renderState,!0);r.cull.enabled=t,i.renderState=p.Z.fromCache(r)}}(this))}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,function(e){const t=e.cullFace,n=y(e),i=n.length;for(let e=0;e<i;e++){const i=n[e],r=(0,a.Z)(i.renderState,!0);r.cull.face=t,i.renderState=p.Z.fromCache(r)}}(this))}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume=e,function(e){const t=e.debugShowBoundingVolume,n=y(e),i=n.length;for(let e=0;e<i;e++){n[e].debugShowBoundingVolume=t}}(this)}}});const g=new d.Z;function I(e){const t=l.Z.shallowClone(e);return t.modelMatrix=new d.Z,t.boundingVolume=new r.Z,t}Z.prototype.getCommands=function(e){const t=this._commandList,n=this._commandList2D,i=function(e,t){if(t.mode!==_.Z.SCENE2D||e.model._projectTo2D)return;const n=t.mapProjection.ellipsoid.maximumRadius*o.Z.PI,i=e.model.sceneGraph._boundingSphere2D,r=i.center.y-i.radius,s=i.center.y+i.radius;return r<n&&s>n||r<-n&&s>-n}(this,e);if(i&&0===n.length){const e=t.length;for(let i=0;i<e;i++){const e=I(t[i]);n.push(e)}this._modelMatrix2DDirty=!0}this._modelMatrix2DDirty&&(!function(e,t){const n=e.modelMatrix,i=e.runtimePrimitive.boundingSphere,s=e._commandList2D,a=s.length;if(0===a)return;const u=d.Z.clone(n,g);u[13]-=2*o.Z.sign(n[13])*o.Z.PI*t.mapProjection.ellipsoid.maximumRadius;for(let e=0;e<a;e++){const t=s[e];t.modelMatrix=d.Z.clone(u,t.modelMatrix),t.boundingVolume=r.Z.transform(i,t.modelMatrix,t.boundingVolume)}}(this,e),this._modelMatrix2DDirty=!1);const s=[];return s.push.apply(s,t),i&&s.push.apply(s,n),s};const A=Z},1179:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(93517),r=n(17497),o=n(88779),s=n(54485),a=n(20176),u=n(71118),c=n(49742),l=n(4821),d=n(4135),h=n(20291);function p(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),r.Z.typeOf.object("options.node",e.node),r.Z.typeOf.object("options.transform",e.transform),r.Z.typeOf.object("options.transformToRoot",e.transformToRoot),r.Z.typeOf.object("options.sceneGraph",e.sceneGraph),r.Z.typeOf.object("options.children",e.children);const t=e.sceneGraph,n=e.transform,i=e.transformToRoot,a=e.node;this._sceneGraph=t,this._children=e.children,this._node=a,this._name=a.name,this._originalTransform=u.Z.clone(n,this._originalTransform),this._transform=u.Z.clone(n,this._transform),this._transformToRoot=u.Z.clone(i,this._transformToRoot),this._originalTransform=u.Z.clone(n,this._originalTransform);const c=u.Z.multiply(i,n,new u.Z);this._computedTransform=c,this._transformDirty=!1,this._transformParameters=(0,s.Z)(a.matrix)?void 0:new d.Z(a.translation,a.rotation,a.scale),this._morphWeights=(0,s.Z)(a.morphWeights)?a.morphWeights.slice():[],this._runtimeSkin=void 0,this._computedJointMatrices=[],this.pipelineStages=[],this.runtimePrimitives=[],this.updateStages=[]}function f(e,t){e._transformDirty=!0,e._transform=u.Z.fromTranslationRotationScale(t,e._transform)}Object.defineProperties(p.prototype,{node:{get:function(){return this._node}},sceneGraph:{get:function(){return this._sceneGraph}},children:{get:function(){return this._children}},transform:{get:function(){return this._transform},set:function(e){u.Z.equals(this._transform,e)||(this._transformDirty=!0,this._transform=u.Z.clone(e,this._transform))}},transformToRoot:{get:function(){return this._transformToRoot}},computedTransform:{get:function(){return this._computedTransform}},originalTransform:{get:function(){return this._originalTransform}},translation:{get:function(){return(0,s.Z)(this._transformParameters)?this._transformParameters.translation:void 0},set:function(e){const t=this._transformParameters;if(!(0,s.Z)(t))throw new a.Z("The translation of a node cannot be set if it was defined using a matrix in the model.");const n=t.translation;i.Z.equals(n,e)||(t.translation=i.Z.clone(e,t.translation),f(this,t))}},rotation:{get:function(){return(0,s.Z)(this._transformParameters)?this._transformParameters.rotation:void 0},set:function(e){const t=this._transformParameters;if(!(0,s.Z)(t))throw new a.Z("The rotation of a node cannot be set if it was defined using a matrix in the model.");const n=t.rotation;h.Z.equals(n,e)||(t.rotation=h.Z.clone(e,t.rotation),f(this,t))}},scale:{get:function(){return(0,s.Z)(this._transformParameters)?this._transformParameters.scale:void 0},set:function(e){const t=this._transformParameters;if(!(0,s.Z)(t))throw new a.Z("The scale of a node cannot be set if it was defined using a matrix in the model.");const n=t.scale;i.Z.equals(n,e)||(t.scale=i.Z.clone(e,t.scale),f(this,t))}},morphWeights:{get:function(){return this._morphWeights},set:function(e){const t=e.length;if(this._morphWeights.length!==t)throw new a.Z("value must have the same length as the original weights array.");for(let n=0;n<t;n++)this._morphWeights[n]=e[n]}},runtimeSkin:{get:function(){return this._runtimeSkin}},computedJointMatrices:{get:function(){return this._computedJointMatrices}}}),p.prototype.getChild=function(e){if(r.Z.typeOf.number("index",e),e<0||e>=this.children.length)throw new a.Z("index must be greater than or equal to 0 and less than the number of children.");return this.sceneGraph.runtimeNodes[this.children[e]]},p.prototype.configurePipeline=function(){const e=this.node,t=this.pipelineStages;t.length=0;const n=this.updateStages;n.length=0,(0,s.Z)(e.instances)&&t.push(c.Z),n.push(l.Z)},p.prototype.updateComputedTransform=function(){this._computedTransform=u.Z.multiply(this._transformToRoot,this._transform,this._computedTransform)},p.prototype.updateJointMatrices=function(){const e=this._runtimeSkin;if(!(0,s.Z)(e))return;e.updateJointMatrices();const t=this._computedJointMatrices,n=e.jointMatrices,i=n.length;for(let e=0;e<i;e++){(0,s.Z)(t[e])||(t[e]=new u.Z);const i=u.Z.multiplyTransformation(this.transformToRoot,this.transform,t[e]),r=u.Z.inverseTransformation(i,t[e]);t[e]=u.Z.multiplyTransformation(r,n[e],t[e])}}},62716:(e,t,n)=>{n.d(t,{Z:()=>O});var i=n(17497),r=n(88779),o=n(54485),s=n(84473),a=n(13052),u=n(89639),c=n(32347),l=n(86461),d=n(92885),h=n(94452),p=n(13679),f=n(80249),_=n(99491),m=n(18291),T=n(37463),Z=n(59137),y=n(18591),g=n(72493),I=n(64172),A=n(18061),b=n(13887),E=n(93435),S=n(97648),N=n(76180);function O(e){const t=(e=(0,r.Z)(e,r.Z.EMPTY_OBJECT)).primitive,n=e.node,o=e.model;i.Z.typeOf.object("options.primitive",t),i.Z.typeOf.object("options.node",n),i.Z.typeOf.object("options.model",o),this.primitive=t,this.node=n,this.model=o,this.pipelineStages=[],this.drawCommand=void 0,this.boundingSphere=void 0,this.boundingSphere2D=void 0,this.positionBuffer2D=void 0,this.updateStages=[]}O.prototype.configurePipeline=function(e){const t=this.pipelineStages;t.length=0;const n=this.primitive,i=this.node,r=this.model,O=r.customShader,C=e.context.webgl2,v=e.mode!==A.Z.SCENE3D&&!e.scene3DOnly&&r._projectTo2D,D=(0,o.Z)(n.morphTargets)&&n.morphTargets.length>0,M=(0,o.Z)(i.skin),x=(0,o.Z)(O),w=!(x&&(0,o.Z)(O.fragmentShaderText))||O.mode!==c.Z.REPLACE_MATERIAL,R=Z.Z.hasQuantizedAttributes(n.attributes),F=r.debugWireframe&&s.Z.isTriangles(n.primitiveType)&&(r._enableDebugWireframe||C),L=r.pointCloudShading,P=(0,o.Z)(L)&&L.attenuation,U=function(e,t,n){let i;if((0,o.Z)(t.instances)&&(i=Z.Z.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),(0,o.Z)(i)))return{hasFeatureIds:!0,hasPropertyTable:(0,o.Z)(i.propertyTableId)};if(i=Z.Z.getFeatureIdsByLabel(n.featureIds,e.featureIdLabel),(0,o.Z)(i))return{hasFeatureIds:!0,hasPropertyTable:(0,o.Z)(i.propertyTableId)};return{hasFeatureIds:!1,hasPropertyTable:!1}}(r,i,n);v&&t.push(b.Z),t.push(f.Z),F&&t.push(N.Z),D&&t.push(y.Z),M&&t.push(S.Z),P&&n.primitiveType===s.Z.POINTS&&t.push(I.Z),R&&t.push(p.Z),w&&t.push(m.Z),t.push(d.Z),t.push(T.Z),U.hasPropertyTable&&(t.push(E.Z),t.push(u.Z),t.push(h.Z)),x&&t.push(l.Z),t.push(_.Z),r.allowPicking&&t.push(g.Z),t.push(a.Z)}},86667:(e,t,n)=>{n.d(t,{Z:()=>E});var i=n(3584),r=n(52351),o=n(93517),s=n(17497),a=n(88779),u=n(54485),c=n(31412),l=n(71118),d=n(61610),h=n(57622),p=n(62716),f=n(1179),_=n(96611),m=n(59137),T=n(85311),Z=n(65295),y=n(99950),g=n(86943),I=n(18061),A=n(77493),b=n(7004);function E(e){const t=(e=(0,a.Z)(e,a.Z.EMPTY_OBJECT)).modelComponents;s.Z.typeOf.object("options.model",e.model),s.Z.typeOf.object("options.modelComponents",t),this._model=e.model,this._components=t,this._pipelineStages=[],this._updateStages=[],this._runtimeNodes=[],this._rootNodes=[],this._skinnedNodes=[],this._runtimeSkins=[],this.modelPipelineStages=[],this._boundingSphere=void 0,this._boundingSphere2D=void 0,this._computedModelMatrix=l.Z.clone(l.Z.IDENTITY),this._computedModelMatrix2D=l.Z.clone(l.Z.IDENTITY),this._axisCorrectionMatrix=m.Z.getAxisCorrectionMatrix(t.upAxis,t.forwardAxis,new l.Z),function(e){const t=e._components,n=t.scene;S(e);const i=t.nodes,r=i.length;e._runtimeNodes=new Array(r);const o=n.nodes.length,s=l.Z.IDENTITY;for(let t=0;t<o;t++){const i=O(e,n.nodes[t],s);e._rootNodes.push(i)}const a=t.skins,u=e._runtimeSkins,c=a.length;for(let t=0;t<c;t++){const n=a[t];u.push(new _.Z({skin:n,sceneGraph:e}))}const d=e._skinnedNodes,h=d.length;for(let t=0;t<h;t++){const n=d[t],r=e._runtimeNodes[n],o=i[n].skin.index;r._runtimeSkin=u[o],r.updateJointMatrices()}}(this)}function S(e){const t=e._components,n=e._model;e._computedModelMatrix=l.Z.multiplyTransformation(n.modelMatrix,t.transform,e._computedModelMatrix),e._computedModelMatrix=l.Z.multiplyTransformation(e._computedModelMatrix,e._axisCorrectionMatrix,e._computedModelMatrix),e._computedModelMatrix=l.Z.multiplyByUniformScale(e._computedModelMatrix,n.computedScale,e._computedModelMatrix)}Object.defineProperties(E.prototype,{components:{get:function(){return this._components}},computedModelMatrix:{get:function(){return this._computedModelMatrix}},axisCorrectionMatrix:{get:function(){return this._axisCorrectionMatrix}},boundingSphere:{get:function(){return this._boundingSphere}}});const N=new o.Z;function O(e,t,n){const i=[],r=m.Z.getNodeTransform(t),o=t.children.length;for(let s=0;s<o;s++){const o=O(e,t.children[s],l.Z.multiplyTransformation(n,r,new l.Z));i.push(o)}const s=new f.Z({node:t,transform:r,transformToRoot:n,children:i,sceneGraph:e}),a=t.primitives.length;for(let n=0;n<a;n++)s.runtimePrimitives.push(new p.Z({primitive:t.primitives[n],node:t,model:e._model}));const c=t.index;return e._runtimeNodes[c]=s,(0,u.Z)(t.skin)&&e._skinnedNodes.push(c),c}const C=new o.Z,v=new o.Z,D=new o.Z,M=new o.Z;function x(e,t){for(let n=0;n<e._runtimeNodes.length;n++){const i=e._runtimeNodes[n];for(let e=0;e<i.runtimePrimitives.length;e++){t(i.runtimePrimitives[e])}}}E.prototype.buildDrawCommands=function(e){const t=this._model,n=new T.Z(t);this.configurePipeline();const s=this.modelPipelineStages;let a,u,c;for(a=0;a<s.length;a++){s[a].process(n,t,e)}const d=o.Z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,C),h=o.Z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,v);for(a=0;a<this._runtimeNodes.length;a++){const t=this._runtimeNodes[a];t.configurePipeline();const s=t.pipelineStages,p=new y.Z(n,t);for(u=0;u<s.length;u++){s[u].process(p,t.node,e)}const f=t.computedTransform;for(u=0;u<t.runtimePrimitives.length;u++){const n=t.runtimePrimitives[u];n.configurePipeline(e);const s=n.pipelineStages,a=new g.Z(p,n);for(c=0;c<s.length;c++){s[c].process(a,n.primitive,e)}n.boundingSphere=r.Z.clone(a.boundingSphere,new r.Z);const _=l.Z.multiplyByPoint(f,a.positionMin,D),m=l.Z.multiplyByPoint(f,a.positionMax,M);o.Z.minimumByComponent(d,_,d),o.Z.maximumByComponent(h,m,h);const T=(0,i.Z)(a,e);n.drawCommand=T}}this._boundingSphere=r.Z.fromCornerPoints(d,h,new r.Z),this._boundingSphere=r.Z.transformWithoutScale(this._boundingSphere,this._axisCorrectionMatrix,this._boundingSphere),t._boundingSphere=r.Z.transform(this._boundingSphere,t.modelMatrix,t._boundingSphere),t._initialRadius=t._boundingSphere.radius,t._boundingSphere.radius*=t._clampedScale},E.prototype.configurePipeline=function(){const e=this.modelPipelineStages;e.length=0;const t=this._model;(0,u.Z)(t.color)&&e.push(d.Z),t.imageBasedLighting.enabled&&e.push(c.Z),t.isClippingEnabled()&&e.push(h.Z),(0,u.Z)(t.splitDirection)&&t.splitDirection!==A.Z.NONE&&e.push(Z.Z)},E.prototype.update=function(e,t){let n,i,r;for(n=0;n<this._runtimeNodes.length;n++){const o=this._runtimeNodes[n];for(i=0;i<o.updateStages.length;i++){o.updateStages[i].update(o,this,e)}const s=e.mode!==I.Z.SCENE3D&&this._model._projectTo2D;for(t&&!s&&this.updateJointMatrices(),i=0;i<o.runtimePrimitives.length;i++){const e=o.runtimePrimitives[i];for(r=0;r<e.updateStages.length;r++){e.updateStages[r].update(e)}}}},E.prototype.updateModelMatrix=function(e){S(this),e.mode!==I.Z.SCENE3D&&function(e,t){const n=e._computedModelMatrix,i=l.Z.getTranslation(n,N);if(o.Z.equals(i,o.Z.ZERO)){const i=e.boundingSphere.center,r=b.Z.wgs84To2DModelMatrix(t.mapProjection,i,e._computedModelMatrix2D);e._computedModelMatrix2D=l.Z.multiply(r,n,e._computedModelMatrix2D)}else e._computedModelMatrix2D=b.Z.basisTo2D(t.mapProjection,n,e._computedModelMatrix2D);e._boundingSphere2D=r.Z.transform(e._boundingSphere,e._computedModelMatrix2D,e._boundingSphere2D)}(this,e);const t=this._rootNodes;for(let e=0;e<t.length;e++){this._runtimeNodes[t[e]]._transformDirty=!0}},E.prototype.updateJointMatrices=function(){const e=this._skinnedNodes,t=e.length;for(let n=0;n<t;n++){const t=e[n];this._runtimeNodes[t].updateJointMatrices()}},E.prototype.updateBackFaceCulling=function(e){x(this,(function(t){t.drawCommand.backFaceCulling=e}))},E.prototype.updateShadows=function(e){x(this,(function(t){t.drawCommand.shadows=e}))},E.prototype.updateShowBoundingVolume=function(e){x(this,(function(t){t.drawCommand.debugShowBoundingVolume=e}))},E.prototype.getDrawCommands=function(e){const t=[];return x(this,(function(n){const i=n.drawCommand.getCommands(e);t.push.apply(t,i)})),t}},96611:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(71118),r=n(17497),o=n(88779);function s(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),r.Z.typeOf.object("options.skin",e.skin),r.Z.typeOf.object("options.sceneGraph",e.sceneGraph),this._sceneGraph=e.sceneGraph;const t=e.skin;this._skin=t,this._inverseBindMatrices=void 0,this._joints=[],this._jointMatrices=[],function(e){const t=e.skin,n=t.inverseBindMatrices;e._inverseBindMatrices=n;const r=t.joints,o=r.length,s=e.sceneGraph._runtimeNodes,u=e.joints,c=e._jointMatrices;for(let e=0;e<o;e++){const t=s[r[e].index];u.push(t);const o=a(t,n[e],new i.Z);c.push(o)}}(this)}function a(e,t,n){const r=i.Z.multiplyTransformation(e.transformToRoot,e.transform,n);return n=i.Z.multiplyTransformation(r,t,n)}Object.defineProperties(s.prototype,{skin:{get:function(){return this._skin}},sceneGraph:{get:function(){return this._sceneGraph}},inverseBindMatrices:{get:function(){return this._inverseBindMatrices}},joints:{get:function(){return this._joints}},jointMatrices:{get:function(){return this._jointMatrices}}}),s.prototype.updateJointMatrices=function(){const e=this._jointMatrices,t=e.length;for(let n=0;n<t;n++){const t=this.joints[n],i=this.inverseBindMatrices[n];e[n]=a(t,i,e[n])}}},12361:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(17497),r=n(20176);const o={GLTF:"GLTF",TILE_GLTF:"TILE_GLTF",TILE_B3DM:"B3DM",TILE_I3DM:"I3DM",TILE_PNTS:"PNTS",TILE_GEOJSON:"TILE_GEOJSON",is3DTiles:function(e){switch(i.Z.typeOf.string("modelType",e),e){case o.TILE_GLTF:case o.TILE_B3DM:case o.TILE_I3DM:case o.TILE_PNTS:case o.TILE_GEOJSON:return!0;case o.GLTF:return!1;default:throw new r.Z("modelType is not a valid value.")}}},s=Object.freeze(o)},59137:(e,t,n)=>{n.d(t,{Z:()=>f});var i=n(93517),r=n(54485),o=n(71118),s=n(20291),a=n(21514),u=n(81737),c=n(91257),l=n(34240),d=n(28075),h=n(84473),p=n(39109);function f(){}f.getFailedLoadFunction=function(e,t,n){return function(e){let i=`Failed to load ${t}: ${n}`;return(0,r.Z)(e)&&(i+=`\n${e.message}`),Promise.reject(new a.Z(i))}},f.getNodeTransform=function(e){return(0,r.Z)(e.matrix)?e.matrix:o.Z.fromTranslationQuaternionRotationScale((0,r.Z)(e.translation)?e.translation:i.Z.ZERO,(0,r.Z)(e.rotation)?e.rotation:s.Z.IDENTITY,(0,r.Z)(e.scale)?e.scale:i.Z.ONE)},f.getAttributeBySemantic=function(e,t,n){const i=e.attributes,o=i.length;for(let e=0;e<o;++e){const o=i[e],s=!(0,r.Z)(n)||o.setIndex===n;if(o.semantic===t&&s)return o}},f.getAttributeByName=function(e,t){const n=e.attributes,i=n.length;for(let e=0;e<i;++e){const i=n[e];if(i.name===t)return i}},f.getFeatureIdsByLabel=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.positionalLabel===t||i.label===t)return i}},f.hasQuantizedAttributes=function(e){if(!(0,r.Z)(e))return!1;for(let t=0;t<e.length;t++){const n=e[t];if((0,r.Z)(n.quantization))return!0}return!1},f.getAttributeInfo=function(e){const t=e.semantic,n=e.setIndex;let i,o=!1;(0,r.Z)(t)?(i=l.Z.getVariableName(t,n),o=!0):(i=e.name,i=i.replace(/^_/,""),i=i.toLowerCase());const s=/^color_\d+$/.test(i),a=e.type;let u=c.Z.getGlslType(a);s&&(u="vec4");const d=(0,r.Z)(e.quantization);let h;return d&&(h=s?"vec4":c.Z.getGlslType(e.quantization.type)),{attribute:e,isQuantized:d,variableName:i,hasSemantic:o,glslType:u,quantizedGlslType:h}};const _=new i.Z,m=new i.Z;f.getPositionMinMax=function(e,t,n){const o=f.getAttributeBySemantic(e,"POSITION");let s=o.max,a=o.min;return(0,r.Z)(n)&&(0,r.Z)(t)&&(a=i.Z.add(a,t,m),s=i.Z.add(s,n,_)),{min:a,max:s}},f.getAxisCorrectionMatrix=function(e,t,n){return n=o.Z.clone(o.Z.IDENTITY,n),e===u.Z.Y?n=o.Z.clone(u.Z.Y_UP_TO_Z_UP,n):e===u.Z.X&&(n=o.Z.clone(u.Z.X_UP_TO_Z_UP,n)),t===u.Z.Z&&(n=o.Z.multiplyTransformation(n,u.Z.Z_UP_TO_X_UP,n)),n};const T=new p.Z;f.getCullFace=function(e,t){if(!h.Z.isTriangles(t))return d.Z.BACK;const n=o.Z.getMatrix3(e,T);return p.Z.determinant(n)<0?d.Z.FRONT:d.Z.BACK}},30999:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(6785),r=n(54485);function o(e){this._model=e.model,this._featureTable=e.featureTable,this._featureId=e.featureId,this._color=void 0}Object.defineProperties(o.prototype,{show:{get:function(){return this._featureTable.getShow(this._featureId)},set:function(e){this._featureTable.setShow(this._featureId,e)}},color:{get:function(){return(0,r.Z)(this._color)||(this._color=new i.Z),this._featureTable.getColor(this._featureId,this._color)},set:function(e){this._featureTable.setColor(this._featureId,e)}},primitive:{get:function(){return this._model}},featureTable:{get:function(){return this._featureTable}},featureId:{get:function(){return this._featureId}}}),o.prototype.hasProperty=function(e){return this._featureTable.hasProperty(this._featureId,e)},o.prototype.getProperty=function(e){return this._featureTable.getProperty(this._featureId,e)},o.prototype.getPropertyInherited=function(e){return this._featureTable.hasPropertyBySemantic(this._featureId,e)?this._featureTable.getPropertyBySemantic(this._featureId,e):this._featureTable.getProperty(this._featureId,e)},o.prototype.getPropertyNames=function(e){return this._featureTable.getPropertyNames(e)},o.prototype.setProperty=function(e,t){return this._featureTable.setProperty(this._featureId,e,t)}},60472:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(66973),r=n(96059),o=n(17497),s=n(6785),a=n(54485),u=n(90332),c=n(30999),l=n(88779),d=n(59964),h=n(12361);function p(e){const t=e.model,n=e.propertyTable;o.Z.typeOf.object("propertyTable",n),o.Z.typeOf.object("model",t),this._propertyTable=n,this._model=t,this._features=void 0,this._featuresLength=0,this._batchTexture=void 0,this._styleCommandsNeededDirty=!1,this._styleCommandsNeeded=d.Z.ALL_OPAQUE,function(e){const t=e._model,n=h.Z.is3DTiles(t.type),o=e._propertyTable.count;if(0===o)return;let s;const a=new Array(o);if(n){const e=t.content;for(s=0;s<o;s++)a[s]=new r.Z(e,s)}else for(s=0;s<o;s++)a[s]=new c.Z({model:t,featureId:s,featureTable:e});e._features=a,e._featuresLength=o,e._batchTexture=new i.Z({featuresLength:o,owner:e,statistics:n?t.content.tileset.statistics:e._statistics})}(this)}Object.defineProperties(p.prototype,{batchTexture:{get:function(){return this._batchTexture}},featuresLength:{get:function(){return this._featuresLength}},styleCommandsNeededDirty:{get:function(){return this._styleCommandsNeededDirty}}}),p.prototype.update=function(e){this._styleCommandsNeededDirty=!1,this._batchTexture.update(void 0,e);const t=d.Z.getStyleCommandsNeeded(this._featuresLength,this._batchTexture.translucentFeaturesLength);this._styleCommandsNeeded!==t&&(this._styleCommandsNeededDirty=!0,this._styleCommandsNeeded=t)},p.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)},p.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)},p.prototype.getShow=function(e){return this._batchTexture.getShow(e)},p.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)},p.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)},p.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)},p.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)},p.prototype.getFeature=function(e){return this._features[e]},p.prototype.hasProperty=function(e,t){return this._propertyTable.hasProperty(e,t)},p.prototype.hasPropertyBySemantic=function(e,t){return this._propertyTable.hasPropertyBySemantic(e,t)},p.prototype.getProperty=function(e,t){return this._propertyTable.getProperty(e,t)},p.prototype.getPropertyBySemantic=function(e,t){return this._propertyTable.getPropertyBySemantic(e,t)},p.prototype.getPropertyNames=function(e){return this._propertyTable.getPropertyIds(e)},p.prototype.setProperty=function(e,t,n){return this._propertyTable.setProperty(e,t,n)};const f=new s.Z;p.prototype.applyStyle=function(e){if(!(0,a.Z)(e))return this.setAllColor(i.Z.DEFAULT_COLOR_VALUE),void this.setAllShow(i.Z.DEFAULT_SHOW_VALUE);for(let t=0;t<this._featuresLength;t++){const n=this.getFeature(t),r=(0,a.Z)(e.color)?(0,l.Z)(e.color.evaluateColor(n,f),i.Z.DEFAULT_COLOR_VALUE):i.Z.DEFAULT_COLOR_VALUE,o=(0,a.Z)(e.show)?(0,l.Z)(e.show.evaluate(n),i.Z.DEFAULT_SHOW_VALUE):i.Z.DEFAULT_SHOW_VALUE;this.setColor(t,r),this.setShow(t,o)}},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(e){this._batchTexture.destroy(),(0,u.Z)(this)}},43224:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(88779),r=n(65961);function o(e){e=(0,i.Z)(e,i.Z.EMPTY_OBJECT),this.lightingModel=(0,i.Z)(e.lightingModel,r.Z.UNLIT)}},4821:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(71118),r=n(59137),o=n(18061);const s={};function a(e,t,n,o){let s;o=i.Z.multiplyTransformation(o,e.transform,new i.Z),e.updateComputedTransform();const u=e.runtimePrimitives.length;for(s=0;s<u;s++){const t=e.runtimePrimitives[s].drawCommand;t.modelMatrix=i.Z.multiplyTransformation(n,o,t.modelMatrix),t.cullFace=r.Z.getCullFace(t.modelMatrix,t.primitiveType)}const c=e.children.length;for(s=0;s<c;s++){const r=t._runtimeNodes[e.children[s]];r._transformToRoot=i.Z.clone(o,r._transformToRoot),a(r,t,n,o),r._transformDirty=!1}}s.name="ModelMatrixUpdateStage",s.update=function(e,t,n){const i=n.mode!==o.Z.SCENE3D;if((!i||!t._model._projectTo2D)&&e._transformDirty){a(e,t,i?t._computedModelMatrix2D:t._computedModelMatrix,e.transformToRoot),e._transformDirty=!1}};const u=s},85311:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(17497),r=n(8840),o=n(63452);function s(e){i.Z.typeOf.object("model",e),this.shaderBuilder=new o.Z,this.model=e,this.uniformMap={},this.alphaOptions=new r.Z,this.renderStateOptions={}}},65295:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(51138),r=n(90708),o=n(83567);const s={name:"ModelSplitterPipelineStage",SPLIT_DIRECTION_UNIFORM_NAME:"model_splitDirection",process:function(e,t,n){const a=e.shaderBuilder;a.addDefine("HAS_MODEL_SPLITTER",void 0,o.Z.FRAGMENT),a.addFragmentLines([r.Z]);const u={};a.addUniform("float",s.SPLIT_DIRECTION_UNIFORM_NAME,o.Z.FRAGMENT),u[s.SPLIT_DIRECTION_UNIFORM_NAME]=function(){return t.splitDirection},e.uniformMap=(0,i.Z)(u,e.uniformMap)}},a=s},18591:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(91257),r=n(51138),o=n(54485),s=n(83567),a=n(94786),u=n(34240);const c={name:"MorphTargetsPipelineStage",FUNCTION_ID_GET_MORPHED_POSITION:"getMorphedPosition",FUNCTION_SIGNATURE_GET_MORPHED_POSITION:"vec3 getMorphedPosition(in vec3 position)",FUNCTION_ID_GET_MORPHED_NORMAL:"getMorphedNormal",FUNCTION_SIGNATURE_GET_MORPHED_NORMAL:"vec3 getMorphedNormal(in vec3 normal)",FUNCTION_ID_GET_MORPHED_TANGENT:"getMorphedTangent",FUNCTION_SIGNATURE_GET_MORPHED_TANGENT:"vec3 getMorphedTangent(in vec3 tangent)"};c.process=function(e,t){const n=e.shaderBuilder;n.addDefine("HAS_MORPH_TARGETS",void 0,s.Z.VERTEX),function(e){e.addFunction(c.FUNCTION_ID_GET_MORPHED_POSITION,c.FUNCTION_SIGNATURE_GET_MORPHED_POSITION,s.Z.VERTEX);const t="vec3 morphedPosition = position;";e.addFunctionLines(c.FUNCTION_ID_GET_MORPHED_POSITION,[t]),e.addFunction(c.FUNCTION_ID_GET_MORPHED_NORMAL,c.FUNCTION_SIGNATURE_GET_MORPHED_NORMAL,s.Z.VERTEX);const n="vec3 morphedNormal = normal;";e.addFunctionLines(c.FUNCTION_ID_GET_MORPHED_NORMAL,[n]),e.addFunction(c.FUNCTION_ID_GET_MORPHED_TANGENT,c.FUNCTION_SIGNATURE_GET_MORPHED_TANGENT,s.Z.VERTEX);const i="vec3 morphedTangent = tangent;";e.addFunctionLines(c.FUNCTION_ID_GET_MORPHED_TANGENT,[i])}(n);for(let n=0;n<t.morphTargets.length;n++){const i=t.morphTargets[n].attributes;for(let t=0;t<i.length;t++){const r=i[t],o=r.semantic;o!==u.Z.POSITION&&o!==u.Z.NORMAL&&o!==u.Z.TANGENT||(d(e,r,e.attributeIndex,n),e.attributeIndex++)}}!function(e){const t="return morphedPosition;";e.addFunctionLines(c.FUNCTION_ID_GET_MORPHED_POSITION,[t]);const n="return morphedNormal;";e.addFunctionLines(c.FUNCTION_ID_GET_MORPHED_NORMAL,[n]);const i="return morphedTangent;";e.addFunctionLines(c.FUNCTION_ID_GET_MORPHED_TANGENT,[i])}(n);const i=e.runtimeNode.morphWeights.length;n.addUniform("float",`u_morphWeights[${i}]`,s.Z.VERTEX),n.addVertexLines([a.Z]);const o={u_morphWeights:function(){return e.runtimeNode.morphWeights}};e.uniformMap=(0,r.Z)(o,e.uniformMap)};const l={attributeString:void 0,functionId:void 0};function d(e,t,n,r){const s=e.shaderBuilder;!function(e,t,n){const r={index:n,value:(0,o.Z)(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,componentsPerAttribute:i.Z.getNumberOfComponents(t.type),componentDatatype:t.componentDatatype,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};e.attributes.push(r)}(e,t,n);const a=function(e,t){switch(e.semantic){case u.Z.POSITION:t.attributeString="Position",t.functionId=c.FUNCTION_ID_GET_MORPHED_POSITION;break;case u.Z.NORMAL:t.attributeString="Normal",t.functionId=c.FUNCTION_ID_GET_MORPHED_NORMAL;break;case u.Z.TANGENT:t.attributeString="Tangent",t.functionId=c.FUNCTION_ID_GET_MORPHED_TANGENT}return t}(t,l);!function(e,t,n){const i=t.attributeString,r=`a_target${i}_${n}`,o=`morphed${i} += u_morphWeights[${n}] * a_target${i}_${n};`;e.addAttribute("vec3",r),e.addFunctionLines(t.functionId,[o])}(s,a,r)}const h=c},99950:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(17497),r=n(55077);function o(e,t){i.Z.typeOf.object("modelRenderResources",e),i.Z.typeOf.object("runtimeNode",t),this.model=e.model,this.shaderBuilder=e.shaderBuilder.clone(),this.uniformMap=(0,r.Z)(e.uniformMap),this.alphaOptions=(0,r.Z)(e.alphaOptions),this.renderStateOptions=(0,r.Z)(e.renderStateOptions),this.runtimeNode=t,this.attributes=[],this.attributeIndex=1,this.featureIdVertexAttributeSetIndex=0,this.instanceCount=0,this.instancingTranslationMax=void 0,this.instancingTranslationMin=void 0}},72493:(e,t,n)=>{n.d(t,{Z:()=>f});var i=n(31328),r=n(36627),o=n(6785),s=n(44990),a=n(88779),u=n(54485),c=n(83567),l=n(12361),d=n(59137);const h={};function p(e,t){const n=e.model,i={model:n,node:e.runtimeNode,primitive:e.runtimePrimitive};let r;if(l.Z.is3DTiles(n.type)){const e=n.content;r={content:e,primitive:e.tileset,detail:i}}else r={primitive:n,detail:i};return(0,u.Z)(t)&&(r.instanceId=t),r}h.name="PickingPipelineStage",h.process=function(e,t,n){const l=n.context,h=e.runtimeNode,f=e.shaderBuilder,_=e.model,m=h.node.instances;if(e.hasPropertyTable)!function(e,t,n){const i=e.model;let r,o;const s=i.featureIdLabel,l=i.instanceFeatureIdLabel;(0,u.Z)(i.featureTableId)?r=i.featureTableId:(0,u.Z)(n)?(o=d.Z.getFeatureIdsByLabel(n.featureIds,l),r=o.propertyTableId):(o=d.Z.getFeatureIdsByLabel(t.featureIds,s),r=o.propertyTableId);const h=i.featureTables[r];e.shaderBuilder.addUniform("sampler2D","model_pickTexture",c.Z.FRAGMENT);const p=h.batchTexture;e.uniformMap.model_pickTexture=function(){return(0,a.Z)(p.pickTexture,p.defaultTexture)},e.pickId="((selectedFeature.id < int(model_featuresLength)) ? texture2D(model_pickTexture, selectedFeature.st) : vec4(0.0))"}(e,t,m);else if((0,u.Z)(m))!function(e,t,n){const a=e.instanceCount,u=new Array(a),l=new Uint8Array(4*a),d=e.model._resources;for(let t=0;t<a;t++){const i=p(e,t),r=n.createPickId(i);d.push(r),u[t]=r;const s=r.color;l[4*t+0]=o.Z.floatToByte(s.red),l[4*t+1]=o.Z.floatToByte(s.green),l[4*t+2]=o.Z.floatToByte(s.blue),l[4*t+3]=o.Z.floatToByte(s.alpha)}const h=i.Z.createVertexBuffer({context:n,typedArray:l,usage:r.Z.STATIC_DRAW});h.vertexArrayDestroyable=!1,d.push(h);const f={index:e.attributeIndex++,vertexBuffer:h,componentsPerAttribute:4,componentDatatype:s.Z.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};e.attributes.push(f);const _=e.shaderBuilder;_.addDefine("USE_PICKING",void 0,c.Z.BOTH),_.addAttribute("vec4","a_pickColor"),_.addVarying("vec4","v_pickColor"),e.pickId="v_pickColor"}(e,0,l);else{const t=p(e),n=l.createPickId(t);_._resources.push(n),f.addUniform("vec4","czm_pickColor",c.Z.FRAGMENT);e.uniformMap.czm_pickColor=function(){return n.color},e.pickId="czm_pickColor"}};const f=h},14797:(e,t,n)=>{n.d(t,{Z:()=>P});var i=n(69310),r=n(93517),o=n(6785),s=n(17497),a=n(44990),u=n(88779),c=n(54485),l=n(71118),d=n(84473),h=n(7034),p=n(31328),f=n(36627),_=n(46959),m=n(91257),T=n(81737),Z=n(62524),y=n(10613),g=n(2087),I=n(39226),A=n(41519),b=n(53839),E=n(17932),S=n(41184),N=n(5955),O=n(34240);const C=b.Z.Components,v=b.Z.Scene,D=b.Z.Node,M=b.Z.Primitive,x=b.Z.Attribute,w=b.Z.Quantization,R=b.Z.FeatureIdAttribute,F=b.Z.Material,L=b.Z.MetallicRoughness;function P(e){const t=(e=(0,u.Z)(e,u.Z.EMPTY_OBJECT)).arrayBuffer,n=(0,u.Z)(e.byteOffset,0);s.Z.typeOf.object("options.arrayBuffer",t),this._arrayBuffer=t,this._byteOffset=n,this._parsedContent=void 0,this._decodePromise=void 0,this._decodedAttributes=void 0,this._promise=void 0,this._process=function(e){},this._state=N.Z.UNLOADED,this._buffers=[],this._components=void 0,this._transform=l.Z.IDENTITY}function U(e,t,n){let s,a=t.typedArray;if(t.octEncoded&&(s=new w,s.octEncoded=t.octEncoded,s.octEncodedZXY=t.octEncodedZXY,s.normalizationRange=t.quantizedRange,s.type=t.quantizedType,s.componentDatatype=t.quantizedComponentDatatype),t.isQuantized){s=new w;const e=t.quantizedRange;s.normalizationRange=e,s.quantizedVolumeOffset=r.Z.ZERO;const n=t.quantizedVolumeScale;s.quantizedVolumeDimensions=n,s.quantizedVolumeStepSize=r.Z.divideByScalar(n,e,new r.Z),s.componentDatatype=t.quantizedComponentDatatype,s.type=t.quantizedType}const l=new x;if(l.name=t.name,l.semantic=t.semantic,l.setIndex=t.setIndex,l.componentDatatype=t.componentDatatype,l.type=t.type,l.normalized=(0,u.Z)(t.normalized,!1),l.min=t.min,l.max=t.max,l.quantization=s,t.isRGB565&&(a=i.Z.decodeRGB565(a)),(0,c.Z)(t.constantColor)){const e=new Array(4);l.constant=o.Z.pack(t.constantColor,e)}else{const t=p.Z.createVertexBuffer({typedArray:a,context:n,usage:f.Z.STATIC_DRAW});t.vertexArrayDestroyable=!1,e._buffers.push(t),l.buffer=t}return l}let B,G;function V(e){if(!(0,c.Z)(G)){B=new h.Z(0),G=new Array(e);for(let t=0;t<e;++t)G[t]=B.random()}return G}(0,c.Z)(Object.create)&&(P.prototype=Object.create(I.Z.prototype),P.prototype.constructor=P),Object.defineProperties(P.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}},transform:{get:function(){return this._transform}}}),P.prototype.load=function(){this._parsedContent=E.Z.parse(this._arrayBuffer,this._byteOffset),this._state=N.Z.PROCESSING;const e=this;this._promise=new Promise((function(t,n){e._process=function(i){e._state===N.Z.PROCESSING&&((0,c.Z)(e._decodePromise)||function(e,t){const n=e._parsedContent.draco;let i;i=(0,c.Z)(n)?y.Z.decodePointCloud(n,t):Promise.resolve();if(!(0,c.Z)(i))return;return e._decodePromise=i,i.then((function(i){if(!e.isDestroyed())return(0,c.Z)(i)&&function(e,t,n){e._state=N.Z.READY;const i=e._parsedContent;let o;if((0,c.Z)(n.POSITION)){if(o={name:"POSITION",semantic:O.Z.POSITION,typedArray:n.POSITION.array,componentDatatype:a.Z.FLOAT,type:m.Z.VEC3,isQuantized:!1},(0,c.Z)(n.POSITION.data.quantization)){const e=n.POSITION.data.quantization,t=e.range,i=r.Z.fromElements(t,t,t),s=r.Z.unpack(e.minValues),u=(1<<e.quantizationBits)-1;o.isQuantized=!0,o.quantizedRange=u,o.quantizedVolumeOffset=s,o.quantizedVolumeScale=i,o.quantizedComponentDatatype=a.Z.UNSIGNED_SHORT,o.quantizedType=m.Z.VEC3}i.positions=o}if((0,c.Z)(n.NORMAL)){if(o={name:"NORMAL",semantic:O.Z.NORMAL,typedArray:n.NORMAL.array,componentDatatype:a.Z.FLOAT,type:m.Z.VEC3,isQuantized:!1,octEncoded:!1,octEncodedZXY:!1},(0,c.Z)(n.NORMAL.data.quantization)){const e=(1<<n.NORMAL.data.quantization.quantizationBits)-1;o.quantizedRange=e,o.octEncoded=!0,o.octEncodedZXY=!0,o.quantizedComponentDatatype=a.Z.UNSIGNED_BYTE,o.quantizedType=m.Z.VEC2}i.normals=o}(0,c.Z)(n.RGBA)?i.colors={name:"COLOR",semantic:O.Z.COLOR,setIndex:0,typedArray:n.RGBA.array,componentDatatype:a.Z.UNSIGNED_BYTE,type:m.Z.VEC4,normalized:!0,isTranslucent:!0}:(0,c.Z)(n.RGB)&&(i.colors={name:"COLOR",semantic:O.Z.COLOR,setIndex:0,typedArray:n.RGB.array,componentDatatype:a.Z.UNSIGNED_BYTE,type:m.Z.VEC3,normalized:!0,isTranslucent:!1});if((0,c.Z)(n.BATCH_ID)){const e=n.BATCH_ID.array;i.batchIds={name:"_FEATURE_ID",semantic:O.Z.FEATURE_ID,setIndex:0,typedArray:e,componentDatatype:a.Z.fromTypedArray(e),type:m.Z.SCALAR}}let s=i.styleableProperties;const u=t.batchTableProperties;for(const e in u)if(u.hasOwnProperty(e)){const t=n[e];(0,c.Z)(s)||(s={}),s[e]={typedArray:t.array,componentCount:t.data.componentsPerAttribute}}i.styleableProperties=s}(e,n,i),function(e,t){const n=e._parsedContent,i=new L;i.metallicFactor=0,i.roughnessFactor=.9;const o=new F;o.metallicRoughness=i;const s=n.colors;(0,c.Z)(s)&&s.isTranslucent&&(o.alphaMode=_.Z.BLEND);const a=!(0,c.Z)(n.normals);o.unlit=a;const h=new M;if(h.attributes=function(e,t,n){const i=[];let o;const s=t.positions;(0,c.Z)(s)&&(!function(e){const t=e.typedArray,n=20,i=t.length/3,o=Math.min(i,n),s=V(n),a=Number.MAX_VALUE,u=-Number.MAX_VALUE;let c,l,d,h=r.Z.fromElements(a,a,a,k),p=r.Z.fromElements(u,u,u,z);if(e.isQuantized)h=r.Z.ZERO,p=e.quantizedVolumeScale;else for(c=0;c<o;++c)l=Math.floor(s[c]*i),d=r.Z.unpack(t,3*l,$),r.Z.minimumByComponent(h,d,h),r.Z.maximumByComponent(p,d,p);e.min=r.Z.clone(h),e.max=r.Z.clone(p)}(s),o=U(e,s,n),o.count=t.pointsLength,i.push(o));(0,c.Z)(t.normals)&&(o=U(e,t.normals,n),i.push(o));(0,c.Z)(t.colors)?(o=U(e,t.colors,n),i.push(o)):(o=U(e,H,n),i.push(o));(0,c.Z)(t.batchIds)&&(o=U(e,t.batchIds,n),i.push(o));return i}(e,n,t),h.primitiveType=d.Z.POINTS,h.material=o,(0,c.Z)(n.batchIds)){const e=new R;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",h.featureIds.push(e)}const p=new D;p.index=0,p.primitives=[h];const f=new v;f.nodes=[p],f.upAxis=T.Z.Z,f.forwardAxis=T.Z.X;const m=new C;m.scene=f,m.nodes=[p],m.structuralMetadata=function(e){const t=e.batchLength,n=e.pointsLength,i=e.batchTableBinary;if((0,c.Z)(i)){const r=(0,u.Z)(t,n);return(0,Z.Z)({count:r,batchTable:e.batchTableJson,binaryBody:i})}const r=new S.Z({name:A.Z.BATCH_TABLE_CLASS_NAME,count:n});return new g.Z({schema:{},propertyTables:[r]})}(n),(0,c.Z)(n.rtcCenter)&&(m.transform=l.Z.multiplyByTranslation(m.transform,n.rtcCenter,m.transform));const y=n.positions;(0,c.Z)(y)&&y.isQuantized&&(m.transform=l.Z.multiplyByTranslation(m.transform,y.quantizedVolumeOffset,m.transform));e._components=m,e._parsedContent=void 0}(e,t),e._state=N.Z.READY,e})).catch((function(t){e.unload(),e._state=N.Z.FAILED;const n="Failed to load Draco";return Promise.reject(e.getError(n,t))}))}(e,i.context).then(t).catch(n))}}))},P.prototype.process=function(e){this._process(e)};const k=new r.Z,z=new r.Z,$=new r.Z;const H={name:O.Z.COLOR,semantic:O.Z.COLOR,setIndex:0,constantColor:o.Z.DARKGRAY,componentDatatype:a.Z.FLOAT,type:m.Z.VEC4,isQuantized:!1,isTranslucent:!1};P.prototype.unload=function(){const e=this._buffers;for(let t=0;t<e.length;t++)e[t].destroy();e.length=0,this._components=void 0,this._parsedContent=void 0}}}]);