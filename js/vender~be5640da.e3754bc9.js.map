{"version":3,"file":"js/vender~be5640da.e3754bc9.js","mappings":"0IAqBQA,E,qMAFJC,EAA4B,IAAI,KAChB,oBAATC,MAAyBC,OAAOC,UAAUC,eAAeC,KAAKJ,KAAM,YAE3EC,OAAOI,eAAeL,KAAM,UAAW,CACnCM,IAAK,WAAc,OAAOR,GAC1BS,IAAK,SAAUC,IACXV,EAAaU,IAETT,EAA0BU,gBAAgBX,MASnD,SAASY,IACZ,OAAO,IAAIC,SAAQ,SAAUC,GACF,oBAAZC,QACPd,EAA0Be,SAAQ,SAAUC,GAAgB,OAAOH,EAAQG,MAG3EH,EAAQC,YAUb,SAASG,EAAwBC,EAAUC,GAC9C,OAAO,QAAUC,UAAM,OAAQ,GAAQ,WACnC,OAAO,QAAYA,MAAM,SAAUC,GAC/B,OAAQA,EAAGC,OACP,KAAK,EAAG,MAAO,CAAC,EAAaX,KAC7B,KAAK,EAED,OADCU,EAAGE,OAAQL,GAAYC,EACjB,CAAC,UAK5B,IAAIK,EAAuC,WACvC,SAASA,EAAsBC,GAE3BL,KAAKM,SAAU,EACfN,KAAKO,SAAU,EACfP,KAAKQ,YAAc,GACnBR,KAAKK,OAASA,EA4flB,OA1fAD,EAAsBrB,UAAU0B,qBAAuB,WACnD,OAAO,MAEXL,EAAsBrB,UAAU2B,uBAAyB,WACrD,OAAO,MAGXN,EAAsBrB,UAAU4B,+BAAiC,SAAUC,GACvE,MAAM,IAAIC,MAAM,oBAEpBT,EAAsBrB,UAAU+B,uBAAyB,SAAUC,EAAQC,EAAqBC,EAAeC,EAAUC,EAAaC,EAAUC,EAAiBC,GAC7J,IAWIC,EAXAlB,EAASL,KAAKK,OAClB,GAAIA,EAAOmB,uBACP,IAAK,IAAIC,KAAUT,EACfD,EAAOW,iBAAiBD,EAAQT,EAAoBS,IAS5D,IAN8BzB,KAAKK,OAAOsB,YAAY3B,KAAMiB,GACpCW,SAAQ,SAAUC,EAASN,GAC/CL,EAASD,EAAcM,IAAUM,KAErC7B,KAAK8B,UAAYZ,EAEZK,EAAQ,EAAGA,EAAQJ,EAAYY,OAAQR,IAAS,CAElC,MADDR,EAAOiB,WAAWb,EAAYI,MAExCJ,EAAYc,OAAOV,EAAO,GAC1BA,KAGRJ,EAAYS,SAAQ,SAAUM,EAAMX,GAChCH,EAASc,GAAQX,KAErBD,EAAWa,KAAKC,MAAMd,EAAYjB,EAAOgC,cAAcrC,KAAMqB,KAKjEjB,EAAsBrB,UAAUuD,QAAU,WACtCtC,KAAK8B,UAAY,IAOrB1B,EAAsBrB,UAAUwD,aAAe,SAAUC,EAAaC,GAClE,IAAIC,EAAQ1C,KAAKQ,YAAYgC,GACzBG,EAAOF,EAAOG,WAClB,YAAcC,IAAVH,GAAuBA,IAAUC,KAGrC3C,KAAKQ,YAAYgC,GAAeG,GACzB,IAQXvC,EAAsBrB,UAAU+D,aAAe,SAAUN,EAAaO,EAAGC,GACrE,IAAIN,EAAQ1C,KAAKQ,YAAYgC,GAC7B,IAAKE,EAGD,OAFAA,EAAQ,CAACK,EAAGC,GACZhD,KAAKQ,YAAYgC,GAAeE,GACzB,EAEX,IAAIO,GAAU,EASd,OARIP,EAAM,KAAOK,IACbL,EAAM,GAAKK,EACXE,GAAU,GAEVP,EAAM,KAAOM,IACbN,EAAM,GAAKM,EACXC,GAAU,GAEPA,GASX7C,EAAsBrB,UAAUmE,aAAe,SAAUV,EAAaO,EAAGC,EAAGG,GACxE,IAAIT,EAAQ1C,KAAKQ,YAAYgC,GAC7B,IAAKE,EAGD,OAFAA,EAAQ,CAACK,EAAGC,EAAGG,GACfnD,KAAKQ,YAAYgC,GAAeE,GACzB,EAEX,IAAIO,GAAU,EAad,OAZIP,EAAM,KAAOK,IACbL,EAAM,GAAKK,EACXE,GAAU,GAEVP,EAAM,KAAOM,IACbN,EAAM,GAAKM,EACXC,GAAU,GAEVP,EAAM,KAAOS,IACbT,EAAM,GAAKS,EACXF,GAAU,GAEPA,GAUX7C,EAAsBrB,UAAUqE,aAAe,SAAUZ,EAAaO,EAAGC,EAAGG,EAAGE,GAC3E,IAAIX,EAAQ1C,KAAKQ,YAAYgC,GAC7B,IAAKE,EAGD,OAFAA,EAAQ,CAACK,EAAGC,EAAGG,EAAGE,GAClBrD,KAAKQ,YAAYgC,GAAeE,GACzB,EAEX,IAAIO,GAAU,EAiBd,OAhBIP,EAAM,KAAOK,IACbL,EAAM,GAAKK,EACXE,GAAU,GAEVP,EAAM,KAAOM,IACbN,EAAM,GAAKM,EACXC,GAAU,GAEVP,EAAM,KAAOS,IACbT,EAAM,GAAKS,EACXF,GAAU,GAEVP,EAAM,KAAOW,IACbX,EAAM,GAAKW,EACXJ,GAAU,GAEPA,GAOX7C,EAAsBrB,UAAUuE,OAAS,SAAUd,EAAanD,GAC5D,IAAIqD,EAAQ1C,KAAKQ,YAAYgC,QACfK,IAAVH,GAAuBA,IAAUrD,GAGjCW,KAAKK,OAAOiD,OAAOtD,KAAK8B,UAAUU,GAAcnD,KAChDW,KAAKQ,YAAYgC,GAAenD,IASxCe,EAAsBrB,UAAUwE,QAAU,SAAUf,EAAaO,EAAGC,GAC5DhD,KAAK8C,aAAaN,EAAaO,EAAGC,KAC7BhD,KAAKK,OAAOkD,QAAQvD,KAAK8B,UAAUU,GAAcO,EAAGC,KACrDhD,KAAKQ,YAAYgC,GAAe,QAW5CpC,EAAsBrB,UAAUyE,QAAU,SAAUhB,EAAaO,EAAGC,EAAGG,GAC/DnD,KAAKkD,aAAaV,EAAaO,EAAGC,EAAGG,KAChCnD,KAAKK,OAAOmD,QAAQxD,KAAK8B,UAAUU,GAAcO,EAAGC,EAAGG,KACxDnD,KAAKQ,YAAYgC,GAAe,QAY5CpC,EAAsBrB,UAAU0E,QAAU,SAAUjB,EAAaO,EAAGC,EAAGG,EAAGE,GAClErD,KAAKoD,aAAaZ,EAAaO,EAAGC,EAAGG,EAAGE,KACnCrD,KAAKK,OAAOoD,QAAQzD,KAAK8B,UAAUU,GAAcO,EAAGC,EAAGG,EAAGE,KAC3DrD,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAU2E,YAAc,SAAUlB,EAAamB,GACjE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOqD,YAAY1D,KAAK8B,UAAUU,GAAcmB,IAOzDvD,EAAsBrB,UAAU6E,aAAe,SAAUpB,EAAamB,GAClE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOuD,aAAa5D,KAAK8B,UAAUU,GAAcmB,IAO1DvD,EAAsBrB,UAAU8E,aAAe,SAAUrB,EAAamB,GAClE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOwD,aAAa7D,KAAK8B,UAAUU,GAAcmB,IAO1DvD,EAAsBrB,UAAU+E,aAAe,SAAUtB,EAAamB,GAClE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOyD,aAAa9D,KAAK8B,UAAUU,GAAcmB,IAO1DvD,EAAsBrB,UAAUgF,cAAgB,SAAUvB,EAAamB,GACnE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAO0D,cAAc/D,KAAK8B,UAAUU,GAAcmB,IAO3DvD,EAAsBrB,UAAUiF,eAAiB,SAAUxB,EAAamB,GACpE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAO2D,eAAehE,KAAK8B,UAAUU,GAAcmB,IAO5DvD,EAAsBrB,UAAUkF,eAAiB,SAAUzB,EAAamB,GACpE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAO4D,eAAejE,KAAK8B,UAAUU,GAAcmB,IAO5DvD,EAAsBrB,UAAUmF,eAAiB,SAAU1B,EAAamB,GACpE3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAO6D,eAAelE,KAAK8B,UAAUU,GAAcmB,IAO5DvD,EAAsBrB,UAAUoF,SAAW,SAAU3B,EAAamB,GAC9D3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAO8D,SAASnE,KAAK8B,UAAUU,GAAcmB,IAOtDvD,EAAsBrB,UAAUqF,UAAY,SAAU5B,EAAamB,GAC/D3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAO+D,UAAUpE,KAAK8B,UAAUU,GAAcmB,IAQvDvD,EAAsBrB,UAAUsF,UAAY,SAAU7B,EAAamB,GAC/D3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOgE,UAAUrE,KAAK8B,UAAUU,GAAcmB,IAOvDvD,EAAsBrB,UAAUuF,UAAY,SAAU9B,EAAamB,GAC/D3D,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOiE,UAAUtE,KAAK8B,UAAUU,GAAcmB,IAOvDvD,EAAsBrB,UAAUwF,YAAc,SAAU/B,EAAagC,GAC5DA,IAGLxE,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOkE,YAAYvE,KAAK8B,UAAUU,GAAcgC,KAOzDpE,EAAsBrB,UAAU0F,UAAY,SAAUjC,EAAaC,GAC3DzC,KAAKuC,aAAaC,EAAaC,KAC1BzC,KAAKK,OAAOkE,YAAYvE,KAAK8B,UAAUU,GAAcC,EAAOiC,aAC7D1E,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAU4F,aAAe,SAAUnC,EAAaC,GAClEzC,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOsE,aAAa3E,KAAK8B,UAAUU,GAAcC,IAO1DrC,EAAsBrB,UAAU6F,aAAe,SAAUpC,EAAaC,GAClEzC,KAAKQ,YAAYgC,GAAe,KAChCxC,KAAKK,OAAOuE,aAAa5E,KAAK8B,UAAUU,GAAcC,IAQ1DrC,EAAsBrB,UAAU8F,SAAW,SAAUrC,EAAanD,GAC9D,IAAIqD,EAAQ1C,KAAKQ,YAAYgC,QACfK,IAAVH,GAAuBA,IAAUrD,GAGjCW,KAAKK,OAAOwE,SAAS7E,KAAK8B,UAAUU,GAAcnD,KAClDW,KAAKQ,YAAYgC,GAAenD,IAQxCe,EAAsBrB,UAAU+F,QAAU,SAAUtC,EAAauC,GAC7D,IAAIrC,EAAQ1C,KAAKQ,YAAYgC,QACfK,IAAVH,GAAuBA,IAAUqC,GAGjC/E,KAAKK,OAAOiD,OAAOtD,KAAK8B,UAAUU,GAAcuC,EAAO,EAAI,KAC3D/E,KAAKQ,YAAYgC,GAAeuC,EAAO,EAAI,IAQnD3E,EAAsBrB,UAAUiG,WAAa,SAAUxC,EAAayC,GAC5DjF,KAAK8C,aAAaN,EAAayC,EAAQlC,EAAGkC,EAAQjC,KAC7ChD,KAAKK,OAAO6E,UAAUlF,KAAK8B,UAAUU,GAAcyC,EAAQlC,EAAGkC,EAAQjC,KACvEhD,KAAKQ,YAAYgC,GAAe,QAU5CpC,EAAsBrB,UAAUmG,UAAY,SAAU1C,EAAaO,EAAGC,GAC9DhD,KAAK8C,aAAaN,EAAaO,EAAGC,KAC7BhD,KAAKK,OAAO6E,UAAUlF,KAAK8B,UAAUU,GAAcO,EAAGC,KACvDhD,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAUoG,WAAa,SAAU3C,EAAa4C,GAC5DpF,KAAKkD,aAAaV,EAAa4C,EAAQrC,EAAGqC,EAAQpC,EAAGoC,EAAQjC,KACxDnD,KAAKK,OAAOgF,UAAUrF,KAAK8B,UAAUU,GAAc4C,EAAQrC,EAAGqC,EAAQpC,EAAGoC,EAAQjC,KAClFnD,KAAKQ,YAAYgC,GAAe,QAW5CpC,EAAsBrB,UAAUsG,UAAY,SAAU7C,EAAaO,EAAGC,EAAGG,GACjEnD,KAAKkD,aAAaV,EAAaO,EAAGC,EAAGG,KAChCnD,KAAKK,OAAOgF,UAAUrF,KAAK8B,UAAUU,GAAcO,EAAGC,EAAGG,KAC1DnD,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAUuG,WAAa,SAAU9C,EAAa+C,GAC5DvF,KAAKoD,aAAaZ,EAAa+C,EAAQxC,EAAGwC,EAAQvC,EAAGuC,EAAQpC,EAAGoC,EAAQlC,KACnErD,KAAKK,OAAOmF,UAAUxF,KAAK8B,UAAUU,GAAc+C,EAAQxC,EAAGwC,EAAQvC,EAAGuC,EAAQpC,EAAGoC,EAAQlC,KAC7FrD,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAU0G,cAAgB,SAAUjD,EAAakD,GAC/D1F,KAAKoD,aAAaZ,EAAakD,EAAW3C,EAAG2C,EAAW1C,EAAG0C,EAAWvC,EAAGuC,EAAWrC,KAC/ErD,KAAKK,OAAOmF,UAAUxF,KAAK8B,UAAUU,GAAckD,EAAW3C,EAAG2C,EAAW1C,EAAG0C,EAAWvC,EAAGuC,EAAWrC,KACzGrD,KAAKQ,YAAYgC,GAAe,QAa5CpC,EAAsBrB,UAAUyG,UAAY,SAAUhD,EAAaO,EAAGC,EAAGG,EAAGE,GACpErD,KAAKoD,aAAaZ,EAAaO,EAAGC,EAAGG,EAAGE,KACnCrD,KAAKK,OAAOmF,UAAUxF,KAAK8B,UAAUU,GAAcO,EAAGC,EAAGG,EAAGE,KAC7DrD,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAU4G,UAAY,SAAUnD,EAAaoD,GAC3D5F,KAAKkD,aAAaV,EAAaoD,EAAOC,EAAGD,EAAOE,EAAGF,EAAOG,KACrD/F,KAAKK,OAAOgF,UAAUrF,KAAK8B,UAAUU,GAAcoD,EAAOC,EAAGD,EAAOE,EAAGF,EAAOG,KAC/E/F,KAAKQ,YAAYgC,GAAe,QAU5CpC,EAAsBrB,UAAUiH,UAAY,SAAUxD,EAAaoD,EAAQK,GACnEjG,KAAKoD,aAAaZ,EAAaoD,EAAOC,EAAGD,EAAOE,EAAGF,EAAOG,EAAGE,KACxDjG,KAAKK,OAAOmF,UAAUxF,KAAK8B,UAAUU,GAAcoD,EAAOC,EAAGD,EAAOE,EAAGF,EAAOG,EAAGE,KAClFjG,KAAKQ,YAAYgC,GAAe,QAS5CpC,EAAsBrB,UAAUmH,gBAAkB,SAAU1D,EAAa2D,GACjEnG,KAAKoD,aAAaZ,EAAa2D,EAAON,EAAGM,EAAOL,EAAGK,EAAOJ,EAAGI,EAAOC,KAC/DpG,KAAKK,OAAOmF,UAAUxF,KAAK8B,UAAUU,GAAc2D,EAAON,EAAGM,EAAOL,EAAGK,EAAOJ,EAAGI,EAAOC,KACzFpG,KAAKQ,YAAYgC,GAAe,QAIrCpC,EAlgB+B,GAogBtCiG,EAA2C,SAAUC,GAErD,SAASD,EAA0BE,EAASC,EAAQC,EAAMpG,GACtD,IAAIqG,EAAQJ,EAAOrH,KAAKe,KAAMuG,EAASC,EAAQC,EAAMpG,IAAWL,KAIhE,OAHA0G,EAAMC,cAAgB,KACtBD,EAAME,0BAA4B,KAClCF,EAAMG,QAAUxG,EACTqG,EAkCX,OAxCA,QAAUL,EAA2BC,GAQrCxH,OAAOI,eAAemH,EAA0BtH,UAAW,eAAgB,CACvEI,IAAK,WACD,OAAOa,KAAK2G,eAEhBvH,IAAK,SAAU0H,GACP9G,KAAK2G,eACL3G,KAAK6G,QAAQE,2BAA2B/G,KAAK2G,eAEjD3G,KAAK2G,cAAgBG,GAEzBE,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAemH,EAA0BtH,UAAW,2BAA4B,CACnFI,IAAK,WACD,OAAOa,KAAK4G,2BAEhBxH,IAAK,SAAU8H,GACPlH,KAAK4G,2BACL5G,KAAK6G,QAAQE,2BAA2B/G,KAAK4G,2BAEjD5G,KAAK4G,0BAA4BM,GAErCF,YAAY,EACZC,cAAc,IAElBZ,EAA0BtH,UAAUuD,QAAU,SAAU6E,QACpB,IAA5BA,IAAsCA,GAA0B,GACpEnH,KAAKoH,aAAe,KACpBpH,KAAKqH,yBAA2B,KAChCf,EAAOvH,UAAUuD,QAAQrD,KAAKe,KAAMmH,IAEjCd,EAzCmC,CA0C5C,KAIEiB,EAAkC,SAAUhB,GAE5C,SAASgB,IACL,OAAkB,OAAXhB,GAAmBA,EAAOlE,MAAMpC,KAAMuH,YAAcvH,KAE/D,OAJA,QAAUsH,EAAkBhB,GAIrBgB,EAL0B,CAMnC,KAEEE,EAAsC,WACtC,SAASA,EAAqBX,GAC1B7G,KAAK6G,QAAUA,EACf7G,KAAKyH,SAAW,IAAIC,MACpB1H,KAAK2H,6BAA8B,EACnC3H,KAAK4H,eAAiBC,EAAaC,0BACnC9H,KAAK6G,QAAQkB,qBAAqB/H,KAAK4H,gBAiD3C,OA/CAJ,EAAqBzI,UAAUiJ,kBAAoB,WAC/C,GAAIhI,KAAK2H,4BACL,MAAM,IAAI9G,MAAM,iCAEpBb,KAAK2H,6BAA8B,GAEvCH,EAAqBzI,UAAUkJ,gBAAkB,WAC7C,IAAKjI,KAAK2H,4BACN,MAAM,IAAI9G,MAAM,gCAEpBb,KAAK2H,6BAA8B,EACnC3H,KAAKkI,WAETV,EAAqBzI,UAAUoJ,qBAAuB,SAAUC,GAC5DpI,KAAK4H,eAAeS,gBAAgBD,IAExCZ,EAAqBzI,UAAUuJ,yBAA2B,SAAUC,GAChEvI,KAAK4H,eAAeY,YAAYD,IAEpCf,EAAqBzI,UAAU0J,0BAA4B,SAAUF,GACjEvI,KAAK4H,eAAec,iBAAiBH,IAEzCf,EAAqBzI,UAAU4J,wBAA0B,SAAUJ,GAC/DvI,KAAK4H,eAAegB,WAAWL,IAEnCf,EAAqBzI,UAAU8J,yBAA2B,SAAUN,GAChEvI,KAAK4H,eAAekB,gBAAgBP,IAExCf,EAAqBzI,UAAUgK,0BAA4B,SAAUR,GACjEvI,KAAK4H,eAAeoB,aAAaT,IAErCf,EAAqBzI,UAAUkK,2BAA6B,SAAUV,GAClEvI,KAAK4H,eAAesB,kBAAkBX,IAE1Cf,EAAqBzI,UAAUoK,6BAA+B,SAAUZ,GACpEvI,KAAK4H,eAAeS,gBAAgBE,GACpCvI,KAAKyH,SAAStF,KAAKoG,IAEvBf,EAAqBzI,UAAUqK,sBAAwB,WAC9CpJ,KAAK2H,6BACN3H,KAAKkI,WAGbV,EAAqBzI,UAAUmJ,QAAU,WACrClI,KAAK6G,QAAQwC,iBACbrJ,KAAKyH,SAAS1F,OAAS,GAEpByF,EAvD8B,GA0DrCK,EAA8B,SAAUvB,GAExC,SAASuB,EAAayB,QACF,IAAZA,IAAsBA,EAAU,IACpC,IAAI5C,EAAQJ,EAAOrH,KAAKe,KAAM,MAAM,OAAO6C,EAAWyG,EAAQC,qBAAuBvJ,KAiBrF,GAhBA0G,EAAMG,QAAU,IAAInH,QAAQ8J,OAC5B9C,EAAM+C,QAAU/J,QAAQgK,OAAS,IAAIhK,QAAQgK,OAAW,KACxDhD,EAAMiD,sBAAwB,IAAInC,EAAqBd,EAAMG,SAC7DH,EAAMkD,yBAA2B,KACjClD,EAAMmD,kBAAoBnK,QAAQ8J,OAAOM,kBACzCpD,EAAMqD,cAAe,EACrBrD,EAAMsD,aAAe,IACrBtD,EAAMuD,aAAe,IACrBvD,EAAMwD,gBAAkB,EACxBxD,EAAMyD,iBAAmB,IACzBzD,EAAM0D,sBAAwB,KAC9B1D,EAAM2D,oBAAsB,KAC5B3D,EAAM4D,2BAA6B,KACnC5D,EAAM6D,SAAW,EACjB7D,EAAM8D,cAAgB,EACtB9D,EAAM+D,aAAc,EAChB/K,QAAQ8J,OAAOkB,mBAAqB7C,EAAa6C,iBACjD,MAAM,IAAI7J,MAAM,8BAA8B8J,OAAOjL,QAAQ8J,OAAOkB,iBAAkB,kBAAkBC,OAAO9C,EAAa6C,iBAAkB,UAElJhE,EAAMkE,cAAgB,EACtBlE,EAAMmE,uBAAwB,EAG9BnE,EAAMoE,MAAQ,CACVC,sBAAuB,GACvBC,2BAA4B,GAC5BC,8BAA+B,GAC/BC,eAAgBxL,QAAQ8J,OAAO2B,6BAC/BC,sBAAuB,IACvBC,qBAAsB,IACtBC,iBAAkB,GAClBC,kBAAmB,GACnBC,0BAA2B,GAC3BC,wBAAyB,GACzBC,qBAAqB,EACrBC,KAAM,KACNC,MAAO,KACPC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,cAAe,GACfC,aAAa,EACbC,wBAAwB,EACxBC,8BAA8B,EAC9BC,kBAAkB,EAClBC,cAAc,EACdC,6BAA6B,EAC7BC,oBAAoB,EACpBC,kBAAkB,EAClBC,iCAAiC,EACjCC,wBAAwB,EACxBC,YAAY,EACZC,sBAAsB,EACtBC,uBAAuB,EACvBC,mBAAmB,EACnBC,iBAAiB,EACjBC,uBAAuB,EACvBC,8BAA8B,EAC9BC,aAAa,EACbC,eAAgB,EAChBC,oBAAoB,EACpBC,kBAAkB,EAClBC,uBAAuB,EACvBC,oBAAoB,EACpBC,2BAA2B,EAC3BC,iBAAiB,EACjBC,4BAA6BhO,QAAQ8J,OAAOmE,gCAEhDjH,EAAMkH,UAAY,CACdC,iCAAiC,EACjCC,2CAA2C,EAC3CC,4BAA4B,EAC5BC,uBAAuB,EACvBC,8BAA8B,EAC9BC,0BAA0B,EAC1BC,kBAAkB,EAClBC,8BAA8B,EAC9BC,YAAY,EACZC,eAAe,EACfC,mBAAmB,EACnBC,iCAAiC,EACjCC,aAAa,EACbC,cAAc,EACdC,+BAA+B,EAC/BC,2BAA2B,EAC3BC,wBAAwB,EACxBC,sBAAsB,EACtBC,oBAAoB,EACpBC,wBAAwB,EACxBC,gCAAgC,EAChCC,qBAAqB,EACrBC,4BAA4B,GAEhC,SAAU,oBAAsB,YAAiB,cACjD,gBAAmB,SAAUC,EAAWC,EAAWC,EAASC,GACxD,cAAeH,GAAW,SAAUI,GAChCC,SAASD,GAAMpN,MAAM,MACjBiN,GACAA,WAELxM,OAAWA,GAAW,GAAO,SAAU6M,EAASC,GAC3CL,GACAA,EAAQ,mBAAoBK,OAKrB,oBAARC,MACPC,OAAOD,IAAM,CACTE,gBAAiB,aACjBC,gBAAiB,eAGL,oBAATC,OACPH,OAAOG,KAAO,SAAUC,GACpB,OAAOA,IAKf,IAAIC,EAAmBL,QAASA,OAAOK,kBAA0B,EACjExJ,EAAMyJ,sBAAwB7G,EAAQC,mBAAqB2G,EAAmB,EAC9ExJ,EAAM0J,SACN,IAAIC,EAAuB3J,EAAM4J,mBAkBjC,OAjBID,GACA3J,EAAM6J,iBAAiBF,GAG3B3J,EAAM8J,iBAAmB,IAAI,IAC7B9J,EAAM+J,0BAA0BC,KAAI,SAAUC,GAC1C,IAAIC,EAAiBD,EAAME,OAC3BF,EAAME,OAAS,WAEX,IADA,IAAIC,EAAO,GACFC,EAAK,EAAGA,EAAKxJ,UAAUxF,OAAQgP,IACpCD,EAAKC,GAAMxJ,UAAUwJ,GAEzBrK,EAAMiD,sBAAsB3B,oBAC5B4I,EAAexO,MAAMuO,EAAOG,GAC5BpK,EAAMiD,sBAAsB1B,sBAG7BvB,EAo1DX,OAr+DA,QAAUmB,EAAcvB,GAmJxBuB,EAAa9I,UAAUiS,wBAA0B,WAC7C,OAAOhR,KAAK6G,QAAQmK,2BAExBnJ,EAAa9I,UAAUkS,wBAA0B,SAAUC,GACvDlR,KAAK6G,QAAQoK,wBAAwBC,IAEzCrJ,EAAa9I,UAAUuD,QAAU,WAC7BgE,EAAOvH,UAAUuD,QAAQrD,KAAKe,MAC1BA,KAAK4J,0BACL5J,KAAKmR,mBAAmBnR,KAAK4J,0BAEjC5J,KAAK6G,QAAQvE,WAGjBuF,EAAaC,wBAA0B,WACnC,OAAO,IAAI,KAQfD,EAAa9I,UAAUqS,eAAiB,SAAUC,EAAsBC,GAQpE,OANIA,EAAUC,uBAAyBD,IAAczB,OACjDyB,EAAUC,sBAAsBF,GAGhCrR,KAAK6G,QAAQ0K,sBAAsBF,GAEhC,GAMXxJ,EAAa9I,UAAUyS,wBAA0B,SAAU1K,GACnD9G,KAAKyR,sBAAwB3K,IACzB9G,KAAKyR,sBACLzR,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOkI,2BAC/D1R,KAAK2J,sBAAsBR,6BAA6BnJ,KAAKyR,qBAC7DzR,KAAK2J,sBAAsBP,yBAE3BtC,IACA9G,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmI,yBAC/D3R,KAAK2J,sBAAsBR,6BAA6BrC,GACxD9G,KAAK2J,sBAAsBP,yBAE/BpJ,KAAKyR,oBAAsB3K,IAOnCe,EAAa9I,UAAU6S,gBAAkB,WACrC,OAAO,MAEX/J,EAAa9I,UAAU8S,MAAQ,SAAUC,EAAOC,EAAYC,EAAOC,GAE/D,QADgB,IAAZA,IAAsBA,GAAU,GAChCjS,KAAKkS,sBACL,MAAM,IAAIrR,MAAM,qDAEpBb,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO2I,eAC/DnS,KAAK2J,sBAAsBrB,yBAAyByJ,GAAcD,EAAQ,EAAI,GAC9E9R,KAAK2J,sBAAsBZ,0BAA0B+I,EAAQA,EAAMjM,EAAI,GACvE7F,KAAK2J,sBAAsBZ,0BAA0B+I,EAAQA,EAAMhM,EAAI,GACvE9F,KAAK2J,sBAAsBZ,0BAA0B+I,EAAQA,EAAM/L,EAAI,GACvE/F,KAAK2J,sBAAsBZ,0BAA0B+I,EAAQA,EAAM1L,EAAI,GACvEpG,KAAK2J,sBAAsBrB,yBAAyB0J,EAAQ,EAAI,GAChEhS,KAAK2J,sBAAsBZ,0BAA0B,GACrD/I,KAAK2J,sBAAsBrB,yBAAyB2J,EAAU,EAAI,GAClEjS,KAAK2J,sBAAsBrB,yBAAyB,GACpDtI,KAAK2J,sBAAsBP,yBAE/BvB,EAAa9I,UAAUqT,kBAAoB,SAAUC,EAASC,GAC1D,IAAI9C,EAAOxP,KAAKuS,oBAAoBF,GAChCG,EAAS,IAAIlL,EAMjB,OALAkL,EAAOC,WAAa,EACpBD,EAAOE,SAAsC,IAA3BlD,EAAKmD,kBACnBnD,EAAKoD,aACLJ,EAAOK,kBAAoB7S,KAAK6G,QAAQuL,kBAAkB5C,EAAKgD,OAAQhD,EAAKsD,WAAYtD,EAAKoD,WAAYJ,EAAOE,SAAUJ,SAA+CA,IAEtKE,GAEX3K,EAAa9I,UAAUgU,mBAAqB,SAAUC,EAAUV,GAC5D,IAAI9C,EAAOyD,YAAYC,OAAOF,GAAYA,EAAW,IAAIG,aAAaH,GAClER,EAAS,IAAIlL,EAKjB,OAJAkL,EAAOC,WAAa,EAChBjD,EAAKoD,aACLJ,EAAOY,mBAAqBpT,KAAK6G,QAAQkM,mBAAmBvD,EAAKgD,OAAQhD,EAAKsD,WAAYtD,EAAKoD,WAAYN,SAA+CA,IAEvJE,GAEX3K,EAAa9I,UAAUsU,yBAA2B,SAAUC,EAAaC,EAAeC,EAAazS,GAC7FyS,GACAxT,KAAK6G,QAAQ4M,kBAAkBH,EAAaE,EAAYX,mBAG5D,IADA,IAAIvR,EAAaP,EAAO2S,qBACfnS,EAAQ,EAAGA,EAAQD,EAAWS,OAAQR,IAAS,CACpD,IAAIoS,EAAa5S,EAAO6S,qBAAqBrS,GAC7C,GAAIoS,GAAc,EAAG,CACjB,IACIE,EAAeN,EADRjS,EAAWC,IAEtB,GAAIsS,EAAc,CACd,IAAIrB,EAASqB,EAAaC,YACtBtB,GACAxS,KAAK6G,QAAQkN,mBAAmBT,EAAad,EAAOY,mBAAoBO,EAAYE,EAAaf,WAAYe,EAAaG,WAAYH,EAAaI,UAAWjU,KAAKkU,qBAAqBL,EAAaM,MAAON,EAAaO,WAAYP,EAAaQ,0BAMtQxM,EAAa9I,UAAUuV,YAAc,SAAUf,EAAeC,EAAazS,GACnEf,KAAK4J,0BACL5J,KAAKmR,mBAAmBnR,KAAK4J,0BAEjC5J,KAAK4J,yBAA2B5J,KAAK6G,QAAQ0N,oBAC7CvU,KAAKqT,yBAAyBrT,KAAK4J,yBAA0B2J,EAAeC,EAAazS,GACzFf,KAAKwU,sBAAsBxU,KAAK4J,2BAEpC/B,EAAa9I,UAAU0V,wBAA0B,SAAUlB,EAAeC,EAAazS,GACnF,IAAIuS,EAActT,KAAK6G,QAAQ0N,oBAE/B,OADAvU,KAAKqT,yBAAyBC,EAAaC,EAAeC,EAAazS,GAChEuS,GAEXzL,EAAa9I,UAAUoS,mBAAqB,SAAUmC,GAClDtT,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOkL,2BAC/D1U,KAAK2J,sBAAsBR,6BAA6BmK,GACxDtT,KAAK2J,sBAAsBP,yBAE/BvB,EAAa9I,UAAUyV,sBAAwB,SAAUlB,GACrDtT,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmL,yBAC/D3U,KAAK2J,sBAAsBR,6BAA6BmK,GACxDtT,KAAK2J,sBAAsBP,yBAE/BvB,EAAa9I,UAAU6V,yBAA2B,SAAUtB,GACxDtT,KAAKmR,mBAAmBmC,IAE5BzL,EAAa9I,UAAUsD,cAAgB,SAAUwS,EAAiBxT,GAC9D,IAAIyT,EAAwBD,EAC5B,OAAO7U,KAAK6G,QAAQxE,cAAcyS,EAAsBC,cAAe1T,IAS3EwG,EAAa9I,UAAUiW,iBAAmB,SAAUC,EAAUC,EAAYC,EAAYC,GAElFpV,KAAKqV,WAAWC,SAAS,GAAG,GAQ5BtV,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO+L,qBAC/DvV,KAAK2J,sBAAsBrB,yBAAyB2M,GACpDjV,KAAK2J,sBAAsBrB,yBAAyB4M,GACpDlV,KAAK2J,sBAAsBrB,yBAAyB6M,GACpDnV,KAAK2J,sBAAsBP,yBAU/BvB,EAAa9I,UAAUyW,eAAiB,SAAUP,EAAUQ,EAAeC,EAAeN,GAEtFpV,KAAKqV,WAAWC,SAAS,GAAG,GAK5BtV,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmM,cAC/D3V,KAAK2J,sBAAsBrB,yBAAyB2M,GACpDjV,KAAK2J,sBAAsBrB,yBAAyBmN,GACpDzV,KAAK2J,sBAAsBrB,yBAAyBoN,GACpD1V,KAAK2J,sBAAsBP,yBAG/BvB,EAAa9I,UAAU6W,sBAAwB,WAC3C,OAAO,IAAIxV,EAAsBJ,OAErC6H,EAAa9I,UAAU8W,sBAAwB,aAG/ChO,EAAa9I,UAAU+W,kBAAoB,aAG3CjO,EAAa9I,UAAUgX,wBAA0B,SAAUlB,EAAiBmB,EAAkBC,EAAoBC,EAAaC,EAAqBC,EAAuBC,EAAeC,EAASC,GAC/L,IAAIzB,EAAwBD,EAExBC,EAAsBC,cADtBmB,EACsClW,KAAKwW,uBAAuB3B,EAAiBmB,EAAkBC,OAAoBpT,EAAW0T,GAG9FvW,KAAKyW,oBAAoB5B,EAAiBmB,EAAkBC,EAAoBK,OAASzT,EAAW0T,IAOlJ1O,EAAa9I,UAAU2X,0BAA4B,SAAU7B,GAEzD,OAAO,GAOXhN,EAAa9I,UAAU4X,qCAAuC,SAAU9B,EAAiB+B,GAErFA,KAEJ/O,EAAa9I,UAAUyX,uBAAyB,SAAU3B,EAAiBgC,EAAYC,EAAcC,EAASR,GAE1G,WADkC,IAA9BA,IAAwCA,EAA4B,MAClE,IAAI1V,MAAM,kBAEpBgH,EAAa9I,UAAU0X,oBAAsB,SAAU5B,EAAiBgC,EAAYC,EAAcR,EAASS,EAASR,QAC9E,IAA9BA,IAAwCA,EAA4B,MACxEvW,KAAKgX,oCAAoC1X,gBAAgBU,MACzD,IAAIiX,EAAgB,IAAI,IAAkBJ,GAC1CI,EAAcC,cACdL,EAAaI,EAAcE,KAC3B,IAAIC,EAAkB,IAAI,IAAkBN,GAC5CM,EAAgBF,cAChBJ,EAAeM,EAAgBD,KAC/BN,EAAa,uBAA8BA,EAAYP,GACvDQ,EAAe,uBAA8BA,EAAcR,GAC3D,IAAIe,EAAUrX,KAAK6G,QAAQyQ,cAAcT,EAAYC,GAErD,OADA9W,KAAKuX,mCAAmCjY,gBAAgBU,MACjDqX,GAOXxP,EAAa9I,UAAUyY,iBAAmB,SAAUL,GAChD,IAAIM,EAAM,IAAI,IAAkBN,GAGhC,OAFAM,EAAIC,OAAQ,EACZD,EAAIP,cACGO,EAAIN,MAEftP,EAAa9I,UAAU4Y,YAAc,SAAUN,GACvCrX,KAAK4X,kBAAoBP,IACzBrX,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOqO,oBAC/D7X,KAAK2J,sBAAsBR,6BAA6BkO,GACxDrX,KAAK2J,sBAAsBP,wBAC3BpJ,KAAK4X,gBAAkBP,IAG/BxP,EAAa9I,UAAU+Y,uBAAyB,SAAUjD,GACtD,IAAIC,EAAwBD,EACxBC,GAAyBA,EAAsBC,gBAC/C/U,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOuO,uBAC/D/X,KAAK2J,sBAAsBR,6BAA6B2L,EAAsBC,eAC9E/U,KAAK2J,sBAAsBP,0BAGnCvB,EAAa9I,UAAU4C,YAAc,SAAUkT,EAAiB5T,GAC5D,IAAI6T,EAAwBD,EAC5B,OAAO7U,KAAK6G,QAAQlF,YAAYmT,EAAsBC,cAAe9T,IAEzE4G,EAAa9I,UAAU2C,iBAAmB,SAAUmT,EAAiBmD,EAAWzW,GAE5E,MAAM,IAAIV,MAAM,oBAEpBgH,EAAa9I,UAAUkZ,aAAe,SAAUlX,GAC5C,IAAI+T,EAAwB/T,EAAOmX,qBACnClY,KAAK2X,YAAY7C,EAAsBC,eAGvC,IADA,IAAI3T,EAAWL,EAAOoX,cACb5W,EAAQ,EAAGA,EAAQH,EAASW,OAAQR,IAAS,CAClD,IAAIM,EAAUd,EAAOiB,WAAWZ,EAASG,IACrCM,IACA7B,KAAKoY,eAAe7W,GAASM,GAGrC7B,KAAKqY,eAAiB,MAE1BxQ,EAAa9I,UAAU0F,UAAY,SAAU5C,EAASY,GAClD,GAAKZ,EAAL,CAGA,IAAIyW,EAAc7V,EAAOiC,UACzB1E,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO+O,mBAC/DvY,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BqP,GACtDtY,KAAK2J,sBAAsBP,0BAE/BvB,EAAa9I,UAAUyZ,eAAiB,SAAUC,GAE9C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBC,MAE9B3Y,KAAK6G,QAAQ2R,kBAExB3Q,EAAa9I,UAAU6Z,gBAAkB,SAAUH,GAE/C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBG,OAE9B7Y,KAAK6G,QAAQ+R,mBAExB/Q,EAAa9I,UAAU+Z,YAAc,SAAUC,EAAUC,EAAeC,GACpEjZ,KAAKkZ,gBAAkBH,EACvB/Y,KAAK6G,QAAQsS,YAAYJ,EAAShW,EAAGgW,EAAS/V,EAAG+V,EAASJ,MAAOI,EAASF,SAE9EhR,EAAa9I,UAAUqa,SAAW,SAAUC,EAASC,EAASC,EAAOC,EAAaC,EAAexH,EAASyH,GACtG,IAAIzZ,EAAI0Z,OACQ,IAAZL,IAAsBA,EAAU,QAChB,IAAhBE,IAA0BA,GAAc,QACvB,IAAjBE,IAA2BA,EAAe,GAC9C1Z,KAAKuK,SAAW+O,EAChBtZ,KAAKwK,cAAgBkP,EACrB1Z,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOoQ,kBAC/D5Z,KAAK2J,sBAAsBrB,yBAAyB+Q,EAAU,EAAI,GAClErZ,KAAK2J,sBAAsBZ,0BAA0BuQ,GACrDtZ,KAAK2J,sBAAsBZ,0BAA0B2Q,GACrD1Z,KAAK2J,sBAAsBrB,yBAA8G,QAAnFqR,EAAmC,QAA7B1Z,EAAKD,KAAKyZ,qBAAkC,IAAPxZ,EAAgBA,EAAKwZ,SAAkC,IAAPE,GAAgBA,EAAa,EAAI,GAClL3Z,KAAK2J,sBAAsBrB,yBAAyBkR,EAAc,EAAI,GACtExZ,KAAK2J,sBAAsBP,yBAM/BvB,EAAa9I,UAAU8a,0BAA4B,WAY/C,MAXW,CACPC,OAAQ9Z,KAAK4Y,kBACbC,OAAQ7Y,KAAK4Y,kBACbmB,KAAM,EACNC,MAAOha,KAAKwY,iBACZyB,IAAK,EACLtB,MAAO3Y,KAAKwY,iBACZzV,EAAG,EACHC,EAAG,EACHkX,OAAQ,eAQhBrS,EAAa9I,UAAUob,WAAa,SAAU9a,GACtCA,IAAUW,KAAKuK,WACfvK,KAAKuK,SAAWlL,EAChBW,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO4Q,oBAC/Dpa,KAAK2J,sBAAsBZ,0BAA0B/I,KAAKkS,uBAAyB7S,EAAQA,GAC3FW,KAAK2J,sBAAsBP,0BAOnCvB,EAAa9I,UAAUsb,WAAa,WAChC,OAAOra,KAAKuK,UAMhB1C,EAAa9I,UAAUub,gBAAkB,SAAUjb,GAC3CA,IAAUW,KAAKwK,gBACfxK,KAAKwK,cAAgBnL,EACrBW,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO+Q,yBAC/Dva,KAAK2J,sBAAsBZ,0BAA0B/I,KAAKkS,uBAAyB7S,EAAQA,GAC3FW,KAAK2J,sBAAsBP,0BAOnCvB,EAAa9I,UAAUyb,gBAAkB,WACrC,OAAOxa,KAAKwK,eAMhB3C,EAAa9I,UAAU0b,eAAiB,SAAUC,GAC9C1a,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmR,sBAC/D3a,KAAK2J,sBAAsBrB,yBAAyBoS,EAAS1a,KAAK6J,kBAAoBnK,QAAQ8J,OAAOoR,mBACrG5a,KAAK2J,sBAAsBP,yBAM/BvB,EAAa9I,UAAU8b,cAAgB,WACnC,OAAO7a,KAAKyK,aAEhB5C,EAAa9I,UAAUuR,iBAAmB,WACtC,OAAQtQ,KAAK6J,mBACT,KAAKnK,QAAQ8J,OAAOsR,iBAChB,OAAO,IACX,KAAKpb,QAAQ8J,OAAOoR,kBAChB,OAAO,IACX,KAAKlb,QAAQ8J,OAAOuR,mBAChB,OAAO,IACX,KAAKrb,QAAQ8J,OAAOwR,kBAChB,OAAO,IACX,KAAKtb,QAAQ8J,OAAOyR,oBAChB,OAAO,IACX,KAAKvb,QAAQ8J,OAAO0R,iBAChB,OAAO,IACX,KAAKxb,QAAQ8J,OAAO2R,gBAChB,OAAO,IACX,KAAKzb,QAAQ8J,OAAOM,kBAChB,OAAO,IAEf,OAAO,MAEXjC,EAAa9I,UAAUwR,iBAAmB,SAAU6K,GAChD,IAAIC,EAAkB,EACtB,OAAQD,GACJ,KAAK,IACDC,EAAkB3b,QAAQ8J,OAAOsR,iBACjC,MACJ,KAAK,IACDO,EAAkB3b,QAAQ8J,OAAOoR,kBACjC,MACJ,KAAK,IACDS,EAAkB3b,QAAQ8J,OAAOuR,mBACjC,MACJ,KAAK,IACDM,EAAkB3b,QAAQ8J,OAAOwR,kBACjC,MACJ,KAAK,IACDK,EAAkB3b,QAAQ8J,OAAOyR,oBACjC,MACJ,KAAK,IACDI,EAAkB3b,QAAQ8J,OAAO0R,iBACjC,MACJ,KAAK,IACDG,EAAkB3b,QAAQ8J,OAAO2R,gBACjC,MACJ,KAAK,IACDE,EAAkB3b,QAAQ8J,OAAOM,kBAGzC9J,KAAK6J,kBAAoBwR,EACzBrb,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmR,sBAC/D3a,KAAK2J,sBAAsBrB,yBAAyBtI,KAAK6J,mBACzD7J,KAAK2J,sBAAsBP,yBAM/BvB,EAAa9I,UAAUuc,cAAgB,SAAUZ,GAC7C1a,KAAKyK,YAAciQ,EACnB1a,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO+R,uBAC/Dvb,KAAK2J,sBAAsBrB,yBAAyBkT,OAAOd,IAC3D1a,KAAK2J,sBAAsBP,yBAM/BvB,EAAa9I,UAAU0c,cAAgB,SAAUf,GAC7C1a,KAAK0b,YAAchB,EACnB1a,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmS,uBAC/D3b,KAAK2J,sBAAsBrB,yBAAyBkT,OAAOd,IAC3D1a,KAAK2J,sBAAsBP,yBAM/BvB,EAAa9I,UAAU6c,cAAgB,WACnC,OAAO5b,KAAK0b,aAEhB7T,EAAa9I,UAAU8c,aAAe,WAClC7b,KAAK8b,YAAY9b,KAAKgK,aAAchK,KAAK+b,kBAAkB/b,KAAKoK,uBAAwBpK,KAAKgc,qBAAqBhc,KAAKqK,qBAAsBrK,KAAKic,qBAAqBjc,KAAKsK,4BAA6BtK,KAAKkc,gBAAgBlc,KAAKiK,cAAejK,KAAKkK,kBAE3PrC,EAAa9I,UAAU+c,YAAc,SAAUK,EAAMC,EAAeC,EAAaC,EAAaC,EAAMC,GAChGxc,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOiT,oBAC/Dzc,KAAK2J,sBAAsBrB,yBAAyB6T,GACpDnc,KAAK2J,sBAAsBrB,yBAAyB8T,GACpDpc,KAAK2J,sBAAsBrB,yBAAyB+T,GACpDrc,KAAK2J,sBAAsBrB,yBAAyBgU,GACpDtc,KAAK2J,sBAAsBrB,yBAAyBiU,GACpDvc,KAAK2J,sBAAsBrB,yBAAyBkU,GACpDxc,KAAK2J,sBAAsBP,yBAM/BvB,EAAa9I,UAAU2d,iBAAmB,SAAUhC,GAChD1a,KAAK+J,aAAe2Q,EAChBA,EACA1a,KAAK6b,eAGL7b,KAAK8b,YAAY,IAAKpc,QAAQ8J,OAAOmT,uBAAwBjd,QAAQ8J,OAAOoT,uBAAwBld,QAAQ8J,OAAOqT,uBAAwBnd,QAAQ8J,OAAOsT,oBAAqB,IAOvLjV,EAAa9I,UAAUge,iBAAmB,WACtC,OAAO/c,KAAK+J,cAMhBlC,EAAa9I,UAAUie,wBAA0B,WAC7C,OAAOhd,KAAKsK,4BAMhBzC,EAAa9I,UAAUke,wBAA0B,SAAUC,GACvDld,KAAKsK,2BAA6B4S,EAClCld,KAAK6b,gBAMThU,EAAa9I,UAAUoe,eAAiB,SAAUhB,GAC9Cnc,KAAKgK,aAAemS,EACpBnc,KAAK6b,gBAMThU,EAAa9I,UAAUqe,mBAAqB,SAAUC,GAClDrd,KAAKiK,aAAeoT,EACpBrd,KAAK6b,gBAMThU,EAAa9I,UAAUue,4BAA8B,SAAUC,GAC3Dvd,KAAKkK,gBAAkBqT,EACvBvd,KAAK6b,gBAMThU,EAAa9I,UAAUye,uBAAyB,SAAUrB,GACtDnc,KAAKmK,iBAAmBgS,GAM5BtU,EAAa9I,UAAU0e,wBAA0B,SAAUP,GACvDld,KAAKoK,sBAAwB8S,EAC7Bld,KAAK6b,gBAMThU,EAAa9I,UAAU2e,6BAA+B,SAAUR,GAC5Dld,KAAKqK,oBAAsB6S,EAC3Bld,KAAK6b,gBAMThU,EAAa9I,UAAU4e,eAAiB,WACpC,OAAO3d,KAAKgK,cAMhBnC,EAAa9I,UAAU6e,mBAAqB,WACxC,OAAO5d,KAAKiK,cAMhBpC,EAAa9I,UAAU8e,4BAA8B,WACjD,OAAO7d,KAAKkK,iBAMhBrC,EAAa9I,UAAU+e,uBAAyB,WAC5C,OAAO9d,KAAKmK,kBAMhBtC,EAAa9I,UAAUgf,wBAA0B,WAC7C,OAAO/d,KAAKoK,uBAMhBvC,EAAa9I,UAAUif,6BAA+B,WAClD,OAAOhe,KAAKqK,qBAShBxC,EAAa9I,UAAUkf,kBAAoB,SAAUpY,EAAGC,EAAGC,EAAGK,GAC1D,MAAM,IAAIvF,MAAM,4DAQpBgH,EAAa9I,UAAUmf,aAAe,SAAUC,EAAMC,GAElD,QAD2B,IAAvBA,IAAiCA,GAAqB,GACtDpe,KAAKqe,aAAeF,EAAxB,CAGA,IAAIG,EAAate,KAAKue,oBAAoBJ,GAC1Cne,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOgV,sBAC/Dxe,KAAK2J,sBAAsBrB,yBAAyBgW,GACpDte,KAAK2J,sBAAsBP,wBACtBgV,GACDpe,KAAKsb,cAAuB,IAAT6C,GAEvBne,KAAKqe,WAAaF,IAOtBtW,EAAa9I,UAAU0f,aAAe,WAClC,OAAOze,KAAKqe,YAEhBxW,EAAa9I,UAAUuE,OAAS,SAAUzB,EAAS6c,GAC/C,QAAK7c,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOmV,gBAC/D3e,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBhB,wBAAwB+V,GACnD1e,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU2E,YAAc,SAAU7B,EAAS8B,GACpD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOoV,qBAC/D5e,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBd,yBAAyBlF,GACpD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU6E,aAAe,SAAU/B,EAAS8B,GACrD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOqV,sBAC/D7e,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBd,yBAAyBlF,GACpD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU8E,aAAe,SAAUhC,EAAS8B,GACrD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOsV,sBAC/D9e,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBd,yBAAyBlF,GACpD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU+E,aAAe,SAAUjC,EAAS8B,GACrD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOuV,sBAC/D/e,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBd,yBAAyBlF,GACpD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUgF,cAAgB,SAAUlC,EAAS8B,GACtD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOwV,uBAC/Dhf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BtF,GACtD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUiF,eAAiB,SAAUnC,EAAS8B,GACvD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOyV,wBAC/Djf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BtF,GACtD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUkF,eAAiB,SAAUpC,EAAS8B,GACvD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO0V,wBAC/Dlf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BtF,GACtD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUmF,eAAiB,SAAUrC,EAAS8B,GACvD,QAAK9B,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO2V,wBAC/Dnf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BtF,GACtD3D,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUoF,SAAW,SAAUtC,EAAS8B,GACjD,QAAK9B,GAGE7B,KAAK+D,cAAclC,EAAS,IAAIsR,aAAaxP,KAExDkE,EAAa9I,UAAUqF,UAAY,SAAUvC,EAAS8B,GAClD,QAAK9B,GAGE7B,KAAKgE,eAAenC,EAAS,IAAIsR,aAAaxP,KAEzDkE,EAAa9I,UAAUsF,UAAY,SAAUxC,EAAS8B,GAClD,QAAK9B,GAGE7B,KAAKiE,eAAepC,EAAS,IAAIsR,aAAaxP,KAEzDkE,EAAa9I,UAAUuF,UAAY,SAAUzC,EAAS8B,GAClD,QAAK9B,GAGE7B,KAAKkE,eAAerC,EAAS,IAAIsR,aAAaxP,KAEzDkE,EAAa9I,UAAUwF,YAAc,SAAU1C,EAAS2C,GACpD,QAAK3C,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO4V,qBAC/Dpf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BzE,GACtDxE,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU4F,aAAe,SAAU9C,EAASY,GACrD,QAAKZ,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO6V,sBAC/Drf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BxG,GACtDzC,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU6F,aAAe,SAAU/C,EAASY,GACrD,QAAKZ,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO8V,sBAC/Dtf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBV,2BAA2BxG,GACtDzC,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU8F,SAAW,SAAUhD,EAASxC,GACjD,QAAKwC,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO+V,kBAC/Dvf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBZ,0BAA0B1J,GACrDW,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUmG,UAAY,SAAUrD,EAASkB,EAAGC,GACrD,QAAKnB,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOgW,mBAC/Dxf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBZ,0BAA0BhG,GACrD/C,KAAK2J,sBAAsBZ,0BAA0B/F,GACrDhD,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUsG,UAAY,SAAUxD,EAASkB,EAAGC,EAAGG,GACxD,QAAKtB,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOiW,mBAC/Dzf,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBZ,0BAA0BhG,GACrD/C,KAAK2J,sBAAsBZ,0BAA0B/F,GACrDhD,KAAK2J,sBAAsBZ,0BAA0B5F,GACrDnD,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAUyG,UAAY,SAAU3D,EAASkB,EAAGC,EAAGG,EAAGE,GAC3D,QAAKxB,IAGL7B,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOkW,mBAC/D1f,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBZ,0BAA0BhG,GACrD/C,KAAK2J,sBAAsBZ,0BAA0B/F,GACrDhD,KAAK2J,sBAAsBZ,0BAA0B5F,GACrDnD,KAAK2J,sBAAsBZ,0BAA0B1F,GACrDrD,KAAK2J,sBAAsBP,yBACpB,IAEXvB,EAAa9I,UAAU4G,UAAY,SAAU9D,EAAS+D,GAClD,QAAK/D,IAGL7B,KAAKqF,UAAUxD,EAAS+D,EAAOC,EAAGD,EAAOE,EAAGF,EAAOG,IAC5C,IAEX8B,EAAa9I,UAAUiH,UAAY,SAAUnE,EAAS+D,EAAQK,GAC1D,QAAKpE,IAGL7B,KAAKwF,UAAU3D,EAAS+D,EAAOC,EAAGD,EAAOE,EAAGF,EAAOG,EAAGE,IAC/C,IAEX4B,EAAa9I,UAAU4gB,WAAa,SAAUC,GACtC5f,KAAK6f,gCAGT7f,KAAK8f,oBACL9f,KAAKqY,eAAiB,KAClBuH,IACA5f,KAAK4X,gBAAkB,KACvB5X,KAAK+f,sBAAsBC,QAC3BhgB,KAAKigB,mBAAmBD,QACxBhgB,KAAKkgB,YAAYF,SAErBhgB,KAAKmgB,qBAAuB,KAC5BngB,KAAKogB,mBAAqB,KAC1BpgB,KAAKqgB,8BAAgC,OAEzCxY,EAAa9I,UAAUuhB,eAAiB,WACpC,OAAOtgB,KAAK6G,QAAQ0Z,iBAExB1Y,EAAa9I,UAAUyhB,eAAiB,SAAUC,GAC1CA,GACAzgB,KAAK6G,QAAQ6Z,cAAcD,IAWnC5Y,EAAa9I,UAAU4hB,qBAAuB,SAAUF,EAASG,EAAQC,EAASC,EAAaC,GAK3F,QAJoB,IAAhBD,IAA0BA,GAAc,QACxB,IAAhBA,IACAA,GAAc,GAEZL,GAAaA,EAAQO,iBAAkB,CACzC,IAAIC,EAASL,EAAOM,mBAChBC,EAAcV,EAAQO,iBAAiBI,mBAC3CphB,KAAK6G,QAAQwa,YAAYF,EAAaF,GACtCR,EAAQlgB,SAAU,IAG1BsH,EAAa9I,UAAUuiB,qBAAuB,SAAU3I,EAAOE,EAAQ0I,EAAiBC,GAKpF,OAFA7I,EAAQ8I,KAAKC,IAAI/I,EAAO,GACxBE,EAAS4I,KAAKC,IAAI7I,EAAQ,GACnB7Y,KAAK2hB,iBAAiB,IAAIC,WAAWjJ,EAAQE,EAAS,GAAIF,EAAOE,EAAQ,GAAG,GAAO,EAAO2I,IAErG3Z,EAAa9I,UAAU8iB,mBAAqB,SAAUC,GAElD,OAAI9hB,KAAKyJ,QACEzJ,KAAKyJ,QAAQsY,YAAYD,GAE7B,MAEXja,EAAa9I,UAAUijB,mBAAqB,SAAUvB,EAASwB,EAAOpB,GAClE,GAAIJ,GAAWA,EAAQO,kBAAoBhhB,KAAKyJ,QAAS,CACrD,IAAIyY,EAAezB,EAAQO,iBAAiBI,mBAC5CphB,KAAKyJ,QAAQuY,mBAAmBE,EAAcD,EAAOpB,KAG7DhZ,EAAa9I,UAAU4iB,iBAAmB,SAAUnS,EAAMmJ,EAAOE,EAAQkI,EAAQQ,EAAiBV,EAASW,EAAcW,EAAahO,EAAMiO,EAAeC,QACnI,IAAhBF,IAA0BA,EAAc,WAC/B,IAAThO,IAAmBA,EAAO,QACR,IAAlBiO,IAA4BA,EAAgB,QAC1B,IAAlBC,IAA4BA,GAAgB,GAChD,IAAI5B,EAAU,IAAI,IAAgBzgB,KAAM,SAaxC,GAZAygB,EAAQM,OAASA,EACjBN,EAAQc,gBAAkBA,EAC1Bd,EAAQe,aAAeA,EACvBf,EAAQI,QAAUA,EAClBJ,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQ9H,MAAQ8H,EAAQ6B,UACxB7B,EAAQ5H,OAAS4H,EAAQ8B,WACzB9B,EAAQ+B,aAAeL,EACvB1B,EAAQtM,KAAOA,EACfsM,EAAQgC,eAAiBziB,KAAK0iB,kBAAkBL,GAAgBd,GAChEvhB,KAAK2iB,iBAAiBlC,EAASjR,EAAMuR,EAAQF,EAASsB,EAAahO,EAAMsM,EAAQgC,gBAC7EhC,EAAQO,iBAAkB,CAC1B,IAAIkB,EAAezB,EAAQO,iBAAiBI,mBACxCwB,EAAS5iB,KAAK6iB,uBAAuBrB,GACzCxhB,KAAK8iB,oBAAoBZ,EAAcU,GAG3C,OADA5iB,KAAK+iB,uBAAuB5gB,KAAKse,GAC1BA,GAEX5Y,EAAa9I,UAAUikB,wBAA0B,SAAUxT,EAAMmJ,EAAOE,EAAQ7G,EAAO+O,EAAQQ,EAAiBV,EAASW,EAAcW,EAAac,QAC5H,IAAhBd,IAA0BA,EAAc,WACxB,IAAhBc,IAA0BA,EAAc,GAC5C,IAAIxC,EAAU,IAAI,IAAgBzgB,KAAM,gBAYxC,GAXAygB,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQyC,UAAYlR,EACpByO,EAAQ9H,MAAQA,EAChB8H,EAAQ5H,OAASA,EACjB4H,EAAQzO,MAAQA,EAChByO,EAAQM,OAASA,EACjBN,EAAQtM,KAAO8O,EACfxC,EAAQc,gBAAkBA,EAC1Bd,EAAQe,aAAeA,EACvBf,EAAQ0C,WAAY,EAChB1C,EAAQO,iBAAkB,CAC1B,IAAIkB,EAAezB,EAAQO,iBAAiBI,mBAC5CphB,KAAK6G,QAAQuc,sBAAsBlB,EAAc1S,EAAMmJ,EAAOE,EAAQ7G,EAAOhS,KAAKqjB,wBAAwBtC,EAAQkC,GAAc1B,EAAiBV,GACjJ,IAAI+B,EAAS5iB,KAAK6iB,uBAAuBrB,GACzCxhB,KAAK8iB,oBAAoBZ,EAAcU,GAI3C,OAFAnC,EAAQlgB,SAAU,EAClBP,KAAK+iB,uBAAuB5gB,KAAKse,GAC1BA,GAEX5Y,EAAa9I,UAAU4jB,iBAAmB,SAAUlC,EAAS6C,EAAYvC,EAAQF,EAASsB,EAAahO,EAAMkO,GAIzG,QAHoB,IAAhBF,IAA0BA,EAAc,WAC/B,IAAThO,IAAmBA,EAAO,QACR,IAAlBkO,IAA4BA,GAAgB,GAC3C5B,EAAL,CAGA,GAAI6C,GAAc7C,EAAQO,iBAAkB,CACxC,IAAII,EAAqBX,EAAQO,iBAAiBI,mBAClDphB,KAAK6G,QAAQ0c,eAAenC,EAAoBkC,EAAY7C,EAAQ9H,MAAO8H,EAAQ5H,OAAQ7Y,KAAKqjB,wBAAwBtC,EAAQ5M,GAAOsM,EAAQc,gBAAiBd,EAAQI,SAE5KJ,EAAQlgB,SAAU,IA0BtBsH,EAAa9I,UAAUwhB,cAAgB,SAAUiD,EAAKC,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,EAASkD,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,EAAUC,EAAe1B,EAAeC,GAC9L,IAAI3b,EAAQ1G,UACS,IAAjBwhB,IAA2BA,EAAe,QAC/B,IAAXkC,IAAqBA,EAAS,WAClB,IAAZpU,IAAsBA,EAAU,WACrB,IAAXkD,IAAqBA,EAAS,WACjB,IAAbmR,IAAuBA,EAAW,WACvB,IAAX5C,IAAqBA,EAAS,WACV,IAApB6C,IAA8BA,EAAkB,WAC9B,IAAlBvB,IAA4BA,GAAgB,GAEhD,IAAI0B,EAAgC,WADpCP,EAAMA,GAAO,IACMQ,OAAO,EAAG,GAEzBC,EAAWF,IAAyC,IAA7BP,EAAIU,QAAQ,YACnCzD,EAAUkD,GAAsB,IAAI,IAAgB3jB,KAAM,SAC1DmkB,EAAcX,GACdxjB,KAAKokB,sBAAyBH,GAAaN,GAAanR,IACxDgR,EAAMxjB,KAAKokB,qBAAqBZ,IAMpC,IAHA,IAAIa,EAAUb,EAAIc,YAAY,KAC1BC,EAAYX,IAAoCS,GAAW,EAAIb,EAAIgB,UAAUH,GAASI,cAAgB,IACtGC,EAAS,KACJ3T,EAAK,EAAG9Q,EAAK,oBAAwB8Q,EAAK9Q,EAAG8B,OAAQgP,IAAM,CAChE,IAAI4T,EAAkB1kB,EAAG8Q,GACzB,GAAI4T,EAAgBC,QAAQL,GAAY,CACpCG,EAASC,EACT,OAGJhU,GACAA,EAAMkU,gBAAgBpE,GAE1BA,EAAQ+C,IAAMA,EACd/C,EAAQc,iBAAmBkC,EAC3BhD,EAAQe,aAAeA,EACvBf,EAAQI,QAAUA,EAClBJ,EAAQgC,eAAiBziB,KAAK0iB,kBAAkBL,EAAeoB,GAC1DzjB,KAAK8kB,yBAENrE,EAAQsE,QAAUvS,GAEtB,IAAIwS,EAAiB,KACjBtB,IAAWC,IACXqB,EAAiBvE,EAAQwE,mBAAmBvU,IAAIgT,IAE/CC,GACD3jB,KAAK+iB,uBAAuB5gB,KAAKse,GAwBrC,GAAIiE,EACA,MAAM,IAAI7jB,MAAM,qEAGhB,IAAIqkB,EAAW,SAAU1V,GACrB,GAAKiR,EAAQO,iBAAb,CAMA,IAAII,EAAqBX,EAAQO,iBAAiBI,mBAClD1a,EAAMG,QAAQse,YAAY/D,EAAoB5R,GAAOiU,EAAU5C,EAASwB,GAAe,WACnF5B,EAAQ6B,UAAY5b,EAAMG,QAAQue,gBAAgBhE,GAClDX,EAAQ8B,WAAa7b,EAAMG,QAAQwe,iBAAiBjE,GACpDX,EAAQ9H,MAAQ8H,EAAQ6B,UACxB7B,EAAQ5H,OAAS4H,EAAQ8B,WACzB9B,EAAQlgB,SAAU,EAClB,IAAIqiB,EAASlc,EAAMmc,uBAAuBrB,GAC1C9a,EAAMoc,oBAAoB1B,EAAoBwB,GAC1CjS,GACAA,EAAM2U,mBAAmB7E,GAE7BA,EAAQwE,mBAAmB3lB,gBAAgBmhB,GAC3CA,EAAQwE,mBAAmBpT,WAC5B,WACC,MAAM,IAAIhR,MAAM,4CApBZ8P,GACAA,EAAM2U,mBAAmB7E,IAsBrC,GAAIsD,GAAYvR,EACZ,GAAIA,aAAkBS,YAClBiS,EAAS,IAAItD,WAAWpP,SAEvB,GAAIS,YAAYC,OAAOV,GACxB0S,EAAS1S,OAER,IAAsB,iBAAXA,EAIZ,MAAM,IAAI3R,MAAM,2BAHhBqkB,EAAS,IAAItD,WAAW,kBAAmBpP,UAO3CyR,EACAiB,EAAS,IAAItD,WAAW,kBAAmB4B,KAG3CxjB,KAAKulB,UAAU/B,GAAK,SAAUhU,GAAQ,OAAO0V,EAAS,IAAItD,WAAWpS,WAAW3M,OAAWA,GAAW,GAAM,SAAU6M,EAASC,IAtErH,SAAU6V,EAAS7V,GACjCgB,GACAA,EAAM2U,mBAAmB7E,GAEzB+C,IAAQW,GACJa,GACAvE,EAAQwE,mBAAmBQ,OAAOT,GAElC,wBACAte,EAAM6Z,cAAc,oBAA6BkD,EAAUhD,EAAQI,QAASlQ,EAAO6Q,EAAc,KAAMlS,EAASkD,EAAQiO,GAExHnR,GACAA,GAASkW,GAAW,kBAAoB,uBAAiC,+BAAiC,IAAK7V,KAKnH,SAAY,kBAAkBhF,OAAO6Y,EAAK,sBAAsB7Y,OAAOwZ,IACvEzd,EAAM6Z,cAAc4D,EAAaV,EAAUhD,EAAQI,QAASlQ,EAAO6Q,EAAckC,EAAQpU,EAASkD,EAAQiO,EAASM,EAAQ6C,EAAiBC,EAAUC,IAqD9I4B,CAAgB,mBAAqBhW,GAAUA,EAAQiW,YAAmBhW,OAK1F,OAAO8Q,GAOX5Y,EAAa9I,UAAU6mB,kBAAoB,SAAUnF,GAEjD,IAAIoF,EAAkB,IAAI,IAAqBpF,EAASzgB,KAAK8lB,KACzDC,EAAkB,IAAI,IAAgB/lB,KAAM,aAA+B,GAG/E,OAFA+lB,EAAgB/E,iBAAmB6E,EACnCE,EAAgBxlB,SAAU,EACnBwlB,GAMXle,EAAa9I,UAAUinB,iBAAmB,WACtC,MAAM,IAAInlB,MAAM,sEAEpBgH,EAAa9I,UAAUknB,2BAA6B,SAAUxf,EAAM6C,EAAS4c,GACzE,IAAIC,EAAkBD,EAClBzF,EAAU,IAAI,IAAgBzgB,KAAM,kBACpC2Y,EAAQlS,EAAKkS,OAASlS,EACtBoS,EAASpS,EAAKoS,QAAUpS,EACxBK,EAAc9G,KAAK6G,QAAQuf,kBAAkB3F,EAAQO,iBAAiBI,mBAAoBzI,EAAOE,EAAQnZ,QAAQ8J,OAAO6c,sBAAsB,GAAO,GAAM,GAE/J,OADAF,EAAgB9e,yBAA2BP,EACpC2Z,GAMX5Y,EAAa9I,UAAUgI,2BAA6B,SAAUD,GACtDA,IACA9G,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO8c,2BAC/DtmB,KAAK2J,sBAAsBR,6BAA6BrC,GACxD9G,KAAK2J,sBAAsBP,0BAUnCvB,EAAa9I,UAAUwnB,6BAA+B,SAAUC,EAAald,GACzE,IAAI5C,EAAQ1G,KAiBZ,OAhBc,IAAIR,SAAQ,SAAUC,EAASgnB,GACzC,IAAIC,EAAQhgB,EAAMigB,oBAClBD,EAAME,OAAS,WACX,IACI,IAAIC,EAAcngB,EAAMG,QAAQigB,kBAAkBJ,GAClDjnB,EAAQonB,GAEZ,MAAOE,GACHN,EAAO,uBAAuB9b,OAAO+b,EAAMM,IAAK,qBAAqBrc,OAAOoc,MAGpFL,EAAMO,QAAU,SAAUF,GACtBN,EAAO,uBAAuB9b,OAAO+b,EAAMM,IAAK,qBAAqBrc,OAAOoc,KAEhFL,EAAMM,IAAMR,MAUpB3e,EAAa9I,UAAU+nB,kBAAoB,SAAUJ,EAAOpd,GACxD,IAAI5C,EAAQ1G,KACZ,OAAO,IAAIR,SAAQ,SAAUC,EAASgnB,GAClC,GAAI/e,MAAMwf,QAAQR,GAAQ,CACtB,IAAIS,EAAMT,EACV,GAAIS,EAAIplB,OAAQ,CACZ,IAAIqlB,EAAU1gB,EAAMG,QAAQigB,kBAAkBK,EAAI,IAClD,GAAIC,EAEA,YADA3nB,EAAQ2nB,IAKpBX,EAAO,+CAUf5e,EAAa9I,UAAUsoB,kBAAoB,SAAUX,EAAOY,EAAaC,GACrE,OAAOvnB,KAAK6G,QAAQwgB,kBAAkBX,EAAOY,EAAaC,IAoB9D1f,EAAa9I,UAAUyoB,kBAAoB,SAAUC,EAAS9W,EAAO+W,EAAOjE,EAAUC,EAAQpU,EAASyR,EAAQ6C,EAAiB+D,EAAmBC,EAAUC,EAAWlE,EAAUG,EAAezB,GAC7L,IAAI3b,EAAQ1G,UACG,IAAX0jB,IAAqBA,EAAS,WAClB,IAAZpU,IAAsBA,EAAU,WACZ,IAApBsU,IAA8BA,EAAkB,WAC1B,IAAtB+D,IAAgCA,GAAoB,QACvC,IAAbC,IAAuBA,EAAW,QACpB,IAAdC,IAAwBA,EAAY,QACvB,IAAblE,IAAuBA,EAAW,WAChB,IAAlBtB,IAA4BA,GAAgB,GAChD,IAAI5B,EAAUkD,GAAsB,IAAI,IAAgB3jB,KAAM,UAC9DygB,EAAQja,QAAS,EACjBia,EAAQ+C,IAAMiE,EACdhH,EAAQc,iBAAmBkC,EAC3BhD,EAAQqH,oBAAsBF,EAC9BnH,EAAQsH,qBAAuBF,EAC1B7nB,KAAKgoB,0BACNvH,EAAQwH,WAAarE,EACrBnD,EAAQyH,OAASR,GAErB,IAAIrD,EAAUoD,EAAQnD,YAAY,KAGlC,GAAkB,UAFFV,IAAoCS,GAAW,EAAIoD,EAAQjD,UAAUH,GAASI,cAAgB,KAEpF,CA2BtB,GAAIiD,GAA0B,IAAjBA,EAAM3lB,OACf,MAAM,IAAIlB,MAAM,gDAQhBb,KAAKulB,UAAUkC,GAAS,SAAUjY,GAAQ,OAnC3B,SAAUA,GACzB,IAAI2Y,GAAO,QAAW3Y,GACtBiR,EAAQ9H,MAAQwP,EAAKxP,MACrB8H,EAAQ5H,OAASsP,EAAKxP,OACtB,QAAmB8H,EAAS0H,GAC5B,IAAIC,EAAeD,EAAKE,SACxB,IAAKD,EACD,MAAM,IAAIvnB,MAAM,8BAEpB4f,EAAQqH,oBAAsBM,EAAaE,mBAC3C,IAAIC,GAAY,QAAgC/Y,EAAM2Y,GACtD1H,EAAQM,OAAS,EACjBN,EAAQtM,KAAO,EACfsM,EAAQc,iBAAkB,EAC1Bd,EAAQ+H,YAAYC,0BAA0B,2BAAgChI,GAC9EA,EAAQiI,SAAU,EAClBjI,EAAQI,SAAU,EAClBna,EAAMG,QAAQ8hB,wBAAwBlI,EAAQO,iBAAiBI,mBAAoBmH,GAAW,EAAOlG,GAAe,WAChH5B,EAAQlgB,SAAU,EACdmjB,GACAA,OAEL,WACC,MAAM,IAAI7iB,MAAM,4CAY6B+nB,CAAa,IAAIhH,WAAWpS,WAAW3M,OAAWA,GAAW,GALxF,SAAU6M,EAASC,GACjCL,GAAWI,GACXJ,EAAQI,EAAQmZ,OAAS,IAAMnZ,EAAQoZ,WAAYnZ,UAM9D,CACD,IAAK+X,GAA0B,IAAjBA,EAAM3lB,OAChB,MAAM,IAAIlB,MAAM,wDAGpB,IAAIkoB,EAAiB,CAACrB,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAC9EloB,QAAQwpB,IAAID,EAAeE,KAAI,SAAUC,GAAQ,OAAO,mBAAoBA,GAAMC,MAAK,SAAU3Z,GAAQ,OAAO,IAAIoS,WAAWpS,UAC1H2Z,MAAK,SAAU3Z,GAChB,OAAO,IAAIhQ,SAAQ,SAAUC,EAASgnB,GAClC/f,EAAMG,QAAQuiB,gBAAgB3I,EAAQO,iBAAiBI,mBAAoB5R,GAAOiU,GAAU,EAAMpB,EAAe5iB,EAASgnB,SAG7H0C,MAAK,WACN1I,EAAQlgB,SAAU,EACdmjB,GACAA,OAEL,SAAUqD,GACLzX,GACAA,EAAQ,2BAA2B3E,OAAOoc,EAAMvB,SAAUuB,MAKtE,OADA/mB,KAAK+iB,uBAAuB5gB,KAAKse,GAC1BA,GAQX5Y,EAAa9I,UAAUsqB,mCAAqC,SAAU9iB,EAASC,EAAQC,GACnF,IAAIyf,EAAY,IAAI7f,EAA0BE,EAASC,EAAQC,EAAMzG,MAErE,OADAA,KAAKspB,0BAA0BnnB,KAAK+jB,GAC7BA,GAEXre,EAAa9I,UAAUwqB,0BAA4B,SAAU9iB,EAAM6C,GAC/D,IAAI4c,EAAYlmB,KAAKqpB,oCAAmC,GAAO,EAAO5iB,GAClE+iB,EAAc,QACF3mB,IAAZyG,GAA4C,iBAAZA,GAChCkgB,EAAYjI,gBAAkBjY,EAAQiY,gBACtCiI,EAAYC,yBAAsD5mB,IAAhCyG,EAAQmgB,qBAA2CngB,EAAQmgB,oBAC7FD,EAAYE,sBAAwBF,EAAYC,qBAAuBngB,EAAQogB,sBAC/EF,EAAYrV,UAAwBtR,IAAjByG,EAAQ6K,KAAqB,EAAI7K,EAAQ6K,KAC5DqV,EAAYhI,kBAAwC3e,IAAzByG,EAAQkY,aAA6B,EAAIlY,EAAQkY,aAC5EgI,EAAYzI,YAA4Ble,IAAnByG,EAAQyX,OAAuB,EAAIzX,EAAQyX,SAGhEyI,EAAYjI,gBAAkBjY,EAC9BkgB,EAAYC,qBAAsB,EAClCD,EAAYE,uBAAwB,EACpCF,EAAYrV,KAAO,EACnBqV,EAAYhI,aAAe,EAC3BgI,EAAYzI,OAAS,IAEA,IAArByI,EAAYrV,MAAenU,KAAK8K,MAAMwB,+BAIZ,IAArBkd,EAAYrV,MAAenU,KAAK8K,MAAM2B,mCAF3C+c,EAAYhI,aAAe,GAM/B,IAAIf,EAAU,IAAI,IAAgBzgB,KAAM,kBACpC2Y,EAAQlS,EAAKkS,OAASlS,EACtBoS,EAASpS,EAAKoS,QAAUpS,EACH,IAArB+iB,EAAYrV,MAAenU,KAAK8K,MAAMuB,eACtCmd,EAAYrV,KAAO,EACnB,SAAY,6FAEhB,IAAIrN,EAAc9G,KAAK6G,QAAQuf,kBAAkB3F,EAAQO,iBAAiBI,mBAAoBzI,EAAOE,EAAQ7Y,KAAKqjB,wBAAwBmG,EAAYzI,OAAQyI,EAAYrV,QAAOqV,EAAYE,sBAAsCF,EAAYC,sBAAqBD,EAAYjI,iBAgBhR,OAfA2E,EAAU9e,aAAeN,EACzBof,EAAUyD,qBAAuBH,EAAYC,oBAC7CvD,EAAU0D,yBAAyBJ,EAAYE,sBAC/CjJ,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQ9H,MAAQA,EAChB8H,EAAQ5H,OAASA,EACjB4H,EAAQlgB,SAAU,EAClBkgB,EAAQoJ,QAAU,EAClBpJ,EAAQc,kBAAkBiI,EAAYjI,gBACtCd,EAAQe,aAAegI,EAAYhI,aACnCf,EAAQtM,KAAOqV,EAAYrV,KAC3BsM,EAAQM,OAASyI,EAAYzI,OAC7B/gB,KAAK+iB,uBAAuB5gB,KAAKse,GACjCyF,EAAU4D,YAAYrJ,GACfyF,GAEXre,EAAa9I,UAAU0pB,0BAA4B,SAAUjH,EAAcf,GACvE,GAAIA,EAAQO,iBAAkB,CAC1B,IAAI4B,EAAS5iB,KAAK6iB,uBAAuBrB,GACzCxhB,KAAK8iB,oBAAoBrC,EAAQO,iBAAiBI,mBAAoBwB,GAE1EnC,EAAQe,aAAeA,GAE3B3Z,EAAa9I,UAAUgrB,gBAAkB,SAAUtJ,EAASuJ,EAAWhR,EAAeC,EAAgBgR,GAClG,IAAI9D,EAAkB1F,EACtB,GAAIuJ,EACA,MAAM,IAAInpB,MAAM,+DAEpB,GAAImY,GAAiBC,EACjB,MAAM,IAAIpY,MAAM,8EAKhBslB,EAAgB9e,yBAChBrH,KAAKwR,wBAAwB2U,EAAgB9e,0BAG7CrH,KAAKwR,wBAAwB2U,EAAgB/e,eAGrDS,EAAa9I,UAAUmrB,kBAAoB,SAAUzJ,EAAS0J,EAAwBC,QAEnD,IAA3BD,IAAqCA,GAAyB,GAC9DC,GACAA,IAEJpqB,KAAKwR,wBAAwB,OAEjC3J,EAAa9I,UAAUsrB,0BAA4B,SAAU7a,GACzD,OAAOxP,KAAK+S,mBAAmBvD,GAAM,IAEzC3H,EAAa9I,UAAUurB,yBAA2B,SAAU9W,EAAanB,EAASkY,QAC/D,IAAXA,IAAqBA,EAAS,GAClC,IAAI/X,EAASgB,EACThE,EAAOxP,KAAKuS,oBAAoBF,GACpCG,EAAOE,SAAsC,IAA3BlD,EAAKmD,kBACvB3S,KAAK6G,QAAQyjB,yBAAyB9X,EAAOK,kBAAmBrD,EAAKgD,OAAQhD,EAAKsD,WAAYtD,EAAKoD,WAAY2X,IAEnH1iB,EAAa9I,UAAUyrB,0BAA4B,SAAU3W,EAAc4W,EAAW3X,EAAYF,GAC9F,IAAIJ,EAASqB,EACTrE,EAAOyD,YAAYC,OAAOuX,GAAaA,EAAY,IAAItX,aAAasX,GACxEzqB,KAAK6G,QAAQ2jB,0BAA0BhY,EAAOY,mBAAoB5D,EAAKgD,OAAQhD,EAAKsD,YAAcA,QAA+CA,EAAa,GAAIF,QAA+CA,EAAapD,EAAKoD,aAGvO/K,EAAa9I,UAAU2rB,YAAc,SAAUC,EAASlK,EAASmK,EAAsBC,QACtD,IAAzBD,IAAmCA,GAAuB,QAClC,IAAxBC,IAAkCA,GAAsB,GAC5D,IAsBI9E,EAtBAlkB,EAAU7B,KAAKoY,eAAeuS,GAClC,IAAK9oB,EACD,OAAO,EAGX,IAAK4e,EAKD,OAJyC,MAArCzgB,KAAK8qB,oBAAoBH,KACzB3qB,KAAK+qB,eAAiBJ,EACtB3qB,KAAKgrB,gBAAgBnpB,EAAS,QAE3B,EAGX,GAAI4e,EAAQwB,MACRjiB,KAAK+qB,eAAiBJ,EACtBlK,EAAQwK,cAEP,GAA+B,IAA3BxK,EAAQyK,eAGb,OADAzK,EAAQ0K,aACD,EAsBX,OAlBIpF,EADA8E,EACkBpK,EAAQoK,oBAErBpK,EAAQlgB,UACKkgB,EAAQ2K,qBAErB3K,EAAQja,OACKxG,KAAKqrB,iBAElB5K,EAAQ6K,KACKtrB,KAAKurB,eAElB9K,EAAQ0C,UACKnjB,KAAKwrB,oBAGLxrB,KAAKyrB,aAE3BzrB,KAAK+qB,eAAiBJ,KACjB5E,IAAoBA,EAAgB/E,oBAGzChhB,KAAK0rB,oBAAoB3F,EAAgB/E,iBAAiBI,mBAAoBphB,KAAK2rB,gBAAgBlL,EAAQmL,OAAQ5rB,KAAK2rB,gBAAgBlL,EAAQoL,OAAQ7rB,KAAK2rB,gBAAgBlL,EAAQqL,QACrL9rB,KAAK+rB,wBAAwBtL,GAC7BzgB,KAAKgrB,gBAAgBnpB,EAASkkB,EAAgB/E,iBAAiBI,qBACxD,IAGXvZ,EAAa9I,UAAU+jB,oBAAsB,SAAUrC,EAASmC,GAC5D5iB,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOwiB,4BAC/DhsB,KAAK2J,sBAAsBR,6BAA6BsX,GACxDzgB,KAAK2J,sBAAsBrB,yBAAyBsa,GACpD5iB,KAAK2J,sBAAsBP,yBAG/BvB,EAAa9I,UAAU2sB,oBAAsB,SAAUjL,EAASwL,EAAcC,EAAcC,GACxFnsB,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO4iB,4BAC/DpsB,KAAK2J,sBAAsBR,6BAA6BsX,GACxDzgB,KAAK2J,sBAAsBrB,yBAAyB2jB,GACpDjsB,KAAK2J,sBAAsBrB,yBAAyB4jB,GACpDlsB,KAAK2J,sBAAsBrB,yBAAyB6jB,GACpDnsB,KAAK2J,sBAAsBP,yBAE/BvB,EAAa9I,UAAUisB,gBAAkB,SAAUnpB,EAAS4e,GACxDzgB,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAO6iB,oBAC/DrsB,KAAK2J,sBAAsBR,6BAA6BtH,GACxD7B,KAAK2J,sBAAsBR,6BAA6BsX,GACxDzgB,KAAK2J,sBAAsBP,yBAI/BvB,EAAa9I,UAAUgtB,wBAA0B,SAAUtL,GACvD,IAAIsF,EAAkBtF,EAAQ2K,qBAC1B/rB,EAAQohB,EAAQ6L,0BACfvG,GAAoBA,EAAgB/E,kBAGrC+E,EAAgBwG,mCAAqCltB,IACrDW,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOgjB,oCAC/DxsB,KAAK2J,sBAAsBR,6BAA6B4c,EAAgB/E,iBAAiBI,oBACzFphB,KAAK2J,sBAAsBrB,yBAAyBjJ,GACpDW,KAAK2J,sBAAsBP,wBAC3B2c,EAAgBwG,iCAAmCltB,IAI3DwI,EAAa9I,UAAU4sB,gBAAkB,SAAUc,GAC/C,OAAQA,GACJ,KAAK,EACD,OAAO/sB,QAAQ8J,OAAOkjB,kBAC1B,KAAK,EACD,OAAOhtB,QAAQ8J,OAAOmjB,mBAC1B,KAAK,EACD,OAAOjtB,QAAQ8J,OAAOojB,oBAC1B,QACI,MAAM,IAAI/rB,MAAM,yBAA2B4rB,EAAW,OAQlE5kB,EAAa9I,UAAU8tB,aAAe,SAAUlC,EAASlK,GACrD,IAAI5e,EAAU7B,KAAKoY,eAAeuS,GAClC,GAAK9oB,GAGD4e,GAAWA,EAAQO,iBAAkB,CACrC,IAAII,EAAqBX,EAAQO,iBAAiBI,mBAClDphB,KAAKgrB,gBAAgBnpB,EAASuf,KAGtCvZ,EAAa9I,UAAU+tB,cAAgB,SAAUta,GACzCA,EAAOK,oBACP7S,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOujB,2BAC/D/sB,KAAK2J,sBAAsBR,6BAA6BqJ,EAAOK,mBAC/D7S,KAAK2J,sBAAsBP,+BACpBoJ,EAAOK,mBAEdL,EAAOY,qBACPpT,KAAK2J,sBAAsBxB,qBAAqBzI,QAAQ8J,OAAOwjB,4BAC/DhtB,KAAK2J,sBAAsBR,6BAA6BqJ,EAAOY,oBAC/DpT,KAAK2J,sBAAsBP,+BACpBoJ,EAAOY,qBAStBvL,EAAa9I,UAAUkuB,aAAe,SAAUtU,EAAOE,GACnD,IAAKnZ,QAAQwtB,OACT,MAAM,IAAIrsB,MAAM,uCAEpB,IAAI+f,EAAS,IAAIlhB,QAAQwtB,OAGzB,OAFAtM,EAAOjI,MAAQA,EACfiI,EAAO/H,OAASA,EACT+H,GAMX/Y,EAAa9I,UAAU4nB,kBAAoB,WACvC,IAAKjnB,QAAQwtB,OACT,MAAM,IAAIrsB,MAAM,uCAGpB,OADY,IAAInB,QAAQytB,OAe5BtlB,EAAa9I,UAAUquB,kBAAoB,SAAU3M,EAAS8H,EAAW8E,EAASC,EAAS3U,EAAOE,EAAQmR,EAAWuD,EAAKhM,GAItH,WAHkB,IAAdyI,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,QACJ,IAApBhM,IAA8BA,GAAkB,GAC9C,IAAI1gB,MAAM,uCAYpBgH,EAAa9I,UAAUyuB,uCAAyC,SAAU/M,EAASgN,EAAgB9U,EAAOE,EAAQrJ,EAAMwa,EAAWuD,GAG/H,WAFkB,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GACtB,IAAI1sB,MAAM,4DASpBgH,EAAa9I,UAAU2uB,6BAA+B,SAAUjN,EAAS8H,EAAWyB,EAAWuD,GAG3F,WAFkB,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GACtB,IAAI1sB,MAAM,kDASpBgH,EAAa9I,UAAU4uB,gCAAkC,SAAUlN,EAAS8H,EAAWyB,EAAWuD,GAG9F,WAFkB,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GACtB,IAAI1sB,MAAM,qDASpBgH,EAAa9I,UAAU6uB,sBAAwB,SAAUnN,EAASiG,EAAOsD,EAAWuD,GAGhF,WAFkB,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GACtB,IAAI1sB,MAAM,qDAGpBgH,EAAa9I,UAAU8jB,uBAAyB,SAAUrB,GACtD,OAAQA,GACJ,KAAK,EACD,OAAO9hB,QAAQ8J,OAAOqkB,wBAC1B,KAAK,EACD,OAAOnuB,QAAQ8J,OAAOskB,sBAC1B,KAAK,EACD,OAAOpuB,QAAQ8J,OAAOukB,gCAC1B,KAAK,EACD,OAAOruB,QAAQ8J,OAAOwkB,mCAC1B,KAAK,EACD,OAAOtuB,QAAQ8J,OAAOykB,kCAC1B,KAAK,EACD,OAAOvuB,QAAQ8J,OAAO0kB,iCAC1B,KAAK,EACD,OAAOxuB,QAAQ8J,OAAO2kB,uBAC1B,KAAK,EACD,OAAOzuB,QAAQ8J,OAAO4kB,kCAC1B,KAAK,EACD,OAAO1uB,QAAQ8J,OAAO6kB,kCAC1B,KAAK,GACD,OAAO3uB,QAAQ8J,OAAO8kB,iCAC1B,KAAK,GACD,OAAO5uB,QAAQ8J,OAAO+kB,iCAC1B,KAAK,GACD,OAAO7uB,QAAQ8J,OAAOglB,uBAC1B,QACI,MAAM,IAAI3tB,MAAM,8BAA8B8J,OAAO6W,EAAc,QAG/E3Z,EAAa9I,UAAUmd,gBAAkB,SAAUK,GAC/C,OAAQA,GACJ,KAAK,IACD,OAAO7c,QAAQ8J,OAAOilB,kBAC1B,KAAK,IACD,OAAO/uB,QAAQ8J,OAAOklB,oBAC1B,KAAK,IACD,OAAOhvB,QAAQ8J,OAAOmlB,mBAC1B,KAAK,IACD,OAAOjvB,QAAQ8J,OAAOolB,oBAC1B,KAAK,IACD,OAAOlvB,QAAQ8J,OAAOqlB,qBAC1B,KAAK,IACD,OAAOnvB,QAAQ8J,OAAOslB,sBAC1B,KAAK,IACD,OAAOpvB,QAAQ8J,OAAOulB,mBAC1B,KAAK,IACD,OAAOrvB,QAAQ8J,OAAOsT,oBAC1B,QACI,MAAM,IAAIjc,MAAM,kCAAkC8J,OAAO4R,EAAM,QAG3E1U,EAAa9I,UAAUgd,kBAAoB,SAAUiT,GACjD,OAAQA,GACJ,KAAK,KACD,OAAOtvB,QAAQ8J,OAAOmT,uBAC1B,KAAK,EACD,OAAOjd,QAAQ8J,OAAOylB,uBAC1B,KAAK,KACD,OAAOvvB,QAAQ8J,OAAO0lB,0BAC1B,KAAK,KACD,OAAOxvB,QAAQ8J,OAAO2lB,uBAC1B,KAAK,KACD,OAAOzvB,QAAQ8J,OAAO4lB,uBAC1B,KAAK,KACD,OAAO1vB,QAAQ8J,OAAO6lB,yBAC1B,KAAK,MACD,OAAO3vB,QAAQ8J,OAAO8lB,0BAC1B,KAAK,MACD,OAAO5vB,QAAQ8J,OAAO+lB,0BAC1B,QACI,MAAM,IAAI1uB,MAAM,oCAAoC8J,OAAOqkB,EAAQ,QAG/EnnB,EAAa9I,UAAUid,qBAAuB,SAAUwT,GACpD,OAAQA,GACJ,KAAK,KACD,OAAO9vB,QAAQ8J,OAAOoT,uBAC1B,KAAK,EACD,OAAOld,QAAQ8J,OAAOimB,uBAC1B,KAAK,KACD,OAAO/vB,QAAQ8J,OAAOkmB,0BAC1B,KAAK,KACD,OAAOhwB,QAAQ8J,OAAOmmB,uBAC1B,KAAK,KACD,OAAOjwB,QAAQ8J,OAAOomB,uBAC1B,KAAK,KACD,OAAOlwB,QAAQ8J,OAAOqmB,yBAC1B,KAAK,MACD,OAAOnwB,QAAQ8J,OAAOsmB,0BAC1B,KAAK,MACD,OAAOpwB,QAAQ8J,OAAOumB,0BAC1B,QACI,MAAM,IAAIlvB,MAAM,uCAAuC8J,OAAO6kB,EAAW,QAGrF3nB,EAAa9I,UAAUkd,qBAAuB,SAAU+T,GACpD,OAAQA,GACJ,KAAK,KACD,OAAOtwB,QAAQ8J,OAAOqT,uBAC1B,KAAK,EACD,OAAOnd,QAAQ8J,OAAOymB,uBAC1B,KAAK,KACD,OAAOvwB,QAAQ8J,OAAO0mB,0BAC1B,KAAK,KACD,OAAOxwB,QAAQ8J,OAAO2mB,uBAC1B,KAAK,KACD,OAAOzwB,QAAQ8J,OAAO4mB,uBAC1B,KAAK,KACD,OAAO1wB,QAAQ8J,OAAO6mB,yBAC1B,KAAK,MACD,OAAO3wB,QAAQ8J,OAAO8mB,0BAC1B,KAAK,MACD,OAAO5wB,QAAQ8J,OAAO+mB,0BAC1B,QACI,MAAM,IAAI1vB,MAAM,oCAAoC8J,OAAOqlB,EAAQ,QAG/EnoB,EAAa9I,UAAUskB,wBAA0B,SAAUtC,EAAQ5M,GAC/D,GAAc,GAAV4M,GAAuB,GAAR5M,EACf,OAAOzU,QAAQ8J,OAAOgnB,oBAErB,GAAc,GAAVzP,GAAuB,GAAR5M,EACpB,OAAOzU,QAAQ8J,OAAO6c,qBAErB,GAAc,GAAVtF,GAAuB,GAAR5M,EACpB,OAAOzU,QAAQ8J,OAAOinB,uBAGtB,MAAM,IAAI,KAAa,8CAA8C9lB,OAAOoW,EAAQ,WAAWpW,OAAOwJ,EAAM,KAAM,+BAG1HtM,EAAa9I,UAAUwf,oBAAsB,SAAUJ,GACnD,OAAQA,GACJ,KAAK,EACD,OAAOze,QAAQ8J,OAAOknB,cAC1B,KAAK,EACD,OAAOhxB,QAAQ8J,OAAOmnB,UAC1B,KAAK,EACD,OAAOjxB,QAAQ8J,OAAOonB,cAC1B,KAAK,EACD,OAAOlxB,QAAQ8J,OAAOqnB,eAC1B,KAAK,EACD,OAAOnxB,QAAQ8J,OAAOsnB,eAC1B,KAAK,EACD,OAAOpxB,QAAQ8J,OAAOunB,gBAC1B,KAAK,EACD,OAAOrxB,QAAQ8J,OAAOwnB,aAC1B,KAAK,EACD,OAAOtxB,QAAQ8J,OAAOynB,oBAC1B,KAAK,EACD,OAAOvxB,QAAQ8J,OAAO0nB,+BAC1B,KAAK,EACD,OAAOxxB,QAAQ8J,OAAO2nB,kBAC1B,KAAK,GACD,OAAOzxB,QAAQ8J,OAAO4nB,iBAC1B,QACI,MAAM,IAAIvwB,MAAM,2BAA2B8J,OAAOwT,EAAM,QAGpEtW,EAAa9I,UAAUmV,qBAAuB,SAAUC,GACpD,OAAQA,GACJ,KAAK,SACD,OAAOzU,QAAQ8J,OAAO6nB,iBAC1B,KAAK,kBACD,OAAO3xB,QAAQ8J,OAAO8nB,kBAC1B,KAAK,UACD,OAAO5xB,QAAQ8J,OAAO+nB,kBAC1B,KAAK,mBACD,OAAO7xB,QAAQ8J,OAAOgoB,mBAC1B,KAAK,UACD,OAAO9xB,QAAQ8J,OAAOioB,kBAC1B,QACI,MAAM,IAAI5wB,MAAM,+BAA+B8J,OAAOwJ,EAAM,QAGxEtM,EAAa9I,UAAU2yB,cAAgB,SAAUC,GAG7C,MADa,CAAEC,OAAQ,EAAG/Y,OAAQ,EAAGgZ,QAAS,IAIlDhqB,EAAa6C,iBAAmB,EACzB7C,EAt+DsB,CAu+D/B,M,oIC9oFEiqB,EACA,WAII9xB,KAAK+xB,YAAc,IAInB/xB,KAAKgyB,aAAe,IAIpBhyB,KAAKiyB,YAAc,IAKnBjyB,KAAKkyB,uBAAwB,EAK7BlyB,KAAKmyB,iBAAmB,GAS5BC,EAA4B,SAAU9rB,GAEtC,SAAS8rB,EAAW9oB,QACA,IAAZA,IAAsBA,EAAU,IAAIwoB,GACxC,IAAIprB,EAAQJ,EAAOrH,KAAKe,KAAM,OAASA,KACvC,mBAAsB0G,QACgB7D,IAAlCyG,EAAQ4oB,wBACR5oB,EAAQ4oB,uBAAwB,QAEHrvB,IAA7ByG,EAAQ6oB,mBACR7oB,EAAQ6oB,iBAAmB,GAE/BzrB,EAAM2rB,SAAW/oB,EACjB,yBAA6CA,EAAQgpB,wBAGrD5rB,EAAMoE,MAAQ,CACVC,sBAAuB,GACvBC,2BAA4B,GAC5BC,8BAA+B,GAC/BC,eAAgB,IAChBE,sBAAuB,IACvBC,qBAAsB,IACtBC,iBAAkB,GAClBC,kBAAmB,GACnBC,0BAA2B,GAC3BC,wBAAyB,GACzBC,qBAAqB,EACrBC,KAAM,KACNC,MAAO,KACPC,KAAM,KACNC,KAAM,KACNC,KAAM,KACNC,cAAe,EACfC,aAAa,EACbC,wBAAwB,EACxBC,8BAA8B,EAC9BC,kBAAkB,EAClBC,cAAc,EACdC,6BAA6B,EAC7BC,oBAAoB,EACpBC,kBAAkB,EAClBC,iCAAiC,EACjCC,wBAAwB,EACxBC,YAAY,EACZC,sBAAsB,EACtBC,uBAAuB,EACvBC,mBAAmB,EACnBC,iBAAiB,EACjBC,uBAAuB,EACvBC,8BAA8B,EAC9BE,eAAgB,EAChBD,aAAa,EACbE,oBAAoB,EACpBC,kBAAkB,EAClBC,uBAAuB,EACvBC,oBAAoB,EACpBC,2BAA2B,EAC3BC,iBAAiB,EACjBC,4BAA6B,KAEjChH,EAAMkH,UAAY,CACdC,iCAAiC,EACjCC,2CAA2C,EAC3CC,4BAA4B,EAC5BC,uBAAuB,EACvBC,8BAA8B,EAC9BC,0BAA0B,EAC1BC,kBAAkB,EAClBC,8BAA8B,EAC9BC,YAAY,EACZC,eAAe,EACfC,mBAAmB,EACnBC,iCAAiC,EACjCC,aAAa,EACbC,cAAc,EACdC,+BAA+B,EAC/BC,2BAA2B,EAC3BC,wBAAwB,EACxBC,sBAAsB,EACtBC,oBAAoB,EACpBC,wBAAwB,EACxBC,gCAAgC,EAChCC,qBAAqB,EACrBC,4BAA4B,GAEhC,IAAAojB,IAAW,eAAe5nB,OAAO,YAAgB,mBAEjD,IAAI6nB,EAAmC,oBAAT3zB,KAAuBA,KAAyB,oBAAX4zB,OAAyBA,OAAS5iB,OAUrG,MATmB,oBAARD,MACP4iB,EAAiB5iB,IAAM,CACnBE,gBAAiB,aACjBC,gBAAiB,eAGL,oBAATC,OACPwiB,EAAiBxiB,KAAO,cAErBtJ,EA4vBX,OA71BA,QAAU0rB,EAAY9rB,GAwGtB8rB,EAAWrzB,UAAU2zB,wBAA0B,WAC3C,OAAO1yB,KAAKqyB,SAASH,uBAOzBE,EAAWrzB,UAAU4zB,oBAAsB,WACvC,OAAO3yB,KAAKqyB,SAASF,kBAQzBC,EAAWrzB,UAAUiS,wBAA0B,WAC3C,OAAO,GAOXohB,EAAWrzB,UAAUgU,mBAAqB,SAAUC,GAChD,IAAIR,EAAS,IAAI,IAEjB,OADAA,EAAOC,WAAa,EACbD,GAOX4f,EAAWrzB,UAAUqT,kBAAoB,SAAUC,GAC/C,IAAIG,EAAS,IAAI,IAEjB,OADAA,EAAOC,WAAa,EACbD,GASX4f,EAAWrzB,UAAU8S,MAAQ,SAAUC,EAAOC,EAAYC,EAAOC,QAC7C,IAAZA,IAAsBA,GAAU,IAOxCmgB,EAAWrzB,UAAUyZ,eAAiB,SAAUC,GAE5C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBC,MAE9B3Y,KAAKqyB,SAASN,aAOzBK,EAAWrzB,UAAU6Z,gBAAkB,SAAUH,GAE7C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBG,OAE9B7Y,KAAKqyB,SAASL,cAQzBI,EAAWrzB,UAAU+Z,YAAc,SAAUC,EAAUC,EAAeC,GAClEjZ,KAAKkZ,gBAAkBH,GAE3BqZ,EAAWrzB,UAAU0X,oBAAsB,SAAU5B,EAAiBgC,EAAYC,EAAcR,EAASS,GACrG,MAAO,CAEH6b,yBAA0B,OASlCR,EAAWrzB,UAAU4C,YAAc,SAAUkT,EAAiB5T,GAC1D,MAAO,IAQXmxB,EAAWrzB,UAAUsD,cAAgB,SAAUwS,EAAiBxT,GAC5D,MAAO,IAMX+wB,EAAWrzB,UAAUkZ,aAAe,SAAUlX,GAC1Cf,KAAKqY,eAAiB,MAM1B+Z,EAAWrzB,UAAU8zB,aAAe,SAAU9xB,GAC1CA,EAAoB,OAAXA,GAAmB,cAAsBA,GAAUA,EAAOA,OAASA,EAC5Ef,KAAKqY,eAAiBtX,EACjBA,IAGDA,EAAO+xB,QACP/xB,EAAO+xB,OAAO/xB,GAEdA,EAAOgyB,mBACPhyB,EAAOgyB,kBAAkBzzB,gBAAgByB,KAajDqxB,EAAWrzB,UAAUqa,SAAW,SAAUC,EAASC,EAASC,EAAOC,EAAaC,EAAexH,EAASyH,QACpF,IAAZJ,IAAsBA,EAAU,QAChB,IAAhBE,IAA0BA,GAAc,QACvB,IAAjBE,IAA2BA,EAAe,IAQlD0Y,EAAWrzB,UAAU2E,YAAc,SAAU7B,EAAS8B,GAClD,OAAO,GAQXyuB,EAAWrzB,UAAU6E,aAAe,SAAU/B,EAAS8B,GACnD,OAAO,GAQXyuB,EAAWrzB,UAAU8E,aAAe,SAAUhC,EAAS8B,GACnD,OAAO,GAQXyuB,EAAWrzB,UAAU+E,aAAe,SAAUjC,EAAS8B,GACnD,OAAO,GAQXyuB,EAAWrzB,UAAUgF,cAAgB,SAAUlC,EAAS8B,GACpD,OAAO,GAQXyuB,EAAWrzB,UAAUiF,eAAiB,SAAUnC,EAAS8B,GACrD,OAAO,GAQXyuB,EAAWrzB,UAAUkF,eAAiB,SAAUpC,EAAS8B,GACrD,OAAO,GAQXyuB,EAAWrzB,UAAUmF,eAAiB,SAAUrC,EAAS8B,GACrD,OAAO,GAQXyuB,EAAWrzB,UAAUoF,SAAW,SAAUtC,EAAS8B,GAC/C,OAAO,GAQXyuB,EAAWrzB,UAAUqF,UAAY,SAAUvC,EAAS8B,GAChD,OAAO,GAQXyuB,EAAWrzB,UAAUsF,UAAY,SAAUxC,EAAS8B,GAChD,OAAO,GAQXyuB,EAAWrzB,UAAUuF,UAAY,SAAUzC,EAAS8B,GAChD,OAAO,GAQXyuB,EAAWrzB,UAAUwF,YAAc,SAAU1C,EAAS2C,GAClD,OAAO,GAQX4tB,EAAWrzB,UAAU4F,aAAe,SAAU9C,EAASY,GACnD,OAAO,GAQX2vB,EAAWrzB,UAAU6F,aAAe,SAAU/C,EAASY,GACnD,OAAO,GAQX2vB,EAAWrzB,UAAU8F,SAAW,SAAUhD,EAASxC,GAC/C,OAAO,GASX+yB,EAAWrzB,UAAUmG,UAAY,SAAUrD,EAASkB,EAAGC,GACnD,OAAO,GAUXovB,EAAWrzB,UAAUsG,UAAY,SAAUxD,EAASkB,EAAGC,EAAGG,GACtD,OAAO,GAQXivB,EAAWrzB,UAAU+F,QAAU,SAAUjD,EAASkD,GAC9C,OAAO,GAWXqtB,EAAWrzB,UAAUyG,UAAY,SAAU3D,EAASkB,EAAGC,EAAGG,EAAGE,GACzD,OAAO,GAQX+uB,EAAWrzB,UAAUmf,aAAe,SAAUC,EAAMC,QACrB,IAAvBA,IAAiCA,GAAqB,GACtDpe,KAAKqe,aAAeF,IAGxBne,KAAKgzB,WAAWC,WAAsB,IAAT9U,EACxBC,GACDpe,KAAKsb,cAAuB,IAAT6C,GAEvBne,KAAKqe,WAAaF,IAQtBiU,EAAWrzB,UAAUuV,YAAc,SAAUf,EAAeC,EAAazS,KAMzEqxB,EAAWrzB,UAAU4gB,WAAa,SAAUC,GACpC5f,KAAK6f,gCAGT7f,KAAK8f,oBACL9f,KAAKqY,eAAiB,KAClBuH,IACA5f,KAAK4X,gBAAkB,KACvB5X,KAAK+f,sBAAsBC,QAC3BhgB,KAAKkzB,kBAAkBlT,QACvBhgB,KAAKgzB,WAAWhT,SAEpBhgB,KAAKmgB,qBAAuB,KAC5BngB,KAAKogB,mBAAqB,KAC1BpgB,KAAKqgB,8BAAgC,OASzC+R,EAAWrzB,UAAUo0B,KAAO,SAAUC,EAAcle,EAAYC,EAAYC,KAQ5Egd,EAAWrzB,UAAUiW,iBAAmB,SAAUC,EAAUC,EAAYC,EAAYC,KAQpFgd,EAAWrzB,UAAUyW,eAAiB,SAAUP,EAAUQ,EAAeC,EAAeN,KAExFgd,EAAWrzB,UAAUuhB,eAAiB,WAClC,MAAO,IAMX8R,EAAWrzB,UAAUs0B,gBAAkB,SAAU5S,KAqBjD2R,EAAWrzB,UAAUwhB,cAAgB,SAAU+S,EAAQ7P,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,EAASkD,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,QAClI,IAAjBrC,IAA2BA,EAAe,QAC/B,IAAXkC,IAAqBA,EAAS,WAClB,IAAZpU,IAAsBA,EAAU,WACrB,IAAXkD,IAAqBA,EAAS,WACjB,IAAbmR,IAAuBA,EAAW,WACvB,IAAX5C,IAAqBA,EAAS,WACV,IAApB6C,IAA8BA,EAAkB,MACpD,IAAInD,EAAU,IAAI,IAAgBzgB,KAAM,SACpCwjB,EAAM+P,OAAOD,GAmBjB,OAlBA7S,EAAQ+C,IAAMA,EACd/C,EAAQc,iBAAmBkC,EAC3BhD,EAAQe,aAAeA,EACvBf,EAAQI,QAAUA,EAClBJ,EAAQ6B,UAAYtiB,KAAKqyB,SAASJ,YAClCxR,EAAQ8B,WAAaviB,KAAKqyB,SAASJ,YACnCxR,EAAQ9H,MAAQ3Y,KAAKqyB,SAASJ,YAC9BxR,EAAQ5H,OAAS7Y,KAAKqyB,SAASJ,YAC3BlR,IACAN,EAAQM,OAASA,GAErBN,EAAQlgB,SAAU,EACdmjB,GACA8P,YAAW,WACP9P,OAGR1jB,KAAK+iB,uBAAuB5gB,KAAKse,GAC1BA,GAQX2R,EAAWrzB,UAAUsqB,mCAAqC,SAAU9iB,EAASC,EAAQC,GACjF,IAAIyf,EAAY,IAAI,IAAoB3f,EAASC,EAAQC,EAAMzG,MAE/D,OADAA,KAAKspB,0BAA0BnnB,KAAK+jB,GAC7BA,GAQXkM,EAAWrzB,UAAUwqB,0BAA4B,SAAU9iB,EAAM6C,GAC7D,IAAI4c,EAAYlmB,KAAKqpB,oCAAmC,GAAO,EAAO5iB,GAClE+iB,EAAc,QACF3mB,IAAZyG,GAA4C,iBAAZA,GAChCkgB,EAAYjI,gBAAkBjY,EAAQiY,gBACtCiI,EAAYC,yBAAsD5mB,IAAhCyG,EAAQmgB,qBAA2CngB,EAAQmgB,oBAC7FD,EAAYE,sBAAwBF,EAAYC,qBAAuBngB,EAAQogB,sBAC/EF,EAAYrV,UAAwBtR,IAAjByG,EAAQ6K,KAAqB,EAAI7K,EAAQ6K,KAC5DqV,EAAYhI,kBAAwC3e,IAAzByG,EAAQkY,aAA6B,EAAIlY,EAAQkY,eAG5EgI,EAAYjI,gBAAkBjY,EAC9BkgB,EAAYC,qBAAsB,EAClCD,EAAYE,uBAAwB,EACpCF,EAAYrV,KAAO,EACnBqV,EAAYhI,aAAe,GAE/B,IAAIf,EAAU,IAAI,IAAgBzgB,KAAM,kBACpC2Y,EAAQlS,EAAKkS,OAASlS,EACtBoS,EAASpS,EAAKoS,QAAUpS,EAa5B,OAZAyf,EAAUyD,qBAAuBH,EAAYC,oBAC7CvD,EAAU0D,yBAAyBJ,EAAYE,sBAC/CjJ,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQ9H,MAAQA,EAChB8H,EAAQ5H,OAASA,EACjB4H,EAAQlgB,SAAU,EAClBkgB,EAAQoJ,QAAU,EAClBpJ,EAAQc,kBAAkBiI,EAAYjI,gBACtCd,EAAQe,aAAegI,EAAYhI,aACnCf,EAAQtM,KAAOqV,EAAYrV,KAC3BnU,KAAK+iB,uBAAuB5gB,KAAKse,GAC1ByF,GAOXkM,EAAWrzB,UAAU0pB,0BAA4B,SAAUjH,EAAcf,GACrEA,EAAQe,aAAeA,GAiB3B4Q,EAAWrzB,UAAU4iB,iBAAmB,SAAUnS,EAAMmJ,EAAOE,EAAQkI,EAAQQ,EAAiBV,EAASW,EAAcW,EAAahO,EAAMiO,EAAeC,QACjI,IAAhBF,IAA0BA,EAAc,WAC/B,IAAThO,IAAmBA,EAAO,QACR,IAAlBiO,IAA4BA,EAAgB,QAC1B,IAAlBC,IAA4BA,GAAgB,GAChD,IAAI5B,EAAU,IAAI,IAAgBzgB,KAAM,SAexC,OAdAygB,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQ9H,MAAQA,EAChB8H,EAAQ5H,OAASA,EACjB4H,EAAQM,OAASA,EACjBN,EAAQc,gBAAkBA,EAC1Bd,EAAQe,aAAeA,EACvBf,EAAQI,QAAUA,EAClBJ,EAAQ+B,aAAeL,EACvB1B,EAAQtM,KAAOA,EACfsM,EAAQgC,eAAiBJ,EACpBriB,KAAKgoB,0BACNvH,EAAQgT,YAAcjkB,GAEnBiR,GAYX2R,EAAWrzB,UAAU4jB,iBAAmB,SAAUlC,EAASjR,EAAMuR,EAAQF,EAASsB,EAAahO,EAAMkO,QAC7E,IAAhBF,IAA0BA,EAAc,WAC/B,IAAThO,IAAmBA,EAAO,QACR,IAAlBkO,IAA4BA,GAAgB,GAC5C5B,IACAA,EAAQgT,YAAcjkB,EACtBiR,EAAQM,OAASA,EACjBN,EAAQI,QAAUA,EAClBJ,EAAQ+B,aAAeL,EACvB1B,EAAQtM,KAAOA,EACfsM,EAAQgC,eAAiBJ,IAWjC+P,EAAWrzB,UAAUgrB,gBAAkB,SAAU7D,EAAW8D,EAAWhR,EAAeC,EAAgBgR,GAC9FjqB,KAAK0Y,sBACL1Y,KAAKkqB,kBAAkBlqB,KAAK0Y,sBAEhC1Y,KAAK0Y,qBAAuBwN,EAC5BlmB,KAAKyR,oBAAsB,KACvBzR,KAAKkZ,kBAAoB+Q,GACzBjqB,KAAK8Y,YAAY9Y,KAAKkZ,gBAAiBF,EAAeC,IAS9DmZ,EAAWrzB,UAAUmrB,kBAAoB,SAAUhE,EAAWiE,EAAwBC,QACnD,IAA3BD,IAAqCA,GAAyB,GAClEnqB,KAAK0Y,qBAAuB,KACxB0R,GACAA,IAEJpqB,KAAKyR,oBAAsB,MAO/B2gB,EAAWrzB,UAAUsrB,0BAA4B,SAAUrX,GACvD,IAAIR,EAAS,IAAI,IAGjB,OAFAA,EAAOC,WAAa,EACpBD,EAAOkhB,SAAW,EACXlhB,GAUX4f,EAAWrzB,UAAU4hB,qBAAuB,SAAUF,EAASG,EAAQC,EAASC,EAAaC,QACrE,IAAhBD,IAA0BA,GAAc,IAMhDsR,EAAWrzB,UAAU40B,mBAAqB,WACtC,OAAO,GAQXvB,EAAWrzB,UAAU60B,SAAW,WAC5B,OAAO,GAGXxB,EAAWrzB,UAAU80B,qBAAuB,WACxC,OAAO,GAMXzB,EAAWrzB,UAAU+0B,aAAe,SAAUz0B,KAO9C+yB,EAAWrzB,UAAUurB,yBAA2B,SAAU9W,EAAanB,EAASkY,QAC7D,IAAXA,IAAqBA,EAAS,IAStC6H,EAAWrzB,UAAUyrB,0BAA4B,SAAU3W,EAAcb,EAAUF,EAAYF,KAM/Fwf,EAAWrzB,UAAUg1B,qBAAuB,SAAUC,EAAQvT,GAC1D,OAAIzgB,KAAK8qB,oBAAoB9qB,KAAK+qB,kBAAoBtK,IAClDzgB,KAAK8qB,oBAAoB9qB,KAAK+qB,gBAAkBtK,GACzC,IASf2R,EAAWrzB,UAAU8tB,aAAe,SAAUlC,EAASlK,GAC/CkK,EAAU,GAGd3qB,KAAK+zB,qBAAqB,EAAGtT,IAEjC2R,EAAWrzB,UAAU+tB,cAAgB,SAAUta,KAI/C4f,EAAWrzB,UAAUk1B,eAAiB,aACtC7B,EAAWrzB,UAAUm1B,iBAAmB,aACxC9B,EAAWrzB,UAAUo1B,cAAgB,aACrCr1B,OAAOI,eAAekzB,EAAWrzB,UAAW,gBAAiB,CACzDK,IAAK,SAAUg1B,KACfptB,YAAY,EACZC,cAAc,IAYlBmrB,EAAWrzB,UAAUyuB,uCAAyC,SAAU/M,EAASgN,EAAgB9U,EAAOE,EAAQrJ,EAAMwa,EAAWuD,QAC3G,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,IAShC6E,EAAWrzB,UAAU2uB,6BAA+B,SAAUjN,EAAS8H,EAAWyB,EAAWuD,QACvE,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,IAShC6E,EAAWrzB,UAAU4uB,gCAAkC,SAAUlN,EAAS8H,EAAWyB,EAAWuD,QAC1E,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,IAShC6E,EAAWrzB,UAAU6uB,sBAAwB,SAAUnN,EAASiG,EAAOsD,EAAWuD,QAC5D,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,IAEzB6E,EA91BoB,CA+1B7B,M,iCC34BF,IAAIiC,EAAyC,WACzC,SAASA,KAgCT,OA1BAA,EAAwBC,mBAAqB,SAAUC,GAEnD,GADAF,EAAwBG,4BAA6B,EACjDD,IAAcF,EAAwBI,iBAClCJ,EAAwBK,sBACxB,IAAK,IAAIC,EAAI,EAAGA,EAAIN,EAAwBK,sBAAsB3yB,SAAU4yB,EAAG,CAC3E,IAAIlyB,EAAS4xB,EAAwBK,sBAAsBC,GACvDC,EAASnyB,EAAOoyB,GACpBpyB,EAAOoyB,GAAK,IAAIntB,MAAM,IACtB,IAAK,IAAIotB,EAAI,EAAGA,EAAI,KAAMA,EACtBryB,EAAOoyB,GAAGC,GAAKF,EAAOE,GAKtCT,EAAwBI,gBAAkBF,EAC1CF,EAAwBU,kBAAoBV,EAAwBI,gBAAkB/sB,MAAQyL,aAC9FkhB,EAAwBK,sBAAwB,MAGpDL,EAAwBI,iBAAkB,EAE1CJ,EAAwBG,4BAA6B,EAErDH,EAAwBU,kBAAoB5hB,aAE5CkhB,EAAwBK,sBAAwB,GACzCL,EAjCiC,I,+CCIxCW,EAAqC,WAQrC,SAASA,EAAoBzuB,EAASC,EAAQC,EAAMpG,GAChDL,KAAKi1B,UAAY,KAEjBj1B,KAAKk1B,aAAe,KAEpBl1B,KAAK4pB,wBAAyB,EAE9B5pB,KAAK2pB,sBAAuB,EAE5B3pB,KAAKm1B,iCAAkC,EACvCn1B,KAAKo1B,SAAW7uB,EAChBvG,KAAKq1B,QAAU7uB,EACfxG,KAAKs1B,MAAQ7uB,EACbzG,KAAK6G,QAAUxG,EACfL,KAAKu1B,qBAAuB,KAwVhC,OAtVAz2B,OAAOI,eAAe81B,EAAoBj2B,UAAW,sBAAuB,CAIxEI,IAAK,WACD,OAAOa,KAAKu1B,sBAEhBvuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,iCAAkC,CAInFI,IAAK,WACD,OAAOa,KAAKm1B,iCAEhBnuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,SAAU,CAI3DI,IAAK,WACD,OAAOa,KAAKq1B,SAEhBruB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,UAAW,CAI5DI,IAAK,WACD,OAAOa,KAAKo1B,UAEhBpuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,YAAa,CAI9DI,IAAK,WACD,OAAOa,KAAKw1B,OAAS,GAEzBxuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,OAAQ,CAIzDI,IAAK,WACD,OAAOa,KAAK2Y,OAEhB3R,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,QAAS,CAI1DI,IAAK,WACD,OAAOa,KAAKs1B,MAAM3c,OAAS3Y,KAAKs1B,OAEpCtuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,SAAU,CAI3DI,IAAK,WACD,OAAOa,KAAKs1B,MAAMzc,QAAU7Y,KAAKs1B,OAErCtuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,SAAU,CAI3DI,IAAK,WACD,OAAOa,KAAKs1B,MAAME,QAAU,GAEhCxuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,UAAW,CAI5DI,IAAK,WACD,IAAIc,EAAI0Z,EACR,OAAmF,QAA3EA,EAA+B,QAAzB1Z,EAAKD,KAAKi1B,iBAA8B,IAAPh1B,OAAgB,EAASA,EAAG,UAAuB,IAAP0Z,EAAgBA,EAAK,MAEpH3S,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,WAAY,CAI7DI,IAAK,WACD,OAAOa,KAAKi1B,WAEhBjuB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAe81B,EAAoBj2B,UAAW,UAAW,CAI5DI,IAAK,WACD,IAAIc,EAAI0Z,EACR,OAAsF,QAA9EA,EAA6B,QAAvB1Z,EAAKD,KAAKygB,eAA4B,IAAPxgB,OAAgB,EAASA,EAAG4pB,eAA4B,IAAPlQ,EAAgBA,EAAK,GAEvH3S,YAAY,EACZC,cAAc,IASlB+tB,EAAoBj2B,UAAU02B,WAAa,SAAUp2B,EAAOq2B,EAAmBnc,GAG3E,YAF0B,IAAtBmc,IAAgCA,GAAoB,QAC1C,IAAVnc,IAAoBA,GAAQ,GAC5BvZ,KAAK6pB,UAAYxqB,GAAUka,EAGxBvZ,KAAKo1B,SACNp1B,KAAK6G,QAAQ8uB,6CAA6C31B,KAAMX,EAAOq2B,GACvE11B,KAAK6G,QAAQ+uB,qCAAqC51B,KAAMX,GAJnDA,GAUf21B,EAAoBj2B,UAAU+qB,YAAc,SAAU+L,GAC9CnuB,MAAMwf,QAAQ2O,GACd71B,KAAKi1B,UAAYY,EAGjB71B,KAAKi1B,UADAY,EACY,CAACA,GAGD,MASzBb,EAAoBj2B,UAAU+2B,WAAa,SAAUrV,EAASlf,EAAOw0B,QACnD,IAAVx0B,IAAoBA,EAAQ,QACR,IAApBw0B,IAA8BA,GAAkB,GAC/C/1B,KAAKi1B,YACNj1B,KAAKi1B,UAAY,IAEjBj1B,KAAKi1B,UAAU1zB,IAAUw0B,GACzB/1B,KAAKi1B,UAAU1zB,GAAOe,UAE1BtC,KAAKi1B,UAAU1zB,GAASkf,GAW5BuU,EAAoBj2B,UAAUi3B,0BAA4B,SAAUC,EAAoBC,EAAmBC,EAAiBtM,EAAS9I,GACjI,IAAI9gB,EAgBJ,YAf2B,IAAvBg2B,IAAiCA,EAAqB,QAChC,IAAtBC,IAAgCA,GAAoB,QAChC,IAApBC,IAA8BA,GAAkB,QACpC,IAAZtM,IAAsBA,EAAU,QACrB,IAAX9I,IAAqBA,EAAS,IACG,QAApC9gB,EAAKD,KAAKu1B,4BAAyC,IAAPt1B,GAAyBA,EAAGqC,UACzEtC,KAAKm1B,gCAAkCgB,EACvCn2B,KAAKu1B,qBAAuBv1B,KAAK6G,QAAQmvB,0BAA0Bh2B,KAAKs1B,MAAO,CAC3EY,kBAAmBA,EACnBD,mBAAoBA,EACpBE,gBAAiBA,EACjB3vB,OAAQxG,KAAKq1B,QACbxL,QAASA,EACTuM,mBAAoBrV,GACrB/gB,MACIA,KAAKu1B,sBAOhBP,EAAoBj2B,UAAUs3B,YAAc,SAAUC,GAC9Ct2B,KAAKu1B,uBACDe,EAAaf,sBACbe,EAAaf,qBAAqBjzB,UAEtCg0B,EAAaf,qBAAuBv1B,KAAKu1B,qBACzCv1B,KAAKu1B,qBAAqBgB,wBAOlCvB,EAAoBj2B,UAAUy3B,YAAc,SAAUxC,GAC9Ch0B,KAAKygB,SACLzgB,KAAKygB,QAAQ+V,YAAYxC,GAE7Bh0B,KAAKi1B,UAAY,KACjBj1B,KAAKsC,SAAQ,IAEjB0yB,EAAoBj2B,UAAU03B,0BAA4B,WACtD,IAAIx2B,EAAI0Z,EAAI+c,EAAIC,EAAIC,EAAIC,EACpBC,EAAM,KACV,GAAI92B,KAAKo1B,SAAU,CACf,IAAI2B,EAAe/2B,KAAK61B,SACxB,GAAIkB,GAAgBA,EAAah1B,OAAS,EAAG,CACzC,IAAIi1B,GAAuB,EACvBC,EAAeF,EAAah1B,OAC5Bm1B,EAAoBH,EAAaA,EAAah1B,OAAS,GAAGo1B,QAC1DD,IAAsB,WAA+BA,IAAsB,mBAC3EF,GAAuB,EACvBC,KAIJ,IAFA,IAAIG,EAAgB,GAChBC,EAAQ,GACHvC,EAAI,EAAGA,EAAImC,IAAgBnC,EAAG,CACnC,IAAIrU,EAAUsW,EAAajC,GAC3BsC,EAAcj1B,KAAKse,EAAQe,cAC3B6V,EAAMl1B,KAAKse,EAAQtM,MAEvB,IAAImjB,EAAa,CACbF,cAAeA,EACf7V,gBAAiBwV,EAAa,GAAGxV,gBACjCkI,oBAAqBzpB,KAAK2pB,qBAC1BD,sBAAuB1pB,KAAK4pB,uBAC5BoN,qBAAsBA,EACtBK,MAAOA,EACPJ,aAAcA,GAEdxwB,EAAO,CACPkS,MAAO3Y,KAAK2Y,MACZE,OAAQ7Y,KAAK6Y,QAEjBie,EAAM92B,KAAK6G,QAAQ0wB,2BAA2B9wB,EAAM6wB,QAGvD,CACD,IAAIhuB,EAAU,GAOd,GANAA,EAAQmgB,oBAAsBzpB,KAAK2pB,qBACnCrgB,EAAQiY,gBAAyG,QAAtF5H,EAA6B,QAAvB1Z,EAAKD,KAAKygB,eAA4B,IAAPxgB,OAAgB,EAASA,EAAGshB,uBAAoC,IAAP5H,GAAgBA,EACzIrQ,EAAQogB,sBAAwB1pB,KAAK4pB,uBACrCtgB,EAAQkY,aAAuC,QAAvBkV,EAAK12B,KAAKygB,eAA4B,IAAPiW,OAAgB,EAASA,EAAGlV,aACnFlY,EAAQ6K,KAA+B,QAAvBwiB,EAAK32B,KAAKygB,eAA4B,IAAPkW,OAAgB,EAASA,EAAGxiB,KAC3E7K,EAAQyX,OAAiC,QAAvB6V,EAAK52B,KAAKygB,eAA4B,IAAPmW,OAAgB,EAASA,EAAG7V,OACzE/gB,KAAKwG,OACLswB,EAAM92B,KAAK6G,QAAQ2wB,8BAA8Bx3B,KAAK2Y,MAAOrP,OAE5D,CACG7C,EAAO,CACPkS,MAAO3Y,KAAK2Y,MACZE,OAAQ7Y,KAAK6Y,OACb2c,OAAQx1B,KAAKmjB,UAAoC,QAAvB0T,EAAK72B,KAAKygB,eAA4B,IAAPoW,OAAgB,EAASA,EAAG7kB,WAAQnP,GAEjGi0B,EAAM92B,KAAK6G,QAAQ0iB,0BAA0B9iB,EAAM6C,GAEvDwtB,EAAIrW,QAAQlgB,SAAU,EAE1B,OAAOu2B,GAEX9B,EAAoBj2B,UAAU04B,yBAA2B,SAAUzD,GAC/D,GAAIh0B,KAAKi1B,WAAajB,EAAOiB,UACzB,IAAK,IAAIH,EAAI,EAAGA,EAAI90B,KAAKi1B,UAAUlzB,SAAU+yB,EACzC90B,KAAKi1B,UAAUH,GAAG0B,YAAYxC,EAAOiB,UAAUH,IAAI,GACnDd,EAAOiB,UAAUH,GAAGv0B,SAAU,EAGlCP,KAAKu1B,sBAAwBvB,EAAOuB,uBACpCv1B,KAAKu1B,qBAAqBiB,YAAYxC,EAAOuB,sBAC7CvB,EAAOuB,qBAAqBh1B,SAAU,GAE1CP,KAAKi1B,UAAY,KACjBj1B,KAAKu1B,qBAAuB,MAGhCP,EAAoBj2B,UAAU24B,SAAW,WACrC,IAAIZ,EAAM92B,KAAKy2B,4BACf,GAAKK,EAAL,CAGA,GAAI92B,KAAKu1B,qBAAsB,CAC3B,IAAI/T,EAAexhB,KAAKu1B,qBAAqB/T,aACzCmW,EAA4B,IAAjBnW,GACM,IAAjBA,GACiB,KAAjBA,EACJsV,EAAId,0BAA0Bh2B,KAAKu1B,qBAAqBqC,oBAAqBD,EAAU33B,KAAKm1B,gCAAiCn1B,KAAKu1B,qBAAqB1L,SAEvJ7pB,KAAK6pB,QAAU,GACfiN,EAAIrB,WAAWz1B,KAAK6pB,SAExBiN,EAAIW,yBAAyBz3B,MAC7B82B,EAAIx0B,YAKR0yB,EAAoBj2B,UAAU84B,gBAAkB,WAC5C,IAAI53B,EAAI0Z,EACR,GAAI3Z,KAAKi1B,UACL,IAAK,IAAIH,EAAI,EAAyF,QAArFnb,EAAKmb,GAA+B,QAAzB70B,EAAKD,KAAKi1B,iBAA8B,IAAPh1B,OAAgB,EAASA,EAAG8B,eAA4B,IAAP4X,GAAgBA,IAAUmb,EACpI90B,KAAKi1B,UAAUH,GAAGxyB,UAG1BtC,KAAKi1B,UAAY,MAMrBD,EAAoBj2B,UAAUuD,QAAU,SAAU6E,GAC9C,IAAIlH,OAC4B,IAA5BkH,IAAsCA,GAA0B,GAC/DA,IACoC,QAApClH,EAAKD,KAAKu1B,4BAAyC,IAAPt1B,GAAyBA,EAAGqC,UACzEtC,KAAKu1B,qBAAuB,KAC5Bv1B,KAAK63B,mBAET73B,KAAK6G,QAAQixB,4BAA4B93B,OAEtCg1B,EA9W6B,I,gDCDpC+C,EAA6B,WAC7B,SAASA,KAqDT,OA9CAA,EAAYC,qBAAuB,SAAUC,GAEzC,YADuB,IAAnBA,IAA6BA,EAAiB,UAC3CA,IAAmB,SAAsBF,EAAYG,kBAAoBH,EAAYI,uBAOhGJ,EAAYK,gBAAkB,SAAUH,GAEpC,YADuB,IAAnBA,IAA6BA,EAAiB,UAC3CA,IAAmB,SAAsBF,EAAYM,aAAeN,EAAYO,kBAO3FP,EAAYQ,wBAA0B,SAAUN,GAE5C,YADuB,IAAnBA,IAA6BA,EAAiB,UAC3CA,IAAmB,SAAsBF,EAAYS,qBAAuBT,EAAYU,0BAKnGV,EAAYG,kBAAoB,eAIhCH,EAAYM,aAAe,GAI3BN,EAAYS,qBAAuB,GAInCT,EAAYI,sBAAwB,mBAIpCJ,EAAYO,iBAAmB,GAI/BP,EAAYU,yBAA2B,GAChCV,EAtDqB,I,+PCqB5BW,EACA,aAOAC,EAA4B,WAQ5B,SAASA,EAAWC,EAAiBC,EAAWvvB,EAASC,GACrD,IAAI7C,EAAQ1G,KAEZA,KAAK84B,MAAQ,QAIb94B,KAAK+4B,kBAAmB,EAIxB/4B,KAAKg5B,cAAe,EAKpBh5B,KAAKyZ,cAAgB,KAIrBzZ,KAAKi5B,wBAAyB,EAI9Bj5B,KAAK6f,+BAAgC,EAErC7f,KAAKk5B,wBAAyB,EAC9Bl5B,KAAKm5B,wBAAyB,EAI9Bn5B,KAAKo5B,iBAAkB,EAIvBp5B,KAAKq5B,qBAAsB,EAI3Br5B,KAAK6K,uBAAwB,EAI7B7K,KAAKs5B,oBAAsB,IAAI,KAC/Bt5B,KAAKu5B,SAAW,EAEhBv5B,KAAKw5B,gBAAkB,IAAI9xB,MAE3B1H,KAAKy5B,gBAAkB,IAAI/xB,MAE3B1H,KAAK4K,cAAgB,EACrB5K,KAAK05B,qBAAsB,EAC3B15B,KAAK25B,8BAA+B,EAEpC35B,KAAK45B,QAAS,EAEd55B,KAAK65B,eAAgB,EACrB75B,KAAK85B,yBAA0B,EAC/B95B,KAAK+5B,mBAAqB,IAAIryB,MAK9B1H,KAAKg6B,wBAA0B,IAAI,KAInCh6B,KAAKi6B,4BAA8B,IAAI,KACvCj6B,KAAKk6B,iBAAkB,EAEvBl6B,KAAKgoB,yBAA0B,EAI/BhoB,KAAKm6B,2BAA4B,EAGjCn6B,KAAK0b,aAAc,EAEnB1b,KAAKo6B,oBAAqB,EAE1Bp6B,KAAKigB,mBAAqB,IAAI,IAE9BjgB,KAAK+f,sBAAwB,IAAI,IAEjC/f,KAAKq6B,cAAgB,IAAI,IAEzBr6B,KAAKkgB,YAAc,IAAI,IAEvBlgB,KAAKqe,WAAa,EAElBre,KAAKs6B,eAAiB,EAGtBt6B,KAAK+iB,uBAAyB,IAAIrb,MAElC1H,KAAKspB,0BAA4B,IAAI5hB,MAErC1H,KAAK+qB,eAAiB,EACtB/qB,KAAKu6B,wBAA0B,EAE/Bv6B,KAAK8qB,oBAAsB,GAC3B9qB,KAAKw6B,iBAAmB,GACxBx6B,KAAKy6B,2BAA6B,GAClCz6B,KAAK06B,0BAA2B,EAChC16B,KAAK26B,oBAAsB,IAAIjzB,MAE/B1H,KAAKyR,oBAAsB,KAE3BzR,KAAK46B,kBAAoB,KACzB56B,KAAK66B,uBAAyB,IAAInzB,MAClC1H,KAAK86B,0BAA4B,IAAIpzB,MACrC1H,KAAK+6B,wBAA0B,IAAIrzB,MACnC1H,KAAKg7B,sBAAuB,EAC5Bh7B,KAAKi7B,2BAA4B,EACjCj7B,KAAKk7B,sBAAwB,IAAIxzB,MACjC1H,KAAKm7B,yBAA2B,EAChCn7B,KAAKo7B,wBAA0B,KAC/Bp7B,KAAKq7B,gBAAkB,IAAI3zB,MAE3B1H,KAAKs7B,qBAAsB,EAE3Bt7B,KAAKokB,qBAAuB,KAI5BpkB,KAAKu7B,gBAAkB,CACnBC,UAAU,GAKdx7B,KAAKy7B,oBAAqB,EAI1Bz7B,KAAK07B,8BAAgC,IAAI,KAEzC17B,KAAK27B,WAAY,EACjB37B,KAAK47B,uBAAyB,EAC9B57B,KAAK67B,gBAAkB,CAAE94B,EAAG,EAAGC,EAAG,EAAGG,EAAG,EAAGE,EAAG,GAC9CrD,KAAK87B,mBAAqB,KAM1B97B,KAAK+7B,yBAA0B,EAC/B/7B,KAAKoY,eAAiB,GACtB,IAAIwI,EAAS,KAOb,GANAtX,EAAUA,GAAW,GACrBtJ,KAAKg8B,iBAAmB1yB,EAExBtJ,KAAKs7B,oBAAsB/xB,SAA+DA,EAC1FvJ,KAAK+f,sBAAsBkc,cAAgBj8B,KAAKq6B,cAChD,yBAA6C/wB,EAAQgpB,wBAChDsG,EAAL,CAIA,GADArvB,EAAqBA,GAAsBD,EAAQC,qBAAsB,EACrEqvB,EAAgBsD,WAAY,CAsC5B,GArCAtb,EAASgY,EACT54B,KAAKm8B,iBAAmBvb,OACN/d,IAAdg2B,IACAvvB,EAAQuvB,UAAYA,QAEch2B,IAAlCyG,EAAQ4oB,wBACR5oB,EAAQ4oB,uBAAwB,QAEHrvB,IAA7ByG,EAAQ6oB,mBACR7oB,EAAQ6oB,iBAAmB,QAENtvB,IAArByG,EAAQ8yB,WACR9yB,EAAQ8yB,SAAW,EAAI,SAEWv5B,IAAlCyG,EAAQ+yB,wBACR/yB,EAAQ+yB,uBAAwB,QAERx5B,IAAxByG,EAAQgzB,cACRhzB,EAAQgzB,aAAc,QAESz5B,IAA/ByG,EAAQizB,yBAAgF15B,IAA5CyG,EAAQizB,mBAAmBC,eACvEx8B,KAAKy8B,cAAgBnzB,EAAQizB,mBAAmBC,mBAEjB35B,IAA/ByG,EAAQizB,yBAAoF15B,IAAhDyG,EAAQizB,mBAAmBG,mBACvE18B,KAAK28B,kBAAoBrzB,EAAQizB,mBAAmBG,uBAEhC75B,IAApByG,EAAQ2I,UACR3I,EAAQ2I,SAAU,IAEa,IAA/B3I,EAAQmyB,qBACRz7B,KAAKy7B,oBAAqB,QAED54B,IAAzByG,EAAQszB,eACRtzB,EAAQszB,cAAe,GAE3B58B,KAAKgoB,0BAA0B1e,EAAQwb,uBAEnC+X,WAAaA,UAAUC,UAAW,CAElC98B,KAAK+8B,gBAAkB,WACnB,IAAIC,EAAYH,UAAUC,UAC1Bp2B,EAAM60B,gBAAgBC,UACe,IAAjCwB,EAAU9Y,QAAQ,YAEiB,IAA9B8Y,EAAU9Y,QAAQ,SAAiB,WAAyB,eAAgB+Y,UAGzFj9B,KAAK+8B,mBAED,WACAltB,OAAOqtB,iBAAiB,SAAUl9B,KAAK+8B,iBAG3C,IADA,IAAII,EAAKN,UAAUC,UACV/rB,EAAK,EAAG9Q,EAAK04B,EAAWyE,cAAersB,EAAK9Q,EAAG8B,OAAQgP,IAAM,CAClE,IAAIpB,EAAY1P,EAAG8Q,GACfssB,EAAM1tB,EAAU0tB,IAChBC,EAAU3tB,EAAU2tB,QAExB,GADY,IAAIC,OAAOF,GACbG,KAAKL,GAAK,CAChB,GAAIxtB,EAAU8tB,SAAW9tB,EAAU+tB,kBAAmB,CAClD,IAAID,EAAU9tB,EAAU8tB,QACpBE,EAAahuB,EAAU+tB,kBAEvBE,EADQ,IAAIL,OAAOE,GACHI,KAAKV,GACzB,GAAIS,GAAWA,EAAQ77B,OAAS,EAE5B,GADoB+7B,SAASF,EAAQA,EAAQ77B,OAAS,KACjC47B,EACjB,SAIZ,IAAK,IAAIhkB,EAAK,EAAGokB,EAAYT,EAAS3jB,EAAKokB,EAAUh8B,OAAQ4X,IAAM,CAE/D,OADaokB,EAAUpkB,IAEnB,IAAK,gBACD3Z,KAAK6K,uBAAwB,EAC7B,MACJ,IAAK,MACD7K,KAAKm6B,2BAA4B,EACjC,MACJ,IAAK,YACD7wB,EAAQuvB,WAAY,EACpB,MACJ,IAAK,iBACD74B,KAAKo7B,wBAA0B,MA4BvD,GApBKp7B,KAAKgoB,0BACNhoB,KAAKg+B,eAAiB,SAAUC,GAC5BA,EAAIC,iBACJx3B,EAAMwzB,iBAAkB,EACxB,SAAY,uBACZxzB,EAAMszB,wBAAwB16B,gBAAgBoH,IAElD1G,KAAKm+B,mBAAqB,WACtBz3B,EAAM03B,+BAA+B13B,EAAM23B,eAAeC,KAAK53B,KAEnEka,EAAOsc,iBAAiB,mBAAoBl9B,KAAKg+B,gBAAgB,GACjEpd,EAAOsc,iBAAiB,uBAAwBl9B,KAAKm+B,oBAAoB,GACzE70B,EAAQi1B,gBAAkB,oBAG9Bv+B,KAAK65B,cAAgB,iCAAiC2D,KAAKX,UAAUC,WACjE98B,KAAK65B,gBACLvwB,EAAQszB,cAAe,IAGtBtzB,EAAQk1B,qBACT,IACIx+B,KAAK8lB,IAAOlF,EAAOsb,WAAW,SAAU5yB,IAAYsX,EAAOsb,WAAW,sBAAuB5yB,GACzFtJ,KAAK8lB,MACL9lB,KAAK4K,cAAgB,EACrB5K,KAAKy+B,oBAAsB,SAEtBz+B,KAAK8lB,IAAI4Y,cACV1+B,KAAK4K,cAAgB,EACrB5K,KAAKy+B,oBAAsB,WAIvC,MAAOE,IAIX,IAAK3+B,KAAK8lB,IAAK,CACX,IAAKlF,EACD,MAAM,IAAI/f,MAAM,6CAEpB,IACIb,KAAK8lB,IAAOlF,EAAOsb,WAAW,QAAS5yB,IAAYsX,EAAOsb,WAAW,qBAAsB5yB,GAE/F,MAAOq1B,GACH,MAAM,IAAI99B,MAAM,wBAGxB,IAAKb,KAAK8lB,IACN,MAAM,IAAIjlB,MAAM,2BAGnB,CACDb,KAAK8lB,IAAM8S,EACX54B,KAAKm8B,iBAAmBn8B,KAAK8lB,IAAIlF,OAC7B5gB,KAAK8lB,IAAI8Y,gCACT5+B,KAAK4K,cAAgB,EACrB5K,KAAKy+B,oBAAsB,UAG3Bz+B,KAAKy+B,oBAAsB,SAE/B,IAAIn9B,EAAatB,KAAK8lB,IAAI+Y,uBACtBv9B,IACAgI,EAAQ2I,QAAU3Q,EAAW2Q,SAIrCjS,KAAK8lB,IAAIgZ,YAAY9+B,KAAK8lB,IAAIiZ,mCAAoC/+B,KAAK8lB,IAAIkZ,WACpCn8B,IAAnCyG,EAAQ21B,yBACRj/B,KAAK25B,6BAA+BrwB,EAAQ21B,wBAGhD,IAAI/uB,GAAmB,WAAwBL,OAAOK,kBAA0B,EAC5EgvB,EAAmB51B,EAAQ41B,kBAAoBhvB,EACnDlQ,KAAKmQ,sBAAwB5G,EAAqB,EAAMkY,KAAK0d,IAAID,EAAkBhvB,GAAoB,EACvGlQ,KAAKoQ,SACLpQ,KAAKo/B,mBAAmB91B,EAAQ2I,QAChCjS,KAAKq+B,iBACLr+B,KAAKq/B,gBAEL,IAAK,IAAIvK,EAAI,EAAGA,EAAI90B,KAAK8K,MAAMQ,iBAAkBwpB,IAC7C90B,KAAK66B,uBAAuB/F,GAAK,IAAI4D,EAGzC14B,KAAKwQ,iBAAmBxQ,KAAKs/B,aAAe,EAAI,IAAI,IAA0B,IAAI,IAElFt/B,KAAK45B,OAAS,QAAQ4D,KAAKX,UAAUC,YAAc,UAAUU,KAAKX,UAAUC,WAQ5E,IAAIyC,EAAe,eAAe50B,OAAOguB,EAAW6G,SAGhDx/B,KAAKm8B,kBAAoBn8B,KAAKm8B,iBAAiBsD,cAC/Cz/B,KAAKm8B,iBAAiBsD,aAAa,cAAeF,IA04I1D,OAv4IAzgC,OAAOI,eAAey5B,EAAY,aAAc,CAK5Cx5B,IAAK,WACD,MAAO,oBAEX6H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAY,UAAW,CAIzCx5B,IAAK,WACD,MAAO,UAEX6H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,cAAe,CAIvDI,IAAK,WACD,IAAIugC,EAAc1/B,KAAKkC,KAAOlC,KAAKs/B,aAInC,OAHIt/B,KAAK8K,MAAM60B,wBACXD,GAAe,kCAEZA,GAEX14B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,OAAQ,CAIhDI,IAAK,WACD,OAAOa,KAAK84B,OAEhB15B,IAAK,SAAUC,GACXW,KAAK84B,MAAQz5B,GAEjB2H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,UAAW,CAInDI,IAAK,WACD,OAAOa,KAAK4K,eAEhB5D,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAY,oBAAqB,CAInDx5B,IAAK,WACD,OAAO,uBAEXC,IAAK,SAAUC,GACX,sBAA2BA,GAE/B2H,YAAY,EACZC,cAAc,IAMlB0xB,EAAW55B,UAAU6gC,oBAAsB,SAAU3H,GACjD,OAAOj4B,KAAKwQ,kBAEhB1R,OAAOI,eAAey5B,EAAW55B,UAAW,wBAAyB,CAKjEI,IAAK,WACD,OAAOa,KAAKm5B,wBAEhB/5B,IAAK,SAAUygC,GACPA,IAAe7/B,KAAKm5B,yBAGxBn5B,KAAKm5B,uBAAyB0G,EAE1B7/B,KAAKigB,mBAAmB7E,UADxBykB,EACoC,IAGA,MAG5C74B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,UAAW,CAInDI,IAAK,WACD,OAAOa,KAAKu5B,UAEhBvyB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,yBAA0B,CAKlEI,IAAK,WACD,OAAOa,KAAKs/B,aAAe,IAAMt/B,KAAK6K,uBAE1C7D,YAAY,EACZC,cAAc,IAMlB0xB,EAAW55B,UAAU+gC,mBAAqB,WACtC,OAAO9/B,KAAKg8B,kBAEhBl9B,OAAOI,eAAey5B,EAAW55B,UAAW,gCAAiC,CAEzEI,IAAK,WACD,SAAUa,KAAK8K,MAAMqB,+BAAgCnM,KAAK25B,+BAE9D3yB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,kBAAmB,CAK3DI,IAAK,WACD,OAAOa,KAAK4K,cAAgB,GAAK5K,KAAK+4B,kBAE1C/xB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,oBAAqB,CAK7DI,IAAK,WACD,OAAOa,KAAK+5B,oBAEhB/yB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,yBAA0B,CAKlEI,IAAK,WACD,OAAOa,KAAKgoB,yBAEhB5oB,IAAK,SAAUC,GACXW,KAAKgoB,wBAA0B3oB,GAEnC2H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,oCAAqC,CAC7EI,IAAK,WACD,OAAO,GAEX6H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,8BAA+B,CAMvEK,IAAK,SAAU2gC,GACX//B,KAAKggC,6BAA+BD,GAExC/4B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,kBAAmB,CAI3DI,IAAK,WACD,OAAOa,KAAKkZ,iBAEhBlS,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,eAAgB,CAIxDI,IAAK,WAID,OAHKa,KAAKigC,gBACNjgC,KAAKigC,cAAgBjgC,KAAK2hB,iBAAiB,IAAIC,WAAW,GAAI,EAAG,EAAG,GAAG,GAAO,EAAO,IAElF5hB,KAAKigC,eAEhBj5B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,iBAAkB,CAI1DI,IAAK,WAID,OAHKa,KAAKkgC,kBACNlgC,KAAKkgC,gBAAkBlgC,KAAKmgC,mBAAmB,IAAIve,WAAW,GAAI,EAAG,EAAG,EAAG,GAAG,GAAO,EAAO,IAEzF5hB,KAAKkgC,iBAEhBl5B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,sBAAuB,CAI/DI,IAAK,WAID,OAHKa,KAAKogC,uBACNpgC,KAAKogC,qBAAuBpgC,KAAKgjB,wBAAwB,IAAIpB,WAAW,GAAI,EAAG,EAAG,EAAG,GAAG,GAAO,EAAO,IAEnG5hB,KAAKogC,sBAEhBp5B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,mBAAoB,CAI5DI,IAAK,WACD,IAAKa,KAAKqgC,kBAAmB,CACzB,IAAIC,EAAW,IAAI1e,WAAW,GAC1B2e,EAAW,CAACD,EAAUA,EAAUA,EAAUA,EAAUA,EAAUA,GAClEtgC,KAAKqgC,kBAAoBrgC,KAAKwgC,qBAAqBD,EAAU,EAAG,EAAG,GAAG,GAAO,EAAO,GAExF,OAAOvgC,KAAKqgC,mBAEhBr5B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,WAAY,CAIpDI,IAAK,WACD,OAAOa,KAAK27B,WAEhB30B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,qBAAsB,CAI9DI,IAAK,WACD,OAAOa,KAAKy+B,qBAEhBz3B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,oBAAqB,CAK7DI,IAAK,WACD,OAAO,GAEXC,IAAK,SAAUqhC,KAGfz5B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,wBAAyB,CAIjEI,IAAK,WACD,OAAOa,KAAK47B,wBAEhBx8B,IAAK,SAAU+e,GACXne,KAAK47B,uBAAyBzd,GAElCnX,YAAY,EACZC,cAAc,IAKlB0xB,EAAW55B,UAAU2hC,uBAAyB,WAC1C1gC,KAAK2gC,mBAAoB,GAE7BhI,EAAWiI,cAAgB,SAAUjoB,EAAOE,GACxC,GAAwB,oBAAbokB,SACP,OAAO,IAAI4D,gBAAgBloB,EAAOE,GAEtC,IAAI+H,EAASqc,SAAS6D,cAAc,UAGpC,OAFAlgB,EAAOjI,MAAQA,EACfiI,EAAO/H,OAASA,EACT+H,GAQX+X,EAAW55B,UAAUkuB,aAAe,SAAUtU,EAAOE,GACjD,OAAO8f,EAAWiI,cAAcjoB,EAAOE,IAM3C8f,EAAW55B,UAAU4nB,kBAAoB,WACrC,OAAOsW,SAAS6D,cAAc,QAElCnI,EAAW55B,UAAUq/B,+BAAiC,SAAU2C,GAC5D,IAAIr6B,EAAQ1G,KAEZwzB,YAAW,WAAc,OAAO,QAAU9sB,OAAO,OAAQ,GAAQ,WAC7D,IAAIs6B,EAAW5lB,EAAW6lB,EAAWC,EACjCjhC,EACJ,OAAO,QAAYD,MAAM,SAAU2Z,GAC/B,OAAQA,EAAGzZ,OACP,KAAK,EAOD,OANAF,KAAK46B,kBAAoB,KACzBoG,EAAYhhC,KAAKigB,mBAAmB+gB,UACpC5lB,EAAYpb,KAAKigB,mBAAmB7E,UACpC6lB,EAAYjhC,KAAKigB,mBAAmBghB,UACpCC,EAAclhC,KAAKq6B,cAAc6G,YAE1B,CAAC,EAAaH,KACzB,KAAK,EAqBD,OAnBApnB,EAAGxZ,OAEHH,KAAKmhC,kBACkC,QAAtClhC,EAAKD,KAAKohC,8BAA2C,IAAPnhC,GAAyBA,EAAGhB,KAAKe,MAEhFA,KAAKqhC,2BAELrhC,KAAKshC,+BAELthC,KAAKuhC,kBAELvhC,KAAK2f,YAAW,GAChB3f,KAAKigB,mBAAmB+gB,UAAYA,EACpChhC,KAAKigB,mBAAmB7E,UAAYA,EACpCpb,KAAKigB,mBAAmBghB,UAAYA,EACpCjhC,KAAKq6B,cAAc6G,YAAcA,EACjC,SAAYlhC,KAAKkC,KAAO,mCACxBlC,KAAKi6B,4BAA4B36B,gBAAgBU,MACjDA,KAAKk6B,iBAAkB,EAChB,CAAC,YAGjB,IAQXvB,EAAW55B,UAAUyiC,YAAc,SAAU5gB,EAAQ6gB,EAAwBnF,GACzEt8B,KAAKm8B,iBAAmBvb,GAM5B+X,EAAW55B,UAAU2iC,4BAA8B,SAAUzJ,GACzD,OAAO,MAEXU,EAAW55B,UAAUsiC,yBAA2B,WAE5C,IADA,IACStwB,EAAK,EAAG4wB,EADE3hC,KAAK+iB,uBAAuB6e,QACC7wB,EAAK4wB,EAAe5/B,OAAQgP,IAAM,CACxD4wB,EAAe5wB,GACrB2mB,aAGxBiB,EAAW55B,UAAUuiC,6BAA+B,WAEhD,IADA,IACSvwB,EAAK,EAAG8wB,EADE7hC,KAAKspB,0BAA0BsY,QACF7wB,EAAK8wB,EAAe9/B,OAAQgP,IAAM,CACpD8wB,EAAe9wB,GACrB2mB,aAG5BiB,EAAW55B,UAAUoiC,gBAAkB,WACnC,IAAK,IAAI9D,KAAOr9B,KAAKw6B,iBAAkB,CACnC,IAAIz5B,EAASf,KAAKw6B,iBAAiB6C,GACnCt8B,EAAO+gC,iBAAmB,KAC1B/gC,EAAOghC,qBAAsB,EAC7BhhC,EAAOihC,iBAEX,kBAMJrJ,EAAW55B,UAAU40B,mBAAqB,WACtC,IAAK,IAAI0J,KAAOr9B,KAAKw6B,iBAAkB,CAEnC,IADax6B,KAAKw6B,iBAAiB6C,GACvB98B,UACR,OAAO,EAGf,OAAO,GAEXo4B,EAAW55B,UAAUwiC,gBAAkB,WAEnC,IAAK,IAAIxwB,EAAK,EAAG9Q,EAAKD,KAAKw5B,gBAAiBzoB,EAAK9Q,EAAG8B,OAAQgP,IAAM,CAC1C9Q,EAAG8Q,GACT2mB,WAGlB,IAAK,IAAI/d,EAAK,EAAG+c,EAAK12B,KAAKy5B,gBAAiB9f,EAAK+c,EAAG30B,OAAQ4X,IAAM,CAC1C+c,EAAG/c,GACT+d,aAGtBiB,EAAW55B,UAAUs/B,eAAiB,WAElCr+B,KAAK8K,MAAQ,CACTC,sBAAuB/K,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIoc,yBACtDj3B,8BAA+BjL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIqc,kCAC9Dn3B,2BAA4BhL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIsc,gCAC3Dl3B,eAAgBlL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIuc,kBAC/CC,WAAYtiC,KAAK4K,cAAgB,EAAI5K,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIyc,aAAe,EACnFn3B,sBAAuBpL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI0c,2BACtDn3B,qBAAsBrL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI2c,uBACrDn3B,iBAAkBtL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI4c,oBACjDn3B,kBAAmBvL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI6c,qBAClDn3B,0BAA2BxL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI8c,8BAC1Dn3B,wBAAyBzL,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI+c,4BACxDlD,sBAAuB3/B,KAAK8lB,IAAIgd,aAAa,qCAAkCjgC,EAC/E6I,oBAAqB1L,KAAK4K,cAAgB,GAA2D,OAAtD5K,KAAK8lB,IAAIgd,aAAa,4BACrE92B,cAAe,EACfL,KAAM3L,KAAK8lB,IAAIgd,aAAa,kCAAoC9iC,KAAK8lB,IAAIgd,aAAa,wCACtF/2B,KAAM/L,KAAK8lB,IAAIgd,aAAa,iCAAmC9iC,KAAK8lB,IAAIgd,aAAa,uCACrFC,KAAM/iC,KAAK8lB,IAAIgd,aAAa,kCAAoC9iC,KAAK8lB,IAAIgd,aAAa,wCAEtFE,UAAWhjC,KAAK8lB,IAAIgd,aAAa,uCAAyC9iC,KAAK8lB,IAAIgd,aAAa,6CAChGl3B,MAAO5L,KAAK8lB,IAAIgd,aAAa,mCAAqC9iC,KAAK8lB,IAAIgd,aAAa,yCACxFj3B,KAAM7L,KAAK8lB,IAAIgd,aAAa,kCAAoC9iC,KAAK8lB,IAAIgd,aAAa,wCACtFh3B,KAAM9L,KAAK8lB,IAAIgd,aAAa,iCACxB9iC,KAAK8lB,IAAIgd,aAAa,wCACtB9iC,KAAK8lB,IAAIgd,aAAa,kCAC1BG,kCAAmCjjC,KAAK8lB,IAAIgd,aAAa,mCACrD9iC,KAAK8lB,IAAIgd,aAAa,0CACtB9iC,KAAK8lB,IAAIgd,aAAa,sCAC1B72B,YAAajM,KAAK4K,cAAgB,GAAyD,OAApD5K,KAAK8lB,IAAIgd,aAAa,0BAC7D52B,uBAAwBlM,KAAK4K,cAAgB,GAAiD,OAA5C5K,KAAK8lB,IAAIgd,aAAa,kBACxE32B,8BAA8B,EAC9B+2B,WAAYljC,KAAK8lB,IAAIgd,aAAa,oCAAsC9iC,KAAK8lB,IAAIgd,aAAa,4BAC9F91B,sBAAuBhN,KAAK4K,cAAgB,EAC5CqC,8BAA8B,EAC9BL,sBAAsB,EACtBO,eAAgB,EAChBf,oBAAqBpM,KAAK4K,cAAgB,GAAK5K,KAAK8lB,IAAIgd,aAAa,2BACrEz2B,gBAAcrM,KAAK4K,cAAgB,GAAK5K,KAAK8lB,IAAIgd,aAAa,sBAC9Dt2B,oBAAkBxM,KAAK4K,cAAgB,GAAK5K,KAAK8lB,IAAIgd,aAAa,2BAClEp2B,wBAAwB,EACxBJ,6BAA6B,EAC7BC,oBAAoB,EACpBE,iCAAiC,EACjCK,mBAAmB,EACnBC,iBAAiB,EACjBJ,cAAY3M,KAAK4K,cAAgB,GAAK5K,KAAK8lB,IAAIgd,aAAa,2BAC5D51B,aAAa,EACbi2B,UAAWnjC,KAAK8lB,IAAIgd,aAAa,kBACjCM,gBAAiBpjC,KAAK8lB,IAAIgd,aAAa,oBACvCj2B,uBAAuB,EACvBO,mBAAoBpN,KAAK4K,cAAgB,EACzCyC,iBAAkBrN,KAAK4K,cAAgB,EACvC0C,uBAAuB,EACvBC,oBAAoB,EACpBC,0BAA2BxN,KAAK4K,cAAgB,EAChD6C,gBAAiBzN,KAAK4K,cAAgB,EACtC8C,4BAA6B1N,KAAK4K,cAAgB,EAAI,IAAM,KAGhE5K,KAAKqjC,WAAarjC,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIwd,SACjD,IAAIC,EAAevjC,KAAK8lB,IAAIgd,aAAa,6BA8DzC,GA7DoB,MAAhBS,IACAvjC,KAAKwjC,YAAcxjC,KAAK8lB,IAAImc,aAAasB,EAAaE,yBACtDzjC,KAAK0jC,UAAY1jC,KAAK8lB,IAAImc,aAAasB,EAAaI,wBAEnD3jC,KAAK0jC,YACN1jC,KAAK0jC,UAAY1jC,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI8d,SAAW,kBAE1D5jC,KAAKwjC,cACNxjC,KAAKwjC,YAAcxjC,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI+d,WAAa,oBAGnC,QAA5B7jC,KAAK8lB,IAAIge,iBACT9jC,KAAK8lB,IAAIge,eAAiB,OAEL,QAArB9jC,KAAK8lB,IAAIie,UACT/jC,KAAK8lB,IAAIie,QAAU,OAEE,QAArB/jC,KAAK8lB,IAAIke,UACThkC,KAAK8lB,IAAIke,QAAU,OAEW,QAA9BhkC,KAAK8lB,IAAIme,mBACTjkC,KAAK8lB,IAAIme,iBAAmB,OAG5BjkC,KAAK8K,MAAMo4B,aACgB,IAAvBljC,KAAK4K,gBACL5K,KAAK8lB,IAAIoe,SAAWlkC,KAAK8K,MAAMo4B,WAAWiB,YAAY7F,KAAKt+B,KAAK8K,MAAMo4B,aAE1EljC,KAAK8K,MAAMmC,6BAA+BjN,KAAK8lB,IAAIoe,SAASlkC,KAAK8K,MAAMo4B,WAAWkB,cAAepkC,KAAK8K,MAAMo4B,WAAWmB,wBAA0B,GAErJrkC,KAAK8K,MAAMkB,cAAgBhM,KAAK8K,MAAMm4B,kCAChCjjC,KAAK8lB,IAAImc,aAAajiC,KAAK8K,MAAMm4B,kCAAkCqB,gCACnE,EACNtkC,KAAK8K,MAAMwB,+BAA8BtM,KAAK8K,MAAMuB,eAAgBrM,KAAK8lB,IAAIgd,aAAa,6BAC1F9iC,KAAK8K,MAAMyB,sBAAqBvM,KAAK8K,MAAMuB,eAAgBrM,KAAKukC,gCAChEvkC,KAAK8K,MAAM2B,mCACPzM,KAAK4K,cAAgB,GAAM5K,KAAK8K,MAAM0B,kBAAoBxM,KAAK8lB,IAAIgd,aAAa,kCAEhF9iC,KAAK8K,MAAMa,OACX3L,KAAK8lB,IAAI0e,qCAAuCxkC,KAAK8K,MAAMa,KAAK64B,sCAEhExkC,KAAK8K,MAAMiB,OACX/L,KAAK8lB,IAAI2e,qCAAuCzkC,KAAK8K,MAAMiB,KAAK04B,sCAEhEzkC,KAAK8K,MAAMk4B,YACXhjC,KAAK8lB,IAAI4e,8BAAgC1kC,KAAK8K,MAAMk4B,UAAU0B,8BAC9D1kC,KAAK8lB,IAAI6e,oCAAsC3kC,KAAK8K,MAAMk4B,UAAU2B,oCACpE3kC,KAAK8lB,IAAI8e,oCAAsC5kC,KAAK8K,MAAMk4B,UAAU4B,qCAEpE5kC,KAAK8K,MAAMgB,OACX9L,KAAK8lB,IAAI+e,sBAAwB7kC,KAAK8K,MAAMgB,KAAK+4B,sBACjD7kC,KAAK8lB,IAAIgf,iCAAmC9kC,KAAK8K,MAAMgB,KAAKg5B,kCAG5D9kC,KAAK4K,cAAgB,GACW,OAA5B5K,KAAK8lB,IAAIge,iBACT9jC,KAAK8lB,IAAIge,eAAiB,MAGlC9jC,KAAK8K,MAAM4B,uBAAyB1M,KAAK8K,MAAM0B,kBAAoBxM,KAAK+kC,mCAEpE/kC,KAAK4K,cAAgB,EACrB5K,KAAK8K,MAAM8B,sBAAuB,EAClC5M,KAAK8K,MAAMqC,eAAkD,OAAjCnN,KAAKo7B,wBAAmCp7B,KAAKo7B,wBAA0Bp7B,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAIyc,iBAEjI,CACD,IAAI31B,EAAuB5M,KAAK8lB,IAAIgd,aAAa,sBACjD,GAA6B,OAAzBl2B,EAA+B,CAC/B5M,KAAK8K,MAAM8B,sBAAuB,EAClC5M,KAAK8lB,IAAIkf,YAAcp4B,EAAqBq4B,iBAAiB3G,KAAK1xB,GAClE5M,KAAK8lB,IAAIof,iBAAmBllC,KAAK8lB,IAAIqf,YACrC,IAAK,IAAIrQ,EAAI,EAAGA,EAAI,GAAIA,IACpB90B,KAAK8lB,IAAI,mBAAqBgP,EAAI,UAAYloB,EAAqB,mBAAqBkoB,EAAI,WAKxG,GAAI90B,KAAK4K,cAAgB,EACrB5K,KAAK8K,MAAM+B,uBAAwB,MAElC,CACD,IAAIA,EAAwB7M,KAAK8lB,IAAIgd,aAAa,uBACrB,MAAzBj2B,IACA7M,KAAK8K,MAAM+B,uBAAwB,EACnC7M,KAAK8lB,IAAIsf,kBAAoBv4B,EAAsBw4B,yBAI3D,GAAIrlC,KAAKm6B,0BACLn6B,KAAK8K,MAAMgC,mBAAoB,OAE9B,GAAI9M,KAAK4K,cAAgB,EAC1B5K,KAAK8K,MAAMgC,mBAAoB,MAE9B,CACD,IAAIw4B,EAA6BtlC,KAAK8lB,IAAIgd,aAAa,2BACrB,MAA9BwC,IACAtlC,KAAK8K,MAAMgC,mBAAoB,EAC/B9M,KAAK8lB,IAAIvR,kBAAoB+wB,EAA2BC,qBAAqBjH,KAAKgH,GAClFtlC,KAAK8lB,IAAI0f,gBAAkBF,EAA2BG,mBAAmBnH,KAAKgH,GAC9EtlC,KAAK8lB,IAAI4f,kBAAoBJ,EAA2BK,qBAAqBrH,KAAKgH,IAI1F,GAAItlC,KAAK4K,cAAgB,EACrB5K,KAAK8K,MAAMiC,iBAAkB,MAE5B,CACD,IAAI64B,EAAoB5lC,KAAK8lB,IAAIgd,aAAa,0BACrB,MAArB8C,GACA5lC,KAAK8K,MAAMiC,iBAAkB,EAC7B/M,KAAK8lB,IAAI+f,oBAAsBD,EAAkBE,yBAAyBxH,KAAKsH,GAC/E5lC,KAAK8lB,IAAIigB,sBAAwBH,EAAkBI,2BAA2B1H,KAAKsH,GACnF5lC,KAAK8lB,IAAImgB,oBAAsBL,EAAkBM,yBAAyB5H,KAAKsH,IAG/E5lC,KAAK8K,MAAMiC,iBAAkB,EAGrC,GAAI/M,KAAK8lB,IAAIqgB,yBAA0B,CACnC,IAAIC,EAAcpmC,KAAK8lB,IAAIqgB,yBAAyBnmC,KAAK8lB,IAAIugB,cAAermC,KAAK8lB,IAAIwgB,YACjFC,EAAgBvmC,KAAK8lB,IAAIqgB,yBAAyBnmC,KAAK8lB,IAAI0gB,gBAAiBxmC,KAAK8lB,IAAIwgB,YACrFF,GAAeG,IACfvmC,KAAK8K,MAAMqB,6BAAyD,IAA1Bi6B,EAAYK,WAA+C,IAA5BF,EAAcE,WAG/F,GAAIzmC,KAAK4K,cAAgB,EACrB5K,KAAK8K,MAAMoC,aAAc,MAExB,CACD,IAAIw5B,EAAuB1mC,KAAK8lB,IAAIgd,aAAa,oBACrB,MAAxB4D,IACA1mC,KAAK8K,MAAMoC,aAAc,EACzBlN,KAAK8lB,IAAI6gB,IAAMD,EAAqBE,QACpC5mC,KAAK8lB,IAAI+gB,IAAMH,EAAqBI,SAK5C,IAAK9mC,KAAK8K,MAAMyC,mBAAoB,CAChC,GAAIvN,KAAK4K,cAAgB,EACrB5K,KAAK8K,MAAMyC,oBAAqB,MAE/B,CACD,IAAIw5B,EAAgB/mC,KAAK8lB,IAAIgd,aAAa,YACrB,MAAjBiE,IACA/mC,KAAK8K,MAAMyC,oBAAqB,EAChCvN,KAAK8lB,IAAIkhB,KAAOD,EAAcE,SAC9BjnC,KAAK8lB,IAAIohB,MAAQH,EAAcI,eAC/BnnC,KAAK8lB,IAAIshB,aAAeL,EAAcI,gBAK9CnnC,KAAK8K,MAAMyC,mBAAqBvN,KAAK8K,MAAMyC,uBAAyBvN,KAAKg8B,mBAAoBh8B,KAAKg8B,iBAAiBqL,6BAGvHrnC,KAAKigB,mBAAmB+gB,WAAY,EACpChhC,KAAKigB,mBAAmB7E,UAAYpb,KAAK8lB,IAAIwhB,OAC7CtnC,KAAKigB,mBAAmBghB,WAAY,EAEpCjhC,KAAKm7B,yBAA2Bn7B,KAAK8K,MAAMG,8BAC3C,IAAK,IAAIs8B,EAAO,EAAGA,EAAOvnC,KAAKm7B,yBAA0BoM,IACrDvnC,KAAKk7B,sBAAsB/4B,KAAKolC,IAGxC5O,EAAW55B,UAAUsgC,cAAgB,WACjCr/B,KAAK4N,UAAY,CACbC,iCAAiC,EACjCC,0CAAkE,IAAvB9N,KAAK4K,cAChDmD,2BAAmD,IAAvB/N,KAAK4K,cACjCoD,sBAA8C,IAAvBhO,KAAK4K,cAC5BqD,8BAA8B,EAC9BC,yBAAiD,IAAvBlO,KAAK4K,cAC/BuD,kBAAkB,EAClBC,8BAA8B,EAC9BC,WAAmC,IAAvBrO,KAAK4K,cACjB0D,cAAsC,IAAvBtO,KAAK4K,cACpB2D,kBAA0C,IAAvBvO,KAAK4K,cACxB4D,gCAAwD,IAAvBxO,KAAK4K,cACtC6D,YAAoC,IAAvBzO,KAAK4K,cAClB8D,aAAqC,IAAvB1O,KAAK4K,cACnB+D,8BAAsD,IAAvB3O,KAAK4K,cACpCgE,0BAAkD,IAAvB5O,KAAK4K,cAChCiE,wBAAwB,EACxBC,sBAAsB,EACtBC,oBAAoB,EACpBC,wBAAwB,EACxBC,gCAAgC,EAChCC,qBAAqB,EACrBC,4BAA4B,IAGpCrQ,OAAOI,eAAey5B,EAAW55B,UAAW,eAAgB,CAKxDI,IAAK,WACD,OAAOa,KAAK4K,eAEhB5D,YAAY,EACZC,cAAc,IAMlB0xB,EAAW55B,UAAUyoC,aAAe,WAChC,MAAO,cAEX1oC,OAAOI,eAAey5B,EAAW55B,UAAW,kBAAmB,CAI3DI,IAAK,WACD,OAAOa,KAAKo/B,kBAEhBp4B,YAAY,EACZC,cAAc,IAGlB0xB,EAAW55B,UAAU0oC,sBAAwB,WACzC,IAAIznC,KAAK0nC,eAAT,CAGA1nC,KAAK0nC,eAAiB1nC,KAAKitB,aAAa,EAAG,GAC3C,IAAIlW,EAAU/W,KAAK0nC,eAAexL,WAAW,MACzCnlB,IACA/W,KAAK2nC,gBAAkB5wB,KAM/B4hB,EAAW55B,UAAU+gB,kBAAoB,WACrC,IAAK,IAAIud,KAAOr9B,KAAK8qB,oBACZhsB,OAAOC,UAAUC,eAAeC,KAAKe,KAAK8qB,oBAAqBuS,KAGpEr9B,KAAK8qB,oBAAoBuS,GAAO,MAEpCr9B,KAAKu6B,wBAA0B,GAMnC5B,EAAW55B,UAAU6oC,QAAU,WAC3B,OAAO5nC,KAAK6nC,aAMhBlP,EAAW55B,UAAU8oC,UAAY,WAC7B,MAAO,CACHC,OAAQ9nC,KAAK0jC,UACbqE,SAAU/nC,KAAKwjC,YACfwE,QAAShoC,KAAKqjC,aAStB1K,EAAW55B,UAAUkS,wBAA0B,SAAUC,GACrDlR,KAAKmQ,sBAAwBe,EAC7BlR,KAAKoQ,UAQTuoB,EAAW55B,UAAUiS,wBAA0B,WAC3C,OAAOhR,KAAKmQ,uBAMhBwoB,EAAW55B,UAAUkpC,uBAAyB,WAC1C,OAAOjoC,KAAK+iB,wBAMhB4V,EAAW55B,UAAUmpC,QAAU,WAC3B,OAAOloC,KAAK8K,OAMhB6tB,EAAW55B,UAAUopC,eAAiB,SAAUC,GAC5C,GAAKA,EAAL,CAIA,IAAI7mC,EAAQvB,KAAK+5B,mBAAmB7V,QAAQkkB,GACxC7mC,GAAS,GACTvB,KAAK+5B,mBAAmB93B,OAAOV,EAAO,QALtCvB,KAAK+5B,mBAAqB,IASlCpB,EAAW55B,UAAUspC,YAAc,WAC/B,IAAKroC,KAAKk6B,gBAAiB,CACvB,IAAIoO,GAAe,EAInB,IAHKtoC,KAAKi5B,wBAA0Bj5B,KAAK05B,sBACrC4O,GAAe,GAEfA,EAAc,CAEdtoC,KAAKuoC,aACL,IAAK,IAAIhnC,EAAQ,EAAGA,EAAQvB,KAAK+5B,mBAAmBh4B,OAAQR,IAAS,EAEjE6mC,EADqBpoC,KAAK+5B,mBAAmBx4B,MAIjDvB,KAAKwoC,YAGTxoC,KAAK+5B,mBAAmBh4B,OAAS,EACjC/B,KAAKyoC,cAAgBzoC,KAAKoR,eAAepR,KAAK0oC,qBAAsB1oC,KAAK2oC,iBAGzE3oC,KAAK85B,yBAA0B,GAOvCnB,EAAW55B,UAAU6pC,mBAAqB,WACtC,OAAO5oC,KAAKm8B,kBAMhBxD,EAAW55B,UAAU8pC,gBAAkB,WACnC,OAAO7oC,KAAKy8B,eAMhB9D,EAAW55B,UAAU+pC,oBAAsB,WACvC,OAAO9oC,KAAK28B,mBAMhBhE,EAAW55B,UAAU4pC,cAAgB,WACjC,OAAK,UAGD3oC,KAAKm8B,kBAAoBn8B,KAAKm8B,iBAAiB4M,eAAiB/oC,KAAKm8B,iBAAiB4M,cAAcC,YAC7FhpC,KAAKm8B,iBAAiB4M,cAAcC,YAExCn5B,OALI,MAYf8oB,EAAW55B,UAAUyZ,eAAiB,SAAUC,GAE5C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBC,MAE9B3Y,KAAKggC,6BAA+BhgC,KAAKggC,6BAA6BiJ,iBAAmBjpC,KAAK8lB,IAAIojB,oBAO7GvQ,EAAW55B,UAAU6Z,gBAAkB,SAAUH,GAE7C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBG,OAE9B7Y,KAAKggC,6BAA+BhgC,KAAKggC,6BAA6BmJ,kBAAoBnpC,KAAK8lB,IAAIsjB,qBAQ9GzQ,EAAW55B,UAAUqS,eAAiB,SAAUC,EAAsBC,GAClE,OAAOqnB,EAAW0Q,cAAch4B,EAAsBC,IAM1DqnB,EAAW55B,UAAUuqC,cAAgB,SAAUlB,IACc,IAArDpoC,KAAK+5B,mBAAmB7V,QAAQkkB,KAGpCpoC,KAAK+5B,mBAAmB53B,KAAKimC,GACxBpoC,KAAK85B,0BACN95B,KAAK85B,yBAA0B,EAC/B95B,KAAK0oC,qBAAuB1oC,KAAKqoC,YAAY/J,KAAKt+B,MAClDA,KAAKyoC,cAAgBzoC,KAAKoR,eAAepR,KAAK0oC,qBAAsB1oC,KAAK2oC,oBAUjFhQ,EAAW55B,UAAU8S,MAAQ,SAAUC,EAAOC,EAAYC,EAAOC,QAC7C,IAAZA,IAAsBA,GAAU,GACpC,IAAIs3B,EAAuBvpC,KAAKwpC,qBAAqBD,qBACrDvpC,KAAKwpC,qBAAqBD,sBAAuB,EACjDvpC,KAAKypC,cACLzpC,KAAKwpC,qBAAqBD,qBAAuBA,EACjD,IAAIprB,EAAO,EACPpM,GAAcD,IACd9R,KAAK8lB,IAAI4jB,WAAW53B,EAAMjM,EAAGiM,EAAMhM,EAAGgM,EAAM/L,OAAelD,IAAZiP,EAAM1L,EAAkB0L,EAAM1L,EAAI,GACjF+X,GAAQne,KAAK8lB,IAAI6jB,kBAEjB33B,IACIhS,KAAKkS,uBACLlS,KAAKigB,mBAAmB7E,UAAYpb,KAAK8lB,IAAI8jB,OAC7C5pC,KAAK8lB,IAAI+jB,WAAW,IAGpB7pC,KAAK8lB,IAAI+jB,WAAW,GAExB1rB,GAAQne,KAAK8lB,IAAIgkB,kBAEjB73B,IACAjS,KAAK8lB,IAAIikB,aAAa,GACtB5rB,GAAQne,KAAK8lB,IAAIkkB,oBAErBhqC,KAAK8lB,IAAIjU,MAAMsM,IASnBwa,EAAW55B,UAAUkrC,UAAY,SAAUlnC,EAAGC,EAAG2V,EAAOE,GAChD9V,IAAM/C,KAAK67B,gBAAgB94B,GAAKC,IAAMhD,KAAK67B,gBAAgB74B,GAAK2V,IAAU3Y,KAAK67B,gBAAgB14B,GAAK0V,IAAW7Y,KAAK67B,gBAAgBx4B,IACpIrD,KAAK67B,gBAAgB94B,EAAIA,EACzB/C,KAAK67B,gBAAgB74B,EAAIA,EACzBhD,KAAK67B,gBAAgB14B,EAAIwV,EACzB3Y,KAAK67B,gBAAgBx4B,EAAIwV,EACzB7Y,KAAK8lB,IAAI/M,SAAShW,EAAGC,EAAG2V,EAAOE,KASvC8f,EAAW55B,UAAU+Z,YAAc,SAAUC,EAAUC,EAAeC,GAClE,IAAIN,EAAQK,GAAiBhZ,KAAKwY,iBAC9BK,EAASI,GAAkBjZ,KAAK4Y,kBAChC7V,EAAIgW,EAAShW,GAAK,EAClBC,EAAI+V,EAAS/V,GAAK,EACtBhD,KAAKkZ,gBAAkBH,EACvB/Y,KAAKiqC,UAAUlnC,EAAI4V,EAAO3V,EAAI6V,EAAQF,EAAQI,EAASJ,MAAOE,EAASE,EAASF,SAKpF8f,EAAW55B,UAAUwpC,WAAa,aAIlC5P,EAAW55B,UAAUypC,SAAW,WAExBxoC,KAAK45B,QACL55B,KAAKkqC,mBAETlqC,KAAKu5B,YAMTZ,EAAW55B,UAAUqR,OAAS,SAAU+5B,GAEpC,IAAIxxB,EACAE,EAEJ,QAJqB,IAAjBsxB,IAA2BA,GAAe,GAI1CnqC,KAAKs7B,oBAAqB,CAC1B,IAAI8O,GAAqB,WAAwBv6B,OAAOK,kBAA0B,EAC9EgvB,EAAmBl/B,KAAKg8B,iBAAiBkD,kBAAoBkL,EACjEpqC,KAAKmQ,sBAAwBnQ,KAAKs7B,oBAAsB,EAAM7Z,KAAK0d,IAAID,EAAkBkL,GAAsB,GAE/G,WACAzxB,EAAQ3Y,KAAKm8B,iBAAmBn8B,KAAKm8B,iBAAiBkO,aAAerqC,KAAKm8B,iBAAiBxjB,MAAQ9I,OAAOy6B,WAC1GzxB,EAAS7Y,KAAKm8B,iBAAmBn8B,KAAKm8B,iBAAiBoO,cAAgBvqC,KAAKm8B,iBAAiBtjB,OAAShJ,OAAO26B,cAG7G7xB,EAAQ3Y,KAAKm8B,iBAAmBn8B,KAAKm8B,iBAAiBxjB,MAAQ,IAC9DE,EAAS7Y,KAAKm8B,iBAAmBn8B,KAAKm8B,iBAAiBtjB,OAAS,KAEpE7Y,KAAKyqC,QAAQ9xB,EAAQ3Y,KAAKmQ,sBAAuB0I,EAAS7Y,KAAKmQ,sBAAuBg6B,IAS1FxR,EAAW55B,UAAU0rC,QAAU,SAAU9xB,EAAOE,EAAQsxB,GAEpD,YADqB,IAAjBA,IAA2BA,GAAe,KACzCnqC,KAAKm8B,mBAGVxjB,GAAgB,EAChBE,GAAkB,KACbsxB,GAAgBnqC,KAAKm8B,iBAAiBxjB,QAAUA,GAAS3Y,KAAKm8B,iBAAiBtjB,SAAWA,KAG/F7Y,KAAKm8B,iBAAiBxjB,MAAQA,EAC9B3Y,KAAKm8B,iBAAiBtjB,OAASA,GACxB,KAYX8f,EAAW55B,UAAUgrB,gBAAkB,SAAUtJ,EAASuJ,EAAWhR,EAAeC,EAAgBgR,EAAyBygB,EAAUC,GACnI,IAAI1qC,EAAI0Z,EAAI+c,EAAIC,EAAIC,OACF,IAAd5M,IAAwBA,EAAY,QACvB,IAAb0gB,IAAuBA,EAAW,QACxB,IAAVC,IAAoBA,EAAQ,GAChC,IAAIC,EAAiBnqB,EACjBzgB,KAAK0Y,sBACL1Y,KAAKkqB,kBAAkBlqB,KAAK0Y,sBAEhC1Y,KAAK0Y,qBAAuB+H,EAC5BzgB,KAAKwR,wBAAwBo5B,EAAeC,iBAAmBD,EAAeC,iBAAmBD,EAAexjC,cAChH,IAAI0jC,EAAK9qC,KAAK8lB,IACVrF,EAAQ0C,UACR2nB,EAAGC,wBAAwBD,EAAG3F,YAAa2F,EAAGE,kBAA+D,QAA3C/qC,EAAKwgB,EAAQA,QAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,mBAAoBspB,EAAUC,GAE1KlqB,EAAQja,QACbskC,EAAGG,qBAAqBH,EAAG3F,YAAa2F,EAAGE,kBAAmBF,EAAGI,4BAA8BlhB,EAAuD,QAA3CrQ,EAAK8G,EAAQA,QAAQO,wBAAqC,IAAPrH,OAAgB,EAASA,EAAGyH,mBAAoBspB,GAElN,IAAI7f,EAAsBpK,EAAQ8U,qBAClC,GAAI1K,EAAqB,CACrB,IAAIsgB,EAAa1qB,EAAQ0U,gCAAkC2V,EAAGM,yBAA2BN,EAAGO,iBACxF5qB,EAAQ0C,UACR2nB,EAAGC,wBAAwBD,EAAG3F,YAAagG,EAA4D,QAA/CzU,EAAK7L,EAAoB7J,wBAAqC,IAAP0V,OAAgB,EAASA,EAAGtV,mBAAoBspB,EAAUC,GAEpKlqB,EAAQja,OACbskC,EAAGG,qBAAqBH,EAAG3F,YAAagG,EAAYL,EAAGI,4BAA8BlhB,EAA2D,QAA/C2M,EAAK9L,EAAoB7J,wBAAqC,IAAP2V,OAAgB,EAASA,EAAGvV,mBAAoBspB,GAGxMI,EAAGG,qBAAqBH,EAAG3F,YAAagG,EAAYL,EAAGQ,WAA4D,QAA/C1U,EAAK/L,EAAoB7J,wBAAqC,IAAP4V,OAAgB,EAASA,EAAGxV,mBAAoBspB,GAG/K1qC,KAAKkZ,kBAAoB+Q,EACzBjqB,KAAK8Y,YAAY9Y,KAAKkZ,gBAAiBF,EAAeC,IAGjDD,IACDA,EAAgByH,EAAQ9H,MACpB+xB,IACA1xB,GAAgCyI,KAAK8pB,IAAI,EAAGb,KAG/CzxB,IACDA,EAAiBwH,EAAQ5H,OACrB6xB,IACAzxB,GAAkCwI,KAAK8pB,IAAI,EAAGb,KAGtD1qC,KAAKiqC,UAAU,EAAG,EAAGjxB,EAAeC,IAExCjZ,KAAK2f,cAYTgZ,EAAW55B,UAAUqa,SAAW,SAAUC,EAASC,EAASC,EAAOC,EAAaC,EAAexH,EAASyH,GACpG,IAAIzZ,EAAI0Z,OACQ,IAAZL,IAAsBA,EAAU,QAChB,IAAhBE,IAA0BA,GAAc,QACvB,IAAjBE,IAA2BA,EAAe,IAE1C1Z,KAAKigB,mBAAmBurB,OAASnyB,GAAWE,KAC5CvZ,KAAKigB,mBAAmBurB,KAAOnyB,GAGnC,IAAIoyB,EAAgG,QAAnF9xB,EAAmC,QAA7B1Z,EAAKD,KAAKyZ,qBAAkC,IAAPxZ,EAAgBA,EAAKwZ,SAAkC,IAAPE,GAAgBA,EAAa3Z,KAAK8lB,IAAI4lB,KAAO1rC,KAAK8lB,IAAI6lB,OAC9J3rC,KAAKigB,mBAAmBwrB,WAAaA,GAAYlyB,KACjDvZ,KAAKigB,mBAAmBwrB,SAAWA,GAGvCzrC,KAAKma,WAAWb,GAChBtZ,KAAKsa,gBAAgBZ,GAErB,IAAIkyB,EAAYpyB,EAAcxZ,KAAK8lB,IAAI+lB,GAAK7rC,KAAK8lB,IAAIgmB,KACjD9rC,KAAKigB,mBAAmB2rB,YAAcA,GAAaryB,KACnDvZ,KAAKigB,mBAAmB2rB,UAAYA,GAExC5rC,KAAK+f,sBAAsBgsB,gBAAkB95B,GAMjD0mB,EAAW55B,UAAUob,WAAa,SAAU9a,GACxCW,KAAKigB,mBAAmB3G,QAAUtZ,KAAKkS,uBAAyB7S,EAAQA,GAM5Es5B,EAAW55B,UAAUsb,WAAa,WAC9B,IAAIf,EAAUtZ,KAAKigB,mBAAmB3G,QACtC,OAAOtZ,KAAKkS,uBAAyBoH,EAAUA,GAMnDqf,EAAW55B,UAAUub,gBAAkB,SAAUjb,GAC7CW,KAAKigB,mBAAmBvG,aAAe1Z,KAAKkS,uBAAyB7S,EAAQA,GAMjFs5B,EAAW55B,UAAUyb,gBAAkB,WACnC,IAAId,EAAe1Z,KAAKigB,mBAAmBvG,aAC3C,OAAO1Z,KAAKkS,uBAAyBwH,EAAeA,GAMxDif,EAAW55B,UAAUyS,wBAA0B,SAAU1K,GACjD9G,KAAKyR,sBAAwB3K,IAC7B9G,KAAK8lB,IAAIiE,gBAAgB/pB,KAAK8lB,IAAIqf,YAAar+B,GAC/C9G,KAAKyR,oBAAsB3K,IAInC6xB,EAAW55B,UAAUitC,wCAA0C,WAC3D,OAAoC,OAA7BhsC,KAAKyR,qBAMhBknB,EAAW55B,UAAUktC,gBAAkB,SAAUxrB,GAC7CzgB,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAIwlB,WAAY7qB,GAAS,GACxDzgB,KAAK8lB,IAAIomB,eAAelsC,KAAK8lB,IAAIwlB,YACjCtrC,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAIwlB,WAAY,OAQnD3S,EAAW55B,UAAUmrB,kBAAoB,SAAUzJ,EAAS0J,EAAwBC,GAChF,IAAInqB,OAC2B,IAA3BkqB,IAAqCA,GAAyB,GAClE,IAAIygB,EAAiBnqB,EACrBzgB,KAAK0Y,qBAAuB,KAE5B,IAAIoyB,EAAK9qC,KAAK8lB,IACd,GAAI8kB,EAAeC,iBAAkB,CACjC,GAAIpqB,EAAQla,QAGR,YADAvG,KAAKmsC,sCAAsC1rB,EAAS0J,EAAwBC,GAGhF0gB,EAAG/gB,gBAAgB+gB,EAAGsB,iBAAkBxB,EAAeC,kBACvDC,EAAG/gB,gBAAgB+gB,EAAG5F,iBAAkB0F,EAAexjC,cACvD0jC,EAAGuB,gBAAgB,EAAG,EAAG5rB,EAAQ9H,MAAO8H,EAAQ5H,OAAQ,EAAG,EAAG4H,EAAQ9H,MAAO8H,EAAQ5H,OAAQiyB,EAAGnB,iBAAkBmB,EAAGwB,WAEzF,QAA1BrsC,EAAKwgB,EAAQA,eAA4B,IAAPxgB,OAAgB,EAASA,EAAGshB,kBAAqB4I,GAA2B1J,EAAQja,QACxHxG,KAAKisC,gBAAgBxrB,EAAQA,SAE7B2J,IACIwgB,EAAeC,kBAEf7qC,KAAKwR,wBAAwBo5B,EAAexjC,cAEhDgjB,KAEJpqB,KAAKwR,wBAAwB,OAKjCmnB,EAAW55B,UAAUmrC,iBAAmB,WACpClqC,KAAK8lB,IAAIymB,SAKb5T,EAAW55B,UAAUytC,0BAA4B,WACzCxsC,KAAK0Y,qBACL1Y,KAAKkqB,kBAAkBlqB,KAAK0Y,sBAG5B1Y,KAAKwR,wBAAwB,MAE7BxR,KAAKkZ,iBACLlZ,KAAK8Y,YAAY9Y,KAAKkZ,iBAE1BlZ,KAAK2f,cAITgZ,EAAW55B,UAAU0tC,0BAA4B,WAC7CzsC,KAAK0sC,gBAAgB,MACrB1sC,KAAKmgB,qBAAuB,MAOhCwY,EAAW55B,UAAUgU,mBAAqB,SAAUvD,GAChD,OAAOxP,KAAK2sC,oBAAoBn9B,EAAMxP,KAAK8lB,IAAI8mB,cAEnDjU,EAAW55B,UAAU4tC,oBAAsB,SAAUn9B,EAAMq9B,GACvD,IAAIC,EAAM9sC,KAAK8lB,IAAIinB,eACnB,IAAKD,EACD,MAAM,IAAIjsC,MAAM,kCAEpB,IAAImsC,EAAa,IAAI,IAAgBF,GAUrC,OATA9sC,KAAK0sC,gBAAgBM,GACjBx9B,aAAgB9H,MAChB1H,KAAK8lB,IAAImnB,WAAWjtC,KAAK8lB,IAAIonB,aAAc,IAAI/5B,aAAa3D,GAAOq9B,GAGnE7sC,KAAK8lB,IAAImnB,WAAWjtC,KAAK8lB,IAAIonB,aAAc19B,EAAMq9B,GAErD7sC,KAAKysC,4BACLO,EAAWv6B,WAAa,EACjBu6B,GAOXrU,EAAW55B,UAAUsrB,0BAA4B,SAAU7a,GACvD,OAAOxP,KAAK2sC,oBAAoBn9B,EAAMxP,KAAK8lB,IAAIqnB,eAEnDxU,EAAW55B,UAAUquC,yBAA2B,WAC5CptC,KAAKqtC,gBAAgB,MACrBrtC,KAAKogB,mBAAqB,MAQ9BuY,EAAW55B,UAAUqT,kBAAoB,SAAUC,EAASi7B,GACxD,IAAIR,EAAM9sC,KAAK8lB,IAAIinB,eACfC,EAAa,IAAI,IAAgBF,GACrC,IAAKA,EACD,MAAM,IAAIjsC,MAAM,iCAEpBb,KAAKqtC,gBAAgBL,GACrB,IAAIx9B,EAAOxP,KAAKuS,oBAAoBF,GAKpC,OAJArS,KAAK8lB,IAAImnB,WAAWjtC,KAAK8lB,IAAIynB,qBAAsB/9B,EAAM89B,EAAYttC,KAAK8lB,IAAIqnB,aAAentC,KAAK8lB,IAAI8mB,aACtG5sC,KAAKotC,2BACLJ,EAAWv6B,WAAa,EACxBu6B,EAAWt6B,SAAsC,IAA3BlD,EAAKmD,kBACpBq6B,GAEXrU,EAAW55B,UAAUwT,oBAAsB,SAAUF,GAEjD,GAAwB,IADFA,EAAQM,kBAE1B,OAAON,EAGX,GAAIrS,KAAK8K,MAAMmB,YAAa,CACxB,GAAIoG,aAAmBm7B,YACnB,OAAOn7B,EAIP,IAAK,IAAI9Q,EAAQ,EAAGA,EAAQ8Q,EAAQtQ,OAAQR,IACxC,GAAI8Q,EAAQ9Q,IAAU,MAClB,OAAO,IAAIisC,YAAYn7B,GAG/B,OAAO,IAAIo7B,YAAYp7B,GAI/B,OAAO,IAAIo7B,YAAYp7B,IAM3BsmB,EAAW55B,UAAU2tC,gBAAkB,SAAUl6B,GACxCxS,KAAKg7B,sBACNh7B,KAAK0tC,2BAET1tC,KAAK2tC,YAAYn7B,EAAQxS,KAAK8lB,IAAIonB,eAQtCvU,EAAW55B,UAAU2C,iBAAmB,SAAUmT,EAAiBmD,EAAWzW,GAC1E,IAAI8V,EAAUxC,EAAgBwC,QAC1Bu2B,EAAkB5tC,KAAK8lB,IAAI+nB,qBAAqBx2B,EAASW,GAC7DhY,KAAK8lB,IAAIgoB,oBAAoBz2B,EAASu2B,EAAiBrsC,IAG3Do3B,EAAW55B,UAAUsuC,gBAAkB,SAAU76B,GACxCxS,KAAKg7B,sBACNh7B,KAAK0tC,2BAET1tC,KAAK2tC,YAAYn7B,EAAQxS,KAAK8lB,IAAIynB,uBAEtC5U,EAAW55B,UAAU4uC,YAAc,SAAUn7B,EAAQwhB,IAC7Ch0B,KAAKg7B,sBAAwBh7B,KAAK26B,oBAAoB3G,KAAYxhB,KAClExS,KAAK8lB,IAAIioB,WAAW/Z,EAAQxhB,EAASA,EAAO4O,mBAAqB,MACjEphB,KAAK26B,oBAAoB3G,GAAUxhB,IAO3CmmB,EAAW55B,UAAUivC,kBAAoB,SAAUx+B,GAC/CxP,KAAK8lB,IAAImoB,cAAcjuC,KAAK8lB,IAAIonB,aAAc,EAAG19B,IAErDmpB,EAAW55B,UAAUmvC,qBAAuB,SAAU17B,EAAQ27B,EAAM1nC,EAAM0N,EAAMC,EAAYg6B,EAAQ7jB,GAChG,IAAI8jB,EAAUruC,KAAK66B,uBAAuBsT,GAC1C,GAAKE,EAAL,CAGA,IAAIprC,GAAU,EACTorC,EAAQC,QAYLD,EAAQ77B,SAAWA,IACnB67B,EAAQ77B,OAASA,EACjBvP,GAAU,GAEVorC,EAAQ5nC,OAASA,IACjB4nC,EAAQ5nC,KAAOA,EACfxD,GAAU,GAEVorC,EAAQl6B,OAASA,IACjBk6B,EAAQl6B,KAAOA,EACflR,GAAU,GAEVorC,EAAQj6B,aAAeA,IACvBi6B,EAAQj6B,WAAaA,EACrBnR,GAAU,GAEVorC,EAAQD,SAAWA,IACnBC,EAAQD,OAASA,EACjBnrC,GAAU,GAEVorC,EAAQ9jB,SAAWA,IACnB8jB,EAAQ9jB,OAASA,EACjBtnB,GAAU,KAjCdA,GAAU,EACVorC,EAAQC,QAAS,EACjBD,EAAQ9sC,MAAQ4sC,EAChBE,EAAQ5nC,KAAOA,EACf4nC,EAAQl6B,KAAOA,EACfk6B,EAAQj6B,WAAaA,EACrBi6B,EAAQD,OAASA,EACjBC,EAAQ9jB,OAASA,EACjB8jB,EAAQ77B,OAASA,IA4BjBvP,GAAWjD,KAAKg7B,wBAChBh7B,KAAK0sC,gBAAgBl6B,GACrBxS,KAAK8lB,IAAIyoB,oBAAoBJ,EAAM1nC,EAAM0N,EAAMC,EAAYg6B,EAAQ7jB,MAO3EoO,EAAW55B,UAAUyvC,0BAA4B,SAAUh7B,GACpC,MAAfA,GAGAxT,KAAKogB,qBAAuB5M,IAC5BxT,KAAKogB,mBAAqB5M,EAC1BxT,KAAKqtC,gBAAgB75B,GACrBxT,KAAK06B,yBAA2BlnB,EAAYd,WAGpDimB,EAAW55B,UAAU0vC,6BAA+B,SAAUl7B,EAAexS,EAAQ2tC,GACjF,IAAIptC,EAAaP,EAAO2S,qBACnB1T,KAAKg7B,sBACNh7B,KAAK0tC,2BAET1tC,KAAK2uC,sBACL,IAAK,IAAIptC,EAAQ,EAAGA,EAAQD,EAAWS,OAAQR,IAAS,CACpD,IAAIqtC,EAAQ7tC,EAAO6S,qBAAqBrS,GACxC,GAAIqtC,GAAS,EAAG,CACZ,IAAIC,EAAKvtC,EAAWC,GAChBsS,EAAe,KAOnB,GANI66B,IACA76B,EAAe66B,EAAsBG,IAEpCh7B,IACDA,EAAeN,EAAcs7B,KAE5Bh7B,EACD,SAEJ7T,KAAK8lB,IAAIgpB,wBAAwBF,GAC5B5uC,KAAKg7B,uBACNh7B,KAAKy6B,2BAA2BmU,IAAS,GAE7C,IAAIp8B,EAASqB,EAAaC,YACtBtB,IACAxS,KAAKkuC,qBAAqB17B,EAAQo8B,EAAO/6B,EAAaI,UAAWJ,EAAaM,KAAMN,EAAaO,WAAYP,EAAaG,WAAYH,EAAaf,YAC/Ie,EAAak7B,mBACb/uC,KAAK8lB,IAAImgB,oBAAoB2I,EAAO/6B,EAAaQ,sBAC5CrU,KAAKg7B,uBACNh7B,KAAK86B,0BAA0B34B,KAAKysC,GACpC5uC,KAAK+6B,wBAAwB54B,KAAKqQ,SAgB1DmmB,EAAW55B,UAAU0V,wBAA0B,SAAUlB,EAAeC,EAAazS,EAAQ2tC,GACzF,IAAIM,EAAMhvC,KAAK8lB,IAAIvR,oBAQnB,OAPAvU,KAAKg7B,sBAAuB,EAC5Bh7B,KAAK8lB,IAAI0f,gBAAgBwJ,GACzBhvC,KAAKi7B,2BAA4B,EACjCj7B,KAAKyuC,6BAA6Bl7B,EAAexS,EAAQ2tC,GACzD1uC,KAAKqtC,gBAAgB75B,GACrBxT,KAAKg7B,sBAAuB,EAC5Bh7B,KAAK8lB,IAAI0f,gBAAgB,MAClBwJ,GAQXrW,EAAW55B,UAAUyV,sBAAwB,SAAU1H,EAAmB0G,GAClExT,KAAKivC,2BAA6BniC,IAClC9M,KAAKivC,yBAA2BniC,EAChC9M,KAAK8lB,IAAI0f,gBAAgB14B,GACzB9M,KAAKmgB,qBAAuB,KAC5BngB,KAAKogB,mBAAqB,KAC1BpgB,KAAK06B,yBAA0C,MAAflnB,GAAuBA,EAAYd,SACnE1S,KAAKi7B,2BAA4B,IAWzCtC,EAAW55B,UAAUmwC,oBAAsB,SAAUr7B,EAAcL,EAAa27B,EAAmBC,EAAkBruC,GACjH,GAAIf,KAAKmgB,uBAAyBtM,GAAgB7T,KAAKqgB,gCAAkCtf,EAAQ,CAC7Ff,KAAKmgB,qBAAuBtM,EAC5B7T,KAAKqgB,8BAAgCtf,EACrC,IAAIsuC,EAAkBtuC,EAAOuuC,qBAC7BtvC,KAAK0tC,2BACL1tC,KAAK2uC,sBAEL,IADA,IAAIpkB,EAAS,EACJhpB,EAAQ,EAAGA,EAAQ8tC,EAAiB9tC,IACzC,GAAIA,EAAQ4tC,EAAkBptC,OAAQ,CAClC,IAAI6sC,EAAQ7tC,EAAO6S,qBAAqBrS,GACpCqtC,GAAS,IACT5uC,KAAK8lB,IAAIgpB,wBAAwBF,GACjC5uC,KAAKy6B,2BAA2BmU,IAAS,EACzC5uC,KAAKkuC,qBAAqBr6B,EAAc+6B,EAAOO,EAAkB5tC,GAAQvB,KAAK8lB,IAAIypB,OAAO,EAAOH,EAAkB7kB,IAEtHA,GAAqC,EAA3B4kB,EAAkB5tC,IAIxCvB,KAAKwuC,0BAA0Bh7B,IAEnCmlB,EAAW55B,UAAU2uC,yBAA2B,WACvC1tC,KAAKivC,2BAGVjvC,KAAKivC,yBAA2B,KAChCjvC,KAAK8lB,IAAI0f,gBAAgB,QAS7B7M,EAAW55B,UAAUuV,YAAc,SAAUf,EAAeC,EAAazS,EAAQ2tC,GACzE1uC,KAAKmgB,uBAAyB5M,GAAiBvT,KAAKqgB,gCAAkCtf,IACtFf,KAAKmgB,qBAAuB5M,EAC5BvT,KAAKqgB,8BAAgCtf,EACrCf,KAAKyuC,6BAA6Bl7B,EAAexS,EAAQ2tC,IAE7D1uC,KAAKwuC,0BAA0Bh7B,IAKnCmlB,EAAW55B,UAAUywC,yBAA2B,WAE5C,IADA,IAAIC,EACK3a,EAAI,EAAG4a,EAAK1vC,KAAK86B,0BAA0B/4B,OAAQ+yB,EAAI4a,EAAI5a,IAAK,CACrE,IAAI6a,EAAkB3vC,KAAK+6B,wBAAwBjG,GAC/C2a,GAAeE,GAAmBA,EAAgBl9B,aAClDg9B,EAAcE,EACd3vC,KAAK0sC,gBAAgBiD,IAEzB,IAAIC,EAAiB5vC,KAAK86B,0BAA0BhG,GACpD90B,KAAK8lB,IAAImgB,oBAAoB2J,EAAgB,GAEjD5vC,KAAK+6B,wBAAwBh5B,OAAS,EACtC/B,KAAK86B,0BAA0B/4B,OAAS,GAM5C42B,EAAW55B,UAAU6V,yBAA2B,SAAUo6B,GACtDhvC,KAAK8lB,IAAI4f,kBAAkBsJ,IAM/BrW,EAAW55B,UAAU8wC,eAAiB,SAAUr9B,GAE5C,OADAA,EAAOC,aACmB,IAAtBD,EAAOC,aACPzS,KAAK8sB,cAActa,IACZ,IAIfmmB,EAAW55B,UAAU+tB,cAAgB,SAAUta,GAC3CxS,KAAK8lB,IAAIgqB,aAAat9B,EAAO4O,qBAQjCuX,EAAW55B,UAAUgxC,6BAA+B,SAAUJ,EAAiBngC,EAAMwgC,GAKjF,GAJAhwC,KAAK0sC,gBAAgBiD,GACjBngC,GACAxP,KAAK8lB,IAAImoB,cAAcjuC,KAAK8lB,IAAIonB,aAAc,EAAG19B,QAEpB3M,IAA7BmtC,EAAgB,GAAGzuC,MACnBvB,KAAKiwC,oBAAoBN,EAAiBK,GAAiB,QAG3D,IAAK,IAAIzuC,EAAQ,EAAGA,EAAQ,EAAGA,IAAS,CACpC,IAAIquC,EAAiBI,EAAgBzuC,GAChCvB,KAAKy6B,2BAA2BmV,KACjC5vC,KAAK8lB,IAAIgpB,wBAAwBc,GACjC5vC,KAAKy6B,2BAA2BmV,IAAkB,GAEtD5vC,KAAKkuC,qBAAqByB,EAAiBC,EAAgB,EAAG5vC,KAAK8lB,IAAIypB,OAAO,EAAO,GAAY,GAARhuC,GACzFvB,KAAK8lB,IAAImgB,oBAAoB2J,EAAgB,GAC7C5vC,KAAK86B,0BAA0B34B,KAAKytC,GACpC5vC,KAAK+6B,wBAAwB54B,KAAKwtC,KAU9ChX,EAAW55B,UAAUkxC,oBAAsB,SAAUN,EAAiBO,EAAgBC,QAC5D,IAAlBA,IAA4BA,GAAgB,GAChDnwC,KAAK0sC,gBAAgBiD,GACrB,IAAIvB,EAAS,EACb,GAAI+B,EACA,IAAK,IAAIrb,EAAI,EAAGA,EAAIob,EAAenuC,OAAQ+yB,IAAK,CAE5CsZ,GAA6B,GADzBS,EAAKqB,EAAepb,IACXsb,cAGrB,IAAStb,EAAI,EAAGA,EAAIob,EAAenuC,OAAQ+yB,IAAK,CAC5C,IAAI+Z,OACahsC,KADbgsC,EAAKqB,EAAepb,IACjBvzB,QACHstC,EAAGttC,MAAQvB,KAAKqY,eAAeg4B,2BAA2BxB,EAAGyB,gBAE7DzB,EAAGttC,MAAQ,IAGVvB,KAAKy6B,2BAA2BoU,EAAGttC,SACpCvB,KAAK8lB,IAAIgpB,wBAAwBD,EAAGttC,OACpCvB,KAAKy6B,2BAA2BoU,EAAGttC,QAAS,GAEhDvB,KAAKkuC,qBAAqByB,EAAiBd,EAAGttC,MAAOstC,EAAGuB,cAAevB,EAAG0B,eAAiBvwC,KAAK8lB,IAAIypB,MAAOV,EAAGz6B,aAAc,EAAOg6B,EAAQS,EAAGtkB,QAC9IvqB,KAAK8lB,IAAImgB,oBAAoB4I,EAAGttC,WAAsBsB,IAAfgsC,EAAG2B,QAAwB,EAAI3B,EAAG2B,SACzExwC,KAAK86B,0BAA0B34B,KAAK0sC,EAAGttC,OACvCvB,KAAK+6B,wBAAwB54B,KAAKwtC,MAO1ChX,EAAW55B,UAAU0xC,+BAAiC,SAAUvuC,GAC5D,GAAKlC,KAAKqY,eAAV,CAGA,IAAIq4B,EAAoB1wC,KAAKqY,eAAeg4B,2BAA2BnuC,GACvElC,KAAK2wC,yBAAyBD,KAMlC/X,EAAW55B,UAAU4xC,yBAA2B,SAAUD,GAGtD,IAFA,IACInvC,EADAqvC,GAAc,GAE8D,KAAxErvC,EAAQvB,KAAK86B,0BAA0B5W,QAAQwsB,KACnD1wC,KAAK86B,0BAA0B74B,OAAOV,EAAO,GAC7CvB,KAAK+6B,wBAAwB94B,OAAOV,EAAO,GAC3CqvC,GAAc,EACdrvC,EAAQvB,KAAK86B,0BAA0B5W,QAAQwsB,GAE/CE,IACA5wC,KAAK8lB,IAAImgB,oBAAoByK,EAAmB,GAChD1wC,KAAK6wC,wBAAwBH,KAOrC/X,EAAW55B,UAAU8xC,wBAA0B,SAAUH,GACrD1wC,KAAK8lB,IAAIgrB,yBAAyBJ,GAClC1wC,KAAKy6B,2BAA2BiW,IAAqB,EACrD1wC,KAAK66B,uBAAuB6V,GAAmBpC,QAAS,GAS5D3V,EAAW55B,UAAUo0B,KAAO,SAAUC,EAAcle,EAAYC,EAAYC,GACxEpV,KAAKgV,iBAAiBoe,EAAe,EAAI,EAAGle,EAAYC,EAAYC,IAQxEujB,EAAW55B,UAAUgyC,gBAAkB,SAAUt7B,EAAeC,EAAeN,GAC3EpV,KAAKwV,eAAe,EAAGC,EAAeC,EAAeN,IASzDujB,EAAW55B,UAAUiyC,cAAgB,SAAU5d,EAAc3d,EAAeC,EAAeN,GACvFpV,KAAKwV,eAAe4d,EAAe,EAAI,EAAG3d,EAAeC,EAAeN,IAS5EujB,EAAW55B,UAAUiW,iBAAmB,SAAUC,EAAUC,EAAYC,EAAYC,GAEhFpV,KAAKypC,cACLzpC,KAAKixC,kBAEL,IAAIC,EAAWlxC,KAAKmxC,UAAUl8B,GAC1Bm8B,EAAcpxC,KAAK06B,yBAA2B16B,KAAK8lB,IAAIurB,aAAerxC,KAAK8lB,IAAIwrB,eAC/EC,EAAOvxC,KAAK06B,yBAA2B,EAAI,EAC3CtlB,EACApV,KAAK8lB,IAAIigB,sBAAsBmL,EAAU/7B,EAAYi8B,EAAal8B,EAAaq8B,EAAMn8B,GAGrFpV,KAAK8lB,IAAI0rB,aAAaN,EAAU/7B,EAAYi8B,EAAal8B,EAAaq8B,IAU9E5Y,EAAW55B,UAAUyW,eAAiB,SAAUP,EAAUQ,EAAeC,EAAeN,GAEpFpV,KAAKypC,cACLzpC,KAAKixC,kBACL,IAAIC,EAAWlxC,KAAKmxC,UAAUl8B,GAC1BG,EACApV,KAAK8lB,IAAI+f,oBAAoBqL,EAAUz7B,EAAeC,EAAeN,GAGrEpV,KAAK8lB,IAAI2rB,WAAWP,EAAUz7B,EAAeC,IAGrDijB,EAAW55B,UAAUoyC,UAAY,SAAUl8B,GACvC,OAAQA,GAEJ,KAAK,EAmBL,QACI,OAAOjV,KAAK8lB,IAAI4rB,UAlBpB,KAAK,EAKL,KAAK,EACD,OAAO1xC,KAAK8lB,IAAI6rB,OAJpB,KAAK,EAKL,KAAK,EACD,OAAO3xC,KAAK8lB,IAAI8rB,MACpB,KAAK,EACD,OAAO5xC,KAAK8lB,IAAI+rB,UACpB,KAAK,EACD,OAAO7xC,KAAK8lB,IAAIgsB,WACpB,KAAK,EACD,OAAO9xC,KAAK8lB,IAAIisB,eACpB,KAAK,EACD,OAAO/xC,KAAK8lB,IAAIksB,eAM5BrZ,EAAW55B,UAAUkyC,gBAAkB,aAQvCtY,EAAW55B,UAAUkzC,eAAiB,SAAUlxC,GAC5C,GAAIf,KAAKw6B,iBAAiBz5B,EAAOmxC,MAAO,QAC7BlyC,KAAKw6B,iBAAiBz5B,EAAOmxC,MACpC,IAAIr9B,EAAkB9T,EAAOmX,qBACzBrD,GACA7U,KAAK8X,uBAAuBjD,KAQxC8jB,EAAW55B,UAAU+Y,uBAAyB,SAAUjD,GACpD,IAAIs9B,EAAuBt9B,EACvBs9B,GAAwBA,EAAqB96B,UAC7C86B,EAAqB96B,QAAQub,yBAA2B,KACxD5yB,KAAK8lB,IAAIssB,cAAcD,EAAqB96B,WAIpDshB,EAAW55B,UAAUszC,kBAAoB,SAAU/7B,GAC/C,GAAIA,EAaA,OAZItW,KAAKo5B,gBACL9iB,EAA4B,mBAAI,UAGzBA,EAA4B,wBAEnCtW,KAAKkS,sBACLoE,EAAiC,wBAAI,UAG9BA,EAAiC,yBAK5C,IAAIg8B,EAAI,GAUR,OATItyC,KAAKo5B,kBACLkZ,GAAK,8BAELtyC,KAAKkS,wBACDogC,IACAA,GAAK,MAETA,GAAK,mCAEFA,GAiBf3Z,EAAW55B,UAAUwzC,aAAe,SAAUC,EAAUC,EAA0BC,EAAuBtxC,EAAUkV,EAASq8B,EAAW/xC,EAAY0O,EAASsjC,EAAiB3a,GACzK,IAAIh4B,OACmB,IAAnBg4B,IAA6BA,EAAiB,UAClD,IAAI4a,EAASL,EAASM,eAAiBN,EAASK,QAAUL,EAASO,aAAeP,EAASQ,cAAgBR,EACvGS,EAAWT,EAASU,iBAAmBV,EAASS,UAAYT,EAASW,eAAiBX,EAASY,gBAAkBZ,EACjHa,EAAgBrzC,KAAKqyC,oBACrBiB,EAA6G,QAA9FrzC,EAAKqW,QAAyCA,EAAUm8B,EAAyBn8B,eAA4B,IAAPrW,EAAgBA,EAAK,GAC1IozC,IACAC,GAAeD,GAEnB,IAAInxC,EAAO2wC,EAAS,IAAMI,EAAW,IAAMK,EAC3C,GAAItzC,KAAKw6B,iBAAiBt4B,GAAO,CAC7B,IAAIqxC,EAAiBvzC,KAAKw6B,iBAAiBt4B,GAI3C,OAHItB,GAAc2yC,EAAehzC,WAC7BK,EAAW2yC,GAERA,EAEX,IAAIxyC,EAAS,IAAI,IAAOyxC,EAAUC,EAA0BC,EAAuBtxC,EAAUpB,KAAMsW,EAASq8B,EAAW/xC,EAAY0O,EAASsjC,EAAiB1wC,EAAM+1B,GAEnK,OADAj4B,KAAKw6B,iBAAiBt4B,GAAQnB,EACvBA,GAGX43B,EAAW6a,mBAAqB,SAAUvyB,EAAQ3K,EAASm9B,GAEvD,YADsB,IAAlBA,IAA4BA,EAAgB,IACzCA,GAAiBn9B,EAAUA,EAAU,KAAO,IAAM2K,GAE7D0X,EAAW55B,UAAU20C,eAAiB,SAAUzyB,EAAQ9M,EAAMmC,EAASm9B,GACnE,OAAOzzC,KAAK2zC,kBAAkBhb,EAAW6a,mBAAmBvyB,EAAQ3K,EAASm9B,GAAgBt/B,IAEjGwkB,EAAW55B,UAAU40C,kBAAoB,SAAU1yB,EAAQ9M,GACvD,IAAI22B,EAAK9qC,KAAK8lB,IACV8tB,EAAS9I,EAAG+I,aAAsB,WAAT1/B,EAAoB22B,EAAGzE,cAAgByE,EAAGtE,iBACvE,IAAKoN,EAAQ,CAGT,IAFA,IAAI7sB,EAAQ+jB,EAAGgJ,SACXC,EAAYjJ,EAAGgJ,UACXC,EAAYjJ,EAAGlX,cAAgBkX,EAAGgJ,UACtC/sB,EAAQgtB,EAEZ,MAAM,IAAIlzC,MAAM,4CAA4C8J,OAAOwJ,EAAM,6BAA6BxJ,OAAOoc,EAAO,uBAAuBpc,OAAOmgC,EAAGkJ,gBAAiB,sBAAsBrpC,OAAO3K,KAAKk6B,kBAI5M,OAFA4Q,EAAGmJ,aAAaL,EAAQ3yB,GACxB6pB,EAAGoJ,cAAcN,GACVA,GAMXjb,EAAW55B,UAAUo1C,iBAAmB,SAAUP,GAC9C,OAAO5zC,KAAK8lB,IAAIsuB,gBAAgBR,IAWpCjb,EAAW55B,UAAUyX,uBAAyB,SAAU3B,EAAiBgC,EAAYC,EAAcC,EAASR,QACtE,IAA9BA,IAAwCA,EAA4B,MACxEQ,EAAUA,GAAW/W,KAAK8lB,IAC1B,IAAIuuB,EAAer0C,KAAK2zC,kBAAkB98B,EAAY,UAClDy9B,EAAiBt0C,KAAK2zC,kBAAkB78B,EAAc,YAC1D,OAAO9W,KAAKu0C,qBAAqB1/B,EAAiBw/B,EAAcC,EAAgBv9B,EAASR,IAY7FoiB,EAAW55B,UAAU0X,oBAAsB,SAAU5B,EAAiBgC,EAAYC,EAAcR,EAASS,EAASR,QAC5E,IAA9BA,IAAwCA,EAA4B,MACxEQ,EAAUA,GAAW/W,KAAK8lB,IAC1B,IAAI2tB,EAAgBzzC,KAAK4K,cAAgB,EAAI,qCAAuC,GAChFypC,EAAer0C,KAAK0zC,eAAe78B,EAAY,SAAUP,EAASm9B,GAClEa,EAAiBt0C,KAAK0zC,eAAe58B,EAAc,WAAYR,EAASm9B,GAC5E,OAAOzzC,KAAKu0C,qBAAqB1/B,EAAiBw/B,EAAcC,EAAgBv9B,EAASR,IAO7FoiB,EAAW55B,UAAUyY,iBAAmB,SAAUL,GAE9C,OAAOA,GAOXwhB,EAAW55B,UAAU6W,sBAAwB,SAAU4+B,GACnD,IAAI3/B,EAAkB,IAAI,IAK1B,OAJAA,EAAgBxU,OAASL,KACrBA,KAAK8K,MAAM60B,wBACX9qB,EAAgB4/B,oBAAqB,GAElC5/B,GAMX8jB,EAAW55B,UAAU8W,sBAAwB,aAO7C8iB,EAAW55B,UAAU+W,kBAAoB,aAGzC6iB,EAAW55B,UAAUw1C,qBAAuB,SAAU1/B,EAAiBw/B,EAAcC,EAAgBv9B,EAASR,QACxE,IAA9BA,IAAwCA,EAA4B,MACxE,IAAIm+B,EAAgB39B,EAAQO,gBAE5B,GADAzC,EAAgBwC,QAAUq9B,GACrBA,EACD,MAAM,IAAI7zC,MAAM,4BAWpB,OATAkW,EAAQ49B,aAAaD,EAAeL,GACpCt9B,EAAQ49B,aAAaD,EAAeJ,GACpCv9B,EAAQ69B,YAAYF,GACpB7/B,EAAgBkC,QAAUA,EAC1BlC,EAAgBw/B,aAAeA,EAC/Bx/B,EAAgBy/B,eAAiBA,EAC5Bz/B,EAAgB4/B,oBACjBz0C,KAAK60C,yBAAyBhgC,GAE3B6/B,GAEX/b,EAAW55B,UAAU81C,yBAA2B,SAAUhgC,GACtD,IAAIkC,EAAUlC,EAAgBkC,QAC1Bs9B,EAAex/B,EAAgBw/B,aAC/BC,EAAiBz/B,EAAgBy/B,eACjCj9B,EAAUxC,EAAgBwC,QAE9B,IADaN,EAAQ+9B,oBAAoBz9B,EAASN,EAAQg+B,aAC7C,CAIL,IAQIC,EAMJjuB,EAfJ,IAAK/mB,KAAK8lB,IAAImvB,mBAAmBZ,EAAcr0C,KAAK8lB,IAAIovB,gBAEpD,GADIF,EAAMh1C,KAAK8lB,IAAIqvB,iBAAiBd,GAGhC,MADAx/B,EAAgBugC,uBAAyBJ,EACnC,IAAIn0C,MAAM,iBAAmBm0C,GAI3C,IAAKh1C,KAAK8lB,IAAImvB,mBAAmBX,EAAgBt0C,KAAK8lB,IAAIovB,gBAEtD,GADIF,EAAMh1C,KAAK8lB,IAAIqvB,iBAAiBb,GAGhC,MADAz/B,EAAgBwgC,yBAA2BL,EACrC,IAAIn0C,MAAM,mBAAqBm0C,GAI7C,GADIjuB,EAAQhQ,EAAQu+B,kBAAkBj+B,GAGlC,MADAxC,EAAgB0gC,iBAAmBxuB,EAC7B,IAAIlmB,MAAMkmB,GAGxB,GAAI/mB,KAAKk5B,yBACLniB,EAAQy+B,gBAAgBn+B,IACRN,EAAQ+9B,oBAAoBz9B,EAASN,EAAQ0+B,mBAErD1uB,EAAQhQ,EAAQu+B,kBAAkBj+B,KAGlC,MADAxC,EAAgB6gC,uBAAyB3uB,EACnC,IAAIlmB,MAAMkmB,GAI5BhQ,EAAQ4+B,aAAatB,GACrBt9B,EAAQ4+B,aAAarB,GACrBz/B,EAAgBw/B,kBAAexxC,EAC/BgS,EAAgBy/B,oBAAiBzxC,EAC7BgS,EAAgBjU,aAChBiU,EAAgBjU,aAChBiU,EAAgBjU,gBAAaiC,IAgBrC81B,EAAW55B,UAAUgX,wBAA0B,SAAUlB,EAAiBmB,EAAkBC,EAAoBC,EAAaC,EAAqBC,EAAuBC,EAAeC,EAASC,EAA2B8mB,GACxN,IAAIuY,EAAsB/gC,EAEtB+gC,EAAoBv+B,QADpBnB,EAC8BlW,KAAKwW,uBAAuBo/B,EAAqB5/B,EAAkBC,OAAoBpT,EAAW0T,GAGlGvW,KAAKyW,oBAAoBm/B,EAAqB5/B,EAAkBC,EAAoBK,OAASzT,EAAW0T,GAE1Iq/B,EAAoBv+B,QAAQub,yBAA2Bvc,GAM3DsiB,EAAW55B,UAAU2X,0BAA4B,SAAU7B,GACvD,IAAIs9B,EAAuBt9B,EAC3B,QAAI7U,KAAK8lB,IAAIgvB,oBAAoB3C,EAAqB96B,QAASrX,KAAK8K,MAAM60B,sBAAsBkW,yBAC5F71C,KAAK60C,yBAAyB1C,IACvB,IASfxZ,EAAW55B,UAAU4X,qCAAuC,SAAU9B,EAAiB+B,GACnF,IAAIu7B,EAAuBt9B,EAC3B,GAAKs9B,EAAqBsC,mBAA1B,CAIA,IAAIqB,EAAa3D,EAAqBvxC,WAElCuxC,EAAqBvxC,WADrBk1C,EACkC,WAC9BA,IACAl/B,KAI8BA,OAXlCA,KAoBR+hB,EAAW55B,UAAU4C,YAAc,SAAUkT,EAAiB5T,GAG1D,IAFA,IAAI80C,EAAU,IAAIruC,MACdyqC,EAAuBt9B,EAClBtT,EAAQ,EAAGA,EAAQN,EAAcc,OAAQR,IAC9Cw0C,EAAQ5zC,KAAKnC,KAAK8lB,IAAIkwB,mBAAmB7D,EAAqB96B,QAASpW,EAAcM,KAEzF,OAAOw0C,GAQXpd,EAAW55B,UAAUsD,cAAgB,SAAUwS,EAAiBxT,GAG5D,IAFA,IAAI00C,EAAU,GACV5D,EAAuBt9B,EAClBtT,EAAQ,EAAGA,EAAQF,EAAgBU,OAAQR,IAChD,IACIw0C,EAAQ5zC,KAAKnC,KAAK8lB,IAAImwB,kBAAkB9D,EAAqB96B,QAAShW,EAAgBE,KAE1F,MAAOo9B,GACHoX,EAAQ5zC,MAAM,GAGtB,OAAO4zC,GAMXpd,EAAW55B,UAAU8zB,aAAe,SAAU9xB,IAC1CA,EAAoB,OAAXA,GAAmB,cAAsBA,GAAUA,EAAOA,OAASA,IAC7DA,IAAWf,KAAKqY,iBAG/BrY,KAAK+f,sBAAsBgsB,qBAAkBlpC,EAG7C7C,KAAKiY,aAAalX,GAClBf,KAAKqY,eAAiBtX,EAClBA,EAAO+xB,QACP/xB,EAAO+xB,OAAO/xB,GAEdA,EAAOgyB,mBACPhyB,EAAOgyB,kBAAkBzzB,gBAAgByB,KASjD43B,EAAW55B,UAAUuE,OAAS,SAAUzB,EAASxC,GAC7C,QAAKwC,IAGL7B,KAAK8lB,IAAIowB,UAAUr0C,EAASxC,IACrB,IASXs5B,EAAW55B,UAAUwE,QAAU,SAAU1B,EAASkB,EAAGC,GACjD,QAAKnB,IAGL7B,KAAK8lB,IAAIqwB,UAAUt0C,EAASkB,EAAGC,IACxB,IAUX21B,EAAW55B,UAAUyE,QAAU,SAAU3B,EAASkB,EAAGC,EAAGG,GACpD,QAAKtB,IAGL7B,KAAK8lB,IAAIswB,UAAUv0C,EAASkB,EAAGC,EAAGG,IAC3B,IAWXw1B,EAAW55B,UAAU0E,QAAU,SAAU5B,EAASkB,EAAGC,EAAGG,EAAGE,GACvD,QAAKxB,IAGL7B,KAAK8lB,IAAIuwB,UAAUx0C,EAASkB,EAAGC,EAAGG,EAAGE,IAC9B,IAQXs1B,EAAW55B,UAAU2E,YAAc,SAAU7B,EAAS8B,GAClD,QAAK9B,IAGL7B,KAAK8lB,IAAIwwB,WAAWz0C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAU6E,aAAe,SAAU/B,EAAS8B,GACnD,SAAK9B,GAAW8B,EAAM5B,OAAS,GAAM,KAGrC/B,KAAK8lB,IAAIywB,WAAW10C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAU8E,aAAe,SAAUhC,EAAS8B,GACnD,SAAK9B,GAAW8B,EAAM5B,OAAS,GAAM,KAGrC/B,KAAK8lB,IAAI0wB,WAAW30C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAU+E,aAAe,SAAUjC,EAAS8B,GACnD,SAAK9B,GAAW8B,EAAM5B,OAAS,GAAM,KAGrC/B,KAAK8lB,IAAI2wB,WAAW50C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAUoF,SAAW,SAAUtC,EAAS8B,GAC/C,QAAK9B,MAGD8B,EAAM5B,OAAS,KAGnB/B,KAAK8lB,IAAI4wB,WAAW70C,EAAS8B,IACtB,KAQXg1B,EAAW55B,UAAUqF,UAAY,SAAUvC,EAAS8B,GAChD,SAAK9B,GAAW8B,EAAM5B,OAAS,GAAM,KAGrC/B,KAAK8lB,IAAI6wB,WAAW90C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAUsF,UAAY,SAAUxC,EAAS8B,GAChD,SAAK9B,GAAW8B,EAAM5B,OAAS,GAAM,KAGrC/B,KAAK8lB,IAAI8wB,WAAW/0C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAUuF,UAAY,SAAUzC,EAAS8B,GAChD,SAAK9B,GAAW8B,EAAM5B,OAAS,GAAM,KAGrC/B,KAAK8lB,IAAI+wB,WAAWh1C,EAAS8B,IACtB,IAQXg1B,EAAW55B,UAAUwF,YAAc,SAAU1C,EAAS2C,GAClD,QAAK3C,IAGL7B,KAAK8lB,IAAIgxB,iBAAiBj1C,GAAS,EAAO2C,IACnC,IAQXm0B,EAAW55B,UAAU4F,aAAe,SAAU9C,EAASY,GACnD,QAAKZ,IAGL7B,KAAK8lB,IAAIixB,iBAAiBl1C,GAAS,EAAOY,IACnC,IAQXk2B,EAAW55B,UAAU6F,aAAe,SAAU/C,EAASY,GACnD,QAAKZ,IAGL7B,KAAK8lB,IAAIkxB,iBAAiBn1C,GAAS,EAAOY,IACnC,IAQXk2B,EAAW55B,UAAU8F,SAAW,SAAUhD,EAASxC,GAC/C,QAAKwC,IAGL7B,KAAK8lB,IAAImxB,UAAUp1C,EAASxC,IACrB,IASXs5B,EAAW55B,UAAUmG,UAAY,SAAUrD,EAASkB,EAAGC,GACnD,QAAKnB,IAGL7B,KAAK8lB,IAAIoxB,UAAUr1C,EAASkB,EAAGC,IACxB,IAUX21B,EAAW55B,UAAUsG,UAAY,SAAUxD,EAASkB,EAAGC,EAAGG,GACtD,QAAKtB,IAGL7B,KAAK8lB,IAAIqxB,UAAUt1C,EAASkB,EAAGC,EAAGG,IAC3B,IAWXw1B,EAAW55B,UAAUyG,UAAY,SAAU3D,EAASkB,EAAGC,EAAGG,EAAGE,GACzD,QAAKxB,IAGL7B,KAAK8lB,IAAIsxB,UAAUv1C,EAASkB,EAAGC,EAAGG,EAAGE,IAC9B,IAMXs1B,EAAW55B,UAAU0qC,YAAc,WAI/B,GAHAzpC,KAAKigB,mBAAmB7d,MAAMpC,KAAK8lB,KACnC9lB,KAAK+f,sBAAsB3d,MAAMpC,KAAK8lB,KACtC9lB,KAAKkgB,YAAY9d,MAAMpC,KAAK8lB,KACxB9lB,KAAKo6B,mBAAoB,CACzBp6B,KAAKo6B,oBAAqB,EAC1B,IAAI1f,EAAS1a,KAAK0b,YAClB1b,KAAK8lB,IAAIuxB,UAAU38B,EAAQA,EAAQA,EAAQA,KAOnDie,EAAW55B,UAAU0c,cAAgB,SAAUf,GACvCA,IAAW1a,KAAK0b,cAChB1b,KAAKo6B,oBAAqB,EAC1Bp6B,KAAK0b,YAAchB,IAO3Bie,EAAW55B,UAAU6c,cAAgB,WACjC,OAAO5b,KAAK0b,aAEhB5c,OAAOI,eAAey5B,EAAW55B,UAAW,oBAAqB,CAI7DI,IAAK,WACD,OAAOa,KAAKigB,oBAEhBjZ,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,aAAc,CAItDI,IAAK,WACD,OAAOa,KAAKkgB,aAEhBlZ,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,eAAgB,CAIxDI,IAAK,WACD,OAAOa,KAAKq6B,eAEhBrzB,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAW55B,UAAW,uBAAwB,CAIhEI,IAAK,WACD,OAAOa,KAAK+f,uBAEhB/Y,YAAY,EACZC,cAAc,IAOlB0xB,EAAW55B,UAAUu4C,2BAA6B,WAC9Ct3C,KAAK+iB,uBAAyB,IAOlC4V,EAAW55B,UAAU4gB,WAAa,SAAUC,GACpC5f,KAAK6f,gCAAkCD,IAG3C5f,KAAKqY,eAAiB,KACtBrY,KAAK67B,gBAAgB94B,EAAI,EACzB/C,KAAK67B,gBAAgB74B,EAAI,EACzBhD,KAAK67B,gBAAgB14B,EAAI,EACzBnD,KAAK67B,gBAAgBx4B,EAAI,EAEzBrD,KAAK0tC,2BACD9tB,IACA5f,KAAK4X,gBAAkB,KACvB5X,KAAK8f,oBACL9f,KAAK+f,sBAAsBC,QAC3BhgB,KAAKigB,mBAAmBD,QACxBhgB,KAAKigB,mBAAmB7E,UAAYpb,KAAK8lB,IAAIwhB,OAC7CtnC,KAAKkgB,YAAYF,QACjBhgB,KAAKqe,WAAa,EAClBre,KAAKs6B,eAAiB,EACtBt6B,KAAK0b,aAAc,EACnB1b,KAAKo6B,oBAAqB,EAC1Bp6B,KAAK87B,mBAAqB,KAC1B97B,KAAK8lB,IAAIgZ,YAAY9+B,KAAK8lB,IAAIiZ,mCAAoC/+B,KAAK8lB,IAAIkZ,MAC3Eh/B,KAAK8lB,IAAIgZ,YAAY9+B,KAAK8lB,IAAIyxB,+BAAgC,GAC9Dv3C,KAAKi7B,2BAA4B,EACjCj7B,KAAK2uC,uBAET3uC,KAAKysC,4BACLzsC,KAAKogB,mBAAqB,KAC1BpgB,KAAKqgB,8BAAgC,KACrCrgB,KAAKqtC,gBAAgB,QAOzB1U,EAAW55B,UAAUy4C,uBAAyB,SAAUh2B,EAAcD,GAClE,IAAIupB,EAAK9qC,KAAK8lB,IACV2xB,EAAY3M,EAAGwB,QACfoL,EAAY5M,EAAGwB,QACnB,OAAQ9qB,GACJ,KAAK,GACDi2B,EAAY3M,EAAG6M,OAEXD,EADAn2B,EACYupB,EAAG8M,sBAGH9M,EAAG6M,OAEnB,MACJ,KAAK,EACDF,EAAY3M,EAAG6M,OAEXD,EADAn2B,EACYupB,EAAG+M,qBAGH/M,EAAG6M,OAEnB,MACJ,KAAK,EACDF,EAAY3M,EAAGwB,QAEXoL,EADAn2B,EACYupB,EAAGgN,sBAGHhN,EAAGwB,QAEnB,MACJ,KAAK,EACDmL,EAAY3M,EAAGwB,QAEXoL,EADAn2B,EACYupB,EAAGiN,uBAGHjN,EAAGwB,QAEnB,MACJ,KAAK,EACDmL,EAAY3M,EAAGwB,QAEXoL,EADAn2B,EACYupB,EAAG8M,sBAGH9M,EAAG6M,OAEnB,MACJ,KAAK,EACDF,EAAY3M,EAAGwB,QAEXoL,EADAn2B,EACYupB,EAAG+M,qBAGH/M,EAAG6M,OAEnB,MACJ,KAAK,EACDF,EAAY3M,EAAGwB,QACfoL,EAAY5M,EAAG6M,OACf,MACJ,KAAK,EACDF,EAAY3M,EAAGwB,QACfoL,EAAY5M,EAAGwB,QACf,MACJ,KAAK,EACDmL,EAAY3M,EAAG6M,OAEXD,EADAn2B,EACYupB,EAAGiN,uBAGHjN,EAAGwB,QAEnB,MACJ,KAAK,GACDmL,EAAY3M,EAAG6M,OAEXD,EADAn2B,EACYupB,EAAGgN,sBAGHhN,EAAGwB,QAEnB,MACJ,KAAK,EACDmL,EAAY3M,EAAG6M,OACfD,EAAY5M,EAAG6M,OACf,MACJ,KAAK,GACDF,EAAY3M,EAAG6M,OACfD,EAAY5M,EAAGwB,QAGvB,MAAO,CACHnN,IAAKuY,EACLM,IAAKP,IAIb9e,EAAW55B,UAAUuhB,eAAiB,WAClC,IAAIG,EAAUzgB,KAAK8lB,IAAIvF,gBACvB,IAAKE,EACD,MAAM,IAAI5f,MAAM,4BAEpB,OAAO4f,GAGXkY,EAAW55B,UAAUk5C,uBAAyB,WAC1C,OAAO,IAAI,IAAqBj4C,KAAKsgB,iBAAkBtgB,KAAK8lB,MAWhE6S,EAAW55B,UAAUm5C,uBAAyB,SAAUzxC,EAAM6C,EAAS6uC,EAAyBl3B,QAC5D,IAA5Bk3B,IAAsCA,GAA0B,QACrD,IAAXl3B,IAAqBA,EAAS,aAClC,IAAIuI,EAAc,QACF3mB,IAAZyG,GAA4C,iBAAZA,GAChCkgB,EAAYjI,gBAAkBjY,EAAQiY,gBACtCiI,EAAYrV,UAAwBtR,IAAjByG,EAAQ6K,KAAqB,EAAI7K,EAAQ6K,KAC5DqV,EAAYhI,kBAAwC3e,IAAzByG,EAAQkY,aAA6B,EAAIlY,EAAQkY,aAC5EgI,EAAYzI,YAA4Ble,IAAnByG,EAAQyX,OAAuB,EAAIzX,EAAQyX,OAChEyI,EAAYnH,mBAA0Cxf,IAA1ByG,EAAQ+Y,eAAsC/Y,EAAQ+Y,gBAGlFmH,EAAYjI,gBAAkBjY,EAC9BkgB,EAAYrV,KAAO,EACnBqV,EAAYhI,aAAe,EAC3BgI,EAAYzI,OAAS,EACrByI,EAAYnH,eAAgB,GAEhCmH,EAAYnH,cAAgBmH,EAAYnH,eAAiBriB,KAAK8K,MAAMyC,qBAAuBvN,KAAKs/B,aAAe,GAAKt/B,KAAKo4C,WAChG,IAArB5uB,EAAYrV,MAAenU,KAAK8K,MAAMwB,+BAIZ,IAArBkd,EAAYrV,MAAenU,KAAK8K,MAAM2B,mCAF3C+c,EAAYhI,aAAe,GAMN,IAArBgI,EAAYrV,MAAenU,KAAK8K,MAAMuB,eACtCmd,EAAYrV,KAAO,EACnB,SAAY,+EAEhB,IAAI22B,EAAK9qC,KAAK8lB,IACVrF,EAAU,IAAI,IAAgBzgB,KAAMihB,GACxCR,EAAQgC,iBAAmB+G,EAAYnH,cACvC,IAAI1J,EAAQlS,EAAKkS,OAASlS,EACtBoS,EAASpS,EAAKoS,QAAUpS,EACxB+uB,EAAS/uB,EAAK+uB,QAAU,EACxB6iB,EAAUr4C,KAAKw3C,uBAAuBhuB,EAAYhI,eAAcgI,EAAYjI,iBAC5EyS,EAAoB,IAAXwB,EAAesV,EAAGwN,iBAAmBxN,EAAGQ,WACjDiN,EAAcv4C,KAAKw4C,kCAAkChvB,EAAYrV,KAAMqV,EAAYzI,OAAQyI,EAAYnH,eACvGoL,EAAiBztB,KAAKy4C,mBAAmBjvB,EAAYzI,QACrD5M,EAAOnU,KAAK04C,qBAAqBlvB,EAAYrV,MA+BjD,OA7BAnU,KAAK+zB,qBAAqBC,EAAQvT,GACnB,IAAX+U,GACA/U,EAAQ0C,WAAY,EACpB2nB,EAAG6N,WAAW3kB,EAAQ,EAAGukB,EAAa5/B,EAAOE,EAAQ2c,EAAQ,EAAG/H,EAAgBtZ,EAAM,OAGtF22B,EAAG8N,WAAW5kB,EAAQ,EAAGukB,EAAa5/B,EAAOE,EAAQ,EAAG4U,EAAgBtZ,EAAM,MAElF22B,EAAG+N,cAAc7kB,EAAQ8W,EAAGgO,mBAAoBT,EAAQL,KACxDlN,EAAG+N,cAAc7kB,EAAQ8W,EAAGiO,mBAAoBV,EAAQlZ,KACxD2L,EAAG+N,cAAc7kB,EAAQ8W,EAAGkO,eAAgBlO,EAAGmO,eAC/CnO,EAAG+N,cAAc7kB,EAAQ8W,EAAGoO,eAAgBpO,EAAGmO,eAE3CzvB,EAAYjI,iBACZvhB,KAAK8lB,IAAIomB,eAAelY,GAE5Bh0B,KAAK+zB,qBAAqBC,EAAQ,MAClCvT,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQ9H,MAAQA,EAChB8H,EAAQ5H,OAASA,EACjB4H,EAAQzO,MAAQwjB,EAChB/U,EAAQlgB,SAAU,EAClBkgB,EAAQoJ,QAAU,EAClBpJ,EAAQc,kBAAkBiI,EAAYjI,gBACtCd,EAAQe,aAAegI,EAAYhI,aACnCf,EAAQtM,KAAOqV,EAAYrV,KAC3BsM,EAAQM,OAASyI,EAAYzI,OAC7B/gB,KAAK+iB,uBAAuB5gB,KAAKse,GAC1BA,GAOXkY,EAAW55B,UAAU2jB,kBAAoB,SAAUL,EAAeoB,GAE9D,OAAOpB,GAAiBriB,KAAK8K,MAAMyC,qBAAuBvN,KAAKs/B,aAAe,GAAKt/B,KAAKo4C,UAAY30B,IAExGkV,EAAW55B,UAAUo6C,mBAAqB,SAAU31B,EAAKC,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,EAAS8pC,EAAgBC,EAA+B7mC,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,EAAUC,EAAezB,GACjO,IAAI3b,EAAQ1G,UACS,IAAjBwhB,IAA2BA,EAAe,QAC/B,IAAXkC,IAAqBA,EAAS,WAClB,IAAZpU,IAAsBA,EAAU,WACrB,IAAXkD,IAAqBA,EAAS,WACjB,IAAbmR,IAAuBA,EAAW,WACvB,IAAX5C,IAAqBA,EAAS,WACV,IAApB6C,IAA8BA,EAAkB,MAEpD,IAAIG,EAAgC,WADpCP,EAAMA,GAAO,IACMQ,OAAO,EAAG,GACzBs1B,EAAgC,UAArB91B,EAAIQ,OAAO,EAAG,GACzBC,EAAWF,IAAyC,IAA7BP,EAAIU,QAAQ,YACnCzD,EAAUkD,GAAsB,IAAI,IAAgB3jB,KAAM,SAC1DmkB,EAAcX,GACdxjB,KAAKokB,sBAAyBH,GAAaN,GAAanR,IACxDgR,EAAMxjB,KAAKokB,qBAAqBZ,IAEhCW,IAAgBX,IAChB/C,EAAQ84B,aAAep1B,GAG3B,IAAIE,EAAUb,EAAIc,YAAY,KAC1BC,EAAYX,IAAoCS,GAAW,EAAIb,EAAIgB,UAAUH,GAASI,cAAgB,IACtGC,EAAS,KAEUH,EAAUL,QAAQ,MACjB,IACpBK,EAAYA,EAAUi1B,MAAM,KAAK,IAErC,IAAK,IAAIzoC,EAAK,EAAG9Q,EAAK04B,EAAW8gB,gBAAiB1oC,EAAK9Q,EAAG8B,OAAQgP,IAAM,CACpE,IAAI4T,EAAkB1kB,EAAG8Q,GACzB,GAAI4T,EAAgBC,QAAQL,EAAWV,GAAW,CAC9Ca,EAASC,EACT,OAGJhU,GACAA,EAAMkU,gBAAgBpE,GAE1BA,EAAQ+C,IAAMA,EACd/C,EAAQc,iBAAmBkC,EAC3BhD,EAAQe,aAAeA,EACvBf,EAAQI,QAAUA,EAClBJ,EAAQgC,eAAiBziB,KAAK0iB,oBAAoBL,EAAeoB,GAC5DzjB,KAAKgoB,0BAENvH,EAAQsE,QAAUvS,GAEtB,IAAIwS,EAAiB,KACjBtB,IAAWC,IACXqB,EAAiBvE,EAAQwE,mBAAmBvU,IAAIgT,IAE/CC,GACD3jB,KAAK+iB,uBAAuB5gB,KAAKse,GAErC,IAAIiF,EAAkB,SAAUF,EAAS7V,GACjCgB,GACAA,EAAM2U,mBAAmB7E,GAEzB+C,IAAQW,GACJa,GACAvE,EAAQwE,mBAAmBQ,OAAOT,GAElC,wBACAte,EAAMyyC,mBAAmB,oBAA6B11B,EAAUhD,EAAQI,QAASlQ,EAAO6Q,EAAc,KAAMlS,EAAS8pC,EAAgBC,EAA+B7mC,EAAQiO,GAEhL+E,GAAWA,GAAW,kBAAoB,uBAAiC,+BAAiC,IAC5G/E,EAAQi5B,kBAAkBp6C,gBAAgB,CAAEkmB,QAASA,EAAS7V,UAAWA,IACrEL,GACAA,EAAQkW,EAAS7V,KAKrB,SAAY,kBAAkBhF,OAAO6Y,EAAK,sBAAsB7Y,OAAOwZ,IACvEzd,EAAMyyC,mBAAmBh1B,EAAaV,EAAUhD,EAAQI,QAASlQ,EAAO6Q,EAAckC,EAAQpU,EAAS8pC,EAAgBC,EAA+B7mC,EAAQiO,EAASM,EAAQ6C,EAAiBC,EAAUC,EAAezB,KAIjO,GAAIqC,EAAQ,CACR,IAAIi1B,EAAa,SAAUnqC,GACvBkV,EAAOk1B,SAASpqC,EAAMiR,GAAS,SAAU9H,EAAOE,EAAQghC,EAAYC,EAAcC,EAAMC,GAChFA,EACAt0B,EAAgB,qCAGhB0zB,EAAe34B,EAAS8D,EAAW5T,EAAO,CAAEgI,MAAOA,EAAOE,OAAQA,GAAU4H,EAAQI,SAAUg5B,EAAYC,GAAc,WAEpH,OADAC,KACO,IACRv4B,KAERsC,IAEFtR,EAMGA,aAAkBS,YAClB0mC,EAAW,IAAI/3B,WAAWpP,IAErBS,YAAYC,OAAOV,GACxBmnC,EAAWnnC,GAGPlD,GACAA,EAAQ,mEAAoE,MAbpFtP,KAAKulB,UAAU/B,GAAK,SAAUhU,GAAQ,OAAOmqC,EAAW,IAAI/3B,WAAWpS,WAAW3M,EAAW8N,EAAQA,EAAMspC,qBAAkBp3C,GAAW,GAAM,SAAU6M,EAASC,GAC7J+V,EAAgB,mBAAqBhW,GAAUA,EAAQiW,YAAmBhW,WAiBjF,CACD,IAAIuV,EAAW,SAAUg1B,GACjBZ,IAAa5yC,EAAMshB,0BAGnBvH,EAAQsE,QAAUm1B,GAEtBd,EAAe34B,EAAS8D,EAAW5T,EAAOupC,EAAKz5B,EAAQI,QAAS4C,GAAU,EAAO41B,EAA+B73B,KAI/GuC,GAAYE,EACTzR,IAAsC,iBAApBA,EAAO2nC,UAAyB3nC,EAAO4nC,OACzDl1B,EAAS1S,GAGTmmB,EAAW0hB,oBAAoB72B,EAAK0B,EAAUQ,EAAiB/U,EAAQA,EAAMspC,gBAAkB,KAAMp2B,EAAUpD,EAAQI,SAAW7gB,KAAK4N,UAAUkB,qBAAuB,CAAEwrC,iBAAkB,cAAYz3C,GAGrL,iBAAX2P,GAAuBA,aAAkBS,aAAeA,YAAYC,OAAOV,IAAWA,aAAkBxC,KACpH2oB,EAAW0hB,oBAAoB7nC,EAAQ0S,EAAUQ,EAAiB/U,EAAQA,EAAMspC,gBAAkB,KAAMp2B,EAAUpD,EAAQI,SAAW7gB,KAAK4N,UAAUkB,qBAAuB,CAAEwrC,iBAAkB,cAAYz3C,GAEtM2P,GACL0S,EAAS1S,GAGjB,OAAOiO,GAyBXkY,EAAW55B,UAAUwhB,cAAgB,SAAUiD,EAAKC,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,EAASkD,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,EAAUC,EAAe1B,EAAeC,GAC5L,IAAI3b,EAAQ1G,KAQZ,YAPqB,IAAjBwhB,IAA2BA,EAAe,QAC/B,IAAXkC,IAAqBA,EAAS,WAClB,IAAZpU,IAAsBA,EAAU,WACrB,IAAXkD,IAAqBA,EAAS,WACjB,IAAbmR,IAAuBA,EAAW,WACvB,IAAX5C,IAAqBA,EAAS,WACV,IAApB6C,IAA8BA,EAAkB,MAC7C5jB,KAAKm5C,mBAAmB31B,EAAKC,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,EAAStP,KAAKu6C,qBAAqBjc,KAAKt+B,OAAO,SAAUw6C,EAAUC,EAAWP,EAAK31B,EAAW9D,EAASi6B,GACvL,IAAI5P,EAAKpkC,EAAMof,IACX60B,EAAQT,EAAIvhC,QAAU6hC,GAAYN,EAAIrhC,SAAW4hC,EACjDhtB,EAAiB1M,EACfra,EAAM+xC,mBAAmB13B,EAAQN,EAAQgC,gBAC3B,SAAd8B,GAAyB9D,EAAQgC,eAE7BhC,EAAQgC,eACJqoB,EAAG1D,aACH0D,EAAG8P,KAHP9P,EAAG+P,IAITC,EAAc/5B,EAASra,EAAM+xC,mBAAmB13B,GAAwB,SAAdwD,GAAyB9D,EAAQgC,eAA0BqoB,EAAG8P,KAAZ9P,EAAG+P,IAInH,GAHIp6B,EAAQgC,gBAAyC,IAAvB/b,EAAM44B,eAChCwb,EAAcrtB,GAEdktB,EAEA,OADA7P,EAAG8N,WAAW9N,EAAGQ,WAAY,EAAG7d,EAAgBqtB,EAAahQ,EAAGiQ,cAAeb,IACxE,EAEX,IAAIhvC,EAAiBxE,EAAMoE,MAAMI,eACjC,GAAIgvC,EAAIvhC,MAAQzN,GAAkBgvC,EAAIrhC,OAAS3N,IAAmBxE,EAAMs0C,kCAEpE,OADAt0C,EAAM+gC,2BACD/gC,EAAMghC,iBAAmBhhC,EAAMihC,mBAGpCjhC,EAAMghC,eAAe/uB,MAAQ6hC,EAC7B9zC,EAAMghC,eAAe7uB,OAAS4hC,EAC9B/zC,EAAMihC,gBAAgBsT,UAAUf,EAAK,EAAG,EAAGA,EAAIvhC,MAAOuhC,EAAIrhC,OAAQ,EAAG,EAAG2hC,EAAUC,GAClF3P,EAAG8N,WAAW9N,EAAGQ,WAAY,EAAG7d,EAAgBqtB,EAAahQ,EAAGiQ,cAAer0C,EAAMghC,gBACrFjnB,EAAQ9H,MAAQ6hC,EAChB/5B,EAAQ5H,OAAS4hC,GACV,GAIP,IAAIS,EAAW,IAAI,IAAgBx0C,EAAO,UAS9C,OARIA,EAAMqtB,qBAAqB+W,EAAGQ,WAAY4P,GAAU,GACpDpQ,EAAG8N,WAAW9N,EAAGQ,WAAY,EAAG7d,EAAgBqtB,EAAahQ,EAAGiQ,cAAeb,GAC/ExzC,EAAMy0C,gBAAgBD,EAAUz6B,EAAS9P,EAAO8c,GAAgB,WAC5D/mB,EAAM2sB,gBAAgB6nB,GACtBx0C,EAAMqtB,qBAAqB+W,EAAGQ,WAAY7qB,GAAS,GACnDi6B,QAGD,IACRloC,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,EAAUC,EAAezB,IAa3EsW,EAAW0hB,oBAAsB,SAAUe,EAAO13B,EAAQpU,EAAS2qC,EAAiBp2B,EAAUw3B,GAC1F,MAAM,OAAY,cAUtB1iB,EAAW55B,UAAUo8C,gBAAkB,SAAUl6B,EAAQE,EAAaxQ,EAAO8c,EAAgB6tB,KAgB7F3iB,EAAW55B,UAAU4iB,iBAAmB,SAAUnS,EAAMmJ,EAAOE,EAAQkI,EAAQQ,EAAiBV,EAASW,EAAcW,EAAahO,EAAMiO,EAAeC,GAKrJ,WAJoB,IAAhBF,IAA0BA,EAAc,WAC/B,IAAThO,IAAmBA,EAAO,QACR,IAAlBiO,IAA4BA,EAAgB,QAC1B,IAAlBC,IAA4BA,GAAgB,IAC1C,OAAY,sBActBsW,EAAW55B,UAAUyhC,qBAAuB,SAAUhxB,EAAM/I,EAAMsa,EAAQ5M,EAAMoN,EAAiBV,EAASW,EAAcW,GAEpH,WADoB,IAAhBA,IAA0BA,EAAc,OACtC,OAAY,sBAgBtBwW,EAAW55B,UAAUohC,mBAAqB,SAAU3wB,EAAMmJ,EAAOE,EAAQ7G,EAAO+O,EAAQQ,EAAiBV,EAASW,EAAcW,EAAac,GAGzI,WAFoB,IAAhBd,IAA0BA,EAAc,WACxB,IAAhBc,IAA0BA,EAAc,IACtC,OAAY,sBAgBtB0V,EAAW55B,UAAUikB,wBAA0B,SAAUxT,EAAMmJ,EAAOE,EAAQ7G,EAAO+O,EAAQQ,EAAiBV,EAASW,EAAcW,EAAac,GAG9I,WAFoB,IAAhBd,IAA0BA,EAAc,WACxB,IAAhBc,IAA0BA,EAAc,IACtC,OAAY,sBAMtB0V,EAAW55B,UAAU+0B,aAAe,SAAUz0B,GACtCW,KAAK87B,qBAAuBz8B,IAC5BW,KAAK8lB,IAAIgZ,YAAY9+B,KAAK8lB,IAAIy1B,oBAAqBl8C,EAAQ,EAAI,GAC3DW,KAAK+7B,0BACL/7B,KAAK87B,mBAAqBz8B,KAKtCs5B,EAAW55B,UAAU80B,qBAAuB,WACxC,OAAO7zB,KAAK8lB,IAAImc,aAAajiC,KAAK8lB,IAAI01B,mBAE1C7iB,EAAW55B,UAAU08C,kBAAoB,SAAUh7B,GAC/C,OAAIA,EAAQja,OACDxG,KAAK8lB,IAAI41B,iBAEXj7B,EAAQ6K,KACNtrB,KAAK8lB,IAAI61B,WAEXl7B,EAAQ0C,WAAa1C,EAAQm7B,YAC3B57C,KAAK8lB,IAAIwyB,iBAEbt4C,KAAK8lB,IAAIwlB,YAQpB3S,EAAW55B,UAAU0pB,0BAA4B,SAAUjH,EAAcf,EAASc,QACtD,IAApBA,IAA8BA,GAAkB,GACpD,IAAIyS,EAASh0B,KAAKy7C,kBAAkBh7B,GAChC43B,EAAUr4C,KAAKw3C,uBAAuBh2B,EAAcf,EAAQc,iBAAmBA,GACnFvhB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIgzB,mBAAoBT,EAAQL,IAAKv3B,GACnFzgB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIizB,mBAAoBV,EAAQlZ,KAC1E5d,IACAd,EAAQc,iBAAkB,EAC1BvhB,KAAK8lB,IAAIomB,eAAelY,IAE5Bh0B,KAAK+zB,qBAAqBC,EAAQ,MAClCvT,EAAQe,aAAeA,GAS3BmX,EAAW55B,UAAU+8C,wBAA0B,SAAUr7B,EAAS9H,EAAOE,EAAQ7G,QAC/D,IAAVA,IAAoBA,EAAQ,IASpC2mB,EAAW55B,UAAUg9C,0BAA4B,SAAUt7B,EAASmL,EAAOC,EAAOC,QAChE,IAAVD,IAAoBA,EAAQ,WAClB,IAAVC,IAAoBA,EAAQ,MAChC,IAAIkI,EAASh0B,KAAKy7C,kBAAkBh7B,GACtB,OAAVmL,IACA5rB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIkzB,eAAgBh5C,KAAKg8C,oBAAoBpwB,GAAQnL,GACnGA,EAAQw7B,aAAerwB,GAEb,OAAVC,IACA7rB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIozB,eAAgBl5C,KAAKg8C,oBAAoBnwB,GAAQpL,GACnGA,EAAQy7B,aAAerwB,IAEtBpL,EAAQ0C,WAAa1C,EAAQ6K,OAAmB,OAAVQ,IACvC9rB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIq2B,eAAgBn8C,KAAKg8C,oBAAoBlwB,GAAQrL,GACnGA,EAAQ27B,aAAetwB,GAE3B9rB,KAAK+zB,qBAAqBC,EAAQ,OAWtC2E,EAAW55B,UAAUs9C,0BAA4B,SAAUt2B,EAAiBtf,EAAM0vB,EAAiBD,EAAmBD,EAAoBpM,QACtH,IAAZA,IAAsBA,EAAU,GACpC,IAAIlR,EAAQlS,EAAKkS,OAASlS,EACtBoS,EAASpS,EAAKoS,QAAUpS,EACxB+uB,EAAS/uB,EAAK+uB,QAAU,EAC5BzP,EAAgBzD,UAAY3J,EAC5BoN,EAAgBxD,WAAa1J,EAC7BkN,EAAgBpN,MAAQA,EACxBoN,EAAgBlN,OAASA,EACzBkN,EAAgB5C,UAAYqS,EAAS,EACrCzP,EAAgB/T,MAAQwjB,EACxBzP,EAAgBxlB,SAAU,EAC1BwlB,EAAgB8D,QAAUA,EAC1B9D,EAAgBxE,iBAAkB,EAClCwE,EAAgBvE,aAAe0U,EAAoB,EAAI,EACvDnQ,EAAgB5R,KAAO,EACvB4R,EAAgB6R,oBAAsB3B,EACtC,IAAI6U,EAAK9qC,KAAK8lB,IACVkO,EAASh0B,KAAKy7C,kBAAkB11B,GAChCu2B,EAAqBt8C,KAAKw3C,uBAAuBzxB,EAAgBvE,cAAc,GACnFspB,EAAG+N,cAAc7kB,EAAQ8W,EAAGgO,mBAAoBwD,EAAmBtE,KACnElN,EAAG+N,cAAc7kB,EAAQ8W,EAAGiO,mBAAoBuD,EAAmBnd,KACnE2L,EAAG+N,cAAc7kB,EAAQ8W,EAAGkO,eAAgBlO,EAAGmO,eAC/CnO,EAAG+N,cAAc7kB,EAAQ8W,EAAGoO,eAAgBpO,EAAGmO,eACpB,IAAvBhjB,GACA6U,EAAG+N,cAAc7kB,EAAQ8W,EAAGyR,qBAAsB,KAClDzR,EAAG+N,cAAc7kB,EAAQ8W,EAAG0R,qBAAsB1R,EAAG9L,QAGrD8L,EAAG+N,cAAc7kB,EAAQ8W,EAAGyR,qBAAsBtmB,GAClD6U,EAAG+N,cAAc7kB,EAAQ8W,EAAG0R,qBAAsB1R,EAAG2R,0BAa7D9jB,EAAW55B,UAAUyuB,uCAAyC,SAAU/M,EAASgN,EAAgB9U,EAAOE,EAAQrJ,EAAMwa,EAAWuD,QAC3G,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GAC5B,IAAIud,EAAK9qC,KAAK8lB,IACVkO,EAAS8W,EAAGQ,WAIhB,GAHI7qB,EAAQja,SACRwtB,EAAS8W,EAAGI,4BAA8BlhB,GAE1CvJ,EAAQgC,eACR,OAAQgL,GACJ,KAAK,MACL,KAAK,MAEGztB,KAAK8K,MAAMgB,KACX2hB,EAAiBqd,EAAGjG,sBAGpBpkB,EAAQgC,gBAAiB,EAE7B,MACJ,KAAK,MACGziB,KAAK8K,MAAMgB,KACX2hB,EAAiBqd,EAAGhG,iCAGpBrkB,EAAQgC,gBAAiB,EAE7B,MACJ,KAAK,MACDgL,EAAiBqd,EAAGrG,qCACpB,MACJ,KAAK,MACDhX,EAAiBqd,EAAGtG,qCACpB,MACJ,KAAK,MACGxkC,KAAK8K,MAAMk4B,UACXvV,EAAiBqd,EAAGpG,8BAIpBjkB,EAAQgC,gBAAiB,EAE7B,MACJ,KAAK,MACGziB,KAAK8K,MAAMk4B,UACXvV,EAAiBqd,EAAGnG,oCAIpBlkB,EAAQgC,gBAAiB,EAE7B,MACJ,KAAK,MACGziB,KAAK8K,MAAMk4B,UACXvV,EAAiBqd,EAAGlG,oCAIpBnkB,EAAQgC,gBAAiB,EAE7B,MACJ,QAEIhC,EAAQgC,gBAAiB,EAIrCziB,KAAK8lB,IAAI42B,qBAAqB1oB,EAAQzG,EAAKE,EAAgB9U,EAAOE,EAAQ,EAAGrJ,IAWjFmpB,EAAW55B,UAAU2uB,6BAA+B,SAAUjN,EAAS8H,EAAWyB,EAAWuD,EAAKovB,EAAuBC,QACnG,IAAd5yB,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,QACK,IAA7BqvB,IAAuCA,GAA2B,GACtE,IAAI9R,EAAK9qC,KAAK8lB,IACV7C,EAAcjjB,KAAK04C,qBAAqBj4B,EAAQtM,MAChD4M,EAAS/gB,KAAKy4C,mBAAmBh4B,EAAQM,QACzC0M,OAA2C5qB,IAA1B85C,EACf38C,KAAKw4C,kCAAkC/3B,EAAQtM,KAAMsM,EAAQM,OAAQN,EAAQgC,gBAC7EziB,KAAKy4C,mBAAmBkE,EAAuBl8B,EAAQgC,gBAC7DziB,KAAK8zB,aAAarT,EAAQI,SAC1B,IAAImT,EAAS8W,EAAGQ,WACZ7qB,EAAQja,SACRwtB,EAAS8W,EAAGI,4BAA8BlhB,GAE9C,IAAI6yB,EAAcp7B,KAAKq7B,MAAMr7B,KAAKuzB,IAAIv0B,EAAQ9H,OAAS8I,KAAKs7B,OACxDC,EAAev7B,KAAKq7B,MAAMr7B,KAAKuzB,IAAIv0B,EAAQ5H,QAAU4I,KAAKs7B,OAC1DpkC,EAAQikC,EAA2Bn8B,EAAQ9H,MAAQ8I,KAAK8pB,IAAI,EAAG9pB,KAAKC,IAAIm7B,EAActvB,EAAK,IAC3F1U,EAAS+jC,EAA2Bn8B,EAAQ5H,OAAS4I,KAAK8pB,IAAI,EAAG9pB,KAAKC,IAAIs7B,EAAezvB,EAAK,IAClGud,EAAG8N,WAAW5kB,EAAQzG,EAAKE,EAAgB9U,EAAOE,EAAQ,EAAGkI,EAAQkC,EAAasF,IActFoQ,EAAW55B,UAAUquB,kBAAoB,SAAU3M,EAAS8H,EAAW8E,EAASC,EAAS3U,EAAOE,EAAQmR,EAAWuD,EAAKhM,QAClG,IAAdyI,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,QACJ,IAApBhM,IAA8BA,GAAkB,GACpD,IAAIupB,EAAK9qC,KAAK8lB,IACV7C,EAAcjjB,KAAK04C,qBAAqBj4B,EAAQtM,MAChD4M,EAAS/gB,KAAKy4C,mBAAmBh4B,EAAQM,QAC7C/gB,KAAK8zB,aAAarT,EAAQI,SAC1B,IAAImT,EAAS8W,EAAGQ,WACZ7qB,EAAQja,SACRwtB,EAAS8W,EAAGI,4BAA8BlhB,GAE9ChqB,KAAK+zB,qBAAqBC,EAAQvT,GAAS,GAC3CqqB,EAAGmS,cAAcjpB,EAAQzG,EAAKF,EAASC,EAAS3U,EAAOE,EAAQkI,EAAQkC,EAAasF,GAChFhH,GACAvhB,KAAK8lB,IAAIomB,eAAelY,GAE5Bh0B,KAAK+zB,qBAAqBC,EAAQ,OAStC2E,EAAW55B,UAAU4uB,gCAAkC,SAAUlN,EAAS8H,EAAWyB,EAAWuD,QAC1E,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GAC5B,IAAIud,EAAK9qC,KAAK8lB,IACVo3B,EAAaz8B,EAAQja,OAASskC,EAAG4Q,iBAAmB5Q,EAAGQ,WAC3DtrC,KAAK+zB,qBAAqBmpB,EAAYz8B,GAAS,GAC/CzgB,KAAK0tB,6BAA6BjN,EAAS8H,EAAWyB,EAAWuD,GACjEvtB,KAAK+zB,qBAAqBmpB,EAAY,MAAM,IAEhDvkB,EAAW55B,UAAUo+C,iCAAmC,SAAU18B,EAAS9P,EAAO8S,EAAUq2B,EAAct4B,GACtG,IAAIspB,EAAK9qC,KAAK8lB,IACd,GAAKglB,EAAL,CAGA,IAAIuN,EAAUr4C,KAAKw3C,uBAAuBh2B,GAAeiC,GACzDqnB,EAAG+N,cAAc/N,EAAGQ,WAAYR,EAAGgO,mBAAoBT,EAAQL,KAC/DlN,EAAG+N,cAAc/N,EAAGQ,WAAYR,EAAGiO,mBAAoBV,EAAQlZ,KAC1D1b,GAAaq2B,GACdhP,EAAGoB,eAAepB,EAAGQ,YAEzBtrC,KAAK+zB,qBAAqB+W,EAAGQ,WAAY,MAErC36B,GACAA,EAAM2U,mBAAmB7E,GAE7BA,EAAQwE,mBAAmB3lB,gBAAgBmhB,GAC3CA,EAAQwE,mBAAmBpT,UAE/B8mB,EAAW55B,UAAUw7C,qBAAuB,SAAU95B,EAAS8D,EAAW5T,EAAOupC,EAAKr5B,EAAS4C,EAAUq2B,EAAcsD,EAAiB57B,GACpI,IAAI9a,EAAQ1G,UACS,IAAjBwhB,IAA2BA,EAAe,GAC9C,IAAItW,EAAiBlL,KAAKkoC,UAAUh9B,eAChCsvC,EAAW/4B,KAAK0d,IAAIj0B,EAAgBlL,KAAKq9C,gBAAkB1kB,EAAW2kB,iBAAiBpD,EAAIvhC,MAAOzN,GAAkBgvC,EAAIvhC,OACxH8hC,EAAYh5B,KAAK0d,IAAIj0B,EAAgBlL,KAAKq9C,gBAAkB1kB,EAAW2kB,iBAAiBpD,EAAIrhC,OAAQ3N,GAAkBgvC,EAAIrhC,QAC1HiyB,EAAK9qC,KAAK8lB,IACTglB,IAGArqB,EAAQO,kBAObhhB,KAAK+zB,qBAAqB+W,EAAGQ,WAAY7qB,GAAS,GAClDzgB,KAAK8zB,kBAAyBjxB,IAAZge,KAA+BA,GACjDJ,EAAQ6B,UAAY43B,EAAIvhC,MACxB8H,EAAQ8B,WAAa23B,EAAIrhC,OACzB4H,EAAQ9H,MAAQ6hC,EAChB/5B,EAAQ5H,OAAS4hC,EACjBh6B,EAAQlgB,SAAU,EACd68C,EAAgB5C,EAAUC,EAAWP,EAAK31B,EAAW9D,GAAS,WAC9D/Z,EAAMy2C,iCAAiC18B,EAAS9P,EAAO8S,EAAUq2B,EAAct4B,OAKnFxhB,KAAKm9C,iCAAiC18B,EAAS9P,EAAO8S,EAAUq2B,EAAct4B,IAlBtE7Q,GACAA,EAAM2U,mBAAmB7E,KA2BrCkY,EAAW55B,UAAUw+C,kCAAoC,SAAU7zB,EAAuBD,EAAqB9Q,EAAOE,EAAQgR,QAC1G,IAAZA,IAAsBA,EAAU,GACpC,IAAIihB,EAAK9qC,KAAK8lB,IAEd,GAAI4D,GAAyBD,EACzB,OAAOzpB,KAAKw9C,oBAAoB7kC,EAAOE,EAAQgR,EAASihB,EAAG2S,cAAe3S,EAAG7G,iBAAkB6G,EAAGM,0BAEtG,GAAI3hB,EAAqB,CACrB,IAAIi0B,EAAc5S,EAAG6S,kBAIrB,OAHI39C,KAAK4K,cAAgB,IACrB8yC,EAAc5S,EAAG8S,oBAEd59C,KAAKw9C,oBAAoB7kC,EAAOE,EAAQgR,EAAS6zB,EAAaA,EAAa5S,EAAGO,kBAEzF,OAAI3hB,EACO1pB,KAAKw9C,oBAAoB7kC,EAAOE,EAAQgR,EAASihB,EAAG+S,eAAgB/S,EAAG+S,eAAgB/S,EAAGgT,oBAE9F,MAYXnlB,EAAW55B,UAAUy+C,oBAAsB,SAAU7kC,EAAOE,EAAQgR,EAAS4D,EAAgBswB,EAAkB5S,EAAY6S,QAClG,IAAjBA,IAA2BA,GAAe,GAC9C,IAAIlT,EAAK9qC,KAAK8lB,IACVm4B,EAAenT,EAAGoT,qBAYtB,OAXApT,EAAGqT,iBAAiBrT,EAAGsT,aAAcH,GACjCp0B,EAAU,GAAKihB,EAAGlM,+BAClBkM,EAAGlM,+BAA+BkM,EAAGsT,aAAcv0B,EAASk0B,EAAkBplC,EAAOE,GAGrFiyB,EAAGuT,oBAAoBvT,EAAGsT,aAAc3wB,EAAgB9U,EAAOE,GAEnEiyB,EAAGwT,wBAAwBxT,EAAG3F,YAAagG,EAAYL,EAAGsT,aAAcH,GACpED,GACAlT,EAAGqT,iBAAiBrT,EAAGsT,aAAc,MAElCH,GAMXtlB,EAAW55B,UAAUs0B,gBAAkB,SAAU5S,GAC7C,IAAIxgB,EACJD,KAAKwgB,eAAmD,QAAnCvgB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,oBAE5FphB,KAAKu+C,oBACL,IAAIh9C,EAAQvB,KAAK+iB,uBAAuBmB,QAAQzD,IACjC,IAAXlf,GACAvB,KAAK+iB,uBAAuB9gB,OAAOV,EAAO,GAG1Ckf,EAAQ+9B,iBACR/9B,EAAQ+9B,gBAAgBl8C,UAExBme,EAAQg+B,gBACRh+B,EAAQg+B,eAAen8C,UAEvBme,EAAQi+B,gBACRj+B,EAAQi+B,eAAep8C,UAGvBme,EAAQk+B,oBACRl+B,EAAQk+B,mBAAmBr8C,WAOnCq2B,EAAW55B,UAAU+4B,4BAA8B,SAAU5R,GACzD,IAAI3kB,EAAQvB,KAAKspB,0BAA0BpF,QAAQgC,IACpC,IAAX3kB,GACAvB,KAAKspB,0BAA0BrnB,OAAOV,EAAO,IAGrDo3B,EAAW55B,UAAUyhB,eAAiB,SAAUC,GACxCA,GACAzgB,KAAK8lB,IAAIpF,cAAcD,IAG/BkY,EAAW55B,UAAU4Y,YAAc,SAAUN,GACrCrX,KAAK4X,kBAAoBP,IACzBrX,KAAK8lB,IAAI84B,WAAWvnC,GACpBrX,KAAK4X,gBAAkBP,IAO/BshB,EAAW55B,UAAUkZ,aAAe,SAAUlX,GAC1C,IAAIoxC,EAAuBpxC,EAAOmX,qBAClClY,KAAK2X,YAAYw6B,EAAqB96B,SAEtC,IADA,IAAIjW,EAAWL,EAAOoX,cACb5W,EAAQ,EAAGA,EAAQH,EAASW,OAAQR,IAAS,CAClD,IAAIM,EAAUd,EAAOiB,WAAWZ,EAASG,IACrCM,IACA7B,KAAKoY,eAAe7W,GAASM,GAGrC7B,KAAKqY,eAAiB,MAE1BsgB,EAAW55B,UAAU8/C,wBAA0B,WACvC7+C,KAAKu6B,yBAA2Bv6B,KAAK+qB,iBACrC/qB,KAAK8lB,IAAIg5B,cAAc9+C,KAAK8lB,IAAIi5B,SAAW/+C,KAAK+qB,gBAChD/qB,KAAKu6B,uBAAyBv6B,KAAK+qB,iBAU3C4N,EAAW55B,UAAUg1B,qBAAuB,SAAUC,EAAQvT,EAASu+B,EAAsBzlC,GACzF,IAAItZ,EAAI0Z,OACqB,IAAzBqlC,IAAmCA,GAAuB,QAChD,IAAVzlC,IAAoBA,GAAQ,GAChC,IAAI0lC,GAAqB,EACrBC,EAAwBz+B,GAAWA,EAAQ0+B,oBAAsB,EAKrE,GAJIH,GAAwBE,IACxBl/C,KAAK+qB,eAAiBtK,EAAQ0+B,oBAERn/C,KAAK8qB,oBAAoB9qB,KAAK+qB,kBAC5BtK,GAAWlH,EAAO,CAE1C,GADAvZ,KAAK6+C,0BACDp+B,GAAWA,EAAQm7B,YAGnB,KAAM,wDAGN57C,KAAK8lB,IAAIs5B,YAAYprB,EAAgK,QAAvJra,EAA2F,QAArF1Z,EAAKwgB,aAAyC,EAASA,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,0BAAuC,IAAPzH,EAAgBA,EAAK,MAEtN3Z,KAAK8qB,oBAAoB9qB,KAAK+qB,gBAAkBtK,EAC5CA,IACAA,EAAQ0+B,mBAAqBn/C,KAAK+qB,qBAGjCi0B,IACLC,GAAqB,EACrBj/C,KAAK6+C,2BAKT,OAHIK,IAA0BF,GAC1Bh/C,KAAKq/C,6BAA6B5+B,EAAQ0+B,mBAAoBn/C,KAAK+qB,gBAEhEk0B,GAQXtmB,EAAW55B,UAAU8tB,aAAe,SAAUlC,EAASlK,EAASve,GAC5D,QAAgBW,IAAZ8nB,EAAJ,CAGIlK,IACAA,EAAQ0+B,mBAAqBx0B,GAEjC3qB,KAAK+qB,eAAiBJ,EACtB,IAAIqJ,EAASvT,EAAUzgB,KAAKy7C,kBAAkBh7B,GAAWzgB,KAAK8lB,IAAIwlB,WAClEtrC,KAAK+zB,qBAAqBC,EAAQvT,KAKtCkY,EAAW55B,UAAUw/C,kBAAoB,WACrC,IAAK,IAAI5zB,EAAU,EAAGA,EAAU3qB,KAAKm7B,yBAA0BxQ,IAC3D3qB,KAAK+qB,eAAiBJ,EACtB3qB,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAIwlB,WAAY,MAC/CtrC,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAI41B,iBAAkB,MACjD17C,KAAKs/B,aAAe,IACpBt/B,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAI61B,WAAY,MAC/C37C,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAIwyB,iBAAkB,QAWjE3f,EAAW55B,UAAU+2B,WAAa,SAAUnL,EAAS9oB,EAAS4e,EAASve,QACnDW,IAAZ8nB,IAGA9oB,IACA7B,KAAKoY,eAAeuS,GAAW9oB,GAEnC7B,KAAK0qB,YAAYC,EAASlK,KAE9BkY,EAAW55B,UAAUsgD,6BAA+B,SAAUC,EAAYn+B,GACtE,IAAItf,EAAU7B,KAAKoY,eAAeknC,GAC7Bz9C,GAAWA,EAAQ09C,gBAAkBp+B,IAG1CnhB,KAAK8lB,IAAIowB,UAAUr0C,EAASsf,GAC5Btf,EAAQ09C,cAAgBp+B,IAE5BwX,EAAW55B,UAAUi9C,oBAAsB,SAAU79B,GACjD,OAAQA,GACJ,KAAK,EACD,OAAOne,KAAK8lB,IAAI05B,OACpB,KAAK,EACD,OAAOx/C,KAAK8lB,IAAImzB,cACpB,KAAK,EACD,OAAOj5C,KAAK8lB,IAAI25B,gBAExB,OAAOz/C,KAAK8lB,IAAI05B,QAEpB7mB,EAAW55B,UAAU2rB,YAAc,SAAUC,EAASlK,EAASmK,EAAsBC,EAAqB3oB,GAKtG,QAJ6B,IAAzB0oB,IAAmCA,GAAuB,QAClC,IAAxBC,IAAkCA,GAAsB,QAC/C,IAAT3oB,IAAmBA,EAAO,KAEzBue,EAUD,OATyC,MAArCzgB,KAAK8qB,oBAAoBH,KACzB3qB,KAAK+qB,eAAiBJ,EACtB3qB,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAIwlB,WAAY,MAC/CtrC,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAI41B,iBAAkB,MACjD17C,KAAKs/B,aAAe,IACpBt/B,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAI61B,WAAY,MAC/C37C,KAAK+zB,qBAAqB/zB,KAAK8lB,IAAIwyB,iBAAkB,SAGtD,EAGX,GAAI73B,EAAQwB,MACRjiB,KAAK+qB,eAAiBJ,EACtBlK,EAAQwK,cAEP,GAA+B,IAA3BxK,EAAQyK,eAGb,OADAzK,EAAQ0K,aACD,EAEX,IAAIpF,EAEAA,EADA8E,EACkBpK,EAAQoK,oBAErBpK,EAAQlgB,UACKkgB,EAAQ2K,qBAErB3K,EAAQja,OACKxG,KAAKqrB,iBAElB5K,EAAQ6K,KACKtrB,KAAKurB,eAElB9K,EAAQ0C,UACKnjB,KAAKwrB,oBAGLxrB,KAAKyrB,cAEtBb,GAAwB7E,IACzBA,EAAgBo5B,mBAAqBx0B,GAEzC,IAAI+0B,GAAa,EACb1/C,KAAK8qB,oBAAoBH,KAAa5E,IACjC6E,GACD5qB,KAAKq/C,6BAA6Bt5B,EAAgBo5B,mBAAoBx0B,GAE1E+0B,GAAa,GAEjB1/C,KAAK+qB,eAAiBJ,EACtB,IAAIqJ,EAASh0B,KAAKy7C,kBAAkB11B,GAIpC,GAHI25B,GACA1/C,KAAK+zB,qBAAqBC,EAAQjO,EAAiB6E,GAEnD7E,IAAoBA,EAAgB61B,YAAa,CAEjD,GAAI71B,EAAgBvf,QAAUuf,EAAgB45B,yBAA2Bl/B,EAAQm/B,gBAAiB,CAC9F75B,EAAgB45B,uBAAyBl/B,EAAQm/B,gBACjD,IAAIC,EAA8C,IAA5Bp/B,EAAQm/B,iBAAqD,IAA5Bn/B,EAAQm/B,gBACzD,EACA,EACNn/B,EAAQmL,MAAQi0B,EAChBp/B,EAAQoL,MAAQg0B,EAEhB95B,EAAgBk2B,eAAiBx7B,EAAQmL,QACzC7F,EAAgBk2B,aAAex7B,EAAQmL,MACvC5rB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIkzB,eAAgBh5C,KAAKg8C,oBAAoBv7B,EAAQmL,OAAQ7F,IAE3GA,EAAgBm2B,eAAiBz7B,EAAQoL,QACzC9F,EAAgBm2B,aAAez7B,EAAQoL,MACvC7rB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIozB,eAAgBl5C,KAAKg8C,oBAAoBv7B,EAAQoL,OAAQ9F,IAE3GA,EAAgBuF,MAAQvF,EAAgBq2B,eAAiB37B,EAAQqL,QACjE/F,EAAgBq2B,aAAe37B,EAAQqL,MACvC9rB,KAAK67C,4BAA4B7nB,EAAQh0B,KAAK8lB,IAAIq2B,eAAgBn8C,KAAKg8C,oBAAoBv7B,EAAQqL,OAAQ/F,IAE/G/lB,KAAK8/C,qBAAqB9rB,EAAQjO,EAAiBtF,EAAQ6L,2BAE/D,OAAO,GASXqM,EAAW55B,UAAUghD,gBAAkB,SAAUp1B,EAAS9oB,EAASg0B,EAAU3zB,GACzE,QAAgBW,IAAZ8nB,GAA0B9oB,EAA9B,CAGK7B,KAAKggD,eAAiBhgD,KAAKggD,cAAcj+C,SAAW8zB,EAAS9zB,SAC9D/B,KAAKggD,cAAgB,IAAIC,WAAWpqB,EAAS9zB,SAEjD,IAAK,IAAI+yB,EAAI,EAAGA,EAAIe,EAAS9zB,OAAQ+yB,IAAK,CACtC,IAAIrU,EAAUoV,EAASf,GAAG1J,qBACtB3K,GACAzgB,KAAKggD,cAAclrB,GAAKnK,EAAUmK,EAClCrU,EAAQ0+B,mBAAqBx0B,EAAUmK,GAGvC90B,KAAKggD,cAAclrB,IAAM,EAGjC90B,KAAK8lB,IAAIwwB,WAAWz0C,EAAS7B,KAAKggD,eAClC,IAAK,IAAIz+C,EAAQ,EAAGA,EAAQs0B,EAAS9zB,OAAQR,IACzCvB,KAAK0qB,YAAY1qB,KAAKggD,cAAcz+C,GAAQs0B,EAASt0B,IAAQ,KASrEo3B,EAAW55B,UAAU+gD,qBAAuB,SAAU9rB,EAAQjO,EAAiBuG,GAC3E,IAAI4zB,EAA6BlgD,KAAK8K,MAAMm4B,kCACP,KAAjCld,EAAgBvE,cACiB,IAAjCuE,EAAgBvE,cACiB,IAAjCuE,EAAgBvE,eAChB8K,EAA4B,GAE5B4zB,GAA8Bn6B,EAAgBwG,mCAAqCD,IACnFtsB,KAAKmgD,0BAA0BnsB,EAAQksB,EAA2BE,2BAA4B3+B,KAAK0d,IAAI7S,EAA2BtsB,KAAK8K,MAAMkB,eAAgB+Z,GAC7JA,EAAgBwG,iCAAmCD,IAG3DqM,EAAW55B,UAAUohD,0BAA4B,SAAUnsB,EAAQqsB,EAAWhhD,EAAOohB,GACjFzgB,KAAK+zB,qBAAqBC,EAAQvT,GAAS,GAAM,GACjDzgB,KAAK8lB,IAAIw6B,cAActsB,EAAQqsB,EAAWhhD,IAE9Cs5B,EAAW55B,UAAU88C,4BAA8B,SAAU7nB,EAAQqsB,EAAWhhD,EAAOohB,GAC/EA,GACAzgB,KAAK+zB,qBAAqBC,EAAQvT,GAAS,GAAM,GAErDzgB,KAAK8lB,IAAI+yB,cAAc7kB,EAAQqsB,EAAWhhD,IAK9Cs5B,EAAW55B,UAAU4vC,oBAAsB,WACvC,GAAI3uC,KAAKi7B,0BAAT,CACIj7B,KAAKi7B,2BAA4B,EACjC,IAAK,IAAInG,EAAI,EAAGA,EAAI90B,KAAK8K,MAAMQ,iBAAkBwpB,IAC7C90B,KAAK6wC,wBAAwB/b,OAIhC,CAAIA,EAAI,EAAb,IAAK,IAAW4a,EAAK1vC,KAAKy6B,2BAA2B14B,OAAQ+yB,EAAI4a,EAAI5a,IAC7DA,GAAK90B,KAAK8K,MAAMQ,mBAAqBtL,KAAKy6B,2BAA2B3F,IAGzE90B,KAAK6wC,wBAAwB/b,KAMrC6D,EAAW55B,UAAUk1B,eAAiB,WAClC,IAAK,IAAIxyB,KAAUzB,KAAKw6B,iBAAkB,CACtC,IAAI2X,EAAuBnyC,KAAKw6B,iBAAiB/4B,GAAQyW,qBACzDlY,KAAK8X,uBAAuBq6B,GAEhCnyC,KAAKw6B,iBAAmB,IAK5B7B,EAAW55B,UAAUuD,QAAU,WAC3B,IAAIrC,EACJD,KAAKmoC,iBAEDnoC,KAAK07B,+BACL17B,KAAK07B,8BAA8B7pB,QAGnC7R,KAAKigC,gBACLjgC,KAAKqzB,gBAAgBrzB,KAAKigC,eAC1BjgC,KAAKigC,cAAgB,MAErBjgC,KAAKqgC,oBACLrgC,KAAKqzB,gBAAgBrzB,KAAKqgC,mBAC1BrgC,KAAKqgC,kBAAoB,MAEzBrgC,KAAK46B,mBACL56B,KAAK8lB,IAAIy6B,kBAAkBvgD,KAAK46B,mBAGpC56B,KAAKi0B,iBACiC,QAArCh0B,EAAKD,KAAKwgD,6BAA0C,IAAPvgD,GAAyBA,EAAGhB,KAAKe,MAE/EA,KAAK2uC,sBACL3uC,KAAKoY,eAAiB,IAElB,WACIpY,KAAKm8B,mBACAn8B,KAAKgoB,0BACNhoB,KAAKm8B,iBAAiBskB,oBAAoB,mBAAoBzgD,KAAKg+B,gBACnEh+B,KAAKm8B,iBAAiBskB,oBAAoB,uBAAwBzgD,KAAKm+B,qBAE3EtuB,OAAO4wC,oBAAoB,SAAUzgD,KAAK+8B,kBAGlD/8B,KAAK0nC,eAAiB,KACtB1nC,KAAK2nC,gBAAkB,KACvB3nC,KAAK66B,uBAAyB,GAC9B76B,KAAKm8B,iBAAmB,KACxBn8B,KAAK4X,gBAAkB,KACvB5X,KAAK0oC,qBAAuB,KAC5B,iBAEA,IAAK,IAAI33B,EAAK,EAAG4I,EAAK3Z,KAAKq7B,gBAAiBtqB,EAAK4I,EAAG5X,OAAQgP,IAAM,CAChD4I,EAAG5I,GACT2vC,QAEZ1gD,KAAKs5B,oBAAoBh6B,gBAAgBU,MACzCA,KAAKs5B,oBAAoBznB,SAM7B8mB,EAAW55B,UAAU4hD,uBAAyB,SAAUC,GAChD5gD,KAAKm8B,kBACLn8B,KAAKm8B,iBAAiBe,iBAAiB,mBAAoB0jB,GAAU,IAO7EjoB,EAAW55B,UAAU8hD,2BAA6B,SAAUD,GACpD5gD,KAAKm8B,kBACLn8B,KAAKm8B,iBAAiBe,iBAAiB,uBAAwB0jB,GAAU,IAQjFjoB,EAAW55B,UAAU60B,SAAW,WAC5B,OAAO5zB,KAAK8lB,IAAI8N,YAEpB+E,EAAW55B,UAAUwlC,6BAA+B,WAChD,OAAIvkC,KAAK4K,cAAgB,EACd5K,KAAK8K,MAAMsB,iBAEfpM,KAAK8gD,wBAAwB,IAExCnoB,EAAW55B,UAAUgmC,iCAAmC,WACpD,OAAI/kC,KAAK4K,cAAgB,EACd5K,KAAK8K,MAAMsB,iBAEfpM,KAAK8gD,wBAAwB,IAGxCnoB,EAAW55B,UAAU+hD,wBAA0B,SAAU3sC,GAIrD,IAHA,IAAI22B,EAAK9qC,KAAK8lB,IAGPglB,EAAGlX,aAAekX,EAAGgJ,WAC5B,IAAIiN,GAAa,EACbtgC,EAAUqqB,EAAGvqB,gBACjBuqB,EAAGsU,YAAYtU,EAAGQ,WAAY7qB,GAC9BqqB,EAAG8N,WAAW9N,EAAGQ,WAAY,EAAGtrC,KAAKw4C,kCAAkCrkC,GAAO,EAAG,EAAG,EAAG22B,EAAG8P,KAAM56C,KAAK04C,qBAAqBvkC,GAAO,MACjI22B,EAAG+N,cAAc/N,EAAGQ,WAAYR,EAAGiO,mBAAoBjO,EAAGwB,SAC1DxB,EAAG+N,cAAc/N,EAAGQ,WAAYR,EAAGgO,mBAAoBhO,EAAGwB,SAC1D,IAAI0U,EAAKlW,EAAGmW,oBACZnW,EAAG/gB,gBAAgB+gB,EAAG3F,YAAa6b,GACnClW,EAAGG,qBAAqBH,EAAG3F,YAAa2F,EAAGE,kBAAmBF,EAAGQ,WAAY7qB,EAAS,GACtF,IAAIoI,EAASiiB,EAAGoW,uBAAuBpW,EAAG3F,aAS1C,IAPA4b,GADAA,EAAaA,GAAcl4B,IAAWiiB,EAAGqW,uBACdrW,EAAGlX,aAAekX,EAAGgJ,YAG5ChJ,EAAGj5B,MAAMi5B,EAAGnB,kBACZoX,EAAaA,GAAcjW,EAAGlX,aAAekX,EAAGgJ,UAGhDiN,EAAY,CAEZjW,EAAG/gB,gBAAgB+gB,EAAG3F,YAAa,MACnC,IAAIic,EAAatW,EAAG8P,KAChByG,EAAWvW,EAAGiQ,cACdvoC,EAAS,IAAIoP,WAAW,GAC5BkpB,EAAGwW,WAAW,EAAG,EAAG,EAAG,EAAGF,EAAYC,EAAU7uC,GAChDuuC,EAAaA,GAAcjW,EAAGlX,aAAekX,EAAGgJ,SAQpD,IALAhJ,EAAGpqB,cAAcD,GACjBqqB,EAAGyV,kBAAkBS,GACrBlW,EAAG/gB,gBAAgB+gB,EAAG3F,YAAa,OAG3B4b,GAAcjW,EAAGlX,aAAekX,EAAGgJ,WAC3C,OAAOiN,GAMXpoB,EAAW55B,UAAU25C,qBAAuB,SAAUvkC,GAClD,GAA2B,IAAvBnU,KAAK4K,cAAqB,CAC1B,OAAQuJ,GACJ,KAAK,EACD,OAAOnU,KAAK8lB,IAAIypB,MACpB,KAAK,EACD,OAAOvvC,KAAK8lB,IAAIge,eACpB,KAAK,EACD,OAAO9jC,KAAK8lB,IAAIi1B,cACpB,KAAK,EACD,OAAO/6C,KAAK8lB,IAAIy7B,uBACpB,KAAK,EACD,OAAOvhD,KAAK8lB,IAAI07B,uBACpB,KAAK,GACD,OAAOxhD,KAAK8lB,IAAI27B,qBAExB,OAAOzhD,KAAK8lB,IAAIi1B,cAEpB,OAAQ5mC,GACJ,KAAK,EACD,OAAOnU,KAAK8lB,IAAI47B,KACpB,KAAK,EACD,OAAO1hD,KAAK8lB,IAAIi1B,cACpB,KAAK,EACD,OAAO/6C,KAAK8lB,IAAI67B,MACpB,KAAK,EACD,OAAO3hD,KAAK8lB,IAAIwrB,eACpB,KAAK,EACD,OAAOtxC,KAAK8lB,IAAI87B,IACpB,KAAK,EACD,OAAO5hD,KAAK8lB,IAAIurB,aACpB,KAAK,EACD,OAAOrxC,KAAK8lB,IAAIypB,MACpB,KAAK,EACD,OAAOvvC,KAAK8lB,IAAI+7B,WACpB,KAAK,EACD,OAAO7hD,KAAK8lB,IAAIy7B,uBACpB,KAAK,EACD,OAAOvhD,KAAK8lB,IAAI07B,uBACpB,KAAK,GACD,OAAOxhD,KAAK8lB,IAAI27B,qBACpB,KAAK,GACD,OAAOzhD,KAAK8lB,IAAIg8B,4BACpB,KAAK,GACD,OAAO9hD,KAAK8lB,IAAIsf,kBACpB,KAAK,GACD,OAAOplC,KAAK8lB,IAAIi8B,6BACpB,KAAK,GACD,OAAO/hD,KAAK8lB,IAAIk8B,yBACpB,KAAK,GACD,OAAOhiD,KAAK8lB,IAAIm8B,+BAExB,OAAOjiD,KAAK8lB,IAAIi1B,eAOpBpiB,EAAW55B,UAAU05C,mBAAqB,SAAU13B,EAAQsB,QAClC,IAAlBA,IAA4BA,GAAgB,GAChD,IAAIoL,EAAiBpL,EAAgBriB,KAAK8lB,IAAIshB,aAAepnC,KAAK8lB,IAAI80B,KACtE,OAAQ75B,GACJ,KAAK,EACD0M,EAAiBztB,KAAK8lB,IAAIo8B,MAC1B,MACJ,KAAK,EACDz0B,EAAiBztB,KAAK8lB,IAAIq8B,UAC1B,MACJ,KAAK,EACD10B,EAAiBztB,KAAK8lB,IAAIs8B,gBAC1B,MACJ,KAAK,EACD30B,EAAiBztB,KAAK8lB,IAAIu8B,IAC1B,MACJ,KAAK,EACD50B,EAAiBztB,KAAK8lB,IAAIw8B,GAC1B,MACJ,KAAK,EACD70B,EAAiBpL,EAAgBriB,KAAK8lB,IAAIkhB,KAAOhnC,KAAK8lB,IAAI+0B,IAC1D,MACJ,KAAK,EACDptB,EAAiBpL,EAAgBriB,KAAK8lB,IAAIshB,aAAepnC,KAAK8lB,IAAI80B,KAG1E,GAAI56C,KAAK4K,cAAgB,EACrB,OAAQmW,GACJ,KAAK,EACD0M,EAAiBztB,KAAK8lB,IAAIy8B,YAC1B,MACJ,KAAK,EACD90B,EAAiBztB,KAAK8lB,IAAI08B,WAC1B,MACJ,KAAK,GACD/0B,EAAiBztB,KAAK8lB,IAAI28B,YAC1B,MACJ,KAAK,GACDh1B,EAAiBztB,KAAK8lB,IAAI48B,aAItC,OAAOj1B,GAQXkL,EAAW55B,UAAUy5C,kCAAoC,SAAUrkC,EAAM4M,EAAQsB,GAE7E,QADsB,IAAlBA,IAA4BA,GAAgB,GACrB,IAAvBriB,KAAK4K,cAAqB,CAC1B,QAAe/H,IAAXke,EACA,OAAQA,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAIo8B,MACpB,KAAK,EACD,OAAOliD,KAAK8lB,IAAIq8B,UACpB,KAAK,EACD,OAAOniD,KAAK8lB,IAAIs8B,gBACpB,KAAK,EACD,OAAO//B,EAAgBriB,KAAK8lB,IAAIkhB,KAAOhnC,KAAK8lB,IAAI+0B,IAG5D,OAAO76C,KAAK8lB,IAAI80B,KAEpB,OAAQzmC,GACJ,KAAK,EACD,OAAQ4M,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAI68B,SACpB,KAAK,EACD,OAAO3iD,KAAK8lB,IAAI88B,UACpB,KAAK,EACD,OAAO5iD,KAAK8lB,IAAI+8B,WACpB,KAAK,EACD,OAAO7iD,KAAK8lB,IAAIg9B,IACpB,KAAK,EACD,OAAO9iD,KAAK8lB,IAAIi9B,KACpB,KAAK,GACD,OAAO/iD,KAAK8lB,IAAIk9B,MACpB,KAAK,GACD,OAAOhjD,KAAK8lB,IAAIm9B,OACpB,QACI,OAAOjjD,KAAK8lB,IAAIo9B,YAE5B,KAAK,EACD,OAAQniC,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAIq9B,GACpB,KAAK,EACD,OAAOnjD,KAAK8lB,IAAIs9B,IACpB,KAAK,EACD,OAAO/gC,EAAgBriB,KAAK8lB,IAAIohB,MAAQlnC,KAAK8lB,IAAIu9B,KACrD,KAAK,EACD,OAAOhhC,EAAgBriB,KAAK8lB,IAAIshB,aAAepnC,KAAK8lB,IAAIw9B,MAC5D,KAAK,EACD,OAAOtjD,KAAK8lB,IAAIy9B,KACpB,KAAK,EACD,OAAOvjD,KAAK8lB,IAAI09B,MACpB,KAAK,GACD,OAAOxjD,KAAK8lB,IAAI29B,OACpB,KAAK,GACD,OAAOzjD,KAAK8lB,IAAI49B,QACpB,KAAK,EACD,OAAO1jD,KAAK8lB,IAAIo8B,MACpB,KAAK,EACD,OAAOliD,KAAK8lB,IAAIq8B,UACpB,KAAK,EACD,OAAOniD,KAAK8lB,IAAIs8B,gBACpB,QACI,OAAOpiD,KAAK8lB,IAAIw9B,MAE5B,KAAK,EACD,OAAQviC,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAI69B,KACpB,KAAK,EACD,OAAO3jD,KAAK8lB,IAAI89B,MACpB,KAAK,GACD,OAAO5jD,KAAK8lB,IAAI+9B,OAGpB,QACI,OAAO7jD,KAAK8lB,IAAIg+B,QAE5B,KAAK,EACD,OAAQ/iC,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAIi+B,MACpB,KAAK,EACD,OAAO/jD,KAAK8lB,IAAIk+B,OACpB,KAAK,GACD,OAAOhkD,KAAK8lB,IAAIm+B,QAGpB,QACI,OAAOjkD,KAAK8lB,IAAIo+B,SAE5B,KAAK,EACD,OAAQnjC,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAIq+B,KACpB,KAAK,EACD,OAAOnkD,KAAK8lB,IAAIs+B,MACpB,KAAK,GACD,OAAOpkD,KAAK8lB,IAAIu+B,OAGpB,QACI,OAAOrkD,KAAK8lB,IAAIw+B,QAE5B,KAAK,EACD,OAAQvjC,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAIy+B,MACpB,KAAK,EACD,OAAOvkD,KAAK8lB,IAAI0+B,OACpB,KAAK,GACD,OAAOxkD,KAAK8lB,IAAI2+B,QAGpB,QACI,OAAOzkD,KAAK8lB,IAAI4+B,SAE5B,KAAK,EACD,OAAQ3jC,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAI6+B,KACpB,KAAK,EACD,OAAO3kD,KAAK8lB,IAAI8+B,MACpB,KAAK,EACD,OAAO5kD,KAAK8lB,IAAI++B,OAGpB,QACI,OAAO7kD,KAAK8lB,IAAIke,QAE5B,KAAK,EACD,OAAQjjB,GACJ,KAAK,EACD,OAAO/gB,KAAK8lB,IAAIg/B,KACpB,KAAK,EACD,OAAO9kD,KAAK8lB,IAAIi/B,MACpB,KAAK,EACD,OAAO/kD,KAAK8lB,IAAIk/B,OAGpB,QACI,OAAOhlD,KAAK8lB,IAAIie,QAE5B,KAAK,GACD,OAAO/jC,KAAK8lB,IAAIm/B,OACpB,KAAK,GACD,OAAOjlD,KAAK8lB,IAAIo/B,eACpB,KAAK,GACD,OAAOllD,KAAK8lB,IAAIq/B,QACpB,KAAK,EACD,OAAOnlD,KAAK8lB,IAAIs/B,MACpB,KAAK,EACD,OAAOplD,KAAK8lB,IAAIu/B,QACpB,KAAK,GACD,OAAQtkC,GACJ,KAAK,EAIL,QACI,OAAO/gB,KAAK8lB,IAAIw/B,SAHpB,KAAK,GACD,OAAOtlD,KAAK8lB,IAAIy/B,YAKhC,OAAOljC,EAAgBriB,KAAK8lB,IAAIshB,aAAepnC,KAAK8lB,IAAIw9B,OAM5D3qB,EAAW55B,UAAUymD,gCAAkC,SAAUrxC,GAC7D,OAAa,IAATA,EACOnU,KAAK8lB,IAAIke,QAEF,IAAT7vB,EACEnU,KAAK8lB,IAAIie,QAEb/jC,KAAK8lB,IAAIw9B,OAWpB3qB,EAAW55B,UAAUwmB,UAAY,SAAU/B,EAAKnU,EAAWo2C,EAAYxL,EAAiByL,EAAgBp2C,GACpG,IAAI5I,EAAQ1G,KACR0P,EAAUipB,EAAWgtB,mBAAmBniC,EAAKnU,EAAWo2C,EAAYxL,EAAiByL,EAAgBp2C,GAKzG,OAJAtP,KAAKq7B,gBAAgBl5B,KAAKuN,GAC1BA,EAAQk2C,qBAAqBl1C,KAAI,SAAUhB,GACvChJ,EAAM20B,gBAAgBp5B,OAAOyE,EAAM20B,gBAAgBnX,QAAQxU,GAAU,MAElEA,GAaXipB,EAAWgtB,mBAAqB,SAAUniC,EAAKnU,EAAWo2C,EAAYxL,EAAiByL,EAAgBp2C,GACnG,MAAM,OAAY,cAYtBqpB,EAAW55B,UAAUuiD,WAAa,SAAUv+C,EAAGC,EAAG2V,EAAOE,EAAQgtC,EAAUC,QACtD,IAAbD,IAAuBA,GAAW,QAChB,IAAlBC,IAA4BA,GAAgB,GAChD,IAAIC,EAAcF,EAAW,EAAI,EAC7B9kC,EAAS8kC,EAAW7lD,KAAK8lB,IAAI80B,KAAO56C,KAAK8lB,IAAI+0B,IAC7CrrC,EAAO,IAAIoS,WAAW/I,EAASF,EAAQotC,GAK3C,OAJID,GACA9lD,KAAKkqC,mBAETlqC,KAAK8lB,IAAIw7B,WAAWv+C,EAAGC,EAAG2V,EAAOE,EAAQkI,EAAQ/gB,KAAK8lB,IAAIi1B,cAAevrC,GAClEhQ,QAAQC,QAAQ+P,IAE3B1Q,OAAOI,eAAey5B,EAAY,mBAAoB,CAIlDx5B,IAAK,WACD,OAAOK,QAAQC,QAAQO,KAAKgmD,gBAEhCh/C,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAey5B,EAAY,cAAe,CAI7Cx5B,IAAK,WACD,OAAOa,KAAKgmD,eAEhBh/C,YAAY,EACZC,cAAc,IAQlB0xB,EAAWqtB,YAAc,WACrB,GAAwC,OAApChmD,KAAKimD,2BACL,OAAQjmD,KAAKimD,2BAEjB,GAA0B,OAAtBjmD,KAAKkmD,aACL,IACI,IAAIC,EAAanmD,KAAK4gC,cAAc,EAAG,GACnCkK,EAAKqb,EAAWjqB,WAAW,UAAYiqB,EAAWjqB,WAAW,sBACjEl8B,KAAKkmD,aAAqB,MAANpb,KAAgBj7B,OAAOu2C,sBAE/C,MAAOznB,GACH3+B,KAAKkmD,cAAe,EAG5B,OAAOlmD,KAAKkmD,cAEhBpnD,OAAOI,eAAey5B,EAAY,4BAA6B,CAI3Dx5B,IAAK,WACD,GAAwC,OAApCa,KAAKimD,2BACL,IACI,IAAIE,EAAanmD,KAAK4gC,cAAc,EAAG,GACnCkK,EAAKqb,EAAWjqB,WAAW,QAAS,CAAEmqB,8BAA8B,KACpEF,EAAWjqB,WAAW,qBAAsB,CAAEmqB,8BAA8B,IAChFrmD,KAAKimD,4BAA8Bnb,EAEvC,MAAOnM,GACH3+B,KAAKimD,4BAA6B,EAG1C,OAAOjmD,KAAKimD,4BAEhBj/C,YAAY,EACZC,cAAc,IAOlB0xB,EAAW2tB,WAAa,SAAUvjD,GAQ9B,OAPAA,IACAA,GAAKA,GAAK,EACVA,GAAKA,GAAK,EACVA,GAAKA,GAAK,EACVA,GAAKA,GAAK,EACVA,GAAKA,GAAK,KACVA,GAQJ41B,EAAW4tB,SAAW,SAAUxjD,GAM5B,OALAA,GAASA,GAAK,EACdA,GAASA,GAAK,EACdA,GAASA,GAAK,EACdA,GAASA,GAAK,GACdA,GAASA,GAAK,KACFA,GAAK,IAOrB41B,EAAW6tB,WAAa,SAAUzjD,GAC9B,IAAI0jD,EAAI9tB,EAAW2tB,WAAWvjD,GAC1B2jD,EAAI/tB,EAAW4tB,SAASxjD,GAC5B,OAAO0jD,EAAI1jD,EAAIA,EAAI2jD,EAAIA,EAAID,GAS/B9tB,EAAW2kB,iBAAmB,SAAUj+C,EAAOqiB,EAAKvD,GAEhD,IAAIwoC,EACJ,YAFa,IAATxoC,IAAmBA,EAAO,GAEtBA,GACJ,KAAK,EACDwoC,EAAMhuB,EAAW4tB,SAASlnD,GAC1B,MACJ,KAAK,EACDsnD,EAAMhuB,EAAW6tB,WAAWnnD,GAC5B,MAEJ,QACIsnD,EAAMhuB,EAAW2tB,WAAWjnD,GAGpC,OAAOoiB,KAAK0d,IAAIwnB,EAAKjlC,IAQzBiX,EAAW0Q,cAAgB,SAAU9sB,EAAMjL,GACvC,OAAK,WAMAA,IACDA,EAAYzB,QAEZyB,EAAUs1C,0BACHt1C,EAAUs1C,0BAA0BrqC,GAEtCjL,EAAUC,sBACRD,EAAUC,sBAAsBgL,GAElCjL,EAAUu1C,wBACRv1C,EAAUu1C,wBAAwBtqC,GAEpCjL,EAAUw1C,4BACRx1C,EAAUw1C,4BAA4BvqC,GAExCjL,EAAUy1C,yBACRz1C,EAAUy1C,yBAAyBxqC,GAErCjL,EAAU01C,uBACR11C,EAAU01C,uBAAuBzqC,GAGjC1M,OAAO2jB,WAAWjX,EAAM,KA3BM,oBAA1BhL,sBACAA,sBAAsBgL,GAE1BiX,WAAWjX,EAAM,KA+BhCoc,EAAW55B,UAAU6S,gBAAkB,WACnC,OAAI5R,KAAKm8B,kBAAoBn8B,KAAKm8B,iBAAiB4M,cACxC/oC,KAAKm8B,iBAAiB4M,eAE1B,UAAwB9L,SAAW,MAG9CtE,EAAWyE,cAAgB,CACvB,CAAEC,IAAK,cAAeI,QAAS,yBAA0BC,kBAAmB,IAAKJ,QAAS,CAAC,kBAC3F,CAAED,IAAK,aAAcI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,kBACvE,CAAED,IAAK,aAAcI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,kBACvE,CAAED,IAAK,qBAAsBI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,QAC/E,CAAED,IAAK,qBAAsBI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,QAC/E,CAAED,IAAK,qBAAsBI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,QAC/E,CAAED,IAAK,oBAAqBI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,QAC9E,CAAED,IAAK,oBAAqBI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,QAC9E,CAAED,IAAK,iBAAkBI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,kBAE3E,CAAED,IAAK,gCAAiCI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,YAAa,mBAEvG,CAAED,IAAK,gCAAiCI,QAAS,KAAMC,kBAAmB,KAAMJ,QAAS,CAAC,YAAa,oBAG3G3E,EAAW8gB,gBAAkB,GAK7B9gB,EAAWsuB,kBAAoB,KAE/BtuB,EAAWutB,aAAe,KAC1BvtB,EAAWstB,2BAA6B,KACjCttB,EAlvJoB,I,kcCU3BuuB,EAA8B,SAAU5gD,GAOxC,SAAS4gD,EAAatmC,EAAQtX,QACV,IAAZA,IAAsBA,EAAU,IACpC,IACIrJ,EAAI0Z,EAAI+c,EAAIC,EADZjwB,EAAQ1G,KA+FZ,IA7FA0G,EAAQJ,EAAOrH,KAAKe,KAAM,OAASA,MAE7BmnD,yBAA2B,CAAEjnD,MAAO,UAC1CwG,EAAM0gD,yBAA2B,CAAElnD,MAAO,UAC1CwG,EAAM2gD,+BAAiC,CAAEnnD,MAAO,gBAEhDwG,EAAM4gD,iBAAmB,EAEzB5gD,EAAM6gD,wBAA0B,EAEhC7gD,EAAM8gD,mBAAqB,EAC3B9gD,EAAM+gD,oBAAsB,EAC5B/gD,EAAMghD,SAAW,KACjBhhD,EAAMihD,UAAY,KAElBjhD,EAAMkhD,wBAA0B,GAEhClhD,EAAMmhD,UAAY,CACdC,iBAAkB,EAClBC,qBAAsB,EACtBC,+BAAgC,EAChCC,4BAA6B,GAKjCvhD,EAAMwhD,kBAAoB,CACtBJ,iBAAkB,EAClBC,qBAAsB,EACtBC,+BAAgC,EAChCC,4BAA6B,GAKjCvhD,EAAMyhD,uBAAyB,GAC/BzhD,EAAM0hD,gBAAkB,CAAC,KAAM,KAAM,MAGrC1hD,EAAM2hD,mBAAqB,KAE3B3hD,EAAM4hD,uBAAyB,IAAI,IAEnC5hD,EAAM6hD,sBAAwB,IAAI,IAElC7hD,EAAM8hD,sBAAwB,GAE9B9hD,EAAM+hD,oCAAsC,IAAI,KAChD/hD,EAAMgiD,8BAAgC,KACtChiD,EAAMiiD,oBAAsB,KAC5BjiD,EAAMkiD,kBAAmB,EACzBliD,EAAMmiD,oBAAqB,EAG3BniD,EAAMoiD,mBAAoB,EAE1BpiD,EAAMqiD,iBAAkB,EAExBriD,EAAMsiD,8BAA+B,EAErCtiD,EAAMuiD,wBAA0B,GAEhCviD,EAAMwiD,wBAAyB,EAE/BxiD,EAAMyiD,+BAAgC,EAKtCziD,EAAM0iD,kBAAoB,CACtB,CAAErmD,EAAG,EAAGC,EAAG,EAAGK,EAAG,EAAGgmD,EAAG,GACvB,CAAEtmD,EAAG,EAAGC,EAAG,EAAGK,EAAG,EAAGgmD,EAAG,IAE3B3iD,EAAM4iD,iBAAmB,CACrB,CAAEvmD,EAAG,EAAGC,EAAG,EAAGK,EAAG,EAAGgmD,EAAG,GACvB,CAAEtmD,EAAG,EAAGC,EAAG,EAAGK,EAAG,EAAGgmD,EAAG,IAE3B3iD,EAAM6iD,eAAiB,CAAExmD,EAAG,EAAGC,EAAG,EAAGG,EAAG,EAAGE,EAAG,GAC9CqD,EAAM8iD,oBAAsB,EAAE,GAAI,GAClC9iD,EAAM+iD,oBAAsB,CACxB,CAAC,KAAM,KAAM,KAAM,MACnB,CAAC,KAAM,KAAM,KAAM,OAEvB/iD,EAAMoyB,MAAQ,SACdpyB,EAAM0yB,iBAAkB,EACxB1yB,EAAM2yB,qBAAsB,EAC5B/vB,EAAQogD,iBAAmBpgD,EAAQogD,kBAAoB,GACvDpgD,EAAQqgD,gBAAkBrgD,EAAQqgD,iBAAmB,gBACrDrgD,EAAQsgD,kBAAwC/mD,IAAzByG,EAAQsgD,cAAoCtgD,EAAQsgD,aAC3EtgD,EAAQ2I,QAAqC,QAA1BhS,EAAKqJ,EAAQ2I,eAA4B,IAAPhS,GAAgBA,EACrEqJ,EAAQugD,sBAAiE,QAAxClwC,EAAKrQ,EAAQugD,6BAA0C,IAAPlwC,GAAgBA,EACjG,yBAA6CrQ,EAAQgpB,wBACrD,IAAAC,IAAW,eAAe5nB,OAAO,YAAgB,OAAOA,OAAOjE,EAAMg5B,YAAa,aAC7E7C,UAAUitB,IAEX,OADA,UAAa,4CACNpjD,EAEXA,EAAMi1B,WAAY,EAClBj1B,EAAM+3B,oBAAsB,cACU57B,IAAlCyG,EAAQ4oB,wBACR5oB,EAAQ4oB,uBAAwB,QAEHrvB,IAA7ByG,EAAQ6oB,mBACR7oB,EAAQ6oB,iBAAmB,QAEHtvB,IAAxByG,EAAQgzB,cACRhzB,EAAQgzB,aAAc,GAE1B51B,EAAMqjD,uBAAyBzgD,EAAQ4oB,sBACvCxrB,EAAMsjD,kBAAoB1gD,EAAQ6oB,iBAClCzrB,EAAMujD,UAAY3gD,EAAQ8yB,UAAY,EAAI,GAC1C11B,EAAMshB,0BAA4B1e,EAAQwb,uBAC1Cpe,EAAMwjD,QAAUtpC,EAChBla,EAAM2rB,SAAW/oB,EACjB5C,EAAM+0B,mBAA2D,QAArC/E,EAAKptB,EAAQmyB,0BAAuC,IAAP/E,GAAgBA,EACzF,IAAIxmB,GAAmB,WAAwBL,OAAOK,kBAA0B,EAC5EgvB,EAAmB51B,EAAQ41B,kBAAoBhvB,EAC/C3G,EAA2D,QAArCotB,EAAKrtB,EAAQC,0BAAuC,IAAPotB,GAAgBA,EAOvF,OANAjwB,EAAMyJ,sBAAwB5G,EAAqB,EAAMkY,KAAK0d,IAAID,EAAkBhvB,GAAoB,EACxGxJ,EAAMyjD,qBAAuB7gD,EAAQsgD,aAAeljD,EAAM+gD,oBAAsB,EAChF/gD,EAAM04B,iBAAmB91B,EAAQ2I,QACjCvL,EAAM86B,YAAY5gB,IAAUtX,EAAQm4B,uBAAwBn4B,EAAQgzB,aACpE51B,EAAM8J,iBAAmB,IAAI,IAC7B9J,EAAM0jD,qBAAuB,IAAI,IAC1B1jD,EA+pFX,OAryFA,QAAUwgD,EAAc5gD,GAwIxBxH,OAAOI,eAAegoD,EAAanoD,UAAW,wBAAyB,CAInEI,IAAK,WACD,OAAOa,KAAKqqD,mBAAmBlsC,MAEnC/e,IAAK,SAAU+e,GACXne,KAAKqqD,mBAAmBlsC,KAAOA,GAEnCnX,YAAY,EACZC,cAAc,IAKlBigD,EAAanoD,UAAU2hC,uBAAyB,WAC5C1gC,KAAKqqD,mBAAmBrqC,SAE5BlhB,OAAOI,eAAegoD,EAAanoD,UAAW,oBAAqB,CAK/DI,IAAK,WACD,OAAOa,KAAKqqD,mBAAmBC,SAEnClrD,IAAK,SAAUqhC,GACXzgC,KAAKqqD,mBAAmBC,QAAU7pB,GAEtCz5B,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,uBAAwB,CAIlEI,IAAK,WACD,QAAOa,KAAKuqD,eAAgBvqD,KAAKuqD,cAAcC,UAEnDprD,IAAK,SAAUqrD,GACPzqD,KAAKuqD,gBACLvqD,KAAKuqD,cAAcC,SAAWC,IAGtCzjD,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,8BAA+B,CAIzEI,IAAK,WACD,QAAOa,KAAK0qD,sBAAuB1qD,KAAK0qD,qBAAqBF,UAEjEprD,IAAK,SAAUqrD,GACPzqD,KAAK0qD,uBACL1qD,KAAK0qD,qBAAqBF,SAAWC,IAG7CzjD,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,yBAA0B,CAIpEI,IAAK,WACD,QAAOa,KAAK2qD,kBAAmB3qD,KAAK2qD,iBAAiBH,UAEzDprD,IAAK,SAAUqrD,GACPzqD,KAAK2qD,mBACL3qD,KAAK2qD,iBAAiBH,SAAWC,IAGzCzjD,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAc,mBAAoB,CAIpD/nD,IAAK,WACD,OAAQ09B,UAAUitB,IAEZjtB,UAAUitB,IACPc,iBACAzhC,MAAK,SAAU0hC,GAAW,QAASA,KAAY,WAAc,OAAO,KACpEC,OAAM,WAAc,OAAO,KAJ9BtrD,QAAQC,SAAQ,IAM1BuH,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAc,cAAe,CAI/C/nD,IAAK,WAED,OADA,SAAY,+CACL,GAEX6H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,yBAA0B,CAIpEI,IAAK,WACD,OAAO,GAEX6H,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,sBAAuB,CAEjEI,IAAK,WACD,OAAOa,KAAK+qD,6BAEhB/jD,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,oBAAqB,CAE/DI,IAAK,WACD,OAAOa,KAAKgrD,0BAEhBhkD,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,cAAe,CAIzDI,IAAK,WAED,OADkBa,KAAKkC,KAAOlC,KAAKgoC,SAGvChhC,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,UAAW,CAIrDI,IAAK,WACD,OAAO,GAEX6H,YAAY,EACZC,cAAc,IAMlBigD,EAAanoD,UAAU6oC,QAAU,WAC7B,MAAO,CACHE,OAAQ,iBACRC,SAAU,mBACVC,QAAS,oBAGjBlpC,OAAOI,eAAegoD,EAAanoD,UAAW,oBAAqB,CAM/DI,IAAK,WACD,OAAOa,KAAKirD,oBAEhB7rD,IAAK,SAAU+e,GACXne,KAAKirD,mBAAqB9sC,GAE9BnX,YAAY,EACZC,cAAc,IAElBnI,OAAOI,eAAegoD,EAAanoD,UAAW,qBAAsB,CAEhEI,IAAK,WACD,OAAOa,KAAK0Y,qBAAuB1Y,KAAK0Y,qBAAqBmR,QAAU7pB,KAAKmqD,sBAEhFnjD,YAAY,EACZC,cAAc,IAQlBigD,EAAagE,YAAc,SAAUtqC,EAAQtX,QACzB,IAAZA,IAAsBA,EAAU,IACpC,IAAIjJ,EAAS,IAAI6mD,EAAatmC,EAAQtX,GACtC,OAAO,IAAI9J,SAAQ,SAAUC,GACzBY,EAAO8qD,UAAU7hD,EAAQ8hD,eAAgB9hD,EAAQ+hD,cAAcliC,MAAK,WAAc,OAAO1pB,EAAQY,UAYzG6mD,EAAanoD,UAAUosD,UAAY,SAAUC,EAAgBC,GACzD,IACIprD,EADAyG,EAAQ1G,KAEZ,OAAOA,KAAKsrD,aAAaF,QAAuDA,EAA0C,QAAxBnrD,EAAKD,KAAKqyB,gBAA6B,IAAPpyB,OAAgB,EAASA,EAAGmrD,gBACzJjiC,MAAK,SAAUoiC,GAChB,IAAItrD,EAGJ,OAFAyG,EAAMghD,SAAW6D,EACjB7kD,EAAMihD,UAAYT,EAAasE,SAAW,IAAI,IAAmB,KAC1D9kD,EAAMihD,UACPjhD,EAAMihD,UAAU8D,UAAUJ,QAAmDA,EAAyC,QAAzBprD,EAAKyG,EAAM2rB,gBAA6B,IAAPpyB,OAAgB,EAASA,EAAGorD,cAAcliC,MAAK,WAC3K,OAAO0T,UAAUitB,IAAIc,eAAelkD,EAAM2rB,aAC3C,SAAUq5B,GAGT,MAFA,UAAa,6BACb,UAAaA,GACP7qD,MAAM,sCAEdg8B,UAAUitB,IAAIc,eAAelkD,EAAM2rB,aAC1C,SAAUq5B,GAGT,MAFA,UAAa,+BACb,UAAaA,GACP7qD,MAAM,sCAEXsoB,MAAK,SAAU0hC,GAChB,IAAI5qD,EACJ,GAAK4qD,EAGA,CACDnkD,EAAMilD,SAAWd,EACjBnkD,EAAMqkD,4BAA8B,GACD,QAAlC9qD,EAAKyG,EAAMilD,SAASC,gBAA6B,IAAP3rD,GAAyBA,EAAG2B,SAAQ,SAAUiqD,GAAW,OAAOnlD,EAAMqkD,4BAA4B5oD,KAAK0pD,MAClJ,IAAInC,EAAmBhjD,EAAM2rB,SAASq3B,iBACtC,GAAIA,aAA2D,EAASA,EAAiBoC,iBAAkB,CAGvG,IAFA,IACIC,EAAkB,GACbh7C,EAAK,EAAGi7C,EAFStC,EAAiBoC,iBAEmB/6C,EAAKi7C,EAAsBjqD,OAAQgP,IAAM,CACnG,IAAIwT,EAAYynC,EAAsBj7C,IACwB,IAA1DrK,EAAMqkD,4BAA4B7mC,QAAQK,IAC1CwnC,EAAgB5pD,KAAKoiB,GAG7BmlC,EAAiBoC,iBAAmBC,EAExC,OAAOrlD,EAAMilD,SAASM,cAAcvlD,EAAM2rB,SAASq3B,kBAlBnD,KAAM,4DAqBTvgC,MAAK,SAAU+iC,GAChB,IAAIjsD,EAAI0Z,EACRjT,EAAMylD,QAAUD,EAChBxlD,EAAMskD,yBAA2B,GACC,QAAjC/qD,EAAKyG,EAAMylD,QAAQP,gBAA6B,IAAP3rD,GAAyBA,EAAG2B,SAAQ,SAAUiqD,GAAW,OAAOnlD,EAAMskD,yBAAyB7oD,KAAK0pD,MAC9I,IAAIO,GAAuB,EAC3B1lD,EAAMylD,QAAQjvB,iBAAiB,mBAAmB,SAAUmvB,KAClDD,EAAsB1lD,EAAMyhD,uBAC9B,SAAY,4BAA4Bx9C,OAAOyhD,EAAsB,EAAG,OAAOzhD,OAAO0hD,EAAMtlC,MAAO,OAAOpc,OAAO0hD,EAAMtlC,MAAMvB,UAExH4mC,MAA0B1lD,EAAMyhD,wBACrC,SAAY,+CAA+Cx9C,OAAOjE,EAAMyhD,uBAAwB,4EAGnGzhD,EAAMshB,yBACuB,QAA7BrO,EAAKjT,EAAMylD,QAAQG,YAAyB,IAAP3yC,GAAyBA,EAAGwP,MAAK,SAAUhB,GAC7EzhB,EAAMwzB,iBAAkB,EACxB,SAAY,wBAA0B/R,GACtCzhB,EAAMszB,wBAAwB16B,gBAAgBoH,GAC9CA,EAAM03B,+BAA+B13B,EAAMykD,UAAU7sB,KAAK53B,UAGnE,SAAUi4B,GACT,UAAa,uCACb,UAAaA,MAEZxV,MAAK,WACNziB,EAAM6lD,eAAiB,IAAI,IAAoB7lD,EAAMylD,SACrDzlD,EAAM8lD,eAAiB,IAAI,IAAoB9lD,EAAMylD,QAASzlD,EAAMghD,SAAUhhD,EAAMihD,UAAWjhD,EAAM6lD,gBACrG7lD,EAAM6jD,cAAgB,IAAI,EAAAkC,EAAmB/lD,EAAMylD,SACnDzlD,EAAMikD,iBAAmB,IAAI,IAAsBjkD,EAAMylD,QAASzlD,EAAM6jD,cAAe7jD,GACvFA,EAAMgmD,gBAAkB,IAAI,IAAqBhmD,EAAMylD,QAASzlD,EAAM6lD,gBACtE7lD,EAAMimD,gBAAkBjmD,EAAMylD,QAAQS,eAAiB,IAAI,IAAqBlmD,EAAOA,EAAMylD,QAASzlD,EAAM6lD,qBAAkB1pD,EAC9H6D,EAAMmmD,YAAc,IAAI,KAAiBnmD,EAAMylD,SAC/CzlD,EAAMomD,wBAA0B,IAAI,KAAiBpmD,EAAMylD,SAC3DzlD,EAAM2jD,mBAAqB,IAAI,IAAwB3jD,EAAOA,EAAMk1B,uBAAwBl1B,EAAMmmD,YAAanmD,EAAMomD,yBACrHpmD,EAAMqmD,WAAarmD,EAAM6lD,eAAexf,aAAa,IAAI55B,aAAa,EAAE,EAAG,IAAK,aAAsC,cACtHzM,EAAMsmD,eAAiBtmD,EAAM6lD,eAAexf,aAAa,IAAI55B,aAAa,CAAC,EAAG,IAAK,aAAsC,cACrHzM,EAAMsiD,mCACenmD,IAAjB6D,EAAMumD,SACNvmD,EAAMumD,OAAS,GAIvBvmD,EAAMwmD,eAAiBxmD,EAAMylD,QAAQgB,qBAAqBzmD,EAAMygD,0BAChEzgD,EAAM0mD,eAAiB1mD,EAAMylD,QAAQgB,qBAAqBzmD,EAAM0gD,0BAChE1gD,EAAM2mD,qBAAuB3mD,EAAMylD,QAAQgB,qBAAqBzmD,EAAM2gD,gCACtE3gD,EAAM4mD,mBAAqB,IAAI,IAAa5mD,EAAO,CAAC,GAAI,IAAI,GAAO,EAAO,GAAG,EAAO,EAAG,GACvFA,EAAM6mD,oBACN7mD,EAAMgkD,qBAAuB,IAAI,IAA8BhkD,EAAMylD,QAASzlD,EAAM4mD,oBAAqB5mD,EAAMoE,MAAMwB,6BACrH5F,EAAMuZ,mBAAqB,IAAI,IAAwBvZ,EAAMgkD,sBAC7DhkD,EAAMqZ,sBAAwB,IAAI,IAA2BrZ,EAAMgkD,sBACnEhkD,EAAMqZ,sBAAsBkc,cAAgBv1B,EAAM2zB,cAClD3zB,EAAMuZ,mBAAmB+gB,WAAY,EACrCt6B,EAAMuZ,mBAAmB7E,UAAY,IACrC1U,EAAMuZ,mBAAmBghB,WAAY,EACrCv6B,EAAM8lD,eAAegB,kBAAkB9mD,EAAMwmD,gBAC7CxmD,EAAM+mD,WAAa,IAAI,IAAgB/mD,EAAMylD,QAASzlD,EAAOA,EAAM4mD,oBACnE5mD,EAAMgnD,oBAAsBhnD,EAAMoP,oBAClCpP,EAAMinD,oBAAsBjnD,EAAMgnD,oBAClChnD,EAAMknD,wBAA0BlnD,EAAMmP,wBACtCnP,EAAMmnD,wBAA0BnnD,EAAMknD,wBACtClnD,EAAMonD,iCACNpnD,EAAMqnD,6BACNrnD,EAAM0J,YAEL06C,OAAM,SAAUnsB,GACjB,UAAa,gDACb,UAAaA,GACTqvB,QAAQC,UAKpB/G,EAAanoD,UAAUusD,aAAe,SAAUF,GAG5C,OAFAA,EAAiBA,GAAkB,IACnCA,GAAiB,SAAS,QAAS,GAAIlE,EAAagH,0BAA2B9C,IAC5DG,QACR/rD,QAAQC,QAAQ2rD,EAAeG,SAEtC1sD,KAAK0sD,QACE1sD,KAAK0sD,QAAQH,EAAe+C,UAEnC/C,EAAegD,QAAUhD,EAAe+C,UACpC,UACO,qBAAsB/C,EAAegD,QAAQjlC,MAAK,WACrD,OAAOtqB,KAAK0sD,QAAQH,EAAe+C,cAIvCE,cAAcjD,EAAegD,QACtBvvD,KAAK0sD,QAAQH,EAAe+C,WAGpC3uD,QAAQinB,OAAO,6BAE1BygC,EAAanoD,UAAUwuD,kBAAoB,WAGvCvtD,KAAK8K,MAAQ,CACTC,sBAAuB,GACvBC,2BAA4B,GAC5BC,8BAA+B,GAC/BC,eAAgB,KAChBE,sBAAuB,KACvBC,qBAAsB,KACtBC,iBAAkB,GAClBC,kBAAmB,GACnBC,0BAA2B,KAC3BC,wBAAyB,KACzBC,qBAAqB,EACrBC,KAAO3L,KAAKgrD,yBAAyB9mC,QAAQ,8BAAuD,QAAWrhB,EAC/GkgC,KAAO/iC,KAAKgrD,yBAAyB9mC,QAAQ,4BAAqD,QAAWrhB,EAC7G+I,MAAO,KACPC,KAAM,KACNC,KAAO9L,KAAKgrD,yBAAyB9mC,QAAQ,8BAAuD,QAAWrhB,EAC/GkJ,KAAM/L,KAAKgrD,yBAAyB9mC,QAAQ,4BAAqD,QAAWrhB,EAC5GmJ,cAAe,EACfC,aAAa,EACbC,wBAAwB,EACxBC,8BAA8B,EAC9BC,kBAAkB,EAClBC,cAAc,EACdC,6BAA6B,EAC7BC,oBAAoB,EACpBC,kBAAkB,EAClBC,iCAAiC,EACjCC,wBAAwB,EACxBC,YAAY,EACZC,sBAAsB,EACtBC,uBAAuB,EACvBC,mBAAmB,EACnBC,iBAAiB,EACjBm2B,WAAsC,oBAAnBorB,iBAAkH,IAAhFtuD,KAAKuuD,kBAAkBrqC,QAAQ,2BAA4DrhB,EAChJmK,sBAAiD,oBAAnBshD,eAC9BrhD,8BAA8B,EAC9Bk2B,WAAW,EACXC,iBAAiB,EACjBzD,2BAAuB98B,EACvBqK,aAAa,EACbC,eAAgB,EAChBC,oBAAoB,EACpBC,kBAAkB,EAClBC,uBAAuB,EACvBC,oBAAoB,EACpBC,2BAA2B,EAC3BC,iBAAiB,EACjBC,4BAA6B,MAEjC1N,KAAK8K,MAAM60B,sBAAwB,KACnC3/B,KAAK4N,UAAY,CACbC,iCAAiC,EACjCC,2CAA2C,EAC3CC,4BAA4B,EAC5BC,uBAAuB,EACvBC,8BAA8B,EAC9BC,0BAA0B,EAC1BC,kBAAkB,EAClBC,8BAA8B,EAC9BC,YAAY,EACZC,eAAe,EACfC,mBAAmB,EACnBC,iCAAiC,EACjCC,aAAa,EACbC,cAAc,EACdC,+BAA+B,EAC/BC,2BAA2B,EAC3BC,wBAAwB,EACxBC,sBAAsB,EACtBC,oBAAoB,EACpBC,wBAAwB,EACxBC,gCAAgC,EAChCC,qBAAqB,EACrBC,4BAA4B,IAGpC+3C,EAAanoD,UAAU+uD,+BAAiC,WACpD9tD,KAAKwuD,SAAWxuD,KAAKkqD,QAAQhuB,WAAW,UACxCl8B,KAAKyuD,oBACLzuD,KAAK0uD,aAAe1uD,KAAKqyB,SAASs3B,gBAClC3pD,KAAKsoD,uBAAuBqG,2BAA6B,CAAC,IAAI,KAC9D3uD,KAAKsoD,uBAAuBqG,2BAA2B,GAAG5tC,OAAS/gB,KAAK0uD,cAG5ExH,EAAanoD,UAAUgvD,2BAA6B,WAChD,IAAI9tD,EACJD,KAAK4uD,oBAAsB,CACvBj2C,MAAO3Y,KAAKwY,iBACZK,OAAQ7Y,KAAK4Y,kBACbi2C,mBAAoB,GAExB,IAGIC,EAHAC,EAAmB,IAAI57C,aAAa,CAACnT,KAAK4Y,oBAI9C,GAHA5Y,KAAKusD,eAAeyC,WAAWhvD,KAAK+sD,WAAY,EAAGgC,GACnD/uD,KAAKusD,eAAeyC,WAAWhvD,KAAKgtD,eAAgB,EAAG+B,GAEnD/uD,KAAKqyB,SAASu3B,aAAc,CAC5B,IAAIqF,EAAwB,CACxBxoD,KAAMzG,KAAK4uD,oBACXM,cAAe,EACfC,YAAanvD,KAAKmqD,qBAClBiF,UAAW,SACXruC,OAAQ/gB,KAAKqyB,SAASs3B,gBACtB9c,MAAO,uBAEkB,QAA5B5sC,EAAKD,KAAKqvD,oBAAiC,IAAPpvD,GAAyBA,EAAGqvD,UACjEtvD,KAAKqvD,aAAervD,KAAKmsD,QAAQ5rC,cAAc0uC,GAC/CH,EAAuB,CACnB,CACIS,KAAMvvD,KAAKqvD,aAAaG,aACxBC,WAAY,IAAI,KAAO,EAAG,EAAG,EAAG,GAChCC,OAAQ,WACRC,QAAS,kBAKjBb,EAAuB,CACnB,CACIS,UAAM1sD,EACN4sD,WAAY,IAAI,KAAO,EAAG,EAAG,EAAG,GAChCC,OAAQ,WACRC,QAAS,aAIrB3vD,KAAKsoD,uBAAuBlyB,mBAAqBp2B,KAAK4vD,gBAAkB,yBAAoD,kBAC5H5vD,KAAK6vD,uBAAuB7vD,KAAKsoD,wBACjC,IAAIwH,EAAyB,CACzBrpD,KAAMzG,KAAK4uD,oBACXM,cAAe,EACfC,YAAanvD,KAAKmqD,qBAClBiF,UAAW,SACXruC,OAAQ/gB,KAAKsoD,uBAAuBlyB,mBACpCyW,MAAO,uBAEP7sC,KAAK+vD,eACL/vD,KAAK+vD,cAAcT,UAEvBtvD,KAAK+vD,cAAgB/vD,KAAKmsD,QAAQ5rC,cAAcuvC,GAChD,IAAIE,EAAsB,CACtBT,KAAMvvD,KAAK+vD,cAAcP,aACzBS,gBAAiBjwD,KAAKsnD,iBACtB4I,YAAa,WACbC,aAAc,WACdC,kBAAmBpwD,KAAKwnD,mBACxB6I,cAAgBrwD,KAAK4vD,gBAA8B,gBAAZ/sD,EACvCytD,eAAiBtwD,KAAK4vD,gBAA8B,gBAAZ/sD,GAE5C7C,KAAKsoD,uBAAuBiI,qBAAuB,CAC/CC,iBAAkB1B,EAClB2B,uBAAwBT,GAEmB,OAA3ChwD,KAAKsoD,uBAAuBoI,YAC5B1wD,KAAK2wD,sBAGbzJ,EAAanoD,UAAU0vD,kBAAoB,WACvCzuD,KAAKwuD,SAASoC,UAAU,CACpB1E,OAAQlsD,KAAKmsD,QACbprC,OAAQ/gB,KAAKqyB,SAASs3B,gBACtB9c,MAAO,sBAAgD,aACvDgkB,qBAAsB7wD,KAAKy7B,mBAAqB,mBAA2D,eAUnHyrB,EAAanoD,UAAU0rC,QAAU,SAAU9xB,EAAOE,EAAQsxB,GAEtD,YADqB,IAAjBA,IAA2BA,GAAe,KACzC7jC,EAAOvH,UAAU0rC,QAAQxrC,KAAKe,KAAM2Y,EAAOE,EAAQsxB,KAGpDnqC,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAI3CjpD,KAAK+tD,6BACD/tD,KAAK2gC,mBAEL3gC,KAAK0gC,0BAEF,IAMXwmB,EAAanoD,UAAU6gC,oBAAsB,SAAU3H,GACnD,OAAIA,IAAmB,SACZj4B,KAAKoqD,qBAETpqD,KAAKwQ,kBAMhB02C,EAAanoD,UAAU2iC,4BAA8B,SAAUzJ,GAC3D,OAAO,IAAI,IAA8BA,IAM7CivB,EAAanoD,UAAU0qC,YAAc,WACjCzpC,KAAK+f,sBAAsB3d,QAC3BpC,KAAK0qD,qBAAqBoG,qBAAqB9wD,KAAKkgB,YAAY+S,aAOpEi0B,EAAanoD,UAAU4gB,WAAa,SAAUC,GACtC5f,KAAK6f,gCAAkCD,IAK3C5f,KAAK6oD,oBAAqB,EAC1B7oD,KAAK2oD,oBAAsB,KAC3B3oD,KAAK0oD,8BAAgC,KACrC1oD,KAAK0qD,qBAAqBqG,WAAW,KAAM,KAAM,MAC7CnxC,IACA5f,KAAK+f,sBAAsBC,QAC3BhgB,KAAKigB,mBAAmBD,QACxBhgB,KAAKigB,mBAAmB7E,UAAY,IACpCpb,KAAKkgB,YAAYF,QACjBhgB,KAAKqe,WAAa,EAClBre,KAAKs6B,eAAiB,EACtBt6B,KAAK0qD,qBAAqBsG,qBAAqBhxD,KAAKkgB,YAAY+wC,yBAA0BjxD,KAAKkgB,YAAYgxC,0BAC3GlxD,KAAK0qD,qBAAqBoG,sBAAqB,GAC/C9wD,KAAKyb,eAAc,IAEvBzb,KAAKmgB,qBAAuB,KAC5BngB,KAAKogB,mBAAqB,KAC1BpgB,KAAKqgB,8BAAgC,OAMzC6mC,EAAanoD,UAAU0c,cAAgB,SAAUf,GAC7C1a,KAAK4oD,iBAAmBluC,EACxB1a,KAAK0qD,qBAAqByG,aAAaz2C,EAAS,GAAM,IAM1DwsC,EAAanoD,UAAU6c,cAAgB,WACnC,OAAO5b,KAAK4oD,kBAEhB1B,EAAanoD,UAAUqyD,sBAAwB,SAAU7vD,GACrDvB,KAAKopD,kBAAkB7nD,GAAOwB,EAAI,EAClC/C,KAAKopD,kBAAkB7nD,GAAOyB,EAAI,EAClChD,KAAKopD,kBAAkB7nD,GAAO8B,EAAI,EAClCrD,KAAKopD,kBAAkB7nD,GAAO8nD,EAAI,EACpB,IAAV9nD,IACAvB,KAAK67B,gBAAgB94B,EAAI,EACzB/C,KAAK67B,gBAAgB74B,EAAI,EACzBhD,KAAK67B,gBAAgB14B,EAAI,EACzBnD,KAAK67B,gBAAgBx4B,EAAI,IAGjC6jD,EAAanoD,UAAUsyD,oBAAsB,SAAUX,GACnD,IAAInvD,EAAQmvD,IAAe1wD,KAAKsoD,uBAAuBoI,WAAa,EAAI,EACpE3tD,EAAI/C,KAAK67B,gBAAgB94B,EAAGC,EAAIhD,KAAK67B,gBAAgB74B,EAAGK,EAAIrD,KAAK67B,gBAAgB14B,EAAGkmD,EAAIrpD,KAAK67B,gBAAgBx4B,EAC7G4nB,EAASjrB,KAAKopD,kBAAkB7nD,GAAOwB,IAAMA,GAAK/C,KAAKopD,kBAAkB7nD,GAAOyB,IAAMA,GAAKhD,KAAKopD,kBAAkB7nD,GAAO8B,IAAMA,GAAKrD,KAAKopD,kBAAkB7nD,GAAO8nD,IAAMA,EAO5K,OANIp+B,IACAjrB,KAAKopD,kBAAkB7nD,GAAOwB,EAAI/C,KAAK67B,gBAAgB94B,EACvD/C,KAAKopD,kBAAkB7nD,GAAOyB,EAAIhD,KAAK67B,gBAAgB74B,EACvDhD,KAAKopD,kBAAkB7nD,GAAO8B,EAAIrD,KAAK67B,gBAAgB14B,EACvDnD,KAAKopD,kBAAkB7nD,GAAO8nD,EAAIrpD,KAAK67B,gBAAgBx4B,GAEpD4nB,GAEXi8B,EAAanoD,UAAUuyD,eAAiB,SAAUZ,GAC9C,IAAI1tD,EAAIye,KAAK8vC,MAAMvxD,KAAK67B,gBAAgB74B,GACpCqmD,EAAI5nC,KAAK8vC,MAAMvxD,KAAK67B,gBAAgBx4B,GACnCrD,KAAK0Y,uBACN1V,EAAIhD,KAAK4Y,kBAAoB5V,EAAIqmD,GAErCqH,EAAW53C,YAAY2I,KAAK8vC,MAAMvxD,KAAK67B,gBAAgB94B,GAAIC,EAAGye,KAAK8vC,MAAMvxD,KAAK67B,gBAAgB14B,GAAIkmD,EAAG,EAAG,GACpGrpD,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,2BAY/C/B,EAAanoD,UAAUkrC,UAAY,SAAUlnC,EAAGC,EAAG2V,EAAOE,GACtD7Y,KAAK67B,gBAAgB94B,EAAIA,EACzB/C,KAAK67B,gBAAgB74B,EAAIA,EACzBhD,KAAK67B,gBAAgB14B,EAAIwV,EACzB3Y,KAAK67B,gBAAgBx4B,EAAIwV,GAE7BquC,EAAanoD,UAAUyyD,qBAAuB,SAAUjwD,GACpDvB,KAAKspD,iBAAiB/nD,GAAOwB,EAAI,EACjC/C,KAAKspD,iBAAiB/nD,GAAOyB,EAAI,EACjChD,KAAKspD,iBAAiB/nD,GAAO8B,EAAI,EACjCrD,KAAKspD,iBAAiB/nD,GAAO8nD,EAAI,GAErCnC,EAAanoD,UAAU0yD,mBAAqB,SAAUf,GAClD,IAAInvD,EAAQmvD,IAAe1wD,KAAKsoD,uBAAuBoI,WAAa,EAAI,EACpE3tD,EAAI/C,KAAKupD,eAAexmD,EAAGC,EAAIhD,KAAKupD,eAAevmD,EAAGK,EAAIrD,KAAKupD,eAAepmD,EAAGkmD,EAAIrpD,KAAKupD,eAAelmD,EACzG4nB,EAASjrB,KAAKspD,iBAAiB/nD,GAAOwB,IAAMA,GAAK/C,KAAKspD,iBAAiB/nD,GAAOyB,IAAMA,GAAKhD,KAAKspD,iBAAiB/nD,GAAO8B,IAAMA,GAAKrD,KAAKspD,iBAAiB/nD,GAAO8nD,IAAMA,EAOxK,OANIp+B,IACAjrB,KAAKspD,iBAAiB/nD,GAAOwB,EAAI/C,KAAKupD,eAAexmD,EACrD/C,KAAKspD,iBAAiB/nD,GAAOyB,EAAIhD,KAAKupD,eAAevmD,EACrDhD,KAAKspD,iBAAiB/nD,GAAO8B,EAAIrD,KAAKupD,eAAepmD,EACrDnD,KAAKspD,iBAAiB/nD,GAAO8nD,EAAIrpD,KAAKupD,eAAelmD,GAElD4nB,GAEXi8B,EAAanoD,UAAU2yD,cAAgB,SAAUhB,GAC7CA,EAAWiB,eAAe3xD,KAAKupD,eAAexmD,EAAG/C,KAAK0Y,qBAAuB1Y,KAAKupD,eAAevmD,EAAIhD,KAAK4Y,kBAAoB5Y,KAAKupD,eAAelmD,EAAIrD,KAAKupD,eAAevmD,EAAGhD,KAAKupD,eAAepmD,EAAGnD,KAAKupD,eAAelmD,GACpNrD,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,2BAK/C/B,EAAanoD,UAAU6yD,iBAAmB,WACtC,OAAiC,IAA1B5xD,KAAKupD,eAAexmD,GAAqC,IAA1B/C,KAAKupD,eAAevmD,GAAqC,IAA1BhD,KAAKupD,eAAepmD,GAAqC,IAA1BnD,KAAKupD,eAAelmD,GAE5H6jD,EAAanoD,UAAU8yD,cAAgB,SAAU9uD,EAAGC,EAAG2V,EAAOE,GAC1D7Y,KAAKupD,eAAexmD,EAAIA,EACxB/C,KAAKupD,eAAevmD,EAAIA,EACxBhD,KAAKupD,eAAepmD,EAAIwV,EACxB3Y,KAAKupD,eAAelmD,EAAIwV,GAE5BquC,EAAanoD,UAAU+yD,eAAiB,WACpC9xD,KAAKupD,eAAexmD,EAAI,EACxB/C,KAAKupD,eAAevmD,EAAI,EACxBhD,KAAKupD,eAAepmD,EAAI,EACxBnD,KAAKupD,eAAelmD,EAAI,EACxBrD,KAAKwxD,qBAAqB,GAC1BxxD,KAAKwxD,qBAAqB,IAE9BtK,EAAanoD,UAAUgzD,wBAA0B,SAAUxwD,GACvDvB,KAAKwpD,oBAAoBjoD,IAAU,GAEvC2lD,EAAanoD,UAAUizD,sBAAwB,SAAUtB,GACrD,IAAInvD,EAAQmvD,IAAe1wD,KAAKsoD,uBAAuBoI,WAAa,EAAI,EACpEzlC,EAASjrB,KAAK+f,sBAAsBkyC,UAAYjyD,KAAKwpD,oBAAoBjoD,GAI7E,OAHI0pB,IACAjrB,KAAKwpD,oBAAoBjoD,GAASvB,KAAK+f,sBAAsBkyC,SAE1DhnC,GAMXi8B,EAAanoD,UAAUmzD,iBAAmB,SAAUxB,GAChD,IAAIzwD,EACJywD,EAAWyB,oBAAkE,QAA7ClyD,EAAKD,KAAK+f,sBAAsBkyC,eAA4B,IAAPhyD,EAAgBA,EAAK,IAE9GinD,EAAanoD,UAAUqzD,wBAA0B,SAAU7wD,GACvDvB,KAAKypD,oBAAoBloD,GAAO,GAAKvB,KAAKypD,oBAAoBloD,GAAO,GAAKvB,KAAKypD,oBAAoBloD,GAAO,GAAKvB,KAAKypD,oBAAoBloD,GAAO,GAAK,MAExJ2lD,EAAanoD,UAAUszD,sBAAwB,SAAU3B,GACrD,IAAInvD,EAAQmvD,IAAe1wD,KAAKsoD,uBAAuBoI,WAAa,EAAI,EACpE4B,EAAatyD,KAAKkgB,YAAYqyC,gBAC9BtnC,EAASqnC,EAAW,KAAOtyD,KAAKypD,oBAAoBloD,GAAO,IAC3D+wD,EAAW,KAAOtyD,KAAKypD,oBAAoBloD,GAAO,IAClD+wD,EAAW,KAAOtyD,KAAKypD,oBAAoBloD,GAAO,IAClD+wD,EAAW,KAAOtyD,KAAKypD,oBAAoBloD,GAAO,GAOtD,OANI0pB,IACAjrB,KAAKypD,oBAAoBloD,GAAO,GAAK+wD,EAAW,GAChDtyD,KAAKypD,oBAAoBloD,GAAO,GAAK+wD,EAAW,GAChDtyD,KAAKypD,oBAAoBloD,GAAO,GAAK+wD,EAAW,GAChDtyD,KAAKypD,oBAAoBloD,GAAO,GAAK+wD,EAAW,IAE7CrnC,GAEXi8B,EAAanoD,UAAUyzD,iBAAmB,SAAU9B,GAChDA,EAAW+B,iBAAiBzyD,KAAKkgB,YAAYqyC,kBASjDrL,EAAanoD,UAAU8S,MAAQ,SAAUC,EAAOC,EAAYC,EAAOC,QAC/C,IAAZA,IAAsBA,GAAU,GAEhCH,QAAqBjP,IAAZiP,EAAM1L,IACf0L,EAAM1L,EAAI,GAEd,IAAIssD,EAAa1yD,KAAK4xD,mBAClB5xD,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAKvCjpD,KAAK0Y,qBACDg6C,GACK1yD,KAAKuoD,sBAAsBmI,YAC5B1wD,KAAK2yD,6BAA6B3yD,KAAK0Y,sBAAsB,EAAO3G,EAAaD,EAAQ,KAAME,EAAOC,GAErGjS,KAAK4yD,kBAIN5yD,KAAK0xD,cAAc1xD,KAAKqoD,oBAHxBroD,KAAK8sD,wBAAwB+F,QAAQ,IAAI,KAAwB7yD,KAAKupD,eAAexmD,EAAG/C,KAAKupD,eAAevmD,EAAGhD,KAAKupD,eAAepmD,EAAGnD,KAAKupD,eAAelmD,IAK9JrD,KAAK8yD,eAAe/gD,EAAaD,EAAQ,KAAME,EAAOC,KAGlDjS,KAAKqoD,oBACLroD,KAAK+yD,6BAET/yD,KAAK2yD,6BAA6B3yD,KAAK0Y,sBAAsB,EAAM3G,EAAaD,EAAQ,KAAME,EAAOC,KAIpGjS,KAAKsoD,uBAAuBoI,YAAegC,GAC5C1yD,KAAKgzD,sBAAsBN,EAAY3gD,EAAaD,EAAQ,KAAME,EAAOC,GAEzEygD,IACK1yD,KAAK4yD,kBAIN5yD,KAAK0xD,cAAc1xD,KAAKqoD,oBAHxBroD,KAAK6sD,YAAYgG,QAAQ,IAAI,KAAwB7yD,KAAKupD,eAAexmD,EAAG/C,KAAKupD,eAAevmD,EAAGhD,KAAKupD,eAAepmD,EAAGnD,KAAKupD,eAAelmD,IAKlJrD,KAAK8yD,eAAe/gD,EAAaD,EAAQ,KAAME,EAAOC,MAIlEi1C,EAAanoD,UAAU+zD,eAAiB,SAAUppB,EAAYG,EAAYE,GACtE,IAAI9pC,EAAI0Z,EAAI+c,EACRg6B,EAAc1wD,KAAK4yD,kBAA2B5yD,KAAKizD,wBAAZ,KAEvCC,EAAiC,IADflzD,KAAKmzD,6BACcnzD,KAAK6sD,YAAc7sD,KAAK8sD,wBACjE9sD,KAAKytD,WAAW2F,eAAepzD,KAAK0uD,cACpC1uD,KAAKytD,WAAW4F,sBAAsBrzD,KAAKszD,qBAC3CtzD,KAAKytD,WAAW8F,kBAAsE,QAAnDtzD,EAAKD,KAAK0qD,qBAAqB8I,sBAAmC,IAAPvzD,EAAgBA,EAAK,GAAyD,QAApD0Z,EAAK3Z,KAAK0qD,qBAAqB+I,uBAAoC,IAAP95C,EAAgBA,EAAK,GAAI3Z,KAAK0qD,qBAAqBgJ,iBAClO1zD,KAAK4yD,kBAINlC,EAAWyB,oBAAoBnyD,KAAKwnD,oBAHpC0L,EAAWL,QAAQ,IAAI,KAA2B7yD,KAAKwnD,qBAK3D,IAAImM,EAAS3zD,KAAKytD,WAAW57C,MAAM6+C,EAAYhnB,EAAYG,EAAYE,EAAc/pC,KAAK4zD,oBACrF5zD,KAAK4yD,kBAMN5yD,KAAKkyD,iBAAiBxB,IALtBwC,EAAWW,UAAUF,GACrBT,EAAWL,QAAQ,IAAI,KAAyE,QAA7Cn8B,EAAK12B,KAAK+f,sBAAsBkyC,eAA4B,IAAPv7B,EAAgBA,EAAK,IAC7H12B,KAAKixC,oBAcbiW,EAAanoD,UAAUgU,mBAAqB,SAAUvD,GAClD,IAAI+/C,EAWJ,OATIA,EADA//C,aAAgB9H,MACT,IAAIyL,aAAa3D,GAEnBA,aAAgByD,YACd,IAAI2O,WAAWpS,GAGfA,EAEMxP,KAAKusD,eAAexf,aAAawiB,EAAM,YAAqC,eAQjGrI,EAAanoD,UAAUsrB,0BAA4B,SAAU7a,GACzD,OAAOxP,KAAK+S,mBAAmBvD,IAOnC03C,EAAanoD,UAAUqT,kBAAoB,SAAUC,GACjD,IACIk9C,EADA78C,GAAW,EAEXL,aAAmBm7B,aAAen7B,aAAmB4tC,WACrDsP,EAAOl9C,EAEFA,aAAmBo7B,aACxB8hB,EAAOl9C,EACPK,GAAW,GAGPL,EAAQtQ,OAAS,MACjBwtD,EAAO,IAAI/hB,YAAYn7B,IAGvBk9C,EAAO,IAAI9hB,YAAYp7B,GACvBK,GAAW,GAGnB,IAAIs6B,EAAahtC,KAAKusD,eAAexf,aAAawiB,EAAM,WAAoC,cAE5F,OADAviB,EAAWt6B,SAAWA,EACfs6B,GAOXka,EAAanoD,UAAU+0D,cAAgB,SAAUtkD,EAAM4S,GACnD,IAAImtC,EAEAA,EADA//C,aAAgB9H,MACT,IAAIyL,aAAa3D,GAEnBA,aAAgByD,YACd,IAAI2O,WAAWpS,GAGfA,EAEX,IAAIukD,EAAQ,EAmBZ,OAlBoB,EAAhB3xC,IACA2xC,GAAS,cAEO,EAAhB3xC,IACA2xC,GAAS,cAEO,EAAhB3xC,IACA2xC,GAAS,cAEO,EAAhB3xC,IACA2xC,GAAS,aAEO,GAAhB3xC,IACA2xC,GAAS,YAEO,GAAhB3xC,IACA2xC,GAAS,cAEN/zD,KAAKusD,eAAexf,aAAawiB,EAAMwE,IAKlD7M,EAAanoD,UAAUmwC,oBAAsB,WACzC,KAAM,6BAKVgY,EAAanoD,UAAUgxC,6BAA+B,WAClD,KAAM,6BASVmX,EAAanoD,UAAUuV,YAAc,SAAUf,EAAeC,EAAazS,EAAQ2tC,GAC/E1uC,KAAK2oD,oBAAsBn1C,EAC3BxT,KAAK0oD,8BAAgCha,QAAqEA,EAAwB,KAClI1uC,KAAK0qD,qBAAqBqG,WAAWx9C,EAAeC,EAAaxT,KAAK0oD,gCAM1ExB,EAAanoD,UAAU8wC,eAAiB,SAAUr9B,GAC9C,OAAOxS,KAAKusD,eAAeyH,cAAcxhD,IAmB7C00C,EAAanoD,UAAUwzC,aAAe,SAAUC,EAAUC,EAA0BC,EAAuBtxC,EAAUkV,EAASq8B,EAAW/xC,EAAY0O,EAASsjC,EAAiB3a,GAC3K,IAAIh4B,OACmB,IAAnBg4B,IAA6BA,EAAiB,UAClD,IAAI4a,EAASL,EAASM,eAAiBN,EAASK,QAAUL,EAASO,aAAeP,EAASQ,cAAgBR,EACvGS,EAAWT,EAASU,iBAAmBV,EAASS,UAAYT,EAASW,eAAiBX,EAASY,gBAAkBZ,EACjHa,EAAgBrzC,KAAKqyC,oBACrBiB,EAA6G,QAA9FrzC,EAAKqW,QAAyCA,EAAUm8B,EAAyBn8B,eAA4B,IAAPrW,EAAgBA,EAAK,GAC1IozC,IACAC,GAAe,KAAOD,GAE1B,IAAInxC,EAAO2wC,EAAS,IAAMI,EAAW,IAAMK,EAC3C,GAAItzC,KAAKw6B,iBAAiBt4B,GAAO,CAC7B,IAAIqxC,EAAiBvzC,KAAKw6B,iBAAiBt4B,GAI3C,OAHItB,GAAc2yC,EAAehzC,WAC7BK,EAAW2yC,GAERA,EAEX,IAAIxyC,EAAS,IAAI,IAAOyxC,EAAUC,EAA0BC,EAAuBtxC,EAAUpB,KAAMsW,EAASq8B,EAAW/xC,EAAY0O,EAASsjC,EAAiB1wC,EAAM+1B,GAEnK,OADAj4B,KAAKw6B,iBAAiBt4B,GAAQnB,EACvBA,GAEXmmD,EAAanoD,UAAUk1D,yBAA2B,SAAUhzC,EAAQ9M,GAChE,OAAOnU,KAAK0nD,SAASwM,YAAYjzC,EAAQ9M,IAE7C+yC,EAAanoD,UAAUo1D,sBAAwB,SAAUlzC,EAAQ9M,EAAMmC,EAASm9B,GAC5E,OAAOzzC,KAAKi0D,yBAAyBxgB,GAAiBn9B,EAAUA,EAAU,KAAO,IAAM2K,EAAQ9M,IAEnG+yC,EAAanoD,UAAUq1D,eAAiB,SAAUnzC,EAAQ9M,EAAMmC,GAO5D,OALIA,EADAA,EACU,KAAOA,EAAQkjC,MAAM,MAAM6a,KAAK,QAAU,KAG1C,IAEGpzC,GAErBimC,EAAanoD,UAAUu1D,+BAAiC,SAAUjgB,EAAcC,EAAgBrc,GAK5F,OAJIj4B,KAAK2nD,WAAa1vB,IAAmB,WACrCoc,EAAer0C,KAAK2nD,UAAU4M,kBAAkBlgB,GAChDC,EAAiBt0C,KAAK2nD,UAAU4M,kBAAkBjgB,IAE/C,CACHkgB,YAAa,CACTC,OAAQz0D,KAAKmsD,QAAQuI,mBAAmB,CACpCv9C,KAAMk9B,IAEVsgB,WAAY,QAEhBC,cAAe,CACXH,OAAQz0D,KAAKmsD,QAAQuI,mBAAmB,CACpCv9C,KAAMm9B,IAEVqgB,WAAY,UAIxBzN,EAAanoD,UAAU81D,mCAAqC,SAAUh+C,EAAYC,EAAcmhB,GAC5F,IAAIoc,EAAepc,IAAmB,SAAsBj4B,KAAKi0D,yBAAyBp9C,EAAY,UAAYA,EAC9Gy9B,EAAiBrc,IAAmB,SAAsBj4B,KAAKi0D,yBAAyBn9C,EAAc,YAAcA,EACxH,OAAO9W,KAAKs0D,+BAA+BjgB,EAAcC,EAAgBrc,IAE7EivB,EAAanoD,UAAU+1D,gCAAkC,SAAUj+C,EAAYC,EAAcR,EAAS2hB,GAClGj4B,KAAKgX,oCAAoC1X,gBAAgBU,MACzD,IAAIyzC,EAAgB,iBAChBY,EAAepc,IAAmB,SAAsBj4B,KAAKm0D,sBAAsBt9C,EAAY,SAAUP,EAASm9B,GAAiBzzC,KAAKo0D,eAAev9C,EAAY,SAAUP,GAC7Kg+B,EAAiBrc,IAAmB,SAClCj4B,KAAKm0D,sBAAsBr9C,EAAc,WAAYR,EAASm9B,GAC9DzzC,KAAKo0D,eAAet9C,EAAc,WAAYR,GAChDe,EAAUrX,KAAKs0D,+BAA+BjgB,EAAcC,EAAgBrc,GAEhF,OADAj4B,KAAKuX,mCAAmCjY,gBAAgBU,MACjDqX,GAKX6vC,EAAanoD,UAAUyX,uBAAyB,WAC5C,KAAM,2BAKV0wC,EAAanoD,UAAU0X,oBAAsB,WACzC,KAAM,2BAOVywC,EAAanoD,UAAUyY,iBAAmB,SAAUL,GAChD,IAAIM,EAAM,IAAI,IAAkBN,GAGhC,OAFAM,EAAIC,OAAQ,EACZD,EAAIP,cACGO,EAAIN,MAOf+vC,EAAanoD,UAAU6W,sBAAwB,SAAU4+B,GACrD,OAAO,IAAI,IAAsBA,EAAyBx0C,OAM9DknD,EAAanoD,UAAU8W,sBAAwB,WAC3C,OAAO,IAAI,KAMfqxC,EAAanoD,UAAU+W,kBAAoB,WACvC,OAAO,IAAI,IAAkB9V,KAAKusD,iBAatCrF,EAAanoD,UAAUgX,wBAA0B,SAAUlB,EAAiBmB,EAAkBC,EAAoBC,EAAaC,EAAqBC,EAAuBC,EAAeC,GACtL,IAAIy+C,EAAgBlgD,EAChBojB,EAAiB88B,EAAcvgB,wBAAwBvc,eACvDj4B,KAAK8oD,kBAKTiM,EAAcC,QAAU,CACpB/hB,SAAUh9B,EACV48B,OAAQ78B,EACRi/C,UAAW9+C,EACX++C,YAAa9+C,GAGb2+C,EAAcI,OADdj/C,EACuBlW,KAAK60D,mCAAmC7+C,EAAkBC,EAAoBgiB,GAG9Ej4B,KAAK80D,gCAAgC9+C,EAAkBC,EAAoBK,EAAS2hB,IASnHivB,EAAanoD,UAAUsD,cAAgB,SAAUwS,EAAiBxT,GAG9D,IAFA,IAAI00C,EAAU,IAAIruC,MAAMrG,EAAgBU,QACpCqzD,EAAqBvgD,EAChBigB,EAAI,EAAGA,EAAIzzB,EAAgBU,OAAQ+yB,IAAK,CAC7C,IAAIwb,EAAgBjvC,EAAgByzB,GAChC4b,EAAoB0kB,EAAmB5gB,wBAAwB6gB,oBAAoB/kB,QAC7DztC,IAAtB6tC,IAGJqF,EAAQjhB,GAAK4b,GAEjB,OAAOqF,GAMXmR,EAAanoD,UAAU8zB,aAAe,SAAU9xB,GAC5C,GAAKA,EAAL,CAGA,IAAIu0D,GAAc,EAClB,GAAK,cAAsBv0D,GAUtB,KAAKA,EAAOA,QACZA,EAAOA,SAAWf,KAAKqY,gBACpBtX,EAAOw0D,kBAAoBv1D,KAAK6tD,yBAChC9sD,EAAOy0D,cAAgBx1D,KAAK2tD,sBAC3B3tD,KAAK6oD,mBAAqB,CAC/B,IAAK9nD,EAAOA,QAAUf,KAAKmpD,8BAEvB,KAAM,8DAEV,OAQA,GALAmM,EAAcv0D,EAAOA,SAAWf,KAAKqY,eACrCrY,KAAKqY,eAAiBtX,EAAOA,OAC7Bf,KAAK6tD,wBAA0B9sD,EAAOw0D,gBACtCv1D,KAAK2tD,oBAAsB5sD,EAAOy0D,YAClCx1D,KAAK6nD,UAAUE,wBACV/nD,KAAK6tD,wBAEN,KAAM,4EA5BVyH,EAAcv0D,IAAWf,KAAKqY,eAC9BrY,KAAKqY,eAAiBtX,EACtBf,KAAK6tD,wBAA0B7tD,KAAK4tD,wBACpC5tD,KAAK2tD,oBAAsB3tD,KAAK0tD,oBAChC1tD,KAAK6nD,UAAUC,mBACX9nD,KAAKkpD,wBACL,SAAY,kFAAkFv+C,OAAO5J,EAAO00D,SAAU,kBAAkB9qD,OAAO5J,EAAOmB,KAAM,yBAAyByI,OAAO5J,EAAOmB,KAAK2wC,OAAQ,2BAA2BloC,OAAO5J,EAAOmB,KAAK+wC,UAAW,IAyBjRjzC,KAAK+f,sBAAsBgsB,qBAAkBlpC,EAC7C7C,KAAK6oD,oBAAqByM,IAAet1D,KAAK6oD,oBAA6B7oD,KAAK6oD,mBAC5EyM,IACIt1D,KAAKqY,eAAeya,QACpB9yB,KAAKqY,eAAeya,OAAO9yB,KAAKqY,gBAEhCrY,KAAKqY,eAAe0a,mBACpB/yB,KAAKqY,eAAe0a,kBAAkBzzB,gBAAgBU,KAAKqY,mBAQvE6uC,EAAanoD,UAAUkzC,eAAiB,SAAUlxC,GAC1Cf,KAAKw6B,iBAAiBz5B,EAAOmxC,eACtBlyC,KAAKw6B,iBAAiBz5B,EAAOmxC,MACpClyC,KAAK8X,uBAAuB/W,EAAOmX,wBAM3CgvC,EAAanoD,UAAUk1B,eAAiB,WACpC,IAAK,IAAIxyB,KAAUzB,KAAKw6B,iBAAkB,CACtC,IAAIk7B,EAAwB11D,KAAKw6B,iBAAiB/4B,GAAQyW,qBAC1DlY,KAAK8X,uBAAuB49C,GAEhC11D,KAAKw6B,iBAAmB,IAE5B0sB,EAAanoD,UAAU+Y,uBAAyB,SAAUjD,GAC1BA,GAExBA,EAAgBvS,WAGxBxD,OAAOI,eAAegoD,EAAanoD,UAAW,kBAAmB,CAQ7DI,IAAK,WACD,OAAO,GAEX6H,YAAY,EACZC,cAAc,IAGlBigD,EAAanoD,UAAUk5C,uBAAyB,WAC5C,OAAO,IAAI,KAMfiP,EAAanoD,UAAUs0B,gBAAkB,SAAU5S,GAC/C,IAAIlf,EAAQvB,KAAK+iB,uBAAuBmB,QAAQzD,IACjC,IAAXlf,GACAvB,KAAK+iB,uBAAuB9gB,OAAOV,EAAO,GAE9CvB,KAAKwsD,eAAemJ,eAAel1C,IAKvCymC,EAAanoD,UAAUy5C,kCAAoC,WACvD,OAAO,GAEX0O,EAAanoD,UAAU62D,gCAAkC,SAAUn1C,EAASwV,GACxExV,EAAQmX,oBAAsB3B,GAWlCixB,EAAanoD,UAAUm5C,uBAAyB,SAAUzxC,EAAM6C,EAAS6uC,EAAyBl3B,GAC9F,IAAIhhB,EAAI0Z,EAAI+c,OACoB,IAA5ByhB,IAAsCA,GAA0B,QACrD,IAAXl3B,IAAqBA,EAAS,aAClC,IAAIuI,EAAc,QACF3mB,IAAZyG,GAA4C,iBAAZA,GAChCkgB,EAAYjI,gBAAkBjY,EAAQiY,gBACtCiI,EAAYrV,UAAwBtR,IAAjByG,EAAQ6K,KAAqB,EAAI7K,EAAQ6K,KAC5DqV,EAAYhI,kBAAwC3e,IAAzByG,EAAQkY,aAA6B,EAAIlY,EAAQkY,aAC5EgI,EAAYzI,YAA4Ble,IAAnByG,EAAQyX,OAAuB,EAAIzX,EAAQyX,OAChEyI,EAAYK,QAAqC,QAA1B5pB,EAAKqJ,EAAQugB,eAA4B,IAAP5pB,EAAgBA,EAAK,EAC9EupB,EAAYpH,cAAiD,QAAhCzI,EAAKrQ,EAAQ8Y,qBAAkC,IAAPzI,EAAgBA,EAAK,EAC1F6P,EAAYnH,cAAiD,QAAhCqU,EAAKptB,EAAQ+Y,qBAAkC,IAAPqU,GAAgBA,IAGrFlN,EAAYjI,gBAAkBjY,EAC9BkgB,EAAYrV,KAAO,EACnBqV,EAAYhI,aAAe,EAC3BgI,EAAYzI,OAAS,EACrByI,EAAYK,QAAU,EACtBL,EAAYpH,cAAgB,EAC5BoH,EAAYnH,eAAgB,IAEP,IAArBmH,EAAYrV,MAAenU,KAAK8K,MAAMwB,+BAGZ,IAArBkd,EAAYrV,MAAenU,KAAK8K,MAAM2B,mCAF3C+c,EAAYhI,aAAe,GAKN,IAArBgI,EAAYrV,MAAenU,KAAK8K,MAAMuB,eACtCmd,EAAYrV,KAAO,EACnB,SAAY,+EAEhB,IAAIsM,EAAU,IAAI,IAAgBzgB,KAAMihB,GACpCtI,EAAQlS,EAAKkS,OAASlS,EACtBoS,EAASpS,EAAKoS,QAAUpS,EACxB+uB,EAAS/uB,EAAK+uB,QAAU,EAoB5B,OAnBA/U,EAAQ6B,UAAY3J,EACpB8H,EAAQ8B,WAAa1J,EACrB4H,EAAQ9H,MAAQA,EAChB8H,EAAQ5H,OAASA,EACjB4H,EAAQzO,MAAQwjB,EAChB/U,EAAQlgB,SAAU,EAClBkgB,EAAQoJ,QAAUL,EAAYK,QAC9BpJ,EAAQc,kBAAkBiI,EAAYjI,gBACtCd,EAAQe,aAAegI,EAAYhI,aACnCf,EAAQtM,KAAOqV,EAAYrV,KAC3BsM,EAAQM,OAASyI,EAAYzI,OAC7BN,EAAQ0C,UAAYqS,EAAS,EAC7B/U,EAAQw7B,aAAe,EACvBx7B,EAAQy7B,aAAe,EACvBz7B,EAAQgC,eAAiB+G,EAAYnH,cACrCriB,KAAK+iB,uBAAuB5gB,KAAKse,GAC5B03B,GACDn4C,KAAKwsD,eAAeqJ,mCAAmCp1C,EAAS9H,EAAOE,EAAQ2c,GAAU,EAAGhM,EAAYpH,eAErG3B,GAyBXymC,EAAanoD,UAAUwhB,cAAgB,SAAUiD,EAAKC,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,EAASkD,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,EAAUC,EAAe1B,EAAeC,GAC9L,IAAI3b,EAAQ1G,KAQZ,YAPqB,IAAjBwhB,IAA2BA,EAAe,QAC/B,IAAXkC,IAAqBA,EAAS,WAClB,IAAZpU,IAAsBA,EAAU,WACrB,IAAXkD,IAAqBA,EAAS,WACjB,IAAbmR,IAAuBA,EAAW,WACvB,IAAX5C,IAAqBA,EAAS,WACV,IAApB6C,IAA8BA,EAAkB,MAC7C5jB,KAAKm5C,mBAAmB31B,EAAKC,EAAU5C,EAASlQ,EAAO6Q,EAAckC,EAAQpU,GAAS,SAAUmR,EAAS8D,EAAW5T,EAAOupC,EAAKr5B,EAAS4C,EAAUq2B,EAAcsD,GACpK,IAAIn9C,EACA4mB,EAAcqzB,EAOlB,GANAz5B,EAAQ6B,UAAYuE,EAAYlO,MAChC8H,EAAQ8B,WAAasE,EAAYhO,OACjC4H,EAAQ9H,MAAQkO,EAAYlO,MAC5B8H,EAAQ5H,OAASgO,EAAYhO,OAC7B4H,EAAQM,OAASA,QAAuCA,GAAU,EAClEq8B,EAAgB38B,EAAQ9H,MAAO8H,EAAQ5H,OAAQgO,EAAatC,EAAW9D,GAAS,eACtC,QAAnCxgB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,mBAUpEqC,GAAaq2B,GACnBpzC,EAAMovD,iBAAiBr1C,EAAS/Z,EAAMwmD,oBAXyD,CAE/F,IAAI6I,EAAoBrvD,EAAM8lD,eAAeqJ,mCAAmCp1C,EAASoG,EAAYlO,MAAOkO,EAAYhO,YAAQhW,EAAWuf,GACvI,kBAAkCyE,KAClCngB,EAAM8lD,eAAewJ,cAAcnvC,EAAapG,EAASoG,EAAYlO,MAAOkO,EAAYhO,OAAQ4H,EAAQzO,MAAO+jD,EAAkBh1C,OAAQ,EAAG,EAAGF,GAAS,EAAO,EAAG,GAC7J4C,GAAaq2B,GACdpzC,EAAMovD,iBAAiBr1C,EAAS/Z,EAAMwmD,iBAO9Cv8C,GACAA,EAAM2U,mBAAmB7E,GAE7BA,EAAQlgB,SAAU,EAClBkgB,EAAQwE,mBAAmB3lB,gBAAgBmhB,GAC3CA,EAAQwE,mBAAmBpT,WAC5B,WAAc,OAAO,IAAUW,EAAQmR,EAAU5C,EAAQ6C,EAAiBC,EAAUC,EAAezB,IAO1G6kC,EAAanoD,UAAUk3D,kBAAoB,SAAUx1C,GACjD,IAAIoF,EAAkB,IAAI,IAAsBpF,GAC5CsF,EAAkB,IAAI,IAAgB/lB,KAAM,aAA+B,GAG/E,OAFA+lB,EAAgB/E,iBAAmB6E,EACnCE,EAAgBxlB,SAAU,EACnBwlB,GAMXmhC,EAAanoD,UAAUinB,iBAAmB,WACtC,MAAM,IAAInlB,MAAM,sEAEpBqmD,EAAanoD,UAAUm3D,0BAA4B,SAAUz1C,GACzD,IAAIxgB,EACAwgB,EAAQc,mBAC6C,QAAnCthB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,qBAErFphB,KAAKwsD,eAAeqJ,mCAAmCp1C,GAE3DzgB,KAAK81D,iBAAiBr1C,EAASA,EAAQQ,SAAW,kBAAsCR,EAAQQ,SAAW,sBAA0CjhB,KAAKqtD,0BAAuBxqD,KASzLqkD,EAAanoD,UAAU0pB,0BAA4B,SAAUjH,EAAcf,EAASc,QACxD,IAApBA,IAA8BA,GAAkB,GAChDA,IACAd,EAAQc,iBAAkB,EAC1BvhB,KAAK81D,iBAAiBr1C,IAE1BA,EAAQe,aAAeA,GAS3B0lC,EAAanoD,UAAUg9C,0BAA4B,SAAUt7B,EAASmL,EAAOC,EAAOC,QAClE,IAAVD,IAAoBA,EAAQ,WAClB,IAAVC,IAAoBA,EAAQ,MAClB,OAAVF,IACAnL,EAAQw7B,aAAerwB,GAEb,OAAVC,IACApL,EAAQy7B,aAAerwB,IAEtBpL,EAAQ0C,WAAa1C,EAAQ6K,OAAmB,OAAVQ,IACvCrL,EAAQ27B,aAAetwB,IAU/Bo7B,EAAanoD,UAAU+8C,wBAA0B,SAAUr7B,EAAS9H,EAAOE,EAAQ7G,GAE/E,QADc,IAAVA,IAAoBA,EAAQ,GAC3ByO,EAAQO,mBAITP,EAAQ9H,QAAUA,GAAS8H,EAAQ5H,SAAWA,GAAU4H,EAAQzO,QAAUA,GAA9E,CAGA,IAAImkD,EAAmB11C,EAAQO,iBAAiBo1C,wBAChD31C,EAAQO,iBAAiBq1C,UACzBr2D,KAAKwsD,eAAeqJ,mCAAmCp1C,EAAS9H,EAAOE,EAAQ7G,EAAOmkD,KAQ1FjP,EAAanoD,UAAUu3D,oBAAsB,SAAUp0D,EAAMue,EAAS+xB,GAElE,GADAA,EAAWA,QAA2CA,EAAWtwC,EAC7DlC,KAAKqY,eAAgB,CACrB,IACIk+C,EADwBv2D,KAAKqY,eAAeypB,iBACH0S,wBAAwBgiB,kBAAkBhkB,GAEvF,GADAxyC,KAAK6tD,wBAAwB/3B,WAAW5zB,EAAMue,GAC1C81C,GAAoBA,EAAiBE,gBAAiB,CACtD,IAAIC,EAAclkB,EAAW,sBAC7BxyC,KAAK6tD,wBAAwB8I,WAAWD,EAAaj2C,MAWjEymC,EAAanoD,UAAU+2B,WAAa,SAAUnL,EAASisC,EAAQn2C,EAASve,GACpElC,KAAK0qB,YAAYC,EAASlK,GAAS,GAAO,EAAOve,EAAMA,IAS3DglD,EAAanoD,UAAUghD,gBAAkB,SAAUp1B,EAASisC,EAAQ/gC,EAAU3zB,GAC1E,IAAK,IAAIX,EAAQ,EAAGA,EAAQs0B,EAAS9zB,OAAQR,IACzCvB,KAAK0qB,aAAa,EAAGmL,EAASt0B,IAAQ,GAAM,EAAOW,EAAOX,EAAMs1D,WAAY30D,IAGpFglD,EAAanoD,UAAU2rB,YAAc,SAAUC,EAASlK,EAExDmK,EAAsBC,EAAqB3oB,EAAMswC,GAS7C,QAR6B,IAAzB5nB,IAAmCA,GAAuB,QAClC,IAAxBC,IAAkCA,GAAsB,QAC/C,IAAT3oB,IAAmBA,EAAO,IAK9BswC,EAAWA,QAA2CA,EAAWtwC,EAC7DlC,KAAKqY,eAAgB,CACrB,IAAKoI,EAED,OADAzgB,KAAK6tD,wBAAwB/3B,WAAW5zB,EAAM,OACvC,EAGX,GAAIue,EAAQwB,MACRxB,EAAQwK,cAEP,GAA+B,IAA3BxK,EAAQyK,eAGb,OADAzK,EAAQ0K,aACD,EAEX,IAAIpF,EAAkB,KAmBtB,IAjBIA,EADA8E,EACkBpK,EAAQoK,oBAErBpK,EAAQlgB,UACKkgB,EAAQ2K,qBAErB3K,EAAQja,OACKxG,KAAKqrB,iBAElB5K,EAAQ6K,KACKtrB,KAAKurB,eAElB9K,EAAQ0C,UACKnjB,KAAKwrB,oBAGLxrB,KAAKyrB,gBAEH1F,EAAgB61B,YAAa,CAEjD,GAAI71B,EAAgBvf,QAAUuf,EAAgB45B,yBAA2Bl/B,EAAQm/B,gBAAiB,CAC9F75B,EAAgB45B,uBAAyBl/B,EAAQm/B,gBACjD,IAAIC,EAA8C,IAA5Bp/B,EAAQm/B,iBAAqD,IAA5Bn/B,EAAQm/B,gBACzD,EACA,EACNn/B,EAAQmL,MAAQi0B,EAChBp/B,EAAQoL,MAAQg0B,EAEpB95B,EAAgBk2B,aAAex7B,EAAQmL,MACvC7F,EAAgBm2B,aAAez7B,EAAQoL,MACnC9F,EAAgBuF,OAChBvF,EAAgBq2B,aAAe37B,EAAQqL,OAE3C9rB,KAAK8/C,qBAAqB,EAAG/5B,EAAiBtF,EAAQ6L,2BAE1DtsB,KAAKs2D,oBAAoBp0D,EAAM6jB,EAAiBysB,QAG5CxyC,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAK/C,OAAO,GAQX/B,EAAanoD,UAAU+gD,qBAAuB,SAAU9rB,EAAQjO,EAAiBuG,GACzEvG,EAAgBwG,mCAAqCD,IACrDvG,EAAgBwG,iCAAmC9K,KAAK0d,IAAI7S,EAA2BtsB,KAAK8K,MAAMkB,iBAS1Gk7C,EAAanoD,UAAU8tB,aAAe,SAAUlC,EAASlK,EAASve,QAC9CW,IAAZ8nB,GAGJ3qB,KAAKs2D,oBAAoBp0D,EAAMue,IAMnCymC,EAAanoD,UAAUktC,gBAAkB,SAAUxrB,GAC/CzgB,KAAK81D,iBAAiBr1C,EAASzgB,KAAKqtD,uBAOxCnG,EAAanoD,UAAU+2D,iBAAmB,SAAUr1C,EAASq2C,GACzD,IAAIC,EAAqBt2C,EAAQO,iBACjC,GAAK+1C,EAAL,CAKAD,EACIA,QAAuDA,EAAkB92D,KAAK0Y,uBAAyB1Y,KAAKqoD,mBAAqBroD,KAAKqtD,qBAAwBrtD,KAAKqoD,mBAA2CroD,KAAKktD,eAA3BltD,KAAKotD,eACjM,IAAIrsC,EAASN,EAAQO,iBAAiBD,OAClCi2C,EAAc,2BAA2Cv2C,EAAQ9H,MAAO8H,EAAQ5H,QAChF7Y,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAIvCxoC,EAAQja,OACRxG,KAAKwsD,eAAeyK,oBAAoBF,EAAoBh2C,EAAQi2C,EAAaF,GAGjF92D,KAAKwsD,eAAevgB,gBAAgB8qB,EAAoBh2C,EAAQi2C,EAAa,EAAGF,KAexF5P,EAAanoD,UAAUquB,kBAAoB,SAAU3M,EAAS8H,EAAW8E,EAASC,EAAS3U,EAAOE,EAAQmR,EAAWuD,EAAKhM,GACtH,IAAIthB,OACc,IAAd+pB,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,QACJ,IAApBhM,IAA8BA,GAAkB,GACpD,IAAIw0C,EAAoBt1C,EAAQO,kBACU,QAAnC/gB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,sBAC1E20C,EAAoB/1D,KAAKwsD,eAAeqJ,mCAAmCp1C,IAE/E,IAAIjR,EAAO,IAAIoS,WAAW2G,EAAU/V,OAAQ+V,EAAUzV,WAAYyV,EAAU3V,YAC5E5S,KAAKwsD,eAAewJ,cAAcxmD,EAAMiR,EAAS9H,EAAOE,EAAQ4H,EAAQzO,MAAO+jD,EAAkBh1C,OAAQiJ,EAAWuD,EAAK9M,EAAQI,SAAS,EAAOwM,EAASC,GACtJ/L,GACAvhB,KAAK81D,iBAAiBr1C,EAASzgB,KAAKqtD,uBAa5CnG,EAAanoD,UAAUyuB,uCAAyC,SAAU/M,EAASgN,EAAgB9U,EAAOE,EAAQ0P,EAAWyB,EAAWuD,GACpI,IAAIttB,OACc,IAAd+pB,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GAC5B,IAAIwoC,EAAoBt1C,EAAQO,kBACU,QAAnC/gB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,sBAC1EX,EAAQM,OAAS0M,EACjBsoC,EAAoB/1D,KAAKwsD,eAAeqJ,mCAAmCp1C,EAAS9H,EAAOE,IAE/F,IAAIrJ,EAAO,IAAIoS,WAAW2G,EAAU/V,OAAQ+V,EAAUzV,WAAYyV,EAAU3V,YAC5E5S,KAAKwsD,eAAewJ,cAAcxmD,EAAMiR,EAAS9H,EAAOE,EAAQ4H,EAAQzO,MAAO+jD,EAAkBh1C,OAAQiJ,EAAWuD,GAAK,GAAO,EAAO,EAAG,IAW9I25B,EAAanoD,UAAU2uB,6BAA+B,SAAUjN,EAAS8H,EAAWyB,EAAWuD,EAAKovB,EAAuBC,GACvH,IAAI38C,OACc,IAAd+pB,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,QACK,IAA7BqvB,IAAuCA,GAA2B,GACtE,IAAIC,EAAcp7B,KAAKq7B,MAAMr7B,KAAKuzB,IAAIv0B,EAAQ9H,OAAS8I,KAAKs7B,OACxDC,EAAev7B,KAAKq7B,MAAMr7B,KAAKuzB,IAAIv0B,EAAQ5H,QAAU4I,KAAKs7B,OAC1DpkC,EAAQikC,EAA2Bn8B,EAAQ9H,MAAQ8I,KAAK8pB,IAAI,EAAG9pB,KAAKC,IAAIm7B,EAActvB,EAAK,IAC3F1U,EAAS+jC,EAA2Bn8B,EAAQ5H,OAAS4I,KAAK8pB,IAAI,EAAG9pB,KAAKC,IAAIs7B,EAAezvB,EAAK,IAC9FwoC,EAAoBt1C,EAAQO,kBACU,QAAnC/gB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,sBAC1E20C,EAAoB/1D,KAAKwsD,eAAeqJ,mCAAmCp1C,EAAS9H,EAAOE,IAE/F,IAAIrJ,EAAO,IAAIoS,WAAW2G,EAAU/V,OAAQ+V,EAAUzV,WAAYyV,EAAU3V,YAC5E5S,KAAKwsD,eAAewJ,cAAcxmD,EAAMiR,EAAS9H,EAAOE,EAAQ4H,EAAQzO,MAAO+jD,EAAkBh1C,OAAQiJ,EAAWuD,EAAK9M,EAAQI,SAAS,EAAO,EAAG,IASxJqmC,EAAanoD,UAAU4uB,gCAAkC,SAAUlN,EAAS8H,EAAWyB,EAAWuD,QAC5E,IAAdvD,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GAC5BvtB,KAAK0tB,6BAA6BjN,EAAS8H,EAAWyB,EAAWuD,IASrE25B,EAAanoD,UAAU6uB,sBAAwB,SAAUnN,EAASiG,EAAOsD,EAAWuD,GAChF,IAAIttB,OACc,IAAd+pB,IAAwBA,EAAY,QAC5B,IAARuD,IAAkBA,EAAM,GAC5B,IAAIwoC,EAAoBt1C,EAAQO,kBACU,QAAnC/gB,EAAKwgB,EAAQO,wBAAqC,IAAP/gB,OAAgB,EAASA,EAAGmhB,sBAC1E20C,EAAoB/1D,KAAKwsD,eAAeqJ,mCAAmCp1C,IAE/E,IAAIy2C,EAASxwC,EACT/N,EAAQ8I,KAAK01C,KAAK12C,EAAQ9H,OAAS,GAAK4U,IACxC1U,EAAS4I,KAAK01C,KAAK12C,EAAQ5H,QAAU,GAAK0U,IAC9CvtB,KAAKwsD,eAAewJ,cAAckB,EAAQz2C,EAAS9H,EAAOE,EAAQ4H,EAAQzO,MAAO+jD,EAAkBh1C,OAAQiJ,EAAWuD,EAAK9M,EAAQI,SAAS,EAAO,EAAG,IAa1JqmC,EAAanoD,UAAUuiD,WAAa,SAAUv+C,EAAGC,EAAG2V,EAAOE,EAAQgtC,EAAUC,QACxD,IAAbD,IAAuBA,GAAW,QAChB,IAAlBC,IAA4BA,GAAgB,GAChD,IACIjgC,GADoB7lB,KAAKuoD,sBAAsBmI,WAAa1wD,KAAKuoD,sBAAwBvoD,KAAKsoD,wBAC1DqG,2BAA2B,GACnE,IAAK9oC,EAED,OAAOrmB,QAAQC,QAAQ,IAAImiB,WAAW,IAE1C,IAAIw1C,EAAavxC,EAAgBzE,mBAC7Bi2C,EAAmBxxC,EAAgB9E,OACvC,OAAKq2C,GAIDtR,GACA9lD,KAAKkqC,mBAEFlqC,KAAKwsD,eAAelL,WAAW8V,EAAYr0D,EAAGC,EAAG2V,EAAOE,EAAQw+C,IAL5D73D,QAAQC,QAAQ,IAAImiB,WAAW,KAa9CslC,EAAanoD,UAAUwpC,WAAa,WAChCjiC,EAAOvH,UAAUwpC,WAAWtpC,KAAKe,OAKrCknD,EAAanoD,UAAUypC,SAAW,WAe9B,GAdAxoC,KAAKqqD,mBAAmB7hB,SAASxoC,KAAKsoD,uBAAuBoI,YAC7D1wD,KAAK2wD,qBACL3wD,KAAK0sD,gBAAgBlkB,SAASxoC,KAAKotD,gBACnCptD,KAAKkqC,kBAAiB,GAClBlqC,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAI3CjpD,KAAKwsD,eAAe8K,0BACpBt3D,KAAKusD,eAAegL,yBAChBv3D,KAAK4N,UAAUuB,2BAA4B,CAC3C,GAAInP,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,QAAUjtD,KAAKitD,OAASjtD,KAAKipD,yBAAyB,CAC5D,IAAIuO,EAAO,GACX,IAAK,IAAIC,KAAU,wBACfD,EAAKr1D,KAAKs1D,EAAS,IAAM,wBAAkCA,IAKvE,wBAAoC,GAExCz3D,KAAKkoD,kBAAkBJ,iBAAmB9nD,KAAK6nD,UAAUC,iBACzD9nD,KAAKkoD,kBAAkBH,qBAAuB/nD,KAAK6nD,UAAUE,qBAC7D/nD,KAAKkoD,kBAAkBF,+BAAiChoD,KAAK6nD,UAAUG,+BACvEhoD,KAAKkoD,kBAAkBD,4BAA8BjoD,KAAK6nD,UAAUI,4BACpEjoD,KAAK6nD,UAAUC,iBAAmB,EAClC9nD,KAAK6nD,UAAUE,qBAAuB,EACtC/nD,KAAK6nD,UAAUG,+BAAiC,EAChDhoD,KAAK6nD,UAAUI,4BAA8B,EAC7CjoD,KAAK0qD,qBAAqBliB,WAC1BxoC,KAAK2qD,iBAAiBniB,WACtBxoC,KAAKwoD,sBAAsBzmD,OAAS,EACpCuE,EAAOvH,UAAUypC,SAASvpC,KAAKe,MAC3BA,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,GAEdjtD,KAAKitD,OAASjtD,KAAKipD,wBAGnBjpD,KAAKitD,OAASjtD,KAAKipD,0BACnBjpD,KAAKitD,SACDjtD,KAAKitD,OAAWjtD,KAAKipD,2BAUrC/B,EAAanoD,UAAUmrC,iBAAmB,SAAUwtB,QAC7B,IAAfA,IAAyBA,GAAa,GAE1C,IAAIC,GAA2B33D,KAAKqoD,mBAChCuP,EAAgB,EAChB53D,KAAKqoD,oBAAsBroD,KAAK0Y,uBAChCk/C,GAAiB,EACjB53D,KAAK+yD,8BAEL/yD,KAAKsoD,uBAAuBoI,aAC5BkH,GAAiB,EACjB53D,KAAK2wD,sBAET3wD,KAAKooD,gBAAgB,GAAKpoD,KAAKktD,eAAe2K,SAC9C73D,KAAKooD,gBAAgB,GAAKpoD,KAAKqtD,qBAAqBwK,SACpD73D,KAAKooD,gBAAgB,GAAKpoD,KAAKotD,eAAeyK,SAC9C73D,KAAKmsD,QAAQ2L,MAAMC,OAAO/3D,KAAKooD,iBAC/BpoD,KAAKktD,eAAiBltD,KAAKmsD,QAAQgB,qBAAqBntD,KAAKmnD,0BAC7DnnD,KAAKotD,eAAiBptD,KAAKmsD,QAAQgB,qBAAqBntD,KAAKonD,0BAC7DpnD,KAAKqtD,qBAAuBrtD,KAAKmsD,QAAQgB,qBAAqBntD,KAAKqnD,gCACnErnD,KAAK0sD,gBAAgBsL,WAAWh4D,KAAKktD,gBACrCltD,KAAKwsD,eAAegB,kBAAkBxtD,KAAKktD,gBAC3CltD,KAAK6sD,YAAY7sC,QACjBhgB,KAAK8sD,wBAAwB9sC,QAEzB03C,IACoB,EAAhBE,GACA53D,KAAKgzD,sBAAqB,GAEV,EAAhB4E,GACA53D,KAAK2yD,6BAA6B3yD,KAAK0Y,sBAAsB,EAAO,MAAM,GAAO,GAEjFi/C,GAA2B33D,KAAK0Y,uBAChC1Y,KAAKqoD,mBAAqB,QAKtCnB,EAAanoD,UAAUitC,wCAA0C,WAC7D,OAAqC,OAA9BhsC,KAAK0Y,sBAKhBwuC,EAAanoD,UAAU4zD,6BAA+B,SAAUsF,EAAqBC,EAAgBxuB,EAAYG,EAAYE,GACzH,IAAI9pC,EAAI0Z,EAAI+c,EACRxQ,EAAY+xC,EACZptC,EAAsB3E,EAAUqP,qBAChC4iC,EAAyBttC,aAAiE,EAASA,EAAoB7J,iBACvHo3C,EAAyBD,aAAuE,EAASA,EAAuB/2C,mBAChIi3C,EAA6BF,aAAuE,EAASA,EAAuBG,YACpIC,EAAmBH,aAAuE,EAASA,EAAuB5I,WAAWxvD,KAAKuoD,sBAAsBiQ,+BAChKC,EAAuBJ,aAA+E,EAASA,EAA2B7I,WAAWxvD,KAAKuoD,sBAAsBiQ,+BAChLE,IAAyBP,GAAyB,qBAAqCA,EAAuBp3C,QAC9GyvC,EAAmB,GACnBxwD,KAAKkS,uBACLlS,KAAK24D,mCAET,IAAIC,EAAiBV,GAAkBxuB,EACnCmvB,EAAiBX,GAAkBruB,EACnCivB,EAAmBZ,GAAkBnuB,EACzC,GAAI7jB,EAAUgP,cAAgBhP,EAAU3f,QAAS,CAExCvG,KAAK+4D,iBAAmD,IAAhC/4D,KAAK+4D,gBAAgBh3D,SAC9C/B,KAAK+4D,gBAAkB7yC,EAAU8yC,qBAErC,IAAK,IAAIlkC,EAAI,EAAGA,EAAI90B,KAAK+4D,gBAAgBh3D,SAAU+yB,EAAG,CAClD,IAAIvzB,EAAQvB,KAAK+4D,gBAAgBjkC,GAC7BmkC,EAAa/yC,EAAU2P,SAASf,GAChCokC,EAAgBD,aAA+C,EAASA,EAAWj4C,iBACnFm4C,EAAgBD,aAAqD,EAASA,EAAc93C,mBAChG,GAAI83C,GAAiBC,EAAe,CAChC,IAAIC,GAAiB,SAAS,QAAS,GAAIp5D,KAAKuoD,sBAAsB8Q,+BAAgC,CAAEt4C,OAAQm4C,EAAcn4C,SAC1Hu4C,EAAiBJ,EAAcZ,YAC/BiB,EAAmBJ,EAAc3J,WAAW4J,GAC5CI,EAAuBF,aAAuD,EAASA,EAAe9J,WAAW4J,GACrH5I,EAAiBruD,KAAK,CAClBotD,KAAMiK,GAA8CD,EACpDE,cAAeH,EAAiBC,OAAmB12D,EACnD4sD,WAAsB,IAAVluD,GAAeq3D,EAAiBlvB,OAAa7mC,EACzD6sD,OAAkB,IAAVnuD,GAAeq3D,EAAiB,WAA+B,UACvEjJ,QAAS,cAIrB3vD,KAAK0qD,qBAAqBgP,OAAOxzC,EAAU2P,SAAU71B,KAAK+4D,gBAAgBh3D,QAC1E/B,KAAK0qD,qBAAqB6I,kBAAkBvzD,KAAK+4D,qBAEhD,CAGD,GADIhzC,EAAkBG,EAAUzF,QACX,CACjB,IAAIk5C,EAAa5zC,EAAgB/E,iBAC7Bo2C,EAAauC,EAAWv4C,mBACxBk4C,EAAiBK,EAAWrB,YAC5BiB,EAAmBnC,EAAW5H,WAAWxvD,KAAKuoD,sBAAsB8Q,+BACpEG,EAAuBF,aAAuD,EAASA,EAAe9J,WAAWxvD,KAAKuoD,sBAAsB8Q,+BAChJ7I,EAAiBruD,KAAK,CAClBotD,KAAMiK,GAA8CD,EACpDE,cAAeH,EAAiBC,OAAmB12D,EACnD4sD,WAAYmJ,EAAiBlvB,OAAa7mC,EAC1C6sD,OAAQkJ,EAAiB,WAA+B,UACxDjJ,QAAS,kBAIba,EAAiBruD,KAAK,MAwB9B,GArBgC,QAA/BlC,EAAKD,KAAK45D,uBAAoC,IAAP35D,GAAyBA,EAAGhB,KAAKe,KAAM,qBAAsB,GACrGA,KAAKuoD,sBAAsBgI,qBAAuB,CAC9CC,iBAAkBA,EAClBC,uBAAwB5lC,GAAuButC,EACzC,CACE7I,KAAMkJ,GAA8CF,EACpDtI,gBAAiB4I,EAAkB74D,KAAKkS,sBAAwBlS,KAAKunD,wBAA0BvnD,KAAKsnD,sBAAoBzkD,EACxHqtD,YAAa2I,EAAiB,WAA+B,UAC7D1I,aAAc,WACdC,kBAAmBlqC,EAAUiP,iCAAmC2jC,EAAmB94D,KAAKwnD,wBAAqB3kD,EAC7GwtD,cAAgBqI,EAEVxyC,EAAUiP,iCAAmC2jC,EACzC,WACA,eAHJj2D,EAINytD,eAAiBoI,EAAqC,gBAAZ71D,QAE5CA,EACNg3D,mBAAoD,QAA/BlgD,EAAK3Z,KAAK2sD,uBAAoC,IAAPhzC,OAAgB,EAASA,EAAGmgD,YAAc95D,KAAK2sD,gBAAgBoN,cAAWl3D,GAE1I7C,KAAKuoD,sBAAsBmI,WAAa1wD,KAAKqtD,qBAAqB2M,gBAAgBh6D,KAAKuoD,sBAAsBgI,sBACzGvwD,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,QAAUjtD,KAAKitD,OAASjtD,KAAKipD,yBACnC,IAAIljC,EAAkBG,EAAUzF,QAIxCzgB,KAAKqoD,mBAAqBroD,KAAKuoD,sBAAsBmI,WACV,QAA1Ch6B,EAAK12B,KAAKi6D,kCAA+C,IAAPvjC,GAAyBA,EAAGz3B,KAAKe,MACpFA,KAAKoxD,sBAAsB,GAC3BpxD,KAAKwxD,qBAAqB,GAC1BxxD,KAAK+xD,wBAAwB,GAC7B/xD,KAAKoyD,wBAAwB,GACxB+F,GAA2B,qBAAqCA,EAAuBp3C,UACxF/gB,KAAK+f,sBAAsBuqC,SAAU,IAI7CpD,EAAanoD,UAAUg0D,2BAA6B,WAChD,IAAI9yD,EAAY02B,EAChB,GAAI32B,KAAKqoD,mBAAoB,CACzB,IAAIsR,EAA0D,QAA5C15D,EAAKD,KAAK0Y,qBAAqB+H,eAA4B,IAAPxgB,OAAgB,EAASA,EAAG+gB,kBAC9F24C,GAAe35D,KAAKqqD,mBAAmB6P,oBAAoBl6D,KAAKqoD,mBAAoBsR,IAAgB35D,KAAK4yD,oBACzG5yD,KAAK8sD,wBAAwBqN,IAAIn6D,KAAKqoD,oBACtCroD,KAAK8sD,wBAAwB9sC,SAEjChgB,KAAKqoD,mBAAmB+R,MACpBp6D,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAIZ,QAA9BtyB,EAAK32B,KAAKq6D,sBAAmC,IAAP1jC,GAAyBA,EAAG13B,KAAKe,KAAM,GAC9EA,KAAKoxD,sBAAsB,GAC3BpxD,KAAKwxD,qBAAqB,GAC1BxxD,KAAK+xD,wBAAwB,GAC7B/xD,KAAKoyD,wBAAwB,GAC7BpyD,KAAKqoD,mBAAqB,KAC1BroD,KAAKuoD,sBAAsBvoC,UAGnCknC,EAAanoD,UAAUk0D,sBAAwB,WAQ3C,OAPIjzD,KAAK0Y,uBAAyB1Y,KAAKqoD,mBAEnCroD,KAAK2yD,6BAA6B3yD,KAAK0Y,sBAAsB,EAAO,MAAM,GAAO,GAE3E1Y,KAAKqoD,oBACXroD,KAAKgzD,sBAAqB,GAEvBhzD,KAAKqoD,oBAGhBnB,EAAanoD,UAAUo0D,2BAA6B,WAChD,OAAmC,OAA5BnzD,KAAKqoD,oBAA+B,EAAIroD,KAAKqoD,qBAAuBroD,KAAKsoD,uBAAuBoI,WAAa,EAAI,GAE5HxJ,EAAanoD,UAAUi0D,qBAAuB,SAAUkF,EAAgBxuB,EAAYG,EAAYE,GAC5F,IAAI9pC,EAAI0Z,EAAI+c,EACR12B,KAAKsoD,uBAAuBoI,YAC5B1wD,KAAK2wD,qBAEL3wD,KAAKkS,uBACLlS,KAAK24D,mCAET,IAAIC,EAAiBV,GAAkBxuB,EACnCmvB,EAAiBX,GAAkBruB,EACnCivB,EAAmBZ,GAAkBnuB,EACzC/pC,KAAKsoD,uBAAuBiI,qBAAqBC,iBAAiB,GAAGf,WAAamJ,EAAiBlvB,OAAa7mC,EAChH7C,KAAKsoD,uBAAuBiI,qBAAqBC,iBAAiB,GAAGd,OAASkJ,EAAiB,WAA+B,UAC9H54D,KAAKsoD,uBAAuBiI,qBAAqBE,uBAAuBR,gBAAkB4I,EACpF74D,KAAKkS,sBACDlS,KAAKunD,wBACLvnD,KAAKsnD,sBACTzkD,EACN7C,KAAKsoD,uBAAuBiI,qBAAqBE,uBAAuBP,YAAc2I,EAAiB,WAA+B,UACtI74D,KAAKsoD,uBAAuBiI,qBAAqBE,uBAAuBL,kBAAoB0I,EAAmB94D,KAAKwnD,wBAAqB3kD,EACzI7C,KAAKsoD,uBAAuBiI,qBAAqBE,uBAAuBJ,cAAiBrwD,KAAK4vD,gBAExFkJ,EACI,WACA,eAHJj2D,EAIN7C,KAAKsoD,uBAAuBiI,qBAAqBsJ,mBAAqD,QAA/B55D,EAAKD,KAAK2sD,uBAAoC,IAAP1sD,OAAgB,EAASA,EAAG65D,YAAc95D,KAAK2sD,gBAAgBoN,cAAWl3D,EACxL7C,KAAKs6D,kBAAoBt6D,KAAKwuD,SAAS+L,oBACvCv6D,KAAKsoD,uBAAuBqG,2BAA2B,GAAGvvD,IAAIY,KAAKs6D,mBAE/Dt6D,KAAKqyB,SAASu3B,aACd5pD,KAAKsoD,uBAAuBiI,qBAAqBC,iBAAiB,GAAGiJ,cAAgBz5D,KAAKs6D,kBAAkB9K,aAG5GxvD,KAAKsoD,uBAAuBiI,qBAAqBC,iBAAiB,GAAGjB,KAAOvvD,KAAKs6D,kBAAkB9K,aAEnGxvD,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAIX,QAA/BtvC,EAAK3Z,KAAK45D,uBAAoC,IAAPjgD,GAAyBA,EAAG1a,KAAKe,KAAM,YAAa,GAC5FA,KAAKqoD,mBAAqBroD,KAAKotD,eAAe4M,gBAAgBh6D,KAAKsoD,uBAAuBiI,sBAC1FvwD,KAAKsoD,uBAAuBoI,WAAa1wD,KAAKqoD,mBACH,QAA1C3xB,EAAK12B,KAAKi6D,kCAA+C,IAAPvjC,GAAyBA,EAAGz3B,KAAKe,MACpFA,KAAKoxD,sBAAsB,GAC3BpxD,KAAKwxD,qBAAqB,GAC1BxxD,KAAK+xD,wBAAwB,GAC7B/xD,KAAKoyD,wBAAwB,GACxBpyD,KAAKo/B,mBACNp/B,KAAK+f,sBAAsBuqC,SAAU,IAG7CpD,EAAanoD,UAAU4xD,mBAAqB,WACxC,IAAI1wD,EAC2C,OAA3CD,KAAKsoD,uBAAuBoI,aAC5B1wD,KAAKqqD,mBAAmBmQ,oBACnBx6D,KAAK4yD,mBAAsB5yD,KAAKqqD,mBAAmBoQ,OACpDz6D,KAAK6sD,YAAYsN,IAAIn6D,KAAKsoD,uBAAuBoI,YACjD1wD,KAAK6sD,YAAY7sC,SAErBhgB,KAAKsoD,uBAAuBoI,WAAW0J,MACnCp6D,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAIZ,QAA9BhpD,EAAKD,KAAKq6D,sBAAmC,IAAPp6D,GAAyBA,EAAGhB,KAAKe,KAAM,GAC9EA,KAAKoxD,sBAAsB,GAC3BpxD,KAAKwxD,qBAAqB,GAC1BxxD,KAAK+xD,wBAAwB,GAC7B/xD,KAAKoyD,wBAAwB,GACzBpyD,KAAKsoD,uBAAuBoI,aAAe1wD,KAAKqoD,qBAChDroD,KAAKqoD,mBAAqB,MAE9BroD,KAAKsoD,uBAAuBtoC,OAAM,KAa1CknC,EAAanoD,UAAUgrB,gBAAkB,SAAUtJ,EAASuJ,EAAWhR,EAAeC,EAAgBgR,EAAyBygB,EAAUC,GACrI,IAAI1qC,OACc,IAAd+pB,IAAwBA,EAAY,QACvB,IAAb0gB,IAAuBA,EAAW,QACxB,IAAVC,IAAoBA,EAAQ,GAChC,IAAI9kB,EAA6C,QAA1B5lB,EAAKwgB,EAAQA,eAA4B,IAAPxgB,OAAgB,EAASA,EAAG+gB,iBACjFhhB,KAAK0Y,sBACL1Y,KAAKkqB,kBAAkBlqB,KAAK0Y,sBAEhC1Y,KAAK0Y,qBAAuB+H,EACxBoF,IACAA,EAAgB60C,cAAgBj6C,EAAQja,OAAiB,EAARmkC,EAAY3gB,EAAY2gB,GAE7E3qC,KAAKuoD,sBAAsBoG,2BAA2B,GAAK9oC,EAC3D7lB,KAAKuoD,sBAAsBnyB,mBAAqBp2B,KAAK0Y,qBAAqB6c,qBACpE,4BAA4C,EAAGv1B,KAAK0Y,qBAAqB6c,qBAAqBxU,aAC9Fle,EACN7C,KAAK6vD,uBAAuB7vD,KAAKuoD,uBACjCvoD,KAAK26D,gBAAgB36D,KAAKuoD,uBAC1BvoD,KAAKuoD,sBAAsB8Q,8BAAgC,CACvDt4C,OAAQ/gB,KAAK0uD,aACbU,UAAW,SACXF,cAAe,EACf0L,eAAgBn6C,EAAQja,OAAiB,EAARmkC,EAAY3gB,EAAY2gB,EACzDkwB,aAAcnwB,EACdowB,gBAAiB,EACjBC,OAAQ,UAEZ/6D,KAAKuoD,sBAAsBiQ,8BAAgC,CACvDz3C,OAAQ/gB,KAAKszD,oBACblE,UAAW,SACXF,cAAe,EACf0L,eAAgBn6C,EAAQja,OAAiB,EAARmkC,EAAY3gB,EAAY2gB,EACzDkwB,aAAc,EACdC,gBAAiB,EACjBC,OAAQ,UAER/6D,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAI3CjpD,KAAKqoD,mBAAqB,KACtBroD,KAAK2gC,mBAAoD,IAA/B3gC,KAAKg7D,uBAE/Bh7D,KAAKizD,wBAELjzD,KAAKkZ,kBAAoB+Q,EACzBjqB,KAAK8Y,YAAY9Y,KAAKkZ,gBAAiBF,EAAeC,IAGjDD,IACDA,EAAgByH,EAAQ9H,MACpB+xB,IACA1xB,GAAgCyI,KAAK8pB,IAAI,EAAGb,KAG/CzxB,IACDA,EAAiBwH,EAAQ5H,OACrB6xB,IACAzxB,GAAkCwI,KAAK8pB,IAAI,EAAGb,KAGtD1qC,KAAKiqC,UAAU,EAAG,EAAGjxB,EAAeC,IAExCjZ,KAAK2f,cAQTunC,EAAanoD,UAAUmrB,kBAAoB,SAAUzJ,EAAS0J,EAAwBC,GAClF,IAAInqB,OAC2B,IAA3BkqB,IAAqCA,GAAyB,GAClE,IAAI8wC,EAAUj7D,KAAK0Y,qBACnB1Y,KAAK0Y,qBAAuB,KACxB0R,GACAA,IAEJpqB,KAAK0Y,qBAAuBuiD,EACxBj7D,KAAKqoD,oBAAsBroD,KAAKqoD,qBAAuBroD,KAAKsoD,uBAAuBoI,YACnF1wD,KAAK+yD,+BAEuB,QAA1B9yD,EAAKwgB,EAAQA,eAA4B,IAAPxgB,OAAgB,EAASA,EAAGshB,kBAAqB4I,GAA2B1J,EAAQja,QACxHxG,KAAK81D,iBAAiBr1C,EAAQA,SAElCzgB,KAAK0Y,qBAAuB,KAC5B1Y,KAAKyoD,oCAAoCnpD,gBAAgBU,MACrDA,KAAKgpD,oCACenmD,IAAhB7C,KAAKitD,SACLjtD,KAAKitD,OAAS,IAEbjtD,KAAKitD,SAAUjtD,KAAKitD,OAASjtD,KAAKipD,0BAI3CjpD,KAAK+4D,gBAAkB,GACvB/4D,KAAK0qD,qBAAqBgP,OAAO,IACjC15D,KAAK0qD,qBAAqB6I,kBAAkBvzD,KAAK+4D,iBACjD/4D,KAAKqoD,mBAAqBroD,KAAKsoD,uBAAuBoI,WACtD1wD,KAAK6vD,uBAAuB7vD,KAAKsoD,wBACjCtoD,KAAK26D,gBAAgB36D,KAAKsoD,yBAK9BpB,EAAanoD,UAAUytC,0BAA4B,WAC3CxsC,KAAK0Y,qBACL1Y,KAAKkqB,kBAAkBlqB,KAAK0Y,uBAG5B1Y,KAAKqoD,mBAAqBroD,KAAKsoD,uBAAuBoI,WACtD1wD,KAAK6vD,uBAAuB7vD,KAAKsoD,wBACjCtoD,KAAK26D,gBAAgB36D,KAAKsoD,yBAE1BtoD,KAAKqoD,oBACDroD,KAAKkZ,iBACLlZ,KAAK8Y,YAAY9Y,KAAKkZ,iBAG9BlZ,KAAK2f,cASTunC,EAAanoD,UAAU47D,gBAAkB,SAAUO,GAC/C,IAAIj7D,EAAI0Z,EACJoH,EAAgH,QAAtGpH,EAAsD,QAAhD1Z,EAAKi7D,EAAQvM,2BAA2B,UAAuB,IAAP1uD,OAAgB,EAASA,EAAG8gB,cAA2B,IAAPpH,EAAgBA,EAAK,KACjJ3Z,KAAK0qD,qBAAqB0I,eAAeryC,GACrC/gB,KAAK0uD,eAAiB3tC,IAG1B/gB,KAAK0uD,aAAe3tC,IAMxBmmC,EAAanoD,UAAU8wD,uBAAyB,SAAUqL,GACtDl7D,KAAK0qD,qBAAqB2I,sBAAsB6H,EAAQ9kC,oBACpDp2B,KAAKszD,sBAAwB4H,EAAQ9kC,qBAGzCp2B,KAAKszD,oBAAsB4H,EAAQ9kC,qBAEvC8wB,EAAanoD,UAAUo8D,kBAAoB,aAG3CjU,EAAanoD,UAAUq8D,mBAAqB,aAa5ClU,EAAanoD,UAAUqa,SAAW,SAAUC,EAASC,EAASC,EAAOC,EAAaC,EAAexH,EAASyH,GACtG,IAAIzZ,EAAI0Z,OACQ,IAAZL,IAAsBA,EAAU,QAChB,IAAhBE,IAA0BA,GAAc,QACvB,IAAjBE,IAA2BA,EAAe,IAE1C1Z,KAAKigB,mBAAmBurB,OAASnyB,GAAWE,KAC5CvZ,KAAKigB,mBAAmBurB,KAAOnyB,GAGnC,IAAIoyB,EAAgG,QAAnF9xB,EAAmC,QAA7B1Z,EAAKD,KAAKyZ,qBAAkC,IAAPxZ,EAAgBA,EAAKwZ,SAAkC,IAAPE,GAAgBA,EAAa,EAAI,GACzI3Z,KAAKigB,mBAAmBwrB,WAAaA,GAAYlyB,KACjDvZ,KAAKigB,mBAAmBwrB,SAAWA,GAGvCzrC,KAAKma,WAAWb,GAChBtZ,KAAKsa,gBAAgBZ,GAErB,IAAIkyB,EAAYpyB,EAAexZ,KAAK0Y,qBAAuB,EAAI,EAAK1Y,KAAK0Y,qBAAuB,EAAI,GAChG1Y,KAAKigB,mBAAmB2rB,YAAcA,GAAaryB,KACnDvZ,KAAKigB,mBAAmB2rB,UAAYA,GAExC5rC,KAAK+f,sBAAsBgsB,gBAAkB95B,GAEjDi1C,EAAanoD,UAAUs8D,wBAA0B,SAAU3K,EAAYwC,GACnE,IAAIjzD,EACAq7D,EAAqBt7D,KAAKqxD,oBAAoBX,GAC9C6K,EAAoBv7D,KAAKyxD,mBAAmBf,GAC5C8K,IAAwBx7D,KAAK+f,sBAAsBuqC,SAAkBtqD,KAAKgyD,sBAAsBtB,GAChG+K,IAAwBz7D,KAAKkgB,YAAY+S,YAAqBjzB,KAAKqyD,sBAAsB3B,GACzFwC,GACIoI,GACApI,EAAWL,QAAQ,IAAI,KAAyB7yD,KAAK67B,gBAAgB94B,EAAG/C,KAAK67B,gBAAgB74B,EAAGhD,KAAK67B,gBAAgB14B,EAAGnD,KAAK67B,gBAAgBx4B,IAE7Ik4D,GACArI,EAAWL,QAAQ,IAAI,KAAwB7yD,KAAKupD,eAAexmD,EAAG/C,KAAKupD,eAAevmD,EAAGhD,KAAKupD,eAAepmD,EAAGnD,KAAKupD,eAAelmD,IAExIm4D,GACAtI,EAAWL,QAAQ,IAAI,KAAyE,QAA7C5yD,EAAKD,KAAK+f,sBAAsBkyC,eAA4B,IAAPhyD,EAAgBA,EAAK,IAE7Hw7D,GACAvI,EAAWL,QAAQ,IAAI,KAA2B7yD,KAAKkgB,YAAYqyC,gBAAgB3wB,YAInF05B,GACAt7D,KAAKsxD,eAAeZ,GAEpB6K,GACAv7D,KAAK0xD,cAAchB,GAEnB8K,GACAx7D,KAAKkyD,iBAAiBxB,GAEtB+K,GACAz7D,KAAKwyD,iBAAiB9B,KAIlCxJ,EAAanoD,UAAU28D,MAAQ,SAAUC,EAAU1mD,EAAU2mD,EAAOC,EAAOzmD,GACvE,IAAInV,EACAywD,EAAa1wD,KAAKizD,wBAElBC,EAAiC,IADflzD,KAAKmzD,6BACcnzD,KAAK6sD,YAAc7sD,KAAK8sD,wBACjE9sD,KAAKypC,cACL,IAAIqyB,EAAwB97D,KAAKqY,eAAeypB,iBAMhD,GALA9hC,KAAK+7D,sBAAsB/7D,KAAK0Y,qBAAuB1Y,KAAK+sD,WAAa/sD,KAAKgtD,eAAgB,EAAG,sBAC7F8O,EAAsBE,gBACtBF,EAAsBE,cAAc/wC,SACpCjrB,KAAK+7D,sBAAsBD,EAAsBE,cAAcloD,YAAa,EAAG,uBAE/E9T,KAAKqqD,mBAAmBoQ,KACxBz6D,KAAKixC,sBADT,EAIKjxC,KAAK4yD,oBACL5yD,KAAK2tD,oBAAoBsO,QAAQj8D,KAAK6tD,wBAAwBqO,WAAal8D,KAAK6tD,wBAAwBoO,SAAWj8D,KAAK6tD,wBAAwBsO,0BACjJn8D,KAAK2tD,oBAAoByO,gBAAav5D,GAE1C,IACIw5D,EAAc3L,EAClB,IAFmB1wD,KAAK4yD,mBAAqB5yD,KAAK2tD,oBAAoByO,YAEnDp8D,KAAKqqD,mBAAmBiS,OAAQ,CAE/C,GADAt8D,KAAKq7D,wBAAwB3K,EAAYwC,IACpClzD,KAAKqqD,mBAAmBiS,OAOzB,OANAt8D,KAAK6nD,UAAUI,8BACXjoD,KAAK2tD,oBAAoB4O,oBACzBv8D,KAAK2tD,oBAAoB6O,gBAAgBX,EAAOzmD,GAAkB,EAAGwmD,GAEzE1I,EAAWW,UAAU7zD,KAAK2tD,oBAAoByO,iBAC9Cp8D,KAAKixC,kBAGTorB,EAAcnJ,EAAWuJ,iBAAiBz8D,KAAK0qD,qBAAqBgS,aAAc18D,KAAKszD,oBAAqBtzD,KAAK4zD,oBACjHV,EAAWyJ,eAEf,IAAIC,EAAe,EACnB,IAAK58D,KAAK8K,MAAMwB,6BAA+BtM,KAAK6tD,wBAAwBgP,iBAExE,IADA,IAAIC,EAAS,EACJhoC,EAAI,EAAGA,EAAIgnC,EAAsBtnB,wBAAwBuoB,aAAah7D,SAAU+yB,EAAG,CACxF,IAAIkoC,EAAclB,EAAsBtnB,wBAAwBuoB,aAAajoC,GACzErU,EAAwE,QAA7DxgB,EAAKD,KAAK6tD,wBAAwBh4B,SAASmnC,UAAiC,IAAP/8D,OAAgB,EAASA,EAAGwgB,QACvC,KAApEA,aAAyC,EAASA,EAAQtM,QAC3DyoD,GAAgBE,GAEpBA,IAAmB,EAG3B,IAAIG,EAAWj9D,KAAK0qD,qBAAqBwS,kBAAkBjoD,EAAUjV,KAAKqY,eAAgBrY,KAAK4zD,mBAAoBgJ,GAC/GO,EAAan9D,KAAK2qD,iBAAiByS,cAActB,EAAuB97D,KAAK2tD,oBAAqB3tD,KAAK6tD,yBACtG7tD,KAAKqqD,mBAAmBiS,SACzBt8D,KAAKq7D,wBAAwB3K,EAAa1wD,KAAK4yD,kBAAiC,KAAbM,GAC9DlzD,KAAK4yD,oBACN5yD,KAAK6nD,UAAUG,iCACfqU,EAAcr8D,KAAKmsD,QAAQkR,0BAA0B,CACjDX,aAAc18D,KAAK0qD,qBAAqBgS,aACxCY,mBAAoBt9D,KAAKszD,oBACzBnE,YAAanvD,KAAK4zD,uBAK9ByI,EAAYkB,YAAYN,GAEpBj9D,KAAK2oD,qBACL0T,EAAYmB,eAAex9D,KAAK2oD,oBAAoBvnC,mBAAoBphB,KAAK2oD,oBAAoBj2C,SAAW,YAAqC,YAAoC,GAGzL,IADA,IAAIa,EAAgBvT,KAAK0qD,qBAAqBn3C,cACrChS,EAAQ,EAAGA,EAAQgS,EAAcxR,OAAQR,IAAS,CACvD,IAAIsS,EAAeN,EAAchS,GAC7BiR,EAASqB,EAAaC,YACtBtB,GACA6pD,EAAYoB,gBAAgBl8D,EAAOiR,EAAO4O,mBAAoBvN,EAAa6pD,kBAAoB,EAAI7pD,EAAaf,YAIxH,IAASgiB,EAAI,EAAGA,EAAIqoC,EAAWp7D,OAAQ+yB,IACnCunC,EAAYsB,aAAa7oC,EAAGqoC,EAAWroC,IAG3C,IAAI8oC,GAAiB59D,KAAK4yD,oBAAsB5yD,KAAKqqD,mBAAmBiS,OACpEsB,GAAiB59D,KAAK2tD,oBAAoB4O,oBAC1Cv8D,KAAK2tD,oBAAoB6O,gBAAgBX,EAAOzmD,GAAkB,EAAGwmD,GACpD,IAAbD,EACAU,EAAYwB,oBAAoB79D,KAAK2tD,oBAAoB4O,mBAAoB,GAG7EF,EAAYyB,aAAa99D,KAAK2tD,oBAAoB4O,mBAAoB,IAGxD,IAAbZ,EACLU,EAAY0B,YAAYlC,EAAOzmD,GAAkB,EAAGwmD,EAAO,EAAG,GAG9DS,EAAYlpC,KAAK0oC,EAAOzmD,GAAkB,EAAGwmD,EAAO,GAEpDgC,IACA59D,KAAK2tD,oBAAoByO,WAAaC,EAAYxE,SAClD3E,EAAWW,UAAU7zD,KAAK2tD,oBAAoByO,aAElDp8D,KAAKixC,oBASTiW,EAAanoD,UAAUiW,iBAAmB,SAAUC,EAAUC,EAAYC,EAAYC,QAC3D,IAAnBA,IAA6BA,EAAiB,GAClDpV,KAAK07D,MAAM,EAAGzmD,EAAUC,EAAYC,EAAYC,IASpD8xC,EAAanoD,UAAUyW,eAAiB,SAAUP,EAAUQ,EAAeC,EAAeN,QAC/D,IAAnBA,IAA6BA,EAAiB,GAClDpV,KAAK2oD,oBAAsB,KAC3B3oD,KAAK07D,MAAM,EAAGzmD,EAAUQ,EAAeC,EAAeN,IAQ1D8xC,EAAanoD,UAAUuD,QAAU,WAC7B,IAAIrC,EAAI0Z,EAAI+c,EACiB,QAA5Bz2B,EAAKD,KAAKqvD,oBAAiC,IAAPpvD,GAAyBA,EAAGqvD,UAC5B,QAApC31C,EAAK3Z,KAAKg+D,4BAAyC,IAAPrkD,GAAyBA,EAAG21C,UAC3C,QAA7B54B,EAAK12B,KAAK+vD,qBAAkC,IAAPr5B,GAAyBA,EAAG44B,UAClEhpD,EAAOvH,UAAUuD,QAAQrD,KAAKe,OAUlCknD,EAAanoD,UAAUyZ,eAAiB,SAAUC,GAE9C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBC,MAE9B3Y,KAAKkqD,QAAQvxC,OAOxBuuC,EAAanoD,UAAU6Z,gBAAkB,SAAUH,GAE/C,YADkB,IAAdA,IAAwBA,GAAY,IACnCA,GAAazY,KAAK0Y,qBACZ1Y,KAAK0Y,qBAAqBG,OAE9B7Y,KAAKkqD,QAAQrxC,QAMxBquC,EAAanoD,UAAU6pC,mBAAqB,WACxC,OAAO5oC,KAAKkqD,SAShBhD,EAAanoD,UAAU60B,SAAW,WAE9B,OAAO,GAQXszB,EAAanoD,UAAUkZ,aAAe,aAItCivC,EAAanoD,UAAUg1B,qBAAuB,WAC1C,OAAO,GAMXmzB,EAAanoD,UAAU40B,mBAAqB,WACxC,OAAO,GAOXuzB,EAAanoD,UAAU4X,qCAAuC,SAAU9B,EAAiB+B,GAGrFA,KAKJswC,EAAanoD,UAAU2X,0BAA4B,WAE/C,OAAO,GAGXwwC,EAAanoD,UAAU80B,qBAAuB,WAC1C,OAAO,GAKXqzB,EAAanoD,UAAU+0B,aAAe,aAItCozB,EAAanoD,UAAUyS,wBAA0B,WAC7C,KAAM,wIAMV01C,EAAanoD,UAAUy4C,uBAAyB,WAC5C,KAAM,qDAKV0P,EAAanoD,UAAU4C,YAAc,WACjC,MAAO,IAKXulD,EAAanoD,UAAU2E,YAAc,WACjC,OAAO,GAKXwjD,EAAanoD,UAAU6E,aAAe,WAClC,OAAO,GAKXsjD,EAAanoD,UAAU8E,aAAe,WAClC,OAAO,GAKXqjD,EAAanoD,UAAU+E,aAAe,WAClC,OAAO,GAKXojD,EAAanoD,UAAUoF,SAAW,WAC9B,OAAO,GAKX+iD,EAAanoD,UAAUqF,UAAY,WAC/B,OAAO,GAKX8iD,EAAanoD,UAAUsF,UAAY,WAC/B,OAAO,GAKX6iD,EAAanoD,UAAUuF,UAAY,WAC/B,OAAO,GAKX4iD,EAAanoD,UAAUwF,YAAc,WACjC,OAAO,GAKX2iD,EAAanoD,UAAU4F,aAAe,WAClC,OAAO,GAKXuiD,EAAanoD,UAAU6F,aAAe,WAClC,OAAO,GAKXsiD,EAAanoD,UAAU8F,SAAW,WAC9B,OAAO,GAKXqiD,EAAanoD,UAAUmG,UAAY,WAC/B,OAAO,GAKXgiD,EAAanoD,UAAUsG,UAAY,WAC/B,OAAO,GAKX6hD,EAAanoD,UAAUyG,UAAY,WAC/B,OAAO,GAGX0hD,EAAagH,yBAA2B,CACpCE,OAAQ,mDACRD,SAAU,sDAGdjH,EAAasE,UAAW,EACjBtE,EAtyFsB,CAuyF/B","sources":["webpack:///../../../node_modules/@babylonjs/core/Engines/nativeEngine.js","webpack:///../../../node_modules/@babylonjs/core/Engines/nullEngine.js","webpack:///../../../node_modules/@babylonjs/core/Engines/performanceConfigurator.js","webpack:///../../../node_modules/@babylonjs/core/Engines/renderTargetWrapper.js","webpack:///../../../node_modules/@babylonjs/core/Engines/shaderStore.js","webpack:///../../../node_modules/@babylonjs/core/Engines/thinEngine.js","webpack:///../../../node_modules/@babylonjs/core/Engines/webgpuEngine.js"],"sourcesContent":["import { __awaiter, __extends, __generator } from \"tslib\";\nimport { Engine } from \"../Engines/engine.js\";\nimport { VertexBuffer } from \"../Buffers/buffer.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Texture } from \"../Materials/Textures/texture.js\";\nimport { DataBuffer } from \"../Buffers/dataBuffer.js\";\nimport { Tools } from \"../Misc/tools.js\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { CreateImageDataArrayBufferViews, GetEnvInfo, UploadEnvSpherical } from \"../Misc/environmentTextureTools.js\";\nimport { Logger } from \"../Misc/logger.js\";\n\nimport { ThinEngine } from \"./thinEngine.js\";\nimport { EngineStore } from \"./engineStore.js\";\nimport { ShaderCodeInliner } from \"./Processors/shaderCodeInliner.js\";\nimport { WebGL2ShaderProcessor } from \"../Engines/WebGL/webGL2ShaderProcessors.js\";\nimport { RenderTargetWrapper } from \"./renderTargetWrapper.js\";\nimport { NativeDataStream } from \"./Native/nativeDataStream.js\";\nimport { RuntimeError, ErrorCodes } from \"../Misc/error.js\";\nimport { WebGLHardwareTexture } from \"./WebGL/webGLHardwareTexture.js\";\nvar onNativeObjectInitialized = new Observable();\nif (typeof self !== \"undefined\" && !Object.prototype.hasOwnProperty.call(self, \"_native\")) {\n    var __native_1;\n    Object.defineProperty(self, \"_native\", {\n        get: function () { return __native_1; },\n        set: function (value) {\n            __native_1 = value;\n            if (__native_1) {\n                onNativeObjectInitialized.notifyObservers(__native_1);\n            }\n        },\n    });\n}\n/**\n * Returns _native only after it has been defined by BabylonNative.\n * @hidden\n */\nexport function AcquireNativeObjectAsync() {\n    return new Promise(function (resolve) {\n        if (typeof _native === \"undefined\") {\n            onNativeObjectInitialized.addOnce(function (nativeObject) { return resolve(nativeObject); });\n        }\n        else {\n            resolve(_native);\n        }\n    });\n}\n/**\n * Registers a constructor on the _native object. See NativeXRFrame for an example.\n * @param typeName\n * @param constructor\n * @hidden\n */\nexport function RegisterNativeTypeAsync(typeName, constructor) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, AcquireNativeObjectAsync()];\n                case 1:\n                    (_a.sent())[typeName] = constructor;\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nvar NativePipelineContext = /** @class */ (function () {\n    function NativePipelineContext(engine) {\n        // TODO: async should be true?\n        this.isAsync = false;\n        this.isReady = false;\n        this._valueCache = {};\n        this.engine = engine;\n    }\n    NativePipelineContext.prototype._getVertexShaderCode = function () {\n        return null;\n    };\n    NativePipelineContext.prototype._getFragmentShaderCode = function () {\n        return null;\n    };\n    // TODO: what should this do?\n    NativePipelineContext.prototype._handlesSpectorRebuildCallback = function (onCompiled) {\n        throw new Error(\"Not implemented\");\n    };\n    NativePipelineContext.prototype._fillEffectInformation = function (effect, uniformBuffersNames, uniformsNames, uniforms, samplerList, samplers, attributesNames, attributes) {\n        var engine = this.engine;\n        if (engine.supportsUniformBuffers) {\n            for (var name_1 in uniformBuffersNames) {\n                effect.bindUniformBlock(name_1, uniformBuffersNames[name_1]);\n            }\n        }\n        var effectAvailableUniforms = this.engine.getUniforms(this, uniformsNames);\n        effectAvailableUniforms.forEach(function (uniform, index) {\n            uniforms[uniformsNames[index]] = uniform;\n        });\n        this._uniforms = uniforms;\n        var index;\n        for (index = 0; index < samplerList.length; index++) {\n            var sampler = effect.getUniform(samplerList[index]);\n            if (sampler == null) {\n                samplerList.splice(index, 1);\n                index--;\n            }\n        }\n        samplerList.forEach(function (name, index) {\n            samplers[name] = index;\n        });\n        attributes.push.apply(attributes, engine.getAttributes(this, attributesNames));\n    };\n    /**\n     * Release all associated resources.\n     **/\n    NativePipelineContext.prototype.dispose = function () {\n        this._uniforms = {};\n    };\n    /**\n     * @param uniformName\n     * @param matrix\n     * @hidden\n     */\n    NativePipelineContext.prototype._cacheMatrix = function (uniformName, matrix) {\n        var cache = this._valueCache[uniformName];\n        var flag = matrix.updateFlag;\n        if (cache !== undefined && cache === flag) {\n            return false;\n        }\n        this._valueCache[uniformName] = flag;\n        return true;\n    };\n    /**\n     * @param uniformName\n     * @param x\n     * @param y\n     * @hidden\n     */\n    NativePipelineContext.prototype._cacheFloat2 = function (uniformName, x, y) {\n        var cache = this._valueCache[uniformName];\n        if (!cache) {\n            cache = [x, y];\n            this._valueCache[uniformName] = cache;\n            return true;\n        }\n        var changed = false;\n        if (cache[0] !== x) {\n            cache[0] = x;\n            changed = true;\n        }\n        if (cache[1] !== y) {\n            cache[1] = y;\n            changed = true;\n        }\n        return changed;\n    };\n    /**\n     * @param uniformName\n     * @param x\n     * @param y\n     * @param z\n     * @hidden\n     */\n    NativePipelineContext.prototype._cacheFloat3 = function (uniformName, x, y, z) {\n        var cache = this._valueCache[uniformName];\n        if (!cache) {\n            cache = [x, y, z];\n            this._valueCache[uniformName] = cache;\n            return true;\n        }\n        var changed = false;\n        if (cache[0] !== x) {\n            cache[0] = x;\n            changed = true;\n        }\n        if (cache[1] !== y) {\n            cache[1] = y;\n            changed = true;\n        }\n        if (cache[2] !== z) {\n            cache[2] = z;\n            changed = true;\n        }\n        return changed;\n    };\n    /**\n     * @param uniformName\n     * @param x\n     * @param y\n     * @param z\n     * @param w\n     * @hidden\n     */\n    NativePipelineContext.prototype._cacheFloat4 = function (uniformName, x, y, z, w) {\n        var cache = this._valueCache[uniformName];\n        if (!cache) {\n            cache = [x, y, z, w];\n            this._valueCache[uniformName] = cache;\n            return true;\n        }\n        var changed = false;\n        if (cache[0] !== x) {\n            cache[0] = x;\n            changed = true;\n        }\n        if (cache[1] !== y) {\n            cache[1] = y;\n            changed = true;\n        }\n        if (cache[2] !== z) {\n            cache[2] = z;\n            changed = true;\n        }\n        if (cache[3] !== w) {\n            cache[3] = w;\n            changed = true;\n        }\n        return changed;\n    };\n    /**\n     * Sets an integer value on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param value Value to be set.\n     */\n    NativePipelineContext.prototype.setInt = function (uniformName, value) {\n        var cache = this._valueCache[uniformName];\n        if (cache !== undefined && cache === value) {\n            return;\n        }\n        if (this.engine.setInt(this._uniforms[uniformName], value)) {\n            this._valueCache[uniformName] = value;\n        }\n    };\n    /**\n     * Sets a int2 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param x First int in int2.\n     * @param y Second int in int2.\n     */\n    NativePipelineContext.prototype.setInt2 = function (uniformName, x, y) {\n        if (this._cacheFloat2(uniformName, x, y)) {\n            if (!this.engine.setInt2(this._uniforms[uniformName], x, y)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a int3 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param x First int in int3.\n     * @param y Second int in int3.\n     * @param z Third int in int3.\n     */\n    NativePipelineContext.prototype.setInt3 = function (uniformName, x, y, z) {\n        if (this._cacheFloat3(uniformName, x, y, z)) {\n            if (!this.engine.setInt3(this._uniforms[uniformName], x, y, z)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a int4 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param x First int in int4.\n     * @param y Second int in int4.\n     * @param z Third int in int4.\n     * @param w Fourth int in int4.\n     */\n    NativePipelineContext.prototype.setInt4 = function (uniformName, x, y, z, w) {\n        if (this._cacheFloat4(uniformName, x, y, z, w)) {\n            if (!this.engine.setInt4(this._uniforms[uniformName], x, y, z, w)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets an int array on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setIntArray = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setIntArray(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an int array 2 on a uniform variable. (Array is specified as single array eg. [1,2,3,4] will result in [[1,2],[3,4]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setIntArray2 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setIntArray2(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an int array 3 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6] will result in [[1,2,3],[4,5,6]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setIntArray3 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setIntArray3(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an int array 4 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6,7,8] will result in [[1,2,3,4],[5,6,7,8]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setIntArray4 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setIntArray4(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an float array on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setFloatArray = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setFloatArray(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an float array 2 on a uniform variable. (Array is specified as single array eg. [1,2,3,4] will result in [[1,2],[3,4]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setFloatArray2 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setFloatArray2(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an float array 3 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6] will result in [[1,2,3],[4,5,6]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setFloatArray3 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setFloatArray3(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an float array 4 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6,7,8] will result in [[1,2,3,4],[5,6,7,8]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setFloatArray4 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setFloatArray4(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an array on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setArray = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setArray(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an array 2 on a uniform variable. (Array is specified as single array eg. [1,2,3,4] will result in [[1,2],[3,4]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setArray2 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setArray2(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an array 3 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6] will result in [[1,2,3],[4,5,6]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     * @returns this effect.\n     */\n    NativePipelineContext.prototype.setArray3 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setArray3(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets an array 4 on a uniform variable. (Array is specified as single array eg. [1,2,3,4,5,6,7,8] will result in [[1,2,3,4],[5,6,7,8]] in the shader)\n     * @param uniformName Name of the variable.\n     * @param array array to be set.\n     */\n    NativePipelineContext.prototype.setArray4 = function (uniformName, array) {\n        this._valueCache[uniformName] = null;\n        this.engine.setArray4(this._uniforms[uniformName], array);\n    };\n    /**\n     * Sets matrices on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param matrices matrices to be set.\n     */\n    NativePipelineContext.prototype.setMatrices = function (uniformName, matrices) {\n        if (!matrices) {\n            return;\n        }\n        this._valueCache[uniformName] = null;\n        this.engine.setMatrices(this._uniforms[uniformName], matrices);\n    };\n    /**\n     * Sets matrix on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param matrix matrix to be set.\n     */\n    NativePipelineContext.prototype.setMatrix = function (uniformName, matrix) {\n        if (this._cacheMatrix(uniformName, matrix)) {\n            if (!this.engine.setMatrices(this._uniforms[uniformName], matrix.toArray())) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a 3x3 matrix on a uniform variable. (Specified as [1,2,3,4,5,6,7,8,9] will result in [1,2,3][4,5,6][7,8,9] matrix)\n     * @param uniformName Name of the variable.\n     * @param matrix matrix to be set.\n     */\n    NativePipelineContext.prototype.setMatrix3x3 = function (uniformName, matrix) {\n        this._valueCache[uniformName] = null;\n        this.engine.setMatrix3x3(this._uniforms[uniformName], matrix);\n    };\n    /**\n     * Sets a 2x2 matrix on a uniform variable. (Specified as [1,2,3,4] will result in [1,2][3,4] matrix)\n     * @param uniformName Name of the variable.\n     * @param matrix matrix to be set.\n     */\n    NativePipelineContext.prototype.setMatrix2x2 = function (uniformName, matrix) {\n        this._valueCache[uniformName] = null;\n        this.engine.setMatrix2x2(this._uniforms[uniformName], matrix);\n    };\n    /**\n     * Sets a float on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param value value to be set.\n     * @returns this effect.\n     */\n    NativePipelineContext.prototype.setFloat = function (uniformName, value) {\n        var cache = this._valueCache[uniformName];\n        if (cache !== undefined && cache === value) {\n            return;\n        }\n        if (this.engine.setFloat(this._uniforms[uniformName], value)) {\n            this._valueCache[uniformName] = value;\n        }\n    };\n    /**\n     * Sets a boolean on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param bool value to be set.\n     */\n    NativePipelineContext.prototype.setBool = function (uniformName, bool) {\n        var cache = this._valueCache[uniformName];\n        if (cache !== undefined && cache === bool) {\n            return;\n        }\n        if (this.engine.setInt(this._uniforms[uniformName], bool ? 1 : 0)) {\n            this._valueCache[uniformName] = bool ? 1 : 0;\n        }\n    };\n    /**\n     * Sets a Vector2 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param vector2 vector2 to be set.\n     */\n    NativePipelineContext.prototype.setVector2 = function (uniformName, vector2) {\n        if (this._cacheFloat2(uniformName, vector2.x, vector2.y)) {\n            if (!this.engine.setFloat2(this._uniforms[uniformName], vector2.x, vector2.y)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a float2 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param x First float in float2.\n     * @param y Second float in float2.\n     */\n    NativePipelineContext.prototype.setFloat2 = function (uniformName, x, y) {\n        if (this._cacheFloat2(uniformName, x, y)) {\n            if (!this.engine.setFloat2(this._uniforms[uniformName], x, y)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a Vector3 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param vector3 Value to be set.\n     */\n    NativePipelineContext.prototype.setVector3 = function (uniformName, vector3) {\n        if (this._cacheFloat3(uniformName, vector3.x, vector3.y, vector3.z)) {\n            if (!this.engine.setFloat3(this._uniforms[uniformName], vector3.x, vector3.y, vector3.z)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a float3 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param x First float in float3.\n     * @param y Second float in float3.\n     * @param z Third float in float3.\n     */\n    NativePipelineContext.prototype.setFloat3 = function (uniformName, x, y, z) {\n        if (this._cacheFloat3(uniformName, x, y, z)) {\n            if (!this.engine.setFloat3(this._uniforms[uniformName], x, y, z)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a Vector4 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param vector4 Value to be set.\n     */\n    NativePipelineContext.prototype.setVector4 = function (uniformName, vector4) {\n        if (this._cacheFloat4(uniformName, vector4.x, vector4.y, vector4.z, vector4.w)) {\n            if (!this.engine.setFloat4(this._uniforms[uniformName], vector4.x, vector4.y, vector4.z, vector4.w)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a Quaternion on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param quaternion Value to be set.\n     */\n    NativePipelineContext.prototype.setQuaternion = function (uniformName, quaternion) {\n        if (this._cacheFloat4(uniformName, quaternion.x, quaternion.y, quaternion.z, quaternion.w)) {\n            if (!this.engine.setFloat4(this._uniforms[uniformName], quaternion.x, quaternion.y, quaternion.z, quaternion.w)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a float4 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param x First float in float4.\n     * @param y Second float in float4.\n     * @param z Third float in float4.\n     * @param w Fourth float in float4.\n     * @returns this effect.\n     */\n    NativePipelineContext.prototype.setFloat4 = function (uniformName, x, y, z, w) {\n        if (this._cacheFloat4(uniformName, x, y, z, w)) {\n            if (!this.engine.setFloat4(this._uniforms[uniformName], x, y, z, w)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a Color3 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param color3 Value to be set.\n     */\n    NativePipelineContext.prototype.setColor3 = function (uniformName, color3) {\n        if (this._cacheFloat3(uniformName, color3.r, color3.g, color3.b)) {\n            if (!this.engine.setFloat3(this._uniforms[uniformName], color3.r, color3.g, color3.b)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a Color4 on a uniform variable.\n     * @param uniformName Name of the variable.\n     * @param color3 Value to be set.\n     * @param alpha Alpha value to be set.\n     */\n    NativePipelineContext.prototype.setColor4 = function (uniformName, color3, alpha) {\n        if (this._cacheFloat4(uniformName, color3.r, color3.g, color3.b, alpha)) {\n            if (!this.engine.setFloat4(this._uniforms[uniformName], color3.r, color3.g, color3.b, alpha)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    /**\n     * Sets a Color4 on a uniform variable\n     * @param uniformName defines the name of the variable\n     * @param color4 defines the value to be set\n     */\n    NativePipelineContext.prototype.setDirectColor4 = function (uniformName, color4) {\n        if (this._cacheFloat4(uniformName, color4.r, color4.g, color4.b, color4.a)) {\n            if (!this.engine.setFloat4(this._uniforms[uniformName], color4.r, color4.g, color4.b, color4.a)) {\n                this._valueCache[uniformName] = null;\n            }\n        }\n    };\n    return NativePipelineContext;\n}());\nvar NativeRenderTargetWrapper = /** @class */ (function (_super) {\n    __extends(NativeRenderTargetWrapper, _super);\n    function NativeRenderTargetWrapper(isMulti, isCube, size, engine) {\n        var _this = _super.call(this, isMulti, isCube, size, engine) || this;\n        _this.__framebuffer = null;\n        _this.__framebufferDepthStencil = null;\n        _this._engine = engine;\n        return _this;\n    }\n    Object.defineProperty(NativeRenderTargetWrapper.prototype, \"_framebuffer\", {\n        get: function () {\n            return this.__framebuffer;\n        },\n        set: function (framebuffer) {\n            if (this.__framebuffer) {\n                this._engine._releaseFramebufferObjects(this.__framebuffer);\n            }\n            this.__framebuffer = framebuffer;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(NativeRenderTargetWrapper.prototype, \"_framebufferDepthStencil\", {\n        get: function () {\n            return this.__framebufferDepthStencil;\n        },\n        set: function (framebufferDepthStencil) {\n            if (this.__framebufferDepthStencil) {\n                this._engine._releaseFramebufferObjects(this.__framebufferDepthStencil);\n            }\n            this.__framebufferDepthStencil = framebufferDepthStencil;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    NativeRenderTargetWrapper.prototype.dispose = function (disposeOnlyFramebuffers) {\n        if (disposeOnlyFramebuffers === void 0) { disposeOnlyFramebuffers = false; }\n        this._framebuffer = null;\n        this._framebufferDepthStencil = null;\n        _super.prototype.dispose.call(this, disposeOnlyFramebuffers);\n    };\n    return NativeRenderTargetWrapper;\n}(RenderTargetWrapper));\n/**\n * Container for accessors for natively-stored mesh data buffers.\n */\nvar NativeDataBuffer = /** @class */ (function (_super) {\n    __extends(NativeDataBuffer, _super);\n    function NativeDataBuffer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return NativeDataBuffer;\n}(DataBuffer));\n/** @hidden */\nvar CommandBufferEncoder = /** @class */ (function () {\n    function CommandBufferEncoder(_engine) {\n        this._engine = _engine;\n        this._pending = new Array();\n        this._isCommandBufferScopeActive = false;\n        this._commandStream = NativeEngine._createNativeDataStream();\n        this._engine.setCommandDataStream(this._commandStream);\n    }\n    CommandBufferEncoder.prototype.beginCommandScope = function () {\n        if (this._isCommandBufferScopeActive) {\n            throw new Error(\"Command scope already active.\");\n        }\n        this._isCommandBufferScopeActive = true;\n    };\n    CommandBufferEncoder.prototype.endCommandScope = function () {\n        if (!this._isCommandBufferScopeActive) {\n            throw new Error(\"Command scope is not active.\");\n        }\n        this._isCommandBufferScopeActive = false;\n        this._submit();\n    };\n    CommandBufferEncoder.prototype.startEncodingCommand = function (command) {\n        this._commandStream.writeNativeData(command);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsUInt32 = function (commandArg) {\n        this._commandStream.writeUint32(commandArg);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsUInt32s = function (commandArg) {\n        this._commandStream.writeUint32Array(commandArg);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsInt32 = function (commandArg) {\n        this._commandStream.writeInt32(commandArg);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsInt32s = function (commandArg) {\n        this._commandStream.writeInt32Array(commandArg);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsFloat32 = function (commandArg) {\n        this._commandStream.writeFloat32(commandArg);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsFloat32s = function (commandArg) {\n        this._commandStream.writeFloat32Array(commandArg);\n    };\n    CommandBufferEncoder.prototype.encodeCommandArgAsNativeData = function (commandArg) {\n        this._commandStream.writeNativeData(commandArg);\n        this._pending.push(commandArg);\n    };\n    CommandBufferEncoder.prototype.finishEncodingCommand = function () {\n        if (!this._isCommandBufferScopeActive) {\n            this._submit();\n        }\n    };\n    CommandBufferEncoder.prototype._submit = function () {\n        this._engine.submitCommands();\n        this._pending.length = 0;\n    };\n    return CommandBufferEncoder;\n}());\n/** @hidden */\nvar NativeEngine = /** @class */ (function (_super) {\n    __extends(NativeEngine, _super);\n    function NativeEngine(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, null, false, undefined, options.adaptToDeviceRatio) || this;\n        _this._engine = new _native.Engine();\n        _this._camera = _native.Camera ? new _native.Camera() : null;\n        _this._commandBufferEncoder = new CommandBufferEncoder(_this._engine);\n        _this._boundBuffersVertexArray = null;\n        _this._currentDepthTest = _native.Engine.DEPTH_TEST_LEQUAL;\n        _this._stencilTest = false;\n        _this._stencilMask = 255;\n        _this._stencilFunc = 519;\n        _this._stencilFuncRef = 0;\n        _this._stencilFuncMask = 255;\n        _this._stencilOpStencilFail = 7680;\n        _this._stencilOpDepthFail = 7680;\n        _this._stencilOpStencilDepthPass = 7681;\n        _this._zOffset = 0;\n        _this._zOffsetUnits = 0;\n        _this._depthWrite = true;\n        if (_native.Engine.PROTOCOL_VERSION !== NativeEngine.PROTOCOL_VERSION) {\n            throw new Error(\"Protocol version mismatch: \".concat(_native.Engine.PROTOCOL_VERSION, \" (Native) !== \").concat(NativeEngine.PROTOCOL_VERSION, \" (JS)\"));\n        }\n        _this._webGLVersion = 2;\n        _this.disableUniformBuffers = true;\n        // TODO: Initialize this more correctly based on the hardware capabilities.\n        // Init caps\n        _this._caps = {\n            maxTexturesImageUnits: 16,\n            maxVertexTextureImageUnits: 16,\n            maxCombinedTexturesImageUnits: 32,\n            maxTextureSize: _native.Engine.CAPS_LIMITS_MAX_TEXTURE_SIZE,\n            maxCubemapTextureSize: 512,\n            maxRenderTextureSize: 512,\n            maxVertexAttribs: 16,\n            maxVaryingVectors: 16,\n            maxFragmentUniformVectors: 16,\n            maxVertexUniformVectors: 16,\n            standardDerivatives: true,\n            astc: null,\n            pvrtc: null,\n            etc1: null,\n            etc2: null,\n            bptc: null,\n            maxAnisotropy: 16,\n            uintIndices: true,\n            fragmentDepthSupported: false,\n            highPrecisionShaderSupported: true,\n            colorBufferFloat: false,\n            textureFloat: true,\n            textureFloatLinearFiltering: false,\n            textureFloatRender: false,\n            textureHalfFloat: false,\n            textureHalfFloatLinearFiltering: false,\n            textureHalfFloatRender: false,\n            textureLOD: true,\n            drawBuffersExtension: false,\n            depthTextureExtension: false,\n            vertexArrayObject: true,\n            instancedArrays: false,\n            supportOcclusionQuery: false,\n            canUseTimestampForTimerQuery: false,\n            blendMinMax: false,\n            maxMSAASamples: 1,\n            canUseGLInstanceID: true,\n            canUseGLVertexID: true,\n            supportComputeShaders: false,\n            supportSRGBBuffers: true,\n            supportTransformFeedbacks: false,\n            textureMaxLevel: false,\n            texture2DArrayMaxLayerCount: _native.Engine.CAPS_LIMITS_MAX_TEXTURE_LAYERS,\n        };\n        _this._features = {\n            forceBitmapOverHTMLImageElement: false,\n            supportRenderAndCopyToLodForFloatTextures: false,\n            supportDepthStencilTexture: false,\n            supportShadowSamplers: false,\n            uniformBufferHardCheckMatrix: false,\n            allowTexturePrefiltering: false,\n            trackUbosInFrame: false,\n            checkUbosContentBeforeUpload: false,\n            supportCSM: false,\n            basisNeedsPOT: false,\n            support3DTextures: false,\n            needTypeSuffixInShaderConstants: false,\n            supportMSAA: false,\n            supportSSAO2: false,\n            supportExtendedTextureFormats: false,\n            supportSwitchCaseInShader: false,\n            supportSyncTextureRead: false,\n            needsInvertingBitmap: true,\n            useUBOBindingCache: true,\n            needShaderCodeInlining: true,\n            needToAlwaysBindUniformBuffers: false,\n            supportRenderPasses: true,\n            _collectUbosUpdatedInFrame: false,\n        };\n        Tools.Log(\"Babylon Native (v\" + Engine.Version + \") launched\");\n        Tools.LoadScript = function (scriptUrl, onSuccess, onError, scriptId) {\n            Tools.LoadFile(scriptUrl, function (data) {\n                Function(data).apply(null);\n                if (onSuccess) {\n                    onSuccess();\n                }\n            }, undefined, undefined, false, function (request, exception) {\n                if (onError) {\n                    onError(\"LoadScript Error\", exception);\n                }\n            });\n        };\n        // Wrappers\n        if (typeof URL === \"undefined\") {\n            window.URL = {\n                createObjectURL: function () { },\n                revokeObjectURL: function () { },\n            };\n        }\n        if (typeof Blob === \"undefined\") {\n            window.Blob = function (v) {\n                return v;\n            };\n        }\n        // Currently we do not fully configure the ThinEngine on construction of NativeEngine.\n        // Setup resolution scaling based on display settings.\n        var devicePixelRatio = window ? window.devicePixelRatio || 1.0 : 1.0;\n        _this._hardwareScalingLevel = options.adaptToDeviceRatio ? devicePixelRatio : 1.0;\n        _this.resize();\n        var currentDepthFunction = _this.getDepthFunction();\n        if (currentDepthFunction) {\n            _this.setDepthFunction(currentDepthFunction);\n        }\n        // Shader processor\n        _this._shaderProcessor = new WebGL2ShaderProcessor();\n        _this.onNewSceneAddedObservable.add(function (scene) {\n            var originalRender = scene.render;\n            scene.render = function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                _this._commandBufferEncoder.beginCommandScope();\n                originalRender.apply(scene, args);\n                _this._commandBufferEncoder.endCommandScope();\n            };\n        });\n        return _this;\n    }\n    NativeEngine.prototype.getHardwareScalingLevel = function () {\n        return this._engine.getHardwareScalingLevel();\n    };\n    NativeEngine.prototype.setHardwareScalingLevel = function (level) {\n        this._engine.setHardwareScalingLevel(level);\n    };\n    NativeEngine.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        if (this._boundBuffersVertexArray) {\n            this._deleteVertexArray(this._boundBuffersVertexArray);\n        }\n        this._engine.dispose();\n    };\n    /** @hidden */\n    NativeEngine._createNativeDataStream = function () {\n        return new NativeDataStream();\n    };\n    /**\n     * Can be used to override the current requestAnimationFrame requester.\n     * @param bindedRenderFunction\n     * @param requester\n     * @hidden\n     */\n    NativeEngine.prototype._queueNewFrame = function (bindedRenderFunction, requester) {\n        // Use the provided requestAnimationFrame, unless the requester is the window. In that case, we will default to the Babylon Native version of requestAnimationFrame.\n        if (requester.requestAnimationFrame && requester !== window) {\n            requester.requestAnimationFrame(bindedRenderFunction);\n        }\n        else {\n            this._engine.requestAnimationFrame(bindedRenderFunction);\n        }\n        return 0;\n    };\n    /**\n     * Override default engine behavior.\n     * @param framebuffer\n     */\n    NativeEngine.prototype._bindUnboundFramebuffer = function (framebuffer) {\n        if (this._currentFramebuffer !== framebuffer) {\n            if (this._currentFramebuffer) {\n                this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_UNBINDFRAMEBUFFER);\n                this._commandBufferEncoder.encodeCommandArgAsNativeData(this._currentFramebuffer);\n                this._commandBufferEncoder.finishEncodingCommand();\n            }\n            if (framebuffer) {\n                this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_BINDFRAMEBUFFER);\n                this._commandBufferEncoder.encodeCommandArgAsNativeData(framebuffer);\n                this._commandBufferEncoder.finishEncodingCommand();\n            }\n            this._currentFramebuffer = framebuffer;\n        }\n    };\n    /**\n     * Gets host document\n     * @returns the host document object\n     */\n    NativeEngine.prototype.getHostDocument = function () {\n        return null;\n    };\n    NativeEngine.prototype.clear = function (color, backBuffer, depth, stencil) {\n        if (stencil === void 0) { stencil = false; }\n        if (this.useReverseDepthBuffer) {\n            throw new Error(\"reverse depth buffer is not currently implemented\");\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_CLEAR);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(backBuffer && color ? 1 : 0);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(color ? color.r : 0);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(color ? color.g : 0);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(color ? color.b : 0);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(color ? color.a : 1);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(depth ? 1 : 0);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(1);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(stencil ? 1 : 0);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(0);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    NativeEngine.prototype.createIndexBuffer = function (indices, updateable) {\n        var data = this._normalizeIndexData(indices);\n        var buffer = new NativeDataBuffer();\n        buffer.references = 1;\n        buffer.is32Bits = data.BYTES_PER_ELEMENT === 4;\n        if (data.byteLength) {\n            buffer.nativeIndexBuffer = this._engine.createIndexBuffer(data.buffer, data.byteOffset, data.byteLength, buffer.is32Bits, updateable !== null && updateable !== void 0 ? updateable : false);\n        }\n        return buffer;\n    };\n    NativeEngine.prototype.createVertexBuffer = function (vertices, updateable) {\n        var data = ArrayBuffer.isView(vertices) ? vertices : new Float32Array(vertices);\n        var buffer = new NativeDataBuffer();\n        buffer.references = 1;\n        if (data.byteLength) {\n            buffer.nativeVertexBuffer = this._engine.createVertexBuffer(data.buffer, data.byteOffset, data.byteLength, updateable !== null && updateable !== void 0 ? updateable : false);\n        }\n        return buffer;\n    };\n    NativeEngine.prototype._recordVertexArrayObject = function (vertexArray, vertexBuffers, indexBuffer, effect) {\n        if (indexBuffer) {\n            this._engine.recordIndexBuffer(vertexArray, indexBuffer.nativeIndexBuffer);\n        }\n        var attributes = effect.getAttributesNames();\n        for (var index = 0; index < attributes.length; index++) {\n            var location_1 = effect.getAttributeLocation(index);\n            if (location_1 >= 0) {\n                var kind = attributes[index];\n                var vertexBuffer = vertexBuffers[kind];\n                if (vertexBuffer) {\n                    var buffer = vertexBuffer.getBuffer();\n                    if (buffer) {\n                        this._engine.recordVertexBuffer(vertexArray, buffer.nativeVertexBuffer, location_1, vertexBuffer.byteOffset, vertexBuffer.byteStride, vertexBuffer.getSize(), this._getNativeAttribType(vertexBuffer.type), vertexBuffer.normalized, vertexBuffer.getInstanceDivisor());\n                    }\n                }\n            }\n        }\n    };\n    NativeEngine.prototype.bindBuffers = function (vertexBuffers, indexBuffer, effect) {\n        if (this._boundBuffersVertexArray) {\n            this._deleteVertexArray(this._boundBuffersVertexArray);\n        }\n        this._boundBuffersVertexArray = this._engine.createVertexArray();\n        this._recordVertexArrayObject(this._boundBuffersVertexArray, vertexBuffers, indexBuffer, effect);\n        this.bindVertexArrayObject(this._boundBuffersVertexArray);\n    };\n    NativeEngine.prototype.recordVertexArrayObject = function (vertexBuffers, indexBuffer, effect) {\n        var vertexArray = this._engine.createVertexArray();\n        this._recordVertexArrayObject(vertexArray, vertexBuffers, indexBuffer, effect);\n        return vertexArray;\n    };\n    NativeEngine.prototype._deleteVertexArray = function (vertexArray) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DELETEVERTEXARRAY);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(vertexArray);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    NativeEngine.prototype.bindVertexArrayObject = function (vertexArray) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_BINDVERTEXARRAY);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(vertexArray);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    NativeEngine.prototype.releaseVertexArrayObject = function (vertexArray) {\n        this._deleteVertexArray(vertexArray);\n    };\n    NativeEngine.prototype.getAttributes = function (pipelineContext, attributesNames) {\n        var nativePipelineContext = pipelineContext;\n        return this._engine.getAttributes(nativePipelineContext.nativeProgram, attributesNames);\n    };\n    /**\n     * Draw a list of indexed primitives\n     * @param fillMode defines the primitive to use\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    NativeEngine.prototype.drawElementsType = function (fillMode, indexStart, indexCount, instancesCount) {\n        // Apply states\n        this._drawCalls.addCount(1, false);\n        // TODO: Make this implementation more robust like core Engine version.\n        // Render\n        //var indexFormat = this._uintIndicesCurrentlySet ? this._gl.UNSIGNED_INT : this._gl.UNSIGNED_SHORT;\n        //var mult = this._uintIndicesCurrentlySet ? 4 : 2;\n        // if (instancesCount) {\n        //     this._gl.drawElementsInstanced(drawMode, indexCount, indexFormat, indexStart * mult, instancesCount);\n        // } else {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DRAWINDEXED);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(fillMode);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(indexStart);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(indexCount);\n        this._commandBufferEncoder.finishEncodingCommand();\n        // }\n    };\n    /**\n     * Draw a list of unindexed primitives\n     * @param fillMode defines the primitive to use\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    NativeEngine.prototype.drawArraysType = function (fillMode, verticesStart, verticesCount, instancesCount) {\n        // Apply states\n        this._drawCalls.addCount(1, false);\n        // TODO: Make this implementation more robust like core Engine version.\n        // if (instancesCount) {\n        //     this._gl.drawArraysInstanced(drawMode, verticesStart, verticesCount, instancesCount);\n        // } else {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DRAW);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(fillMode);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(verticesStart);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(verticesCount);\n        this._commandBufferEncoder.finishEncodingCommand();\n        // }\n    };\n    NativeEngine.prototype.createPipelineContext = function () {\n        return new NativePipelineContext(this);\n    };\n    NativeEngine.prototype.createMaterialContext = function () {\n        return undefined;\n    };\n    NativeEngine.prototype.createDrawContext = function () {\n        return undefined;\n    };\n    NativeEngine.prototype._preparePipelineContext = function (pipelineContext, vertexSourceCode, fragmentSourceCode, createAsRaw, rawVertexSourceCode, rawFragmentSourceCode, rebuildRebind, defines, transformFeedbackVaryings) {\n        var nativePipelineContext = pipelineContext;\n        if (createAsRaw) {\n            nativePipelineContext.nativeProgram = this.createRawShaderProgram(pipelineContext, vertexSourceCode, fragmentSourceCode, undefined, transformFeedbackVaryings);\n        }\n        else {\n            nativePipelineContext.nativeProgram = this.createShaderProgram(pipelineContext, vertexSourceCode, fragmentSourceCode, defines, undefined, transformFeedbackVaryings);\n        }\n    };\n    /**\n     * @param pipelineContext\n     * @hidden\n     */\n    NativeEngine.prototype._isRenderingStateCompiled = function (pipelineContext) {\n        // TODO: support async shader compilcation\n        return true;\n    };\n    /**\n     * @param pipelineContext\n     * @param action\n     * @hidden\n     */\n    NativeEngine.prototype._executeWhenRenderingStateIsCompiled = function (pipelineContext, action) {\n        // TODO: support async shader compilcation\n        action();\n    };\n    NativeEngine.prototype.createRawShaderProgram = function (pipelineContext, vertexCode, fragmentCode, context, transformFeedbackVaryings) {\n        if (transformFeedbackVaryings === void 0) { transformFeedbackVaryings = null; }\n        throw new Error(\"Not Supported\");\n    };\n    NativeEngine.prototype.createShaderProgram = function (pipelineContext, vertexCode, fragmentCode, defines, context, transformFeedbackVaryings) {\n        if (transformFeedbackVaryings === void 0) { transformFeedbackVaryings = null; }\n        this.onBeforeShaderCompilationObservable.notifyObservers(this);\n        var vertexInliner = new ShaderCodeInliner(vertexCode);\n        vertexInliner.processCode();\n        vertexCode = vertexInliner.code;\n        var fragmentInliner = new ShaderCodeInliner(fragmentCode);\n        fragmentInliner.processCode();\n        fragmentCode = fragmentInliner.code;\n        vertexCode = ThinEngine._ConcatenateShader(vertexCode, defines);\n        fragmentCode = ThinEngine._ConcatenateShader(fragmentCode, defines);\n        var program = this._engine.createProgram(vertexCode, fragmentCode);\n        this.onAfterShaderCompilationObservable.notifyObservers(this);\n        return program;\n    };\n    /**\n     * Inline functions in shader code that are marked to be inlined\n     * @param code code to inline\n     * @returns inlined code\n     */\n    NativeEngine.prototype.inlineShaderCode = function (code) {\n        var sci = new ShaderCodeInliner(code);\n        sci.debug = false;\n        sci.processCode();\n        return sci.code;\n    };\n    NativeEngine.prototype._setProgram = function (program) {\n        if (this._currentProgram !== program) {\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETPROGRAM);\n            this._commandBufferEncoder.encodeCommandArgAsNativeData(program);\n            this._commandBufferEncoder.finishEncodingCommand();\n            this._currentProgram = program;\n        }\n    };\n    NativeEngine.prototype._deletePipelineContext = function (pipelineContext) {\n        var nativePipelineContext = pipelineContext;\n        if (nativePipelineContext && nativePipelineContext.nativeProgram) {\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DELETEPROGRAM);\n            this._commandBufferEncoder.encodeCommandArgAsNativeData(nativePipelineContext.nativeProgram);\n            this._commandBufferEncoder.finishEncodingCommand();\n        }\n    };\n    NativeEngine.prototype.getUniforms = function (pipelineContext, uniformsNames) {\n        var nativePipelineContext = pipelineContext;\n        return this._engine.getUniforms(nativePipelineContext.nativeProgram, uniformsNames);\n    };\n    NativeEngine.prototype.bindUniformBlock = function (pipelineContext, blockName, index) {\n        // TODO\n        throw new Error(\"Not Implemented\");\n    };\n    NativeEngine.prototype.bindSamplers = function (effect) {\n        var nativePipelineContext = effect.getPipelineContext();\n        this._setProgram(nativePipelineContext.nativeProgram);\n        // TODO: share this with engine?\n        var samplers = effect.getSamplers();\n        for (var index = 0; index < samplers.length; index++) {\n            var uniform = effect.getUniform(samplers[index]);\n            if (uniform) {\n                this._boundUniforms[index] = uniform;\n            }\n        }\n        this._currentEffect = null;\n    };\n    NativeEngine.prototype.setMatrix = function (uniform, matrix) {\n        if (!uniform) {\n            return;\n        }\n        var matrixArray = matrix.toArray();\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETMATRIX);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(matrixArray);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    NativeEngine.prototype.getRenderWidth = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.width;\n        }\n        return this._engine.getRenderWidth();\n    };\n    NativeEngine.prototype.getRenderHeight = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.height;\n        }\n        return this._engine.getRenderHeight();\n    };\n    NativeEngine.prototype.setViewport = function (viewport, requiredWidth, requiredHeight) {\n        this._cachedViewport = viewport;\n        this._engine.setViewPort(viewport.x, viewport.y, viewport.width, viewport.height);\n    };\n    NativeEngine.prototype.setState = function (culling, zOffset, force, reverseSide, cullBackFaces, stencil, zOffsetUnits) {\n        var _a, _b;\n        if (zOffset === void 0) { zOffset = 0; }\n        if (reverseSide === void 0) { reverseSide = false; }\n        if (zOffsetUnits === void 0) { zOffsetUnits = 0; }\n        this._zOffset = zOffset;\n        this._zOffsetUnits = zOffsetUnits;\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETSTATE);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(culling ? 1 : 0);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(zOffset);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(zOffsetUnits);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(((_b = (_a = this.cullBackFaces) !== null && _a !== void 0 ? _a : cullBackFaces) !== null && _b !== void 0 ? _b : true) ? 1 : 0);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(reverseSide ? 1 : 0);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    /**\n     * Gets the client rect of native canvas.  Needed for InputManager.\n     * @returns a client rectangle\n     */\n    NativeEngine.prototype.getInputElementClientRect = function () {\n        var rect = {\n            bottom: this.getRenderHeight(),\n            height: this.getRenderHeight(),\n            left: 0,\n            right: this.getRenderWidth(),\n            top: 0,\n            width: this.getRenderWidth(),\n            x: 0,\n            y: 0,\n            toJSON: function () { },\n        };\n        return rect;\n    };\n    /**\n     * Set the z offset Factor to apply to current rendering\n     * @param value defines the offset to apply\n     */\n    NativeEngine.prototype.setZOffset = function (value) {\n        if (value !== this._zOffset) {\n            this._zOffset = value;\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETZOFFSET);\n            this._commandBufferEncoder.encodeCommandArgAsFloat32(this.useReverseDepthBuffer ? -value : value);\n            this._commandBufferEncoder.finishEncodingCommand();\n        }\n    };\n    /**\n     * Gets the current value of the zOffset Factor\n     * @returns the current zOffset Factor state\n     */\n    NativeEngine.prototype.getZOffset = function () {\n        return this._zOffset;\n    };\n    /**\n     * Set the z offset Units to apply to current rendering\n     * @param value defines the offset to apply\n     */\n    NativeEngine.prototype.setZOffsetUnits = function (value) {\n        if (value !== this._zOffsetUnits) {\n            this._zOffsetUnits = value;\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETZOFFSETUNITS);\n            this._commandBufferEncoder.encodeCommandArgAsFloat32(this.useReverseDepthBuffer ? -value : value);\n            this._commandBufferEncoder.finishEncodingCommand();\n        }\n    };\n    /**\n     * Gets the current value of the zOffset Units\n     * @returns the current zOffset Units state\n     */\n    NativeEngine.prototype.getZOffsetUnits = function () {\n        return this._zOffsetUnits;\n    };\n    /**\n     * Enable or disable depth buffering\n     * @param enable defines the state to set\n     */\n    NativeEngine.prototype.setDepthBuffer = function (enable) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETDEPTHTEST);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(enable ? this._currentDepthTest : _native.Engine.DEPTH_TEST_ALWAYS);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    /**\n     * Gets a boolean indicating if depth writing is enabled\n     * @returns the current depth writing state\n     */\n    NativeEngine.prototype.getDepthWrite = function () {\n        return this._depthWrite;\n    };\n    NativeEngine.prototype.getDepthFunction = function () {\n        switch (this._currentDepthTest) {\n            case _native.Engine.DEPTH_TEST_NEVER:\n                return 512;\n            case _native.Engine.DEPTH_TEST_ALWAYS:\n                return 519;\n            case _native.Engine.DEPTH_TEST_GREATER:\n                return 516;\n            case _native.Engine.DEPTH_TEST_GEQUAL:\n                return 518;\n            case _native.Engine.DEPTH_TEST_NOTEQUAL:\n                return 517;\n            case _native.Engine.DEPTH_TEST_EQUAL:\n                return 514;\n            case _native.Engine.DEPTH_TEST_LESS:\n                return 513;\n            case _native.Engine.DEPTH_TEST_LEQUAL:\n                return 515;\n        }\n        return null;\n    };\n    NativeEngine.prototype.setDepthFunction = function (depthFunc) {\n        var nativeDepthFunc = 0;\n        switch (depthFunc) {\n            case 512:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_NEVER;\n                break;\n            case 519:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_ALWAYS;\n                break;\n            case 516:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_GREATER;\n                break;\n            case 518:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_GEQUAL;\n                break;\n            case 517:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_NOTEQUAL;\n                break;\n            case 514:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_EQUAL;\n                break;\n            case 513:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_LESS;\n                break;\n            case 515:\n                nativeDepthFunc = _native.Engine.DEPTH_TEST_LEQUAL;\n                break;\n        }\n        this._currentDepthTest = nativeDepthFunc;\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETDEPTHTEST);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(this._currentDepthTest);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    /**\n     * Enable or disable depth writing\n     * @param enable defines the state to set\n     */\n    NativeEngine.prototype.setDepthWrite = function (enable) {\n        this._depthWrite = enable;\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETDEPTHWRITE);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(Number(enable));\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    /**\n     * Enable or disable color writing\n     * @param enable defines the state to set\n     */\n    NativeEngine.prototype.setColorWrite = function (enable) {\n        this._colorWrite = enable;\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETCOLORWRITE);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(Number(enable));\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    /**\n     * Gets a boolean indicating if color writing is enabled\n     * @returns the current color writing state\n     */\n    NativeEngine.prototype.getColorWrite = function () {\n        return this._colorWrite;\n    };\n    NativeEngine.prototype.applyStencil = function () {\n        this._setStencil(this._stencilMask, this._getStencilOpFail(this._stencilOpStencilFail), this._getStencilDepthFail(this._stencilOpDepthFail), this._getStencilDepthPass(this._stencilOpStencilDepthPass), this._getStencilFunc(this._stencilFunc), this._stencilFuncRef);\n    };\n    NativeEngine.prototype._setStencil = function (mask, stencilOpFail, depthOpFail, depthOpPass, func, ref) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETSTENCIL);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(mask);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(stencilOpFail);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(depthOpFail);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(depthOpPass);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(func);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(ref);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    /**\n     * Enable or disable the stencil buffer\n     * @param enable defines if the stencil buffer must be enabled or disabled\n     */\n    NativeEngine.prototype.setStencilBuffer = function (enable) {\n        this._stencilTest = enable;\n        if (enable) {\n            this.applyStencil();\n        }\n        else {\n            this._setStencil(255, _native.Engine.STENCIL_OP_FAIL_S_KEEP, _native.Engine.STENCIL_OP_FAIL_Z_KEEP, _native.Engine.STENCIL_OP_PASS_Z_KEEP, _native.Engine.STENCIL_TEST_ALWAYS, 0);\n        }\n    };\n    /**\n     * Gets a boolean indicating if stencil buffer is enabled\n     * @returns the current stencil buffer state\n     */\n    NativeEngine.prototype.getStencilBuffer = function () {\n        return this._stencilTest;\n    };\n    /**\n     * Gets the current stencil operation when stencil passes\n     * @returns a number defining stencil operation to use when stencil passes\n     */\n    NativeEngine.prototype.getStencilOperationPass = function () {\n        return this._stencilOpStencilDepthPass;\n    };\n    /**\n     * Sets the stencil operation to use when stencil passes\n     * @param operation defines the stencil operation to use when stencil passes\n     */\n    NativeEngine.prototype.setStencilOperationPass = function (operation) {\n        this._stencilOpStencilDepthPass = operation;\n        this.applyStencil();\n    };\n    /**\n     * Sets the current stencil mask\n     * @param mask defines the new stencil mask to use\n     */\n    NativeEngine.prototype.setStencilMask = function (mask) {\n        this._stencilMask = mask;\n        this.applyStencil();\n    };\n    /**\n     * Sets the current stencil function\n     * @param stencilFunc defines the new stencil function to use\n     */\n    NativeEngine.prototype.setStencilFunction = function (stencilFunc) {\n        this._stencilFunc = stencilFunc;\n        this.applyStencil();\n    };\n    /**\n     * Sets the current stencil reference\n     * @param reference defines the new stencil reference to use\n     */\n    NativeEngine.prototype.setStencilFunctionReference = function (reference) {\n        this._stencilFuncRef = reference;\n        this.applyStencil();\n    };\n    /**\n     * Sets the current stencil mask\n     * @param mask defines the new stencil mask to use\n     */\n    NativeEngine.prototype.setStencilFunctionMask = function (mask) {\n        this._stencilFuncMask = mask;\n    };\n    /**\n     * Sets the stencil operation to use when stencil fails\n     * @param operation defines the stencil operation to use when stencil fails\n     */\n    NativeEngine.prototype.setStencilOperationFail = function (operation) {\n        this._stencilOpStencilFail = operation;\n        this.applyStencil();\n    };\n    /**\n     * Sets the stencil operation to use when depth fails\n     * @param operation defines the stencil operation to use when depth fails\n     */\n    NativeEngine.prototype.setStencilOperationDepthFail = function (operation) {\n        this._stencilOpDepthFail = operation;\n        this.applyStencil();\n    };\n    /**\n     * Gets the current stencil mask\n     * @returns a number defining the new stencil mask to use\n     */\n    NativeEngine.prototype.getStencilMask = function () {\n        return this._stencilMask;\n    };\n    /**\n     * Gets the current stencil function\n     * @returns a number defining the stencil function to use\n     */\n    NativeEngine.prototype.getStencilFunction = function () {\n        return this._stencilFunc;\n    };\n    /**\n     * Gets the current stencil reference value\n     * @returns a number defining the stencil reference value to use\n     */\n    NativeEngine.prototype.getStencilFunctionReference = function () {\n        return this._stencilFuncRef;\n    };\n    /**\n     * Gets the current stencil mask\n     * @returns a number defining the stencil mask to use\n     */\n    NativeEngine.prototype.getStencilFunctionMask = function () {\n        return this._stencilFuncMask;\n    };\n    /**\n     * Gets the current stencil operation when stencil fails\n     * @returns a number defining stencil operation to use when stencil fails\n     */\n    NativeEngine.prototype.getStencilOperationFail = function () {\n        return this._stencilOpStencilFail;\n    };\n    /**\n     * Gets the current stencil operation when depth fails\n     * @returns a number defining stencil operation to use when depth fails\n     */\n    NativeEngine.prototype.getStencilOperationDepthFail = function () {\n        return this._stencilOpDepthFail;\n    };\n    /**\n     * Sets alpha constants used by some alpha blending modes\n     * @param r defines the red component\n     * @param g defines the green component\n     * @param b defines the blue component\n     * @param a defines the alpha component\n     */\n    NativeEngine.prototype.setAlphaConstants = function (r, g, b, a) {\n        throw new Error(\"Setting alpha blend constant color not yet implemented.\");\n    };\n    /**\n     * Sets the current alpha mode\n     * @param mode defines the mode to use (one of the BABYLON.undefined)\n     * @param noDepthWriteChange defines if depth writing state should remains unchanged (false by default)\n     * @see https://doc.babylonjs.com/resources/transparency_and_how_meshes_are_rendered\n     */\n    NativeEngine.prototype.setAlphaMode = function (mode, noDepthWriteChange) {\n        if (noDepthWriteChange === void 0) { noDepthWriteChange = false; }\n        if (this._alphaMode === mode) {\n            return;\n        }\n        var nativeMode = this._getNativeAlphaMode(mode);\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETBLENDMODE);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(nativeMode);\n        this._commandBufferEncoder.finishEncodingCommand();\n        if (!noDepthWriteChange) {\n            this.setDepthWrite(mode === 0);\n        }\n        this._alphaMode = mode;\n    };\n    /**\n     * Gets the current alpha mode\n     * @see https://doc.babylonjs.com/resources/transparency_and_how_meshes_are_rendered\n     * @returns the current alpha mode\n     */\n    NativeEngine.prototype.getAlphaMode = function () {\n        return this._alphaMode;\n    };\n    NativeEngine.prototype.setInt = function (uniform, int) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETINT);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsInt32(int);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setIntArray = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETINTARRAY);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsInt32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setIntArray2 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETINTARRAY2);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsInt32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setIntArray3 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETINTARRAY3);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsInt32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setIntArray4 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETINTARRAY4);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsInt32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloatArray = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOATARRAY);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloatArray2 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOATARRAY2);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloatArray3 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOATARRAY3);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloatArray4 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOATARRAY4);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(array);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setArray = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        return this.setFloatArray(uniform, new Float32Array(array));\n    };\n    NativeEngine.prototype.setArray2 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        return this.setFloatArray2(uniform, new Float32Array(array));\n    };\n    NativeEngine.prototype.setArray3 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        return this.setFloatArray3(uniform, new Float32Array(array));\n    };\n    NativeEngine.prototype.setArray4 = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        return this.setFloatArray4(uniform, new Float32Array(array));\n    };\n    NativeEngine.prototype.setMatrices = function (uniform, matrices) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETMATRICES);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(matrices);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setMatrix3x3 = function (uniform, matrix) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETMATRIX3X3);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(matrix);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setMatrix2x2 = function (uniform, matrix) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETMATRIX2X2);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32s(matrix);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloat = function (uniform, value) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOAT);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(value);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloat2 = function (uniform, x, y) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOAT2);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(x);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(y);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloat3 = function (uniform, x, y, z) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOAT3);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(x);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(y);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(z);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setFloat4 = function (uniform, x, y, z, w) {\n        if (!uniform) {\n            return false;\n        }\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETFLOAT4);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(x);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(y);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(z);\n        this._commandBufferEncoder.encodeCommandArgAsFloat32(w);\n        this._commandBufferEncoder.finishEncodingCommand();\n        return true;\n    };\n    NativeEngine.prototype.setColor3 = function (uniform, color3) {\n        if (!uniform) {\n            return false;\n        }\n        this.setFloat3(uniform, color3.r, color3.g, color3.b);\n        return true;\n    };\n    NativeEngine.prototype.setColor4 = function (uniform, color3, alpha) {\n        if (!uniform) {\n            return false;\n        }\n        this.setFloat4(uniform, color3.r, color3.g, color3.b, alpha);\n        return true;\n    };\n    NativeEngine.prototype.wipeCaches = function (bruteForce) {\n        if (this.preventCacheWipeBetweenFrames) {\n            return;\n        }\n        this.resetTextureCache();\n        this._currentEffect = null;\n        if (bruteForce) {\n            this._currentProgram = null;\n            this._stencilStateComposer.reset();\n            this._depthCullingState.reset();\n            this._alphaState.reset();\n        }\n        this._cachedVertexBuffers = null;\n        this._cachedIndexBuffer = null;\n        this._cachedEffectForVertexBuffers = null;\n    };\n    NativeEngine.prototype._createTexture = function () {\n        return this._engine.createTexture();\n    };\n    NativeEngine.prototype._deleteTexture = function (texture) {\n        if (texture) {\n            this._engine.deleteTexture(texture);\n        }\n    };\n    /**\n     * Update the content of a dynamic texture\n     * @param texture defines the texture to update\n     * @param canvas defines the canvas containing the source\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param premulAlpha defines if alpha is stored as premultiplied\n     * @param format defines the format of the data\n     */\n    NativeEngine.prototype.updateDynamicTexture = function (texture, canvas, invertY, premulAlpha, format) {\n        if (premulAlpha === void 0) { premulAlpha = false; }\n        if (premulAlpha === void 0) {\n            premulAlpha = false;\n        }\n        if (!!texture && !!texture._hardwareTexture) {\n            var source = canvas.getCanvasTexture();\n            var destination = texture._hardwareTexture.underlyingResource;\n            this._engine.copyTexture(destination, source);\n            texture.isReady = true;\n        }\n    };\n    NativeEngine.prototype.createDynamicTexture = function (width, height, generateMipMaps, samplingMode) {\n        // it's not possible to create 0x0 texture sized. Many bgfx methods assume texture size is at least 1x1(best case).\n        // Worst case is getting a crash/assert.\n        width = Math.max(width, 1);\n        height = Math.max(height, 1);\n        return this.createRawTexture(new Uint8Array(width * height * 4), width, height, 5, false, false, samplingMode);\n    };\n    NativeEngine.prototype.createVideoElement = function (constraints) {\n        // create native object depending on stream. Only NativeCamera is supported for now.\n        if (this._camera) {\n            return this._camera.createVideo(constraints);\n        }\n        return null;\n    };\n    NativeEngine.prototype.updateVideoTexture = function (texture, video, invertY) {\n        if (texture && texture._hardwareTexture && this._camera) {\n            var webGLTexture = texture._hardwareTexture.underlyingResource;\n            this._camera.updateVideoTexture(webGLTexture, video, invertY);\n        }\n    };\n    NativeEngine.prototype.createRawTexture = function (data, width, height, format, generateMipMaps, invertY, samplingMode, compression, type, creationFlags, useSRGBBuffer) {\n        if (compression === void 0) { compression = null; }\n        if (type === void 0) { type = 0; }\n        if (creationFlags === void 0) { creationFlags = 0; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        var texture = new InternalTexture(this, InternalTextureSource.Raw);\n        texture.format = format;\n        texture.generateMipMaps = generateMipMaps;\n        texture.samplingMode = samplingMode;\n        texture.invertY = invertY;\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = texture.baseWidth;\n        texture.height = texture.baseHeight;\n        texture._compression = compression;\n        texture.type = type;\n        texture._useSRGBBuffer = this._getUseSRGBBuffer(useSRGBBuffer, !generateMipMaps);\n        this.updateRawTexture(texture, data, format, invertY, compression, type, texture._useSRGBBuffer);\n        if (texture._hardwareTexture) {\n            var webGLTexture = texture._hardwareTexture.underlyingResource;\n            var filter = this._getNativeSamplingMode(samplingMode);\n            this._setTextureSampling(webGLTexture, filter);\n        }\n        this._internalTexturesCache.push(texture);\n        return texture;\n    };\n    NativeEngine.prototype.createRawTexture2DArray = function (data, width, height, depth, format, generateMipMaps, invertY, samplingMode, compression, textureType) {\n        if (compression === void 0) { compression = null; }\n        if (textureType === void 0) { textureType = 0; }\n        var texture = new InternalTexture(this, InternalTextureSource.Raw2DArray);\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.baseDepth = depth;\n        texture.width = width;\n        texture.height = height;\n        texture.depth = depth;\n        texture.format = format;\n        texture.type = textureType;\n        texture.generateMipMaps = generateMipMaps;\n        texture.samplingMode = samplingMode;\n        texture.is2DArray = true;\n        if (texture._hardwareTexture) {\n            var webGLTexture = texture._hardwareTexture.underlyingResource;\n            this._engine.loadRawTexture2DArray(webGLTexture, data, width, height, depth, this._getNativeTextureFormat(format, textureType), generateMipMaps, invertY);\n            var filter = this._getNativeSamplingMode(samplingMode);\n            this._setTextureSampling(webGLTexture, filter);\n        }\n        texture.isReady = true;\n        this._internalTexturesCache.push(texture);\n        return texture;\n    };\n    NativeEngine.prototype.updateRawTexture = function (texture, bufferView, format, invertY, compression, type, useSRGBBuffer) {\n        if (compression === void 0) { compression = null; }\n        if (type === void 0) { type = 0; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        if (!texture) {\n            return;\n        }\n        if (bufferView && texture._hardwareTexture) {\n            var underlyingResource = texture._hardwareTexture.underlyingResource;\n            this._engine.loadRawTexture(underlyingResource, bufferView, texture.width, texture.height, this._getNativeTextureFormat(format, type), texture.generateMipMaps, texture.invertY);\n        }\n        texture.isReady = true;\n    };\n    // TODO: Refactor to share more logic with babylon.engine.ts version.\n    /**\n     * Usually called from Texture.ts.\n     * Passed information to create a WebGLTexture\n     * @param url defines a value which contains one of the following:\n     * * A conventional http URL, e.g. 'http://...' or 'file://...'\n     * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n     * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n     * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n     * @param scene needed for loading to the correct scene\n     * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n     * @param onLoad optional callback to be called upon successful completion\n     * @param onError optional callback to be called upon failure\n     * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n     * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n     * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param mimeType defines an optional mime type\n     * @param loaderOptions options to be passed to the loader\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns a InternalTexture for assignment back into BABYLON.Texture\n     */\n    NativeEngine.prototype.createTexture = function (url, noMipmap, invertY, scene, samplingMode, onLoad, onError, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, creationFlags, useSRGBBuffer) {\n        var _this = this;\n        if (samplingMode === void 0) { samplingMode = 3; }\n        if (onLoad === void 0) { onLoad = null; }\n        if (onError === void 0) { onError = null; }\n        if (buffer === void 0) { buffer = null; }\n        if (fallback === void 0) { fallback = null; }\n        if (format === void 0) { format = null; }\n        if (forcedExtension === void 0) { forcedExtension = null; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        url = url || \"\";\n        var fromData = url.substr(0, 5) === \"data:\";\n        //const fromBlob = url.substr(0, 5) === \"blob:\";\n        var isBase64 = fromData && url.indexOf(\";base64,\") !== -1;\n        var texture = fallback ? fallback : new InternalTexture(this, InternalTextureSource.Url);\n        var originalUrl = url;\n        if (this._transformTextureUrl && !isBase64 && !fallback && !buffer) {\n            url = this._transformTextureUrl(url);\n        }\n        // establish the file extension, if possible\n        var lastDot = url.lastIndexOf(\".\");\n        var extension = forcedExtension ? forcedExtension : lastDot > -1 ? url.substring(lastDot).toLowerCase() : \"\";\n        var loader = null;\n        for (var _i = 0, _a = Engine._TextureLoaders; _i < _a.length; _i++) {\n            var availableLoader = _a[_i];\n            if (availableLoader.canLoad(extension)) {\n                loader = availableLoader;\n                break;\n            }\n        }\n        if (scene) {\n            scene._addPendingData(texture);\n        }\n        texture.url = url;\n        texture.generateMipMaps = !noMipmap;\n        texture.samplingMode = samplingMode;\n        texture.invertY = invertY;\n        texture._useSRGBBuffer = this._getUseSRGBBuffer(useSRGBBuffer, noMipmap);\n        if (!this.doNotHandleContextLost) {\n            // Keep a link to the buffer only if we plan to handle context lost\n            texture._buffer = buffer;\n        }\n        var onLoadObserver = null;\n        if (onLoad && !fallback) {\n            onLoadObserver = texture.onLoadedObservable.add(onLoad);\n        }\n        if (!fallback) {\n            this._internalTexturesCache.push(texture);\n        }\n        var onInternalError = function (message, exception) {\n            if (scene) {\n                scene._removePendingData(texture);\n            }\n            if (url === originalUrl) {\n                if (onLoadObserver) {\n                    texture.onLoadedObservable.remove(onLoadObserver);\n                }\n                if (EngineStore.UseFallbackTexture) {\n                    _this.createTexture(EngineStore.FallbackTexture, noMipmap, texture.invertY, scene, samplingMode, null, onError, buffer, texture);\n                }\n                if (onError) {\n                    onError((message || \"Unknown error\") + (EngineStore.UseFallbackTexture ? \" - Fallback texture was used\" : \"\"), exception);\n                }\n            }\n            else {\n                // fall back to the original url if the transformed url fails to load\n                Logger.Warn(\"Failed to load \".concat(url, \", falling back to \").concat(originalUrl));\n                _this.createTexture(originalUrl, noMipmap, texture.invertY, scene, samplingMode, onLoad, onError, buffer, texture, format, forcedExtension, mimeType, loaderOptions);\n            }\n        };\n        // processing for non-image formats\n        if (loader) {\n            throw new Error(\"Loading textures from IInternalTextureLoader not yet implemented.\");\n        }\n        else {\n            var onload_1 = function (data) {\n                if (!texture._hardwareTexture) {\n                    if (scene) {\n                        scene._removePendingData(texture);\n                    }\n                    return;\n                }\n                var underlyingResource = texture._hardwareTexture.underlyingResource;\n                _this._engine.loadTexture(underlyingResource, data, !noMipmap, invertY, useSRGBBuffer, function () {\n                    texture.baseWidth = _this._engine.getTextureWidth(underlyingResource);\n                    texture.baseHeight = _this._engine.getTextureHeight(underlyingResource);\n                    texture.width = texture.baseWidth;\n                    texture.height = texture.baseHeight;\n                    texture.isReady = true;\n                    var filter = _this._getNativeSamplingMode(samplingMode);\n                    _this._setTextureSampling(underlyingResource, filter);\n                    if (scene) {\n                        scene._removePendingData(texture);\n                    }\n                    texture.onLoadedObservable.notifyObservers(texture);\n                    texture.onLoadedObservable.clear();\n                }, function () {\n                    throw new Error(\"Could not load a native texture.\");\n                });\n            };\n            if (fromData && buffer) {\n                if (buffer instanceof ArrayBuffer) {\n                    onload_1(new Uint8Array(buffer));\n                }\n                else if (ArrayBuffer.isView(buffer)) {\n                    onload_1(buffer);\n                }\n                else if (typeof buffer === \"string\") {\n                    onload_1(new Uint8Array(Tools.DecodeBase64(buffer)));\n                }\n                else {\n                    throw new Error(\"Unsupported buffer type\");\n                }\n            }\n            else {\n                if (isBase64) {\n                    onload_1(new Uint8Array(Tools.DecodeBase64(url)));\n                }\n                else {\n                    this._loadFile(url, function (data) { return onload_1(new Uint8Array(data)); }, undefined, undefined, true, function (request, exception) {\n                        onInternalError(\"Unable to load \" + (request ? request.responseURL : url, exception));\n                    });\n                }\n            }\n        }\n        return texture;\n    };\n    /**\n     * Wraps an external native texture in a Babylon texture.\n     * @param texture defines the external texture\n     * @returns the babylon internal texture\n     */\n    NativeEngine.prototype.wrapNativeTexture = function (texture) {\n        // Currently native is using the WebGL wrapper\n        var hardwareTexture = new WebGLHardwareTexture(texture, this._gl);\n        var internalTexture = new InternalTexture(this, InternalTextureSource.Unknown, true);\n        internalTexture._hardwareTexture = hardwareTexture;\n        internalTexture.isReady = true;\n        return internalTexture;\n    };\n    /**\n     * Wraps an external web gl texture in a Babylon texture.\n     * @returns the babylon internal texture\n     */\n    NativeEngine.prototype.wrapWebGLTexture = function () {\n        throw new Error(\"wrapWebGLTexture is not supported, use wrapNativeTexture instead.\");\n    };\n    NativeEngine.prototype._createDepthStencilTexture = function (size, options, rtWrapper) {\n        var nativeRTWrapper = rtWrapper;\n        var texture = new InternalTexture(this, InternalTextureSource.DepthStencil);\n        var width = size.width || size;\n        var height = size.height || size;\n        var framebuffer = this._engine.createFrameBuffer(texture._hardwareTexture.underlyingResource, width, height, _native.Engine.TEXTURE_FORMAT_RGBA8, false, true, false);\n        nativeRTWrapper._framebufferDepthStencil = framebuffer;\n        return texture;\n    };\n    /**\n     * @param framebuffer\n     * @hidden\n     */\n    NativeEngine.prototype._releaseFramebufferObjects = function (framebuffer) {\n        if (framebuffer) {\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DELETEFRAMEBUFFER);\n            this._commandBufferEncoder.encodeCommandArgAsNativeData(framebuffer);\n            this._commandBufferEncoder.finishEncodingCommand();\n        }\n    };\n    /** @hidden */\n    /**\n     * Engine abstraction for loading and creating an image bitmap from a given source string.\n     * @param imageSource source to load the image from.\n     * @param options An object that sets options for the image's extraction.\n     * @returns ImageBitmap\n     */\n    NativeEngine.prototype._createImageBitmapFromSource = function (imageSource, options) {\n        var _this = this;\n        var promise = new Promise(function (resolve, reject) {\n            var image = _this.createCanvasImage();\n            image.onload = function () {\n                try {\n                    var imageBitmap = _this._engine.createImageBitmap(image);\n                    resolve(imageBitmap);\n                }\n                catch (error) {\n                    reject(\"Error loading image \".concat(image.src, \" with exception: \").concat(error));\n                }\n            };\n            image.onerror = function (error) {\n                reject(\"Error loading image \".concat(image.src, \" with exception: \").concat(error));\n            };\n            image.src = imageSource;\n        });\n        return promise;\n    };\n    /**\n     * Engine abstraction for createImageBitmap\n     * @param image source for image\n     * @param options An object that sets options for the image's extraction.\n     * @returns ImageBitmap\n     */\n    NativeEngine.prototype.createImageBitmap = function (image, options) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (Array.isArray(image)) {\n                var arr = image;\n                if (arr.length) {\n                    var image_1 = _this._engine.createImageBitmap(arr[0]);\n                    if (image_1) {\n                        resolve(image_1);\n                        return;\n                    }\n                }\n            }\n            reject(\"Unsupported data for createImageBitmap.\");\n        });\n    };\n    /**\n     * Resize an image and returns the image data as an uint8array\n     * @param image image to resize\n     * @param bufferWidth destination buffer width\n     * @param bufferHeight destination buffer height\n     * @returns an uint8array containing RGBA values of bufferWidth * bufferHeight size\n     */\n    NativeEngine.prototype.resizeImageBitmap = function (image, bufferWidth, bufferHeight) {\n        return this._engine.resizeImageBitmap(image, bufferWidth, bufferHeight);\n    };\n    /**\n     * Creates a cube texture\n     * @param rootUrl defines the url where the files to load is located\n     * @param scene defines the current scene\n     * @param files defines the list of files to load (1 per face)\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated (false by default)\n     * @param onLoad defines an optional callback raised when the texture is loaded\n     * @param onError defines an optional callback raised if there is an issue to load the texture\n     * @param format defines the format of the data\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param createPolynomials if a polynomial sphere should be created for the cube texture\n     * @param lodScale defines the scale applied to environment texture. This manages the range of LOD level used for IBL according to the roughness\n     * @param lodOffset defines the offset applied to environment texture. This manages first LOD level used for IBL according to the roughness\n     * @param fallback defines texture to use while falling back when (compressed) texture file not found.\n     * @param loaderOptions options to be passed to the loader\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns the cube texture as an InternalTexture\n     */\n    NativeEngine.prototype.createCubeTexture = function (rootUrl, scene, files, noMipmap, onLoad, onError, format, forcedExtension, createPolynomials, lodScale, lodOffset, fallback, loaderOptions, useSRGBBuffer) {\n        var _this = this;\n        if (onLoad === void 0) { onLoad = null; }\n        if (onError === void 0) { onError = null; }\n        if (forcedExtension === void 0) { forcedExtension = null; }\n        if (createPolynomials === void 0) { createPolynomials = false; }\n        if (lodScale === void 0) { lodScale = 0; }\n        if (lodOffset === void 0) { lodOffset = 0; }\n        if (fallback === void 0) { fallback = null; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        var texture = fallback ? fallback : new InternalTexture(this, InternalTextureSource.Cube);\n        texture.isCube = true;\n        texture.url = rootUrl;\n        texture.generateMipMaps = !noMipmap;\n        texture._lodGenerationScale = lodScale;\n        texture._lodGenerationOffset = lodOffset;\n        if (!this._doNotHandleContextLost) {\n            texture._extension = forcedExtension;\n            texture._files = files;\n        }\n        var lastDot = rootUrl.lastIndexOf(\".\");\n        var extension = forcedExtension ? forcedExtension : lastDot > -1 ? rootUrl.substring(lastDot).toLowerCase() : \"\";\n        // TODO: use texture loader to load env files?\n        if (extension === \".env\") {\n            var onloaddata_1 = function (data) {\n                var info = GetEnvInfo(data);\n                texture.width = info.width;\n                texture.height = info.width;\n                UploadEnvSpherical(texture, info);\n                var specularInfo = info.specular;\n                if (!specularInfo) {\n                    throw new Error(\"Nothing else parsed so far\");\n                }\n                texture._lodGenerationScale = specularInfo.lodGenerationScale;\n                var imageData = CreateImageDataArrayBufferViews(data, info);\n                texture.format = 5;\n                texture.type = 0;\n                texture.generateMipMaps = true;\n                texture.getEngine().updateTextureSamplingMode(Texture.TRILINEAR_SAMPLINGMODE, texture);\n                texture._isRGBD = true;\n                texture.invertY = true;\n                _this._engine.loadCubeTextureWithMips(texture._hardwareTexture.underlyingResource, imageData, false, useSRGBBuffer, function () {\n                    texture.isReady = true;\n                    if (onLoad) {\n                        onLoad();\n                    }\n                }, function () {\n                    throw new Error(\"Could not load a native cube texture.\");\n                });\n            };\n            if (files && files.length === 6) {\n                throw new Error(\"Multi-file loading not allowed on env files.\");\n            }\n            else {\n                var onInternalError = function (request, exception) {\n                    if (onError && request) {\n                        onError(request.status + \" \" + request.statusText, exception);\n                    }\n                };\n                this._loadFile(rootUrl, function (data) { return onloaddata_1(new Uint8Array(data)); }, undefined, undefined, true, onInternalError);\n            }\n        }\n        else {\n            if (!files || files.length !== 6) {\n                throw new Error(\"Cannot load cubemap because 6 files were not defined\");\n            }\n            // Reorder from [+X, +Y, +Z, -X, -Y, -Z] to [+X, -X, +Y, -Y, +Z, -Z].\n            var reorderedFiles = [files[0], files[3], files[1], files[4], files[2], files[5]];\n            Promise.all(reorderedFiles.map(function (file) { return Tools.LoadFileAsync(file).then(function (data) { return new Uint8Array(data); }); }))\n                .then(function (data) {\n                return new Promise(function (resolve, reject) {\n                    _this._engine.loadCubeTexture(texture._hardwareTexture.underlyingResource, data, !noMipmap, true, useSRGBBuffer, resolve, reject);\n                });\n            })\n                .then(function () {\n                texture.isReady = true;\n                if (onLoad) {\n                    onLoad();\n                }\n            }, function (error) {\n                if (onError) {\n                    onError(\"Failed to load cubemap: \".concat(error.message), error);\n                }\n            });\n        }\n        this._internalTexturesCache.push(texture);\n        return texture;\n    };\n    /**\n     * @param isMulti\n     * @param isCube\n     * @param size\n     * @hidden\n     */\n    NativeEngine.prototype._createHardwareRenderTargetWrapper = function (isMulti, isCube, size) {\n        var rtWrapper = new NativeRenderTargetWrapper(isMulti, isCube, size, this);\n        this._renderTargetWrapperCache.push(rtWrapper);\n        return rtWrapper;\n    };\n    NativeEngine.prototype.createRenderTargetTexture = function (size, options) {\n        var rtWrapper = this._createHardwareRenderTargetWrapper(false, false, size);\n        var fullOptions = {};\n        if (options !== undefined && typeof options === \"object\") {\n            fullOptions.generateMipMaps = options.generateMipMaps;\n            fullOptions.generateDepthBuffer = options.generateDepthBuffer === undefined ? true : options.generateDepthBuffer;\n            fullOptions.generateStencilBuffer = fullOptions.generateDepthBuffer && options.generateStencilBuffer;\n            fullOptions.type = options.type === undefined ? 0 : options.type;\n            fullOptions.samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n            fullOptions.format = options.format === undefined ? 5 : options.format;\n        }\n        else {\n            fullOptions.generateMipMaps = options;\n            fullOptions.generateDepthBuffer = true;\n            fullOptions.generateStencilBuffer = false;\n            fullOptions.type = 0;\n            fullOptions.samplingMode = 3;\n            fullOptions.format = 5;\n        }\n        if (fullOptions.type === 1 && !this._caps.textureFloatLinearFiltering) {\n            // if floating point linear (gl.FLOAT) then force to NEAREST_SAMPLINGMODE\n            fullOptions.samplingMode = 1;\n        }\n        else if (fullOptions.type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n            // if floating point linear (HALF_FLOAT) then force to NEAREST_SAMPLINGMODE\n            fullOptions.samplingMode = 1;\n        }\n        var texture = new InternalTexture(this, InternalTextureSource.RenderTarget);\n        var width = size.width || size;\n        var height = size.height || size;\n        if (fullOptions.type === 1 && !this._caps.textureFloat) {\n            fullOptions.type = 0;\n            Logger.Warn(\"Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type\");\n        }\n        var framebuffer = this._engine.createFrameBuffer(texture._hardwareTexture.underlyingResource, width, height, this._getNativeTextureFormat(fullOptions.format, fullOptions.type), fullOptions.generateStencilBuffer ? true : false, fullOptions.generateDepthBuffer, fullOptions.generateMipMaps ? true : false);\n        rtWrapper._framebuffer = framebuffer;\n        rtWrapper._generateDepthBuffer = fullOptions.generateDepthBuffer;\n        rtWrapper._generateStencilBuffer = fullOptions.generateStencilBuffer ? true : false;\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = width;\n        texture.height = height;\n        texture.isReady = true;\n        texture.samples = 1;\n        texture.generateMipMaps = fullOptions.generateMipMaps ? true : false;\n        texture.samplingMode = fullOptions.samplingMode;\n        texture.type = fullOptions.type;\n        texture.format = fullOptions.format;\n        this._internalTexturesCache.push(texture);\n        rtWrapper.setTextures(texture);\n        return rtWrapper;\n    };\n    NativeEngine.prototype.updateTextureSamplingMode = function (samplingMode, texture) {\n        if (texture._hardwareTexture) {\n            var filter = this._getNativeSamplingMode(samplingMode);\n            this._setTextureSampling(texture._hardwareTexture.underlyingResource, filter);\n        }\n        texture.samplingMode = samplingMode;\n    };\n    NativeEngine.prototype.bindFramebuffer = function (texture, faceIndex, requiredWidth, requiredHeight, forceFullscreenViewport) {\n        var nativeRTWrapper = texture;\n        if (faceIndex) {\n            throw new Error(\"Cuboid frame buffers are not yet supported in NativeEngine.\");\n        }\n        if (requiredWidth || requiredHeight) {\n            throw new Error(\"Required width/height for frame buffers not yet supported in NativeEngine.\");\n        }\n        if (forceFullscreenViewport) {\n            //Not supported yet but don't stop rendering\n        }\n        if (nativeRTWrapper._framebufferDepthStencil) {\n            this._bindUnboundFramebuffer(nativeRTWrapper._framebufferDepthStencil);\n        }\n        else {\n            this._bindUnboundFramebuffer(nativeRTWrapper._framebuffer);\n        }\n    };\n    NativeEngine.prototype.unBindFramebuffer = function (texture, disableGenerateMipMaps, onBeforeUnbind) {\n        // NOTE: Disabling mipmap generation is not yet supported in NativeEngine.\n        if (disableGenerateMipMaps === void 0) { disableGenerateMipMaps = false; }\n        if (onBeforeUnbind) {\n            onBeforeUnbind();\n        }\n        this._bindUnboundFramebuffer(null);\n    };\n    NativeEngine.prototype.createDynamicVertexBuffer = function (data) {\n        return this.createVertexBuffer(data, true);\n    };\n    NativeEngine.prototype.updateDynamicIndexBuffer = function (indexBuffer, indices, offset) {\n        if (offset === void 0) { offset = 0; }\n        var buffer = indexBuffer;\n        var data = this._normalizeIndexData(indices);\n        buffer.is32Bits = data.BYTES_PER_ELEMENT === 4;\n        this._engine.updateDynamicIndexBuffer(buffer.nativeIndexBuffer, data.buffer, data.byteOffset, data.byteLength, offset);\n    };\n    NativeEngine.prototype.updateDynamicVertexBuffer = function (vertexBuffer, verticies, byteOffset, byteLength) {\n        var buffer = vertexBuffer;\n        var data = ArrayBuffer.isView(verticies) ? verticies : new Float32Array(verticies);\n        this._engine.updateDynamicVertexBuffer(buffer.nativeVertexBuffer, data.buffer, data.byteOffset + (byteOffset !== null && byteOffset !== void 0 ? byteOffset : 0), byteLength !== null && byteLength !== void 0 ? byteLength : data.byteLength);\n    };\n    // TODO: Refactor to share more logic with base Engine implementation.\n    NativeEngine.prototype._setTexture = function (channel, texture, isPartOfTextureArray, depthStencilTexture) {\n        if (isPartOfTextureArray === void 0) { isPartOfTextureArray = false; }\n        if (depthStencilTexture === void 0) { depthStencilTexture = false; }\n        var uniform = this._boundUniforms[channel];\n        if (!uniform) {\n            return false;\n        }\n        // Not ready?\n        if (!texture) {\n            if (this._boundTexturesCache[channel] != null) {\n                this._activeChannel = channel;\n                this._setTextureCore(uniform, null);\n            }\n            return false;\n        }\n        // Video\n        if (texture.video) {\n            this._activeChannel = channel;\n            texture.update();\n        }\n        else if (texture.delayLoadState === 4) {\n            // Delay loading\n            texture.delayLoad();\n            return false;\n        }\n        var internalTexture;\n        if (depthStencilTexture) {\n            internalTexture = texture.depthStencilTexture;\n        }\n        else if (texture.isReady()) {\n            internalTexture = texture.getInternalTexture();\n        }\n        else if (texture.isCube) {\n            internalTexture = this.emptyCubeTexture;\n        }\n        else if (texture.is3D) {\n            internalTexture = this.emptyTexture3D;\n        }\n        else if (texture.is2DArray) {\n            internalTexture = this.emptyTexture2DArray;\n        }\n        else {\n            internalTexture = this.emptyTexture;\n        }\n        this._activeChannel = channel;\n        if (!internalTexture || !internalTexture._hardwareTexture) {\n            return false;\n        }\n        this._setTextureWrapMode(internalTexture._hardwareTexture.underlyingResource, this._getAddressMode(texture.wrapU), this._getAddressMode(texture.wrapV), this._getAddressMode(texture.wrapR));\n        this._updateAnisotropicLevel(texture);\n        this._setTextureCore(uniform, internalTexture._hardwareTexture.underlyingResource);\n        return true;\n    };\n    // filter is a NativeFilter.XXXX value.\n    NativeEngine.prototype._setTextureSampling = function (texture, filter) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETTEXTURESAMPLING);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(texture);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(filter);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    // addressModes are NativeAddressMode.XXXX values.\n    NativeEngine.prototype._setTextureWrapMode = function (texture, addressModeU, addressModeV, addressModeW) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETTEXTUREWRAPMODE);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(texture);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(addressModeU);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(addressModeV);\n        this._commandBufferEncoder.encodeCommandArgAsUInt32(addressModeW);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    NativeEngine.prototype._setTextureCore = function (uniform, texture) {\n        this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETTEXTURE);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(uniform);\n        this._commandBufferEncoder.encodeCommandArgAsNativeData(texture);\n        this._commandBufferEncoder.finishEncodingCommand();\n    };\n    // TODO: Share more of this logic with the base implementation.\n    // TODO: Rename to match naming in base implementation once refactoring allows different parameters.\n    NativeEngine.prototype._updateAnisotropicLevel = function (texture) {\n        var internalTexture = texture.getInternalTexture();\n        var value = texture.anisotropicFilteringLevel;\n        if (!internalTexture || !internalTexture._hardwareTexture) {\n            return;\n        }\n        if (internalTexture._cachedAnisotropicFilteringLevel !== value) {\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_SETTEXTUREANISOTROPICLEVEL);\n            this._commandBufferEncoder.encodeCommandArgAsNativeData(internalTexture._hardwareTexture.underlyingResource);\n            this._commandBufferEncoder.encodeCommandArgAsUInt32(value);\n            this._commandBufferEncoder.finishEncodingCommand();\n            internalTexture._cachedAnisotropicFilteringLevel = value;\n        }\n    };\n    // Returns a NativeAddressMode.XXX value.\n    NativeEngine.prototype._getAddressMode = function (wrapMode) {\n        switch (wrapMode) {\n            case 1:\n                return _native.Engine.ADDRESS_MODE_WRAP;\n            case 0:\n                return _native.Engine.ADDRESS_MODE_CLAMP;\n            case 2:\n                return _native.Engine.ADDRESS_MODE_MIRROR;\n            default:\n                throw new Error(\"Unexpected wrap mode: \" + wrapMode + \".\");\n        }\n    };\n    /**\n     * @param channel\n     * @param texture\n     * @hidden\n     */\n    NativeEngine.prototype._bindTexture = function (channel, texture) {\n        var uniform = this._boundUniforms[channel];\n        if (!uniform) {\n            return;\n        }\n        if (texture && texture._hardwareTexture) {\n            var underlyingResource = texture._hardwareTexture.underlyingResource;\n            this._setTextureCore(uniform, underlyingResource);\n        }\n    };\n    NativeEngine.prototype._deleteBuffer = function (buffer) {\n        if (buffer.nativeIndexBuffer) {\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DELETEINDEXBUFFER);\n            this._commandBufferEncoder.encodeCommandArgAsNativeData(buffer.nativeIndexBuffer);\n            this._commandBufferEncoder.finishEncodingCommand();\n            delete buffer.nativeIndexBuffer;\n        }\n        if (buffer.nativeVertexBuffer) {\n            this._commandBufferEncoder.startEncodingCommand(_native.Engine.COMMAND_DELETEVERTEXBUFFER);\n            this._commandBufferEncoder.encodeCommandArgAsNativeData(buffer.nativeVertexBuffer);\n            this._commandBufferEncoder.finishEncodingCommand();\n            delete buffer.nativeVertexBuffer;\n        }\n    };\n    /**\n     * Create a canvas\n     * @param width width\n     * @param height height\n     * @return ICanvas interface\n     */\n    NativeEngine.prototype.createCanvas = function (width, height) {\n        if (!_native.Canvas) {\n            throw new Error(\"Native Canvas plugin not available.\");\n        }\n        var canvas = new _native.Canvas();\n        canvas.width = width;\n        canvas.height = height;\n        return canvas;\n    };\n    /**\n     * Create an image to use with canvas\n     * @return IImage interface\n     */\n    NativeEngine.prototype.createCanvasImage = function () {\n        if (!_native.Canvas) {\n            throw new Error(\"Native Canvas plugin not available.\");\n        }\n        var image = new _native.Image();\n        return image;\n    };\n    /**\n     * Update a portion of an internal texture\n     * @param texture defines the texture to update\n     * @param imageData defines the data to store into the texture\n     * @param xOffset defines the x coordinates of the update rectangle\n     * @param yOffset defines the y coordinates of the update rectangle\n     * @param width defines the width of the update rectangle\n     * @param height defines the height of the update rectangle\n     * @param faceIndex defines the face index if texture is a cube (0 by default)\n     * @param lod defines the lod level to update (0 by default)\n     * @param generateMipMaps defines whether to generate mipmaps or not\n     */\n    NativeEngine.prototype.updateTextureData = function (texture, imageData, xOffset, yOffset, width, height, faceIndex, lod, generateMipMaps) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        if (generateMipMaps === void 0) { generateMipMaps = false; }\n        throw new Error(\"updateTextureData not implemented.\");\n    };\n    /**\n     * @param texture\n     * @param internalFormat\n     * @param width\n     * @param height\n     * @param data\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NativeEngine.prototype._uploadCompressedDataToTextureDirectly = function (texture, internalFormat, width, height, data, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        throw new Error(\"_uploadCompressedDataToTextureDirectly not implemented.\");\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NativeEngine.prototype._uploadDataToTextureDirectly = function (texture, imageData, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        throw new Error(\"_uploadDataToTextureDirectly not implemented.\");\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NativeEngine.prototype._uploadArrayBufferViewToTexture = function (texture, imageData, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        throw new Error(\"_uploadArrayBufferViewToTexture not implemented.\");\n    };\n    /**\n     * @param texture\n     * @param image\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NativeEngine.prototype._uploadImageToTexture = function (texture, image, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        throw new Error(\"_uploadArrayBufferViewToTexture not implemented.\");\n    };\n    // JavaScript-to-Native conversion helper functions.\n    NativeEngine.prototype._getNativeSamplingMode = function (samplingMode) {\n        switch (samplingMode) {\n            case 1:\n                return _native.Engine.TEXTURE_NEAREST_NEAREST;\n            case 2:\n                return _native.Engine.TEXTURE_LINEAR_LINEAR;\n            case 3:\n                return _native.Engine.TEXTURE_LINEAR_LINEAR_MIPLINEAR;\n            case 4:\n                return _native.Engine.TEXTURE_NEAREST_NEAREST_MIPNEAREST;\n            case 5:\n                return _native.Engine.TEXTURE_NEAREST_LINEAR_MIPNEAREST;\n            case 6:\n                return _native.Engine.TEXTURE_NEAREST_LINEAR_MIPLINEAR;\n            case 7:\n                return _native.Engine.TEXTURE_NEAREST_LINEAR;\n            case 8:\n                return _native.Engine.TEXTURE_NEAREST_NEAREST_MIPLINEAR;\n            case 9:\n                return _native.Engine.TEXTURE_LINEAR_NEAREST_MIPNEAREST;\n            case 10:\n                return _native.Engine.TEXTURE_LINEAR_NEAREST_MIPLINEAR;\n            case 11:\n                return _native.Engine.TEXTURE_LINEAR_LINEAR_MIPNEAREST;\n            case 12:\n                return _native.Engine.TEXTURE_LINEAR_NEAREST;\n            default:\n                throw new Error(\"Unsupported sampling mode: \".concat(samplingMode, \".\"));\n        }\n    };\n    NativeEngine.prototype._getStencilFunc = function (func) {\n        switch (func) {\n            case 513:\n                return _native.Engine.STENCIL_TEST_LESS;\n            case 515:\n                return _native.Engine.STENCIL_TEST_LEQUAL;\n            case 514:\n                return _native.Engine.STENCIL_TEST_EQUAL;\n            case 518:\n                return _native.Engine.STENCIL_TEST_GEQUAL;\n            case 516:\n                return _native.Engine.STENCIL_TEST_GREATER;\n            case 517:\n                return _native.Engine.STENCIL_TEST_NOTEQUAL;\n            case 512:\n                return _native.Engine.STENCIL_TEST_NEVER;\n            case 519:\n                return _native.Engine.STENCIL_TEST_ALWAYS;\n            default:\n                throw new Error(\"Unsupported stencil func mode: \".concat(func, \".\"));\n        }\n    };\n    NativeEngine.prototype._getStencilOpFail = function (opFail) {\n        switch (opFail) {\n            case 7680:\n                return _native.Engine.STENCIL_OP_FAIL_S_KEEP;\n            case 0:\n                return _native.Engine.STENCIL_OP_FAIL_S_ZERO;\n            case 7681:\n                return _native.Engine.STENCIL_OP_FAIL_S_REPLACE;\n            case 7682:\n                return _native.Engine.STENCIL_OP_FAIL_S_INCR;\n            case 7683:\n                return _native.Engine.STENCIL_OP_FAIL_S_DECR;\n            case 5386:\n                return _native.Engine.STENCIL_OP_FAIL_S_INVERT;\n            case 34055:\n                return _native.Engine.STENCIL_OP_FAIL_S_INCRSAT;\n            case 34056:\n                return _native.Engine.STENCIL_OP_FAIL_S_DECRSAT;\n            default:\n                throw new Error(\"Unsupported stencil OpFail mode: \".concat(opFail, \".\"));\n        }\n    };\n    NativeEngine.prototype._getStencilDepthFail = function (depthFail) {\n        switch (depthFail) {\n            case 7680:\n                return _native.Engine.STENCIL_OP_FAIL_Z_KEEP;\n            case 0:\n                return _native.Engine.STENCIL_OP_FAIL_Z_ZERO;\n            case 7681:\n                return _native.Engine.STENCIL_OP_FAIL_Z_REPLACE;\n            case 7682:\n                return _native.Engine.STENCIL_OP_FAIL_Z_INCR;\n            case 7683:\n                return _native.Engine.STENCIL_OP_FAIL_Z_DECR;\n            case 5386:\n                return _native.Engine.STENCIL_OP_FAIL_Z_INVERT;\n            case 34055:\n                return _native.Engine.STENCIL_OP_FAIL_Z_INCRSAT;\n            case 34056:\n                return _native.Engine.STENCIL_OP_FAIL_Z_DECRSAT;\n            default:\n                throw new Error(\"Unsupported stencil depthFail mode: \".concat(depthFail, \".\"));\n        }\n    };\n    NativeEngine.prototype._getStencilDepthPass = function (opPass) {\n        switch (opPass) {\n            case 7680:\n                return _native.Engine.STENCIL_OP_PASS_Z_KEEP;\n            case 0:\n                return _native.Engine.STENCIL_OP_PASS_Z_ZERO;\n            case 7681:\n                return _native.Engine.STENCIL_OP_PASS_Z_REPLACE;\n            case 7682:\n                return _native.Engine.STENCIL_OP_PASS_Z_INCR;\n            case 7683:\n                return _native.Engine.STENCIL_OP_PASS_Z_DECR;\n            case 5386:\n                return _native.Engine.STENCIL_OP_PASS_Z_INVERT;\n            case 34055:\n                return _native.Engine.STENCIL_OP_PASS_Z_INCRSAT;\n            case 34056:\n                return _native.Engine.STENCIL_OP_PASS_Z_DECRSAT;\n            default:\n                throw new Error(\"Unsupported stencil opPass mode: \".concat(opPass, \".\"));\n        }\n    };\n    NativeEngine.prototype._getNativeTextureFormat = function (format, type) {\n        if (format == 4 && type == 0) {\n            return _native.Engine.TEXTURE_FORMAT_RGB8;\n        }\n        else if (format == 5 && type == 0) {\n            return _native.Engine.TEXTURE_FORMAT_RGBA8;\n        }\n        else if (format == 5 && type == 1) {\n            return _native.Engine.TEXTURE_FORMAT_RGBA32F;\n        }\n        else {\n            throw new RuntimeError(\"Unsupported texture format or type: format \".concat(format, \", type \").concat(type, \".\"), ErrorCodes.UnsupportedTextureError);\n        }\n    };\n    NativeEngine.prototype._getNativeAlphaMode = function (mode) {\n        switch (mode) {\n            case 0:\n                return _native.Engine.ALPHA_DISABLE;\n            case 1:\n                return _native.Engine.ALPHA_ADD;\n            case 2:\n                return _native.Engine.ALPHA_COMBINE;\n            case 3:\n                return _native.Engine.ALPHA_SUBTRACT;\n            case 4:\n                return _native.Engine.ALPHA_MULTIPLY;\n            case 5:\n                return _native.Engine.ALPHA_MAXIMIZED;\n            case 6:\n                return _native.Engine.ALPHA_ONEONE;\n            case 7:\n                return _native.Engine.ALPHA_PREMULTIPLIED;\n            case 8:\n                return _native.Engine.ALPHA_PREMULTIPLIED_PORTERDUFF;\n            case 9:\n                return _native.Engine.ALPHA_INTERPOLATE;\n            case 10:\n                return _native.Engine.ALPHA_SCREENMODE;\n            default:\n                throw new Error(\"Unsupported alpha mode: \".concat(mode, \".\"));\n        }\n    };\n    NativeEngine.prototype._getNativeAttribType = function (type) {\n        switch (type) {\n            case VertexBuffer.BYTE:\n                return _native.Engine.ATTRIB_TYPE_INT8;\n            case VertexBuffer.UNSIGNED_BYTE:\n                return _native.Engine.ATTRIB_TYPE_UINT8;\n            case VertexBuffer.SHORT:\n                return _native.Engine.ATTRIB_TYPE_INT16;\n            case VertexBuffer.UNSIGNED_SHORT:\n                return _native.Engine.ATTRIB_TYPE_UINT16;\n            case VertexBuffer.FLOAT:\n                return _native.Engine.ATTRIB_TYPE_FLOAT;\n            default:\n                throw new Error(\"Unsupported attribute type: \".concat(type, \".\"));\n        }\n    };\n    NativeEngine.prototype.getFontOffset = function (font) {\n        // TODO\n        var result = { ascent: 0, height: 0, descent: 0 };\n        return result;\n    };\n    // This must match the protocol version in NativeEngine.cpp\n    NativeEngine.PROTOCOL_VERSION = 6;\n    return NativeEngine;\n}(Engine));\nexport { NativeEngine };\n//# sourceMappingURL=nativeEngine.js.map","import { __extends } from \"tslib\";\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { Logger } from \"../Misc/logger.js\";\nimport { Engine } from \"../Engines/engine.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\n\nimport { DataBuffer } from \"../Buffers/dataBuffer.js\";\nimport { PerformanceConfigurator } from \"./performanceConfigurator.js\";\nimport { DrawWrapper } from \"../Materials/drawWrapper.js\";\nimport { RenderTargetWrapper } from \"./renderTargetWrapper.js\";\n/**\n * Options to create the null engine\n */\nvar NullEngineOptions = /** @class */ (function () {\n    function NullEngineOptions() {\n        /**\n         * Render width (Default: 512)\n         */\n        this.renderWidth = 512;\n        /**\n         * Render height (Default: 256)\n         */\n        this.renderHeight = 256;\n        /**\n         * Texture size (Default: 512)\n         */\n        this.textureSize = 512;\n        /**\n         * If delta time between frames should be constant\n         * @see https://doc.babylonjs.com/babylon101/animations#deterministic-lockstep\n         */\n        this.deterministicLockstep = false;\n        /**\n         * Maximum about of steps between frames (Default: 4)\n         * @see https://doc.babylonjs.com/babylon101/animations#deterministic-lockstep\n         */\n        this.lockstepMaxSteps = 4;\n    }\n    return NullEngineOptions;\n}());\nexport { NullEngineOptions };\n/**\n * The null engine class provides support for headless version of babylon.js.\n * This can be used in server side scenario or for testing purposes\n */\nvar NullEngine = /** @class */ (function (_super) {\n    __extends(NullEngine, _super);\n    function NullEngine(options) {\n        if (options === void 0) { options = new NullEngineOptions(); }\n        var _this = _super.call(this, null) || this;\n        Engine.Instances.push(_this);\n        if (options.deterministicLockstep === undefined) {\n            options.deterministicLockstep = false;\n        }\n        if (options.lockstepMaxSteps === undefined) {\n            options.lockstepMaxSteps = 4;\n        }\n        _this._options = options;\n        PerformanceConfigurator.SetMatrixPrecision(!!options.useHighPrecisionMatrix);\n        // Init caps\n        // We consider we are on a webgl1 capable device\n        _this._caps = {\n            maxTexturesImageUnits: 16,\n            maxVertexTextureImageUnits: 16,\n            maxCombinedTexturesImageUnits: 32,\n            maxTextureSize: 512,\n            maxCubemapTextureSize: 512,\n            maxRenderTextureSize: 512,\n            maxVertexAttribs: 16,\n            maxVaryingVectors: 16,\n            maxFragmentUniformVectors: 16,\n            maxVertexUniformVectors: 16,\n            standardDerivatives: false,\n            astc: null,\n            pvrtc: null,\n            etc1: null,\n            etc2: null,\n            bptc: null,\n            maxAnisotropy: 0,\n            uintIndices: false,\n            fragmentDepthSupported: false,\n            highPrecisionShaderSupported: true,\n            colorBufferFloat: false,\n            textureFloat: false,\n            textureFloatLinearFiltering: false,\n            textureFloatRender: false,\n            textureHalfFloat: false,\n            textureHalfFloatLinearFiltering: false,\n            textureHalfFloatRender: false,\n            textureLOD: false,\n            drawBuffersExtension: false,\n            depthTextureExtension: false,\n            vertexArrayObject: false,\n            instancedArrays: false,\n            supportOcclusionQuery: false,\n            canUseTimestampForTimerQuery: false,\n            maxMSAASamples: 1,\n            blendMinMax: false,\n            canUseGLInstanceID: false,\n            canUseGLVertexID: false,\n            supportComputeShaders: false,\n            supportSRGBBuffers: false,\n            supportTransformFeedbacks: false,\n            textureMaxLevel: false,\n            texture2DArrayMaxLayerCount: 128,\n        };\n        _this._features = {\n            forceBitmapOverHTMLImageElement: false,\n            supportRenderAndCopyToLodForFloatTextures: false,\n            supportDepthStencilTexture: false,\n            supportShadowSamplers: false,\n            uniformBufferHardCheckMatrix: false,\n            allowTexturePrefiltering: false,\n            trackUbosInFrame: false,\n            checkUbosContentBeforeUpload: false,\n            supportCSM: false,\n            basisNeedsPOT: false,\n            support3DTextures: false,\n            needTypeSuffixInShaderConstants: false,\n            supportMSAA: false,\n            supportSSAO2: false,\n            supportExtendedTextureFormats: false,\n            supportSwitchCaseInShader: false,\n            supportSyncTextureRead: false,\n            needsInvertingBitmap: false,\n            useUBOBindingCache: false,\n            needShaderCodeInlining: false,\n            needToAlwaysBindUniformBuffers: false,\n            supportRenderPasses: true,\n            _collectUbosUpdatedInFrame: false,\n        };\n        Logger.Log(\"Babylon.js v\".concat(Engine.Version, \" - Null engine\"));\n        // Wrappers\n        var theCurrentGlobal = typeof self !== \"undefined\" ? self : typeof global !== \"undefined\" ? global : window;\n        if (typeof URL === \"undefined\") {\n            theCurrentGlobal.URL = {\n                createObjectURL: function () { },\n                revokeObjectURL: function () { },\n            };\n        }\n        if (typeof Blob === \"undefined\") {\n            theCurrentGlobal.Blob = function () { };\n        }\n        return _this;\n    }\n    /**\n     * Gets a boolean indicating that the engine is running in deterministic lock step mode\n     * @see https://doc.babylonjs.com/babylon101/animations#deterministic-lockstep\n     * @returns true if engine is in deterministic lock step mode\n     */\n    NullEngine.prototype.isDeterministicLockStep = function () {\n        return this._options.deterministicLockstep;\n    };\n    /**\n     * Gets the max steps when engine is running in deterministic lock step\n     * @see https://doc.babylonjs.com/babylon101/animations#deterministic-lockstep\n     * @returns the max steps\n     */\n    NullEngine.prototype.getLockstepMaxSteps = function () {\n        return this._options.lockstepMaxSteps;\n    };\n    /**\n     * Gets the current hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @returns a number indicating the current hardware scaling level\n     */\n    NullEngine.prototype.getHardwareScalingLevel = function () {\n        return 1.0;\n    };\n    /**\n     * Creates a vertex buffer\n     * @param vertices the data for the vertex buffer\n     * @returns the new WebGL static buffer\n     */\n    NullEngine.prototype.createVertexBuffer = function (vertices) {\n        var buffer = new DataBuffer();\n        buffer.references = 1;\n        return buffer;\n    };\n    /**\n     * Creates a new index buffer\n     * @param indices defines the content of the index buffer\n     * @returns a new webGL buffer\n     */\n    NullEngine.prototype.createIndexBuffer = function (indices) {\n        var buffer = new DataBuffer();\n        buffer.references = 1;\n        return buffer;\n    };\n    /**\n     * Clear the current render buffer or the current render target (if any is set up)\n     * @param color defines the color to use\n     * @param backBuffer defines if the back buffer must be cleared\n     * @param depth defines if the depth buffer must be cleared\n     * @param stencil defines if the stencil buffer must be cleared\n     */\n    NullEngine.prototype.clear = function (color, backBuffer, depth, stencil) {\n        if (stencil === void 0) { stencil = false; }\n    };\n    /**\n     * Gets the current render width\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render width\n     */\n    NullEngine.prototype.getRenderWidth = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.width;\n        }\n        return this._options.renderWidth;\n    };\n    /**\n     * Gets the current render height\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render height\n     */\n    NullEngine.prototype.getRenderHeight = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.height;\n        }\n        return this._options.renderHeight;\n    };\n    /**\n     * Set the WebGL's viewport\n     * @param viewport defines the viewport element to be used\n     * @param requiredWidth defines the width required for rendering. If not provided the rendering canvas' width is used\n     * @param requiredHeight defines the height required for rendering. If not provided the rendering canvas' height is used\n     */\n    NullEngine.prototype.setViewport = function (viewport, requiredWidth, requiredHeight) {\n        this._cachedViewport = viewport;\n    };\n    NullEngine.prototype.createShaderProgram = function (pipelineContext, vertexCode, fragmentCode, defines, context) {\n        return {\n            // eslint-disable-next-line @typescript-eslint/naming-convention\n            __SPECTOR_rebuildProgram: null,\n        };\n    };\n    /**\n     * Gets the list of webGL uniform locations associated with a specific program based on a list of uniform names\n     * @param pipelineContext defines the pipeline context to use\n     * @param uniformsNames defines the list of uniform names\n     * @returns an array of webGL uniform locations\n     */\n    NullEngine.prototype.getUniforms = function (pipelineContext, uniformsNames) {\n        return [];\n    };\n    /**\n     * Gets the lsit of active attributes for a given webGL program\n     * @param pipelineContext defines the pipeline context to use\n     * @param attributesNames defines the list of attribute names to get\n     * @returns an array of indices indicating the offset of each attribute\n     */\n    NullEngine.prototype.getAttributes = function (pipelineContext, attributesNames) {\n        return [];\n    };\n    /**\n     * Binds an effect to the webGL context\n     * @param effect defines the effect to bind\n     */\n    NullEngine.prototype.bindSamplers = function (effect) {\n        this._currentEffect = null;\n    };\n    /**\n     * Activates an effect, making it the current one (ie. the one used for rendering)\n     * @param effect defines the effect to activate\n     */\n    NullEngine.prototype.enableEffect = function (effect) {\n        effect = effect !== null && DrawWrapper.IsWrapper(effect) ? effect.effect : effect; // get only the effect, we don't need a Wrapper in the WebGL engine\n        this._currentEffect = effect;\n        if (!effect) {\n            return;\n        }\n        if (effect.onBind) {\n            effect.onBind(effect);\n        }\n        if (effect._onBindObservable) {\n            effect._onBindObservable.notifyObservers(effect);\n        }\n    };\n    /**\n     * Set various states to the webGL context\n     * @param culling defines culling state: true to enable culling, false to disable it\n     * @param zOffset defines the value to apply to zOffset (0 by default)\n     * @param force defines if states must be applied even if cache is up to date\n     * @param reverseSide defines if culling must be reversed (CCW if false, CW if true)\n     * @param cullBackFaces true to cull back faces, false to cull front faces (if culling is enabled)\n     * @param stencil stencil states to set\n     * @param zOffsetUnits defines the value to apply to zOffsetUnits (0 by default)\n     */\n    NullEngine.prototype.setState = function (culling, zOffset, force, reverseSide, cullBackFaces, stencil, zOffsetUnits) {\n        if (zOffset === void 0) { zOffset = 0; }\n        if (reverseSide === void 0) { reverseSide = false; }\n        if (zOffsetUnits === void 0) { zOffsetUnits = 0; }\n    };\n    /**\n     * Set the value of an uniform to an array of int32\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setIntArray = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setIntArray2 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setIntArray3 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setIntArray4 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of float32\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of float32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloatArray = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of float32 (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of float32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloatArray2 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of float32 (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of float32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloatArray3 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of float32 (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of float32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloatArray4 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setArray = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setArray2 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setArray3 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setArray4 = function (uniform, array) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of float32 (stored as matrices)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrices defines the array of float32 to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setMatrices = function (uniform, matrices) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a matrix (3x3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 3x3 matrix to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setMatrix3x3 = function (uniform, matrix) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a matrix (2x2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 2x2 matrix to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setMatrix2x2 = function (uniform, matrix) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a number (float)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the float number to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloat = function (uniform, value) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a vec2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloat2 = function (uniform, x, y) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a vec3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloat3 = function (uniform, x, y, z) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a boolean\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param bool defines the boolean to store\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setBool = function (uniform, bool) {\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a vec4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if value was set\n     */\n    NullEngine.prototype.setFloat4 = function (uniform, x, y, z, w) {\n        return true;\n    };\n    /**\n     * Sets the current alpha mode\n     * @param mode defines the mode to use (one of the Engine.ALPHA_XXX)\n     * @param noDepthWriteChange defines if depth writing state should remains unchanged (false by default)\n     * @see https://doc.babylonjs.com/resources/transparency_and_how_meshes_are_rendered\n     */\n    NullEngine.prototype.setAlphaMode = function (mode, noDepthWriteChange) {\n        if (noDepthWriteChange === void 0) { noDepthWriteChange = false; }\n        if (this._alphaMode === mode) {\n            return;\n        }\n        this.alphaState.alphaBlend = mode !== 0;\n        if (!noDepthWriteChange) {\n            this.setDepthWrite(mode === 0);\n        }\n        this._alphaMode = mode;\n    };\n    /**\n     * Bind webGl buffers directly to the webGL context\n     * @param vertexBuffers defines the vertex buffer to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param effect defines the effect associated with the vertex buffer\n     */\n    NullEngine.prototype.bindBuffers = function (vertexBuffers, indexBuffer, effect) { };\n    /**\n     * Force the entire cache to be cleared\n     * You should not have to use this function unless your engine needs to share the webGL context with another engine\n     * @param bruteForce defines a boolean to force clearing ALL caches (including stencil, detoh and alpha states)\n     */\n    NullEngine.prototype.wipeCaches = function (bruteForce) {\n        if (this.preventCacheWipeBetweenFrames) {\n            return;\n        }\n        this.resetTextureCache();\n        this._currentEffect = null;\n        if (bruteForce) {\n            this._currentProgram = null;\n            this._stencilStateComposer.reset();\n            this.depthCullingState.reset();\n            this.alphaState.reset();\n        }\n        this._cachedVertexBuffers = null;\n        this._cachedIndexBuffer = null;\n        this._cachedEffectForVertexBuffers = null;\n    };\n    /**\n     * Send a draw order\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    NullEngine.prototype.draw = function (useTriangles, indexStart, indexCount, instancesCount) { };\n    /**\n     * Draw a list of indexed primitives\n     * @param fillMode defines the primitive to use\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    NullEngine.prototype.drawElementsType = function (fillMode, indexStart, indexCount, instancesCount) { };\n    /**\n     * Draw a list of unindexed primitives\n     * @param fillMode defines the primitive to use\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    NullEngine.prototype.drawArraysType = function (fillMode, verticesStart, verticesCount, instancesCount) { };\n    /** @hidden */\n    NullEngine.prototype._createTexture = function () {\n        return {};\n    };\n    /**\n     * @param texture\n     * @hidden\n     */\n    NullEngine.prototype._releaseTexture = function (texture) { };\n    /**\n     * Usually called from Texture.ts.\n     * Passed information to create a WebGLTexture\n     * @param urlArg defines a value which contains one of the following:\n     * * A conventional http URL, e.g. 'http://...' or 'file://...'\n     * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n     * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n     * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n     * @param scene needed for loading to the correct scene\n     * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n     * @param onLoad optional callback to be called upon successful completion\n     * @param onError optional callback to be called upon failure\n     * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n     * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n     * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param mimeType defines an optional mime type\n     * @returns a InternalTexture for assignment back into BABYLON.Texture\n     */\n    NullEngine.prototype.createTexture = function (urlArg, noMipmap, invertY, scene, samplingMode, onLoad, onError, buffer, fallback, format, forcedExtension, mimeType) {\n        if (samplingMode === void 0) { samplingMode = 3; }\n        if (onLoad === void 0) { onLoad = null; }\n        if (onError === void 0) { onError = null; }\n        if (buffer === void 0) { buffer = null; }\n        if (fallback === void 0) { fallback = null; }\n        if (format === void 0) { format = null; }\n        if (forcedExtension === void 0) { forcedExtension = null; }\n        var texture = new InternalTexture(this, InternalTextureSource.Url);\n        var url = String(urlArg);\n        texture.url = url;\n        texture.generateMipMaps = !noMipmap;\n        texture.samplingMode = samplingMode;\n        texture.invertY = invertY;\n        texture.baseWidth = this._options.textureSize;\n        texture.baseHeight = this._options.textureSize;\n        texture.width = this._options.textureSize;\n        texture.height = this._options.textureSize;\n        if (format) {\n            texture.format = format;\n        }\n        texture.isReady = true;\n        if (onLoad) {\n            setTimeout(function () {\n                onLoad();\n            });\n        }\n        this._internalTexturesCache.push(texture);\n        return texture;\n    };\n    /**\n     * @param isMulti\n     * @param isCube\n     * @param size\n     * @hidden\n     */\n    NullEngine.prototype._createHardwareRenderTargetWrapper = function (isMulti, isCube, size) {\n        var rtWrapper = new RenderTargetWrapper(isMulti, isCube, size, this);\n        this._renderTargetWrapperCache.push(rtWrapper);\n        return rtWrapper;\n    };\n    /**\n     * Creates a new render target wrapper\n     * @param size defines the size of the texture\n     * @param options defines the options used to create the texture\n     * @returns a new render target wrapper\n     */\n    NullEngine.prototype.createRenderTargetTexture = function (size, options) {\n        var rtWrapper = this._createHardwareRenderTargetWrapper(false, false, size);\n        var fullOptions = {};\n        if (options !== undefined && typeof options === \"object\") {\n            fullOptions.generateMipMaps = options.generateMipMaps;\n            fullOptions.generateDepthBuffer = options.generateDepthBuffer === undefined ? true : options.generateDepthBuffer;\n            fullOptions.generateStencilBuffer = fullOptions.generateDepthBuffer && options.generateStencilBuffer;\n            fullOptions.type = options.type === undefined ? 0 : options.type;\n            fullOptions.samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n        }\n        else {\n            fullOptions.generateMipMaps = options;\n            fullOptions.generateDepthBuffer = true;\n            fullOptions.generateStencilBuffer = false;\n            fullOptions.type = 0;\n            fullOptions.samplingMode = 3;\n        }\n        var texture = new InternalTexture(this, InternalTextureSource.RenderTarget);\n        var width = size.width || size;\n        var height = size.height || size;\n        rtWrapper._generateDepthBuffer = fullOptions.generateDepthBuffer;\n        rtWrapper._generateStencilBuffer = fullOptions.generateStencilBuffer ? true : false;\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = width;\n        texture.height = height;\n        texture.isReady = true;\n        texture.samples = 1;\n        texture.generateMipMaps = fullOptions.generateMipMaps ? true : false;\n        texture.samplingMode = fullOptions.samplingMode;\n        texture.type = fullOptions.type;\n        this._internalTexturesCache.push(texture);\n        return rtWrapper;\n    };\n    /**\n     * Update the sampling mode of a given texture\n     * @param samplingMode defines the required sampling mode\n     * @param texture defines the texture to update\n     */\n    NullEngine.prototype.updateTextureSamplingMode = function (samplingMode, texture) {\n        texture.samplingMode = samplingMode;\n    };\n    /**\n     * Creates a raw texture\n     * @param data defines the data to store in the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param format defines the format of the data\n     * @param generateMipMaps defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (Texture.NEAREST_SAMPLINGMODE by default)\n     * @param compression defines the compression used (null by default)\n     * @param type defines the type fo the data (Engine.TEXTURETYPE_UNSIGNED_INT by default)\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns the raw texture inside an InternalTexture\n     */\n    NullEngine.prototype.createRawTexture = function (data, width, height, format, generateMipMaps, invertY, samplingMode, compression, type, creationFlags, useSRGBBuffer) {\n        if (compression === void 0) { compression = null; }\n        if (type === void 0) { type = 0; }\n        if (creationFlags === void 0) { creationFlags = 0; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        var texture = new InternalTexture(this, InternalTextureSource.Raw);\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = width;\n        texture.height = height;\n        texture.format = format;\n        texture.generateMipMaps = generateMipMaps;\n        texture.samplingMode = samplingMode;\n        texture.invertY = invertY;\n        texture._compression = compression;\n        texture.type = type;\n        texture._useSRGBBuffer = useSRGBBuffer;\n        if (!this._doNotHandleContextLost) {\n            texture._bufferView = data;\n        }\n        return texture;\n    };\n    /**\n     * Update a raw texture\n     * @param texture defines the texture to update\n     * @param data defines the data to store in the texture\n     * @param format defines the format of the data\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param compression defines the compression used (null by default)\n     * @param type defines the type fo the data (Engine.TEXTURETYPE_UNSIGNED_INT by default)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     */\n    NullEngine.prototype.updateRawTexture = function (texture, data, format, invertY, compression, type, useSRGBBuffer) {\n        if (compression === void 0) { compression = null; }\n        if (type === void 0) { type = 0; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        if (texture) {\n            texture._bufferView = data;\n            texture.format = format;\n            texture.invertY = invertY;\n            texture._compression = compression;\n            texture.type = type;\n            texture._useSRGBBuffer = useSRGBBuffer;\n        }\n    };\n    /**\n     * Binds the frame buffer to the specified texture.\n     * @param rtWrapper The render target wrapper to render to\n     * @param faceIndex The face of the texture to render to in case of cube texture\n     * @param requiredWidth The width of the target to render to\n     * @param requiredHeight The height of the target to render to\n     * @param forceFullscreenViewport Forces the viewport to be the entire texture/screen if true\n     */\n    NullEngine.prototype.bindFramebuffer = function (rtWrapper, faceIndex, requiredWidth, requiredHeight, forceFullscreenViewport) {\n        if (this._currentRenderTarget) {\n            this.unBindFramebuffer(this._currentRenderTarget);\n        }\n        this._currentRenderTarget = rtWrapper;\n        this._currentFramebuffer = null;\n        if (this._cachedViewport && !forceFullscreenViewport) {\n            this.setViewport(this._cachedViewport, requiredWidth, requiredHeight);\n        }\n    };\n    /**\n     * Unbind the current render target texture from the webGL context\n     * @param rtWrapper defines the render target wrapper to unbind\n     * @param disableGenerateMipMaps defines a boolean indicating that mipmaps must not be generated\n     * @param onBeforeUnbind defines a function which will be called before the effective unbind\n     */\n    NullEngine.prototype.unBindFramebuffer = function (rtWrapper, disableGenerateMipMaps, onBeforeUnbind) {\n        if (disableGenerateMipMaps === void 0) { disableGenerateMipMaps = false; }\n        this._currentRenderTarget = null;\n        if (onBeforeUnbind) {\n            onBeforeUnbind();\n        }\n        this._currentFramebuffer = null;\n    };\n    /**\n     * Creates a dynamic vertex buffer\n     * @param vertices the data for the dynamic vertex buffer\n     * @returns the new WebGL dynamic buffer\n     */\n    NullEngine.prototype.createDynamicVertexBuffer = function (vertices) {\n        var buffer = new DataBuffer();\n        buffer.references = 1;\n        buffer.capacity = 1;\n        return buffer;\n    };\n    /**\n     * Update the content of a dynamic texture\n     * @param texture defines the texture to update\n     * @param canvas defines the canvas containing the source\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param premulAlpha defines if alpha is stored as premultiplied\n     * @param format defines the format of the data\n     */\n    NullEngine.prototype.updateDynamicTexture = function (texture, canvas, invertY, premulAlpha, format) {\n        if (premulAlpha === void 0) { premulAlpha = false; }\n    };\n    /**\n     * Gets a boolean indicating if all created effects are ready\n     * @returns true if all effects are ready\n     */\n    NullEngine.prototype.areAllEffectsReady = function () {\n        return true;\n    };\n    /**\n     * @hidden\n     * Get the current error code of the webGL context\n     * @returns the error code\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/getError\n     */\n    NullEngine.prototype.getError = function () {\n        return 0;\n    };\n    /** @hidden */\n    NullEngine.prototype._getUnpackAlignement = function () {\n        return 1;\n    };\n    /**\n     * @param value\n     * @hidden\n     */\n    NullEngine.prototype._unpackFlipY = function (value) { };\n    /**\n     * Update a dynamic index buffer\n     * @param indexBuffer defines the target index buffer\n     * @param indices defines the data to update\n     * @param offset defines the offset in the target index buffer where update should start\n     */\n    NullEngine.prototype.updateDynamicIndexBuffer = function (indexBuffer, indices, offset) {\n        if (offset === void 0) { offset = 0; }\n    };\n    /**\n     * Updates a dynamic vertex buffer.\n     * @param vertexBuffer the vertex buffer to update\n     * @param vertices the data used to update the vertex buffer\n     * @param byteOffset the byte offset of the data (optional)\n     * @param byteLength the byte length of the data (optional)\n     */\n    NullEngine.prototype.updateDynamicVertexBuffer = function (vertexBuffer, vertices, byteOffset, byteLength) { };\n    /**\n     * @param target\n     * @param texture\n     * @hidden\n     */\n    NullEngine.prototype._bindTextureDirectly = function (target, texture) {\n        if (this._boundTexturesCache[this._activeChannel] !== texture) {\n            this._boundTexturesCache[this._activeChannel] = texture;\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param channel\n     * @param texture\n     * @hidden\n     */\n    NullEngine.prototype._bindTexture = function (channel, texture) {\n        if (channel < 0) {\n            return;\n        }\n        this._bindTextureDirectly(0, texture);\n    };\n    NullEngine.prototype._deleteBuffer = function (buffer) { };\n    /**\n     * Force the engine to release all cached effects. This means that next effect compilation will have to be done completely even if a similar effect was already compiled\n     */\n    NullEngine.prototype.releaseEffects = function () { };\n    NullEngine.prototype.displayLoadingUI = function () { };\n    NullEngine.prototype.hideLoadingUI = function () { };\n    Object.defineProperty(NullEngine.prototype, \"loadingUIText\", {\n        set: function (_) { },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @param texture\n     * @param internalFormat\n     * @param width\n     * @param height\n     * @param data\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NullEngine.prototype._uploadCompressedDataToTextureDirectly = function (texture, internalFormat, width, height, data, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NullEngine.prototype._uploadDataToTextureDirectly = function (texture, imageData, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NullEngine.prototype._uploadArrayBufferViewToTexture = function (texture, imageData, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n    };\n    /**\n     * @param texture\n     * @param image\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    NullEngine.prototype._uploadImageToTexture = function (texture, image, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n    };\n    return NullEngine;\n}(Engine));\nexport { NullEngine };\n//# sourceMappingURL=nullEngine.js.map","/** @hidden */\nvar PerformanceConfigurator = /** @class */ (function () {\n    function PerformanceConfigurator() {\n    }\n    /**\n     * @param use64bits\n     * @hidden\n     */\n    PerformanceConfigurator.SetMatrixPrecision = function (use64bits) {\n        PerformanceConfigurator.MatrixTrackPrecisionChange = false;\n        if (use64bits && !PerformanceConfigurator.MatrixUse64Bits) {\n            if (PerformanceConfigurator.MatrixTrackedMatrices) {\n                for (var m = 0; m < PerformanceConfigurator.MatrixTrackedMatrices.length; ++m) {\n                    var matrix = PerformanceConfigurator.MatrixTrackedMatrices[m];\n                    var values = matrix._m;\n                    matrix._m = new Array(16);\n                    for (var i = 0; i < 16; ++i) {\n                        matrix._m[i] = values[i];\n                    }\n                }\n            }\n        }\n        PerformanceConfigurator.MatrixUse64Bits = use64bits;\n        PerformanceConfigurator.MatrixCurrentType = PerformanceConfigurator.MatrixUse64Bits ? Array : Float32Array;\n        PerformanceConfigurator.MatrixTrackedMatrices = null; // reclaim some memory, as we don't need _TrackedMatrices anymore\n    };\n    /** @hidden */\n    PerformanceConfigurator.MatrixUse64Bits = false;\n    /** @hidden */\n    PerformanceConfigurator.MatrixTrackPrecisionChange = true;\n    /** @hidden */\n    PerformanceConfigurator.MatrixCurrentType = Float32Array;\n    /** @hidden */\n    PerformanceConfigurator.MatrixTrackedMatrices = [];\n    return PerformanceConfigurator;\n}());\nexport { PerformanceConfigurator };\n//# sourceMappingURL=performanceConfigurator.js.map","import { InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\n\n/**\n * Wrapper around a render target (either single or multi textures)\n */\nvar RenderTargetWrapper = /** @class */ (function () {\n    /**\n     * Initializes the render target wrapper\n     * @param isMulti true if the wrapper is a multi render target\n     * @param isCube true if the wrapper should render to a cube texture\n     * @param size size of the render target (width/height/layers)\n     * @param engine engine used to create the render target\n     */\n    function RenderTargetWrapper(isMulti, isCube, size, engine) {\n        this._textures = null;\n        /** @hidden */\n        this._attachments = null;\n        /** @hidden */\n        this._generateStencilBuffer = false;\n        /** @hidden */\n        this._generateDepthBuffer = false;\n        /** @hidden */\n        this._depthStencilTextureWithStencil = false;\n        this._isMulti = isMulti;\n        this._isCube = isCube;\n        this._size = size;\n        this._engine = engine;\n        this._depthStencilTexture = null;\n    }\n    Object.defineProperty(RenderTargetWrapper.prototype, \"depthStencilTexture\", {\n        /**\n         * Gets the depth/stencil texture (if created by a createDepthStencilTexture() call)\n         */\n        get: function () {\n            return this._depthStencilTexture;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"depthStencilTextureWithStencil\", {\n        /**\n         * Indicates if the depth/stencil texture has a stencil aspect\n         */\n        get: function () {\n            return this._depthStencilTextureWithStencil;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"isCube\", {\n        /**\n         * Defines if the render target wrapper is for a cube texture or if false a 2d texture\n         */\n        get: function () {\n            return this._isCube;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"isMulti\", {\n        /**\n         * Defines if the render target wrapper is for a single or multi target render wrapper\n         */\n        get: function () {\n            return this._isMulti;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"is2DArray\", {\n        /**\n         * Defines if the render target wrapper is for a single or an array of textures\n         */\n        get: function () {\n            return this.layers > 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"size\", {\n        /**\n         * Gets the size of the render target wrapper (used for cubes, as width=height in this case)\n         */\n        get: function () {\n            return this.width;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"width\", {\n        /**\n         * Gets the width of the render target wrapper\n         */\n        get: function () {\n            return this._size.width || this._size;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"height\", {\n        /**\n         * Gets the height of the render target wrapper\n         */\n        get: function () {\n            return this._size.height || this._size;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"layers\", {\n        /**\n         * Gets the number of layers of the render target wrapper (only used if is2DArray is true)\n         */\n        get: function () {\n            return this._size.layers || 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"texture\", {\n        /**\n         * Gets the render texture. If this is a multi render target, gets the first texture\n         */\n        get: function () {\n            var _a, _b;\n            return (_b = (_a = this._textures) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"textures\", {\n        /**\n         * Gets the list of render textures. If we are not in a multi render target, the list will be null (use the texture getter instead)\n         */\n        get: function () {\n            return this._textures;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderTargetWrapper.prototype, \"samples\", {\n        /**\n         * Gets the sample count of the render target\n         */\n        get: function () {\n            var _a, _b;\n            return (_b = (_a = this.texture) === null || _a === void 0 ? void 0 : _a.samples) !== null && _b !== void 0 ? _b : 1;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Sets the sample count of the render target\n     * @param value sample count\n     * @param initializeBuffers If set to true, the engine will make an initializing call to drawBuffers (only used when isMulti=true).\n     * @param force true to force calling the update sample count engine function even if the current sample count is equal to value\n     * @returns the sample count that has been set\n     */\n    RenderTargetWrapper.prototype.setSamples = function (value, initializeBuffers, force) {\n        if (initializeBuffers === void 0) { initializeBuffers = true; }\n        if (force === void 0) { force = false; }\n        if (this.samples === value && !force) {\n            return value;\n        }\n        return this._isMulti\n            ? this._engine.updateMultipleRenderTargetTextureSampleCount(this, value, initializeBuffers)\n            : this._engine.updateRenderTargetTextureSampleCount(this, value);\n    };\n    /**\n     * Sets the render target texture(s)\n     * @param textures texture(s) to set\n     */\n    RenderTargetWrapper.prototype.setTextures = function (textures) {\n        if (Array.isArray(textures)) {\n            this._textures = textures;\n        }\n        else if (textures) {\n            this._textures = [textures];\n        }\n        else {\n            this._textures = null;\n        }\n    };\n    /**\n     * Set a texture in the textures array\n     * @param texture the texture to set\n     * @param index the index in the textures array to set\n     * @param disposePrevious If this function should dispose the previous texture\n     */\n    RenderTargetWrapper.prototype.setTexture = function (texture, index, disposePrevious) {\n        if (index === void 0) { index = 0; }\n        if (disposePrevious === void 0) { disposePrevious = true; }\n        if (!this._textures) {\n            this._textures = [];\n        }\n        if (this._textures[index] && disposePrevious) {\n            this._textures[index].dispose();\n        }\n        this._textures[index] = texture;\n    };\n    /**\n     * Creates the depth/stencil texture\n     * @param comparisonFunction Comparison function to use for the texture\n     * @param bilinearFiltering true if bilinear filtering should be used when sampling the texture\n     * @param generateStencil true if the stencil aspect should also be created\n     * @param samples sample count to use when creating the texture\n     * @param format format of the depth texture\n     * @returns the depth/stencil created texture\n     */\n    RenderTargetWrapper.prototype.createDepthStencilTexture = function (comparisonFunction, bilinearFiltering, generateStencil, samples, format) {\n        var _a;\n        if (comparisonFunction === void 0) { comparisonFunction = 0; }\n        if (bilinearFiltering === void 0) { bilinearFiltering = true; }\n        if (generateStencil === void 0) { generateStencil = false; }\n        if (samples === void 0) { samples = 1; }\n        if (format === void 0) { format = 14; }\n        (_a = this._depthStencilTexture) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._depthStencilTextureWithStencil = generateStencil;\n        this._depthStencilTexture = this._engine.createDepthStencilTexture(this._size, {\n            bilinearFiltering: bilinearFiltering,\n            comparisonFunction: comparisonFunction,\n            generateStencil: generateStencil,\n            isCube: this._isCube,\n            samples: samples,\n            depthTextureFormat: format,\n        }, this);\n        return this._depthStencilTexture;\n    };\n    /**\n     * Shares the depth buffer of this render target with another render target.\n     * @hidden\n     * @param renderTarget Destination renderTarget\n     */\n    RenderTargetWrapper.prototype._shareDepth = function (renderTarget) {\n        if (this._depthStencilTexture) {\n            if (renderTarget._depthStencilTexture) {\n                renderTarget._depthStencilTexture.dispose();\n            }\n            renderTarget._depthStencilTexture = this._depthStencilTexture;\n            this._depthStencilTexture.incrementReferences();\n        }\n    };\n    /**\n     * @param target\n     * @hidden\n     */\n    RenderTargetWrapper.prototype._swapAndDie = function (target) {\n        if (this.texture) {\n            this.texture._swapAndDie(target);\n        }\n        this._textures = null;\n        this.dispose(true);\n    };\n    RenderTargetWrapper.prototype._cloneRenderTargetWrapper = function () {\n        var _a, _b, _c, _d, _e, _f;\n        var rtw = null;\n        if (this._isMulti) {\n            var textureArray = this.textures;\n            if (textureArray && textureArray.length > 0) {\n                var generateDepthTexture = false;\n                var textureCount = textureArray.length;\n                var lastTextureSource = textureArray[textureArray.length - 1]._source;\n                if (lastTextureSource === InternalTextureSource.Depth || lastTextureSource === InternalTextureSource.DepthStencil) {\n                    generateDepthTexture = true;\n                    textureCount--;\n                }\n                var samplingModes = [];\n                var types = [];\n                for (var i = 0; i < textureCount; ++i) {\n                    var texture = textureArray[i];\n                    samplingModes.push(texture.samplingMode);\n                    types.push(texture.type);\n                }\n                var optionsMRT = {\n                    samplingModes: samplingModes,\n                    generateMipMaps: textureArray[0].generateMipMaps,\n                    generateDepthBuffer: this._generateDepthBuffer,\n                    generateStencilBuffer: this._generateStencilBuffer,\n                    generateDepthTexture: generateDepthTexture,\n                    types: types,\n                    textureCount: textureCount,\n                };\n                var size = {\n                    width: this.width,\n                    height: this.height,\n                };\n                rtw = this._engine.createMultipleRenderTarget(size, optionsMRT);\n            }\n        }\n        else {\n            var options = {};\n            options.generateDepthBuffer = this._generateDepthBuffer;\n            options.generateMipMaps = (_b = (_a = this.texture) === null || _a === void 0 ? void 0 : _a.generateMipMaps) !== null && _b !== void 0 ? _b : false;\n            options.generateStencilBuffer = this._generateStencilBuffer;\n            options.samplingMode = (_c = this.texture) === null || _c === void 0 ? void 0 : _c.samplingMode;\n            options.type = (_d = this.texture) === null || _d === void 0 ? void 0 : _d.type;\n            options.format = (_e = this.texture) === null || _e === void 0 ? void 0 : _e.format;\n            if (this.isCube) {\n                rtw = this._engine.createRenderTargetCubeTexture(this.width, options);\n            }\n            else {\n                var size = {\n                    width: this.width,\n                    height: this.height,\n                    layers: this.is2DArray ? (_f = this.texture) === null || _f === void 0 ? void 0 : _f.depth : undefined,\n                };\n                rtw = this._engine.createRenderTargetTexture(size, options);\n            }\n            rtw.texture.isReady = true;\n        }\n        return rtw;\n    };\n    RenderTargetWrapper.prototype._swapRenderTargetWrapper = function (target) {\n        if (this._textures && target._textures) {\n            for (var i = 0; i < this._textures.length; ++i) {\n                this._textures[i]._swapAndDie(target._textures[i], false);\n                target._textures[i].isReady = true;\n            }\n        }\n        if (this._depthStencilTexture && target._depthStencilTexture) {\n            this._depthStencilTexture._swapAndDie(target._depthStencilTexture);\n            target._depthStencilTexture.isReady = true;\n        }\n        this._textures = null;\n        this._depthStencilTexture = null;\n    };\n    /** @hidden */\n    RenderTargetWrapper.prototype._rebuild = function () {\n        var rtw = this._cloneRenderTargetWrapper();\n        if (!rtw) {\n            return;\n        }\n        if (this._depthStencilTexture) {\n            var samplingMode = this._depthStencilTexture.samplingMode;\n            var bilinear = samplingMode === 2 ||\n                samplingMode === 3 ||\n                samplingMode === 11;\n            rtw.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction, bilinear, this._depthStencilTextureWithStencil, this._depthStencilTexture.samples);\n        }\n        if (this.samples > 1) {\n            rtw.setSamples(this.samples);\n        }\n        rtw._swapRenderTargetWrapper(this);\n        rtw.dispose();\n    };\n    /**\n     * Releases the internal render textures\n     */\n    RenderTargetWrapper.prototype.releaseTextures = function () {\n        var _a, _b;\n        if (this._textures) {\n            for (var i = 0; (_b = i < ((_a = this._textures) === null || _a === void 0 ? void 0 : _a.length)) !== null && _b !== void 0 ? _b : 0; ++i) {\n                this._textures[i].dispose();\n            }\n        }\n        this._textures = null;\n    };\n    /**\n     * Disposes the whole render target wrapper\n     * @param disposeOnlyFramebuffers true if only the frame buffers should be released (used for the WebGL engine). If false, all the textures will also be released\n     */\n    RenderTargetWrapper.prototype.dispose = function (disposeOnlyFramebuffers) {\n        var _a;\n        if (disposeOnlyFramebuffers === void 0) { disposeOnlyFramebuffers = false; }\n        if (!disposeOnlyFramebuffers) {\n            (_a = this._depthStencilTexture) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._depthStencilTexture = null;\n            this.releaseTextures();\n        }\n        this._engine._releaseRenderTargetWrapper(this);\n    };\n    return RenderTargetWrapper;\n}());\nexport { RenderTargetWrapper };\n//# sourceMappingURL=renderTargetWrapper.js.map","import { ShaderLanguage } from \"../Materials/shaderLanguage.js\";\n/**\n * Defines the shader related stores and directory\n */\nvar ShaderStore = /** @class */ (function () {\n    function ShaderStore() {\n    }\n    /**\n     * Gets the shaders repository path for a given shader language\n     * @param shaderLanguage the shader language\n     * @returns the path to the shaders repository\n     */\n    ShaderStore.GetShadersRepository = function (shaderLanguage) {\n        if (shaderLanguage === void 0) { shaderLanguage = ShaderLanguage.GLSL; }\n        return shaderLanguage === ShaderLanguage.GLSL ? ShaderStore.ShadersRepository : ShaderStore.ShadersRepositoryWGSL;\n    };\n    /**\n     * Gets the shaders store of a given shader language\n     * @param shaderLanguage the shader language\n     * @returns the shaders store\n     */\n    ShaderStore.GetShadersStore = function (shaderLanguage) {\n        if (shaderLanguage === void 0) { shaderLanguage = ShaderLanguage.GLSL; }\n        return shaderLanguage === ShaderLanguage.GLSL ? ShaderStore.ShadersStore : ShaderStore.ShadersStoreWGSL;\n    };\n    /**\n     * Gets the include shaders store of a given shader language\n     * @param shaderLanguage the shader language\n     * @returns the include shaders store\n     */\n    ShaderStore.GetIncludesShadersStore = function (shaderLanguage) {\n        if (shaderLanguage === void 0) { shaderLanguage = ShaderLanguage.GLSL; }\n        return shaderLanguage === ShaderLanguage.GLSL ? ShaderStore.IncludesShadersStore : ShaderStore.IncludesShadersStoreWGSL;\n    };\n    /**\n     * Gets or sets the relative url used to load shaders if using the engine in non-minified mode\n     */\n    ShaderStore.ShadersRepository = \"src/Shaders/\";\n    /**\n     * Store of each shader (The can be looked up using effect.key)\n     */\n    ShaderStore.ShadersStore = {};\n    /**\n     * Store of each included file for a shader (The can be looked up using effect.key)\n     */\n    ShaderStore.IncludesShadersStore = {};\n    /**\n     * Gets or sets the relative url used to load shaders (WGSL) if using the engine in non-minified mode\n     */\n    ShaderStore.ShadersRepositoryWGSL = \"src/ShadersWGSL/\";\n    /**\n     * Store of each shader  (WGSL)\n     */\n    ShaderStore.ShadersStoreWGSL = {};\n    /**\n     * Store of each included file for a shader (WGSL)\n     */\n    ShaderStore.IncludesShadersStoreWGSL = {};\n    return ShaderStore;\n}());\nexport { ShaderStore };\n//# sourceMappingURL=shaderStore.js.map","import { __awaiter, __generator } from \"tslib\";\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { EngineStore } from \"./engineStore.js\";\nimport { Effect } from \"../Materials/effect.js\";\nimport { _WarnImport } from \"../Misc/devTools.js\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { DepthCullingState } from \"../States/depthCullingState.js\";\nimport { StencilState } from \"../States/stencilState.js\";\nimport { AlphaState } from \"../States/alphaCullingState.js\";\n\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { IsDocumentAvailable, IsWindowObjectExist } from \"../Misc/domManagement.js\";\nimport { WebGLShaderProcessor } from \"./WebGL/webGLShaderProcessors.js\";\nimport { WebGL2ShaderProcessor } from \"./WebGL/webGL2ShaderProcessors.js\";\nimport { WebGLDataBuffer } from \"../Meshes/WebGL/webGLDataBuffer.js\";\nimport { WebGLPipelineContext } from \"./WebGL/webGLPipelineContext.js\";\nimport { PerformanceConfigurator } from \"./performanceConfigurator.js\";\nimport { WebGLHardwareTexture } from \"./WebGL/webGLHardwareTexture.js\";\nimport { DrawWrapper } from \"../Materials/drawWrapper.js\";\nimport { StencilStateComposer } from \"../States/stencilStateComposer.js\";\nimport { ShaderLanguage } from \"../Materials/shaderLanguage.js\";\n/**\n * Keeps track of all the buffer info used in engine.\n */\nvar BufferPointer = /** @class */ (function () {\n    function BufferPointer() {\n    }\n    return BufferPointer;\n}());\n/**\n * The base engine class (root of all engines)\n */\nvar ThinEngine = /** @class */ (function () {\n    /**\n     * Creates a new engine\n     * @param canvasOrContext defines the canvas or WebGL context to use for rendering. If you provide a WebGL context, Babylon.js will not hook events on the canvas (like pointers, keyboards, etc...) so no event observables will be available. This is mostly used when Babylon.js is used as a plugin on a system which already used the WebGL context\n     * @param antialias defines enable antialiasing (default: false)\n     * @param options defines further options to be sent to the getContext() function\n     * @param adaptToDeviceRatio defines whether to adapt to the device's viewport characteristics (default: false)\n     */\n    function ThinEngine(canvasOrContext, antialias, options, adaptToDeviceRatio) {\n        var _this = this;\n        /** @hidden */\n        this._name = \"WebGL\";\n        /**\n         * Gets or sets a boolean that indicates if textures must be forced to power of 2 size even if not required\n         */\n        this.forcePOTTextures = false;\n        /**\n         * Gets a boolean indicating if the engine is currently rendering in fullscreen mode\n         */\n        this.isFullscreen = false;\n        /**\n         * Gets or sets a boolean indicating if back faces must be culled. If false, front faces are culled instead (true by default)\n         * If non null, this takes precedence over the value from the material\n         */\n        this.cullBackFaces = null;\n        /**\n         * Gets or sets a boolean indicating if the engine must keep rendering even if the window is not in foreground\n         */\n        this.renderEvenInBackground = true;\n        /**\n         * Gets or sets a boolean indicating that cache can be kept between frames\n         */\n        this.preventCacheWipeBetweenFrames = false;\n        /** Gets or sets a boolean indicating if the engine should validate programs after compilation */\n        this.validateShaderPrograms = false;\n        this._useReverseDepthBuffer = false;\n        /**\n         * Indicates if the z range in NDC space is 0..1 (value: true) or -1..1 (value: false)\n         */\n        this.isNDCHalfZRange = false;\n        /**\n         * Indicates that the origin of the texture/framebuffer space is the bottom left corner. If false, the origin is top left\n         */\n        this.hasOriginBottomLeft = true;\n        /**\n         * Gets or sets a boolean indicating that uniform buffers must be disabled even if they are supported\n         */\n        this.disableUniformBuffers = false;\n        /**\n         * An event triggered when the engine is disposed.\n         */\n        this.onDisposeObservable = new Observable();\n        this._frameId = 0;\n        /** @hidden */\n        this._uniformBuffers = new Array();\n        /** @hidden */\n        this._storageBuffers = new Array();\n        /** @hidden */\n        this._webGLVersion = 1.0;\n        this._windowIsBackground = false;\n        this._highPrecisionShadersAllowed = true;\n        /** @hidden */\n        this._badOS = false;\n        /** @hidden */\n        this._badDesktopOS = false;\n        this._renderingQueueLaunched = false;\n        this._activeRenderLoops = new Array();\n        // Lost context\n        /**\n         * Observable signaled when a context lost event is raised\n         */\n        this.onContextLostObservable = new Observable();\n        /**\n         * Observable signaled when a context restored event is raised\n         */\n        this.onContextRestoredObservable = new Observable();\n        this._contextWasLost = false;\n        /** @hidden */\n        this._doNotHandleContextLost = false;\n        /**\n         * Gets or sets a boolean indicating that vertex array object must be disabled even if they are supported\n         */\n        this.disableVertexArrayObjects = false;\n        // States\n        /** @hidden */\n        this._colorWrite = true;\n        /** @hidden */\n        this._colorWriteChanged = true;\n        /** @hidden */\n        this._depthCullingState = new DepthCullingState();\n        /** @hidden */\n        this._stencilStateComposer = new StencilStateComposer();\n        /** @hidden */\n        this._stencilState = new StencilState();\n        /** @hidden */\n        this._alphaState = new AlphaState();\n        /** @hidden */\n        this._alphaMode = 1;\n        /** @hidden */\n        this._alphaEquation = 0;\n        // Cache\n        /** @hidden */\n        this._internalTexturesCache = new Array();\n        /** @hidden */\n        this._renderTargetWrapperCache = new Array();\n        /** @hidden */\n        this._activeChannel = 0;\n        this._currentTextureChannel = -1;\n        /** @hidden */\n        this._boundTexturesCache = {};\n        this._compiledEffects = {};\n        this._vertexAttribArraysEnabled = [];\n        this._uintIndicesCurrentlySet = false;\n        this._currentBoundBuffer = new Array();\n        /** @hidden */\n        this._currentFramebuffer = null;\n        /** @hidden */\n        this._dummyFramebuffer = null;\n        this._currentBufferPointers = new Array();\n        this._currentInstanceLocations = new Array();\n        this._currentInstanceBuffers = new Array();\n        this._vaoRecordInProgress = false;\n        this._mustWipeVertexAttributes = false;\n        this._nextFreeTextureSlots = new Array();\n        this._maxSimultaneousTextures = 0;\n        this._maxMSAASamplesOverride = null;\n        this._activeRequests = new Array();\n        /** @hidden */\n        this._adaptToDeviceRatio = false;\n        /** @hidden */\n        this._transformTextureUrl = null;\n        /**\n         * Gets information about the current host\n         */\n        this.hostInformation = {\n            isMobile: false,\n        };\n        /**\n         * Defines whether the engine has been created with the premultipliedAlpha option on or not.\n         */\n        this.premultipliedAlpha = true;\n        /**\n         * Observable event triggered before each texture is initialized\n         */\n        this.onBeforeTextureInitObservable = new Observable();\n        /** @hidden */\n        this._isWebGPU = false;\n        this._snapshotRenderingMode = 0;\n        this._viewportCached = { x: 0, y: 0, z: 0, w: 0 };\n        this._unpackFlipYCached = null;\n        /**\n         * In case you are sharing the context with other applications, it might\n         * be interested to not cache the unpack flip y state to ensure a consistent\n         * value would be set.\n         */\n        this.enableUnpackFlipYCached = true;\n        this._boundUniforms = {};\n        var canvas = null;\n        options = options || {};\n        this._creationOptions = options;\n        // Save this off for use in resize().\n        this._adaptToDeviceRatio = adaptToDeviceRatio !== null && adaptToDeviceRatio !== void 0 ? adaptToDeviceRatio : false;\n        this._stencilStateComposer.stencilGlobal = this._stencilState;\n        PerformanceConfigurator.SetMatrixPrecision(!!options.useHighPrecisionMatrix);\n        if (!canvasOrContext) {\n            return;\n        }\n        adaptToDeviceRatio = adaptToDeviceRatio || options.adaptToDeviceRatio || false;\n        if (canvasOrContext.getContext) {\n            canvas = canvasOrContext;\n            this._renderingCanvas = canvas;\n            if (antialias !== undefined) {\n                options.antialias = antialias;\n            }\n            if (options.deterministicLockstep === undefined) {\n                options.deterministicLockstep = false;\n            }\n            if (options.lockstepMaxSteps === undefined) {\n                options.lockstepMaxSteps = 4;\n            }\n            if (options.timeStep === undefined) {\n                options.timeStep = 1 / 60;\n            }\n            if (options.preserveDrawingBuffer === undefined) {\n                options.preserveDrawingBuffer = false;\n            }\n            if (options.audioEngine === undefined) {\n                options.audioEngine = true;\n            }\n            if (options.audioEngineOptions !== undefined && options.audioEngineOptions.audioContext !== undefined) {\n                this._audioContext = options.audioEngineOptions.audioContext;\n            }\n            if (options.audioEngineOptions !== undefined && options.audioEngineOptions.audioDestination !== undefined) {\n                this._audioDestination = options.audioEngineOptions.audioDestination;\n            }\n            if (options.stencil === undefined) {\n                options.stencil = true;\n            }\n            if (options.premultipliedAlpha === false) {\n                this.premultipliedAlpha = false;\n            }\n            if (options.xrCompatible === undefined) {\n                options.xrCompatible = true;\n            }\n            this._doNotHandleContextLost = options.doNotHandleContextLost ? true : false;\n            // Exceptions\n            if (navigator && navigator.userAgent) {\n                // Function to check if running on mobile device\n                this._checkForMobile = function () {\n                    var currentUA = navigator.userAgent;\n                    _this.hostInformation.isMobile =\n                        currentUA.indexOf(\"Mobile\") !== -1 ||\n                            // Needed for iOS 13+ detection on iPad (inspired by solution from https://stackoverflow.com/questions/9038625/detect-if-device-is-ios)\n                            (currentUA.indexOf(\"Mac\") !== -1 && IsDocumentAvailable() && \"ontouchend\" in document);\n                };\n                // Set initial isMobile value\n                this._checkForMobile();\n                // Set up event listener to check when window is resized (used to get emulator activation to work properly)\n                if (IsWindowObjectExist()) {\n                    window.addEventListener(\"resize\", this._checkForMobile);\n                }\n                var ua = navigator.userAgent;\n                for (var _i = 0, _a = ThinEngine.ExceptionList; _i < _a.length; _i++) {\n                    var exception = _a[_i];\n                    var key = exception.key;\n                    var targets = exception.targets;\n                    var check = new RegExp(key);\n                    if (check.test(ua)) {\n                        if (exception.capture && exception.captureConstraint) {\n                            var capture = exception.capture;\n                            var constraint = exception.captureConstraint;\n                            var regex = new RegExp(capture);\n                            var matches = regex.exec(ua);\n                            if (matches && matches.length > 0) {\n                                var capturedValue = parseInt(matches[matches.length - 1]);\n                                if (capturedValue >= constraint) {\n                                    continue;\n                                }\n                            }\n                        }\n                        for (var _b = 0, targets_1 = targets; _b < targets_1.length; _b++) {\n                            var target = targets_1[_b];\n                            switch (target) {\n                                case \"uniformBuffer\":\n                                    this.disableUniformBuffers = true;\n                                    break;\n                                case \"vao\":\n                                    this.disableVertexArrayObjects = true;\n                                    break;\n                                case \"antialias\":\n                                    options.antialias = false;\n                                    break;\n                                case \"maxMSAASamples\":\n                                    this._maxMSAASamplesOverride = 1;\n                                    break;\n                            }\n                        }\n                    }\n                }\n            }\n            // Context lost\n            if (!this._doNotHandleContextLost) {\n                this._onContextLost = function (evt) {\n                    evt.preventDefault();\n                    _this._contextWasLost = true;\n                    Logger.Warn(\"WebGL context lost.\");\n                    _this.onContextLostObservable.notifyObservers(_this);\n                };\n                this._onContextRestored = function () {\n                    _this._restoreEngineAfterContextLost(_this._initGLContext.bind(_this));\n                };\n                canvas.addEventListener(\"webglcontextlost\", this._onContextLost, false);\n                canvas.addEventListener(\"webglcontextrestored\", this._onContextRestored, false);\n                options.powerPreference = \"high-performance\";\n            }\n            // Detect if we are running on a faulty buggy desktop OS.\n            this._badDesktopOS = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n            if (this._badDesktopOS) {\n                options.xrCompatible = false;\n            }\n            // GL\n            if (!options.disableWebGL2Support) {\n                try {\n                    this._gl = (canvas.getContext(\"webgl2\", options) || canvas.getContext(\"experimental-webgl2\", options));\n                    if (this._gl) {\n                        this._webGLVersion = 2.0;\n                        this._shaderPlatformName = \"WEBGL2\";\n                        // Prevent weird browsers to lie (yeah that happens!)\n                        if (!this._gl.deleteQuery) {\n                            this._webGLVersion = 1.0;\n                            this._shaderPlatformName = \"WEBGL1\";\n                        }\n                    }\n                }\n                catch (e) {\n                    // Do nothing\n                }\n            }\n            if (!this._gl) {\n                if (!canvas) {\n                    throw new Error(\"The provided canvas is null or undefined.\");\n                }\n                try {\n                    this._gl = (canvas.getContext(\"webgl\", options) || canvas.getContext(\"experimental-webgl\", options));\n                }\n                catch (e) {\n                    throw new Error(\"WebGL not supported\");\n                }\n            }\n            if (!this._gl) {\n                throw new Error(\"WebGL not supported\");\n            }\n        }\n        else {\n            this._gl = canvasOrContext;\n            this._renderingCanvas = this._gl.canvas;\n            if (this._gl.renderbufferStorageMultisample) {\n                this._webGLVersion = 2.0;\n                this._shaderPlatformName = \"WEBGL2\";\n            }\n            else {\n                this._shaderPlatformName = \"WEBGL1\";\n            }\n            var attributes = this._gl.getContextAttributes();\n            if (attributes) {\n                options.stencil = attributes.stencil;\n            }\n        }\n        // Ensures a consistent color space unpacking of textures cross browser.\n        this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n        if (options.useHighPrecisionFloats !== undefined) {\n            this._highPrecisionShadersAllowed = options.useHighPrecisionFloats;\n        }\n        // Viewport\n        var devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n        var limitDeviceRatio = options.limitDeviceRatio || devicePixelRatio;\n        this._hardwareScalingLevel = adaptToDeviceRatio ? 1.0 / Math.min(limitDeviceRatio, devicePixelRatio) : 1.0;\n        this.resize();\n        this._isStencilEnable = options.stencil ? true : false;\n        this._initGLContext();\n        this._initFeatures();\n        // Prepare buffer pointers\n        for (var i = 0; i < this._caps.maxVertexAttribs; i++) {\n            this._currentBufferPointers[i] = new BufferPointer();\n        }\n        // Shader processor\n        this._shaderProcessor = this.webGLVersion > 1 ? new WebGL2ShaderProcessor() : new WebGLShaderProcessor();\n        // Detect if we are running on a faulty buggy OS.\n        this._badOS = /iPad/i.test(navigator.userAgent) || /iPhone/i.test(navigator.userAgent);\n        // Starting with iOS 14, we can trust the browser\n        // let matches = navigator.userAgent.match(/Version\\/(\\d+)/);\n        // if (matches && matches.length === 2) {\n        //     if (parseInt(matches[1]) >= 14) {\n        //         this._badOS = false;\n        //     }\n        // }\n        var versionToLog = \"Babylon.js v\".concat(ThinEngine.Version);\n        console.log(versionToLog + \" - \".concat(this.description));\n        // Check setAttribute in case of workers\n        if (this._renderingCanvas && this._renderingCanvas.setAttribute) {\n            this._renderingCanvas.setAttribute(\"data-engine\", versionToLog);\n        }\n    }\n    Object.defineProperty(ThinEngine, \"NpmPackage\", {\n        /**\n         * Returns the current npm package of the sdk\n         */\n        // Not mixed with Version for tooling purpose.\n        get: function () {\n            return \"babylonjs@5.11.0\";\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine, \"Version\", {\n        /**\n         * Returns the current version of the framework\n         */\n        get: function () {\n            return \"5.11.0\";\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"description\", {\n        /**\n         * Returns a string describing the current engine\n         */\n        get: function () {\n            var description = this.name + this.webGLVersion;\n            if (this._caps.parallelShaderCompile) {\n                description += \" - Parallel shader compilation\";\n            }\n            return description;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"name\", {\n        /**\n         * Gets or sets the name of the engine\n         */\n        get: function () {\n            return this._name;\n        },\n        set: function (value) {\n            this._name = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"version\", {\n        /**\n         * Returns the version of the engine\n         */\n        get: function () {\n            return this._webGLVersion;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine, \"ShadersRepository\", {\n        /**\n         * Gets or sets the relative url used to load shaders if using the engine in non-minified mode\n         */\n        get: function () {\n            return Effect.ShadersRepository;\n        },\n        set: function (value) {\n            Effect.ShadersRepository = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @param shaderLanguage\n     * @hidden\n     */\n    ThinEngine.prototype._getShaderProcessor = function (shaderLanguage) {\n        return this._shaderProcessor;\n    };\n    Object.defineProperty(ThinEngine.prototype, \"useReverseDepthBuffer\", {\n        /**\n         * Gets or sets a boolean indicating if depth buffer should be reverse, going from far to near.\n         * This can provide greater z depth for distant objects.\n         */\n        get: function () {\n            return this._useReverseDepthBuffer;\n        },\n        set: function (useReverse) {\n            if (useReverse === this._useReverseDepthBuffer) {\n                return;\n            }\n            this._useReverseDepthBuffer = useReverse;\n            if (useReverse) {\n                this._depthCullingState.depthFunc = 518;\n            }\n            else {\n                this._depthCullingState.depthFunc = 515;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"frameId\", {\n        /**\n         * Gets the current frame id\n         */\n        get: function () {\n            return this._frameId;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"supportsUniformBuffers\", {\n        /**\n         * Gets a boolean indicating that the engine supports uniform buffers\n         * @see https://doc.babylonjs.com/features/webgl2#uniform-buffer-objets\n         */\n        get: function () {\n            return this.webGLVersion > 1 && !this.disableUniformBuffers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets the options used for engine creation\n     * @returns EngineOptions object\n     */\n    ThinEngine.prototype.getCreationOptions = function () {\n        return this._creationOptions;\n    };\n    Object.defineProperty(ThinEngine.prototype, \"_shouldUseHighPrecisionShader\", {\n        /** @hidden */\n        get: function () {\n            return !!(this._caps.highPrecisionShaderSupported && this._highPrecisionShadersAllowed);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"needPOTTextures\", {\n        /**\n         * Gets a boolean indicating that only power of 2 textures are supported\n         * Please note that you can still use non power of 2 textures but in this case the engine will forcefully convert them\n         */\n        get: function () {\n            return this._webGLVersion < 2 || this.forcePOTTextures;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"activeRenderLoops\", {\n        /**\n         * Gets the list of current active render loop functions\n         * @returns an array with the current render loop functions\n         */\n        get: function () {\n            return this._activeRenderLoops;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"doNotHandleContextLost\", {\n        /**\n         * Gets or sets a boolean indicating if resources should be retained to be able to handle context lost events\n         * @see https://doc.babylonjs.com/how_to/optimizing_your_scene#handling-webgl-context-lost\n         */\n        get: function () {\n            return this._doNotHandleContextLost;\n        },\n        set: function (value) {\n            this._doNotHandleContextLost = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"_supportsHardwareTextureRescaling\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"framebufferDimensionsObject\", {\n        /**\n         * sets the object from which width and height will be taken from when getting render width and height\n         * Will fallback to the gl object\n         * @param dimensions the framebuffer width and height that will be used.\n         */\n        set: function (dimensions) {\n            this._framebufferDimensionsObject = dimensions;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"currentViewport\", {\n        /**\n         * Gets the current viewport\n         */\n        get: function () {\n            return this._cachedViewport;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"emptyTexture\", {\n        /**\n         * Gets the default empty texture\n         */\n        get: function () {\n            if (!this._emptyTexture) {\n                this._emptyTexture = this.createRawTexture(new Uint8Array(4), 1, 1, 5, false, false, 1);\n            }\n            return this._emptyTexture;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"emptyTexture3D\", {\n        /**\n         * Gets the default empty 3D texture\n         */\n        get: function () {\n            if (!this._emptyTexture3D) {\n                this._emptyTexture3D = this.createRawTexture3D(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n            }\n            return this._emptyTexture3D;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"emptyTexture2DArray\", {\n        /**\n         * Gets the default empty 2D array texture\n         */\n        get: function () {\n            if (!this._emptyTexture2DArray) {\n                this._emptyTexture2DArray = this.createRawTexture2DArray(new Uint8Array(4), 1, 1, 1, 5, false, false, 1);\n            }\n            return this._emptyTexture2DArray;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"emptyCubeTexture\", {\n        /**\n         * Gets the default empty cube texture\n         */\n        get: function () {\n            if (!this._emptyCubeTexture) {\n                var faceData = new Uint8Array(4);\n                var cubeData = [faceData, faceData, faceData, faceData, faceData, faceData];\n                this._emptyCubeTexture = this.createRawCubeTexture(cubeData, 1, 5, 0, false, false, 1);\n            }\n            return this._emptyCubeTexture;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"isWebGPU\", {\n        /**\n         * Gets a boolean indicating if the engine runs in WebGPU or not.\n         */\n        get: function () {\n            return this._isWebGPU;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"shaderPlatformName\", {\n        /**\n         * Gets the shader platform name used by the effects.\n         */\n        get: function () {\n            return this._shaderPlatformName;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"snapshotRendering\", {\n        /**\n         * Enables or disables the snapshot rendering mode\n         * Note that the WebGL engine does not support snapshot rendering so setting the value won't have any effect for this engine\n         */\n        get: function () {\n            return false;\n        },\n        set: function (activate) {\n            // WebGL engine does not support snapshot rendering\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"snapshotRenderingMode\", {\n        /**\n         * Gets or sets the snapshot rendering mode\n         */\n        get: function () {\n            return this._snapshotRenderingMode;\n        },\n        set: function (mode) {\n            this._snapshotRenderingMode = mode;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Creates a new snapshot at the next frame using the current snapshotRenderingMode\n     */\n    ThinEngine.prototype.snapshotRenderingReset = function () {\n        this.snapshotRendering = false;\n    };\n    ThinEngine._CreateCanvas = function (width, height) {\n        if (typeof document === \"undefined\") {\n            return new OffscreenCanvas(width, height);\n        }\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = width;\n        canvas.height = height;\n        return canvas;\n    };\n    /**\n     * Create a canvas. This method is overridden by other engines\n     * @param width width\n     * @param height height\n     * @return ICanvas interface\n     */\n    ThinEngine.prototype.createCanvas = function (width, height) {\n        return ThinEngine._CreateCanvas(width, height);\n    };\n    /**\n     * Create an image to use with canvas\n     * @return IImage interface\n     */\n    ThinEngine.prototype.createCanvasImage = function () {\n        return document.createElement(\"img\");\n    };\n    ThinEngine.prototype._restoreEngineAfterContextLost = function (initEngine) {\n        var _this = this;\n        // Adding a timeout to avoid race condition at browser level\n        setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n            var depthTest, depthFunc, depthMask, stencilTest;\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this._dummyFramebuffer = null;\n                        depthTest = this._depthCullingState.depthTest;\n                        depthFunc = this._depthCullingState.depthFunc;\n                        depthMask = this._depthCullingState.depthMask;\n                        stencilTest = this._stencilState.stencilTest;\n                        // Rebuild context\n                        return [4 /*yield*/, initEngine()];\n                    case 1:\n                        // Rebuild context\n                        _b.sent();\n                        // Rebuild effects\n                        this._rebuildEffects();\n                        (_a = this._rebuildComputeEffects) === null || _a === void 0 ? void 0 : _a.call(this);\n                        // Rebuild textures\n                        this._rebuildInternalTextures();\n                        // Rebuild textures\n                        this._rebuildRenderTargetWrappers();\n                        // Rebuild buffers\n                        this._rebuildBuffers();\n                        // Cache\n                        this.wipeCaches(true);\n                        this._depthCullingState.depthTest = depthTest;\n                        this._depthCullingState.depthFunc = depthFunc;\n                        this._depthCullingState.depthMask = depthMask;\n                        this._stencilState.stencilTest = stencilTest;\n                        Logger.Warn(this.name + \" context successfully restored.\");\n                        this.onContextRestoredObservable.notifyObservers(this);\n                        this._contextWasLost = false;\n                        return [2 /*return*/];\n                }\n            });\n        }); }, 0);\n    };\n    /**\n     * Shared initialization across engines types.\n     * @param canvas The canvas associated with this instance of the engine.\n     * @param doNotHandleTouchAction Defines that engine should ignore modifying touch action attribute and style\n     * @param audioEngine Defines if an audio engine should be created by default\n     */\n    ThinEngine.prototype._sharedInit = function (canvas, doNotHandleTouchAction, audioEngine) {\n        this._renderingCanvas = canvas;\n    };\n    /**\n     * @param shaderLanguage\n     * @hidden\n     */\n    ThinEngine.prototype._getShaderProcessingContext = function (shaderLanguage) {\n        return null;\n    };\n    ThinEngine.prototype._rebuildInternalTextures = function () {\n        var currentState = this._internalTexturesCache.slice(); // Do a copy because the rebuild will add proxies\n        for (var _i = 0, currentState_1 = currentState; _i < currentState_1.length; _i++) {\n            var internalTexture = currentState_1[_i];\n            internalTexture._rebuild();\n        }\n    };\n    ThinEngine.prototype._rebuildRenderTargetWrappers = function () {\n        var currentState = this._renderTargetWrapperCache.slice(); // Do a copy because the rebuild will add proxies\n        for (var _i = 0, currentState_2 = currentState; _i < currentState_2.length; _i++) {\n            var renderTargetWrapper = currentState_2[_i];\n            renderTargetWrapper._rebuild();\n        }\n    };\n    ThinEngine.prototype._rebuildEffects = function () {\n        for (var key in this._compiledEffects) {\n            var effect = this._compiledEffects[key];\n            effect._pipelineContext = null; // because _prepareEffect will try to dispose this pipeline before recreating it and that would lead to webgl errors\n            effect._wasPreviouslyReady = false;\n            effect._prepareEffect();\n        }\n        Effect.ResetCache();\n    };\n    /**\n     * Gets a boolean indicating if all created effects are ready\n     * @returns true if all effects are ready\n     */\n    ThinEngine.prototype.areAllEffectsReady = function () {\n        for (var key in this._compiledEffects) {\n            var effect = this._compiledEffects[key];\n            if (!effect.isReady()) {\n                return false;\n            }\n        }\n        return true;\n    };\n    ThinEngine.prototype._rebuildBuffers = function () {\n        // Uniforms\n        for (var _i = 0, _a = this._uniformBuffers; _i < _a.length; _i++) {\n            var uniformBuffer = _a[_i];\n            uniformBuffer._rebuild();\n        }\n        // Storage buffers\n        for (var _b = 0, _c = this._storageBuffers; _b < _c.length; _b++) {\n            var storageBuffer = _c[_b];\n            storageBuffer._rebuild();\n        }\n    };\n    ThinEngine.prototype._initGLContext = function () {\n        // Caps\n        this._caps = {\n            maxTexturesImageUnits: this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),\n            maxCombinedTexturesImageUnits: this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),\n            maxVertexTextureImageUnits: this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),\n            maxTextureSize: this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),\n            maxSamples: this._webGLVersion > 1 ? this._gl.getParameter(this._gl.MAX_SAMPLES) : 1,\n            maxCubemapTextureSize: this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),\n            maxRenderTextureSize: this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),\n            maxVertexAttribs: this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),\n            maxVaryingVectors: this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),\n            maxFragmentUniformVectors: this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),\n            maxVertexUniformVectors: this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),\n            parallelShaderCompile: this._gl.getExtension(\"KHR_parallel_shader_compile\") || undefined,\n            standardDerivatives: this._webGLVersion > 1 || this._gl.getExtension(\"OES_standard_derivatives\") !== null,\n            maxAnisotropy: 1,\n            astc: this._gl.getExtension(\"WEBGL_compressed_texture_astc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_astc\"),\n            bptc: this._gl.getExtension(\"EXT_texture_compression_bptc\") || this._gl.getExtension(\"WEBKIT_EXT_texture_compression_bptc\"),\n            s3tc: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\"),\n            // eslint-disable-next-line @typescript-eslint/naming-convention\n            s3tc_srgb: this._gl.getExtension(\"WEBGL_compressed_texture_s3tc_srgb\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc_srgb\"),\n            pvrtc: this._gl.getExtension(\"WEBGL_compressed_texture_pvrtc\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\"),\n            etc1: this._gl.getExtension(\"WEBGL_compressed_texture_etc1\") || this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc1\"),\n            etc2: this._gl.getExtension(\"WEBGL_compressed_texture_etc\") ||\n                this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc\") ||\n                this._gl.getExtension(\"WEBGL_compressed_texture_es3_0\"),\n            textureAnisotropicFilterExtension: this._gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\n                this._gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\") ||\n                this._gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\"),\n            uintIndices: this._webGLVersion > 1 || this._gl.getExtension(\"OES_element_index_uint\") !== null,\n            fragmentDepthSupported: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_frag_depth\") !== null,\n            highPrecisionShaderSupported: false,\n            timerQuery: this._gl.getExtension(\"EXT_disjoint_timer_query_webgl2\") || this._gl.getExtension(\"EXT_disjoint_timer_query\"),\n            supportOcclusionQuery: this._webGLVersion > 1,\n            canUseTimestampForTimerQuery: false,\n            drawBuffersExtension: false,\n            maxMSAASamples: 1,\n            colorBufferFloat: !!(this._webGLVersion > 1 && this._gl.getExtension(\"EXT_color_buffer_float\")),\n            textureFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_float\") ? true : false,\n            textureHalfFloat: this._webGLVersion > 1 || this._gl.getExtension(\"OES_texture_half_float\") ? true : false,\n            textureHalfFloatRender: false,\n            textureFloatLinearFiltering: false,\n            textureFloatRender: false,\n            textureHalfFloatLinearFiltering: false,\n            vertexArrayObject: false,\n            instancedArrays: false,\n            textureLOD: this._webGLVersion > 1 || this._gl.getExtension(\"EXT_shader_texture_lod\") ? true : false,\n            blendMinMax: false,\n            multiview: this._gl.getExtension(\"OVR_multiview2\"),\n            oculusMultiview: this._gl.getExtension(\"OCULUS_multiview\"),\n            depthTextureExtension: false,\n            canUseGLInstanceID: this._webGLVersion > 1,\n            canUseGLVertexID: this._webGLVersion > 1,\n            supportComputeShaders: false,\n            supportSRGBBuffers: false,\n            supportTransformFeedbacks: this._webGLVersion > 1,\n            textureMaxLevel: this._webGLVersion > 1,\n            texture2DArrayMaxLayerCount: this._webGLVersion > 1 ? 256 : 128,\n        };\n        // Infos\n        this._glVersion = this._gl.getParameter(this._gl.VERSION);\n        var rendererInfo = this._gl.getExtension(\"WEBGL_debug_renderer_info\");\n        if (rendererInfo != null) {\n            this._glRenderer = this._gl.getParameter(rendererInfo.UNMASKED_RENDERER_WEBGL);\n            this._glVendor = this._gl.getParameter(rendererInfo.UNMASKED_VENDOR_WEBGL);\n        }\n        if (!this._glVendor) {\n            this._glVendor = this._gl.getParameter(this._gl.VENDOR) || \"Unknown vendor\";\n        }\n        if (!this._glRenderer) {\n            this._glRenderer = this._gl.getParameter(this._gl.RENDERER) || \"Unknown renderer\";\n        }\n        // Constants\n        if (this._gl.HALF_FLOAT_OES !== 0x8d61) {\n            this._gl.HALF_FLOAT_OES = 0x8d61; // Half floating-point type (16-bit).\n        }\n        if (this._gl.RGBA16F !== 0x881a) {\n            this._gl.RGBA16F = 0x881a; // RGBA 16-bit floating-point color-renderable internal sized format.\n        }\n        if (this._gl.RGBA32F !== 0x8814) {\n            this._gl.RGBA32F = 0x8814; // RGBA 32-bit floating-point color-renderable internal sized format.\n        }\n        if (this._gl.DEPTH24_STENCIL8 !== 35056) {\n            this._gl.DEPTH24_STENCIL8 = 35056;\n        }\n        // Extensions\n        if (this._caps.timerQuery) {\n            if (this._webGLVersion === 1) {\n                this._gl.getQuery = this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery);\n            }\n            this._caps.canUseTimestampForTimerQuery = this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT, this._caps.timerQuery.QUERY_COUNTER_BITS_EXT) > 0;\n        }\n        this._caps.maxAnisotropy = this._caps.textureAnisotropicFilterExtension\n            ? this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT)\n            : 0;\n        this._caps.textureFloatLinearFiltering = this._caps.textureFloat && this._gl.getExtension(\"OES_texture_float_linear\") ? true : false;\n        this._caps.textureFloatRender = this._caps.textureFloat && this._canRenderToFloatFramebuffer() ? true : false;\n        this._caps.textureHalfFloatLinearFiltering =\n            this._webGLVersion > 1 || (this._caps.textureHalfFloat && this._gl.getExtension(\"OES_texture_half_float_linear\")) ? true : false;\n        // Compressed formats\n        if (this._caps.astc) {\n            this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR = this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n        }\n        if (this._caps.bptc) {\n            this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT = this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n        }\n        if (this._caps.s3tc_srgb) {\n            this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n            this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n            this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT = this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n        }\n        if (this._caps.etc2) {\n            this._gl.COMPRESSED_SRGB8_ETC2 = this._caps.etc2.COMPRESSED_SRGB8_ETC2;\n            this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC = this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n        }\n        // Checks if some of the format renders first to allow the use of webgl inspector.\n        if (this._webGLVersion > 1) {\n            if (this._gl.HALF_FLOAT_OES !== 0x140b) {\n                this._gl.HALF_FLOAT_OES = 0x140b;\n            }\n        }\n        this._caps.textureHalfFloatRender = this._caps.textureHalfFloat && this._canRenderToHalfFloatFramebuffer();\n        // Draw buffers\n        if (this._webGLVersion > 1) {\n            this._caps.drawBuffersExtension = true;\n            this._caps.maxMSAASamples = this._maxMSAASamplesOverride !== null ? this._maxMSAASamplesOverride : this._gl.getParameter(this._gl.MAX_SAMPLES);\n        }\n        else {\n            var drawBuffersExtension = this._gl.getExtension(\"WEBGL_draw_buffers\");\n            if (drawBuffersExtension !== null) {\n                this._caps.drawBuffersExtension = true;\n                this._gl.drawBuffers = drawBuffersExtension.drawBuffersWEBGL.bind(drawBuffersExtension);\n                this._gl.DRAW_FRAMEBUFFER = this._gl.FRAMEBUFFER;\n                for (var i = 0; i < 16; i++) {\n                    this._gl[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"] = drawBuffersExtension[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n                }\n            }\n        }\n        // Depth Texture\n        if (this._webGLVersion > 1) {\n            this._caps.depthTextureExtension = true;\n        }\n        else {\n            var depthTextureExtension = this._gl.getExtension(\"WEBGL_depth_texture\");\n            if (depthTextureExtension != null) {\n                this._caps.depthTextureExtension = true;\n                this._gl.UNSIGNED_INT_24_8 = depthTextureExtension.UNSIGNED_INT_24_8_WEBGL;\n            }\n        }\n        // Vertex array object\n        if (this.disableVertexArrayObjects) {\n            this._caps.vertexArrayObject = false;\n        }\n        else if (this._webGLVersion > 1) {\n            this._caps.vertexArrayObject = true;\n        }\n        else {\n            var vertexArrayObjectExtension = this._gl.getExtension(\"OES_vertex_array_object\");\n            if (vertexArrayObjectExtension != null) {\n                this._caps.vertexArrayObject = true;\n                this._gl.createVertexArray = vertexArrayObjectExtension.createVertexArrayOES.bind(vertexArrayObjectExtension);\n                this._gl.bindVertexArray = vertexArrayObjectExtension.bindVertexArrayOES.bind(vertexArrayObjectExtension);\n                this._gl.deleteVertexArray = vertexArrayObjectExtension.deleteVertexArrayOES.bind(vertexArrayObjectExtension);\n            }\n        }\n        // Instances count\n        if (this._webGLVersion > 1) {\n            this._caps.instancedArrays = true;\n        }\n        else {\n            var instanceExtension = this._gl.getExtension(\"ANGLE_instanced_arrays\");\n            if (instanceExtension != null) {\n                this._caps.instancedArrays = true;\n                this._gl.drawArraysInstanced = instanceExtension.drawArraysInstancedANGLE.bind(instanceExtension);\n                this._gl.drawElementsInstanced = instanceExtension.drawElementsInstancedANGLE.bind(instanceExtension);\n                this._gl.vertexAttribDivisor = instanceExtension.vertexAttribDivisorANGLE.bind(instanceExtension);\n            }\n            else {\n                this._caps.instancedArrays = false;\n            }\n        }\n        if (this._gl.getShaderPrecisionFormat) {\n            var vertexhighp = this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER, this._gl.HIGH_FLOAT);\n            var fragmenthighp = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_FLOAT);\n            if (vertexhighp && fragmenthighp) {\n                this._caps.highPrecisionShaderSupported = vertexhighp.precision !== 0 && fragmenthighp.precision !== 0;\n            }\n        }\n        if (this._webGLVersion > 1) {\n            this._caps.blendMinMax = true;\n        }\n        else {\n            var blendMinMaxExtension = this._gl.getExtension(\"EXT_blend_minmax\");\n            if (blendMinMaxExtension != null) {\n                this._caps.blendMinMax = true;\n                this._gl.MAX = blendMinMaxExtension.MAX_EXT;\n                this._gl.MIN = blendMinMaxExtension.MIN_EXT;\n            }\n        }\n        // sRGB buffers\n        // only run this if not already set to true (in the constructor, for example)\n        if (!this._caps.supportSRGBBuffers) {\n            if (this._webGLVersion > 1) {\n                this._caps.supportSRGBBuffers = true;\n            }\n            else {\n                var sRGBExtension = this._gl.getExtension(\"EXT_sRGB\");\n                if (sRGBExtension != null) {\n                    this._caps.supportSRGBBuffers = true;\n                    this._gl.SRGB = sRGBExtension.SRGB_EXT;\n                    this._gl.SRGB8 = sRGBExtension.SRGB_ALPHA_EXT;\n                    this._gl.SRGB8_ALPHA8 = sRGBExtension.SRGB_ALPHA_EXT;\n                }\n            }\n            // take into account the forced state that was provided in options\n            // When the issue in angle/chrome is fixed the flag should be taken into account only when it is explicitly defined\n            this._caps.supportSRGBBuffers = this._caps.supportSRGBBuffers && !!(this._creationOptions && this._creationOptions.forceSRGBBufferSupportState);\n        }\n        // Depth buffer\n        this._depthCullingState.depthTest = true;\n        this._depthCullingState.depthFunc = this._gl.LEQUAL;\n        this._depthCullingState.depthMask = true;\n        // Texture maps\n        this._maxSimultaneousTextures = this._caps.maxCombinedTexturesImageUnits;\n        for (var slot = 0; slot < this._maxSimultaneousTextures; slot++) {\n            this._nextFreeTextureSlots.push(slot);\n        }\n    };\n    ThinEngine.prototype._initFeatures = function () {\n        this._features = {\n            forceBitmapOverHTMLImageElement: false,\n            supportRenderAndCopyToLodForFloatTextures: this._webGLVersion !== 1,\n            supportDepthStencilTexture: this._webGLVersion !== 1,\n            supportShadowSamplers: this._webGLVersion !== 1,\n            uniformBufferHardCheckMatrix: false,\n            allowTexturePrefiltering: this._webGLVersion !== 1,\n            trackUbosInFrame: false,\n            checkUbosContentBeforeUpload: false,\n            supportCSM: this._webGLVersion !== 1,\n            basisNeedsPOT: this._webGLVersion === 1,\n            support3DTextures: this._webGLVersion !== 1,\n            needTypeSuffixInShaderConstants: this._webGLVersion !== 1,\n            supportMSAA: this._webGLVersion !== 1,\n            supportSSAO2: this._webGLVersion !== 1,\n            supportExtendedTextureFormats: this._webGLVersion !== 1,\n            supportSwitchCaseInShader: this._webGLVersion !== 1,\n            supportSyncTextureRead: true,\n            needsInvertingBitmap: true,\n            useUBOBindingCache: true,\n            needShaderCodeInlining: false,\n            needToAlwaysBindUniformBuffers: false,\n            supportRenderPasses: false,\n            _collectUbosUpdatedInFrame: false,\n        };\n    };\n    Object.defineProperty(ThinEngine.prototype, \"webGLVersion\", {\n        /**\n         * Gets version of the current webGL context\n         * Keep it for back compat - use version instead\n         */\n        get: function () {\n            return this._webGLVersion;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets a string identifying the name of the class\n     * @returns \"Engine\" string\n     */\n    ThinEngine.prototype.getClassName = function () {\n        return \"ThinEngine\";\n    };\n    Object.defineProperty(ThinEngine.prototype, \"isStencilEnable\", {\n        /**\n         * Returns true if the stencil buffer has been enabled through the creation option of the context.\n         */\n        get: function () {\n            return this._isStencilEnable;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /** @hidden */\n    ThinEngine.prototype._prepareWorkingCanvas = function () {\n        if (this._workingCanvas) {\n            return;\n        }\n        this._workingCanvas = this.createCanvas(1, 1);\n        var context = this._workingCanvas.getContext(\"2d\");\n        if (context) {\n            this._workingContext = context;\n        }\n    };\n    /**\n     * Reset the texture cache to empty state\n     */\n    ThinEngine.prototype.resetTextureCache = function () {\n        for (var key in this._boundTexturesCache) {\n            if (!Object.prototype.hasOwnProperty.call(this._boundTexturesCache, key)) {\n                continue;\n            }\n            this._boundTexturesCache[key] = null;\n        }\n        this._currentTextureChannel = -1;\n    };\n    /**\n     * Gets an object containing information about the current engine context\n     * @returns an object containing the vendor, the renderer and the version of the current engine context\n     */\n    ThinEngine.prototype.getInfo = function () {\n        return this.getGlInfo();\n    };\n    /**\n     * Gets an object containing information about the current webGL context\n     * @returns an object containing the vendor, the renderer and the version of the current webGL context\n     */\n    ThinEngine.prototype.getGlInfo = function () {\n        return {\n            vendor: this._glVendor,\n            renderer: this._glRenderer,\n            version: this._glVersion,\n        };\n    };\n    /**\n     * Defines the hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @param level defines the level to use\n     */\n    ThinEngine.prototype.setHardwareScalingLevel = function (level) {\n        this._hardwareScalingLevel = level;\n        this.resize();\n    };\n    /**\n     * Gets the current hardware scaling level.\n     * By default the hardware scaling level is computed from the window device ratio.\n     * if level = 1 then the engine will render at the exact resolution of the canvas. If level = 0.5 then the engine will render at twice the size of the canvas.\n     * @returns a number indicating the current hardware scaling level\n     */\n    ThinEngine.prototype.getHardwareScalingLevel = function () {\n        return this._hardwareScalingLevel;\n    };\n    /**\n     * Gets the list of loaded textures\n     * @returns an array containing all loaded textures\n     */\n    ThinEngine.prototype.getLoadedTexturesCache = function () {\n        return this._internalTexturesCache;\n    };\n    /**\n     * Gets the object containing all engine capabilities\n     * @returns the EngineCapabilities object\n     */\n    ThinEngine.prototype.getCaps = function () {\n        return this._caps;\n    };\n    /**\n     * stop executing a render loop function and remove it from the execution array\n     * @param renderFunction defines the function to be removed. If not provided all functions will be removed.\n     */\n    ThinEngine.prototype.stopRenderLoop = function (renderFunction) {\n        if (!renderFunction) {\n            this._activeRenderLoops = [];\n            return;\n        }\n        var index = this._activeRenderLoops.indexOf(renderFunction);\n        if (index >= 0) {\n            this._activeRenderLoops.splice(index, 1);\n        }\n    };\n    /** @hidden */\n    ThinEngine.prototype._renderLoop = function () {\n        if (!this._contextWasLost) {\n            var shouldRender = true;\n            if (!this.renderEvenInBackground && this._windowIsBackground) {\n                shouldRender = false;\n            }\n            if (shouldRender) {\n                // Start new frame\n                this.beginFrame();\n                for (var index = 0; index < this._activeRenderLoops.length; index++) {\n                    var renderFunction = this._activeRenderLoops[index];\n                    renderFunction();\n                }\n                // Present\n                this.endFrame();\n            }\n        }\n        if (this._activeRenderLoops.length > 0) {\n            this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n        }\n        else {\n            this._renderingQueueLaunched = false;\n        }\n    };\n    /**\n     * Gets the HTML canvas attached with the current webGL context\n     * @returns a HTML canvas\n     */\n    ThinEngine.prototype.getRenderingCanvas = function () {\n        return this._renderingCanvas;\n    };\n    /**\n     * Gets the audio context specified in engine initialization options\n     * @returns an Audio Context\n     */\n    ThinEngine.prototype.getAudioContext = function () {\n        return this._audioContext;\n    };\n    /**\n     * Gets the audio destination specified in engine initialization options\n     * @returns an audio destination node\n     */\n    ThinEngine.prototype.getAudioDestination = function () {\n        return this._audioDestination;\n    };\n    /**\n     * Gets host window\n     * @returns the host window object\n     */\n    ThinEngine.prototype.getHostWindow = function () {\n        if (!IsWindowObjectExist()) {\n            return null;\n        }\n        if (this._renderingCanvas && this._renderingCanvas.ownerDocument && this._renderingCanvas.ownerDocument.defaultView) {\n            return this._renderingCanvas.ownerDocument.defaultView;\n        }\n        return window;\n    };\n    /**\n     * Gets the current render width\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render width\n     */\n    ThinEngine.prototype.getRenderWidth = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.width;\n        }\n        return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferWidth : this._gl.drawingBufferWidth;\n    };\n    /**\n     * Gets the current render height\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render height\n     */\n    ThinEngine.prototype.getRenderHeight = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.height;\n        }\n        return this._framebufferDimensionsObject ? this._framebufferDimensionsObject.framebufferHeight : this._gl.drawingBufferHeight;\n    };\n    /**\n     * Can be used to override the current requestAnimationFrame requester.\n     * @param bindedRenderFunction\n     * @param requester\n     * @hidden\n     */\n    ThinEngine.prototype._queueNewFrame = function (bindedRenderFunction, requester) {\n        return ThinEngine.QueueNewFrame(bindedRenderFunction, requester);\n    };\n    /**\n     * Register and execute a render loop. The engine can have more than one render function\n     * @param renderFunction defines the function to continuously execute\n     */\n    ThinEngine.prototype.runRenderLoop = function (renderFunction) {\n        if (this._activeRenderLoops.indexOf(renderFunction) !== -1) {\n            return;\n        }\n        this._activeRenderLoops.push(renderFunction);\n        if (!this._renderingQueueLaunched) {\n            this._renderingQueueLaunched = true;\n            this._boundRenderFunction = this._renderLoop.bind(this);\n            this._frameHandler = this._queueNewFrame(this._boundRenderFunction, this.getHostWindow());\n        }\n    };\n    /**\n     * Clear the current render buffer or the current render target (if any is set up)\n     * @param color defines the color to use\n     * @param backBuffer defines if the back buffer must be cleared\n     * @param depth defines if the depth buffer must be cleared\n     * @param stencil defines if the stencil buffer must be cleared\n     */\n    ThinEngine.prototype.clear = function (color, backBuffer, depth, stencil) {\n        if (stencil === void 0) { stencil = false; }\n        var useStencilGlobalOnly = this.stencilStateComposer.useStencilGlobalOnly;\n        this.stencilStateComposer.useStencilGlobalOnly = true; // make sure the stencil mask is coming from the global stencil and not from a material (effect) which would currently be in effect\n        this.applyStates();\n        this.stencilStateComposer.useStencilGlobalOnly = useStencilGlobalOnly;\n        var mode = 0;\n        if (backBuffer && color) {\n            this._gl.clearColor(color.r, color.g, color.b, color.a !== undefined ? color.a : 1.0);\n            mode |= this._gl.COLOR_BUFFER_BIT;\n        }\n        if (depth) {\n            if (this.useReverseDepthBuffer) {\n                this._depthCullingState.depthFunc = this._gl.GEQUAL;\n                this._gl.clearDepth(0.0);\n            }\n            else {\n                this._gl.clearDepth(1.0);\n            }\n            mode |= this._gl.DEPTH_BUFFER_BIT;\n        }\n        if (stencil) {\n            this._gl.clearStencil(0);\n            mode |= this._gl.STENCIL_BUFFER_BIT;\n        }\n        this._gl.clear(mode);\n    };\n    /**\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @hidden\n     */\n    ThinEngine.prototype._viewport = function (x, y, width, height) {\n        if (x !== this._viewportCached.x || y !== this._viewportCached.y || width !== this._viewportCached.z || height !== this._viewportCached.w) {\n            this._viewportCached.x = x;\n            this._viewportCached.y = y;\n            this._viewportCached.z = width;\n            this._viewportCached.w = height;\n            this._gl.viewport(x, y, width, height);\n        }\n    };\n    /**\n     * Set the WebGL's viewport\n     * @param viewport defines the viewport element to be used\n     * @param requiredWidth defines the width required for rendering. If not provided the rendering canvas' width is used\n     * @param requiredHeight defines the height required for rendering. If not provided the rendering canvas' height is used\n     */\n    ThinEngine.prototype.setViewport = function (viewport, requiredWidth, requiredHeight) {\n        var width = requiredWidth || this.getRenderWidth();\n        var height = requiredHeight || this.getRenderHeight();\n        var x = viewport.x || 0;\n        var y = viewport.y || 0;\n        this._cachedViewport = viewport;\n        this._viewport(x * width, y * height, width * viewport.width, height * viewport.height);\n    };\n    /**\n     * Begin a new frame\n     */\n    ThinEngine.prototype.beginFrame = function () { };\n    /**\n     * Enf the current frame\n     */\n    ThinEngine.prototype.endFrame = function () {\n        // Force a flush in case we are using a bad OS.\n        if (this._badOS) {\n            this.flushFramebuffer();\n        }\n        this._frameId++;\n    };\n    /**\n     * Resize the view according to the canvas' size\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     */\n    ThinEngine.prototype.resize = function (forceSetSize) {\n        if (forceSetSize === void 0) { forceSetSize = false; }\n        var width;\n        var height;\n        // Requery hardware scaling level to handle zoomed-in resizing.\n        if (this._adaptToDeviceRatio) {\n            var devicePixelRatio_1 = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n            var limitDeviceRatio = this._creationOptions.limitDeviceRatio || devicePixelRatio_1;\n            this._hardwareScalingLevel = this._adaptToDeviceRatio ? 1.0 / Math.min(limitDeviceRatio, devicePixelRatio_1) : 1.0;\n        }\n        if (IsWindowObjectExist()) {\n            width = this._renderingCanvas ? this._renderingCanvas.clientWidth || this._renderingCanvas.width : window.innerWidth;\n            height = this._renderingCanvas ? this._renderingCanvas.clientHeight || this._renderingCanvas.height : window.innerHeight;\n        }\n        else {\n            width = this._renderingCanvas ? this._renderingCanvas.width : 100;\n            height = this._renderingCanvas ? this._renderingCanvas.height : 100;\n        }\n        this.setSize(width / this._hardwareScalingLevel, height / this._hardwareScalingLevel, forceSetSize);\n    };\n    /**\n     * Force a specific size of the canvas\n     * @param width defines the new canvas' width\n     * @param height defines the new canvas' height\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     * @returns true if the size was changed\n     */\n    ThinEngine.prototype.setSize = function (width, height, forceSetSize) {\n        if (forceSetSize === void 0) { forceSetSize = false; }\n        if (!this._renderingCanvas) {\n            return false;\n        }\n        width = width | 0;\n        height = height | 0;\n        if (!forceSetSize && this._renderingCanvas.width === width && this._renderingCanvas.height === height) {\n            return false;\n        }\n        this._renderingCanvas.width = width;\n        this._renderingCanvas.height = height;\n        return true;\n    };\n    /**\n     * Binds the frame buffer to the specified texture.\n     * @param texture The render target wrapper to render to\n     * @param faceIndex The face of the texture to render to in case of cube texture\n     * @param requiredWidth The width of the target to render to\n     * @param requiredHeight The height of the target to render to\n     * @param forceFullscreenViewport Forces the viewport to be the entire texture/screen if true\n     * @param lodLevel defines the lod level to bind to the frame buffer\n     * @param layer defines the 2d array index to bind to frame buffer to\n     */\n    ThinEngine.prototype.bindFramebuffer = function (texture, faceIndex, requiredWidth, requiredHeight, forceFullscreenViewport, lodLevel, layer) {\n        var _a, _b, _c, _d, _e;\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lodLevel === void 0) { lodLevel = 0; }\n        if (layer === void 0) { layer = 0; }\n        var webglRTWrapper = texture;\n        if (this._currentRenderTarget) {\n            this.unBindFramebuffer(this._currentRenderTarget);\n        }\n        this._currentRenderTarget = texture;\n        this._bindUnboundFramebuffer(webglRTWrapper._MSAAFramebuffer ? webglRTWrapper._MSAAFramebuffer : webglRTWrapper._framebuffer);\n        var gl = this._gl;\n        if (texture.is2DArray) {\n            gl.framebufferTextureLayer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, (_a = texture.texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource, lodLevel, layer);\n        }\n        else if (texture.isCube) {\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_b = texture.texture._hardwareTexture) === null || _b === void 0 ? void 0 : _b.underlyingResource, lodLevel);\n        }\n        var depthStencilTexture = texture._depthStencilTexture;\n        if (depthStencilTexture) {\n            var attachment = texture._depthStencilTextureWithStencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n            if (texture.is2DArray) {\n                gl.framebufferTextureLayer(gl.FRAMEBUFFER, attachment, (_c = depthStencilTexture._hardwareTexture) === null || _c === void 0 ? void 0 : _c.underlyingResource, lodLevel, layer);\n            }\n            else if (texture.isCube) {\n                gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, (_d = depthStencilTexture._hardwareTexture) === null || _d === void 0 ? void 0 : _d.underlyingResource, lodLevel);\n            }\n            else {\n                gl.framebufferTexture2D(gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, (_e = depthStencilTexture._hardwareTexture) === null || _e === void 0 ? void 0 : _e.underlyingResource, lodLevel);\n            }\n        }\n        if (this._cachedViewport && !forceFullscreenViewport) {\n            this.setViewport(this._cachedViewport, requiredWidth, requiredHeight);\n        }\n        else {\n            if (!requiredWidth) {\n                requiredWidth = texture.width;\n                if (lodLevel) {\n                    requiredWidth = requiredWidth / Math.pow(2, lodLevel);\n                }\n            }\n            if (!requiredHeight) {\n                requiredHeight = texture.height;\n                if (lodLevel) {\n                    requiredHeight = requiredHeight / Math.pow(2, lodLevel);\n                }\n            }\n            this._viewport(0, 0, requiredWidth, requiredHeight);\n        }\n        this.wipeCaches();\n    };\n    /**\n     * Set various states to the webGL context\n     * @param culling defines culling state: true to enable culling, false to disable it\n     * @param zOffset defines the value to apply to zOffset (0 by default)\n     * @param force defines if states must be applied even if cache is up to date\n     * @param reverseSide defines if culling must be reversed (CCW if false, CW if true)\n     * @param cullBackFaces true to cull back faces, false to cull front faces (if culling is enabled)\n     * @param stencil stencil states to set\n     * @param zOffsetUnits defines the value to apply to zOffsetUnits (0 by default)\n     */\n    ThinEngine.prototype.setState = function (culling, zOffset, force, reverseSide, cullBackFaces, stencil, zOffsetUnits) {\n        var _a, _b;\n        if (zOffset === void 0) { zOffset = 0; }\n        if (reverseSide === void 0) { reverseSide = false; }\n        if (zOffsetUnits === void 0) { zOffsetUnits = 0; }\n        // Culling\n        if (this._depthCullingState.cull !== culling || force) {\n            this._depthCullingState.cull = culling;\n        }\n        // Cull face\n        var cullFace = ((_b = (_a = this.cullBackFaces) !== null && _a !== void 0 ? _a : cullBackFaces) !== null && _b !== void 0 ? _b : true) ? this._gl.BACK : this._gl.FRONT;\n        if (this._depthCullingState.cullFace !== cullFace || force) {\n            this._depthCullingState.cullFace = cullFace;\n        }\n        // Z offset\n        this.setZOffset(zOffset);\n        this.setZOffsetUnits(zOffsetUnits);\n        // Front face\n        var frontFace = reverseSide ? this._gl.CW : this._gl.CCW;\n        if (this._depthCullingState.frontFace !== frontFace || force) {\n            this._depthCullingState.frontFace = frontFace;\n        }\n        this._stencilStateComposer.stencilMaterial = stencil;\n    };\n    /**\n     * Set the z offset Factor to apply to current rendering\n     * @param value defines the offset to apply\n     */\n    ThinEngine.prototype.setZOffset = function (value) {\n        this._depthCullingState.zOffset = this.useReverseDepthBuffer ? -value : value;\n    };\n    /**\n     * Gets the current value of the zOffset Factor\n     * @returns the current zOffset Factor state\n     */\n    ThinEngine.prototype.getZOffset = function () {\n        var zOffset = this._depthCullingState.zOffset;\n        return this.useReverseDepthBuffer ? -zOffset : zOffset;\n    };\n    /**\n     * Set the z offset Units to apply to current rendering\n     * @param value defines the offset to apply\n     */\n    ThinEngine.prototype.setZOffsetUnits = function (value) {\n        this._depthCullingState.zOffsetUnits = this.useReverseDepthBuffer ? -value : value;\n    };\n    /**\n     * Gets the current value of the zOffset Units\n     * @returns the current zOffset Units state\n     */\n    ThinEngine.prototype.getZOffsetUnits = function () {\n        var zOffsetUnits = this._depthCullingState.zOffsetUnits;\n        return this.useReverseDepthBuffer ? -zOffsetUnits : zOffsetUnits;\n    };\n    /**\n     * @param framebuffer\n     * @hidden\n     */\n    ThinEngine.prototype._bindUnboundFramebuffer = function (framebuffer) {\n        if (this._currentFramebuffer !== framebuffer) {\n            this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, framebuffer);\n            this._currentFramebuffer = framebuffer;\n        }\n    };\n    /** @hidden */\n    ThinEngine.prototype._currentFrameBufferIsDefaultFrameBuffer = function () {\n        return this._currentFramebuffer === null;\n    };\n    /**\n     * Generates the mipmaps for a texture\n     * @param texture texture to generate the mipmaps for\n     */\n    ThinEngine.prototype.generateMipmaps = function (texture) {\n        this._bindTextureDirectly(this._gl.TEXTURE_2D, texture, true);\n        this._gl.generateMipmap(this._gl.TEXTURE_2D);\n        this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n    };\n    /**\n     * Unbind the current render target texture from the webGL context\n     * @param texture defines the render target wrapper to unbind\n     * @param disableGenerateMipMaps defines a boolean indicating that mipmaps must not be generated\n     * @param onBeforeUnbind defines a function which will be called before the effective unbind\n     */\n    ThinEngine.prototype.unBindFramebuffer = function (texture, disableGenerateMipMaps, onBeforeUnbind) {\n        var _a;\n        if (disableGenerateMipMaps === void 0) { disableGenerateMipMaps = false; }\n        var webglRTWrapper = texture;\n        this._currentRenderTarget = null;\n        // If MSAA, we need to bitblt back to main texture\n        var gl = this._gl;\n        if (webglRTWrapper._MSAAFramebuffer) {\n            if (texture.isMulti) {\n                // This texture is part of a MRT texture, we need to treat all attachments\n                this.unBindMultiColorAttachmentFramebuffer(texture, disableGenerateMipMaps, onBeforeUnbind);\n                return;\n            }\n            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, webglRTWrapper._MSAAFramebuffer);\n            gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, webglRTWrapper._framebuffer);\n            gl.blitFramebuffer(0, 0, texture.width, texture.height, 0, 0, texture.width, texture.height, gl.COLOR_BUFFER_BIT, gl.NEAREST);\n        }\n        if (((_a = texture.texture) === null || _a === void 0 ? void 0 : _a.generateMipMaps) && !disableGenerateMipMaps && !texture.isCube) {\n            this.generateMipmaps(texture.texture);\n        }\n        if (onBeforeUnbind) {\n            if (webglRTWrapper._MSAAFramebuffer) {\n                // Bind the correct framebuffer\n                this._bindUnboundFramebuffer(webglRTWrapper._framebuffer);\n            }\n            onBeforeUnbind();\n        }\n        this._bindUnboundFramebuffer(null);\n    };\n    /**\n     * Force a webGL flush (ie. a flush of all waiting webGL commands)\n     */\n    ThinEngine.prototype.flushFramebuffer = function () {\n        this._gl.flush();\n    };\n    /**\n     * Unbind the current render target and bind the default framebuffer\n     */\n    ThinEngine.prototype.restoreDefaultFramebuffer = function () {\n        if (this._currentRenderTarget) {\n            this.unBindFramebuffer(this._currentRenderTarget);\n        }\n        else {\n            this._bindUnboundFramebuffer(null);\n        }\n        if (this._cachedViewport) {\n            this.setViewport(this._cachedViewport);\n        }\n        this.wipeCaches();\n    };\n    // VBOs\n    /** @hidden */\n    ThinEngine.prototype._resetVertexBufferBinding = function () {\n        this.bindArrayBuffer(null);\n        this._cachedVertexBuffers = null;\n    };\n    /**\n     * Creates a vertex buffer\n     * @param data the data for the vertex buffer\n     * @returns the new WebGL static buffer\n     */\n    ThinEngine.prototype.createVertexBuffer = function (data) {\n        return this._createVertexBuffer(data, this._gl.STATIC_DRAW);\n    };\n    ThinEngine.prototype._createVertexBuffer = function (data, usage) {\n        var vbo = this._gl.createBuffer();\n        if (!vbo) {\n            throw new Error(\"Unable to create vertex buffer\");\n        }\n        var dataBuffer = new WebGLDataBuffer(vbo);\n        this.bindArrayBuffer(dataBuffer);\n        if (data instanceof Array) {\n            this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(data), usage);\n        }\n        else {\n            this._gl.bufferData(this._gl.ARRAY_BUFFER, data, usage);\n        }\n        this._resetVertexBufferBinding();\n        dataBuffer.references = 1;\n        return dataBuffer;\n    };\n    /**\n     * Creates a dynamic vertex buffer\n     * @param data the data for the dynamic vertex buffer\n     * @returns the new WebGL dynamic buffer\n     */\n    ThinEngine.prototype.createDynamicVertexBuffer = function (data) {\n        return this._createVertexBuffer(data, this._gl.DYNAMIC_DRAW);\n    };\n    ThinEngine.prototype._resetIndexBufferBinding = function () {\n        this.bindIndexBuffer(null);\n        this._cachedIndexBuffer = null;\n    };\n    /**\n     * Creates a new index buffer\n     * @param indices defines the content of the index buffer\n     * @param updatable defines if the index buffer must be updatable\n     * @returns a new webGL buffer\n     */\n    ThinEngine.prototype.createIndexBuffer = function (indices, updatable) {\n        var vbo = this._gl.createBuffer();\n        var dataBuffer = new WebGLDataBuffer(vbo);\n        if (!vbo) {\n            throw new Error(\"Unable to create index buffer\");\n        }\n        this.bindIndexBuffer(dataBuffer);\n        var data = this._normalizeIndexData(indices);\n        this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, data, updatable ? this._gl.DYNAMIC_DRAW : this._gl.STATIC_DRAW);\n        this._resetIndexBufferBinding();\n        dataBuffer.references = 1;\n        dataBuffer.is32Bits = data.BYTES_PER_ELEMENT === 4;\n        return dataBuffer;\n    };\n    ThinEngine.prototype._normalizeIndexData = function (indices) {\n        var bytesPerElement = indices.BYTES_PER_ELEMENT;\n        if (bytesPerElement === 2) {\n            return indices;\n        }\n        // Check 32 bit support\n        if (this._caps.uintIndices) {\n            if (indices instanceof Uint32Array) {\n                return indices;\n            }\n            else {\n                // number[] or Int32Array, check if 32 bit is necessary\n                for (var index = 0; index < indices.length; index++) {\n                    if (indices[index] >= 65535) {\n                        return new Uint32Array(indices);\n                    }\n                }\n                return new Uint16Array(indices);\n            }\n        }\n        // No 32 bit support, force conversion to 16 bit (values greater 16 bit are lost)\n        return new Uint16Array(indices);\n    };\n    /**\n     * Bind a webGL buffer to the webGL context\n     * @param buffer defines the buffer to bind\n     */\n    ThinEngine.prototype.bindArrayBuffer = function (buffer) {\n        if (!this._vaoRecordInProgress) {\n            this._unbindVertexArrayObject();\n        }\n        this._bindBuffer(buffer, this._gl.ARRAY_BUFFER);\n    };\n    /**\n     * Bind a specific block at a given index in a specific shader program\n     * @param pipelineContext defines the pipeline context to use\n     * @param blockName defines the block name\n     * @param index defines the index where to bind the block\n     */\n    ThinEngine.prototype.bindUniformBlock = function (pipelineContext, blockName, index) {\n        var program = pipelineContext.program;\n        var uniformLocation = this._gl.getUniformBlockIndex(program, blockName);\n        this._gl.uniformBlockBinding(program, uniformLocation, index);\n    };\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    ThinEngine.prototype.bindIndexBuffer = function (buffer) {\n        if (!this._vaoRecordInProgress) {\n            this._unbindVertexArrayObject();\n        }\n        this._bindBuffer(buffer, this._gl.ELEMENT_ARRAY_BUFFER);\n    };\n    ThinEngine.prototype._bindBuffer = function (buffer, target) {\n        if (this._vaoRecordInProgress || this._currentBoundBuffer[target] !== buffer) {\n            this._gl.bindBuffer(target, buffer ? buffer.underlyingResource : null);\n            this._currentBoundBuffer[target] = buffer;\n        }\n    };\n    /**\n     * update the bound buffer with the given data\n     * @param data defines the data to update\n     */\n    ThinEngine.prototype.updateArrayBuffer = function (data) {\n        this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n    };\n    ThinEngine.prototype._vertexAttribPointer = function (buffer, indx, size, type, normalized, stride, offset) {\n        var pointer = this._currentBufferPointers[indx];\n        if (!pointer) {\n            return;\n        }\n        var changed = false;\n        if (!pointer.active) {\n            changed = true;\n            pointer.active = true;\n            pointer.index = indx;\n            pointer.size = size;\n            pointer.type = type;\n            pointer.normalized = normalized;\n            pointer.stride = stride;\n            pointer.offset = offset;\n            pointer.buffer = buffer;\n        }\n        else {\n            if (pointer.buffer !== buffer) {\n                pointer.buffer = buffer;\n                changed = true;\n            }\n            if (pointer.size !== size) {\n                pointer.size = size;\n                changed = true;\n            }\n            if (pointer.type !== type) {\n                pointer.type = type;\n                changed = true;\n            }\n            if (pointer.normalized !== normalized) {\n                pointer.normalized = normalized;\n                changed = true;\n            }\n            if (pointer.stride !== stride) {\n                pointer.stride = stride;\n                changed = true;\n            }\n            if (pointer.offset !== offset) {\n                pointer.offset = offset;\n                changed = true;\n            }\n        }\n        if (changed || this._vaoRecordInProgress) {\n            this.bindArrayBuffer(buffer);\n            this._gl.vertexAttribPointer(indx, size, type, normalized, stride, offset);\n        }\n    };\n    /**\n     * @param indexBuffer\n     * @hidden\n     */\n    ThinEngine.prototype._bindIndexBufferWithCache = function (indexBuffer) {\n        if (indexBuffer == null) {\n            return;\n        }\n        if (this._cachedIndexBuffer !== indexBuffer) {\n            this._cachedIndexBuffer = indexBuffer;\n            this.bindIndexBuffer(indexBuffer);\n            this._uintIndicesCurrentlySet = indexBuffer.is32Bits;\n        }\n    };\n    ThinEngine.prototype._bindVertexBuffersAttributes = function (vertexBuffers, effect, overrideVertexBuffers) {\n        var attributes = effect.getAttributesNames();\n        if (!this._vaoRecordInProgress) {\n            this._unbindVertexArrayObject();\n        }\n        this.unbindAllAttributes();\n        for (var index = 0; index < attributes.length; index++) {\n            var order = effect.getAttributeLocation(index);\n            if (order >= 0) {\n                var ai = attributes[index];\n                var vertexBuffer = null;\n                if (overrideVertexBuffers) {\n                    vertexBuffer = overrideVertexBuffers[ai];\n                }\n                if (!vertexBuffer) {\n                    vertexBuffer = vertexBuffers[ai];\n                }\n                if (!vertexBuffer) {\n                    continue;\n                }\n                this._gl.enableVertexAttribArray(order);\n                if (!this._vaoRecordInProgress) {\n                    this._vertexAttribArraysEnabled[order] = true;\n                }\n                var buffer = vertexBuffer.getBuffer();\n                if (buffer) {\n                    this._vertexAttribPointer(buffer, order, vertexBuffer.getSize(), vertexBuffer.type, vertexBuffer.normalized, vertexBuffer.byteStride, vertexBuffer.byteOffset);\n                    if (vertexBuffer.getIsInstanced()) {\n                        this._gl.vertexAttribDivisor(order, vertexBuffer.getInstanceDivisor());\n                        if (!this._vaoRecordInProgress) {\n                            this._currentInstanceLocations.push(order);\n                            this._currentInstanceBuffers.push(buffer);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Records a vertex array object\n     * @see https://doc.babylonjs.com/features/webgl2#vertex-array-objects\n     * @param vertexBuffers defines the list of vertex buffers to store\n     * @param indexBuffer defines the index buffer to store\n     * @param effect defines the effect to store\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     * @returns the new vertex array object\n     */\n    ThinEngine.prototype.recordVertexArrayObject = function (vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n        var vao = this._gl.createVertexArray();\n        this._vaoRecordInProgress = true;\n        this._gl.bindVertexArray(vao);\n        this._mustWipeVertexAttributes = true;\n        this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n        this.bindIndexBuffer(indexBuffer);\n        this._vaoRecordInProgress = false;\n        this._gl.bindVertexArray(null);\n        return vao;\n    };\n    /**\n     * Bind a specific vertex array object\n     * @see https://doc.babylonjs.com/features/webgl2#vertex-array-objects\n     * @param vertexArrayObject defines the vertex array object to bind\n     * @param indexBuffer defines the index buffer to bind\n     */\n    ThinEngine.prototype.bindVertexArrayObject = function (vertexArrayObject, indexBuffer) {\n        if (this._cachedVertexArrayObject !== vertexArrayObject) {\n            this._cachedVertexArrayObject = vertexArrayObject;\n            this._gl.bindVertexArray(vertexArrayObject);\n            this._cachedVertexBuffers = null;\n            this._cachedIndexBuffer = null;\n            this._uintIndicesCurrentlySet = indexBuffer != null && indexBuffer.is32Bits;\n            this._mustWipeVertexAttributes = true;\n        }\n    };\n    /**\n     * Bind webGl buffers directly to the webGL context\n     * @param vertexBuffer defines the vertex buffer to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param vertexDeclaration defines the vertex declaration to use with the vertex buffer\n     * @param vertexStrideSize defines the vertex stride of the vertex buffer\n     * @param effect defines the effect associated with the vertex buffer\n     */\n    ThinEngine.prototype.bindBuffersDirectly = function (vertexBuffer, indexBuffer, vertexDeclaration, vertexStrideSize, effect) {\n        if (this._cachedVertexBuffers !== vertexBuffer || this._cachedEffectForVertexBuffers !== effect) {\n            this._cachedVertexBuffers = vertexBuffer;\n            this._cachedEffectForVertexBuffers = effect;\n            var attributesCount = effect.getAttributesCount();\n            this._unbindVertexArrayObject();\n            this.unbindAllAttributes();\n            var offset = 0;\n            for (var index = 0; index < attributesCount; index++) {\n                if (index < vertexDeclaration.length) {\n                    var order = effect.getAttributeLocation(index);\n                    if (order >= 0) {\n                        this._gl.enableVertexAttribArray(order);\n                        this._vertexAttribArraysEnabled[order] = true;\n                        this._vertexAttribPointer(vertexBuffer, order, vertexDeclaration[index], this._gl.FLOAT, false, vertexStrideSize, offset);\n                    }\n                    offset += vertexDeclaration[index] * 4;\n                }\n            }\n        }\n        this._bindIndexBufferWithCache(indexBuffer);\n    };\n    ThinEngine.prototype._unbindVertexArrayObject = function () {\n        if (!this._cachedVertexArrayObject) {\n            return;\n        }\n        this._cachedVertexArrayObject = null;\n        this._gl.bindVertexArray(null);\n    };\n    /**\n     * Bind a list of vertex buffers to the webGL context\n     * @param vertexBuffers defines the list of vertex buffers to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param effect defines the effect associated with the vertex buffers\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     */\n    ThinEngine.prototype.bindBuffers = function (vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n        if (this._cachedVertexBuffers !== vertexBuffers || this._cachedEffectForVertexBuffers !== effect) {\n            this._cachedVertexBuffers = vertexBuffers;\n            this._cachedEffectForVertexBuffers = effect;\n            this._bindVertexBuffersAttributes(vertexBuffers, effect, overrideVertexBuffers);\n        }\n        this._bindIndexBufferWithCache(indexBuffer);\n    };\n    /**\n     * Unbind all instance attributes\n     */\n    ThinEngine.prototype.unbindInstanceAttributes = function () {\n        var boundBuffer;\n        for (var i = 0, ul = this._currentInstanceLocations.length; i < ul; i++) {\n            var instancesBuffer = this._currentInstanceBuffers[i];\n            if (boundBuffer != instancesBuffer && instancesBuffer.references) {\n                boundBuffer = instancesBuffer;\n                this.bindArrayBuffer(instancesBuffer);\n            }\n            var offsetLocation = this._currentInstanceLocations[i];\n            this._gl.vertexAttribDivisor(offsetLocation, 0);\n        }\n        this._currentInstanceBuffers.length = 0;\n        this._currentInstanceLocations.length = 0;\n    };\n    /**\n     * Release and free the memory of a vertex array object\n     * @param vao defines the vertex array object to delete\n     */\n    ThinEngine.prototype.releaseVertexArrayObject = function (vao) {\n        this._gl.deleteVertexArray(vao);\n    };\n    /**\n     * @param buffer\n     * @hidden\n     */\n    ThinEngine.prototype._releaseBuffer = function (buffer) {\n        buffer.references--;\n        if (buffer.references === 0) {\n            this._deleteBuffer(buffer);\n            return true;\n        }\n        return false;\n    };\n    ThinEngine.prototype._deleteBuffer = function (buffer) {\n        this._gl.deleteBuffer(buffer.underlyingResource);\n    };\n    /**\n     * Update the content of a webGL buffer used with instantiation and bind it to the webGL context\n     * @param instancesBuffer defines the webGL buffer to update and bind\n     * @param data defines the data to store in the buffer\n     * @param offsetLocations defines the offsets or attributes information used to determine where data must be stored in the buffer\n     */\n    ThinEngine.prototype.updateAndBindInstancesBuffer = function (instancesBuffer, data, offsetLocations) {\n        this.bindArrayBuffer(instancesBuffer);\n        if (data) {\n            this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, data);\n        }\n        if (offsetLocations[0].index !== undefined) {\n            this.bindInstancesBuffer(instancesBuffer, offsetLocations, true);\n        }\n        else {\n            for (var index = 0; index < 4; index++) {\n                var offsetLocation = offsetLocations[index];\n                if (!this._vertexAttribArraysEnabled[offsetLocation]) {\n                    this._gl.enableVertexAttribArray(offsetLocation);\n                    this._vertexAttribArraysEnabled[offsetLocation] = true;\n                }\n                this._vertexAttribPointer(instancesBuffer, offsetLocation, 4, this._gl.FLOAT, false, 64, index * 16);\n                this._gl.vertexAttribDivisor(offsetLocation, 1);\n                this._currentInstanceLocations.push(offsetLocation);\n                this._currentInstanceBuffers.push(instancesBuffer);\n            }\n        }\n    };\n    /**\n     * Bind the content of a webGL buffer used with instantiation\n     * @param instancesBuffer defines the webGL buffer to bind\n     * @param attributesInfo defines the offsets or attributes information used to determine where data must be stored in the buffer\n     * @param computeStride defines Whether to compute the strides from the info or use the default 0\n     */\n    ThinEngine.prototype.bindInstancesBuffer = function (instancesBuffer, attributesInfo, computeStride) {\n        if (computeStride === void 0) { computeStride = true; }\n        this.bindArrayBuffer(instancesBuffer);\n        var stride = 0;\n        if (computeStride) {\n            for (var i = 0; i < attributesInfo.length; i++) {\n                var ai = attributesInfo[i];\n                stride += ai.attributeSize * 4;\n            }\n        }\n        for (var i = 0; i < attributesInfo.length; i++) {\n            var ai = attributesInfo[i];\n            if (ai.index === undefined) {\n                ai.index = this._currentEffect.getAttributeLocationByName(ai.attributeName);\n            }\n            if (ai.index < 0) {\n                continue;\n            }\n            if (!this._vertexAttribArraysEnabled[ai.index]) {\n                this._gl.enableVertexAttribArray(ai.index);\n                this._vertexAttribArraysEnabled[ai.index] = true;\n            }\n            this._vertexAttribPointer(instancesBuffer, ai.index, ai.attributeSize, ai.attributeType || this._gl.FLOAT, ai.normalized || false, stride, ai.offset);\n            this._gl.vertexAttribDivisor(ai.index, ai.divisor === undefined ? 1 : ai.divisor);\n            this._currentInstanceLocations.push(ai.index);\n            this._currentInstanceBuffers.push(instancesBuffer);\n        }\n    };\n    /**\n     * Disable the instance attribute corresponding to the name in parameter\n     * @param name defines the name of the attribute to disable\n     */\n    ThinEngine.prototype.disableInstanceAttributeByName = function (name) {\n        if (!this._currentEffect) {\n            return;\n        }\n        var attributeLocation = this._currentEffect.getAttributeLocationByName(name);\n        this.disableInstanceAttribute(attributeLocation);\n    };\n    /**\n     * Disable the instance attribute corresponding to the location in parameter\n     * @param attributeLocation defines the attribute location of the attribute to disable\n     */\n    ThinEngine.prototype.disableInstanceAttribute = function (attributeLocation) {\n        var shouldClean = false;\n        var index;\n        while ((index = this._currentInstanceLocations.indexOf(attributeLocation)) !== -1) {\n            this._currentInstanceLocations.splice(index, 1);\n            this._currentInstanceBuffers.splice(index, 1);\n            shouldClean = true;\n            index = this._currentInstanceLocations.indexOf(attributeLocation);\n        }\n        if (shouldClean) {\n            this._gl.vertexAttribDivisor(attributeLocation, 0);\n            this.disableAttributeByIndex(attributeLocation);\n        }\n    };\n    /**\n     * Disable the attribute corresponding to the location in parameter\n     * @param attributeLocation defines the attribute location of the attribute to disable\n     */\n    ThinEngine.prototype.disableAttributeByIndex = function (attributeLocation) {\n        this._gl.disableVertexAttribArray(attributeLocation);\n        this._vertexAttribArraysEnabled[attributeLocation] = false;\n        this._currentBufferPointers[attributeLocation].active = false;\n    };\n    /**\n     * Send a draw order\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    ThinEngine.prototype.draw = function (useTriangles, indexStart, indexCount, instancesCount) {\n        this.drawElementsType(useTriangles ? 0 : 1, indexStart, indexCount, instancesCount);\n    };\n    /**\n     * Draw a list of points\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    ThinEngine.prototype.drawPointClouds = function (verticesStart, verticesCount, instancesCount) {\n        this.drawArraysType(2, verticesStart, verticesCount, instancesCount);\n    };\n    /**\n     * Draw a list of unindexed primitives\n     * @param useTriangles defines if triangles must be used to draw (else wireframe will be used)\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    ThinEngine.prototype.drawUnIndexed = function (useTriangles, verticesStart, verticesCount, instancesCount) {\n        this.drawArraysType(useTriangles ? 0 : 1, verticesStart, verticesCount, instancesCount);\n    };\n    /**\n     * Draw a list of indexed primitives\n     * @param fillMode defines the primitive to use\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    ThinEngine.prototype.drawElementsType = function (fillMode, indexStart, indexCount, instancesCount) {\n        // Apply states\n        this.applyStates();\n        this._reportDrawCall();\n        // Render\n        var drawMode = this._drawMode(fillMode);\n        var indexFormat = this._uintIndicesCurrentlySet ? this._gl.UNSIGNED_INT : this._gl.UNSIGNED_SHORT;\n        var mult = this._uintIndicesCurrentlySet ? 4 : 2;\n        if (instancesCount) {\n            this._gl.drawElementsInstanced(drawMode, indexCount, indexFormat, indexStart * mult, instancesCount);\n        }\n        else {\n            this._gl.drawElements(drawMode, indexCount, indexFormat, indexStart * mult);\n        }\n    };\n    /**\n     * Draw a list of unindexed primitives\n     * @param fillMode defines the primitive to use\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    ThinEngine.prototype.drawArraysType = function (fillMode, verticesStart, verticesCount, instancesCount) {\n        // Apply states\n        this.applyStates();\n        this._reportDrawCall();\n        var drawMode = this._drawMode(fillMode);\n        if (instancesCount) {\n            this._gl.drawArraysInstanced(drawMode, verticesStart, verticesCount, instancesCount);\n        }\n        else {\n            this._gl.drawArrays(drawMode, verticesStart, verticesCount);\n        }\n    };\n    ThinEngine.prototype._drawMode = function (fillMode) {\n        switch (fillMode) {\n            // Triangle views\n            case 0:\n                return this._gl.TRIANGLES;\n            case 2:\n                return this._gl.POINTS;\n            case 1:\n                return this._gl.LINES;\n            // Draw modes\n            case 3:\n                return this._gl.POINTS;\n            case 4:\n                return this._gl.LINES;\n            case 5:\n                return this._gl.LINE_LOOP;\n            case 6:\n                return this._gl.LINE_STRIP;\n            case 7:\n                return this._gl.TRIANGLE_STRIP;\n            case 8:\n                return this._gl.TRIANGLE_FAN;\n            default:\n                return this._gl.TRIANGLES;\n        }\n    };\n    /** @hidden */\n    ThinEngine.prototype._reportDrawCall = function () {\n        // Will be implemented by children\n    };\n    // Shaders\n    /**\n     * @param effect\n     * @hidden\n     */\n    ThinEngine.prototype._releaseEffect = function (effect) {\n        if (this._compiledEffects[effect._key]) {\n            delete this._compiledEffects[effect._key];\n            var pipelineContext = effect.getPipelineContext();\n            if (pipelineContext) {\n                this._deletePipelineContext(pipelineContext);\n            }\n        }\n    };\n    /**\n     * @param pipelineContext\n     * @hidden\n     */\n    ThinEngine.prototype._deletePipelineContext = function (pipelineContext) {\n        var webGLPipelineContext = pipelineContext;\n        if (webGLPipelineContext && webGLPipelineContext.program) {\n            webGLPipelineContext.program.__SPECTOR_rebuildProgram = null;\n            this._gl.deleteProgram(webGLPipelineContext.program);\n        }\n    };\n    /** @hidden */\n    ThinEngine.prototype._getGlobalDefines = function (defines) {\n        if (defines) {\n            if (this.isNDCHalfZRange) {\n                defines[\"IS_NDC_HALF_ZRANGE\"] = \"\";\n            }\n            else {\n                delete defines[\"IS_NDC_HALF_ZRANGE\"];\n            }\n            if (this.useReverseDepthBuffer) {\n                defines[\"USE_REVERSE_DEPTHBUFFER\"] = \"\";\n            }\n            else {\n                delete defines[\"USE_REVERSE_DEPTHBUFFER\"];\n            }\n            return;\n        }\n        else {\n            var s = \"\";\n            if (this.isNDCHalfZRange) {\n                s += \"#define IS_NDC_HALF_ZRANGE\";\n            }\n            if (this.useReverseDepthBuffer) {\n                if (s) {\n                    s += \"\\n\";\n                }\n                s += \"#define USE_REVERSE_DEPTHBUFFER\";\n            }\n            return s;\n        }\n    };\n    /**\n     * Create a new effect (used to store vertex/fragment shaders)\n     * @param baseName defines the base name of the effect (The name of file without .fragment.fx or .vertex.fx)\n     * @param attributesNamesOrOptions defines either a list of attribute names or an IEffectCreationOptions object\n     * @param uniformsNamesOrEngine defines either a list of uniform names or the engine to use\n     * @param samplers defines an array of string used to represent textures\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param fallbacks defines the list of potential fallbacks to use if shader compilation fails\n     * @param onCompiled defines a function to call when the effect creation is successful\n     * @param onError defines a function to call when the effect creation has failed\n     * @param indexParameters defines an object containing the index values to use to compile shaders (like the maximum number of simultaneous lights)\n     * @param shaderLanguage the language the shader is written in (default: GLSL)\n     * @returns the new Effect\n     */\n    ThinEngine.prototype.createEffect = function (baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, defines, fallbacks, onCompiled, onError, indexParameters, shaderLanguage) {\n        var _a;\n        if (shaderLanguage === void 0) { shaderLanguage = ShaderLanguage.GLSL; }\n        var vertex = baseName.vertexElement || baseName.vertex || baseName.vertexToken || baseName.vertexSource || baseName;\n        var fragment = baseName.fragmentElement || baseName.fragment || baseName.fragmentToken || baseName.fragmentSource || baseName;\n        var globalDefines = this._getGlobalDefines();\n        var fullDefines = (_a = defines !== null && defines !== void 0 ? defines : attributesNamesOrOptions.defines) !== null && _a !== void 0 ? _a : \"\";\n        if (globalDefines) {\n            fullDefines += globalDefines;\n        }\n        var name = vertex + \"+\" + fragment + \"@\" + fullDefines;\n        if (this._compiledEffects[name]) {\n            var compiledEffect = this._compiledEffects[name];\n            if (onCompiled && compiledEffect.isReady()) {\n                onCompiled(compiledEffect);\n            }\n            return compiledEffect;\n        }\n        var effect = new Effect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, this, defines, fallbacks, onCompiled, onError, indexParameters, name, shaderLanguage);\n        this._compiledEffects[name] = effect;\n        return effect;\n    };\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    ThinEngine._ConcatenateShader = function (source, defines, shaderVersion) {\n        if (shaderVersion === void 0) { shaderVersion = \"\"; }\n        return shaderVersion + (defines ? defines + \"\\n\" : \"\") + source;\n    };\n    ThinEngine.prototype._compileShader = function (source, type, defines, shaderVersion) {\n        return this._compileRawShader(ThinEngine._ConcatenateShader(source, defines, shaderVersion), type);\n    };\n    ThinEngine.prototype._compileRawShader = function (source, type) {\n        var gl = this._gl;\n        var shader = gl.createShader(type === \"vertex\" ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER);\n        if (!shader) {\n            var error = gl.NO_ERROR;\n            var tempError = gl.NO_ERROR;\n            while ((tempError = gl.getError()) !== gl.NO_ERROR) {\n                error = tempError;\n            }\n            throw new Error(\"Something went wrong while creating a gl \".concat(type, \" shader object. gl error=\").concat(error, \", gl isContextLost=\").concat(gl.isContextLost(), \", _contextWasLost=\").concat(this._contextWasLost));\n        }\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n        return shader;\n    };\n    /**\n     * @param shader\n     * @hidden\n     */\n    ThinEngine.prototype._getShaderSource = function (shader) {\n        return this._gl.getShaderSource(shader);\n    };\n    /**\n     * Directly creates a webGL program\n     * @param pipelineContext  defines the pipeline context to attach to\n     * @param vertexCode defines the vertex shader code to use\n     * @param fragmentCode defines the fragment shader code to use\n     * @param context defines the webGL context to use (if not set, the current one will be used)\n     * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n     * @returns the new webGL program\n     */\n    ThinEngine.prototype.createRawShaderProgram = function (pipelineContext, vertexCode, fragmentCode, context, transformFeedbackVaryings) {\n        if (transformFeedbackVaryings === void 0) { transformFeedbackVaryings = null; }\n        context = context || this._gl;\n        var vertexShader = this._compileRawShader(vertexCode, \"vertex\");\n        var fragmentShader = this._compileRawShader(fragmentCode, \"fragment\");\n        return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n    };\n    /**\n     * Creates a webGL program\n     * @param pipelineContext  defines the pipeline context to attach to\n     * @param vertexCode  defines the vertex shader code to use\n     * @param fragmentCode defines the fragment shader code to use\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param context defines the webGL context to use (if not set, the current one will be used)\n     * @param transformFeedbackVaryings defines the list of transform feedback varyings to use\n     * @returns the new webGL program\n     */\n    ThinEngine.prototype.createShaderProgram = function (pipelineContext, vertexCode, fragmentCode, defines, context, transformFeedbackVaryings) {\n        if (transformFeedbackVaryings === void 0) { transformFeedbackVaryings = null; }\n        context = context || this._gl;\n        var shaderVersion = this._webGLVersion > 1 ? \"#version 300 es\\n#define WEBGL2 \\n\" : \"\";\n        var vertexShader = this._compileShader(vertexCode, \"vertex\", defines, shaderVersion);\n        var fragmentShader = this._compileShader(fragmentCode, \"fragment\", defines, shaderVersion);\n        return this._createShaderProgram(pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings);\n    };\n    /**\n     * Inline functions in shader code that are marked to be inlined\n     * @param code code to inline\n     * @returns inlined code\n     */\n    ThinEngine.prototype.inlineShaderCode = function (code) {\n        // no inlining needed in the WebGL engine\n        return code;\n    };\n    /**\n     * Creates a new pipeline context\n     * @param shaderProcessingContext defines the shader processing context used during the processing if available\n     * @returns the new pipeline\n     */\n    ThinEngine.prototype.createPipelineContext = function (shaderProcessingContext) {\n        var pipelineContext = new WebGLPipelineContext();\n        pipelineContext.engine = this;\n        if (this._caps.parallelShaderCompile) {\n            pipelineContext.isParallelCompiled = true;\n        }\n        return pipelineContext;\n    };\n    /**\n     * Creates a new material context\n     * @returns the new context\n     */\n    ThinEngine.prototype.createMaterialContext = function () {\n        return undefined;\n    };\n    /**\n     * Creates a new draw context\n     * @returns the new context\n     */\n    ThinEngine.prototype.createDrawContext = function () {\n        return undefined;\n    };\n    ThinEngine.prototype._createShaderProgram = function (pipelineContext, vertexShader, fragmentShader, context, transformFeedbackVaryings) {\n        if (transformFeedbackVaryings === void 0) { transformFeedbackVaryings = null; }\n        var shaderProgram = context.createProgram();\n        pipelineContext.program = shaderProgram;\n        if (!shaderProgram) {\n            throw new Error(\"Unable to create program\");\n        }\n        context.attachShader(shaderProgram, vertexShader);\n        context.attachShader(shaderProgram, fragmentShader);\n        context.linkProgram(shaderProgram);\n        pipelineContext.context = context;\n        pipelineContext.vertexShader = vertexShader;\n        pipelineContext.fragmentShader = fragmentShader;\n        if (!pipelineContext.isParallelCompiled) {\n            this._finalizePipelineContext(pipelineContext);\n        }\n        return shaderProgram;\n    };\n    ThinEngine.prototype._finalizePipelineContext = function (pipelineContext) {\n        var context = pipelineContext.context;\n        var vertexShader = pipelineContext.vertexShader;\n        var fragmentShader = pipelineContext.fragmentShader;\n        var program = pipelineContext.program;\n        var linked = context.getProgramParameter(program, context.LINK_STATUS);\n        if (!linked) {\n            // Get more info\n            // Vertex\n            if (!this._gl.getShaderParameter(vertexShader, this._gl.COMPILE_STATUS)) {\n                var log = this._gl.getShaderInfoLog(vertexShader);\n                if (log) {\n                    pipelineContext.vertexCompilationError = log;\n                    throw new Error(\"VERTEX SHADER \" + log);\n                }\n            }\n            // Fragment\n            if (!this._gl.getShaderParameter(fragmentShader, this._gl.COMPILE_STATUS)) {\n                var log = this._gl.getShaderInfoLog(fragmentShader);\n                if (log) {\n                    pipelineContext.fragmentCompilationError = log;\n                    throw new Error(\"FRAGMENT SHADER \" + log);\n                }\n            }\n            var error = context.getProgramInfoLog(program);\n            if (error) {\n                pipelineContext.programLinkError = error;\n                throw new Error(error);\n            }\n        }\n        if (this.validateShaderPrograms) {\n            context.validateProgram(program);\n            var validated = context.getProgramParameter(program, context.VALIDATE_STATUS);\n            if (!validated) {\n                var error = context.getProgramInfoLog(program);\n                if (error) {\n                    pipelineContext.programValidationError = error;\n                    throw new Error(error);\n                }\n            }\n        }\n        context.deleteShader(vertexShader);\n        context.deleteShader(fragmentShader);\n        pipelineContext.vertexShader = undefined;\n        pipelineContext.fragmentShader = undefined;\n        if (pipelineContext.onCompiled) {\n            pipelineContext.onCompiled();\n            pipelineContext.onCompiled = undefined;\n        }\n    };\n    /**\n     * @param pipelineContext\n     * @param vertexSourceCode\n     * @param fragmentSourceCode\n     * @param createAsRaw\n     * @param rawVertexSourceCode\n     * @param rawFragmentSourceCode\n     * @param rebuildRebind\n     * @param defines\n     * @param transformFeedbackVaryings\n     * @param key\n     * @hidden\n     */\n    ThinEngine.prototype._preparePipelineContext = function (pipelineContext, vertexSourceCode, fragmentSourceCode, createAsRaw, rawVertexSourceCode, rawFragmentSourceCode, rebuildRebind, defines, transformFeedbackVaryings, key) {\n        var webGLRenderingState = pipelineContext;\n        if (createAsRaw) {\n            webGLRenderingState.program = this.createRawShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, undefined, transformFeedbackVaryings);\n        }\n        else {\n            webGLRenderingState.program = this.createShaderProgram(webGLRenderingState, vertexSourceCode, fragmentSourceCode, defines, undefined, transformFeedbackVaryings);\n        }\n        webGLRenderingState.program.__SPECTOR_rebuildProgram = rebuildRebind;\n    };\n    /**\n     * @param pipelineContext\n     * @hidden\n     */\n    ThinEngine.prototype._isRenderingStateCompiled = function (pipelineContext) {\n        var webGLPipelineContext = pipelineContext;\n        if (this._gl.getProgramParameter(webGLPipelineContext.program, this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)) {\n            this._finalizePipelineContext(webGLPipelineContext);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param pipelineContext\n     * @param action\n     * @hidden\n     */\n    ThinEngine.prototype._executeWhenRenderingStateIsCompiled = function (pipelineContext, action) {\n        var webGLPipelineContext = pipelineContext;\n        if (!webGLPipelineContext.isParallelCompiled) {\n            action();\n            return;\n        }\n        var oldHandler = webGLPipelineContext.onCompiled;\n        if (oldHandler) {\n            webGLPipelineContext.onCompiled = function () {\n                oldHandler();\n                action();\n            };\n        }\n        else {\n            webGLPipelineContext.onCompiled = action;\n        }\n    };\n    /**\n     * Gets the list of webGL uniform locations associated with a specific program based on a list of uniform names\n     * @param pipelineContext defines the pipeline context to use\n     * @param uniformsNames defines the list of uniform names\n     * @returns an array of webGL uniform locations\n     */\n    ThinEngine.prototype.getUniforms = function (pipelineContext, uniformsNames) {\n        var results = new Array();\n        var webGLPipelineContext = pipelineContext;\n        for (var index = 0; index < uniformsNames.length; index++) {\n            results.push(this._gl.getUniformLocation(webGLPipelineContext.program, uniformsNames[index]));\n        }\n        return results;\n    };\n    /**\n     * Gets the list of active attributes for a given webGL program\n     * @param pipelineContext defines the pipeline context to use\n     * @param attributesNames defines the list of attribute names to get\n     * @returns an array of indices indicating the offset of each attribute\n     */\n    ThinEngine.prototype.getAttributes = function (pipelineContext, attributesNames) {\n        var results = [];\n        var webGLPipelineContext = pipelineContext;\n        for (var index = 0; index < attributesNames.length; index++) {\n            try {\n                results.push(this._gl.getAttribLocation(webGLPipelineContext.program, attributesNames[index]));\n            }\n            catch (e) {\n                results.push(-1);\n            }\n        }\n        return results;\n    };\n    /**\n     * Activates an effect, making it the current one (ie. the one used for rendering)\n     * @param effect defines the effect to activate\n     */\n    ThinEngine.prototype.enableEffect = function (effect) {\n        effect = effect !== null && DrawWrapper.IsWrapper(effect) ? effect.effect : effect; // get only the effect, we don't need a Wrapper in the WebGL engine\n        if (!effect || effect === this._currentEffect) {\n            return;\n        }\n        this._stencilStateComposer.stencilMaterial = undefined;\n        effect = effect;\n        // Use program\n        this.bindSamplers(effect);\n        this._currentEffect = effect;\n        if (effect.onBind) {\n            effect.onBind(effect);\n        }\n        if (effect._onBindObservable) {\n            effect._onBindObservable.notifyObservers(effect);\n        }\n    };\n    /**\n     * Set the value of an uniform to a number (int)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the int number to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setInt = function (uniform, value) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform1i(uniform, value);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a int2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setInt2 = function (uniform, x, y) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform2i(uniform, x, y);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a int3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setInt3 = function (uniform, x, y, z) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform3i(uniform, x, y, z);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a int4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setInt4 = function (uniform, x, y, z, w) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform4i(uniform, x, y, z, w);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setIntArray = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform1iv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setIntArray2 = function (uniform, array) {\n        if (!uniform || array.length % 2 !== 0) {\n            return false;\n        }\n        this._gl.uniform2iv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setIntArray3 = function (uniform, array) {\n        if (!uniform || array.length % 3 !== 0) {\n            return false;\n        }\n        this._gl.uniform3iv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of int32 (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of int32 to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setIntArray4 = function (uniform, array) {\n        if (!uniform || array.length % 4 !== 0) {\n            return false;\n        }\n        this._gl.uniform4iv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setArray = function (uniform, array) {\n        if (!uniform) {\n            return false;\n        }\n        if (array.length < 1) {\n            return false;\n        }\n        this._gl.uniform1fv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number (stored as vec2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setArray2 = function (uniform, array) {\n        if (!uniform || array.length % 2 !== 0) {\n            return false;\n        }\n        this._gl.uniform2fv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number (stored as vec3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setArray3 = function (uniform, array) {\n        if (!uniform || array.length % 3 !== 0) {\n            return false;\n        }\n        this._gl.uniform3fv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of number (stored as vec4)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param array defines the array of number to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setArray4 = function (uniform, array) {\n        if (!uniform || array.length % 4 !== 0) {\n            return false;\n        }\n        this._gl.uniform4fv(uniform, array);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to an array of float32 (stored as matrices)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrices defines the array of float32 to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setMatrices = function (uniform, matrices) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniformMatrix4fv(uniform, false, matrices);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a matrix (3x3)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 3x3 matrix to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setMatrix3x3 = function (uniform, matrix) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniformMatrix3fv(uniform, false, matrix);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a matrix (2x2)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param matrix defines the Float32Array representing the 2x2 matrix to store\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setMatrix2x2 = function (uniform, matrix) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniformMatrix2fv(uniform, false, matrix);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a number (float)\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param value defines the float number to store\n     * @returns true if the value was transferred\n     */\n    ThinEngine.prototype.setFloat = function (uniform, value) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform1f(uniform, value);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a vec2\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setFloat2 = function (uniform, x, y) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform2f(uniform, x, y);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a vec3\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setFloat3 = function (uniform, x, y, z) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform3f(uniform, x, y, z);\n        return true;\n    };\n    /**\n     * Set the value of an uniform to a vec4\n     * @param uniform defines the webGL uniform location where to store the value\n     * @param x defines the 1st component of the value\n     * @param y defines the 2nd component of the value\n     * @param z defines the 3rd component of the value\n     * @param w defines the 4th component of the value\n     * @returns true if the value was set\n     */\n    ThinEngine.prototype.setFloat4 = function (uniform, x, y, z, w) {\n        if (!uniform) {\n            return false;\n        }\n        this._gl.uniform4f(uniform, x, y, z, w);\n        return true;\n    };\n    // States\n    /**\n     * Apply all cached states (depth, culling, stencil and alpha)\n     */\n    ThinEngine.prototype.applyStates = function () {\n        this._depthCullingState.apply(this._gl);\n        this._stencilStateComposer.apply(this._gl);\n        this._alphaState.apply(this._gl);\n        if (this._colorWriteChanged) {\n            this._colorWriteChanged = false;\n            var enable = this._colorWrite;\n            this._gl.colorMask(enable, enable, enable, enable);\n        }\n    };\n    /**\n     * Enable or disable color writing\n     * @param enable defines the state to set\n     */\n    ThinEngine.prototype.setColorWrite = function (enable) {\n        if (enable !== this._colorWrite) {\n            this._colorWriteChanged = true;\n            this._colorWrite = enable;\n        }\n    };\n    /**\n     * Gets a boolean indicating if color writing is enabled\n     * @returns the current color writing state\n     */\n    ThinEngine.prototype.getColorWrite = function () {\n        return this._colorWrite;\n    };\n    Object.defineProperty(ThinEngine.prototype, \"depthCullingState\", {\n        /**\n         * Gets the depth culling state manager\n         */\n        get: function () {\n            return this._depthCullingState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"alphaState\", {\n        /**\n         * Gets the alpha state manager\n         */\n        get: function () {\n            return this._alphaState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"stencilState\", {\n        /**\n         * Gets the stencil state manager\n         */\n        get: function () {\n            return this._stencilState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine.prototype, \"stencilStateComposer\", {\n        /**\n         * Gets the stencil state composer\n         */\n        get: function () {\n            return this._stencilStateComposer;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    // Textures\n    /**\n     * Clears the list of texture accessible through engine.\n     * This can help preventing texture load conflict due to name collision.\n     */\n    ThinEngine.prototype.clearInternalTexturesCache = function () {\n        this._internalTexturesCache = [];\n    };\n    /**\n     * Force the entire cache to be cleared\n     * You should not have to use this function unless your engine needs to share the webGL context with another engine\n     * @param bruteForce defines a boolean to force clearing ALL caches (including stencil, detoh and alpha states)\n     */\n    ThinEngine.prototype.wipeCaches = function (bruteForce) {\n        if (this.preventCacheWipeBetweenFrames && !bruteForce) {\n            return;\n        }\n        this._currentEffect = null;\n        this._viewportCached.x = 0;\n        this._viewportCached.y = 0;\n        this._viewportCached.z = 0;\n        this._viewportCached.w = 0;\n        // Done before in case we clean the attributes\n        this._unbindVertexArrayObject();\n        if (bruteForce) {\n            this._currentProgram = null;\n            this.resetTextureCache();\n            this._stencilStateComposer.reset();\n            this._depthCullingState.reset();\n            this._depthCullingState.depthFunc = this._gl.LEQUAL;\n            this._alphaState.reset();\n            this._alphaMode = 1;\n            this._alphaEquation = 0;\n            this._colorWrite = true;\n            this._colorWriteChanged = true;\n            this._unpackFlipYCached = null;\n            this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._gl.NONE);\n            this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\n            this._mustWipeVertexAttributes = true;\n            this.unbindAllAttributes();\n        }\n        this._resetVertexBufferBinding();\n        this._cachedIndexBuffer = null;\n        this._cachedEffectForVertexBuffers = null;\n        this.bindIndexBuffer(null);\n    };\n    /**\n     * @param samplingMode\n     * @param generateMipMaps\n     * @hidden\n     */\n    ThinEngine.prototype._getSamplingParameters = function (samplingMode, generateMipMaps) {\n        var gl = this._gl;\n        var magFilter = gl.NEAREST;\n        var minFilter = gl.NEAREST;\n        switch (samplingMode) {\n            case 11:\n                magFilter = gl.LINEAR;\n                if (generateMipMaps) {\n                    minFilter = gl.LINEAR_MIPMAP_NEAREST;\n                }\n                else {\n                    minFilter = gl.LINEAR;\n                }\n                break;\n            case 3:\n                magFilter = gl.LINEAR;\n                if (generateMipMaps) {\n                    minFilter = gl.LINEAR_MIPMAP_LINEAR;\n                }\n                else {\n                    minFilter = gl.LINEAR;\n                }\n                break;\n            case 8:\n                magFilter = gl.NEAREST;\n                if (generateMipMaps) {\n                    minFilter = gl.NEAREST_MIPMAP_LINEAR;\n                }\n                else {\n                    minFilter = gl.NEAREST;\n                }\n                break;\n            case 4:\n                magFilter = gl.NEAREST;\n                if (generateMipMaps) {\n                    minFilter = gl.NEAREST_MIPMAP_NEAREST;\n                }\n                else {\n                    minFilter = gl.NEAREST;\n                }\n                break;\n            case 5:\n                magFilter = gl.NEAREST;\n                if (generateMipMaps) {\n                    minFilter = gl.LINEAR_MIPMAP_NEAREST;\n                }\n                else {\n                    minFilter = gl.LINEAR;\n                }\n                break;\n            case 6:\n                magFilter = gl.NEAREST;\n                if (generateMipMaps) {\n                    minFilter = gl.LINEAR_MIPMAP_LINEAR;\n                }\n                else {\n                    minFilter = gl.LINEAR;\n                }\n                break;\n            case 7:\n                magFilter = gl.NEAREST;\n                minFilter = gl.LINEAR;\n                break;\n            case 1:\n                magFilter = gl.NEAREST;\n                minFilter = gl.NEAREST;\n                break;\n            case 9:\n                magFilter = gl.LINEAR;\n                if (generateMipMaps) {\n                    minFilter = gl.NEAREST_MIPMAP_NEAREST;\n                }\n                else {\n                    minFilter = gl.NEAREST;\n                }\n                break;\n            case 10:\n                magFilter = gl.LINEAR;\n                if (generateMipMaps) {\n                    minFilter = gl.NEAREST_MIPMAP_LINEAR;\n                }\n                else {\n                    minFilter = gl.NEAREST;\n                }\n                break;\n            case 2:\n                magFilter = gl.LINEAR;\n                minFilter = gl.LINEAR;\n                break;\n            case 12:\n                magFilter = gl.LINEAR;\n                minFilter = gl.NEAREST;\n                break;\n        }\n        return {\n            min: minFilter,\n            mag: magFilter,\n        };\n    };\n    /** @hidden */\n    ThinEngine.prototype._createTexture = function () {\n        var texture = this._gl.createTexture();\n        if (!texture) {\n            throw new Error(\"Unable to create texture\");\n        }\n        return texture;\n    };\n    /** @hidden */\n    ThinEngine.prototype._createHardwareTexture = function () {\n        return new WebGLHardwareTexture(this._createTexture(), this._gl);\n    };\n    /**\n     * Creates an internal texture without binding it to a framebuffer\n     * @hidden\n     * @param size defines the size of the texture\n     * @param options defines the options used to create the texture\n     * @param delayGPUTextureCreation true to delay the texture creation the first time it is really needed. false to create it right away\n     * @param source source type of the texture\n     * @returns a new internal texture\n     */\n    ThinEngine.prototype._createInternalTexture = function (size, options, delayGPUTextureCreation, source) {\n        if (delayGPUTextureCreation === void 0) { delayGPUTextureCreation = true; }\n        if (source === void 0) { source = InternalTextureSource.Unknown; }\n        var fullOptions = {};\n        if (options !== undefined && typeof options === \"object\") {\n            fullOptions.generateMipMaps = options.generateMipMaps;\n            fullOptions.type = options.type === undefined ? 0 : options.type;\n            fullOptions.samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n            fullOptions.format = options.format === undefined ? 5 : options.format;\n            fullOptions.useSRGBBuffer = options.useSRGBBuffer === undefined ? false : options.useSRGBBuffer;\n        }\n        else {\n            fullOptions.generateMipMaps = options;\n            fullOptions.type = 0;\n            fullOptions.samplingMode = 3;\n            fullOptions.format = 5;\n            fullOptions.useSRGBBuffer = false;\n        }\n        fullOptions.useSRGBBuffer = fullOptions.useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU);\n        if (fullOptions.type === 1 && !this._caps.textureFloatLinearFiltering) {\n            // if floating point linear (gl.FLOAT) then force to NEAREST_SAMPLINGMODE\n            fullOptions.samplingMode = 1;\n        }\n        else if (fullOptions.type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n            // if floating point linear (HALF_FLOAT) then force to NEAREST_SAMPLINGMODE\n            fullOptions.samplingMode = 1;\n        }\n        if (fullOptions.type === 1 && !this._caps.textureFloat) {\n            fullOptions.type = 0;\n            Logger.Warn(\"Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE\");\n        }\n        var gl = this._gl;\n        var texture = new InternalTexture(this, source);\n        texture._useSRGBBuffer = !!fullOptions.useSRGBBuffer;\n        var width = size.width || size;\n        var height = size.height || size;\n        var layers = size.layers || 0;\n        var filters = this._getSamplingParameters(fullOptions.samplingMode, fullOptions.generateMipMaps ? true : false);\n        var target = layers !== 0 ? gl.TEXTURE_2D_ARRAY : gl.TEXTURE_2D;\n        var sizedFormat = this._getRGBABufferInternalSizedFormat(fullOptions.type, fullOptions.format, fullOptions.useSRGBBuffer);\n        var internalFormat = this._getInternalFormat(fullOptions.format);\n        var type = this._getWebGLTextureType(fullOptions.type);\n        // Bind\n        this._bindTextureDirectly(target, texture);\n        if (layers !== 0) {\n            texture.is2DArray = true;\n            gl.texImage3D(target, 0, sizedFormat, width, height, layers, 0, internalFormat, type, null);\n        }\n        else {\n            gl.texImage2D(target, 0, sizedFormat, width, height, 0, internalFormat, type, null);\n        }\n        gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, filters.mag);\n        gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, filters.min);\n        gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        // MipMaps\n        if (fullOptions.generateMipMaps) {\n            this._gl.generateMipmap(target);\n        }\n        this._bindTextureDirectly(target, null);\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = width;\n        texture.height = height;\n        texture.depth = layers;\n        texture.isReady = true;\n        texture.samples = 1;\n        texture.generateMipMaps = fullOptions.generateMipMaps ? true : false;\n        texture.samplingMode = fullOptions.samplingMode;\n        texture.type = fullOptions.type;\n        texture.format = fullOptions.format;\n        this._internalTexturesCache.push(texture);\n        return texture;\n    };\n    /**\n     * @param useSRGBBuffer\n     * @param noMipmap\n     * @hidden\n     */\n    ThinEngine.prototype._getUseSRGBBuffer = function (useSRGBBuffer, noMipmap) {\n        // Generating mipmaps for sRGB textures is not supported in WebGL1 so we must disable the support if mipmaps is enabled\n        return useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU || noMipmap);\n    };\n    ThinEngine.prototype._createTextureBase = function (url, noMipmap, invertY, scene, samplingMode, onLoad, onError, prepareTexture, prepareTextureProcessFunction, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer) {\n        var _this = this;\n        if (samplingMode === void 0) { samplingMode = 3; }\n        if (onLoad === void 0) { onLoad = null; }\n        if (onError === void 0) { onError = null; }\n        if (buffer === void 0) { buffer = null; }\n        if (fallback === void 0) { fallback = null; }\n        if (format === void 0) { format = null; }\n        if (forcedExtension === void 0) { forcedExtension = null; }\n        url = url || \"\";\n        var fromData = url.substr(0, 5) === \"data:\";\n        var fromBlob = url.substr(0, 5) === \"blob:\";\n        var isBase64 = fromData && url.indexOf(\";base64,\") !== -1;\n        var texture = fallback ? fallback : new InternalTexture(this, InternalTextureSource.Url);\n        var originalUrl = url;\n        if (this._transformTextureUrl && !isBase64 && !fallback && !buffer) {\n            url = this._transformTextureUrl(url);\n        }\n        if (originalUrl !== url) {\n            texture._originalUrl = originalUrl;\n        }\n        // establish the file extension, if possible\n        var lastDot = url.lastIndexOf(\".\");\n        var extension = forcedExtension ? forcedExtension : lastDot > -1 ? url.substring(lastDot).toLowerCase() : \"\";\n        var loader = null;\n        // Remove query string\n        var queryStringIndex = extension.indexOf(\"?\");\n        if (queryStringIndex > -1) {\n            extension = extension.split(\"?\")[0];\n        }\n        for (var _i = 0, _a = ThinEngine._TextureLoaders; _i < _a.length; _i++) {\n            var availableLoader = _a[_i];\n            if (availableLoader.canLoad(extension, mimeType)) {\n                loader = availableLoader;\n                break;\n            }\n        }\n        if (scene) {\n            scene._addPendingData(texture);\n        }\n        texture.url = url;\n        texture.generateMipMaps = !noMipmap;\n        texture.samplingMode = samplingMode;\n        texture.invertY = invertY;\n        texture._useSRGBBuffer = this._getUseSRGBBuffer(!!useSRGBBuffer, noMipmap);\n        if (!this._doNotHandleContextLost) {\n            // Keep a link to the buffer only if we plan to handle context lost\n            texture._buffer = buffer;\n        }\n        var onLoadObserver = null;\n        if (onLoad && !fallback) {\n            onLoadObserver = texture.onLoadedObservable.add(onLoad);\n        }\n        if (!fallback) {\n            this._internalTexturesCache.push(texture);\n        }\n        var onInternalError = function (message, exception) {\n            if (scene) {\n                scene._removePendingData(texture);\n            }\n            if (url === originalUrl) {\n                if (onLoadObserver) {\n                    texture.onLoadedObservable.remove(onLoadObserver);\n                }\n                if (EngineStore.UseFallbackTexture) {\n                    _this._createTextureBase(EngineStore.FallbackTexture, noMipmap, texture.invertY, scene, samplingMode, null, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture);\n                }\n                message = (message || \"Unknown error\") + (EngineStore.UseFallbackTexture ? \" - Fallback texture was used\" : \"\");\n                texture.onErrorObservable.notifyObservers({ message: message, exception: exception });\n                if (onError) {\n                    onError(message, exception);\n                }\n            }\n            else {\n                // fall back to the original url if the transformed url fails to load\n                Logger.Warn(\"Failed to load \".concat(url, \", falling back to \").concat(originalUrl));\n                _this._createTextureBase(originalUrl, noMipmap, texture.invertY, scene, samplingMode, onLoad, onError, prepareTexture, prepareTextureProcessFunction, buffer, texture, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n            }\n        };\n        // processing for non-image formats\n        if (loader) {\n            var callback_1 = function (data) {\n                loader.loadData(data, texture, function (width, height, loadMipmap, isCompressed, done, loadFailed) {\n                    if (loadFailed) {\n                        onInternalError(\"TextureLoader failed to load data\");\n                    }\n                    else {\n                        prepareTexture(texture, extension, scene, { width: width, height: height }, texture.invertY, !loadMipmap, isCompressed, function () {\n                            done();\n                            return false;\n                        }, samplingMode);\n                    }\n                }, loaderOptions);\n            };\n            if (!buffer) {\n                this._loadFile(url, function (data) { return callback_1(new Uint8Array(data)); }, undefined, scene ? scene.offlineProvider : undefined, true, function (request, exception) {\n                    onInternalError(\"Unable to load \" + (request ? request.responseURL : url, exception));\n                });\n            }\n            else {\n                if (buffer instanceof ArrayBuffer) {\n                    callback_1(new Uint8Array(buffer));\n                }\n                else if (ArrayBuffer.isView(buffer)) {\n                    callback_1(buffer);\n                }\n                else {\n                    if (onError) {\n                        onError(\"Unable to load: only ArrayBuffer or ArrayBufferView is supported\", null);\n                    }\n                }\n            }\n        }\n        else {\n            var onload_1 = function (img) {\n                if (fromBlob && !_this._doNotHandleContextLost) {\n                    // We need to store the image if we need to rebuild the texture\n                    // in case of a webgl context lost\n                    texture._buffer = img;\n                }\n                prepareTexture(texture, extension, scene, img, texture.invertY, noMipmap, false, prepareTextureProcessFunction, samplingMode);\n            };\n            // According to the WebGL spec section 6.10, ImageBitmaps must be inverted on creation.\n            // So, we pass imageOrientation to _FileToolsLoadImage() as it may create an ImageBitmap.\n            if (!fromData || isBase64) {\n                if (buffer && (typeof buffer.decoding === \"string\" || buffer.close)) {\n                    onload_1(buffer);\n                }\n                else {\n                    ThinEngine._FileToolsLoadImage(url, onload_1, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? { imageOrientation: \"flipY\" } : undefined);\n                }\n            }\n            else if (typeof buffer === \"string\" || buffer instanceof ArrayBuffer || ArrayBuffer.isView(buffer) || buffer instanceof Blob) {\n                ThinEngine._FileToolsLoadImage(buffer, onload_1, onInternalError, scene ? scene.offlineProvider : null, mimeType, texture.invertY && this._features.needsInvertingBitmap ? { imageOrientation: \"flipY\" } : undefined);\n            }\n            else if (buffer) {\n                onload_1(buffer);\n            }\n        }\n        return texture;\n    };\n    /**\n     * Usually called from Texture.ts.\n     * Passed information to create a WebGLTexture\n     * @param url defines a value which contains one of the following:\n     * * A conventional http URL, e.g. 'http://...' or 'file://...'\n     * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n     * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n     * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n     * @param scene needed for loading to the correct scene\n     * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n     * @param onLoad optional callback to be called upon successful completion\n     * @param onError optional callback to be called upon failure\n     * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n     * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n     * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param mimeType defines an optional mime type\n     * @param loaderOptions options to be passed to the loader\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns a InternalTexture for assignment back into BABYLON.Texture\n     */\n    ThinEngine.prototype.createTexture = function (url, noMipmap, invertY, scene, samplingMode, onLoad, onError, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, creationFlags, useSRGBBuffer) {\n        var _this = this;\n        if (samplingMode === void 0) { samplingMode = 3; }\n        if (onLoad === void 0) { onLoad = null; }\n        if (onError === void 0) { onError = null; }\n        if (buffer === void 0) { buffer = null; }\n        if (fallback === void 0) { fallback = null; }\n        if (format === void 0) { format = null; }\n        if (forcedExtension === void 0) { forcedExtension = null; }\n        return this._createTextureBase(url, noMipmap, invertY, scene, samplingMode, onLoad, onError, this._prepareWebGLTexture.bind(this), function (potWidth, potHeight, img, extension, texture, continuationCallback) {\n            var gl = _this._gl;\n            var isPot = img.width === potWidth && img.height === potHeight;\n            var internalFormat = format\n                ? _this._getInternalFormat(format, texture._useSRGBBuffer)\n                : extension === \".jpg\" && !texture._useSRGBBuffer\n                    ? gl.RGB\n                    : texture._useSRGBBuffer\n                        ? gl.SRGB8_ALPHA8\n                        : gl.RGBA;\n            var texelFormat = format ? _this._getInternalFormat(format) : extension === \".jpg\" && !texture._useSRGBBuffer ? gl.RGB : gl.RGBA;\n            if (texture._useSRGBBuffer && _this.webGLVersion === 1) {\n                texelFormat = internalFormat;\n            }\n            if (isPot) {\n                gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, img);\n                return false;\n            }\n            var maxTextureSize = _this._caps.maxTextureSize;\n            if (img.width > maxTextureSize || img.height > maxTextureSize || !_this._supportsHardwareTextureRescaling) {\n                _this._prepareWorkingCanvas();\n                if (!_this._workingCanvas || !_this._workingContext) {\n                    return false;\n                }\n                _this._workingCanvas.width = potWidth;\n                _this._workingCanvas.height = potHeight;\n                _this._workingContext.drawImage(img, 0, 0, img.width, img.height, 0, 0, potWidth, potHeight);\n                gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, _this._workingCanvas);\n                texture.width = potWidth;\n                texture.height = potHeight;\n                return false;\n            }\n            else {\n                // Using shaders when possible to rescale because canvas.drawImage is lossy\n                var source_1 = new InternalTexture(_this, InternalTextureSource.Temp);\n                _this._bindTextureDirectly(gl.TEXTURE_2D, source_1, true);\n                gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, texelFormat, gl.UNSIGNED_BYTE, img);\n                _this._rescaleTexture(source_1, texture, scene, internalFormat, function () {\n                    _this._releaseTexture(source_1);\n                    _this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n                    continuationCallback();\n                });\n            }\n            return true;\n        }, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n    };\n    /**\n     * Loads an image as an HTMLImageElement.\n     * @param input url string, ArrayBuffer, or Blob to load\n     * @param onLoad callback called when the image successfully loads\n     * @param onError callback called when the image fails to load\n     * @param offlineProvider offline provider for caching\n     * @param mimeType optional mime type\n     * @param imageBitmapOptions optional the options to use when creating an ImageBitmap\n     * @returns the HTMLImageElement of the loaded image\n     * @hidden\n     */\n    ThinEngine._FileToolsLoadImage = function (input, onLoad, onError, offlineProvider, mimeType, imageBitmapOptions) {\n        throw _WarnImport(\"FileTools\");\n    };\n    /**\n     * @param source\n     * @param destination\n     * @param scene\n     * @param internalFormat\n     * @param onComplete\n     * @hidden\n     */\n    ThinEngine.prototype._rescaleTexture = function (source, destination, scene, internalFormat, onComplete) { };\n    /**\n     * Creates a raw texture\n     * @param data defines the data to store in the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param format defines the format of the data\n     * @param generateMipMaps defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (Texture.NEAREST_SAMPLINGMODE by default)\n     * @param compression defines the compression used (null by default)\n     * @param type defines the type fo the data (Engine.TEXTURETYPE_UNSIGNED_INT by default)\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns the raw texture inside an InternalTexture\n     */\n    ThinEngine.prototype.createRawTexture = function (data, width, height, format, generateMipMaps, invertY, samplingMode, compression, type, creationFlags, useSRGBBuffer) {\n        if (compression === void 0) { compression = null; }\n        if (type === void 0) { type = 0; }\n        if (creationFlags === void 0) { creationFlags = 0; }\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        throw _WarnImport(\"Engine.RawTexture\");\n    };\n    /**\n     * Creates a new raw cube texture\n     * @param data defines the array of data to use to create each face\n     * @param size defines the size of the textures\n     * @param format defines the format of the data\n     * @param type defines the type of the data (like Engine.TEXTURETYPE_UNSIGNED_INT)\n     * @param generateMipMaps  defines if the engine should generate the mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compression used (null by default)\n     * @returns the cube texture as an InternalTexture\n     */\n    ThinEngine.prototype.createRawCubeTexture = function (data, size, format, type, generateMipMaps, invertY, samplingMode, compression) {\n        if (compression === void 0) { compression = null; }\n        throw _WarnImport(\"Engine.RawTexture\");\n    };\n    /**\n     * Creates a new raw 3D texture\n     * @param data defines the data used to create the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param depth defines the depth of the texture\n     * @param format defines the format of the texture\n     * @param generateMipMaps defines if the engine must generate mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compressed used (can be null)\n     * @param textureType defines the compressed used (can be null)\n     * @returns a new raw 3D texture (stored in an InternalTexture)\n     */\n    ThinEngine.prototype.createRawTexture3D = function (data, width, height, depth, format, generateMipMaps, invertY, samplingMode, compression, textureType) {\n        if (compression === void 0) { compression = null; }\n        if (textureType === void 0) { textureType = 0; }\n        throw _WarnImport(\"Engine.RawTexture\");\n    };\n    /**\n     * Creates a new raw 2D array texture\n     * @param data defines the data used to create the texture\n     * @param width defines the width of the texture\n     * @param height defines the height of the texture\n     * @param depth defines the number of layers of the texture\n     * @param format defines the format of the texture\n     * @param generateMipMaps defines if the engine must generate mip levels\n     * @param invertY defines if data must be stored with Y axis inverted\n     * @param samplingMode defines the required sampling mode (like Texture.NEAREST_SAMPLINGMODE)\n     * @param compression defines the compressed used (can be null)\n     * @param textureType defines the compressed used (can be null)\n     * @returns a new raw 2D array texture (stored in an InternalTexture)\n     */\n    ThinEngine.prototype.createRawTexture2DArray = function (data, width, height, depth, format, generateMipMaps, invertY, samplingMode, compression, textureType) {\n        if (compression === void 0) { compression = null; }\n        if (textureType === void 0) { textureType = 0; }\n        throw _WarnImport(\"Engine.RawTexture\");\n    };\n    /**\n     * @param value\n     * @hidden\n     */\n    ThinEngine.prototype._unpackFlipY = function (value) {\n        if (this._unpackFlipYCached !== value) {\n            this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, value ? 1 : 0);\n            if (this.enableUnpackFlipYCached) {\n                this._unpackFlipYCached = value;\n            }\n        }\n    };\n    /** @hidden */\n    ThinEngine.prototype._getUnpackAlignement = function () {\n        return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT);\n    };\n    ThinEngine.prototype._getTextureTarget = function (texture) {\n        if (texture.isCube) {\n            return this._gl.TEXTURE_CUBE_MAP;\n        }\n        else if (texture.is3D) {\n            return this._gl.TEXTURE_3D;\n        }\n        else if (texture.is2DArray || texture.isMultiview) {\n            return this._gl.TEXTURE_2D_ARRAY;\n        }\n        return this._gl.TEXTURE_2D;\n    };\n    /**\n     * Update the sampling mode of a given texture\n     * @param samplingMode defines the required sampling mode\n     * @param texture defines the texture to update\n     * @param generateMipMaps defines whether to generate mipmaps for the texture\n     */\n    ThinEngine.prototype.updateTextureSamplingMode = function (samplingMode, texture, generateMipMaps) {\n        if (generateMipMaps === void 0) { generateMipMaps = false; }\n        var target = this._getTextureTarget(texture);\n        var filters = this._getSamplingParameters(samplingMode, texture.generateMipMaps || generateMipMaps);\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_MAG_FILTER, filters.mag, texture);\n        this._setTextureParameterInteger(target, this._gl.TEXTURE_MIN_FILTER, filters.min);\n        if (generateMipMaps) {\n            texture.generateMipMaps = true;\n            this._gl.generateMipmap(target);\n        }\n        this._bindTextureDirectly(target, null);\n        texture.samplingMode = samplingMode;\n    };\n    /**\n     * Update the dimensions of a texture\n     * @param texture texture to update\n     * @param width new width of the texture\n     * @param height new height of the texture\n     * @param depth new depth of the texture\n     */\n    ThinEngine.prototype.updateTextureDimensions = function (texture, width, height, depth) {\n        if (depth === void 0) { depth = 1; }\n    };\n    /**\n     * Update the sampling mode of a given texture\n     * @param texture defines the texture to update\n     * @param wrapU defines the texture wrap mode of the u coordinates\n     * @param wrapV defines the texture wrap mode of the v coordinates\n     * @param wrapR defines the texture wrap mode of the r coordinates\n     */\n    ThinEngine.prototype.updateTextureWrappingMode = function (texture, wrapU, wrapV, wrapR) {\n        if (wrapV === void 0) { wrapV = null; }\n        if (wrapR === void 0) { wrapR = null; }\n        var target = this._getTextureTarget(texture);\n        if (wrapU !== null) {\n            this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(wrapU), texture);\n            texture._cachedWrapU = wrapU;\n        }\n        if (wrapV !== null) {\n            this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(wrapV), texture);\n            texture._cachedWrapV = wrapV;\n        }\n        if ((texture.is2DArray || texture.is3D) && wrapR !== null) {\n            this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(wrapR), texture);\n            texture._cachedWrapR = wrapR;\n        }\n        this._bindTextureDirectly(target, null);\n    };\n    /**\n     * @param internalTexture\n     * @param size\n     * @param generateStencil\n     * @param bilinearFiltering\n     * @param comparisonFunction\n     * @param samples\n     * @hidden\n     */\n    ThinEngine.prototype._setupDepthStencilTexture = function (internalTexture, size, generateStencil, bilinearFiltering, comparisonFunction, samples) {\n        if (samples === void 0) { samples = 1; }\n        var width = size.width || size;\n        var height = size.height || size;\n        var layers = size.layers || 0;\n        internalTexture.baseWidth = width;\n        internalTexture.baseHeight = height;\n        internalTexture.width = width;\n        internalTexture.height = height;\n        internalTexture.is2DArray = layers > 0;\n        internalTexture.depth = layers;\n        internalTexture.isReady = true;\n        internalTexture.samples = samples;\n        internalTexture.generateMipMaps = false;\n        internalTexture.samplingMode = bilinearFiltering ? 2 : 1;\n        internalTexture.type = 0;\n        internalTexture._comparisonFunction = comparisonFunction;\n        var gl = this._gl;\n        var target = this._getTextureTarget(internalTexture);\n        var samplingParameters = this._getSamplingParameters(internalTexture.samplingMode, false);\n        gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, samplingParameters.mag);\n        gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, samplingParameters.min);\n        gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        if (comparisonFunction === 0) {\n            gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, 515);\n            gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.NONE);\n        }\n        else {\n            gl.texParameteri(target, gl.TEXTURE_COMPARE_FUNC, comparisonFunction);\n            gl.texParameteri(target, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE);\n        }\n    };\n    /**\n     * @param texture\n     * @param internalFormat\n     * @param width\n     * @param height\n     * @param data\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    ThinEngine.prototype._uploadCompressedDataToTextureDirectly = function (texture, internalFormat, width, height, data, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        var gl = this._gl;\n        var target = gl.TEXTURE_2D;\n        if (texture.isCube) {\n            target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n        }\n        if (texture._useSRGBBuffer) {\n            switch (internalFormat) {\n                case 37492:\n                case 36196:\n                    // Note, if using ETC1 and sRGB is requested, this will use ETC2 if available.\n                    if (this._caps.etc2) {\n                        internalFormat = gl.COMPRESSED_SRGB8_ETC2;\n                    }\n                    else {\n                        texture._useSRGBBuffer = false;\n                    }\n                    break;\n                case 37496:\n                    if (this._caps.etc2) {\n                        internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;\n                    }\n                    else {\n                        texture._useSRGBBuffer = false;\n                    }\n                    break;\n                case 36492:\n                    internalFormat = gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;\n                    break;\n                case 37808:\n                    internalFormat = gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;\n                    break;\n                case 33776:\n                    if (this._caps.s3tc_srgb) {\n                        internalFormat = gl.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n                    }\n                    else {\n                        // S3TC sRGB extension not supported\n                        texture._useSRGBBuffer = false;\n                    }\n                    break;\n                case 33777:\n                    if (this._caps.s3tc_srgb) {\n                        internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n                    }\n                    else {\n                        // S3TC sRGB extension not supported\n                        texture._useSRGBBuffer = false;\n                    }\n                    break;\n                case 33779:\n                    if (this._caps.s3tc_srgb) {\n                        internalFormat = gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n                    }\n                    else {\n                        // S3TC sRGB extension not supported\n                        texture._useSRGBBuffer = false;\n                    }\n                    break;\n                default:\n                    // We don't support a sRGB format corresponding to internalFormat, so revert to non sRGB format\n                    texture._useSRGBBuffer = false;\n                    break;\n            }\n        }\n        this._gl.compressedTexImage2D(target, lod, internalFormat, width, height, 0, data);\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @param babylonInternalFormat\n     * @param useTextureWidthAndHeight\n     * @hidden\n     */\n    ThinEngine.prototype._uploadDataToTextureDirectly = function (texture, imageData, faceIndex, lod, babylonInternalFormat, useTextureWidthAndHeight) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        if (useTextureWidthAndHeight === void 0) { useTextureWidthAndHeight = false; }\n        var gl = this._gl;\n        var textureType = this._getWebGLTextureType(texture.type);\n        var format = this._getInternalFormat(texture.format);\n        var internalFormat = babylonInternalFormat === undefined\n            ? this._getRGBABufferInternalSizedFormat(texture.type, texture.format, texture._useSRGBBuffer)\n            : this._getInternalFormat(babylonInternalFormat, texture._useSRGBBuffer);\n        this._unpackFlipY(texture.invertY);\n        var target = gl.TEXTURE_2D;\n        if (texture.isCube) {\n            target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n        }\n        var lodMaxWidth = Math.round(Math.log(texture.width) * Math.LOG2E);\n        var lodMaxHeight = Math.round(Math.log(texture.height) * Math.LOG2E);\n        var width = useTextureWidthAndHeight ? texture.width : Math.pow(2, Math.max(lodMaxWidth - lod, 0));\n        var height = useTextureWidthAndHeight ? texture.height : Math.pow(2, Math.max(lodMaxHeight - lod, 0));\n        gl.texImage2D(target, lod, internalFormat, width, height, 0, format, textureType, imageData);\n    };\n    /**\n     * Update a portion of an internal texture\n     * @param texture defines the texture to update\n     * @param imageData defines the data to store into the texture\n     * @param xOffset defines the x coordinates of the update rectangle\n     * @param yOffset defines the y coordinates of the update rectangle\n     * @param width defines the width of the update rectangle\n     * @param height defines the height of the update rectangle\n     * @param faceIndex defines the face index if texture is a cube (0 by default)\n     * @param lod defines the lod level to update (0 by default)\n     * @param generateMipMaps defines whether to generate mipmaps or not\n     */\n    ThinEngine.prototype.updateTextureData = function (texture, imageData, xOffset, yOffset, width, height, faceIndex, lod, generateMipMaps) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        if (generateMipMaps === void 0) { generateMipMaps = false; }\n        var gl = this._gl;\n        var textureType = this._getWebGLTextureType(texture.type);\n        var format = this._getInternalFormat(texture.format);\n        this._unpackFlipY(texture.invertY);\n        var target = gl.TEXTURE_2D;\n        if (texture.isCube) {\n            target = gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex;\n        }\n        this._bindTextureDirectly(target, texture, true);\n        gl.texSubImage2D(target, lod, xOffset, yOffset, width, height, format, textureType, imageData);\n        if (generateMipMaps) {\n            this._gl.generateMipmap(target);\n        }\n        this._bindTextureDirectly(target, null);\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    ThinEngine.prototype._uploadArrayBufferViewToTexture = function (texture, imageData, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        var gl = this._gl;\n        var bindTarget = texture.isCube ? gl.TEXTURE_CUBE_MAP : gl.TEXTURE_2D;\n        this._bindTextureDirectly(bindTarget, texture, true);\n        this._uploadDataToTextureDirectly(texture, imageData, faceIndex, lod);\n        this._bindTextureDirectly(bindTarget, null, true);\n    };\n    ThinEngine.prototype._prepareWebGLTextureContinuation = function (texture, scene, noMipmap, isCompressed, samplingMode) {\n        var gl = this._gl;\n        if (!gl) {\n            return;\n        }\n        var filters = this._getSamplingParameters(samplingMode, !noMipmap);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filters.mag);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filters.min);\n        if (!noMipmap && !isCompressed) {\n            gl.generateMipmap(gl.TEXTURE_2D);\n        }\n        this._bindTextureDirectly(gl.TEXTURE_2D, null);\n        // this.resetTextureCache();\n        if (scene) {\n            scene._removePendingData(texture);\n        }\n        texture.onLoadedObservable.notifyObservers(texture);\n        texture.onLoadedObservable.clear();\n    };\n    ThinEngine.prototype._prepareWebGLTexture = function (texture, extension, scene, img, invertY, noMipmap, isCompressed, processFunction, samplingMode) {\n        var _this = this;\n        if (samplingMode === void 0) { samplingMode = 3; }\n        var maxTextureSize = this.getCaps().maxTextureSize;\n        var potWidth = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.width, maxTextureSize) : img.width);\n        var potHeight = Math.min(maxTextureSize, this.needPOTTextures ? ThinEngine.GetExponentOfTwo(img.height, maxTextureSize) : img.height);\n        var gl = this._gl;\n        if (!gl) {\n            return;\n        }\n        if (!texture._hardwareTexture) {\n            //  this.resetTextureCache();\n            if (scene) {\n                scene._removePendingData(texture);\n            }\n            return;\n        }\n        this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n        this._unpackFlipY(invertY === undefined ? true : invertY ? true : false);\n        texture.baseWidth = img.width;\n        texture.baseHeight = img.height;\n        texture.width = potWidth;\n        texture.height = potHeight;\n        texture.isReady = true;\n        if (processFunction(potWidth, potHeight, img, extension, texture, function () {\n            _this._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n        })) {\n            // Returning as texture needs extra async steps\n            return;\n        }\n        this._prepareWebGLTextureContinuation(texture, scene, noMipmap, isCompressed, samplingMode);\n    };\n    /**\n     * @param generateStencilBuffer\n     * @param generateDepthBuffer\n     * @param width\n     * @param height\n     * @param samples\n     * @hidden\n     */\n    ThinEngine.prototype._setupFramebufferDepthAttachments = function (generateStencilBuffer, generateDepthBuffer, width, height, samples) {\n        if (samples === void 0) { samples = 1; }\n        var gl = this._gl;\n        // Create the depth/stencil buffer\n        if (generateStencilBuffer && generateDepthBuffer) {\n            return this._createRenderBuffer(width, height, samples, gl.DEPTH_STENCIL, gl.DEPTH24_STENCIL8, gl.DEPTH_STENCIL_ATTACHMENT);\n        }\n        if (generateDepthBuffer) {\n            var depthFormat = gl.DEPTH_COMPONENT16;\n            if (this._webGLVersion > 1) {\n                depthFormat = gl.DEPTH_COMPONENT32F;\n            }\n            return this._createRenderBuffer(width, height, samples, depthFormat, depthFormat, gl.DEPTH_ATTACHMENT);\n        }\n        if (generateStencilBuffer) {\n            return this._createRenderBuffer(width, height, samples, gl.STENCIL_INDEX8, gl.STENCIL_INDEX8, gl.STENCIL_ATTACHMENT);\n        }\n        return null;\n    };\n    /**\n     * @param width\n     * @param height\n     * @param samples\n     * @param internalFormat\n     * @param msInternalFormat\n     * @param attachment\n     * @param unbindBuffer\n     * @hidden\n     */\n    ThinEngine.prototype._createRenderBuffer = function (width, height, samples, internalFormat, msInternalFormat, attachment, unbindBuffer) {\n        if (unbindBuffer === void 0) { unbindBuffer = true; }\n        var gl = this._gl;\n        var renderBuffer = gl.createRenderbuffer();\n        gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n        if (samples > 1 && gl.renderbufferStorageMultisample) {\n            gl.renderbufferStorageMultisample(gl.RENDERBUFFER, samples, msInternalFormat, width, height);\n        }\n        else {\n            gl.renderbufferStorage(gl.RENDERBUFFER, internalFormat, width, height);\n        }\n        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, attachment, gl.RENDERBUFFER, renderBuffer);\n        if (unbindBuffer) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n        }\n        return renderBuffer;\n    };\n    /**\n     * @param texture\n     * @hidden\n     */\n    ThinEngine.prototype._releaseTexture = function (texture) {\n        var _a;\n        this._deleteTexture((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource);\n        // Unbind channels\n        this.unbindAllTextures();\n        var index = this._internalTexturesCache.indexOf(texture);\n        if (index !== -1) {\n            this._internalTexturesCache.splice(index, 1);\n        }\n        // Integrated fixed lod samplers.\n        if (texture._lodTextureHigh) {\n            texture._lodTextureHigh.dispose();\n        }\n        if (texture._lodTextureMid) {\n            texture._lodTextureMid.dispose();\n        }\n        if (texture._lodTextureLow) {\n            texture._lodTextureLow.dispose();\n        }\n        // Integrated irradiance map.\n        if (texture._irradianceTexture) {\n            texture._irradianceTexture.dispose();\n        }\n    };\n    /**\n     * @param rtWrapper\n     * @hidden\n     */\n    ThinEngine.prototype._releaseRenderTargetWrapper = function (rtWrapper) {\n        var index = this._renderTargetWrapperCache.indexOf(rtWrapper);\n        if (index !== -1) {\n            this._renderTargetWrapperCache.splice(index, 1);\n        }\n    };\n    ThinEngine.prototype._deleteTexture = function (texture) {\n        if (texture) {\n            this._gl.deleteTexture(texture);\n        }\n    };\n    ThinEngine.prototype._setProgram = function (program) {\n        if (this._currentProgram !== program) {\n            this._gl.useProgram(program);\n            this._currentProgram = program;\n        }\n    };\n    /**\n     * Binds an effect to the webGL context\n     * @param effect defines the effect to bind\n     */\n    ThinEngine.prototype.bindSamplers = function (effect) {\n        var webGLPipelineContext = effect.getPipelineContext();\n        this._setProgram(webGLPipelineContext.program);\n        var samplers = effect.getSamplers();\n        for (var index = 0; index < samplers.length; index++) {\n            var uniform = effect.getUniform(samplers[index]);\n            if (uniform) {\n                this._boundUniforms[index] = uniform;\n            }\n        }\n        this._currentEffect = null;\n    };\n    ThinEngine.prototype._activateCurrentTexture = function () {\n        if (this._currentTextureChannel !== this._activeChannel) {\n            this._gl.activeTexture(this._gl.TEXTURE0 + this._activeChannel);\n            this._currentTextureChannel = this._activeChannel;\n        }\n    };\n    /**\n     * @param target\n     * @param texture\n     * @param forTextureDataUpdate\n     * @param force\n     * @hidden\n     */\n    ThinEngine.prototype._bindTextureDirectly = function (target, texture, forTextureDataUpdate, force) {\n        var _a, _b;\n        if (forTextureDataUpdate === void 0) { forTextureDataUpdate = false; }\n        if (force === void 0) { force = false; }\n        var wasPreviouslyBound = false;\n        var isTextureForRendering = texture && texture._associatedChannel > -1;\n        if (forTextureDataUpdate && isTextureForRendering) {\n            this._activeChannel = texture._associatedChannel;\n        }\n        var currentTextureBound = this._boundTexturesCache[this._activeChannel];\n        if (currentTextureBound !== texture || force) {\n            this._activateCurrentTexture();\n            if (texture && texture.isMultiview) {\n                //this._gl.bindTexture(target, texture ? texture._colorTextureArray : null);\n                console.error(target, texture);\n                throw \"_bindTextureDirectly called with a multiview texture!\";\n            }\n            else {\n                this._gl.bindTexture(target, (_b = (_a = texture === null || texture === void 0 ? void 0 : texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource) !== null && _b !== void 0 ? _b : null);\n            }\n            this._boundTexturesCache[this._activeChannel] = texture;\n            if (texture) {\n                texture._associatedChannel = this._activeChannel;\n            }\n        }\n        else if (forTextureDataUpdate) {\n            wasPreviouslyBound = true;\n            this._activateCurrentTexture();\n        }\n        if (isTextureForRendering && !forTextureDataUpdate) {\n            this._bindSamplerUniformToChannel(texture._associatedChannel, this._activeChannel);\n        }\n        return wasPreviouslyBound;\n    };\n    /**\n     * @param channel\n     * @param texture\n     * @param name\n     * @hidden\n     */\n    ThinEngine.prototype._bindTexture = function (channel, texture, name) {\n        if (channel === undefined) {\n            return;\n        }\n        if (texture) {\n            texture._associatedChannel = channel;\n        }\n        this._activeChannel = channel;\n        var target = texture ? this._getTextureTarget(texture) : this._gl.TEXTURE_2D;\n        this._bindTextureDirectly(target, texture);\n    };\n    /**\n     * Unbind all textures from the webGL context\n     */\n    ThinEngine.prototype.unbindAllTextures = function () {\n        for (var channel = 0; channel < this._maxSimultaneousTextures; channel++) {\n            this._activeChannel = channel;\n            this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n            this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n            if (this.webGLVersion > 1) {\n                this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n                this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n            }\n        }\n    };\n    /**\n     * Sets a texture to the according uniform.\n     * @param channel The texture channel\n     * @param uniform The uniform to set\n     * @param texture The texture to apply\n     * @param name The name of the uniform in the effect\n     */\n    ThinEngine.prototype.setTexture = function (channel, uniform, texture, name) {\n        if (channel === undefined) {\n            return;\n        }\n        if (uniform) {\n            this._boundUniforms[channel] = uniform;\n        }\n        this._setTexture(channel, texture);\n    };\n    ThinEngine.prototype._bindSamplerUniformToChannel = function (sourceSlot, destination) {\n        var uniform = this._boundUniforms[sourceSlot];\n        if (!uniform || uniform._currentState === destination) {\n            return;\n        }\n        this._gl.uniform1i(uniform, destination);\n        uniform._currentState = destination;\n    };\n    ThinEngine.prototype._getTextureWrapMode = function (mode) {\n        switch (mode) {\n            case 1:\n                return this._gl.REPEAT;\n            case 0:\n                return this._gl.CLAMP_TO_EDGE;\n            case 2:\n                return this._gl.MIRRORED_REPEAT;\n        }\n        return this._gl.REPEAT;\n    };\n    ThinEngine.prototype._setTexture = function (channel, texture, isPartOfTextureArray, depthStencilTexture, name) {\n        if (isPartOfTextureArray === void 0) { isPartOfTextureArray = false; }\n        if (depthStencilTexture === void 0) { depthStencilTexture = false; }\n        if (name === void 0) { name = \"\"; }\n        // Not ready?\n        if (!texture) {\n            if (this._boundTexturesCache[channel] != null) {\n                this._activeChannel = channel;\n                this._bindTextureDirectly(this._gl.TEXTURE_2D, null);\n                this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null);\n                if (this.webGLVersion > 1) {\n                    this._bindTextureDirectly(this._gl.TEXTURE_3D, null);\n                    this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY, null);\n                }\n            }\n            return false;\n        }\n        // Video\n        if (texture.video) {\n            this._activeChannel = channel;\n            texture.update();\n        }\n        else if (texture.delayLoadState === 4) {\n            // Delay loading\n            texture.delayLoad();\n            return false;\n        }\n        var internalTexture;\n        if (depthStencilTexture) {\n            internalTexture = texture.depthStencilTexture;\n        }\n        else if (texture.isReady()) {\n            internalTexture = texture.getInternalTexture();\n        }\n        else if (texture.isCube) {\n            internalTexture = this.emptyCubeTexture;\n        }\n        else if (texture.is3D) {\n            internalTexture = this.emptyTexture3D;\n        }\n        else if (texture.is2DArray) {\n            internalTexture = this.emptyTexture2DArray;\n        }\n        else {\n            internalTexture = this.emptyTexture;\n        }\n        if (!isPartOfTextureArray && internalTexture) {\n            internalTexture._associatedChannel = channel;\n        }\n        var needToBind = true;\n        if (this._boundTexturesCache[channel] === internalTexture) {\n            if (!isPartOfTextureArray) {\n                this._bindSamplerUniformToChannel(internalTexture._associatedChannel, channel);\n            }\n            needToBind = false;\n        }\n        this._activeChannel = channel;\n        var target = this._getTextureTarget(internalTexture);\n        if (needToBind) {\n            this._bindTextureDirectly(target, internalTexture, isPartOfTextureArray);\n        }\n        if (internalTexture && !internalTexture.isMultiview) {\n            // CUBIC_MODE and SKYBOX_MODE both require CLAMP_TO_EDGE.  All other modes use REPEAT.\n            if (internalTexture.isCube && internalTexture._cachedCoordinatesMode !== texture.coordinatesMode) {\n                internalTexture._cachedCoordinatesMode = texture.coordinatesMode;\n                var textureWrapMode = texture.coordinatesMode !== 3 && texture.coordinatesMode !== 5\n                    ? 1\n                    : 0;\n                texture.wrapU = textureWrapMode;\n                texture.wrapV = textureWrapMode;\n            }\n            if (internalTexture._cachedWrapU !== texture.wrapU) {\n                internalTexture._cachedWrapU = texture.wrapU;\n                this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_S, this._getTextureWrapMode(texture.wrapU), internalTexture);\n            }\n            if (internalTexture._cachedWrapV !== texture.wrapV) {\n                internalTexture._cachedWrapV = texture.wrapV;\n                this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_T, this._getTextureWrapMode(texture.wrapV), internalTexture);\n            }\n            if (internalTexture.is3D && internalTexture._cachedWrapR !== texture.wrapR) {\n                internalTexture._cachedWrapR = texture.wrapR;\n                this._setTextureParameterInteger(target, this._gl.TEXTURE_WRAP_R, this._getTextureWrapMode(texture.wrapR), internalTexture);\n            }\n            this._setAnisotropicLevel(target, internalTexture, texture.anisotropicFilteringLevel);\n        }\n        return true;\n    };\n    /**\n     * Sets an array of texture to the webGL context\n     * @param channel defines the channel where the texture array must be set\n     * @param uniform defines the associated uniform location\n     * @param textures defines the array of textures to bind\n     * @param name name of the channel\n     */\n    ThinEngine.prototype.setTextureArray = function (channel, uniform, textures, name) {\n        if (channel === undefined || !uniform) {\n            return;\n        }\n        if (!this._textureUnits || this._textureUnits.length !== textures.length) {\n            this._textureUnits = new Int32Array(textures.length);\n        }\n        for (var i = 0; i < textures.length; i++) {\n            var texture = textures[i].getInternalTexture();\n            if (texture) {\n                this._textureUnits[i] = channel + i;\n                texture._associatedChannel = channel + i;\n            }\n            else {\n                this._textureUnits[i] = -1;\n            }\n        }\n        this._gl.uniform1iv(uniform, this._textureUnits);\n        for (var index = 0; index < textures.length; index++) {\n            this._setTexture(this._textureUnits[index], textures[index], true);\n        }\n    };\n    /**\n     * @param target\n     * @param internalTexture\n     * @param anisotropicFilteringLevel\n     * @hidden\n     */\n    ThinEngine.prototype._setAnisotropicLevel = function (target, internalTexture, anisotropicFilteringLevel) {\n        var anisotropicFilterExtension = this._caps.textureAnisotropicFilterExtension;\n        if (internalTexture.samplingMode !== 11 &&\n            internalTexture.samplingMode !== 3 &&\n            internalTexture.samplingMode !== 2) {\n            anisotropicFilteringLevel = 1; // Forcing the anisotropic to 1 because else webgl will force filters to linear\n        }\n        if (anisotropicFilterExtension && internalTexture._cachedAnisotropicFilteringLevel !== anisotropicFilteringLevel) {\n            this._setTextureParameterFloat(target, anisotropicFilterExtension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(anisotropicFilteringLevel, this._caps.maxAnisotropy), internalTexture);\n            internalTexture._cachedAnisotropicFilteringLevel = anisotropicFilteringLevel;\n        }\n    };\n    ThinEngine.prototype._setTextureParameterFloat = function (target, parameter, value, texture) {\n        this._bindTextureDirectly(target, texture, true, true);\n        this._gl.texParameterf(target, parameter, value);\n    };\n    ThinEngine.prototype._setTextureParameterInteger = function (target, parameter, value, texture) {\n        if (texture) {\n            this._bindTextureDirectly(target, texture, true, true);\n        }\n        this._gl.texParameteri(target, parameter, value);\n    };\n    /**\n     * Unbind all vertex attributes from the webGL context\n     */\n    ThinEngine.prototype.unbindAllAttributes = function () {\n        if (this._mustWipeVertexAttributes) {\n            this._mustWipeVertexAttributes = false;\n            for (var i = 0; i < this._caps.maxVertexAttribs; i++) {\n                this.disableAttributeByIndex(i);\n            }\n            return;\n        }\n        for (var i = 0, ul = this._vertexAttribArraysEnabled.length; i < ul; i++) {\n            if (i >= this._caps.maxVertexAttribs || !this._vertexAttribArraysEnabled[i]) {\n                continue;\n            }\n            this.disableAttributeByIndex(i);\n        }\n    };\n    /**\n     * Force the engine to release all cached effects. This means that next effect compilation will have to be done completely even if a similar effect was already compiled\n     */\n    ThinEngine.prototype.releaseEffects = function () {\n        for (var name_1 in this._compiledEffects) {\n            var webGLPipelineContext = this._compiledEffects[name_1].getPipelineContext();\n            this._deletePipelineContext(webGLPipelineContext);\n        }\n        this._compiledEffects = {};\n    };\n    /**\n     * Dispose and release all associated resources\n     */\n    ThinEngine.prototype.dispose = function () {\n        var _a;\n        this.stopRenderLoop();\n        // Clear observables\n        if (this.onBeforeTextureInitObservable) {\n            this.onBeforeTextureInitObservable.clear();\n        }\n        // Empty texture\n        if (this._emptyTexture) {\n            this._releaseTexture(this._emptyTexture);\n            this._emptyTexture = null;\n        }\n        if (this._emptyCubeTexture) {\n            this._releaseTexture(this._emptyCubeTexture);\n            this._emptyCubeTexture = null;\n        }\n        if (this._dummyFramebuffer) {\n            this._gl.deleteFramebuffer(this._dummyFramebuffer);\n        }\n        // Release effects\n        this.releaseEffects();\n        (_a = this.releaseComputeEffects) === null || _a === void 0 ? void 0 : _a.call(this);\n        // Unbind\n        this.unbindAllAttributes();\n        this._boundUniforms = [];\n        // Events\n        if (IsWindowObjectExist()) {\n            if (this._renderingCanvas) {\n                if (!this._doNotHandleContextLost) {\n                    this._renderingCanvas.removeEventListener(\"webglcontextlost\", this._onContextLost);\n                    this._renderingCanvas.removeEventListener(\"webglcontextrestored\", this._onContextRestored);\n                }\n                window.removeEventListener(\"resize\", this._checkForMobile);\n            }\n        }\n        this._workingCanvas = null;\n        this._workingContext = null;\n        this._currentBufferPointers = [];\n        this._renderingCanvas = null;\n        this._currentProgram = null;\n        this._boundRenderFunction = null;\n        Effect.ResetCache();\n        // Abort active requests\n        for (var _i = 0, _b = this._activeRequests; _i < _b.length; _i++) {\n            var request = _b[_i];\n            request.abort();\n        }\n        this.onDisposeObservable.notifyObservers(this);\n        this.onDisposeObservable.clear();\n    };\n    /**\n     * Attach a new callback raised when context lost event is fired\n     * @param callback defines the callback to call\n     */\n    ThinEngine.prototype.attachContextLostEvent = function (callback) {\n        if (this._renderingCanvas) {\n            this._renderingCanvas.addEventListener(\"webglcontextlost\", callback, false);\n        }\n    };\n    /**\n     * Attach a new callback raised when context restored event is fired\n     * @param callback defines the callback to call\n     */\n    ThinEngine.prototype.attachContextRestoredEvent = function (callback) {\n        if (this._renderingCanvas) {\n            this._renderingCanvas.addEventListener(\"webglcontextrestored\", callback, false);\n        }\n    };\n    /**\n     * Get the current error code of the webGL context\n     * @returns the error code\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/getError\n     */\n    ThinEngine.prototype.getError = function () {\n        return this._gl.getError();\n    };\n    ThinEngine.prototype._canRenderToFloatFramebuffer = function () {\n        if (this._webGLVersion > 1) {\n            return this._caps.colorBufferFloat;\n        }\n        return this._canRenderToFramebuffer(1);\n    };\n    ThinEngine.prototype._canRenderToHalfFloatFramebuffer = function () {\n        if (this._webGLVersion > 1) {\n            return this._caps.colorBufferFloat;\n        }\n        return this._canRenderToFramebuffer(2);\n    };\n    // Thank you : http://stackoverflow.com/questions/28827511/webgl-ios-render-to-floating-point-texture\n    ThinEngine.prototype._canRenderToFramebuffer = function (type) {\n        var gl = this._gl;\n        //clear existing errors\n        // eslint-disable-next-line no-empty\n        while (gl.getError() !== gl.NO_ERROR) { }\n        var successful = true;\n        var texture = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, this._getRGBABufferInternalSizedFormat(type), 1, 1, 0, gl.RGBA, this._getWebGLTextureType(type), null);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        var fb = gl.createFramebuffer();\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n        var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n        successful = successful && status === gl.FRAMEBUFFER_COMPLETE;\n        successful = successful && gl.getError() === gl.NO_ERROR;\n        //try render by clearing frame buffer's color buffer\n        if (successful) {\n            gl.clear(gl.COLOR_BUFFER_BIT);\n            successful = successful && gl.getError() === gl.NO_ERROR;\n        }\n        //try reading from frame to ensure render occurs (just creating the FBO is not sufficient to determine if rendering is supported)\n        if (successful) {\n            //in practice it's sufficient to just read from the backbuffer rather than handle potentially issues reading from the texture\n            gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            var readFormat = gl.RGBA;\n            var readType = gl.UNSIGNED_BYTE;\n            var buffer = new Uint8Array(4);\n            gl.readPixels(0, 0, 1, 1, readFormat, readType, buffer);\n            successful = successful && gl.getError() === gl.NO_ERROR;\n        }\n        //clean up\n        gl.deleteTexture(texture);\n        gl.deleteFramebuffer(fb);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        //clear accumulated errors\n        // eslint-disable-next-line no-empty\n        while (!successful && gl.getError() !== gl.NO_ERROR) { }\n        return successful;\n    };\n    /**\n     * @param type\n     * @hidden\n     */\n    ThinEngine.prototype._getWebGLTextureType = function (type) {\n        if (this._webGLVersion === 1) {\n            switch (type) {\n                case 1:\n                    return this._gl.FLOAT;\n                case 2:\n                    return this._gl.HALF_FLOAT_OES;\n                case 0:\n                    return this._gl.UNSIGNED_BYTE;\n                case 8:\n                    return this._gl.UNSIGNED_SHORT_4_4_4_4;\n                case 9:\n                    return this._gl.UNSIGNED_SHORT_5_5_5_1;\n                case 10:\n                    return this._gl.UNSIGNED_SHORT_5_6_5;\n            }\n            return this._gl.UNSIGNED_BYTE;\n        }\n        switch (type) {\n            case 3:\n                return this._gl.BYTE;\n            case 0:\n                return this._gl.UNSIGNED_BYTE;\n            case 4:\n                return this._gl.SHORT;\n            case 5:\n                return this._gl.UNSIGNED_SHORT;\n            case 6:\n                return this._gl.INT;\n            case 7: // Refers to UNSIGNED_INT\n                return this._gl.UNSIGNED_INT;\n            case 1:\n                return this._gl.FLOAT;\n            case 2:\n                return this._gl.HALF_FLOAT;\n            case 8:\n                return this._gl.UNSIGNED_SHORT_4_4_4_4;\n            case 9:\n                return this._gl.UNSIGNED_SHORT_5_5_5_1;\n            case 10:\n                return this._gl.UNSIGNED_SHORT_5_6_5;\n            case 11:\n                return this._gl.UNSIGNED_INT_2_10_10_10_REV;\n            case 12:\n                return this._gl.UNSIGNED_INT_24_8;\n            case 13:\n                return this._gl.UNSIGNED_INT_10F_11F_11F_REV;\n            case 14:\n                return this._gl.UNSIGNED_INT_5_9_9_9_REV;\n            case 15:\n                return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV;\n        }\n        return this._gl.UNSIGNED_BYTE;\n    };\n    /**\n     * @param format\n     * @param useSRGBBuffer\n     * @hidden\n     */\n    ThinEngine.prototype._getInternalFormat = function (format, useSRGBBuffer) {\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        var internalFormat = useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA;\n        switch (format) {\n            case 0:\n                internalFormat = this._gl.ALPHA;\n                break;\n            case 1:\n                internalFormat = this._gl.LUMINANCE;\n                break;\n            case 2:\n                internalFormat = this._gl.LUMINANCE_ALPHA;\n                break;\n            case 6:\n                internalFormat = this._gl.RED;\n                break;\n            case 7:\n                internalFormat = this._gl.RG;\n                break;\n            case 4:\n                internalFormat = useSRGBBuffer ? this._gl.SRGB : this._gl.RGB;\n                break;\n            case 5:\n                internalFormat = useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA;\n                break;\n        }\n        if (this._webGLVersion > 1) {\n            switch (format) {\n                case 8:\n                    internalFormat = this._gl.RED_INTEGER;\n                    break;\n                case 9:\n                    internalFormat = this._gl.RG_INTEGER;\n                    break;\n                case 10:\n                    internalFormat = this._gl.RGB_INTEGER;\n                    break;\n                case 11:\n                    internalFormat = this._gl.RGBA_INTEGER;\n                    break;\n            }\n        }\n        return internalFormat;\n    };\n    /**\n     * @param type\n     * @param format\n     * @param useSRGBBuffer\n     * @hidden\n     */\n    ThinEngine.prototype._getRGBABufferInternalSizedFormat = function (type, format, useSRGBBuffer) {\n        if (useSRGBBuffer === void 0) { useSRGBBuffer = false; }\n        if (this._webGLVersion === 1) {\n            if (format !== undefined) {\n                switch (format) {\n                    case 0:\n                        return this._gl.ALPHA;\n                    case 1:\n                        return this._gl.LUMINANCE;\n                    case 2:\n                        return this._gl.LUMINANCE_ALPHA;\n                    case 4:\n                        return useSRGBBuffer ? this._gl.SRGB : this._gl.RGB;\n                }\n            }\n            return this._gl.RGBA;\n        }\n        switch (type) {\n            case 3:\n                switch (format) {\n                    case 6:\n                        return this._gl.R8_SNORM;\n                    case 7:\n                        return this._gl.RG8_SNORM;\n                    case 4:\n                        return this._gl.RGB8_SNORM;\n                    case 8:\n                        return this._gl.R8I;\n                    case 9:\n                        return this._gl.RG8I;\n                    case 10:\n                        return this._gl.RGB8I;\n                    case 11:\n                        return this._gl.RGBA8I;\n                    default:\n                        return this._gl.RGBA8_SNORM;\n                }\n            case 0:\n                switch (format) {\n                    case 6:\n                        return this._gl.R8;\n                    case 7:\n                        return this._gl.RG8;\n                    case 4:\n                        return useSRGBBuffer ? this._gl.SRGB8 : this._gl.RGB8; // By default. Other possibilities are RGB565, SRGB8.\n                    case 5:\n                        return useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA8; // By default. Other possibilities are RGB5_A1, RGBA4, SRGB8_ALPHA8.\n                    case 8:\n                        return this._gl.R8UI;\n                    case 9:\n                        return this._gl.RG8UI;\n                    case 10:\n                        return this._gl.RGB8UI;\n                    case 11:\n                        return this._gl.RGBA8UI;\n                    case 0:\n                        return this._gl.ALPHA;\n                    case 1:\n                        return this._gl.LUMINANCE;\n                    case 2:\n                        return this._gl.LUMINANCE_ALPHA;\n                    default:\n                        return this._gl.RGBA8;\n                }\n            case 4:\n                switch (format) {\n                    case 8:\n                        return this._gl.R16I;\n                    case 9:\n                        return this._gl.RG16I;\n                    case 10:\n                        return this._gl.RGB16I;\n                    case 11:\n                        return this._gl.RGBA16I;\n                    default:\n                        return this._gl.RGBA16I;\n                }\n            case 5:\n                switch (format) {\n                    case 8:\n                        return this._gl.R16UI;\n                    case 9:\n                        return this._gl.RG16UI;\n                    case 10:\n                        return this._gl.RGB16UI;\n                    case 11:\n                        return this._gl.RGBA16UI;\n                    default:\n                        return this._gl.RGBA16UI;\n                }\n            case 6:\n                switch (format) {\n                    case 8:\n                        return this._gl.R32I;\n                    case 9:\n                        return this._gl.RG32I;\n                    case 10:\n                        return this._gl.RGB32I;\n                    case 11:\n                        return this._gl.RGBA32I;\n                    default:\n                        return this._gl.RGBA32I;\n                }\n            case 7: // Refers to UNSIGNED_INT\n                switch (format) {\n                    case 8:\n                        return this._gl.R32UI;\n                    case 9:\n                        return this._gl.RG32UI;\n                    case 10:\n                        return this._gl.RGB32UI;\n                    case 11:\n                        return this._gl.RGBA32UI;\n                    default:\n                        return this._gl.RGBA32UI;\n                }\n            case 1:\n                switch (format) {\n                    case 6:\n                        return this._gl.R32F; // By default. Other possibility is R16F.\n                    case 7:\n                        return this._gl.RG32F; // By default. Other possibility is RG16F.\n                    case 4:\n                        return this._gl.RGB32F; // By default. Other possibilities are RGB16F, R11F_G11F_B10F, RGB9_E5.\n                    case 5:\n                        return this._gl.RGBA32F; // By default. Other possibility is RGBA16F.\n                    default:\n                        return this._gl.RGBA32F;\n                }\n            case 2:\n                switch (format) {\n                    case 6:\n                        return this._gl.R16F;\n                    case 7:\n                        return this._gl.RG16F;\n                    case 4:\n                        return this._gl.RGB16F; // By default. Other possibilities are R11F_G11F_B10F, RGB9_E5.\n                    case 5:\n                        return this._gl.RGBA16F;\n                    default:\n                        return this._gl.RGBA16F;\n                }\n            case 10:\n                return this._gl.RGB565;\n            case 13:\n                return this._gl.R11F_G11F_B10F;\n            case 14:\n                return this._gl.RGB9_E5;\n            case 8:\n                return this._gl.RGBA4;\n            case 9:\n                return this._gl.RGB5_A1;\n            case 11:\n                switch (format) {\n                    case 5:\n                        return this._gl.RGB10_A2; // By default. Other possibility is RGB5_A1.\n                    case 11:\n                        return this._gl.RGB10_A2UI;\n                    default:\n                        return this._gl.RGB10_A2;\n                }\n        }\n        return useSRGBBuffer ? this._gl.SRGB8_ALPHA8 : this._gl.RGBA8;\n    };\n    /**\n     * @param type\n     * @hidden\n     */\n    ThinEngine.prototype._getRGBAMultiSampleBufferFormat = function (type) {\n        if (type === 1) {\n            return this._gl.RGBA32F;\n        }\n        else if (type === 2) {\n            return this._gl.RGBA16F;\n        }\n        return this._gl.RGBA8;\n    };\n    /**\n     * @param url\n     * @param onSuccess\n     * @param onProgress\n     * @param offlineProvider\n     * @param useArrayBuffer\n     * @param onError\n     * @hidden\n     */\n    ThinEngine.prototype._loadFile = function (url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n        var _this = this;\n        var request = ThinEngine._FileToolsLoadFile(url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError);\n        this._activeRequests.push(request);\n        request.onCompleteObservable.add(function (request) {\n            _this._activeRequests.splice(_this._activeRequests.indexOf(request), 1);\n        });\n        return request;\n    };\n    /**\n     * Loads a file from a url\n     * @param url url to load\n     * @param onSuccess callback called when the file successfully loads\n     * @param onProgress callback called while file is loading (if the server supports this mode)\n     * @param offlineProvider defines the offline provider for caching\n     * @param useArrayBuffer defines a boolean indicating that date must be returned as ArrayBuffer\n     * @param onError callback called when the file fails to load\n     * @returns a file request object\n     * @hidden\n     */\n    ThinEngine._FileToolsLoadFile = function (url, onSuccess, onProgress, offlineProvider, useArrayBuffer, onError) {\n        throw _WarnImport(\"FileTools\");\n    };\n    /**\n     * Reads pixels from the current frame buffer. Please note that this function can be slow\n     * @param x defines the x coordinate of the rectangle where pixels must be read\n     * @param y defines the y coordinate of the rectangle where pixels must be read\n     * @param width defines the width of the rectangle where pixels must be read\n     * @param height defines the height of the rectangle where pixels must be read\n     * @param hasAlpha defines whether the output should have alpha or not (defaults to true)\n     * @param flushRenderer true to flush the renderer from the pending commands before reading the pixels\n     * @returns a ArrayBufferView promise (Uint8Array) containing RGBA colors\n     */\n    ThinEngine.prototype.readPixels = function (x, y, width, height, hasAlpha, flushRenderer) {\n        if (hasAlpha === void 0) { hasAlpha = true; }\n        if (flushRenderer === void 0) { flushRenderer = true; }\n        var numChannels = hasAlpha ? 4 : 3;\n        var format = hasAlpha ? this._gl.RGBA : this._gl.RGB;\n        var data = new Uint8Array(height * width * numChannels);\n        if (flushRenderer) {\n            this.flushFramebuffer();\n        }\n        this._gl.readPixels(x, y, width, height, format, this._gl.UNSIGNED_BYTE, data);\n        return Promise.resolve(data);\n    };\n    Object.defineProperty(ThinEngine, \"IsSupportedAsync\", {\n        /**\n         * Gets a Promise<boolean> indicating if the engine can be instantiated (ie. if a webGL context can be found)\n         */\n        get: function () {\n            return Promise.resolve(this.isSupported());\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ThinEngine, \"IsSupported\", {\n        /**\n         * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n         */\n        get: function () {\n            return this.isSupported(); // Backward compat\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets a boolean indicating if the engine can be instantiated (ie. if a webGL context can be found)\n     * @returns true if the engine can be created\n     * @ignorenaming\n     */\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    ThinEngine.isSupported = function () {\n        if (this._HasMajorPerformanceCaveat !== null) {\n            return !this._HasMajorPerformanceCaveat; // We know it is performant so WebGL is supported\n        }\n        if (this._IsSupported === null) {\n            try {\n                var tempcanvas = this._CreateCanvas(1, 1);\n                var gl = tempcanvas.getContext(\"webgl\") || tempcanvas.getContext(\"experimental-webgl\");\n                this._IsSupported = gl != null && !!window.WebGLRenderingContext;\n            }\n            catch (e) {\n                this._IsSupported = false;\n            }\n        }\n        return this._IsSupported;\n    };\n    Object.defineProperty(ThinEngine, \"HasMajorPerformanceCaveat\", {\n        /**\n         * Gets a boolean indicating if the engine can be instantiated on a performant device (ie. if a webGL context can be found and it does not use a slow implementation)\n         */\n        get: function () {\n            if (this._HasMajorPerformanceCaveat === null) {\n                try {\n                    var tempcanvas = this._CreateCanvas(1, 1);\n                    var gl = tempcanvas.getContext(\"webgl\", { failIfMajorPerformanceCaveat: true }) ||\n                        tempcanvas.getContext(\"experimental-webgl\", { failIfMajorPerformanceCaveat: true });\n                    this._HasMajorPerformanceCaveat = !gl;\n                }\n                catch (e) {\n                    this._HasMajorPerformanceCaveat = false;\n                }\n            }\n            return this._HasMajorPerformanceCaveat;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Find the next highest power of two.\n     * @param x Number to start search from.\n     * @return Next highest power of two.\n     */\n    ThinEngine.CeilingPOT = function (x) {\n        x--;\n        x |= x >> 1;\n        x |= x >> 2;\n        x |= x >> 4;\n        x |= x >> 8;\n        x |= x >> 16;\n        x++;\n        return x;\n    };\n    /**\n     * Find the next lowest power of two.\n     * @param x Number to start search from.\n     * @return Next lowest power of two.\n     */\n    ThinEngine.FloorPOT = function (x) {\n        x = x | (x >> 1);\n        x = x | (x >> 2);\n        x = x | (x >> 4);\n        x = x | (x >> 8);\n        x = x | (x >> 16);\n        return x - (x >> 1);\n    };\n    /**\n     * Find the nearest power of two.\n     * @param x Number to start search from.\n     * @return Next nearest power of two.\n     */\n    ThinEngine.NearestPOT = function (x) {\n        var c = ThinEngine.CeilingPOT(x);\n        var f = ThinEngine.FloorPOT(x);\n        return c - x > x - f ? f : c;\n    };\n    /**\n     * Get the closest exponent of two\n     * @param value defines the value to approximate\n     * @param max defines the maximum value to return\n     * @param mode defines how to define the closest value\n     * @returns closest exponent of two of the given value\n     */\n    ThinEngine.GetExponentOfTwo = function (value, max, mode) {\n        if (mode === void 0) { mode = 2; }\n        var pot;\n        switch (mode) {\n            case 1:\n                pot = ThinEngine.FloorPOT(value);\n                break;\n            case 2:\n                pot = ThinEngine.NearestPOT(value);\n                break;\n            case 3:\n            default:\n                pot = ThinEngine.CeilingPOT(value);\n                break;\n        }\n        return Math.min(pot, max);\n    };\n    /**\n     * Queue a new function into the requested animation frame pool (ie. this function will be executed byt the browser for the next frame)\n     * @param func - the function to be called\n     * @param requester - the object that will request the next frame. Falls back to window.\n     * @returns frame number\n     */\n    ThinEngine.QueueNewFrame = function (func, requester) {\n        if (!IsWindowObjectExist()) {\n            if (typeof requestAnimationFrame !== \"undefined\") {\n                return requestAnimationFrame(func);\n            }\n            return setTimeout(func, 16);\n        }\n        if (!requester) {\n            requester = window;\n        }\n        if (requester.requestPostAnimationFrame) {\n            return requester.requestPostAnimationFrame(func);\n        }\n        else if (requester.requestAnimationFrame) {\n            return requester.requestAnimationFrame(func);\n        }\n        else if (requester.msRequestAnimationFrame) {\n            return requester.msRequestAnimationFrame(func);\n        }\n        else if (requester.webkitRequestAnimationFrame) {\n            return requester.webkitRequestAnimationFrame(func);\n        }\n        else if (requester.mozRequestAnimationFrame) {\n            return requester.mozRequestAnimationFrame(func);\n        }\n        else if (requester.oRequestAnimationFrame) {\n            return requester.oRequestAnimationFrame(func);\n        }\n        else {\n            return window.setTimeout(func, 16);\n        }\n    };\n    /**\n     * Gets host document\n     * @returns the host document object\n     */\n    ThinEngine.prototype.getHostDocument = function () {\n        if (this._renderingCanvas && this._renderingCanvas.ownerDocument) {\n            return this._renderingCanvas.ownerDocument;\n        }\n        return IsDocumentAvailable() ? document : null;\n    };\n    /** Use this array to turn off some WebGL2 features on known buggy browsers version */\n    ThinEngine.ExceptionList = [\n        { key: \"Chrome/63.0\", capture: \"63\\\\.0\\\\.3239\\\\.(\\\\d+)\", captureConstraint: 108, targets: [\"uniformBuffer\"] },\n        { key: \"Firefox/58\", capture: null, captureConstraint: null, targets: [\"uniformBuffer\"] },\n        { key: \"Firefox/59\", capture: null, captureConstraint: null, targets: [\"uniformBuffer\"] },\n        { key: \"Chrome/72.+?Mobile\", capture: null, captureConstraint: null, targets: [\"vao\"] },\n        { key: \"Chrome/73.+?Mobile\", capture: null, captureConstraint: null, targets: [\"vao\"] },\n        { key: \"Chrome/74.+?Mobile\", capture: null, captureConstraint: null, targets: [\"vao\"] },\n        { key: \"Mac OS.+Chrome/71\", capture: null, captureConstraint: null, targets: [\"vao\"] },\n        { key: \"Mac OS.+Chrome/72\", capture: null, captureConstraint: null, targets: [\"vao\"] },\n        { key: \"Mac OS.+Chrome\", capture: null, captureConstraint: null, targets: [\"uniformBuffer\"] },\n        // desktop osx safari 15.4\n        { key: \".*AppleWebKit.*(15.4).*Safari\", capture: null, captureConstraint: null, targets: [\"antialias\", \"maxMSAASamples\"] },\n        // mobile browsers using safari 15.4 on ios\n        { key: \".*(15.4).*AppleWebKit.*Safari\", capture: null, captureConstraint: null, targets: [\"antialias\", \"maxMSAASamples\"] },\n    ];\n    /** @hidden */\n    ThinEngine._TextureLoaders = [];\n    // Updatable statics so stick with vars here\n    /**\n     * Gets or sets the epsilon value used by collision engine\n     */\n    ThinEngine.CollisionsEpsilon = 0.001;\n    // Statics\n    ThinEngine._IsSupported = null;\n    ThinEngine._HasMajorPerformanceCaveat = null;\n    return ThinEngine;\n}());\nexport { ThinEngine };\n//# sourceMappingURL=thinEngine.js.map","import { __assign, __extends } from \"tslib\";\nimport { Logger } from \"../Misc/logger.js\";\nimport { IsWindowObjectExist } from \"../Misc/domManagement.js\";\nimport { Color4 } from \"../Maths/math.js\";\nimport { Engine } from \"../Engines/engine.js\";\nimport { InternalTexture, InternalTextureSource } from \"../Materials/Textures/internalTexture.js\";\nimport { Effect } from \"../Materials/effect.js\";\n\nimport * as WebGPUConstants from \"./WebGPU/webgpuConstants.js\";\nimport { VertexBuffer } from \"../Buffers/buffer.js\";\nimport { WebGPUPipelineContext } from \"./WebGPU/webgpuPipelineContext.js\";\nimport { WebGPUShaderProcessorGLSL } from \"./WebGPU/webgpuShaderProcessorsGLSL.js\";\nimport { WebGPUShaderProcessorWGSL } from \"./WebGPU/webgpuShaderProcessorsWGSL.js\";\nimport { WebGPUShaderProcessingContext } from \"./WebGPU/webgpuShaderProcessingContext.js\";\nimport { Tools } from \"../Misc/tools.js\";\nimport { WebGPUTextureHelper } from \"./WebGPU/webgpuTextureHelper.js\";\nimport { WebGPUBufferManager } from \"./WebGPU/webgpuBufferManager.js\";\nimport { WebGPUHardwareTexture } from \"./WebGPU/webgpuHardwareTexture.js\";\nimport { UniformBuffer } from \"../Materials/uniformBuffer.js\";\nimport { WebGPURenderPassWrapper } from \"./WebGPU/webgpuRenderPassWrapper.js\";\nimport { WebGPUCacheSampler } from \"./WebGPU/webgpuCacheSampler.js\";\nimport { WebGPUCacheRenderPipelineTree } from \"./WebGPU/webgpuCacheRenderPipelineTree.js\";\nimport { WebGPUStencilStateComposer } from \"./WebGPU/webgpuStencilStateComposer.js\";\nimport { WebGPUDepthCullingState } from \"./WebGPU/webgpuDepthCullingState.js\";\nimport { DrawWrapper } from \"../Materials/drawWrapper.js\";\nimport { WebGPUMaterialContext } from \"./WebGPU/webgpuMaterialContext.js\";\nimport { WebGPUDrawContext } from \"./WebGPU/webgpuDrawContext.js\";\nimport { WebGPUCacheBindGroups } from \"./WebGPU/webgpuCacheBindGroups.js\";\nimport { WebGPUClearQuad } from \"./WebGPU/webgpuClearQuad.js\";\nimport { WebGPURenderItemBlendColor, WebGPURenderItemScissor, WebGPURenderItemStencilRef, WebGPURenderItemViewport, WebGPUBundleList } from \"./WebGPU/webgpuBundleList.js\";\nimport { WebGPUTimestampQuery } from \"./WebGPU/webgpuTimestampQuery.js\";\nimport { WebGPUOcclusionQuery } from \"./WebGPU/webgpuOcclusionQuery.js\";\nimport { Observable } from \"../Misc/observable.js\";\nimport { ShaderCodeInliner } from \"./Processors/shaderCodeInliner.js\";\nimport { WebGPUTintWASM } from \"./WebGPU/webgpuTintWASM.js\";\nimport { WebGPUShaderProcessor } from \"./WebGPU/webgpuShaderProcessor.js\";\nimport { ShaderLanguage } from \"../Materials/shaderLanguage.js\";\nimport { WebGPUSnapshotRendering } from \"./WebGPU/webgpuSnapshotRendering.js\";\nimport { PerformanceConfigurator } from \"./performanceConfigurator.js\";\n/**\n * The web GPU engine class provides support for WebGPU version of babylon.js.\n * @since 5.0.0\n */\nvar WebGPUEngine = /** @class */ (function (_super) {\n    __extends(WebGPUEngine, _super);\n    /**\n     * Create a new instance of the gpu engine.\n     * @param canvas Defines the canvas to use to display the result\n     * @param options Defines the options passed to the engine to create the GPU context dependencies\n     */\n    function WebGPUEngine(canvas, options) {\n        if (options === void 0) { options = {}; }\n        var _this = this;\n        var _a, _b, _c, _d;\n        _this = _super.call(this, null) || this;\n        // Page Life cycle and constants\n        _this._uploadEncoderDescriptor = { label: \"upload\" };\n        _this._renderEncoderDescriptor = { label: \"render\" };\n        _this._renderTargetEncoderDescriptor = { label: \"renderTarget\" };\n        /** @hidden */\n        _this._clearDepthValue = 1;\n        /** @hidden */\n        _this._clearReverseDepthValue = 0;\n        /** @hidden */\n        _this._clearStencilValue = 0;\n        _this._defaultSampleCount = 4; // Only supported value for now.\n        _this._glslang = null;\n        _this._tintWASM = null;\n        /** @hidden */\n        _this._compiledComputeEffects = {};\n        /** @hidden */\n        _this._counters = {\n            numEnableEffects: 0,\n            numEnableDrawWrapper: 0,\n            numBundleCreationNonCompatMode: 0,\n            numBundleReuseNonCompatMode: 0,\n        };\n        /**\n         * Counters from last frame\n         */\n        _this.countersLastFrame = {\n            numEnableEffects: 0,\n            numEnableDrawWrapper: 0,\n            numBundleCreationNonCompatMode: 0,\n            numBundleReuseNonCompatMode: 0,\n        };\n        /**\n         * Max number of uncaptured error messages to log\n         */\n        _this.numMaxUncapturedErrors = 20;\n        _this._commandBuffers = [null, null, null];\n        // Frame Buffer Life Cycle (recreated for each render target pass)\n        /** @hidden */\n        _this._currentRenderPass = null;\n        /** @hidden */\n        _this._mainRenderPassWrapper = new WebGPURenderPassWrapper();\n        /** @hidden */\n        _this._rttRenderPassWrapper = new WebGPURenderPassWrapper();\n        /** @hidden */\n        _this._pendingDebugCommands = [];\n        /** @hidden */\n        _this._onAfterUnbindFrameBufferObservable = new Observable();\n        _this._currentOverrideVertexBuffers = null;\n        _this._currentIndexBuffer = null;\n        _this._colorWriteLocal = true;\n        _this._forceEnableEffect = false;\n        // TODO WEBGPU remove those variables when code stabilized\n        /** @hidden */\n        _this.dbgShowShaderCode = false;\n        /** @hidden */\n        _this.dbgSanityChecks = true;\n        /** @hidden */\n        _this.dbgVerboseLogsForFirstFrames = false;\n        /** @hidden */\n        _this.dbgVerboseLogsNumFrames = 10;\n        /** @hidden */\n        _this.dbgLogIfNotDrawWrapper = true;\n        /** @hidden */\n        _this.dbgShowEmptyEnableEffectCalls = true;\n        //------------------------------------------------------------------------------\n        //                              Dynamic WebGPU States\n        //------------------------------------------------------------------------------\n        // index 0 is for main render pass, 1 for RTT render pass\n        _this._viewportsCurrent = [\n            { x: 0, y: 0, w: 0, h: 0 },\n            { x: 0, y: 0, w: 0, h: 0 },\n        ];\n        _this._scissorsCurrent = [\n            { x: 0, y: 0, w: 0, h: 0 },\n            { x: 0, y: 0, w: 0, h: 0 },\n        ];\n        _this._scissorCached = { x: 0, y: 0, z: 0, w: 0 };\n        _this._stencilRefsCurrent = [-1, -1];\n        _this._blendColorsCurrent = [\n            [null, null, null, null],\n            [null, null, null, null],\n        ];\n        _this._name = \"WebGPU\";\n        _this.isNDCHalfZRange = true;\n        _this.hasOriginBottomLeft = false;\n        options.deviceDescriptor = options.deviceDescriptor || {};\n        options.swapChainFormat = options.swapChainFormat || WebGPUConstants.TextureFormat.BGRA8Unorm;\n        options.antialiasing = options.antialiasing === undefined ? true : options.antialiasing;\n        options.stencil = (_a = options.stencil) !== null && _a !== void 0 ? _a : true;\n        options.enableGPUDebugMarkers = (_b = options.enableGPUDebugMarkers) !== null && _b !== void 0 ? _b : false;\n        PerformanceConfigurator.SetMatrixPrecision(!!options.useHighPrecisionMatrix);\n        Logger.Log(\"Babylon.js v\".concat(Engine.Version, \" - \").concat(_this.description, \" engine\"));\n        if (!navigator.gpu) {\n            Logger.Error(\"WebGPU is not supported by your browser.\");\n            return _this;\n        }\n        _this._isWebGPU = true;\n        _this._shaderPlatformName = \"WEBGPU\";\n        if (options.deterministicLockstep === undefined) {\n            options.deterministicLockstep = false;\n        }\n        if (options.lockstepMaxSteps === undefined) {\n            options.lockstepMaxSteps = 4;\n        }\n        if (options.audioEngine === undefined) {\n            options.audioEngine = true;\n        }\n        _this._deterministicLockstep = options.deterministicLockstep;\n        _this._lockstepMaxSteps = options.lockstepMaxSteps;\n        _this._timeStep = options.timeStep || 1 / 60;\n        _this._doNotHandleContextLost = !!options.doNotHandleContextLost;\n        _this._canvas = canvas;\n        _this._options = options;\n        _this.premultipliedAlpha = (_c = options.premultipliedAlpha) !== null && _c !== void 0 ? _c : true;\n        var devicePixelRatio = IsWindowObjectExist() ? window.devicePixelRatio || 1.0 : 1.0;\n        var limitDeviceRatio = options.limitDeviceRatio || devicePixelRatio;\n        var adaptToDeviceRatio = (_d = options.adaptToDeviceRatio) !== null && _d !== void 0 ? _d : false;\n        _this._hardwareScalingLevel = adaptToDeviceRatio ? 1.0 / Math.min(limitDeviceRatio, devicePixelRatio) : 1.0;\n        _this._mainPassSampleCount = options.antialiasing ? _this._defaultSampleCount : 1;\n        _this._isStencilEnable = options.stencil;\n        _this._sharedInit(canvas, !!options.doNotHandleTouchAction, options.audioEngine);\n        _this._shaderProcessor = new WebGPUShaderProcessorGLSL();\n        _this._shaderProcessorWGSL = new WebGPUShaderProcessorWGSL();\n        return _this;\n    }\n    Object.defineProperty(WebGPUEngine.prototype, \"snapshotRenderingMode\", {\n        /**\n         * Gets or sets the snapshot rendering mode\n         */\n        get: function () {\n            return this._snapshotRendering.mode;\n        },\n        set: function (mode) {\n            this._snapshotRendering.mode = mode;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Creates a new snapshot at the next frame using the current snapshotRenderingMode\n     */\n    WebGPUEngine.prototype.snapshotRenderingReset = function () {\n        this._snapshotRendering.reset();\n    };\n    Object.defineProperty(WebGPUEngine.prototype, \"snapshotRendering\", {\n        /**\n         * Enables or disables the snapshot rendering mode\n         * Note that the WebGL engine does not support snapshot rendering so setting the value won't have any effect for this engine\n         */\n        get: function () {\n            return this._snapshotRendering.enabled;\n        },\n        set: function (activate) {\n            this._snapshotRendering.enabled = activate;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"disableCacheSamplers\", {\n        /**\n         * Sets this to true to disable the cache for the samplers. You should do it only for testing purpose!\n         */\n        get: function () {\n            return this._cacheSampler ? this._cacheSampler.disabled : false;\n        },\n        set: function (disable) {\n            if (this._cacheSampler) {\n                this._cacheSampler.disabled = disable;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"disableCacheRenderPipelines\", {\n        /**\n         * Sets this to true to disable the cache for the render pipelines. You should do it only for testing purpose!\n         */\n        get: function () {\n            return this._cacheRenderPipeline ? this._cacheRenderPipeline.disabled : false;\n        },\n        set: function (disable) {\n            if (this._cacheRenderPipeline) {\n                this._cacheRenderPipeline.disabled = disable;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"disableCacheBindGroups\", {\n        /**\n         * Sets this to true to disable the cache for the bind groups. You should do it only for testing purpose!\n         */\n        get: function () {\n            return this._cacheBindGroups ? this._cacheBindGroups.disabled : false;\n        },\n        set: function (disable) {\n            if (this._cacheBindGroups) {\n                this._cacheBindGroups.disabled = disable;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine, \"IsSupportedAsync\", {\n        /**\n         * Gets a Promise<boolean> indicating if the engine can be instantiated (ie. if a WebGPU context can be found)\n         */\n        get: function () {\n            return !navigator.gpu\n                ? Promise.resolve(false)\n                : navigator.gpu\n                    .requestAdapter()\n                    .then(function (adapter) { return !!adapter; }, function () { return false; })\n                    .catch(function () { return false; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine, \"IsSupported\", {\n        /**\n         * Not supported by WebGPU, you should call IsSupportedAsync instead!\n         */\n        get: function () {\n            Logger.Warn(\"You must call IsSupportedAsync for WebGPU!\");\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"supportsUniformBuffers\", {\n        /**\n         * Gets a boolean indicating that the engine supports uniform buffers\n         */\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"supportedExtensions\", {\n        /** Gets the supported extensions by the WebGPU adapter */\n        get: function () {\n            return this._adapterSupportedExtensions;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"enabledExtensions\", {\n        /** Gets the currently enabled extensions on the WebGPU device */\n        get: function () {\n            return this._deviceEnabledExtensions;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"description\", {\n        /**\n         * Returns a string describing the current engine\n         */\n        get: function () {\n            var description = this.name + this.version;\n            return description;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"version\", {\n        /**\n         * Returns the version of the engine\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Gets an object containing information about the current engine context\n     * @returns an object containing the vendor, the renderer and the version of the current engine context\n     */\n    WebGPUEngine.prototype.getInfo = function () {\n        return {\n            vendor: \"unknown vendor\",\n            renderer: \"unknown renderer\",\n            version: \"unknown version\",\n        };\n    };\n    Object.defineProperty(WebGPUEngine.prototype, \"compatibilityMode\", {\n        /**\n         * (WebGPU only) True (default) to be in compatibility mode, meaning rendering all existing scenes without artifacts (same rendering than WebGL).\n         * Setting the property to false will improve performances but may not work in some scenes if some precautions are not taken.\n         * See https://doc.babylonjs.com/advanced_topics/webGPU/webGPUOptimization/webGPUNonCompatibilityMode for more details\n         */\n        get: function () {\n            return this._compatibilityMode;\n        },\n        set: function (mode) {\n            this._compatibilityMode = mode;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(WebGPUEngine.prototype, \"currentSampleCount\", {\n        /** @hidden */\n        get: function () {\n            return this._currentRenderTarget ? this._currentRenderTarget.samples : this._mainPassSampleCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Create a new instance of the gpu engine asynchronously\n     * @param canvas Defines the canvas to use to display the result\n     * @param options Defines the options passed to the engine to create the GPU context dependencies\n     * @returns a promise that resolves with the created engine\n     */\n    WebGPUEngine.CreateAsync = function (canvas, options) {\n        if (options === void 0) { options = {}; }\n        var engine = new WebGPUEngine(canvas, options);\n        return new Promise(function (resolve) {\n            engine.initAsync(options.glslangOptions, options.twgslOptions).then(function () { return resolve(engine); });\n        });\n    };\n    //------------------------------------------------------------------------------\n    //                              Initialization\n    //------------------------------------------------------------------------------\n    /**\n     * Initializes the WebGPU context and dependencies.\n     * @param glslangOptions Defines the GLSLang compiler options if necessary\n     * @param twgslOptions Defines the Twgsl compiler options if necessary\n     * @returns a promise notifying the readiness of the engine.\n     */\n    WebGPUEngine.prototype.initAsync = function (glslangOptions, twgslOptions) {\n        var _this = this;\n        var _a;\n        return this._initGlslang(glslangOptions !== null && glslangOptions !== void 0 ? glslangOptions : (_a = this._options) === null || _a === void 0 ? void 0 : _a.glslangOptions)\n            .then(function (glslang) {\n            var _a;\n            _this._glslang = glslang;\n            _this._tintWASM = WebGPUEngine.UseTWGSL ? new WebGPUTintWASM() : null;\n            return _this._tintWASM\n                ? _this._tintWASM.initTwgsl(twgslOptions !== null && twgslOptions !== void 0 ? twgslOptions : (_a = _this._options) === null || _a === void 0 ? void 0 : _a.twgslOptions).then(function () {\n                    return navigator.gpu.requestAdapter(_this._options);\n                }, function (msg) {\n                    Logger.Error(\"Can not initialize twgsl!\");\n                    Logger.Error(msg);\n                    throw Error(\"WebGPU initializations stopped.\");\n                })\n                : navigator.gpu.requestAdapter(_this._options);\n        }, function (msg) {\n            Logger.Error(\"Can not initialize glslang!\");\n            Logger.Error(msg);\n            throw Error(\"WebGPU initializations stopped.\");\n        })\n            .then(function (adapter) {\n            var _a;\n            if (!adapter) {\n                throw \"Could not retrieve a WebGPU adapter (adapter is null).\";\n            }\n            else {\n                _this._adapter = adapter;\n                _this._adapterSupportedExtensions = [];\n                (_a = _this._adapter.features) === null || _a === void 0 ? void 0 : _a.forEach(function (feature) { return _this._adapterSupportedExtensions.push(feature); });\n                var deviceDescriptor = _this._options.deviceDescriptor;\n                if (deviceDescriptor === null || deviceDescriptor === void 0 ? void 0 : deviceDescriptor.requiredFeatures) {\n                    var requestedExtensions = deviceDescriptor.requiredFeatures;\n                    var validExtensions = [];\n                    for (var _i = 0, requestedExtensions_1 = requestedExtensions; _i < requestedExtensions_1.length; _i++) {\n                        var extension = requestedExtensions_1[_i];\n                        if (_this._adapterSupportedExtensions.indexOf(extension) !== -1) {\n                            validExtensions.push(extension);\n                        }\n                    }\n                    deviceDescriptor.requiredFeatures = validExtensions;\n                }\n                return _this._adapter.requestDevice(_this._options.deviceDescriptor);\n            }\n        })\n            .then(function (device) {\n            var _a, _b;\n            _this._device = device;\n            _this._deviceEnabledExtensions = [];\n            (_a = _this._device.features) === null || _a === void 0 ? void 0 : _a.forEach(function (feature) { return _this._deviceEnabledExtensions.push(feature); });\n            var numUncapturedErrors = -1;\n            _this._device.addEventListener(\"uncapturederror\", function (event) {\n                if (++numUncapturedErrors < _this.numMaxUncapturedErrors) {\n                    Logger.Warn(\"WebGPU uncaptured error (\".concat(numUncapturedErrors + 1, \"): \").concat(event.error, \" - \").concat(event.error.message));\n                }\n                else if (numUncapturedErrors++ === _this.numMaxUncapturedErrors) {\n                    Logger.Warn(\"WebGPU uncaptured error: too many warnings (\".concat(_this.numMaxUncapturedErrors, \"), no more warnings will be reported to the console for this engine.\"));\n                }\n            });\n            if (!_this._doNotHandleContextLost) {\n                (_b = _this._device.lost) === null || _b === void 0 ? void 0 : _b.then(function (info) {\n                    _this._contextWasLost = true;\n                    Logger.Warn(\"WebGPU context lost. \" + info);\n                    _this.onContextLostObservable.notifyObservers(_this);\n                    _this._restoreEngineAfterContextLost(_this.initAsync.bind(_this));\n                });\n            }\n        }, function (e) {\n            Logger.Error(\"Could not retrieve a WebGPU device.\");\n            Logger.Error(e);\n        })\n            .then(function () {\n            _this._bufferManager = new WebGPUBufferManager(_this._device);\n            _this._textureHelper = new WebGPUTextureHelper(_this._device, _this._glslang, _this._tintWASM, _this._bufferManager);\n            _this._cacheSampler = new WebGPUCacheSampler(_this._device);\n            _this._cacheBindGroups = new WebGPUCacheBindGroups(_this._device, _this._cacheSampler, _this);\n            _this._timestampQuery = new WebGPUTimestampQuery(_this._device, _this._bufferManager);\n            _this._occlusionQuery = _this._device.createQuerySet ? new WebGPUOcclusionQuery(_this, _this._device, _this._bufferManager) : undefined;\n            _this._bundleList = new WebGPUBundleList(_this._device);\n            _this._bundleListRenderTarget = new WebGPUBundleList(_this._device);\n            _this._snapshotRendering = new WebGPUSnapshotRendering(_this, _this._snapshotRenderingMode, _this._bundleList, _this._bundleListRenderTarget);\n            _this._ubInvertY = _this._bufferManager.createBuffer(new Float32Array([-1, 0]), WebGPUConstants.BufferUsage.Uniform | WebGPUConstants.BufferUsage.CopyDst);\n            _this._ubDontInvertY = _this._bufferManager.createBuffer(new Float32Array([1, 0]), WebGPUConstants.BufferUsage.Uniform | WebGPUConstants.BufferUsage.CopyDst);\n            if (_this.dbgVerboseLogsForFirstFrames) {\n                if (_this._count === undefined) {\n                    _this._count = 0;\n                    console.log(\"%c frame #\" + _this._count + \" - begin\", \"background: #ffff00\");\n                }\n            }\n            _this._uploadEncoder = _this._device.createCommandEncoder(_this._uploadEncoderDescriptor);\n            _this._renderEncoder = _this._device.createCommandEncoder(_this._renderEncoderDescriptor);\n            _this._renderTargetEncoder = _this._device.createCommandEncoder(_this._renderTargetEncoderDescriptor);\n            _this._emptyVertexBuffer = new VertexBuffer(_this, [0], \"\", false, false, 1, false, 0, 1);\n            _this._initializeLimits();\n            _this._cacheRenderPipeline = new WebGPUCacheRenderPipelineTree(_this._device, _this._emptyVertexBuffer, !_this._caps.textureFloatLinearFiltering);\n            _this._depthCullingState = new WebGPUDepthCullingState(_this._cacheRenderPipeline);\n            _this._stencilStateComposer = new WebGPUStencilStateComposer(_this._cacheRenderPipeline);\n            _this._stencilStateComposer.stencilGlobal = _this._stencilState;\n            _this._depthCullingState.depthTest = true;\n            _this._depthCullingState.depthFunc = 515;\n            _this._depthCullingState.depthMask = true;\n            _this._textureHelper.setCommandEncoder(_this._uploadEncoder);\n            _this._clearQuad = new WebGPUClearQuad(_this._device, _this, _this._emptyVertexBuffer);\n            _this._defaultDrawContext = _this.createDrawContext();\n            _this._currentDrawContext = _this._defaultDrawContext;\n            _this._defaultMaterialContext = _this.createMaterialContext();\n            _this._currentMaterialContext = _this._defaultMaterialContext;\n            _this._initializeContextAndSwapChain();\n            _this._initializeMainAttachments();\n            _this.resize();\n        })\n            .catch(function (e) {\n            Logger.Error(\"Can not create WebGPU Device and/or context.\");\n            Logger.Error(e);\n            if (console.trace) {\n                console.trace();\n            }\n        });\n    };\n    WebGPUEngine.prototype._initGlslang = function (glslangOptions) {\n        glslangOptions = glslangOptions || {};\n        glslangOptions = __assign(__assign({}, WebGPUEngine._GLSLslangDefaultOptions), glslangOptions);\n        if (glslangOptions.glslang) {\n            return Promise.resolve(glslangOptions.glslang);\n        }\n        if (self.glslang) {\n            return self.glslang(glslangOptions.wasmPath);\n        }\n        if (glslangOptions.jsPath && glslangOptions.wasmPath) {\n            if (IsWindowObjectExist()) {\n                return Tools.LoadScriptAsync(glslangOptions.jsPath).then(function () {\n                    return self.glslang(glslangOptions.wasmPath);\n                });\n            }\n            else {\n                importScripts(glslangOptions.jsPath);\n                return self.glslang(glslangOptions.wasmPath);\n            }\n        }\n        return Promise.reject(\"gslang is not available.\");\n    };\n    WebGPUEngine.prototype._initializeLimits = function () {\n        // Init caps\n        // TODO WEBGPU Real Capability check once limits will be working.\n        this._caps = {\n            maxTexturesImageUnits: 16,\n            maxVertexTextureImageUnits: 16,\n            maxCombinedTexturesImageUnits: 32,\n            maxTextureSize: 8192,\n            maxCubemapTextureSize: 2048,\n            maxRenderTextureSize: 8192,\n            maxVertexAttribs: 16,\n            maxVaryingVectors: 15,\n            maxFragmentUniformVectors: 1024,\n            maxVertexUniformVectors: 1024,\n            standardDerivatives: true,\n            astc: (this._deviceEnabledExtensions.indexOf(WebGPUConstants.FeatureName.TextureCompressionASTC) >= 0 ? true : undefined),\n            s3tc: (this._deviceEnabledExtensions.indexOf(WebGPUConstants.FeatureName.TextureCompressionBC) >= 0 ? true : undefined),\n            pvrtc: null,\n            etc1: null,\n            etc2: (this._deviceEnabledExtensions.indexOf(WebGPUConstants.FeatureName.TextureCompressionETC2) >= 0 ? true : undefined),\n            bptc: this._deviceEnabledExtensions.indexOf(WebGPUConstants.FeatureName.TextureCompressionBC) >= 0 ? true : undefined,\n            maxAnisotropy: 4,\n            uintIndices: true,\n            fragmentDepthSupported: true,\n            highPrecisionShaderSupported: true,\n            colorBufferFloat: true,\n            textureFloat: true,\n            textureFloatLinearFiltering: false,\n            textureFloatRender: true,\n            textureHalfFloat: true,\n            textureHalfFloatLinearFiltering: true,\n            textureHalfFloatRender: true,\n            textureLOD: true,\n            drawBuffersExtension: true,\n            depthTextureExtension: true,\n            vertexArrayObject: false,\n            instancedArrays: true,\n            timerQuery: typeof BigUint64Array !== \"undefined\" && this.enabledExtensions.indexOf(WebGPUConstants.FeatureName.TimestampQuery) !== -1 ? true : undefined,\n            supportOcclusionQuery: typeof BigUint64Array !== \"undefined\",\n            canUseTimestampForTimerQuery: true,\n            multiview: false,\n            oculusMultiview: false,\n            parallelShaderCompile: undefined,\n            blendMinMax: true,\n            maxMSAASamples: 4,\n            canUseGLInstanceID: true,\n            canUseGLVertexID: true,\n            supportComputeShaders: true,\n            supportSRGBBuffers: true,\n            supportTransformFeedbacks: false,\n            textureMaxLevel: true,\n            texture2DArrayMaxLayerCount: 2048,\n        };\n        this._caps.parallelShaderCompile = null;\n        this._features = {\n            forceBitmapOverHTMLImageElement: true,\n            supportRenderAndCopyToLodForFloatTextures: true,\n            supportDepthStencilTexture: true,\n            supportShadowSamplers: true,\n            uniformBufferHardCheckMatrix: false,\n            allowTexturePrefiltering: true,\n            trackUbosInFrame: true,\n            checkUbosContentBeforeUpload: true,\n            supportCSM: true,\n            basisNeedsPOT: false,\n            support3DTextures: true,\n            needTypeSuffixInShaderConstants: true,\n            supportMSAA: true,\n            supportSSAO2: true,\n            supportExtendedTextureFormats: true,\n            supportSwitchCaseInShader: true,\n            supportSyncTextureRead: false,\n            needsInvertingBitmap: false,\n            useUBOBindingCache: false,\n            needShaderCodeInlining: true,\n            needToAlwaysBindUniformBuffers: true,\n            supportRenderPasses: true,\n            _collectUbosUpdatedInFrame: false,\n        };\n    };\n    WebGPUEngine.prototype._initializeContextAndSwapChain = function () {\n        this._context = this._canvas.getContext(\"webgpu\");\n        this._configureContext();\n        this._colorFormat = this._options.swapChainFormat;\n        this._mainRenderPassWrapper.colorAttachmentGPUTextures = [new WebGPUHardwareTexture()];\n        this._mainRenderPassWrapper.colorAttachmentGPUTextures[0].format = this._colorFormat;\n    };\n    // Set default values as WebGL with depth and stencil attachment for the broadest Compat.\n    WebGPUEngine.prototype._initializeMainAttachments = function () {\n        var _a;\n        this._mainTextureExtends = {\n            width: this.getRenderWidth(),\n            height: this.getRenderHeight(),\n            depthOrArrayLayers: 1,\n        };\n        var bufferDataUpdate = new Float32Array([this.getRenderHeight()]);\n        this._bufferManager.setSubData(this._ubInvertY, 4, bufferDataUpdate);\n        this._bufferManager.setSubData(this._ubDontInvertY, 4, bufferDataUpdate);\n        var mainColorAttachments;\n        if (this._options.antialiasing) {\n            var mainTextureDescriptor = {\n                size: this._mainTextureExtends,\n                mipLevelCount: 1,\n                sampleCount: this._mainPassSampleCount,\n                dimension: WebGPUConstants.TextureDimension.E2d,\n                format: this._options.swapChainFormat,\n                usage: WebGPUConstants.TextureUsage.RenderAttachment,\n            };\n            (_a = this._mainTexture) === null || _a === void 0 ? void 0 : _a.destroy();\n            this._mainTexture = this._device.createTexture(mainTextureDescriptor);\n            mainColorAttachments = [\n                {\n                    view: this._mainTexture.createView(),\n                    clearValue: new Color4(0, 0, 0, 1),\n                    loadOp: WebGPUConstants.LoadOp.Clear,\n                    storeOp: WebGPUConstants.StoreOp.Store, // don't use StoreOp.Discard, else using several cameras with different viewports or using scissors will fail because we call beginRenderPass / endPass several times for the same color attachment!\n                },\n            ];\n        }\n        else {\n            mainColorAttachments = [\n                {\n                    view: undefined,\n                    clearValue: new Color4(0, 0, 0, 1),\n                    loadOp: WebGPUConstants.LoadOp.Clear,\n                    storeOp: WebGPUConstants.StoreOp.Store,\n                },\n            ];\n        }\n        this._mainRenderPassWrapper.depthTextureFormat = this.isStencilEnable ? WebGPUConstants.TextureFormat.Depth24PlusStencil8 : WebGPUConstants.TextureFormat.Depth32Float;\n        this._setDepthTextureFormat(this._mainRenderPassWrapper);\n        var depthTextureDescriptor = {\n            size: this._mainTextureExtends,\n            mipLevelCount: 1,\n            sampleCount: this._mainPassSampleCount,\n            dimension: WebGPUConstants.TextureDimension.E2d,\n            format: this._mainRenderPassWrapper.depthTextureFormat,\n            usage: WebGPUConstants.TextureUsage.RenderAttachment,\n        };\n        if (this._depthTexture) {\n            this._depthTexture.destroy();\n        }\n        this._depthTexture = this._device.createTexture(depthTextureDescriptor);\n        var mainDepthAttachment = {\n            view: this._depthTexture.createView(),\n            depthClearValue: this._clearDepthValue,\n            depthLoadOp: WebGPUConstants.LoadOp.Clear,\n            depthStoreOp: WebGPUConstants.StoreOp.Store,\n            stencilClearValue: this._clearStencilValue,\n            stencilLoadOp: !this.isStencilEnable ? undefined : WebGPUConstants.LoadOp.Clear,\n            stencilStoreOp: !this.isStencilEnable ? undefined : WebGPUConstants.StoreOp.Store,\n        };\n        this._mainRenderPassWrapper.renderPassDescriptor = {\n            colorAttachments: mainColorAttachments,\n            depthStencilAttachment: mainDepthAttachment,\n        };\n        if (this._mainRenderPassWrapper.renderPass !== null) {\n            this._endMainRenderPass();\n        }\n    };\n    WebGPUEngine.prototype._configureContext = function () {\n        this._context.configure({\n            device: this._device,\n            format: this._options.swapChainFormat,\n            usage: WebGPUConstants.TextureUsage.RenderAttachment | WebGPUConstants.TextureUsage.CopySrc,\n            compositingAlphaMode: this.premultipliedAlpha ? WebGPUConstants.CanvasCompositingAlphaMode.Premultiplied : WebGPUConstants.CanvasCompositingAlphaMode.Opaque,\n        });\n    };\n    /**\n     * Force a specific size of the canvas\n     * @param width defines the new canvas' width\n     * @param height defines the new canvas' height\n     * @param forceSetSize true to force setting the sizes of the underlying canvas\n     * @returns true if the size was changed\n     */\n    WebGPUEngine.prototype.setSize = function (width, height, forceSetSize) {\n        if (forceSetSize === void 0) { forceSetSize = false; }\n        if (!_super.prototype.setSize.call(this, width, height, forceSetSize)) {\n            return false;\n        }\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - setSize called -\", width, height);\n            }\n        }\n        this._initializeMainAttachments();\n        if (this.snapshotRendering) {\n            // reset snapshot rendering so that the next frame will record a new list of bundles\n            this.snapshotRenderingReset();\n        }\n        return true;\n    };\n    /**\n     * @param shaderLanguage\n     * @hidden\n     */\n    WebGPUEngine.prototype._getShaderProcessor = function (shaderLanguage) {\n        if (shaderLanguage === ShaderLanguage.WGSL) {\n            return this._shaderProcessorWGSL;\n        }\n        return this._shaderProcessor;\n    };\n    /**\n     * @param shaderLanguage\n     * @hidden\n     */\n    WebGPUEngine.prototype._getShaderProcessingContext = function (shaderLanguage) {\n        return new WebGPUShaderProcessingContext(shaderLanguage);\n    };\n    //------------------------------------------------------------------------------\n    //                          Static Pipeline WebGPU States\n    //------------------------------------------------------------------------------\n    /** @hidden */\n    WebGPUEngine.prototype.applyStates = function () {\n        this._stencilStateComposer.apply();\n        this._cacheRenderPipeline.setAlphaBlendEnabled(this._alphaState.alphaBlend);\n    };\n    /**\n     * Force the entire cache to be cleared\n     * You should not have to use this function unless your engine needs to share the WebGPU context with another engine\n     * @param bruteForce defines a boolean to force clearing ALL caches (including stencil, detoh and alpha states)\n     */\n    WebGPUEngine.prototype.wipeCaches = function (bruteForce) {\n        if (this.preventCacheWipeBetweenFrames && !bruteForce) {\n            return;\n        }\n        //this._currentEffect = null; // can't reset _currentEffect, else some crashes can occur (for eg in ProceduralTexture which calls bindFrameBuffer (which calls wipeCaches) after having called enableEffect and before drawing into the texture)\n        // _forceEnableEffect = true assumes the role of _currentEffect = null\n        this._forceEnableEffect = true;\n        this._currentIndexBuffer = null;\n        this._currentOverrideVertexBuffers = null;\n        this._cacheRenderPipeline.setBuffers(null, null, null);\n        if (bruteForce) {\n            this._stencilStateComposer.reset();\n            this._depthCullingState.reset();\n            this._depthCullingState.depthFunc = 515;\n            this._alphaState.reset();\n            this._alphaMode = 1;\n            this._alphaEquation = 0;\n            this._cacheRenderPipeline.setAlphaBlendFactors(this._alphaState._blendFunctionParameters, this._alphaState._blendEquationParameters);\n            this._cacheRenderPipeline.setAlphaBlendEnabled(false);\n            this.setColorWrite(true);\n        }\n        this._cachedVertexBuffers = null;\n        this._cachedIndexBuffer = null;\n        this._cachedEffectForVertexBuffers = null;\n    };\n    /**\n     * Enable or disable color writing\n     * @param enable defines the state to set\n     */\n    WebGPUEngine.prototype.setColorWrite = function (enable) {\n        this._colorWriteLocal = enable;\n        this._cacheRenderPipeline.setWriteMask(enable ? 0xf : 0);\n    };\n    /**\n     * Gets a boolean indicating if color writing is enabled\n     * @returns the current color writing state\n     */\n    WebGPUEngine.prototype.getColorWrite = function () {\n        return this._colorWriteLocal;\n    };\n    WebGPUEngine.prototype._resetCurrentViewport = function (index) {\n        this._viewportsCurrent[index].x = 0;\n        this._viewportsCurrent[index].y = 0;\n        this._viewportsCurrent[index].w = 0;\n        this._viewportsCurrent[index].h = 0;\n        if (index === 1) {\n            this._viewportCached.x = 0;\n            this._viewportCached.y = 0;\n            this._viewportCached.z = 0;\n            this._viewportCached.w = 0;\n        }\n    };\n    WebGPUEngine.prototype._mustUpdateViewport = function (renderPass) {\n        var index = renderPass === this._mainRenderPassWrapper.renderPass ? 0 : 1;\n        var x = this._viewportCached.x, y = this._viewportCached.y, w = this._viewportCached.z, h = this._viewportCached.w;\n        var update = this._viewportsCurrent[index].x !== x || this._viewportsCurrent[index].y !== y || this._viewportsCurrent[index].w !== w || this._viewportsCurrent[index].h !== h;\n        if (update) {\n            this._viewportsCurrent[index].x = this._viewportCached.x;\n            this._viewportsCurrent[index].y = this._viewportCached.y;\n            this._viewportsCurrent[index].w = this._viewportCached.z;\n            this._viewportsCurrent[index].h = this._viewportCached.w;\n        }\n        return update;\n    };\n    WebGPUEngine.prototype._applyViewport = function (renderPass) {\n        var y = Math.floor(this._viewportCached.y);\n        var h = Math.floor(this._viewportCached.w);\n        if (!this._currentRenderTarget) {\n            y = this.getRenderHeight() - y - h;\n        }\n        renderPass.setViewport(Math.floor(this._viewportCached.x), y, Math.floor(this._viewportCached.z), h, 0, 1);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - viewport applied - (\", this._viewportCached.x, this._viewportCached.y, this._viewportCached.z, this._viewportCached.w, \") current pass is main pass=\" + (renderPass === this._mainRenderPassWrapper.renderPass));\n            }\n        }\n    };\n    /**\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @hidden\n     */\n    WebGPUEngine.prototype._viewport = function (x, y, width, height) {\n        this._viewportCached.x = x;\n        this._viewportCached.y = y;\n        this._viewportCached.z = width;\n        this._viewportCached.w = height;\n    };\n    WebGPUEngine.prototype._resetCurrentScissor = function (index) {\n        this._scissorsCurrent[index].x = 0;\n        this._scissorsCurrent[index].y = 0;\n        this._scissorsCurrent[index].w = 0;\n        this._scissorsCurrent[index].h = 0;\n    };\n    WebGPUEngine.prototype._mustUpdateScissor = function (renderPass) {\n        var index = renderPass === this._mainRenderPassWrapper.renderPass ? 0 : 1;\n        var x = this._scissorCached.x, y = this._scissorCached.y, w = this._scissorCached.z, h = this._scissorCached.w;\n        var update = this._scissorsCurrent[index].x !== x || this._scissorsCurrent[index].y !== y || this._scissorsCurrent[index].w !== w || this._scissorsCurrent[index].h !== h;\n        if (update) {\n            this._scissorsCurrent[index].x = this._scissorCached.x;\n            this._scissorsCurrent[index].y = this._scissorCached.y;\n            this._scissorsCurrent[index].w = this._scissorCached.z;\n            this._scissorsCurrent[index].h = this._scissorCached.w;\n        }\n        return update;\n    };\n    WebGPUEngine.prototype._applyScissor = function (renderPass) {\n        renderPass.setScissorRect(this._scissorCached.x, this._currentRenderTarget ? this._scissorCached.y : this.getRenderHeight() - this._scissorCached.w - this._scissorCached.y, this._scissorCached.z, this._scissorCached.w);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - scissor applied - (\", this._scissorCached.x, this._scissorCached.y, this._scissorCached.z, this._scissorCached.w, \") current pass is main pass=\" + (renderPass === this._mainRenderPassWrapper.renderPass));\n            }\n        }\n    };\n    WebGPUEngine.prototype._scissorIsActive = function () {\n        return this._scissorCached.x !== 0 || this._scissorCached.y !== 0 || this._scissorCached.z !== 0 || this._scissorCached.w !== 0;\n    };\n    WebGPUEngine.prototype.enableScissor = function (x, y, width, height) {\n        this._scissorCached.x = x;\n        this._scissorCached.y = y;\n        this._scissorCached.z = width;\n        this._scissorCached.w = height;\n    };\n    WebGPUEngine.prototype.disableScissor = function () {\n        this._scissorCached.x = 0;\n        this._scissorCached.y = 0;\n        this._scissorCached.z = 0;\n        this._scissorCached.w = 0;\n        this._resetCurrentScissor(0);\n        this._resetCurrentScissor(1);\n    };\n    WebGPUEngine.prototype._resetCurrentStencilRef = function (index) {\n        this._stencilRefsCurrent[index] = -1;\n    };\n    WebGPUEngine.prototype._mustUpdateStencilRef = function (renderPass) {\n        var index = renderPass === this._mainRenderPassWrapper.renderPass ? 0 : 1;\n        var update = this._stencilStateComposer.funcRef !== this._stencilRefsCurrent[index];\n        if (update) {\n            this._stencilRefsCurrent[index] = this._stencilStateComposer.funcRef;\n        }\n        return update;\n    };\n    /**\n     * @param renderPass\n     * @hidden\n     */\n    WebGPUEngine.prototype._applyStencilRef = function (renderPass) {\n        var _a;\n        renderPass.setStencilReference((_a = this._stencilStateComposer.funcRef) !== null && _a !== void 0 ? _a : 0);\n    };\n    WebGPUEngine.prototype._resetCurrentColorBlend = function (index) {\n        this._blendColorsCurrent[index][0] = this._blendColorsCurrent[index][1] = this._blendColorsCurrent[index][2] = this._blendColorsCurrent[index][3] = null;\n    };\n    WebGPUEngine.prototype._mustUpdateBlendColor = function (renderPass) {\n        var index = renderPass === this._mainRenderPassWrapper.renderPass ? 0 : 1;\n        var colorBlend = this._alphaState._blendConstants;\n        var update = colorBlend[0] !== this._blendColorsCurrent[index][0] ||\n            colorBlend[1] !== this._blendColorsCurrent[index][1] ||\n            colorBlend[2] !== this._blendColorsCurrent[index][2] ||\n            colorBlend[3] !== this._blendColorsCurrent[index][3];\n        if (update) {\n            this._blendColorsCurrent[index][0] = colorBlend[0];\n            this._blendColorsCurrent[index][1] = colorBlend[1];\n            this._blendColorsCurrent[index][2] = colorBlend[2];\n            this._blendColorsCurrent[index][3] = colorBlend[3];\n        }\n        return update;\n    };\n    WebGPUEngine.prototype._applyBlendColor = function (renderPass) {\n        renderPass.setBlendConstant(this._alphaState._blendConstants);\n    };\n    /**\n     * Clear the current render buffer or the current render target (if any is set up)\n     * @param color defines the color to use\n     * @param backBuffer defines if the back buffer must be cleared\n     * @param depth defines if the depth buffer must be cleared\n     * @param stencil defines if the stencil buffer must be cleared\n     */\n    WebGPUEngine.prototype.clear = function (color, backBuffer, depth, stencil) {\n        if (stencil === void 0) { stencil = false; }\n        // Some PGs are using color3...\n        if (color && color.a === undefined) {\n            color.a = 1;\n        }\n        var hasScissor = this._scissorIsActive();\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - clear called - backBuffer=\", backBuffer, \" depth=\", depth, \" stencil=\", stencil, \" scissor is active=\", hasScissor);\n            }\n        }\n        // We need to recreate the render pass so that the new parameters for clear color / depth / stencil are taken into account\n        if (this._currentRenderTarget) {\n            if (hasScissor) {\n                if (!this._rttRenderPassWrapper.renderPass) {\n                    this._startRenderTargetRenderPass(this._currentRenderTarget, false, backBuffer ? color : null, depth, stencil);\n                }\n                if (!this.compatibilityMode) {\n                    this._bundleListRenderTarget.addItem(new WebGPURenderItemScissor(this._scissorCached.x, this._scissorCached.y, this._scissorCached.z, this._scissorCached.w));\n                }\n                else {\n                    this._applyScissor(this._currentRenderPass);\n                }\n                this._clearFullQuad(backBuffer ? color : null, depth, stencil);\n            }\n            else {\n                if (this._currentRenderPass) {\n                    this._endRenderTargetRenderPass();\n                }\n                this._startRenderTargetRenderPass(this._currentRenderTarget, true, backBuffer ? color : null, depth, stencil);\n            }\n        }\n        else {\n            if (!this._mainRenderPassWrapper.renderPass || !hasScissor) {\n                this._startMainRenderPass(!hasScissor, backBuffer ? color : null, depth, stencil);\n            }\n            if (hasScissor) {\n                if (!this.compatibilityMode) {\n                    this._bundleList.addItem(new WebGPURenderItemScissor(this._scissorCached.x, this._scissorCached.y, this._scissorCached.z, this._scissorCached.w));\n                }\n                else {\n                    this._applyScissor(this._currentRenderPass);\n                }\n                this._clearFullQuad(backBuffer ? color : null, depth, stencil);\n            }\n        }\n    };\n    WebGPUEngine.prototype._clearFullQuad = function (clearColor, clearDepth, clearStencil) {\n        var _a, _b, _c;\n        var renderPass = !this.compatibilityMode ? null : this._getCurrentRenderPass();\n        var renderPassIndex = this._getCurrentRenderPassIndex();\n        var bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\n        this._clearQuad.setColorFormat(this._colorFormat);\n        this._clearQuad.setDepthStencilFormat(this._depthTextureFormat);\n        this._clearQuad.setMRTAttachments((_a = this._cacheRenderPipeline.mrtAttachments) !== null && _a !== void 0 ? _a : [], (_b = this._cacheRenderPipeline.mrtTextureArray) !== null && _b !== void 0 ? _b : [], this._cacheRenderPipeline.mrtTextureCount);\n        if (!this.compatibilityMode) {\n            bundleList.addItem(new WebGPURenderItemStencilRef(this._clearStencilValue));\n        }\n        else {\n            renderPass.setStencilReference(this._clearStencilValue);\n        }\n        var bundle = this._clearQuad.clear(renderPass, clearColor, clearDepth, clearStencil, this.currentSampleCount);\n        if (!this.compatibilityMode) {\n            bundleList.addBundle(bundle);\n            bundleList.addItem(new WebGPURenderItemStencilRef((_c = this._stencilStateComposer.funcRef) !== null && _c !== void 0 ? _c : 0));\n            this._reportDrawCall();\n        }\n        else {\n            this._applyStencilRef(renderPass);\n        }\n    };\n    //------------------------------------------------------------------------------\n    //                              Vertex/Index/Storage Buffers\n    //------------------------------------------------------------------------------\n    /**\n     * Creates a vertex buffer\n     * @param data the data for the vertex buffer\n     * @returns the new buffer\n     */\n    WebGPUEngine.prototype.createVertexBuffer = function (data) {\n        var view;\n        if (data instanceof Array) {\n            view = new Float32Array(data);\n        }\n        else if (data instanceof ArrayBuffer) {\n            view = new Uint8Array(data);\n        }\n        else {\n            view = data;\n        }\n        var dataBuffer = this._bufferManager.createBuffer(view, WebGPUConstants.BufferUsage.Vertex | WebGPUConstants.BufferUsage.CopyDst);\n        return dataBuffer;\n    };\n    /**\n     * Creates a vertex buffer\n     * @param data the data for the dynamic vertex buffer\n     * @returns the new buffer\n     */\n    WebGPUEngine.prototype.createDynamicVertexBuffer = function (data) {\n        return this.createVertexBuffer(data);\n    };\n    /**\n     * Creates a new index buffer\n     * @param indices defines the content of the index buffer\n     * @returns a new buffer\n     */\n    WebGPUEngine.prototype.createIndexBuffer = function (indices) {\n        var is32Bits = true;\n        var view;\n        if (indices instanceof Uint32Array || indices instanceof Int32Array) {\n            view = indices;\n        }\n        else if (indices instanceof Uint16Array) {\n            view = indices;\n            is32Bits = false;\n        }\n        else {\n            if (indices.length > 65535) {\n                view = new Uint32Array(indices);\n            }\n            else {\n                view = new Uint16Array(indices);\n                is32Bits = false;\n            }\n        }\n        var dataBuffer = this._bufferManager.createBuffer(view, WebGPUConstants.BufferUsage.Index | WebGPUConstants.BufferUsage.CopyDst);\n        dataBuffer.is32Bits = is32Bits;\n        return dataBuffer;\n    };\n    /**\n     * @param data\n     * @param creationFlags\n     * @hidden\n     */\n    WebGPUEngine.prototype._createBuffer = function (data, creationFlags) {\n        var view;\n        if (data instanceof Array) {\n            view = new Float32Array(data);\n        }\n        else if (data instanceof ArrayBuffer) {\n            view = new Uint8Array(data);\n        }\n        else {\n            view = data;\n        }\n        var flags = 0;\n        if (creationFlags & 1) {\n            flags |= WebGPUConstants.BufferUsage.CopySrc;\n        }\n        if (creationFlags & 2) {\n            flags |= WebGPUConstants.BufferUsage.CopyDst;\n        }\n        if (creationFlags & 4) {\n            flags |= WebGPUConstants.BufferUsage.Uniform;\n        }\n        if (creationFlags & 8) {\n            flags |= WebGPUConstants.BufferUsage.Vertex;\n        }\n        if (creationFlags & 16) {\n            flags |= WebGPUConstants.BufferUsage.Index;\n        }\n        if (creationFlags & 32) {\n            flags |= WebGPUConstants.BufferUsage.Storage;\n        }\n        return this._bufferManager.createBuffer(view, flags);\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.bindBuffersDirectly = function () {\n        throw \"Not implemented on WebGPU\";\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.updateAndBindInstancesBuffer = function () {\n        throw \"Not implemented on WebGPU\";\n    };\n    /**\n     * Bind a list of vertex buffers with the engine\n     * @param vertexBuffers defines the list of vertex buffers to bind\n     * @param indexBuffer defines the index buffer to bind\n     * @param effect defines the effect associated with the vertex buffers\n     * @param overrideVertexBuffers defines optional list of avertex buffers that overrides the entries in vertexBuffers\n     */\n    WebGPUEngine.prototype.bindBuffers = function (vertexBuffers, indexBuffer, effect, overrideVertexBuffers) {\n        this._currentIndexBuffer = indexBuffer;\n        this._currentOverrideVertexBuffers = overrideVertexBuffers !== null && overrideVertexBuffers !== void 0 ? overrideVertexBuffers : null;\n        this._cacheRenderPipeline.setBuffers(vertexBuffers, indexBuffer, this._currentOverrideVertexBuffers);\n    };\n    /**\n     * @param buffer\n     * @hidden\n     */\n    WebGPUEngine.prototype._releaseBuffer = function (buffer) {\n        return this._bufferManager.releaseBuffer(buffer);\n    };\n    //------------------------------------------------------------------------------\n    //                              Effects\n    //------------------------------------------------------------------------------\n    /**\n     * Create a new effect (used to store vertex/fragment shaders)\n     * @param baseName defines the base name of the effect (The name of file without .fragment.fx or .vertex.fx)\n     * @param attributesNamesOrOptions defines either a list of attribute names or an IEffectCreationOptions object\n     * @param uniformsNamesOrEngine defines either a list of uniform names or the engine to use\n     * @param samplers defines an array of string used to represent textures\n     * @param defines defines the string containing the defines to use to compile the shaders\n     * @param fallbacks defines the list of potential fallbacks to use if shader compilation fails\n     * @param onCompiled defines a function to call when the effect creation is successful\n     * @param onError defines a function to call when the effect creation has failed\n     * @param indexParameters defines an object containing the index values to use to compile shaders (like the maximum number of simultaneous lights)\n     * @param shaderLanguage the language the shader is written in (default: GLSL)\n     * @returns the new Effect\n     */\n    WebGPUEngine.prototype.createEffect = function (baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, defines, fallbacks, onCompiled, onError, indexParameters, shaderLanguage) {\n        var _a;\n        if (shaderLanguage === void 0) { shaderLanguage = ShaderLanguage.GLSL; }\n        var vertex = baseName.vertexElement || baseName.vertex || baseName.vertexToken || baseName.vertexSource || baseName;\n        var fragment = baseName.fragmentElement || baseName.fragment || baseName.fragmentToken || baseName.fragmentSource || baseName;\n        var globalDefines = this._getGlobalDefines();\n        var fullDefines = (_a = defines !== null && defines !== void 0 ? defines : attributesNamesOrOptions.defines) !== null && _a !== void 0 ? _a : \"\";\n        if (globalDefines) {\n            fullDefines += \"\\n\" + globalDefines;\n        }\n        var name = vertex + \"+\" + fragment + \"@\" + fullDefines;\n        if (this._compiledEffects[name]) {\n            var compiledEffect = this._compiledEffects[name];\n            if (onCompiled && compiledEffect.isReady()) {\n                onCompiled(compiledEffect);\n            }\n            return compiledEffect;\n        }\n        var effect = new Effect(baseName, attributesNamesOrOptions, uniformsNamesOrEngine, samplers, this, defines, fallbacks, onCompiled, onError, indexParameters, name, shaderLanguage);\n        this._compiledEffects[name] = effect;\n        return effect;\n    };\n    WebGPUEngine.prototype._compileRawShaderToSpirV = function (source, type) {\n        return this._glslang.compileGLSL(source, type);\n    };\n    WebGPUEngine.prototype._compileShaderToSpirV = function (source, type, defines, shaderVersion) {\n        return this._compileRawShaderToSpirV(shaderVersion + (defines ? defines + \"\\n\" : \"\") + source, type);\n    };\n    WebGPUEngine.prototype._getWGSLShader = function (source, type, defines) {\n        if (defines) {\n            defines = \"//\" + defines.split(\"\\n\").join(\"\\n//\") + \"\\n\";\n        }\n        else {\n            defines = \"\";\n        }\n        return defines + source;\n    };\n    WebGPUEngine.prototype._createPipelineStageDescriptor = function (vertexShader, fragmentShader, shaderLanguage) {\n        if (this._tintWASM && shaderLanguage === ShaderLanguage.GLSL) {\n            vertexShader = this._tintWASM.convertSpirV2WGSL(vertexShader);\n            fragmentShader = this._tintWASM.convertSpirV2WGSL(fragmentShader);\n        }\n        return {\n            vertexStage: {\n                module: this._device.createShaderModule({\n                    code: vertexShader,\n                }),\n                entryPoint: \"main\",\n            },\n            fragmentStage: {\n                module: this._device.createShaderModule({\n                    code: fragmentShader,\n                }),\n                entryPoint: \"main\",\n            },\n        };\n    };\n    WebGPUEngine.prototype._compileRawPipelineStageDescriptor = function (vertexCode, fragmentCode, shaderLanguage) {\n        var vertexShader = shaderLanguage === ShaderLanguage.GLSL ? this._compileRawShaderToSpirV(vertexCode, \"vertex\") : vertexCode;\n        var fragmentShader = shaderLanguage === ShaderLanguage.GLSL ? this._compileRawShaderToSpirV(fragmentCode, \"fragment\") : fragmentCode;\n        return this._createPipelineStageDescriptor(vertexShader, fragmentShader, shaderLanguage);\n    };\n    WebGPUEngine.prototype._compilePipelineStageDescriptor = function (vertexCode, fragmentCode, defines, shaderLanguage) {\n        this.onBeforeShaderCompilationObservable.notifyObservers(this);\n        var shaderVersion = \"#version 450\\n\";\n        var vertexShader = shaderLanguage === ShaderLanguage.GLSL ? this._compileShaderToSpirV(vertexCode, \"vertex\", defines, shaderVersion) : this._getWGSLShader(vertexCode, \"vertex\", defines);\n        var fragmentShader = shaderLanguage === ShaderLanguage.GLSL\n            ? this._compileShaderToSpirV(fragmentCode, \"fragment\", defines, shaderVersion)\n            : this._getWGSLShader(fragmentCode, \"fragment\", defines);\n        var program = this._createPipelineStageDescriptor(vertexShader, fragmentShader, shaderLanguage);\n        this.onAfterShaderCompilationObservable.notifyObservers(this);\n        return program;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.createRawShaderProgram = function () {\n        throw \"Not available on WebGPU\";\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.createShaderProgram = function () {\n        throw \"Not available on WebGPU\";\n    };\n    /**\n     * Inline functions in shader code that are marked to be inlined\n     * @param code code to inline\n     * @returns inlined code\n     */\n    WebGPUEngine.prototype.inlineShaderCode = function (code) {\n        var sci = new ShaderCodeInliner(code);\n        sci.debug = false;\n        sci.processCode();\n        return sci.code;\n    };\n    /**\n     * Creates a new pipeline context\n     * @param shaderProcessingContext defines the shader processing context used during the processing if available\n     * @returns the new pipeline\n     */\n    WebGPUEngine.prototype.createPipelineContext = function (shaderProcessingContext) {\n        return new WebGPUPipelineContext(shaderProcessingContext, this);\n    };\n    /**\n     * Creates a new material context\n     * @returns the new context\n     */\n    WebGPUEngine.prototype.createMaterialContext = function () {\n        return new WebGPUMaterialContext();\n    };\n    /**\n     * Creates a new draw context\n     * @returns the new context\n     */\n    WebGPUEngine.prototype.createDrawContext = function () {\n        return new WebGPUDrawContext(this._bufferManager);\n    };\n    /**\n     * @param pipelineContext\n     * @param vertexSourceCode\n     * @param fragmentSourceCode\n     * @param createAsRaw\n     * @param rawVertexSourceCode\n     * @param rawFragmentSourceCode\n     * @param rebuildRebind\n     * @param defines\n     * @hidden\n     */\n    WebGPUEngine.prototype._preparePipelineContext = function (pipelineContext, vertexSourceCode, fragmentSourceCode, createAsRaw, rawVertexSourceCode, rawFragmentSourceCode, rebuildRebind, defines) {\n        var webGpuContext = pipelineContext;\n        var shaderLanguage = webGpuContext.shaderProcessingContext.shaderLanguage;\n        if (this.dbgShowShaderCode) {\n            console.log(defines);\n            console.log(vertexSourceCode);\n            console.log(fragmentSourceCode);\n        }\n        webGpuContext.sources = {\n            fragment: fragmentSourceCode,\n            vertex: vertexSourceCode,\n            rawVertex: rawVertexSourceCode,\n            rawFragment: rawFragmentSourceCode,\n        };\n        if (createAsRaw) {\n            webGpuContext.stages = this._compileRawPipelineStageDescriptor(vertexSourceCode, fragmentSourceCode, shaderLanguage);\n        }\n        else {\n            webGpuContext.stages = this._compilePipelineStageDescriptor(vertexSourceCode, fragmentSourceCode, defines, shaderLanguage);\n        }\n    };\n    /**\n     * Gets the list of active attributes for a given WebGPU program\n     * @param pipelineContext defines the pipeline context to use\n     * @param attributesNames defines the list of attribute names to get\n     * @returns an array of indices indicating the offset of each attribute\n     */\n    WebGPUEngine.prototype.getAttributes = function (pipelineContext, attributesNames) {\n        var results = new Array(attributesNames.length);\n        var gpuPipelineContext = pipelineContext;\n        for (var i = 0; i < attributesNames.length; i++) {\n            var attributeName = attributesNames[i];\n            var attributeLocation = gpuPipelineContext.shaderProcessingContext.availableAttributes[attributeName];\n            if (attributeLocation === undefined) {\n                continue;\n            }\n            results[i] = attributeLocation;\n        }\n        return results;\n    };\n    /**\n     * Activates an effect, making it the current one (ie. the one used for rendering)\n     * @param effect defines the effect to activate\n     */\n    WebGPUEngine.prototype.enableEffect = function (effect) {\n        if (!effect) {\n            return;\n        }\n        var isNewEffect = true;\n        if (!DrawWrapper.IsWrapper(effect)) {\n            isNewEffect = effect !== this._currentEffect;\n            this._currentEffect = effect;\n            this._currentMaterialContext = this._defaultMaterialContext;\n            this._currentDrawContext = this._defaultDrawContext;\n            this._counters.numEnableEffects++;\n            if (this.dbgLogIfNotDrawWrapper) {\n                Logger.Warn(\"enableEffect has been called with an Effect and not a Wrapper! effect.uniqueId=\".concat(effect.uniqueId, \", effect.name=\").concat(effect.name, \", effect.name.vertex=\").concat(effect.name.vertex, \", effect.name.fragment=\").concat(effect.name.fragment), 10);\n            }\n        }\n        else if (!effect.effect ||\n            (effect.effect === this._currentEffect &&\n                effect.materialContext === this._currentMaterialContext &&\n                effect.drawContext === this._currentDrawContext &&\n                !this._forceEnableEffect)) {\n            if (!effect.effect && this.dbgShowEmptyEnableEffectCalls) {\n                console.error(\"drawWrapper=\", effect);\n                throw \"Invalid call to enableEffect: the effect property is empty!\";\n            }\n            return;\n        }\n        else {\n            isNewEffect = effect.effect !== this._currentEffect;\n            this._currentEffect = effect.effect;\n            this._currentMaterialContext = effect.materialContext;\n            this._currentDrawContext = effect.drawContext;\n            this._counters.numEnableDrawWrapper++;\n            if (!this._currentMaterialContext) {\n                console.error(\"drawWrapper=\", effect);\n                throw \"Invalid call to enableEffect: the materialContext property is empty!\";\n            }\n        }\n        this._stencilStateComposer.stencilMaterial = undefined;\n        this._forceEnableEffect = isNewEffect || this._forceEnableEffect ? false : this._forceEnableEffect;\n        if (isNewEffect) {\n            if (this._currentEffect.onBind) {\n                this._currentEffect.onBind(this._currentEffect);\n            }\n            if (this._currentEffect._onBindObservable) {\n                this._currentEffect._onBindObservable.notifyObservers(this._currentEffect);\n            }\n        }\n    };\n    /**\n     * @param effect\n     * @hidden\n     */\n    WebGPUEngine.prototype._releaseEffect = function (effect) {\n        if (this._compiledEffects[effect._key]) {\n            delete this._compiledEffects[effect._key];\n            this._deletePipelineContext(effect.getPipelineContext());\n        }\n    };\n    /**\n     * Force the engine to release all cached effects. This means that next effect compilation will have to be done completely even if a similar effect was already compiled\n     */\n    WebGPUEngine.prototype.releaseEffects = function () {\n        for (var name_1 in this._compiledEffects) {\n            var webGPUPipelineContext = this._compiledEffects[name_1].getPipelineContext();\n            this._deletePipelineContext(webGPUPipelineContext);\n        }\n        this._compiledEffects = {};\n    };\n    WebGPUEngine.prototype._deletePipelineContext = function (pipelineContext) {\n        var webgpuPipelineContext = pipelineContext;\n        if (webgpuPipelineContext) {\n            pipelineContext.dispose();\n        }\n    };\n    Object.defineProperty(WebGPUEngine.prototype, \"needPOTTextures\", {\n        //------------------------------------------------------------------------------\n        //                              Textures\n        //------------------------------------------------------------------------------\n        /**\n         * Gets a boolean indicating that only power of 2 textures are supported\n         * Please note that you can still use non power of 2 textures but in this case the engine will forcefully convert them\n         */\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /** @hidden */\n    WebGPUEngine.prototype._createHardwareTexture = function () {\n        return new WebGPUHardwareTexture();\n    };\n    /**\n     * @param texture\n     * @hidden\n     */\n    WebGPUEngine.prototype._releaseTexture = function (texture) {\n        var index = this._internalTexturesCache.indexOf(texture);\n        if (index !== -1) {\n            this._internalTexturesCache.splice(index, 1);\n        }\n        this._textureHelper.releaseTexture(texture);\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype._getRGBABufferInternalSizedFormat = function () {\n        return 5;\n    };\n    WebGPUEngine.prototype.updateTextureComparisonFunction = function (texture, comparisonFunction) {\n        texture._comparisonFunction = comparisonFunction;\n    };\n    /**\n     * Creates an internal texture without binding it to a framebuffer\n     * @hidden\n     * @param size defines the size of the texture\n     * @param options defines the options used to create the texture\n     * @param delayGPUTextureCreation true to delay the texture creation the first time it is really needed. false to create it right away\n     * @param source source type of the texture\n     * @returns a new internal texture\n     */\n    WebGPUEngine.prototype._createInternalTexture = function (size, options, delayGPUTextureCreation, source) {\n        var _a, _b, _c;\n        if (delayGPUTextureCreation === void 0) { delayGPUTextureCreation = true; }\n        if (source === void 0) { source = InternalTextureSource.Unknown; }\n        var fullOptions = {};\n        if (options !== undefined && typeof options === \"object\") {\n            fullOptions.generateMipMaps = options.generateMipMaps;\n            fullOptions.type = options.type === undefined ? 0 : options.type;\n            fullOptions.samplingMode = options.samplingMode === undefined ? 3 : options.samplingMode;\n            fullOptions.format = options.format === undefined ? 5 : options.format;\n            fullOptions.samples = (_a = options.samples) !== null && _a !== void 0 ? _a : 1;\n            fullOptions.creationFlags = (_b = options.creationFlags) !== null && _b !== void 0 ? _b : 0;\n            fullOptions.useSRGBBuffer = (_c = options.useSRGBBuffer) !== null && _c !== void 0 ? _c : false;\n        }\n        else {\n            fullOptions.generateMipMaps = options;\n            fullOptions.type = 0;\n            fullOptions.samplingMode = 3;\n            fullOptions.format = 5;\n            fullOptions.samples = 1;\n            fullOptions.creationFlags = 0;\n            fullOptions.useSRGBBuffer = false;\n        }\n        if (fullOptions.type === 1 && !this._caps.textureFloatLinearFiltering) {\n            fullOptions.samplingMode = 1;\n        }\n        else if (fullOptions.type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n            fullOptions.samplingMode = 1;\n        }\n        if (fullOptions.type === 1 && !this._caps.textureFloat) {\n            fullOptions.type = 0;\n            Logger.Warn(\"Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE\");\n        }\n        var texture = new InternalTexture(this, source);\n        var width = size.width || size;\n        var height = size.height || size;\n        var layers = size.layers || 0;\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = width;\n        texture.height = height;\n        texture.depth = layers;\n        texture.isReady = true;\n        texture.samples = fullOptions.samples;\n        texture.generateMipMaps = fullOptions.generateMipMaps ? true : false;\n        texture.samplingMode = fullOptions.samplingMode;\n        texture.type = fullOptions.type;\n        texture.format = fullOptions.format;\n        texture.is2DArray = layers > 0;\n        texture._cachedWrapU = 0;\n        texture._cachedWrapV = 0;\n        texture._useSRGBBuffer = fullOptions.useSRGBBuffer;\n        this._internalTexturesCache.push(texture);\n        if (!delayGPUTextureCreation) {\n            this._textureHelper.createGPUTextureForInternalTexture(texture, width, height, layers || 1, fullOptions.creationFlags);\n        }\n        return texture;\n    };\n    /**\n     * Usually called from Texture.ts.\n     * Passed information to create a hardware texture\n     * @param url defines a value which contains one of the following:\n     * * A conventional http URL, e.g. 'http://...' or 'file://...'\n     * * A base64 string of in-line texture data, e.g. 'data:image/jpg;base64,/...'\n     * * An indicator that data being passed using the buffer parameter, e.g. 'data:mytexture.jpg'\n     * @param noMipmap defines a boolean indicating that no mipmaps shall be generated.  Ignored for compressed textures.  They must be in the file\n     * @param invertY when true, image is flipped when loaded.  You probably want true. Certain compressed textures may invert this if their default is inverted (eg. ktx)\n     * @param scene needed for loading to the correct scene\n     * @param samplingMode mode with should be used sample / access the texture (Default: Texture.TRILINEAR_SAMPLINGMODE)\n     * @param onLoad optional callback to be called upon successful completion\n     * @param onError optional callback to be called upon failure\n     * @param buffer a source of a file previously fetched as either a base64 string, an ArrayBuffer (compressed or image format), HTMLImageElement (image format), or a Blob\n     * @param fallback an internal argument in case the function must be called again, due to etc1 not having alpha capabilities\n     * @param format internal format.  Default: RGB when extension is '.jpg' else RGBA.  Ignored for compressed textures\n     * @param forcedExtension defines the extension to use to pick the right loader\n     * @param mimeType defines an optional mime type\n     * @param loaderOptions options to be passed to the loader\n     * @param creationFlags specific flags to use when creating the texture (1 for storage textures, for eg)\n     * @param useSRGBBuffer defines if the texture must be loaded in a sRGB GPU buffer (if supported by the GPU).\n     * @returns a InternalTexture for assignment back into BABYLON.Texture\n     */\n    WebGPUEngine.prototype.createTexture = function (url, noMipmap, invertY, scene, samplingMode, onLoad, onError, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, creationFlags, useSRGBBuffer) {\n        var _this = this;\n        if (samplingMode === void 0) { samplingMode = 3; }\n        if (onLoad === void 0) { onLoad = null; }\n        if (onError === void 0) { onError = null; }\n        if (buffer === void 0) { buffer = null; }\n        if (fallback === void 0) { fallback = null; }\n        if (format === void 0) { format = null; }\n        if (forcedExtension === void 0) { forcedExtension = null; }\n        return this._createTextureBase(url, noMipmap, invertY, scene, samplingMode, onLoad, onError, function (texture, extension, scene, img, invertY, noMipmap, isCompressed, processFunction) {\n            var _a;\n            var imageBitmap = img; // we will never get an HTMLImageElement in WebGPU\n            texture.baseWidth = imageBitmap.width;\n            texture.baseHeight = imageBitmap.height;\n            texture.width = imageBitmap.width;\n            texture.height = imageBitmap.height;\n            texture.format = format !== null && format !== void 0 ? format : -1;\n            processFunction(texture.width, texture.height, imageBitmap, extension, texture, function () { });\n            if (!((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource)) {\n                // the texture could have been created before reaching this point so don't recreate it if already existing\n                var gpuTextureWrapper = _this._textureHelper.createGPUTextureForInternalTexture(texture, imageBitmap.width, imageBitmap.height, undefined, creationFlags);\n                if (WebGPUTextureHelper.IsImageBitmap(imageBitmap)) {\n                    _this._textureHelper.updateTexture(imageBitmap, texture, imageBitmap.width, imageBitmap.height, texture.depth, gpuTextureWrapper.format, 0, 0, invertY, false, 0, 0);\n                    if (!noMipmap && !isCompressed) {\n                        _this._generateMipmaps(texture, _this._uploadEncoder);\n                    }\n                }\n            }\n            else if (!noMipmap && !isCompressed) {\n                _this._generateMipmaps(texture, _this._uploadEncoder);\n            }\n            if (scene) {\n                scene._removePendingData(texture);\n            }\n            texture.isReady = true;\n            texture.onLoadedObservable.notifyObservers(texture);\n            texture.onLoadedObservable.clear();\n        }, function () { return false; }, buffer, fallback, format, forcedExtension, mimeType, loaderOptions, useSRGBBuffer);\n    };\n    /**\n     * Wraps an external web gpu texture in a Babylon texture.\n     * @param texture defines the external texture\n     * @returns the babylon internal texture\n     */\n    WebGPUEngine.prototype.wrapWebGPUTexture = function (texture) {\n        var hardwareTexture = new WebGPUHardwareTexture(texture);\n        var internalTexture = new InternalTexture(this, InternalTextureSource.Unknown, true);\n        internalTexture._hardwareTexture = hardwareTexture;\n        internalTexture.isReady = true;\n        return internalTexture;\n    };\n    /**\n     * Wraps an external web gl texture in a Babylon texture.\n     * @returns the babylon internal texture\n     */\n    WebGPUEngine.prototype.wrapWebGLTexture = function () {\n        throw new Error(\"wrapWebGLTexture is not supported, use wrapWebGPUTexture instead.\");\n    };\n    WebGPUEngine.prototype.generateMipMapsForCubemap = function (texture) {\n        var _a;\n        if (texture.generateMipMaps) {\n            var gpuTexture = (_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource;\n            if (!gpuTexture) {\n                this._textureHelper.createGPUTextureForInternalTexture(texture);\n            }\n            this._generateMipmaps(texture, texture.source === InternalTextureSource.RenderTarget || texture.source === InternalTextureSource.MultiRenderTarget ? this._renderTargetEncoder : undefined);\n        }\n    };\n    /**\n     * Update the sampling mode of a given texture\n     * @param samplingMode defines the required sampling mode\n     * @param texture defines the texture to update\n     * @param generateMipMaps defines whether to generate mipmaps for the texture\n     */\n    WebGPUEngine.prototype.updateTextureSamplingMode = function (samplingMode, texture, generateMipMaps) {\n        if (generateMipMaps === void 0) { generateMipMaps = false; }\n        if (generateMipMaps) {\n            texture.generateMipMaps = true;\n            this._generateMipmaps(texture);\n        }\n        texture.samplingMode = samplingMode;\n    };\n    /**\n     * Update the sampling mode of a given texture\n     * @param texture defines the texture to update\n     * @param wrapU defines the texture wrap mode of the u coordinates\n     * @param wrapV defines the texture wrap mode of the v coordinates\n     * @param wrapR defines the texture wrap mode of the r coordinates\n     */\n    WebGPUEngine.prototype.updateTextureWrappingMode = function (texture, wrapU, wrapV, wrapR) {\n        if (wrapV === void 0) { wrapV = null; }\n        if (wrapR === void 0) { wrapR = null; }\n        if (wrapU !== null) {\n            texture._cachedWrapU = wrapU;\n        }\n        if (wrapV !== null) {\n            texture._cachedWrapV = wrapV;\n        }\n        if ((texture.is2DArray || texture.is3D) && wrapR !== null) {\n            texture._cachedWrapR = wrapR;\n        }\n    };\n    /**\n     * Update the dimensions of a texture\n     * @param texture texture to update\n     * @param width new width of the texture\n     * @param height new height of the texture\n     * @param depth new depth of the texture\n     */\n    WebGPUEngine.prototype.updateTextureDimensions = function (texture, width, height, depth) {\n        if (depth === void 0) { depth = 1; }\n        if (!texture._hardwareTexture) {\n            // the gpu texture is not created yet, so when it is it will be created with the right dimensions\n            return;\n        }\n        if (texture.width === width && texture.height === height && texture.depth === depth) {\n            return;\n        }\n        var additionalUsages = texture._hardwareTexture.textureAdditionalUsages;\n        texture._hardwareTexture.release(); // don't defer the releasing! Else we will release at the end of this frame the gpu texture we are about to create in the next line...\n        this._textureHelper.createGPUTextureForInternalTexture(texture, width, height, depth, additionalUsages);\n    };\n    /**\n     * @param name\n     * @param texture\n     * @param baseName\n     * @hidden\n     */\n    WebGPUEngine.prototype._setInternalTexture = function (name, texture, baseName) {\n        baseName = baseName !== null && baseName !== void 0 ? baseName : name;\n        if (this._currentEffect) {\n            var webgpuPipelineContext = this._currentEffect._pipelineContext;\n            var availableTexture = webgpuPipelineContext.shaderProcessingContext.availableTextures[baseName];\n            this._currentMaterialContext.setTexture(name, texture);\n            if (availableTexture && availableTexture.autoBindSampler) {\n                var samplerName = baseName + WebGPUShaderProcessor.AutoSamplerSuffix;\n                this._currentMaterialContext.setSampler(samplerName, texture); // we can safely cast to InternalTexture because ExternalTexture always has autoBindSampler = false\n            }\n        }\n    };\n    /**\n     * Sets a texture to the according uniform.\n     * @param channel The texture channel\n     * @param unused unused parameter\n     * @param texture The texture to apply\n     * @param name The name of the uniform in the effect\n     */\n    WebGPUEngine.prototype.setTexture = function (channel, unused, texture, name) {\n        this._setTexture(channel, texture, false, false, name, name);\n    };\n    /**\n     * Sets an array of texture to the WebGPU context\n     * @param channel defines the channel where the texture array must be set\n     * @param unused unused parameter\n     * @param textures defines the array of textures to bind\n     * @param name name of the channel\n     */\n    WebGPUEngine.prototype.setTextureArray = function (channel, unused, textures, name) {\n        for (var index = 0; index < textures.length; index++) {\n            this._setTexture(-1, textures[index], true, false, name + index.toString(), name);\n        }\n    };\n    WebGPUEngine.prototype._setTexture = function (channel, texture, \n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    isPartOfTextureArray, depthStencilTexture, name, baseName) {\n        if (isPartOfTextureArray === void 0) { isPartOfTextureArray = false; }\n        if (depthStencilTexture === void 0) { depthStencilTexture = false; }\n        if (name === void 0) { name = \"\"; }\n        // name == baseName for a texture that is not part of a texture array\n        // Else, name is something like 'myTexture0' / 'myTexture1' / ... and baseName is 'myTexture'\n        // baseName is used to look up the texture in the shaderProcessingContext.availableTextures map\n        // name is used to look up the texture in the _currentMaterialContext.textures map\n        baseName = baseName !== null && baseName !== void 0 ? baseName : name;\n        if (this._currentEffect) {\n            if (!texture) {\n                this._currentMaterialContext.setTexture(name, null);\n                return false;\n            }\n            // Video\n            if (texture.video) {\n                texture.update();\n            }\n            else if (texture.delayLoadState === 4) {\n                // Delay loading\n                texture.delayLoad();\n                return false;\n            }\n            var internalTexture = null;\n            if (depthStencilTexture) {\n                internalTexture = texture.depthStencilTexture;\n            }\n            else if (texture.isReady()) {\n                internalTexture = texture.getInternalTexture();\n            }\n            else if (texture.isCube) {\n                internalTexture = this.emptyCubeTexture;\n            }\n            else if (texture.is3D) {\n                internalTexture = this.emptyTexture3D;\n            }\n            else if (texture.is2DArray) {\n                internalTexture = this.emptyTexture2DArray;\n            }\n            else {\n                internalTexture = this.emptyTexture;\n            }\n            if (internalTexture && !internalTexture.isMultiview) {\n                // CUBIC_MODE and SKYBOX_MODE both require CLAMP_TO_EDGE.  All other modes use REPEAT.\n                if (internalTexture.isCube && internalTexture._cachedCoordinatesMode !== texture.coordinatesMode) {\n                    internalTexture._cachedCoordinatesMode = texture.coordinatesMode;\n                    var textureWrapMode = texture.coordinatesMode !== 3 && texture.coordinatesMode !== 5\n                        ? 1\n                        : 0;\n                    texture.wrapU = textureWrapMode;\n                    texture.wrapV = textureWrapMode;\n                }\n                internalTexture._cachedWrapU = texture.wrapU;\n                internalTexture._cachedWrapV = texture.wrapV;\n                if (internalTexture.is3D) {\n                    internalTexture._cachedWrapR = texture.wrapR;\n                }\n                this._setAnisotropicLevel(0, internalTexture, texture.anisotropicFilteringLevel);\n            }\n            this._setInternalTexture(name, internalTexture, baseName);\n        }\n        else {\n            if (this.dbgVerboseLogsForFirstFrames) {\n                if (this._count === undefined) {\n                    this._count = 0;\n                }\n                if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                    console.log(\"frame #\" + this._count + \" - _setTexture called with a null _currentEffect! texture=\", texture);\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * @param target\n     * @param internalTexture\n     * @param anisotropicFilteringLevel\n     * @hidden\n     */\n    WebGPUEngine.prototype._setAnisotropicLevel = function (target, internalTexture, anisotropicFilteringLevel) {\n        if (internalTexture._cachedAnisotropicFilteringLevel !== anisotropicFilteringLevel) {\n            internalTexture._cachedAnisotropicFilteringLevel = Math.min(anisotropicFilteringLevel, this._caps.maxAnisotropy);\n        }\n    };\n    /**\n     * @param channel\n     * @param texture\n     * @param name\n     * @hidden\n     */\n    WebGPUEngine.prototype._bindTexture = function (channel, texture, name) {\n        if (channel === undefined) {\n            return;\n        }\n        this._setInternalTexture(name, texture);\n    };\n    /**\n     * Generates the mipmaps for a texture\n     * @param texture texture to generate the mipmaps for\n     */\n    WebGPUEngine.prototype.generateMipmaps = function (texture) {\n        this._generateMipmaps(texture, this._renderTargetEncoder);\n    };\n    /**\n     * @param texture\n     * @param commandEncoder\n     * @hidden\n     */\n    WebGPUEngine.prototype._generateMipmaps = function (texture, commandEncoder) {\n        var gpuHardwareTexture = texture._hardwareTexture;\n        if (!gpuHardwareTexture) {\n            return;\n        }\n        // try as much as possible to use the command encoder corresponding to the current pass.\n        // If not possible (because the pass is started - generateMipmaps itself creates a pass and it's not allowed to have a pass inside a pass), use _uploadEncoder\n        commandEncoder =\n            commandEncoder !== null && commandEncoder !== void 0 ? commandEncoder : (this._currentRenderTarget && !this._currentRenderPass ? this._renderTargetEncoder : !this._currentRenderPass ? this._renderEncoder : this._uploadEncoder);\n        var format = texture._hardwareTexture.format;\n        var mipmapCount = WebGPUTextureHelper.ComputeNumMipmapLevels(texture.width, texture.height);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - generate mipmaps called - width=\", texture.width, \"height=\", texture.height, \"isCube=\", texture.isCube);\n            }\n        }\n        if (texture.isCube) {\n            this._textureHelper.generateCubeMipmaps(gpuHardwareTexture, format, mipmapCount, commandEncoder);\n        }\n        else {\n            this._textureHelper.generateMipmaps(gpuHardwareTexture, format, mipmapCount, 0, commandEncoder);\n        }\n    };\n    /**\n     * Update a portion of an internal texture\n     * @param texture defines the texture to update\n     * @param imageData defines the data to store into the texture\n     * @param xOffset defines the x coordinates of the update rectangle\n     * @param yOffset defines the y coordinates of the update rectangle\n     * @param width defines the width of the update rectangle\n     * @param height defines the height of the update rectangle\n     * @param faceIndex defines the face index if texture is a cube (0 by default)\n     * @param lod defines the lod level to update (0 by default)\n     * @param generateMipMaps defines whether to generate mipmaps or not\n     */\n    WebGPUEngine.prototype.updateTextureData = function (texture, imageData, xOffset, yOffset, width, height, faceIndex, lod, generateMipMaps) {\n        var _a;\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        if (generateMipMaps === void 0) { generateMipMaps = false; }\n        var gpuTextureWrapper = texture._hardwareTexture;\n        if (!((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource)) {\n            gpuTextureWrapper = this._textureHelper.createGPUTextureForInternalTexture(texture);\n        }\n        var data = new Uint8Array(imageData.buffer, imageData.byteOffset, imageData.byteLength);\n        this._textureHelper.updateTexture(data, texture, width, height, texture.depth, gpuTextureWrapper.format, faceIndex, lod, texture.invertY, false, xOffset, yOffset);\n        if (generateMipMaps) {\n            this._generateMipmaps(texture, this._renderTargetEncoder);\n        }\n    };\n    /**\n     * @param texture\n     * @param internalFormat\n     * @param width\n     * @param height\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    WebGPUEngine.prototype._uploadCompressedDataToTextureDirectly = function (texture, internalFormat, width, height, imageData, faceIndex, lod) {\n        var _a;\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        var gpuTextureWrapper = texture._hardwareTexture;\n        if (!((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource)) {\n            texture.format = internalFormat;\n            gpuTextureWrapper = this._textureHelper.createGPUTextureForInternalTexture(texture, width, height);\n        }\n        var data = new Uint8Array(imageData.buffer, imageData.byteOffset, imageData.byteLength);\n        this._textureHelper.updateTexture(data, texture, width, height, texture.depth, gpuTextureWrapper.format, faceIndex, lod, false, false, 0, 0);\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @param babylonInternalFormat\n     * @param useTextureWidthAndHeight\n     * @hidden\n     */\n    WebGPUEngine.prototype._uploadDataToTextureDirectly = function (texture, imageData, faceIndex, lod, babylonInternalFormat, useTextureWidthAndHeight) {\n        var _a;\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        if (useTextureWidthAndHeight === void 0) { useTextureWidthAndHeight = false; }\n        var lodMaxWidth = Math.round(Math.log(texture.width) * Math.LOG2E);\n        var lodMaxHeight = Math.round(Math.log(texture.height) * Math.LOG2E);\n        var width = useTextureWidthAndHeight ? texture.width : Math.pow(2, Math.max(lodMaxWidth - lod, 0));\n        var height = useTextureWidthAndHeight ? texture.height : Math.pow(2, Math.max(lodMaxHeight - lod, 0));\n        var gpuTextureWrapper = texture._hardwareTexture;\n        if (!((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource)) {\n            gpuTextureWrapper = this._textureHelper.createGPUTextureForInternalTexture(texture, width, height);\n        }\n        var data = new Uint8Array(imageData.buffer, imageData.byteOffset, imageData.byteLength);\n        this._textureHelper.updateTexture(data, texture, width, height, texture.depth, gpuTextureWrapper.format, faceIndex, lod, texture.invertY, false, 0, 0);\n    };\n    /**\n     * @param texture\n     * @param imageData\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    WebGPUEngine.prototype._uploadArrayBufferViewToTexture = function (texture, imageData, faceIndex, lod) {\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        this._uploadDataToTextureDirectly(texture, imageData, faceIndex, lod);\n    };\n    /**\n     * @param texture\n     * @param image\n     * @param faceIndex\n     * @param lod\n     * @hidden\n     */\n    WebGPUEngine.prototype._uploadImageToTexture = function (texture, image, faceIndex, lod) {\n        var _a;\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lod === void 0) { lod = 0; }\n        var gpuTextureWrapper = texture._hardwareTexture;\n        if (!((_a = texture._hardwareTexture) === null || _a === void 0 ? void 0 : _a.underlyingResource)) {\n            gpuTextureWrapper = this._textureHelper.createGPUTextureForInternalTexture(texture);\n        }\n        var bitmap = image; // in WebGPU we will always get an ImageBitmap, not an HTMLImageElement\n        var width = Math.ceil(texture.width / (1 << lod));\n        var height = Math.ceil(texture.height / (1 << lod));\n        this._textureHelper.updateTexture(bitmap, texture, width, height, texture.depth, gpuTextureWrapper.format, faceIndex, lod, texture.invertY, false, 0, 0);\n    };\n    /**\n     * Reads pixels from the current frame buffer. Please note that this function can be slow\n     * @param x defines the x coordinate of the rectangle where pixels must be read\n     * @param y defines the y coordinate of the rectangle where pixels must be read\n     * @param width defines the width of the rectangle where pixels must be read\n     * @param height defines the height of the rectangle where pixels must be read\n     * @param hasAlpha defines whether the output should have alpha or not (defaults to true)\n     * @param flushRenderer true to flush the renderer from the pending commands before reading the pixels\n     * @returns a ArrayBufferView promise (Uint8Array) containing RGBA colors\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    WebGPUEngine.prototype.readPixels = function (x, y, width, height, hasAlpha, flushRenderer) {\n        if (hasAlpha === void 0) { hasAlpha = true; }\n        if (flushRenderer === void 0) { flushRenderer = true; }\n        var renderPassWrapper = this._rttRenderPassWrapper.renderPass ? this._rttRenderPassWrapper : this._mainRenderPassWrapper;\n        var hardwareTexture = renderPassWrapper.colorAttachmentGPUTextures[0];\n        if (!hardwareTexture) {\n            // we are calling readPixels for a render pass with no color texture bound\n            return Promise.resolve(new Uint8Array(0));\n        }\n        var gpuTexture = hardwareTexture.underlyingResource;\n        var gpuTextureFormat = hardwareTexture.format;\n        if (!gpuTexture) {\n            // we are calling readPixels before startMainRenderPass has been called and no RTT is bound, so swapChainTexture is not setup yet!\n            return Promise.resolve(new Uint8Array(0));\n        }\n        if (flushRenderer) {\n            this.flushFramebuffer();\n        }\n        return this._textureHelper.readPixels(gpuTexture, x, y, width, height, gpuTextureFormat);\n    };\n    //------------------------------------------------------------------------------\n    //                              Frame management\n    //------------------------------------------------------------------------------\n    /**\n     * Begin a new frame\n     */\n    WebGPUEngine.prototype.beginFrame = function () {\n        _super.prototype.beginFrame.call(this);\n    };\n    /**\n     * End the current frame\n     */\n    WebGPUEngine.prototype.endFrame = function () {\n        this._snapshotRendering.endFrame(this._mainRenderPassWrapper.renderPass);\n        this._endMainRenderPass();\n        this._timestampQuery.endFrame(this._renderEncoder);\n        this.flushFramebuffer(false);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - counters\");\n            }\n        }\n        this._textureHelper.destroyDeferredTextures();\n        this._bufferManager.destroyDeferredBuffers();\n        if (this._features._collectUbosUpdatedInFrame) {\n            if (this.dbgVerboseLogsForFirstFrames) {\n                if (this._count === undefined) {\n                    this._count = 0;\n                }\n                if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                    var list = [];\n                    for (var name_2 in UniformBuffer._UpdatedUbosInFrame) {\n                        list.push(name_2 + \":\" + UniformBuffer._UpdatedUbosInFrame[name_2]);\n                    }\n                    console.log(\"frame #\" + this._count + \" - updated ubos -\", list.join(\", \"));\n                }\n            }\n            UniformBuffer._UpdatedUbosInFrame = {};\n        }\n        this.countersLastFrame.numEnableEffects = this._counters.numEnableEffects;\n        this.countersLastFrame.numEnableDrawWrapper = this._counters.numEnableDrawWrapper;\n        this.countersLastFrame.numBundleCreationNonCompatMode = this._counters.numBundleCreationNonCompatMode;\n        this.countersLastFrame.numBundleReuseNonCompatMode = this._counters.numBundleReuseNonCompatMode;\n        this._counters.numEnableEffects = 0;\n        this._counters.numEnableDrawWrapper = 0;\n        this._counters.numBundleCreationNonCompatMode = 0;\n        this._counters.numBundleReuseNonCompatMode = 0;\n        this._cacheRenderPipeline.endFrame();\n        this._cacheBindGroups.endFrame();\n        this._pendingDebugCommands.length = 0;\n        _super.prototype.endFrame.call(this);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"%c frame #\" + this._count + \" - end\", \"background: #ffff00\");\n            }\n            if (this._count < this.dbgVerboseLogsNumFrames) {\n                this._count++;\n                if (this._count !== this.dbgVerboseLogsNumFrames) {\n                    console.log(\"%c frame #\" + this._count + \" - begin\", \"background: #ffff00\");\n                }\n            }\n        }\n    };\n    /**\n     * Force a WebGPU flush (ie. a flush of all waiting commands)\n     * @param reopenPass true to reopen at the end of the function the pass that was active when entering the function\n     */\n    WebGPUEngine.prototype.flushFramebuffer = function (reopenPass) {\n        if (reopenPass === void 0) { reopenPass = true; }\n        // we need to end the current render pass (main or rtt) if any as we are not allowed to submit the command buffers when being in a pass\n        var currentRenderPassIsNULL = !this._currentRenderPass;\n        var currentPasses = 0; // 0 if no pass, 1 for rtt, 2 for main pass\n        if (this._currentRenderPass && this._currentRenderTarget) {\n            currentPasses |= 1;\n            this._endRenderTargetRenderPass();\n        }\n        if (this._mainRenderPassWrapper.renderPass) {\n            currentPasses |= 2;\n            this._endMainRenderPass();\n        }\n        this._commandBuffers[0] = this._uploadEncoder.finish();\n        this._commandBuffers[1] = this._renderTargetEncoder.finish();\n        this._commandBuffers[2] = this._renderEncoder.finish();\n        this._device.queue.submit(this._commandBuffers);\n        this._uploadEncoder = this._device.createCommandEncoder(this._uploadEncoderDescriptor);\n        this._renderEncoder = this._device.createCommandEncoder(this._renderEncoderDescriptor);\n        this._renderTargetEncoder = this._device.createCommandEncoder(this._renderTargetEncoderDescriptor);\n        this._timestampQuery.startFrame(this._uploadEncoder);\n        this._textureHelper.setCommandEncoder(this._uploadEncoder);\n        this._bundleList.reset();\n        this._bundleListRenderTarget.reset();\n        // restart the render pass\n        if (reopenPass) {\n            if (currentPasses & 2) {\n                this._startMainRenderPass(false);\n            }\n            if (currentPasses & 1) {\n                this._startRenderTargetRenderPass(this._currentRenderTarget, false, null, false, false);\n            }\n            if (currentRenderPassIsNULL && this._currentRenderTarget) {\n                this._currentRenderPass = null;\n            }\n        }\n    };\n    /** @hidden */\n    WebGPUEngine.prototype._currentFrameBufferIsDefaultFrameBuffer = function () {\n        return this._currentRenderTarget === null;\n    };\n    //------------------------------------------------------------------------------\n    //                              Render Pass\n    //------------------------------------------------------------------------------\n    WebGPUEngine.prototype._startRenderTargetRenderPass = function (renderTargetWrapper, setClearStates, clearColor, clearDepth, clearStencil) {\n        var _a, _b, _c;\n        var rtWrapper = renderTargetWrapper;\n        var depthStencilTexture = rtWrapper._depthStencilTexture;\n        var gpuDepthStencilWrapper = depthStencilTexture === null || depthStencilTexture === void 0 ? void 0 : depthStencilTexture._hardwareTexture;\n        var gpuDepthStencilTexture = gpuDepthStencilWrapper === null || gpuDepthStencilWrapper === void 0 ? void 0 : gpuDepthStencilWrapper.underlyingResource;\n        var gpuDepthStencilMSAATexture = gpuDepthStencilWrapper === null || gpuDepthStencilWrapper === void 0 ? void 0 : gpuDepthStencilWrapper.msaaTexture;\n        var depthTextureView = gpuDepthStencilTexture === null || gpuDepthStencilTexture === void 0 ? void 0 : gpuDepthStencilTexture.createView(this._rttRenderPassWrapper.depthAttachmentViewDescriptor);\n        var depthMSAATextureView = gpuDepthStencilMSAATexture === null || gpuDepthStencilMSAATexture === void 0 ? void 0 : gpuDepthStencilMSAATexture.createView(this._rttRenderPassWrapper.depthAttachmentViewDescriptor);\n        var depthTextureHasStencil = gpuDepthStencilWrapper ? WebGPUTextureHelper.HasStencilAspect(gpuDepthStencilWrapper.format) : false;\n        var colorAttachments = [];\n        if (this.useReverseDepthBuffer) {\n            this.setDepthFunctionToGreaterOrEqual();\n        }\n        var mustClearColor = setClearStates && clearColor;\n        var mustClearDepth = setClearStates && clearDepth;\n        var mustClearStencil = setClearStates && clearStencil;\n        if (rtWrapper._attachments && rtWrapper.isMulti) {\n            // multi render targets\n            if (!this._mrtAttachments || this._mrtAttachments.length === 0) {\n                this._mrtAttachments = rtWrapper._defaultAttachments;\n            }\n            for (var i = 0; i < this._mrtAttachments.length; ++i) {\n                var index = this._mrtAttachments[i]; // if index == 0 it means the texture should not be written to => at render pass creation time, it means we should not clear it\n                var mrtTexture = rtWrapper.textures[i];\n                var gpuMRTWrapper = mrtTexture === null || mrtTexture === void 0 ? void 0 : mrtTexture._hardwareTexture;\n                var gpuMRTTexture = gpuMRTWrapper === null || gpuMRTWrapper === void 0 ? void 0 : gpuMRTWrapper.underlyingResource;\n                if (gpuMRTWrapper && gpuMRTTexture) {\n                    var viewDescriptor = __assign(__assign({}, this._rttRenderPassWrapper.colorAttachmentViewDescriptor), { format: gpuMRTWrapper.format });\n                    var gpuMSAATexture = gpuMRTWrapper.msaaTexture;\n                    var colorTextureView = gpuMRTTexture.createView(viewDescriptor);\n                    var colorMSAATextureView = gpuMSAATexture === null || gpuMSAATexture === void 0 ? void 0 : gpuMSAATexture.createView(viewDescriptor);\n                    colorAttachments.push({\n                        view: colorMSAATextureView ? colorMSAATextureView : colorTextureView,\n                        resolveTarget: gpuMSAATexture ? colorTextureView : undefined,\n                        clearValue: index !== 0 && mustClearColor ? clearColor : undefined,\n                        loadOp: index !== 0 && mustClearColor ? WebGPUConstants.LoadOp.Clear : WebGPUConstants.LoadOp.Load,\n                        storeOp: WebGPUConstants.StoreOp.Store,\n                    });\n                }\n            }\n            this._cacheRenderPipeline.setMRT(rtWrapper.textures, this._mrtAttachments.length);\n            this._cacheRenderPipeline.setMRTAttachments(this._mrtAttachments);\n        }\n        else {\n            // single render target\n            var internalTexture = rtWrapper.texture;\n            if (internalTexture) {\n                var gpuWrapper = internalTexture._hardwareTexture;\n                var gpuTexture = gpuWrapper.underlyingResource;\n                var gpuMSAATexture = gpuWrapper.msaaTexture;\n                var colorTextureView = gpuTexture.createView(this._rttRenderPassWrapper.colorAttachmentViewDescriptor);\n                var colorMSAATextureView = gpuMSAATexture === null || gpuMSAATexture === void 0 ? void 0 : gpuMSAATexture.createView(this._rttRenderPassWrapper.colorAttachmentViewDescriptor);\n                colorAttachments.push({\n                    view: colorMSAATextureView ? colorMSAATextureView : colorTextureView,\n                    resolveTarget: gpuMSAATexture ? colorTextureView : undefined,\n                    clearValue: mustClearColor ? clearColor : undefined,\n                    loadOp: mustClearColor ? WebGPUConstants.LoadOp.Clear : WebGPUConstants.LoadOp.Load,\n                    storeOp: WebGPUConstants.StoreOp.Store,\n                });\n            }\n            else {\n                colorAttachments.push(null);\n            }\n        }\n        (_a = this._debugPushGroup) === null || _a === void 0 ? void 0 : _a.call(this, \"render target pass\", 1);\n        this._rttRenderPassWrapper.renderPassDescriptor = {\n            colorAttachments: colorAttachments,\n            depthStencilAttachment: depthStencilTexture && gpuDepthStencilTexture\n                ? {\n                    view: depthMSAATextureView ? depthMSAATextureView : depthTextureView,\n                    depthClearValue: mustClearDepth ? (this.useReverseDepthBuffer ? this._clearReverseDepthValue : this._clearDepthValue) : undefined,\n                    depthLoadOp: mustClearDepth ? WebGPUConstants.LoadOp.Clear : WebGPUConstants.LoadOp.Load,\n                    depthStoreOp: WebGPUConstants.StoreOp.Store,\n                    stencilClearValue: rtWrapper._depthStencilTextureWithStencil && mustClearStencil ? this._clearStencilValue : undefined,\n                    stencilLoadOp: !depthTextureHasStencil\n                        ? undefined\n                        : rtWrapper._depthStencilTextureWithStencil && mustClearStencil\n                            ? WebGPUConstants.LoadOp.Clear\n                            : WebGPUConstants.LoadOp.Load,\n                    stencilStoreOp: !depthTextureHasStencil ? undefined : WebGPUConstants.StoreOp.Store,\n                }\n                : undefined,\n            occlusionQuerySet: ((_b = this._occlusionQuery) === null || _b === void 0 ? void 0 : _b.hasQueries) ? this._occlusionQuery.querySet : undefined,\n        };\n        this._rttRenderPassWrapper.renderPass = this._renderTargetEncoder.beginRenderPass(this._rttRenderPassWrapper.renderPassDescriptor);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                var internalTexture = rtWrapper.texture;\n                console.log(\"frame #\" + this._count + \" - render target begin pass - internalTexture.uniqueId=\", internalTexture.uniqueId, \"width=\", internalTexture.width, \"height=\", internalTexture.height, this._rttRenderPassWrapper.renderPassDescriptor);\n            }\n        }\n        this._currentRenderPass = this._rttRenderPassWrapper.renderPass;\n        (_c = this._debugFlushPendingCommands) === null || _c === void 0 ? void 0 : _c.call(this);\n        this._resetCurrentViewport(1);\n        this._resetCurrentScissor(1);\n        this._resetCurrentStencilRef(1);\n        this._resetCurrentColorBlend(1);\n        if (!gpuDepthStencilWrapper || !WebGPUTextureHelper.HasStencilAspect(gpuDepthStencilWrapper.format)) {\n            this._stencilStateComposer.enabled = false;\n        }\n    };\n    /** @hidden */\n    WebGPUEngine.prototype._endRenderTargetRenderPass = function () {\n        var _a, _b, _c, _d;\n        if (this._currentRenderPass) {\n            var gpuWrapper = (_a = this._currentRenderTarget.texture) === null || _a === void 0 ? void 0 : _a._hardwareTexture;\n            if (gpuWrapper && !this._snapshotRendering.endRenderTargetPass(this._currentRenderPass, gpuWrapper) && !this.compatibilityMode) {\n                this._bundleListRenderTarget.run(this._currentRenderPass);\n                this._bundleListRenderTarget.reset();\n            }\n            this._currentRenderPass.end();\n            if (this.dbgVerboseLogsForFirstFrames) {\n                if (this._count === undefined) {\n                    this._count = 0;\n                }\n                if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                    console.log(\"frame #\" + this._count + \" - render target end pass - internalTexture.uniqueId=\", (_c = (_b = this._currentRenderTarget) === null || _b === void 0 ? void 0 : _b.texture) === null || _c === void 0 ? void 0 : _c.uniqueId);\n                }\n            }\n            (_d = this._debugPopGroup) === null || _d === void 0 ? void 0 : _d.call(this, 1);\n            this._resetCurrentViewport(1);\n            this._resetCurrentScissor(1);\n            this._resetCurrentStencilRef(1);\n            this._resetCurrentColorBlend(1);\n            this._currentRenderPass = null;\n            this._rttRenderPassWrapper.reset();\n        }\n    };\n    WebGPUEngine.prototype._getCurrentRenderPass = function () {\n        if (this._currentRenderTarget && !this._currentRenderPass) {\n            // delayed creation of the render target pass, but we now need to create it as we are requested the render pass\n            this._startRenderTargetRenderPass(this._currentRenderTarget, false, null, false, false);\n        }\n        else if (!this._currentRenderPass) {\n            this._startMainRenderPass(false);\n        }\n        return this._currentRenderPass;\n    };\n    /** @hidden */\n    WebGPUEngine.prototype._getCurrentRenderPassIndex = function () {\n        return this._currentRenderPass === null ? -1 : this._currentRenderPass === this._mainRenderPassWrapper.renderPass ? 0 : 1;\n    };\n    WebGPUEngine.prototype._startMainRenderPass = function (setClearStates, clearColor, clearDepth, clearStencil) {\n        var _a, _b, _c;\n        if (this._mainRenderPassWrapper.renderPass) {\n            this._endMainRenderPass();\n        }\n        if (this.useReverseDepthBuffer) {\n            this.setDepthFunctionToGreaterOrEqual();\n        }\n        var mustClearColor = setClearStates && clearColor;\n        var mustClearDepth = setClearStates && clearDepth;\n        var mustClearStencil = setClearStates && clearStencil;\n        this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].clearValue = mustClearColor ? clearColor : undefined;\n        this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].loadOp = mustClearColor ? WebGPUConstants.LoadOp.Clear : WebGPUConstants.LoadOp.Load;\n        this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.depthClearValue = mustClearDepth\n            ? this.useReverseDepthBuffer\n                ? this._clearReverseDepthValue\n                : this._clearDepthValue\n            : undefined;\n        this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.depthLoadOp = mustClearDepth ? WebGPUConstants.LoadOp.Clear : WebGPUConstants.LoadOp.Load;\n        this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.stencilClearValue = mustClearStencil ? this._clearStencilValue : undefined;\n        this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.stencilLoadOp = !this.isStencilEnable\n            ? undefined\n            : mustClearStencil\n                ? WebGPUConstants.LoadOp.Clear\n                : WebGPUConstants.LoadOp.Load;\n        this._mainRenderPassWrapper.renderPassDescriptor.occlusionQuerySet = ((_a = this._occlusionQuery) === null || _a === void 0 ? void 0 : _a.hasQueries) ? this._occlusionQuery.querySet : undefined;\n        this._swapChainTexture = this._context.getCurrentTexture();\n        this._mainRenderPassWrapper.colorAttachmentGPUTextures[0].set(this._swapChainTexture);\n        // Resolve in case of MSAA\n        if (this._options.antialiasing) {\n            this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].resolveTarget = this._swapChainTexture.createView();\n        }\n        else {\n            this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].view = this._swapChainTexture.createView();\n        }\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - main begin pass - texture width=\" + this._mainTextureExtends.width, \" height=\" + this._mainTextureExtends.height, this._mainRenderPassWrapper.renderPassDescriptor);\n            }\n        }\n        (_b = this._debugPushGroup) === null || _b === void 0 ? void 0 : _b.call(this, \"main pass\", 0);\n        this._currentRenderPass = this._renderEncoder.beginRenderPass(this._mainRenderPassWrapper.renderPassDescriptor);\n        this._mainRenderPassWrapper.renderPass = this._currentRenderPass;\n        (_c = this._debugFlushPendingCommands) === null || _c === void 0 ? void 0 : _c.call(this);\n        this._resetCurrentViewport(0);\n        this._resetCurrentScissor(0);\n        this._resetCurrentStencilRef(0);\n        this._resetCurrentColorBlend(0);\n        if (!this._isStencilEnable) {\n            this._stencilStateComposer.enabled = false;\n        }\n    };\n    WebGPUEngine.prototype._endMainRenderPass = function () {\n        var _a;\n        if (this._mainRenderPassWrapper.renderPass !== null) {\n            this._snapshotRendering.endMainRenderPass();\n            if (!this.compatibilityMode && !this._snapshotRendering.play) {\n                this._bundleList.run(this._mainRenderPassWrapper.renderPass);\n                this._bundleList.reset();\n            }\n            this._mainRenderPassWrapper.renderPass.end();\n            if (this.dbgVerboseLogsForFirstFrames) {\n                if (this._count === undefined) {\n                    this._count = 0;\n                }\n                if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                    console.log(\"frame #\" + this._count + \" - main end pass\");\n                }\n            }\n            (_a = this._debugPopGroup) === null || _a === void 0 ? void 0 : _a.call(this, 0);\n            this._resetCurrentViewport(0);\n            this._resetCurrentScissor(0);\n            this._resetCurrentStencilRef(0);\n            this._resetCurrentColorBlend(0);\n            if (this._mainRenderPassWrapper.renderPass === this._currentRenderPass) {\n                this._currentRenderPass = null;\n            }\n            this._mainRenderPassWrapper.reset(false);\n        }\n    };\n    /**\n     * Binds the frame buffer to the specified texture.\n     * @param texture The render target wrapper to render to\n     * @param faceIndex The face of the texture to render to in case of cube texture\n     * @param requiredWidth The width of the target to render to\n     * @param requiredHeight The height of the target to render to\n     * @param forceFullscreenViewport Forces the viewport to be the entire texture/screen if true\n     * @param lodLevel defines the lod level to bind to the frame buffer\n     * @param layer defines the 2d array index to bind to frame buffer to\n     */\n    WebGPUEngine.prototype.bindFramebuffer = function (texture, faceIndex, requiredWidth, requiredHeight, forceFullscreenViewport, lodLevel, layer) {\n        var _a, _b;\n        if (faceIndex === void 0) { faceIndex = 0; }\n        if (lodLevel === void 0) { lodLevel = 0; }\n        if (layer === void 0) { layer = 0; }\n        var hardwareTexture = (_a = texture.texture) === null || _a === void 0 ? void 0 : _a._hardwareTexture;\n        if (this._currentRenderTarget) {\n            this.unBindFramebuffer(this._currentRenderTarget);\n        }\n        this._currentRenderTarget = texture;\n        if (hardwareTexture) {\n            hardwareTexture._currentLayer = texture.isCube ? layer * 6 + faceIndex : layer;\n        }\n        this._rttRenderPassWrapper.colorAttachmentGPUTextures[0] = hardwareTexture;\n        this._rttRenderPassWrapper.depthTextureFormat = this._currentRenderTarget._depthStencilTexture\n            ? WebGPUTextureHelper.GetWebGPUTextureFormat(-1, this._currentRenderTarget._depthStencilTexture.format)\n            : undefined;\n        this._setDepthTextureFormat(this._rttRenderPassWrapper);\n        this._setColorFormat(this._rttRenderPassWrapper);\n        this._rttRenderPassWrapper.colorAttachmentViewDescriptor = {\n            format: this._colorFormat,\n            dimension: WebGPUConstants.TextureViewDimension.E2d,\n            mipLevelCount: 1,\n            baseArrayLayer: texture.isCube ? layer * 6 + faceIndex : layer,\n            baseMipLevel: lodLevel,\n            arrayLayerCount: 1,\n            aspect: WebGPUConstants.TextureAspect.All,\n        };\n        this._rttRenderPassWrapper.depthAttachmentViewDescriptor = {\n            format: this._depthTextureFormat,\n            dimension: WebGPUConstants.TextureViewDimension.E2d,\n            mipLevelCount: 1,\n            baseArrayLayer: texture.isCube ? layer * 6 + faceIndex : layer,\n            baseMipLevel: 0,\n            arrayLayerCount: 1,\n            aspect: WebGPUConstants.TextureAspect.All,\n        };\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - bindFramebuffer called - internalTexture.uniqueId=\", (_b = texture.texture) === null || _b === void 0 ? void 0 : _b.uniqueId, \"face=\", faceIndex, \"lodLevel=\", lodLevel, \"layer=\", layer, this._rttRenderPassWrapper.colorAttachmentViewDescriptor, this._rttRenderPassWrapper.depthAttachmentViewDescriptor);\n            }\n        }\n        this._currentRenderPass = null; // lazy creation of the render pass, hoping the render pass will be created by a call to clear()...\n        if (this.snapshotRendering && this.snapshotRenderingMode === 1) {\n            // force the creation of the render pass as we know in fast snapshot rendering mode clear() won't be called\n            this._getCurrentRenderPass();\n        }\n        if (this._cachedViewport && !forceFullscreenViewport) {\n            this.setViewport(this._cachedViewport, requiredWidth, requiredHeight);\n        }\n        else {\n            if (!requiredWidth) {\n                requiredWidth = texture.width;\n                if (lodLevel) {\n                    requiredWidth = requiredWidth / Math.pow(2, lodLevel);\n                }\n            }\n            if (!requiredHeight) {\n                requiredHeight = texture.height;\n                if (lodLevel) {\n                    requiredHeight = requiredHeight / Math.pow(2, lodLevel);\n                }\n            }\n            this._viewport(0, 0, requiredWidth, requiredHeight);\n        }\n        this.wipeCaches();\n    };\n    /**\n     * Unbind the current render target texture from the WebGPU context\n     * @param texture defines the render target wrapper to unbind\n     * @param disableGenerateMipMaps defines a boolean indicating that mipmaps must not be generated\n     * @param onBeforeUnbind defines a function which will be called before the effective unbind\n     */\n    WebGPUEngine.prototype.unBindFramebuffer = function (texture, disableGenerateMipMaps, onBeforeUnbind) {\n        var _a, _b;\n        if (disableGenerateMipMaps === void 0) { disableGenerateMipMaps = false; }\n        var saveCRT = this._currentRenderTarget;\n        this._currentRenderTarget = null; // to be iso with thinEngine, this._currentRenderTarget must be null when onBeforeUnbind is called\n        if (onBeforeUnbind) {\n            onBeforeUnbind();\n        }\n        this._currentRenderTarget = saveCRT;\n        if (this._currentRenderPass && this._currentRenderPass !== this._mainRenderPassWrapper.renderPass) {\n            this._endRenderTargetRenderPass();\n        }\n        if (((_a = texture.texture) === null || _a === void 0 ? void 0 : _a.generateMipMaps) && !disableGenerateMipMaps && !texture.isCube) {\n            this._generateMipmaps(texture.texture);\n        }\n        this._currentRenderTarget = null;\n        this._onAfterUnbindFrameBufferObservable.notifyObservers(this);\n        if (this.dbgVerboseLogsForFirstFrames) {\n            if (this._count === undefined) {\n                this._count = 0;\n            }\n            if (!this._count || this._count < this.dbgVerboseLogsNumFrames) {\n                console.log(\"frame #\" + this._count + \" - unBindFramebuffer called - internalTexture.uniqueId=\", (_b = texture.texture) === null || _b === void 0 ? void 0 : _b.uniqueId);\n            }\n        }\n        this._mrtAttachments = [];\n        this._cacheRenderPipeline.setMRT([]);\n        this._cacheRenderPipeline.setMRTAttachments(this._mrtAttachments);\n        this._currentRenderPass = this._mainRenderPassWrapper.renderPass;\n        this._setDepthTextureFormat(this._mainRenderPassWrapper);\n        this._setColorFormat(this._mainRenderPassWrapper);\n    };\n    /**\n     * Unbind the current render target and bind the default framebuffer\n     */\n    WebGPUEngine.prototype.restoreDefaultFramebuffer = function () {\n        if (this._currentRenderTarget) {\n            this.unBindFramebuffer(this._currentRenderTarget);\n        }\n        else {\n            this._currentRenderPass = this._mainRenderPassWrapper.renderPass;\n            this._setDepthTextureFormat(this._mainRenderPassWrapper);\n            this._setColorFormat(this._mainRenderPassWrapper);\n        }\n        if (this._currentRenderPass) {\n            if (this._cachedViewport) {\n                this.setViewport(this._cachedViewport);\n            }\n        }\n        this.wipeCaches();\n    };\n    //------------------------------------------------------------------------------\n    //                              Render\n    //------------------------------------------------------------------------------\n    /**\n     * @param wrapper\n     * @hidden\n     */\n    WebGPUEngine.prototype._setColorFormat = function (wrapper) {\n        var _a, _b;\n        var format = (_b = (_a = wrapper.colorAttachmentGPUTextures[0]) === null || _a === void 0 ? void 0 : _a.format) !== null && _b !== void 0 ? _b : null;\n        this._cacheRenderPipeline.setColorFormat(format);\n        if (this._colorFormat === format) {\n            return;\n        }\n        this._colorFormat = format;\n    };\n    /**\n     * @param wrapper\n     * @hidden\n     */\n    WebGPUEngine.prototype._setDepthTextureFormat = function (wrapper) {\n        this._cacheRenderPipeline.setDepthStencilFormat(wrapper.depthTextureFormat);\n        if (this._depthTextureFormat === wrapper.depthTextureFormat) {\n            return;\n        }\n        this._depthTextureFormat = wrapper.depthTextureFormat;\n    };\n    WebGPUEngine.prototype.setDitheringState = function () {\n        // Does not exist in WebGPU\n    };\n    WebGPUEngine.prototype.setRasterizerState = function () {\n        // Does not exist in WebGPU\n    };\n    /**\n     * Set various states to the webGL context\n     * @param culling defines culling state: true to enable culling, false to disable it\n     * @param zOffset defines the value to apply to zOffset (0 by default)\n     * @param force defines if states must be applied even if cache is up to date\n     * @param reverseSide defines if culling must be reversed (CCW if false, CW if true)\n     * @param cullBackFaces true to cull back faces, false to cull front faces (if culling is enabled)\n     * @param stencil stencil states to set\n     * @param zOffsetUnits defines the value to apply to zOffsetUnits (0 by default)\n     */\n    WebGPUEngine.prototype.setState = function (culling, zOffset, force, reverseSide, cullBackFaces, stencil, zOffsetUnits) {\n        var _a, _b;\n        if (zOffset === void 0) { zOffset = 0; }\n        if (reverseSide === void 0) { reverseSide = false; }\n        if (zOffsetUnits === void 0) { zOffsetUnits = 0; }\n        // Culling\n        if (this._depthCullingState.cull !== culling || force) {\n            this._depthCullingState.cull = culling;\n        }\n        // Cull face\n        var cullFace = ((_b = (_a = this.cullBackFaces) !== null && _a !== void 0 ? _a : cullBackFaces) !== null && _b !== void 0 ? _b : true) ? 1 : 2;\n        if (this._depthCullingState.cullFace !== cullFace || force) {\n            this._depthCullingState.cullFace = cullFace;\n        }\n        // Z offset\n        this.setZOffset(zOffset);\n        this.setZOffsetUnits(zOffsetUnits);\n        // Front face\n        var frontFace = reverseSide ? (this._currentRenderTarget ? 1 : 2) : this._currentRenderTarget ? 2 : 1;\n        if (this._depthCullingState.frontFace !== frontFace || force) {\n            this._depthCullingState.frontFace = frontFace;\n        }\n        this._stencilStateComposer.stencilMaterial = stencil;\n    };\n    WebGPUEngine.prototype._applyRenderPassChanges = function (renderPass, bundleList) {\n        var _a;\n        var mustUpdateViewport = this._mustUpdateViewport(renderPass);\n        var mustUpdateScissor = this._mustUpdateScissor(renderPass);\n        var mustUpdateStencilRef = !this._stencilStateComposer.enabled ? false : this._mustUpdateStencilRef(renderPass);\n        var mustUpdateBlendColor = !this._alphaState.alphaBlend ? false : this._mustUpdateBlendColor(renderPass);\n        if (bundleList) {\n            if (mustUpdateViewport) {\n                bundleList.addItem(new WebGPURenderItemViewport(this._viewportCached.x, this._viewportCached.y, this._viewportCached.z, this._viewportCached.w));\n            }\n            if (mustUpdateScissor) {\n                bundleList.addItem(new WebGPURenderItemScissor(this._scissorCached.x, this._scissorCached.y, this._scissorCached.z, this._scissorCached.w));\n            }\n            if (mustUpdateStencilRef) {\n                bundleList.addItem(new WebGPURenderItemStencilRef((_a = this._stencilStateComposer.funcRef) !== null && _a !== void 0 ? _a : 0));\n            }\n            if (mustUpdateBlendColor) {\n                bundleList.addItem(new WebGPURenderItemBlendColor(this._alphaState._blendConstants.slice()));\n            }\n        }\n        else {\n            if (mustUpdateViewport) {\n                this._applyViewport(renderPass);\n            }\n            if (mustUpdateScissor) {\n                this._applyScissor(renderPass);\n            }\n            if (mustUpdateStencilRef) {\n                this._applyStencilRef(renderPass);\n            }\n            if (mustUpdateBlendColor) {\n                this._applyBlendColor(renderPass);\n            }\n        }\n    };\n    WebGPUEngine.prototype._draw = function (drawType, fillMode, start, count, instancesCount) {\n        var _a;\n        var renderPass = this._getCurrentRenderPass();\n        var renderPassIndex = this._getCurrentRenderPassIndex();\n        var bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\n        this.applyStates();\n        var webgpuPipelineContext = this._currentEffect._pipelineContext;\n        this.bindUniformBufferBase(this._currentRenderTarget ? this._ubInvertY : this._ubDontInvertY, 0, WebGPUShaderProcessor.InternalsUBOName);\n        if (webgpuPipelineContext.uniformBuffer) {\n            webgpuPipelineContext.uniformBuffer.update();\n            this.bindUniformBufferBase(webgpuPipelineContext.uniformBuffer.getBuffer(), 0, WebGPUShaderProcessor.LeftOvertUBOName);\n        }\n        if (this._snapshotRendering.play) {\n            this._reportDrawCall();\n            return;\n        }\n        if (!this.compatibilityMode &&\n            (this._currentDrawContext.isDirty(this._currentMaterialContext.updateId) || this._currentMaterialContext.isDirty || this._currentMaterialContext.forceBindGroupCreation)) {\n            this._currentDrawContext.fastBundle = undefined;\n        }\n        var useFastPath = !this.compatibilityMode && this._currentDrawContext.fastBundle;\n        var renderPass2 = renderPass;\n        if (useFastPath || this._snapshotRendering.record) {\n            this._applyRenderPassChanges(renderPass, bundleList);\n            if (!this._snapshotRendering.record) {\n                this._counters.numBundleReuseNonCompatMode++;\n                if (this._currentDrawContext.indirectDrawBuffer) {\n                    this._currentDrawContext.setIndirectData(count, instancesCount || 1, start);\n                }\n                bundleList.addBundle(this._currentDrawContext.fastBundle);\n                this._reportDrawCall();\n                return;\n            }\n            renderPass2 = bundleList.getBundleEncoder(this._cacheRenderPipeline.colorFormats, this._depthTextureFormat, this.currentSampleCount); // for snapshot recording mode\n            bundleList.numDrawCalls++;\n        }\n        var textureState = 0;\n        if (!this._caps.textureFloatLinearFiltering && this._currentMaterialContext.hasFloatTextures) {\n            var bitVal = 1;\n            for (var i = 0; i < webgpuPipelineContext.shaderProcessingContext.textureNames.length; ++i) {\n                var textureName = webgpuPipelineContext.shaderProcessingContext.textureNames[i];\n                var texture = (_a = this._currentMaterialContext.textures[textureName]) === null || _a === void 0 ? void 0 : _a.texture;\n                if ((texture === null || texture === void 0 ? void 0 : texture.type) === 1) {\n                    textureState |= bitVal;\n                }\n                bitVal = bitVal << 1;\n            }\n        }\n        var pipeline = this._cacheRenderPipeline.getRenderPipeline(fillMode, this._currentEffect, this.currentSampleCount, textureState);\n        var bindGroups = this._cacheBindGroups.getBindGroups(webgpuPipelineContext, this._currentDrawContext, this._currentMaterialContext);\n        if (!this._snapshotRendering.record) {\n            this._applyRenderPassChanges(renderPass, !this.compatibilityMode ? bundleList : null);\n            if (!this.compatibilityMode) {\n                this._counters.numBundleCreationNonCompatMode++;\n                renderPass2 = this._device.createRenderBundleEncoder({\n                    colorFormats: this._cacheRenderPipeline.colorFormats,\n                    depthStencilFormat: this._depthTextureFormat,\n                    sampleCount: this.currentSampleCount,\n                });\n            }\n        }\n        // bind pipeline\n        renderPass2.setPipeline(pipeline);\n        // bind index/vertex buffers\n        if (this._currentIndexBuffer) {\n            renderPass2.setIndexBuffer(this._currentIndexBuffer.underlyingResource, this._currentIndexBuffer.is32Bits ? WebGPUConstants.IndexFormat.Uint32 : WebGPUConstants.IndexFormat.Uint16, 0);\n        }\n        var vertexBuffers = this._cacheRenderPipeline.vertexBuffers;\n        for (var index = 0; index < vertexBuffers.length; index++) {\n            var vertexBuffer = vertexBuffers[index];\n            var buffer = vertexBuffer.getBuffer();\n            if (buffer) {\n                renderPass2.setVertexBuffer(index, buffer.underlyingResource, vertexBuffer._validOffsetRange ? 0 : vertexBuffer.byteOffset);\n            }\n        }\n        // bind bind groups\n        for (var i = 0; i < bindGroups.length; i++) {\n            renderPass2.setBindGroup(i, bindGroups[i]);\n        }\n        // draw\n        var nonCompatMode = !this.compatibilityMode && !this._snapshotRendering.record;\n        if (nonCompatMode && this._currentDrawContext.indirectDrawBuffer) {\n            this._currentDrawContext.setIndirectData(count, instancesCount || 1, start);\n            if (drawType === 0) {\n                renderPass2.drawIndexedIndirect(this._currentDrawContext.indirectDrawBuffer, 0);\n            }\n            else {\n                renderPass2.drawIndirect(this._currentDrawContext.indirectDrawBuffer, 0);\n            }\n        }\n        else if (drawType === 0) {\n            renderPass2.drawIndexed(count, instancesCount || 1, start, 0, 0);\n        }\n        else {\n            renderPass2.draw(count, instancesCount || 1, start, 0);\n        }\n        if (nonCompatMode) {\n            this._currentDrawContext.fastBundle = renderPass2.finish();\n            bundleList.addBundle(this._currentDrawContext.fastBundle);\n        }\n        this._reportDrawCall();\n    };\n    /**\n     * Draw a list of indexed primitives\n     * @param fillMode defines the primitive to use\n     * @param indexStart defines the starting index\n     * @param indexCount defines the number of index to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    WebGPUEngine.prototype.drawElementsType = function (fillMode, indexStart, indexCount, instancesCount) {\n        if (instancesCount === void 0) { instancesCount = 1; }\n        this._draw(0, fillMode, indexStart, indexCount, instancesCount);\n    };\n    /**\n     * Draw a list of unindexed primitives\n     * @param fillMode defines the primitive to use\n     * @param verticesStart defines the index of first vertex to draw\n     * @param verticesCount defines the count of vertices to draw\n     * @param instancesCount defines the number of instances to draw (if instantiation is enabled)\n     */\n    WebGPUEngine.prototype.drawArraysType = function (fillMode, verticesStart, verticesCount, instancesCount) {\n        if (instancesCount === void 0) { instancesCount = 1; }\n        this._currentIndexBuffer = null;\n        this._draw(1, fillMode, verticesStart, verticesCount, instancesCount);\n    };\n    //------------------------------------------------------------------------------\n    //                              Dispose\n    //------------------------------------------------------------------------------\n    /**\n     * Dispose and release all associated resources\n     */\n    WebGPUEngine.prototype.dispose = function () {\n        var _a, _b, _c;\n        (_a = this._mainTexture) === null || _a === void 0 ? void 0 : _a.destroy();\n        (_b = this._mainTextureLastCopy) === null || _b === void 0 ? void 0 : _b.destroy();\n        (_c = this._depthTexture) === null || _c === void 0 ? void 0 : _c.destroy();\n        _super.prototype.dispose.call(this);\n    };\n    //------------------------------------------------------------------------------\n    //                              Misc\n    //------------------------------------------------------------------------------\n    /**\n     * Gets the current render width\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render width\n     */\n    WebGPUEngine.prototype.getRenderWidth = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.width;\n        }\n        return this._canvas.width;\n    };\n    /**\n     * Gets the current render height\n     * @param useScreen defines if screen size must be used (or the current render target if any)\n     * @returns a number defining the current render height\n     */\n    WebGPUEngine.prototype.getRenderHeight = function (useScreen) {\n        if (useScreen === void 0) { useScreen = false; }\n        if (!useScreen && this._currentRenderTarget) {\n            return this._currentRenderTarget.height;\n        }\n        return this._canvas.height;\n    };\n    /**\n     * Gets the HTML canvas attached with the current WebGPU context\n     * @returns a HTML canvas\n     */\n    WebGPUEngine.prototype.getRenderingCanvas = function () {\n        return this._canvas;\n    };\n    //------------------------------------------------------------------------------\n    //                              Errors\n    //------------------------------------------------------------------------------\n    /**\n     * Get the current error code of the WebGPU context\n     * @returns the error code\n     */\n    WebGPUEngine.prototype.getError = function () {\n        // TODO WEBGPU. from the webgpu errors.\n        return 0;\n    };\n    //------------------------------------------------------------------------------\n    //                              Unused WebGPU\n    //------------------------------------------------------------------------------\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.bindSamplers = function () { };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype._bindTextureDirectly = function () {\n        return false;\n    };\n    /**\n     * Gets a boolean indicating if all created effects are ready\n     * @returns always true - No parallel shader compilation\n     */\n    WebGPUEngine.prototype.areAllEffectsReady = function () {\n        return true;\n    };\n    /**\n     * @param pipelineContext\n     * @param action\n     * @hidden\n     */\n    WebGPUEngine.prototype._executeWhenRenderingStateIsCompiled = function (pipelineContext, action) {\n        // No parallel shader compilation.\n        // No Async, so direct launch\n        action();\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype._isRenderingStateCompiled = function () {\n        // No parallel shader compilation.\n        return true;\n    };\n    /** @hidden */\n    WebGPUEngine.prototype._getUnpackAlignement = function () {\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype._unpackFlipY = function () { };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype._bindUnboundFramebuffer = function () {\n        throw \"_bindUnboundFramebuffer is not implementedin WebGPU! You probably want to use restoreDefaultFramebuffer or unBindFramebuffer instead\";\n    };\n    // TODO WEBGPU. All of the below should go once engine split with baseEngine.\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype._getSamplingParameters = function () {\n        throw \"_getSamplingParameters is not available in WebGPU\";\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.getUniforms = function () {\n        return [];\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setIntArray = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setIntArray2 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setIntArray3 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setIntArray4 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setArray = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setArray2 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setArray3 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setArray4 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setMatrices = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setMatrix3x3 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setMatrix2x2 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setFloat = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setFloat2 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setFloat3 = function () {\n        return false;\n    };\n    /**\n     * @hidden\n     */\n    WebGPUEngine.prototype.setFloat4 = function () {\n        return false;\n    };\n    // Default glslang options.\n    WebGPUEngine._GLSLslangDefaultOptions = {\n        jsPath: \"https://preview.babylonjs.com/glslang/glslang.js\",\n        wasmPath: \"https://preview.babylonjs.com/glslang/glslang.wasm\",\n    };\n    /** true to enable using TintWASM to convert Spir-V to WGSL */\n    WebGPUEngine.UseTWGSL = true;\n    return WebGPUEngine;\n}(Engine));\nexport { WebGPUEngine };\n//# sourceMappingURL=webgpuEngine.js.map"],"names":["__native_1","onNativeObjectInitialized","self","Object","prototype","hasOwnProperty","call","defineProperty","get","set","value","notifyObservers","AcquireNativeObjectAsync","Promise","resolve","_native","addOnce","nativeObject","RegisterNativeTypeAsync","typeName","constructor","this","_a","label","sent","NativePipelineContext","engine","isAsync","isReady","_valueCache","_getVertexShaderCode","_getFragmentShaderCode","_handlesSpectorRebuildCallback","onCompiled","Error","_fillEffectInformation","effect","uniformBuffersNames","uniformsNames","uniforms","samplerList","samplers","attributesNames","attributes","index","supportsUniformBuffers","name_1","bindUniformBlock","getUniforms","forEach","uniform","_uniforms","length","getUniform","splice","name","push","apply","getAttributes","dispose","_cacheMatrix","uniformName","matrix","cache","flag","updateFlag","undefined","_cacheFloat2","x","y","changed","_cacheFloat3","z","_cacheFloat4","w","setInt","setInt2","setInt3","setInt4","setIntArray","array","setIntArray2","setIntArray3","setIntArray4","setFloatArray","setFloatArray2","setFloatArray3","setFloatArray4","setArray","setArray2","setArray3","setArray4","setMatrices","matrices","setMatrix","toArray","setMatrix3x3","setMatrix2x2","setFloat","setBool","bool","setVector2","vector2","setFloat2","setVector3","vector3","setFloat3","setVector4","vector4","setFloat4","setQuaternion","quaternion","setColor3","color3","r","g","b","setColor4","alpha","setDirectColor4","color4","a","NativeRenderTargetWrapper","_super","isMulti","isCube","size","_this","__framebuffer","__framebufferDepthStencil","_engine","framebuffer","_releaseFramebufferObjects","enumerable","configurable","framebufferDepthStencil","disposeOnlyFramebuffers","_framebuffer","_framebufferDepthStencil","NativeDataBuffer","arguments","CommandBufferEncoder","_pending","Array","_isCommandBufferScopeActive","_commandStream","NativeEngine","_createNativeDataStream","setCommandDataStream","beginCommandScope","endCommandScope","_submit","startEncodingCommand","command","writeNativeData","encodeCommandArgAsUInt32","commandArg","writeUint32","encodeCommandArgAsUInt32s","writeUint32Array","encodeCommandArgAsInt32","writeInt32","encodeCommandArgAsInt32s","writeInt32Array","encodeCommandArgAsFloat32","writeFloat32","encodeCommandArgAsFloat32s","writeFloat32Array","encodeCommandArgAsNativeData","finishEncodingCommand","submitCommands","options","adaptToDeviceRatio","Engine","_camera","Camera","_commandBufferEncoder","_boundBuffersVertexArray","_currentDepthTest","DEPTH_TEST_LEQUAL","_stencilTest","_stencilMask","_stencilFunc","_stencilFuncRef","_stencilFuncMask","_stencilOpStencilFail","_stencilOpDepthFail","_stencilOpStencilDepthPass","_zOffset","_zOffsetUnits","_depthWrite","PROTOCOL_VERSION","concat","_webGLVersion","disableUniformBuffers","_caps","maxTexturesImageUnits","maxVertexTextureImageUnits","maxCombinedTexturesImageUnits","maxTextureSize","CAPS_LIMITS_MAX_TEXTURE_SIZE","maxCubemapTextureSize","maxRenderTextureSize","maxVertexAttribs","maxVaryingVectors","maxFragmentUniformVectors","maxVertexUniformVectors","standardDerivatives","astc","pvrtc","etc1","etc2","bptc","maxAnisotropy","uintIndices","fragmentDepthSupported","highPrecisionShaderSupported","colorBufferFloat","textureFloat","textureFloatLinearFiltering","textureFloatRender","textureHalfFloat","textureHalfFloatLinearFiltering","textureHalfFloatRender","textureLOD","drawBuffersExtension","depthTextureExtension","vertexArrayObject","instancedArrays","supportOcclusionQuery","canUseTimestampForTimerQuery","blendMinMax","maxMSAASamples","canUseGLInstanceID","canUseGLVertexID","supportComputeShaders","supportSRGBBuffers","supportTransformFeedbacks","textureMaxLevel","texture2DArrayMaxLayerCount","CAPS_LIMITS_MAX_TEXTURE_LAYERS","_features","forceBitmapOverHTMLImageElement","supportRenderAndCopyToLodForFloatTextures","supportDepthStencilTexture","supportShadowSamplers","uniformBufferHardCheckMatrix","allowTexturePrefiltering","trackUbosInFrame","checkUbosContentBeforeUpload","supportCSM","basisNeedsPOT","support3DTextures","needTypeSuffixInShaderConstants","supportMSAA","supportSSAO2","supportExtendedTextureFormats","supportSwitchCaseInShader","supportSyncTextureRead","needsInvertingBitmap","useUBOBindingCache","needShaderCodeInlining","needToAlwaysBindUniformBuffers","supportRenderPasses","_collectUbosUpdatedInFrame","scriptUrl","onSuccess","onError","scriptId","data","Function","request","exception","URL","window","createObjectURL","revokeObjectURL","Blob","v","devicePixelRatio","_hardwareScalingLevel","resize","currentDepthFunction","getDepthFunction","setDepthFunction","_shaderProcessor","onNewSceneAddedObservable","add","scene","originalRender","render","args","_i","getHardwareScalingLevel","setHardwareScalingLevel","level","_deleteVertexArray","_queueNewFrame","bindedRenderFunction","requester","requestAnimationFrame","_bindUnboundFramebuffer","_currentFramebuffer","COMMAND_UNBINDFRAMEBUFFER","COMMAND_BINDFRAMEBUFFER","getHostDocument","clear","color","backBuffer","depth","stencil","useReverseDepthBuffer","COMMAND_CLEAR","createIndexBuffer","indices","updateable","_normalizeIndexData","buffer","references","is32Bits","BYTES_PER_ELEMENT","byteLength","nativeIndexBuffer","byteOffset","createVertexBuffer","vertices","ArrayBuffer","isView","Float32Array","nativeVertexBuffer","_recordVertexArrayObject","vertexArray","vertexBuffers","indexBuffer","recordIndexBuffer","getAttributesNames","location_1","getAttributeLocation","vertexBuffer","getBuffer","recordVertexBuffer","byteStride","getSize","_getNativeAttribType","type","normalized","getInstanceDivisor","bindBuffers","createVertexArray","bindVertexArrayObject","recordVertexArrayObject","COMMAND_DELETEVERTEXARRAY","COMMAND_BINDVERTEXARRAY","releaseVertexArrayObject","pipelineContext","nativePipelineContext","nativeProgram","drawElementsType","fillMode","indexStart","indexCount","instancesCount","_drawCalls","addCount","COMMAND_DRAWINDEXED","drawArraysType","verticesStart","verticesCount","COMMAND_DRAW","createPipelineContext","createMaterialContext","createDrawContext","_preparePipelineContext","vertexSourceCode","fragmentSourceCode","createAsRaw","rawVertexSourceCode","rawFragmentSourceCode","rebuildRebind","defines","transformFeedbackVaryings","createRawShaderProgram","createShaderProgram","_isRenderingStateCompiled","_executeWhenRenderingStateIsCompiled","action","vertexCode","fragmentCode","context","onBeforeShaderCompilationObservable","vertexInliner","processCode","code","fragmentInliner","program","createProgram","onAfterShaderCompilationObservable","inlineShaderCode","sci","debug","_setProgram","_currentProgram","COMMAND_SETPROGRAM","_deletePipelineContext","COMMAND_DELETEPROGRAM","blockName","bindSamplers","getPipelineContext","getSamplers","_boundUniforms","_currentEffect","matrixArray","COMMAND_SETMATRIX","getRenderWidth","useScreen","_currentRenderTarget","width","getRenderHeight","height","setViewport","viewport","requiredWidth","requiredHeight","_cachedViewport","setViewPort","setState","culling","zOffset","force","reverseSide","cullBackFaces","zOffsetUnits","_b","COMMAND_SETSTATE","getInputElementClientRect","bottom","left","right","top","toJSON","setZOffset","COMMAND_SETZOFFSET","getZOffset","setZOffsetUnits","COMMAND_SETZOFFSETUNITS","getZOffsetUnits","setDepthBuffer","enable","COMMAND_SETDEPTHTEST","DEPTH_TEST_ALWAYS","getDepthWrite","DEPTH_TEST_NEVER","DEPTH_TEST_GREATER","DEPTH_TEST_GEQUAL","DEPTH_TEST_NOTEQUAL","DEPTH_TEST_EQUAL","DEPTH_TEST_LESS","depthFunc","nativeDepthFunc","setDepthWrite","COMMAND_SETDEPTHWRITE","Number","setColorWrite","_colorWrite","COMMAND_SETCOLORWRITE","getColorWrite","applyStencil","_setStencil","_getStencilOpFail","_getStencilDepthFail","_getStencilDepthPass","_getStencilFunc","mask","stencilOpFail","depthOpFail","depthOpPass","func","ref","COMMAND_SETSTENCIL","setStencilBuffer","STENCIL_OP_FAIL_S_KEEP","STENCIL_OP_FAIL_Z_KEEP","STENCIL_OP_PASS_Z_KEEP","STENCIL_TEST_ALWAYS","getStencilBuffer","getStencilOperationPass","setStencilOperationPass","operation","setStencilMask","setStencilFunction","stencilFunc","setStencilFunctionReference","reference","setStencilFunctionMask","setStencilOperationFail","setStencilOperationDepthFail","getStencilMask","getStencilFunction","getStencilFunctionReference","getStencilFunctionMask","getStencilOperationFail","getStencilOperationDepthFail","setAlphaConstants","setAlphaMode","mode","noDepthWriteChange","_alphaMode","nativeMode","_getNativeAlphaMode","COMMAND_SETBLENDMODE","getAlphaMode","int","COMMAND_SETINT","COMMAND_SETINTARRAY","COMMAND_SETINTARRAY2","COMMAND_SETINTARRAY3","COMMAND_SETINTARRAY4","COMMAND_SETFLOATARRAY","COMMAND_SETFLOATARRAY2","COMMAND_SETFLOATARRAY3","COMMAND_SETFLOATARRAY4","COMMAND_SETMATRICES","COMMAND_SETMATRIX3X3","COMMAND_SETMATRIX2X2","COMMAND_SETFLOAT","COMMAND_SETFLOAT2","COMMAND_SETFLOAT3","COMMAND_SETFLOAT4","wipeCaches","bruteForce","preventCacheWipeBetweenFrames","resetTextureCache","_stencilStateComposer","reset","_depthCullingState","_alphaState","_cachedVertexBuffers","_cachedIndexBuffer","_cachedEffectForVertexBuffers","_createTexture","createTexture","_deleteTexture","texture","deleteTexture","updateDynamicTexture","canvas","invertY","premulAlpha","format","_hardwareTexture","source","getCanvasTexture","destination","underlyingResource","copyTexture","createDynamicTexture","generateMipMaps","samplingMode","Math","max","createRawTexture","Uint8Array","createVideoElement","constraints","createVideo","updateVideoTexture","video","webGLTexture","compression","creationFlags","useSRGBBuffer","baseWidth","baseHeight","_compression","_useSRGBBuffer","_getUseSRGBBuffer","updateRawTexture","filter","_getNativeSamplingMode","_setTextureSampling","_internalTexturesCache","createRawTexture2DArray","textureType","baseDepth","is2DArray","loadRawTexture2DArray","_getNativeTextureFormat","bufferView","loadRawTexture","url","noMipmap","onLoad","fallback","forcedExtension","mimeType","loaderOptions","fromData","substr","isBase64","indexOf","originalUrl","_transformTextureUrl","lastDot","lastIndexOf","extension","substring","toLowerCase","loader","availableLoader","canLoad","_addPendingData","doNotHandleContextLost","_buffer","onLoadObserver","onLoadedObservable","onload_1","loadTexture","getTextureWidth","getTextureHeight","_removePendingData","_loadFile","message","remove","onInternalError","responseURL","wrapNativeTexture","hardwareTexture","_gl","internalTexture","wrapWebGLTexture","_createDepthStencilTexture","rtWrapper","nativeRTWrapper","createFrameBuffer","TEXTURE_FORMAT_RGBA8","COMMAND_DELETEFRAMEBUFFER","_createImageBitmapFromSource","imageSource","reject","image","createCanvasImage","onload","imageBitmap","createImageBitmap","error","src","onerror","isArray","arr","image_1","resizeImageBitmap","bufferWidth","bufferHeight","createCubeTexture","rootUrl","files","createPolynomials","lodScale","lodOffset","_lodGenerationScale","_lodGenerationOffset","_doNotHandleContextLost","_extension","_files","info","specularInfo","specular","lodGenerationScale","imageData","getEngine","updateTextureSamplingMode","_isRGBD","loadCubeTextureWithMips","onloaddata_1","status","statusText","reorderedFiles","all","map","file","then","loadCubeTexture","_createHardwareRenderTargetWrapper","_renderTargetWrapperCache","createRenderTargetTexture","fullOptions","generateDepthBuffer","generateStencilBuffer","_generateDepthBuffer","_generateStencilBuffer","samples","setTextures","bindFramebuffer","faceIndex","forceFullscreenViewport","unBindFramebuffer","disableGenerateMipMaps","onBeforeUnbind","createDynamicVertexBuffer","updateDynamicIndexBuffer","offset","updateDynamicVertexBuffer","verticies","_setTexture","channel","isPartOfTextureArray","depthStencilTexture","_boundTexturesCache","_activeChannel","_setTextureCore","update","delayLoadState","delayLoad","getInternalTexture","emptyCubeTexture","is3D","emptyTexture3D","emptyTexture2DArray","emptyTexture","_setTextureWrapMode","_getAddressMode","wrapU","wrapV","wrapR","_updateAnisotropicLevel","COMMAND_SETTEXTURESAMPLING","addressModeU","addressModeV","addressModeW","COMMAND_SETTEXTUREWRAPMODE","COMMAND_SETTEXTURE","anisotropicFilteringLevel","_cachedAnisotropicFilteringLevel","COMMAND_SETTEXTUREANISOTROPICLEVEL","wrapMode","ADDRESS_MODE_WRAP","ADDRESS_MODE_CLAMP","ADDRESS_MODE_MIRROR","_bindTexture","_deleteBuffer","COMMAND_DELETEINDEXBUFFER","COMMAND_DELETEVERTEXBUFFER","createCanvas","Canvas","Image","updateTextureData","xOffset","yOffset","lod","_uploadCompressedDataToTextureDirectly","internalFormat","_uploadDataToTextureDirectly","_uploadArrayBufferViewToTexture","_uploadImageToTexture","TEXTURE_NEAREST_NEAREST","TEXTURE_LINEAR_LINEAR","TEXTURE_LINEAR_LINEAR_MIPLINEAR","TEXTURE_NEAREST_NEAREST_MIPNEAREST","TEXTURE_NEAREST_LINEAR_MIPNEAREST","TEXTURE_NEAREST_LINEAR_MIPLINEAR","TEXTURE_NEAREST_LINEAR","TEXTURE_NEAREST_NEAREST_MIPLINEAR","TEXTURE_LINEAR_NEAREST_MIPNEAREST","TEXTURE_LINEAR_NEAREST_MIPLINEAR","TEXTURE_LINEAR_LINEAR_MIPNEAREST","TEXTURE_LINEAR_NEAREST","STENCIL_TEST_LESS","STENCIL_TEST_LEQUAL","STENCIL_TEST_EQUAL","STENCIL_TEST_GEQUAL","STENCIL_TEST_GREATER","STENCIL_TEST_NOTEQUAL","STENCIL_TEST_NEVER","opFail","STENCIL_OP_FAIL_S_ZERO","STENCIL_OP_FAIL_S_REPLACE","STENCIL_OP_FAIL_S_INCR","STENCIL_OP_FAIL_S_DECR","STENCIL_OP_FAIL_S_INVERT","STENCIL_OP_FAIL_S_INCRSAT","STENCIL_OP_FAIL_S_DECRSAT","depthFail","STENCIL_OP_FAIL_Z_ZERO","STENCIL_OP_FAIL_Z_REPLACE","STENCIL_OP_FAIL_Z_INCR","STENCIL_OP_FAIL_Z_DECR","STENCIL_OP_FAIL_Z_INVERT","STENCIL_OP_FAIL_Z_INCRSAT","STENCIL_OP_FAIL_Z_DECRSAT","opPass","STENCIL_OP_PASS_Z_ZERO","STENCIL_OP_PASS_Z_REPLACE","STENCIL_OP_PASS_Z_INCR","STENCIL_OP_PASS_Z_DECR","STENCIL_OP_PASS_Z_INVERT","STENCIL_OP_PASS_Z_INCRSAT","STENCIL_OP_PASS_Z_DECRSAT","TEXTURE_FORMAT_RGB8","TEXTURE_FORMAT_RGBA32F","ALPHA_DISABLE","ALPHA_ADD","ALPHA_COMBINE","ALPHA_SUBTRACT","ALPHA_MULTIPLY","ALPHA_MAXIMIZED","ALPHA_ONEONE","ALPHA_PREMULTIPLIED","ALPHA_PREMULTIPLIED_PORTERDUFF","ALPHA_INTERPOLATE","ALPHA_SCREENMODE","ATTRIB_TYPE_INT8","ATTRIB_TYPE_UINT8","ATTRIB_TYPE_INT16","ATTRIB_TYPE_UINT16","ATTRIB_TYPE_FLOAT","getFontOffset","font","ascent","descent","NullEngineOptions","renderWidth","renderHeight","textureSize","deterministicLockstep","lockstepMaxSteps","NullEngine","_options","useHighPrecisionMatrix","Log","theCurrentGlobal","global","isDeterministicLockStep","getLockstepMaxSteps","__SPECTOR_rebuildProgram","enableEffect","onBind","_onBindObservable","alphaState","alphaBlend","depthCullingState","draw","useTriangles","_releaseTexture","urlArg","String","setTimeout","_bufferView","capacity","areAllEffectsReady","getError","_getUnpackAlignement","_unpackFlipY","_bindTextureDirectly","target","releaseEffects","displayLoadingUI","hideLoadingUI","_","PerformanceConfigurator","SetMatrixPrecision","use64bits","MatrixTrackPrecisionChange","MatrixUse64Bits","MatrixTrackedMatrices","m","values","_m","i","MatrixCurrentType","RenderTargetWrapper","_textures","_attachments","_depthStencilTextureWithStencil","_isMulti","_isCube","_size","_depthStencilTexture","layers","setSamples","initializeBuffers","updateMultipleRenderTargetTextureSampleCount","updateRenderTargetTextureSampleCount","textures","setTexture","disposePrevious","createDepthStencilTexture","comparisonFunction","bilinearFiltering","generateStencil","depthTextureFormat","_shareDepth","renderTarget","incrementReferences","_swapAndDie","_cloneRenderTargetWrapper","_c","_d","_e","_f","rtw","textureArray","generateDepthTexture","textureCount","lastTextureSource","_source","samplingModes","types","optionsMRT","createMultipleRenderTarget","createRenderTargetCubeTexture","_swapRenderTargetWrapper","_rebuild","bilinear","_comparisonFunction","releaseTextures","_releaseRenderTargetWrapper","ShaderStore","GetShadersRepository","shaderLanguage","ShadersRepository","ShadersRepositoryWGSL","GetShadersStore","ShadersStore","ShadersStoreWGSL","GetIncludesShadersStore","IncludesShadersStore","IncludesShadersStoreWGSL","BufferPointer","ThinEngine","canvasOrContext","antialias","_name","forcePOTTextures","isFullscreen","renderEvenInBackground","validateShaderPrograms","_useReverseDepthBuffer","isNDCHalfZRange","hasOriginBottomLeft","onDisposeObservable","_frameId","_uniformBuffers","_storageBuffers","_windowIsBackground","_highPrecisionShadersAllowed","_badOS","_badDesktopOS","_renderingQueueLaunched","_activeRenderLoops","onContextLostObservable","onContextRestoredObservable","_contextWasLost","disableVertexArrayObjects","_colorWriteChanged","_stencilState","_alphaEquation","_currentTextureChannel","_compiledEffects","_vertexAttribArraysEnabled","_uintIndicesCurrentlySet","_currentBoundBuffer","_dummyFramebuffer","_currentBufferPointers","_currentInstanceLocations","_currentInstanceBuffers","_vaoRecordInProgress","_mustWipeVertexAttributes","_nextFreeTextureSlots","_maxSimultaneousTextures","_maxMSAASamplesOverride","_activeRequests","_adaptToDeviceRatio","hostInformation","isMobile","premultipliedAlpha","onBeforeTextureInitObservable","_isWebGPU","_snapshotRenderingMode","_viewportCached","_unpackFlipYCached","enableUnpackFlipYCached","_creationOptions","stencilGlobal","getContext","_renderingCanvas","timeStep","preserveDrawingBuffer","audioEngine","audioEngineOptions","audioContext","_audioContext","audioDestination","_audioDestination","xrCompatible","navigator","userAgent","_checkForMobile","currentUA","document","addEventListener","ua","ExceptionList","key","targets","RegExp","test","capture","captureConstraint","constraint","matches","exec","parseInt","targets_1","_onContextLost","evt","preventDefault","_onContextRestored","_restoreEngineAfterContextLost","_initGLContext","bind","powerPreference","disableWebGL2Support","_shaderPlatformName","deleteQuery","e","renderbufferStorageMultisample","getContextAttributes","pixelStorei","UNPACK_COLORSPACE_CONVERSION_WEBGL","NONE","useHighPrecisionFloats","limitDeviceRatio","min","_isStencilEnable","_initFeatures","webGLVersion","versionToLog","Version","setAttribute","description","parallelShaderCompile","_getShaderProcessor","useReverse","getCreationOptions","dimensions","_framebufferDimensionsObject","_emptyTexture","_emptyTexture3D","createRawTexture3D","_emptyTexture2DArray","_emptyCubeTexture","faceData","cubeData","createRawCubeTexture","activate","snapshotRenderingReset","snapshotRendering","_CreateCanvas","OffscreenCanvas","createElement","initEngine","depthTest","depthMask","stencilTest","_rebuildEffects","_rebuildComputeEffects","_rebuildInternalTextures","_rebuildRenderTargetWrappers","_rebuildBuffers","_sharedInit","doNotHandleTouchAction","_getShaderProcessingContext","currentState_1","slice","currentState_2","_pipelineContext","_wasPreviouslyReady","_prepareEffect","getParameter","MAX_TEXTURE_IMAGE_UNITS","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","maxSamples","MAX_SAMPLES","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_RENDERBUFFER_SIZE","MAX_VERTEX_ATTRIBS","MAX_VARYING_VECTORS","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_VERTEX_UNIFORM_VECTORS","getExtension","s3tc","s3tc_srgb","textureAnisotropicFilterExtension","timerQuery","multiview","oculusMultiview","_glVersion","VERSION","rendererInfo","_glRenderer","UNMASKED_RENDERER_WEBGL","_glVendor","UNMASKED_VENDOR_WEBGL","VENDOR","RENDERER","HALF_FLOAT_OES","RGBA16F","RGBA32F","DEPTH24_STENCIL8","getQuery","getQueryEXT","TIMESTAMP_EXT","QUERY_COUNTER_BITS_EXT","MAX_TEXTURE_MAX_ANISOTROPY_EXT","_canRenderToFloatFramebuffer","COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR","COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT","COMPRESSED_SRGB_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","COMPRESSED_SRGB8_ETC2","COMPRESSED_SRGB8_ALPHA8_ETC2_EAC","_canRenderToHalfFloatFramebuffer","drawBuffers","drawBuffersWEBGL","DRAW_FRAMEBUFFER","FRAMEBUFFER","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","vertexArrayObjectExtension","createVertexArrayOES","bindVertexArray","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","instanceExtension","drawArraysInstanced","drawArraysInstancedANGLE","drawElementsInstanced","drawElementsInstancedANGLE","vertexAttribDivisor","vertexAttribDivisorANGLE","getShaderPrecisionFormat","vertexhighp","VERTEX_SHADER","HIGH_FLOAT","fragmenthighp","FRAGMENT_SHADER","precision","blendMinMaxExtension","MAX","MAX_EXT","MIN","MIN_EXT","sRGBExtension","SRGB","SRGB_EXT","SRGB8","SRGB_ALPHA_EXT","SRGB8_ALPHA8","forceSRGBBufferSupportState","LEQUAL","slot","getClassName","_prepareWorkingCanvas","_workingCanvas","_workingContext","getInfo","getGlInfo","vendor","renderer","version","getLoadedTexturesCache","getCaps","stopRenderLoop","renderFunction","_renderLoop","shouldRender","beginFrame","endFrame","_frameHandler","_boundRenderFunction","getHostWindow","getRenderingCanvas","getAudioContext","getAudioDestination","ownerDocument","defaultView","framebufferWidth","drawingBufferWidth","framebufferHeight","drawingBufferHeight","QueueNewFrame","runRenderLoop","useStencilGlobalOnly","stencilStateComposer","applyStates","clearColor","COLOR_BUFFER_BIT","GEQUAL","clearDepth","DEPTH_BUFFER_BIT","clearStencil","STENCIL_BUFFER_BIT","_viewport","flushFramebuffer","forceSetSize","devicePixelRatio_1","clientWidth","innerWidth","clientHeight","innerHeight","setSize","lodLevel","layer","webglRTWrapper","_MSAAFramebuffer","gl","framebufferTextureLayer","COLOR_ATTACHMENT0","framebufferTexture2D","TEXTURE_CUBE_MAP_POSITIVE_X","attachment","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","TEXTURE_2D","pow","cull","cullFace","BACK","FRONT","frontFace","CW","CCW","stencilMaterial","_currentFrameBufferIsDefaultFrameBuffer","generateMipmaps","generateMipmap","unBindMultiColorAttachmentFramebuffer","READ_FRAMEBUFFER","blitFramebuffer","NEAREST","flush","restoreDefaultFramebuffer","_resetVertexBufferBinding","bindArrayBuffer","_createVertexBuffer","STATIC_DRAW","usage","vbo","createBuffer","dataBuffer","bufferData","ARRAY_BUFFER","DYNAMIC_DRAW","_resetIndexBufferBinding","bindIndexBuffer","updatable","ELEMENT_ARRAY_BUFFER","Uint32Array","Uint16Array","_unbindVertexArrayObject","_bindBuffer","uniformLocation","getUniformBlockIndex","uniformBlockBinding","bindBuffer","updateArrayBuffer","bufferSubData","_vertexAttribPointer","indx","stride","pointer","active","vertexAttribPointer","_bindIndexBufferWithCache","_bindVertexBuffersAttributes","overrideVertexBuffers","unbindAllAttributes","order","ai","enableVertexAttribArray","getIsInstanced","vao","_cachedVertexArrayObject","bindBuffersDirectly","vertexDeclaration","vertexStrideSize","attributesCount","getAttributesCount","FLOAT","unbindInstanceAttributes","boundBuffer","ul","instancesBuffer","offsetLocation","_releaseBuffer","deleteBuffer","updateAndBindInstancesBuffer","offsetLocations","bindInstancesBuffer","attributesInfo","computeStride","attributeSize","getAttributeLocationByName","attributeName","attributeType","divisor","disableInstanceAttributeByName","attributeLocation","disableInstanceAttribute","shouldClean","disableAttributeByIndex","disableVertexAttribArray","drawPointClouds","drawUnIndexed","_reportDrawCall","drawMode","_drawMode","indexFormat","UNSIGNED_INT","UNSIGNED_SHORT","mult","drawElements","drawArrays","TRIANGLES","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLE_STRIP","TRIANGLE_FAN","_releaseEffect","_key","webGLPipelineContext","deleteProgram","_getGlobalDefines","s","createEffect","baseName","attributesNamesOrOptions","uniformsNamesOrEngine","fallbacks","indexParameters","vertex","vertexElement","vertexToken","vertexSource","fragment","fragmentElement","fragmentToken","fragmentSource","globalDefines","fullDefines","compiledEffect","_ConcatenateShader","shaderVersion","_compileShader","_compileRawShader","shader","createShader","NO_ERROR","tempError","isContextLost","shaderSource","compileShader","_getShaderSource","getShaderSource","vertexShader","fragmentShader","_createShaderProgram","shaderProcessingContext","isParallelCompiled","shaderProgram","attachShader","linkProgram","_finalizePipelineContext","getProgramParameter","LINK_STATUS","log","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexCompilationError","fragmentCompilationError","getProgramInfoLog","programLinkError","validateProgram","VALIDATE_STATUS","programValidationError","deleteShader","webGLRenderingState","COMPLETION_STATUS_KHR","oldHandler","results","getUniformLocation","getAttribLocation","uniform1i","uniform2i","uniform3i","uniform4i","uniform1iv","uniform2iv","uniform3iv","uniform4iv","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix4fv","uniformMatrix3fv","uniformMatrix2fv","uniform1f","uniform2f","uniform3f","uniform4f","colorMask","clearInternalTexturesCache","UNPACK_PREMULTIPLY_ALPHA_WEBGL","_getSamplingParameters","magFilter","minFilter","LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_LINEAR","NEAREST_MIPMAP_NEAREST","mag","_createHardwareTexture","_createInternalTexture","delayGPUTextureCreation","isWebGPU","filters","TEXTURE_2D_ARRAY","sizedFormat","_getRGBABufferInternalSizedFormat","_getInternalFormat","_getWebGLTextureType","texImage3D","texImage2D","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","_createTextureBase","prepareTexture","prepareTextureProcessFunction","fromBlob","_originalUrl","split","_TextureLoaders","onErrorObservable","callback_1","loadData","loadMipmap","isCompressed","done","loadFailed","offlineProvider","img","decoding","close","_FileToolsLoadImage","imageOrientation","_prepareWebGLTexture","potWidth","potHeight","continuationCallback","isPot","RGBA","RGB","texelFormat","UNSIGNED_BYTE","_supportsHardwareTextureRescaling","drawImage","source_1","_rescaleTexture","input","imageBitmapOptions","onComplete","UNPACK_FLIP_Y_WEBGL","UNPACK_ALIGNMENT","_getTextureTarget","TEXTURE_CUBE_MAP","TEXTURE_3D","isMultiview","_setTextureParameterInteger","updateTextureDimensions","updateTextureWrappingMode","_getTextureWrapMode","_cachedWrapU","_cachedWrapV","TEXTURE_WRAP_R","_cachedWrapR","_setupDepthStencilTexture","samplingParameters","TEXTURE_COMPARE_FUNC","TEXTURE_COMPARE_MODE","COMPARE_REF_TO_TEXTURE","compressedTexImage2D","babylonInternalFormat","useTextureWidthAndHeight","lodMaxWidth","round","LOG2E","lodMaxHeight","texSubImage2D","bindTarget","_prepareWebGLTextureContinuation","processFunction","needPOTTextures","GetExponentOfTwo","_setupFramebufferDepthAttachments","_createRenderBuffer","DEPTH_STENCIL","depthFormat","DEPTH_COMPONENT16","DEPTH_COMPONENT32F","STENCIL_INDEX8","STENCIL_ATTACHMENT","msInternalFormat","unbindBuffer","renderBuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","framebufferRenderbuffer","unbindAllTextures","_lodTextureHigh","_lodTextureMid","_lodTextureLow","_irradianceTexture","useProgram","_activateCurrentTexture","activeTexture","TEXTURE0","forTextureDataUpdate","wasPreviouslyBound","isTextureForRendering","_associatedChannel","bindTexture","_bindSamplerUniformToChannel","sourceSlot","_currentState","REPEAT","MIRRORED_REPEAT","needToBind","_cachedCoordinatesMode","coordinatesMode","textureWrapMode","_setAnisotropicLevel","setTextureArray","_textureUnits","Int32Array","anisotropicFilterExtension","_setTextureParameterFloat","TEXTURE_MAX_ANISOTROPY_EXT","parameter","texParameterf","deleteFramebuffer","releaseComputeEffects","removeEventListener","abort","attachContextLostEvent","callback","attachContextRestoredEvent","_canRenderToFramebuffer","successful","fb","createFramebuffer","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readFormat","readType","readPixels","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","INT","HALF_FLOAT","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_5_9_9_9_REV","FLOAT_32_UNSIGNED_INT_24_8_REV","ALPHA","LUMINANCE","LUMINANCE_ALPHA","RED","RG","RED_INTEGER","RG_INTEGER","RGB_INTEGER","RGBA_INTEGER","R8_SNORM","RG8_SNORM","RGB8_SNORM","R8I","RG8I","RGB8I","RGBA8I","RGBA8_SNORM","R8","RG8","RGB8","RGBA8","R8UI","RG8UI","RGB8UI","RGBA8UI","R16I","RG16I","RGB16I","RGBA16I","R16UI","RG16UI","RGB16UI","RGBA16UI","R32I","RG32I","RGB32I","RGBA32I","R32UI","RG32UI","RGB32UI","RGBA32UI","R32F","RG32F","RGB32F","R16F","RG16F","RGB16F","RGB565","R11F_G11F_B10F","RGB9_E5","RGBA4","RGB5_A1","RGB10_A2","RGB10_A2UI","_getRGBAMultiSampleBufferFormat","onProgress","useArrayBuffer","_FileToolsLoadFile","onCompleteObservable","hasAlpha","flushRenderer","numChannels","isSupported","_HasMajorPerformanceCaveat","_IsSupported","tempcanvas","WebGLRenderingContext","failIfMajorPerformanceCaveat","CeilingPOT","FloorPOT","NearestPOT","c","f","pot","requestPostAnimationFrame","msRequestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","CollisionsEpsilon","WebGPUEngine","_uploadEncoderDescriptor","_renderEncoderDescriptor","_renderTargetEncoderDescriptor","_clearDepthValue","_clearReverseDepthValue","_clearStencilValue","_defaultSampleCount","_glslang","_tintWASM","_compiledComputeEffects","_counters","numEnableEffects","numEnableDrawWrapper","numBundleCreationNonCompatMode","numBundleReuseNonCompatMode","countersLastFrame","numMaxUncapturedErrors","_commandBuffers","_currentRenderPass","_mainRenderPassWrapper","_rttRenderPassWrapper","_pendingDebugCommands","_onAfterUnbindFrameBufferObservable","_currentOverrideVertexBuffers","_currentIndexBuffer","_colorWriteLocal","_forceEnableEffect","dbgShowShaderCode","dbgSanityChecks","dbgVerboseLogsForFirstFrames","dbgVerboseLogsNumFrames","dbgLogIfNotDrawWrapper","dbgShowEmptyEnableEffectCalls","_viewportsCurrent","h","_scissorsCurrent","_scissorCached","_stencilRefsCurrent","_blendColorsCurrent","deviceDescriptor","swapChainFormat","antialiasing","enableGPUDebugMarkers","gpu","_deterministicLockstep","_lockstepMaxSteps","_timeStep","_canvas","_mainPassSampleCount","_shaderProcessorWGSL","_snapshotRendering","enabled","_cacheSampler","disabled","disable","_cacheRenderPipeline","_cacheBindGroups","requestAdapter","adapter","catch","_adapterSupportedExtensions","_deviceEnabledExtensions","_compatibilityMode","CreateAsync","initAsync","glslangOptions","twgslOptions","_initGlslang","glslang","UseTWGSL","initTwgsl","msg","_adapter","features","feature","requiredFeatures","validExtensions","requestedExtensions_1","requestDevice","device","_device","numUncapturedErrors","event","lost","_bufferManager","_textureHelper","W","_timestampQuery","_occlusionQuery","createQuerySet","_bundleList","_bundleListRenderTarget","_ubInvertY","_ubDontInvertY","_count","_uploadEncoder","createCommandEncoder","_renderEncoder","_renderTargetEncoder","_emptyVertexBuffer","_initializeLimits","setCommandEncoder","_clearQuad","_defaultDrawContext","_currentDrawContext","_defaultMaterialContext","_currentMaterialContext","_initializeContextAndSwapChain","_initializeMainAttachments","console","trace","_GLSLslangDefaultOptions","wasmPath","jsPath","importScripts","BigUint64Array","enabledExtensions","_context","_configureContext","_colorFormat","colorAttachmentGPUTextures","_mainTextureExtends","depthOrArrayLayers","mainColorAttachments","bufferDataUpdate","setSubData","mainTextureDescriptor","mipLevelCount","sampleCount","dimension","_mainTexture","destroy","view","createView","clearValue","loadOp","storeOp","isStencilEnable","_setDepthTextureFormat","depthTextureDescriptor","_depthTexture","mainDepthAttachment","depthClearValue","depthLoadOp","depthStoreOp","stencilClearValue","stencilLoadOp","stencilStoreOp","renderPassDescriptor","colorAttachments","depthStencilAttachment","renderPass","_endMainRenderPass","configure","compositingAlphaMode","setAlphaBlendEnabled","setBuffers","setAlphaBlendFactors","_blendFunctionParameters","_blendEquationParameters","setWriteMask","_resetCurrentViewport","_mustUpdateViewport","_applyViewport","floor","_resetCurrentScissor","_mustUpdateScissor","_applyScissor","setScissorRect","_scissorIsActive","enableScissor","disableScissor","_resetCurrentStencilRef","_mustUpdateStencilRef","funcRef","_applyStencilRef","setStencilReference","_resetCurrentColorBlend","_mustUpdateBlendColor","colorBlend","_blendConstants","_applyBlendColor","setBlendConstant","hasScissor","_startRenderTargetRenderPass","compatibilityMode","addItem","_clearFullQuad","_endRenderTargetRenderPass","_startMainRenderPass","_getCurrentRenderPass","bundleList","_getCurrentRenderPassIndex","setColorFormat","setDepthStencilFormat","_depthTextureFormat","setMRTAttachments","mrtAttachments","mrtTextureArray","mrtTextureCount","bundle","currentSampleCount","addBundle","_createBuffer","flags","releaseBuffer","_compileRawShaderToSpirV","compileGLSL","_compileShaderToSpirV","_getWGSLShader","join","_createPipelineStageDescriptor","convertSpirV2WGSL","vertexStage","module","createShaderModule","entryPoint","fragmentStage","_compileRawPipelineStageDescriptor","_compilePipelineStageDescriptor","webGpuContext","sources","rawVertex","rawFragment","stages","gpuPipelineContext","availableAttributes","isNewEffect","materialContext","drawContext","uniqueId","webGPUPipelineContext","releaseTexture","updateTextureComparisonFunction","createGPUTextureForInternalTexture","_generateMipmaps","gpuTextureWrapper","updateTexture","wrapWebGPUTexture","generateMipMapsForCubemap","additionalUsages","textureAdditionalUsages","release","_setInternalTexture","availableTexture","availableTextures","autoBindSampler","samplerName","setSampler","unused","toString","commandEncoder","gpuHardwareTexture","mipmapCount","generateCubeMipmaps","bitmap","ceil","gpuTexture","gpuTextureFormat","destroyDeferredTextures","destroyDeferredBuffers","list","name_2","reopenPass","currentRenderPassIsNULL","currentPasses","finish","queue","submit","startFrame","renderTargetWrapper","setClearStates","gpuDepthStencilWrapper","gpuDepthStencilTexture","gpuDepthStencilMSAATexture","msaaTexture","depthTextureView","depthAttachmentViewDescriptor","depthMSAATextureView","depthTextureHasStencil","setDepthFunctionToGreaterOrEqual","mustClearColor","mustClearDepth","mustClearStencil","_mrtAttachments","_defaultAttachments","mrtTexture","gpuMRTWrapper","gpuMRTTexture","viewDescriptor","colorAttachmentViewDescriptor","gpuMSAATexture","colorTextureView","colorMSAATextureView","resolveTarget","setMRT","gpuWrapper","_debugPushGroup","occlusionQuerySet","hasQueries","querySet","beginRenderPass","_debugFlushPendingCommands","endRenderTargetPass","run","end","_debugPopGroup","_swapChainTexture","getCurrentTexture","endMainRenderPass","play","_currentLayer","_setColorFormat","baseArrayLayer","baseMipLevel","arrayLayerCount","aspect","snapshotRenderingMode","saveCRT","wrapper","setDitheringState","setRasterizerState","_applyRenderPassChanges","mustUpdateViewport","mustUpdateScissor","mustUpdateStencilRef","mustUpdateBlendColor","_draw","drawType","start","count","webgpuPipelineContext","bindUniformBufferBase","uniformBuffer","isDirty","updateId","forceBindGroupCreation","fastBundle","renderPass2","record","indirectDrawBuffer","setIndirectData","getBundleEncoder","colorFormats","numDrawCalls","textureState","hasFloatTextures","bitVal","textureNames","textureName","pipeline","getRenderPipeline","bindGroups","getBindGroups","createRenderBundleEncoder","depthStencilFormat","setPipeline","setIndexBuffer","setVertexBuffer","_validOffsetRange","setBindGroup","nonCompatMode","drawIndexedIndirect","drawIndirect","drawIndexed","_mainTextureLastCopy"],"sourceRoot":""}