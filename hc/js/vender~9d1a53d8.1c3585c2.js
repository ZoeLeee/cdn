"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2429],{3582:(e,t,i)=>{i.d(t,{Z:()=>Ne});var n=i(23114),o=i(52351),r=i(66522),s=i(59015),a=i(93517),c=i(90868),h=i(66866),u=i(55077),d=i(6785),l=i(41631),p=i(51138),f=i(37337),m=i(88779),_=i(54485),g=i(90332),Z=i(20176),y=i(74834),w=i(78224),b=i(3169),v=i(22874),x=i(71118),S=i(16587),C=i(84929),T=i(91166),E=i(20291),I=i(44164),P=i(95411),O=i(74366),A=i(85834),L=i(83159),N=i(71087),D=i(36274),M=i(1577),R=i(59434),F=i(27400),B=i(29825),k=i(88573),H=i(74064),W=i(28696),U=i(47334),V=i(38268),z=i(28075),G=i(40543),j=i(73020),q=i(27401),Y=i(88463);function X(e){const t=(e=(0,m.Z)(e,m.Z.EMPTY_OBJECT)).context;if(!(0,_.Z)(t))throw new Z.Z("context is required.");if(!(0,_.Z)(e.lightCamera))throw new Z.Z("lightCamera is required.");if((0,_.Z)(e.numberOfCascades)&&1!==e.numberOfCascades&&4!==e.numberOfCascades)throw new Z.Z("Only one or four cascades are supported.");this._enabled=(0,m.Z)(e.enabled,!0),this._softShadows=(0,m.Z)(e.softShadows,!1),this._normalOffset=(0,m.Z)(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=(0,m.Z)(e.fromLightSource,!0),this.darkness=(0,m.Z)(e.darkness,.3),this._darkness=this.darkness,this.fadingEnabled=(0,m.Z)(e.fadingEnabled,!0),this.maximumDistance=(0,m.Z)(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;let i,n=!0;(y.Z.isInternetExplorer()||y.Z.isEdge()||(y.Z.isChrome()||y.Z.isFirefox())&&y.Z.isWindows()&&!t.depthTexture)&&(n=!1),this._polygonOffsetSupported=n,this._terrainBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new x.Z,this._shadowMapTexture=void 0,this._lightDirectionEC=new a.Z,this._lightPositionEC=new c.Z,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new de,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new o.Z,this._isPointLight=(0,m.Z)(e.isPointLight,!1),this._pointLightRadius=(0,m.Z)(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&(0,m.Z)(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?(0,m.Z)(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new s.Z,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new S.Z:(0,_.Z)(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new c.Z,new c.Z],this._cascadeMatrices=[new x.Z,new x.Z,new x.Z,new x.Z],this._cascadeDistances=new c.Z,i=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(i);for(let e=0;e<i;++e)this._passes[e]=new $(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Q(this),this._clearCommand=new O.Z({depth:1,color:new d.Z}),this._clearPassState=new R.Z(t),this._size=(0,m.Z)(e.size,2048),this.size=this._size}function $(e){this.camera=new de,this.passState=new R.Z(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function K(e,t){return H.Z.fromCache({cull:{enabled:!0,face:z.Z.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function Q(e){const t=!e._usesDepthTexture;e._primitiveRenderState=K(t,e._primitiveBias),e._terrainRenderState=K(t,e._terrainBias),e._pointRenderState=K(t,e._pointBias)}function J(e){const t=e._passes.length;for(let i=0;i<t;++i){const t=e._passes[i],n=t.framebuffer;(0,_.Z)(n)&&!n.isDestroyed()&&n.destroy(),t.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function ee(e,t){e._isPointLight?function(e,t){const i=new B.Z({context:t,width:e._textureSize.x,height:e._textureSize.y,format:k.Z.DEPTH_COMPONENT16}),n=new L.Z({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:T.Z.RGBA,pixelDatatype:F.Z.UNSIGNED_BYTE,sampler:W.Z.NEAREST}),o=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ];for(let n=0;n<6;++n){const r=new D.Z({context:t,depthRenderbuffer:i,colorTextures:[o[n]],destroyAttachments:!1}),s=e._passes[n];s.framebuffer=r,s.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t):e._usesDepthTexture?function(e,t){const i=new U.Z({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:T.Z.DEPTH_STENCIL,pixelDatatype:F.Z.UNSIGNED_INT_24_8,sampler:W.Z.NEAREST}),n=new D.Z({context:t,depthStencilTexture:i,destroyAttachments:!1}),o=e._passes.length;for(let t=0;t<o;++t){const i=e._passes[t];i.framebuffer=n,i.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=i}(e,t):function(e,t){const i=new B.Z({context:t,width:e._textureSize.x,height:e._textureSize.y,format:k.Z.DEPTH_COMPONENT16}),n=new U.Z({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:T.Z.RGBA,pixelDatatype:F.Z.UNSIGNED_BYTE,sampler:W.Z.NEAREST}),o=new D.Z({context:t,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),r=e._passes.length;for(let t=0;t<r;++t){const i=e._passes[t];i.framebuffer=o,i.passState.framebuffer=o}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t)}function te(e,t){(0,_.Z)(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(J(e),ee(e,t),function(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==P.Z.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,Q(e),J(e),ee(e,t))}(e,t),ie(e,t))}function ie(e,t,i){i=(0,m.Z)(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}X.MAXIMUM_DISTANCE=2e4,X.prototype.debugCreateRenderStates=function(){Q(this)},Object.defineProperties(X.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){!function(e,t){e._size=t;const i=e._passes,o=i.length,r=e._textureSize;if(e._isPointLight){t=A.Z.maximumCubeMapSize>=t?t:A.Z.maximumCubeMapSize,r.x=t,r.y=t;const e=new n.Z(0,0,t,t);i[0].passState.viewport=e,i[1].passState.viewport=e,i[2].passState.viewport=e,i[3].passState.viewport=e,i[4].passState.viewport=e,i[5].passState.viewport=e}else 1===o?(t=A.Z.maximumTextureSize>=t?t:A.Z.maximumTextureSize,r.x=t,r.y=t,i[0].passState.viewport=new n.Z(0,0,t,t)):4===o&&(t=A.Z.maximumTextureSize>=2*t?t:A.Z.maximumTextureSize/2,r.x=2*t,r.y=2*t,i[0].passState.viewport=new n.Z(0,0,t,t),i[1].passState.viewport=new n.Z(t,0,t,t),i[2].passState.viewport=new n.Z(0,t,t,t),i[3].passState.viewport=new n.Z(t,t,t,t));e._clearPassState.viewport=new n.Z(0,0,r.x,r.y);for(let e=0;e<o;++e){const t=i[e],n=t.passState.viewport,o=n.x/r.x,s=n.y/r.y,a=n.width/r.x,c=n.height/r.y;t.textureOffsets=new x.Z(a,0,0,o,0,c,0,s,0,0,1,0,0,0,0,1)}}(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});const ne=new n.Z;function oe(e,t){const i=t.context,o=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,s=.3*Math.min(o,r),a=ne;a.x=o-s,a.y=0,a.width=s,a.height=s;let c=e._debugShadowViewCommand;(0,_.Z)(c)||(c=function(e,t){let i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":`uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n${e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n"}    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n`;const n=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return n.pass=M.Z.OVERLAY,n}(e,i),e._debugShadowViewCommand=c),(0,_.Z)(c.renderState)&&n.Z.equals(c.renderState.viewport,a)||(c.renderState=H.Z.fromCache({viewport:n.Z.clone(a)})),t.commandList.push(e._debugShadowViewCommand)}const re=new Array(8);re[0]=new c.Z(-1,-1,-1,1),re[1]=new c.Z(1,-1,-1,1),re[2]=new c.Z(1,1,-1,1),re[3]=new c.Z(-1,1,-1,1),re[4]=new c.Z(-1,-1,1,1),re[5]=new c.Z(1,-1,1,1),re[6]=new c.Z(1,1,1,1),re[7]=new c.Z(-1,1,1,1);const se=new x.Z,ae=new Array(8);for(let e=0;e<8;++e)ae[e]=new c.Z;const ce=[d.Z.RED,d.Z.GREEN,d.Z.BLUE,d.Z.MAGENTA],he=new a.Z;function ue(e,t){oe(e,t);const i=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(i&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new G.Z({camera:e._sceneCamera,color:d.Z.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){i&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new G.Z({camera:e._shadowMapCamera,color:d.Z.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(let n=0;n<e._numberOfCascades;++n)i&&(e._debugCascadeFrustums[n]=e._debugCascadeFrustums[n]&&e._debugCascadeFrustums[n].destroy(),e._debugCascadeFrustums[n]=new G.Z({camera:e._passes[n].camera,color:ce[n],updateOnChange:!1})),e._debugCascadeFrustums[n].update(t)}}else if(e._isPointLight){if(!(0,_.Z)(e._debugLightFrustum)||e._needsUpdate){const t=e._shadowMapCamera.positionWC,i=E.Z.IDENTITY,n=2*e._pointLightRadius,o=a.Z.fromElements(n,n,n,he),s=x.Z.fromTranslationQuaternionRotationScale(t,i,o,se);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=function(e,t){const i=new w.Z({geometry:new r.Z({minimum:new a.Z(-.5,-.5,-.5),maximum:new a.Z(.5,.5,.5)}),attributes:{color:l.Z.fromColor(t)}}),n=new w.Z({geometry:new I.Z({radius:.5}),attributes:{color:l.Z.fromColor(t)}});return new q.Z({geometryInstances:[i,n],appearance:new j.Z({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}(s,d.Z.YELLOW)}e._debugLightFrustum.update(t)}else(0,_.Z)(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new G.Z({camera:e._shadowMapCamera,color:d.Z.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function de(){this.viewMatrix=new x.Z,this.inverseViewMatrix=new x.Z,this.frustum=void 0,this.positionCartographic=new h.Z,this.positionWC=new a.Z,this.directionWC=a.Z.clone(a.Z.UNIT_Z),this.upWC=a.Z.clone(a.Z.UNIT_Y),this.rightWC=a.Z.clone(a.Z.UNIT_X),this.viewProjectionMatrix=new x.Z}de.prototype.clone=function(e){x.Z.clone(e.viewMatrix,this.viewMatrix),x.Z.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),h.Z.clone(e.positionCartographic,this.positionCartographic),a.Z.clone(e.positionWC,this.positionWC),a.Z.clone(e.directionWC,this.directionWC),a.Z.clone(e.upWC,this.upWC),a.Z.clone(e.rightWC,this.rightWC)};const le=new x.Z(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);de.prototype.getViewProjection=function(){const e=this.viewMatrix,t=this.frustum.projectionMatrix;return x.Z.multiply(t,e,this.viewProjectionMatrix),x.Z.multiply(le,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};const pe=new Array(5),fe=new C.Z,me=new Array(4),_e=new a.Z,ge=new a.Z;const Ze=new x.Z,ye=new a.Z,we=new a.Z,be=new a.Z;const ve=[new a.Z(-1,0,0),new a.Z(0,-1,0),new a.Z(0,0,-1),new a.Z(1,0,0),new a.Z(0,1,0),new a.Z(0,0,1)],xe=[new a.Z(0,-1,0),new a.Z(0,0,-1),new a.Z(0,-1,0),new a.Z(0,-1,0),new a.Z(0,0,1),new a.Z(0,-1,0)],Se=[new a.Z(0,0,1),new a.Z(1,0,0),new a.Z(-1,0,0),new a.Z(0,0,-1),new a.Z(1,0,0),new a.Z(1,0,0)];const Ce=new a.Z,Te=new a.Z,Ee=new o.Z,Ie=Ee.center;function Pe(e,t){const i=t.camera,n=e._lightCamera,r=e._sceneCamera,s=e._shadowMapCamera;e._cascadesEnabled?a.Z.clone(n.directionWC,s.directionWC):e._isPointLight?a.Z.clone(n.positionWC,s.positionWC):s.clone(n);const c=e._lightDirectionEC;let h,u;x.Z.multiplyByPointAsVector(i.viewMatrix,s.directionWC,c),a.Z.normalize(c,c),a.Z.negate(c,c),x.Z.multiplyByPoint(i.viewMatrix,s.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(h=Math.min(t.shadowState.nearPlane,e.maximumDistance),u=Math.min(t.shadowState.farPlane,e.maximumDistance),u=Math.max(u,h+1)):(h=i.frustum.near,u=e.maximumDistance),e._sceneCamera=V.Z.clone(i,r),i.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=h,e._sceneCamera.frustum.far=u,e._distance=u-h,function(e,t){const i=e._sceneCamera,n=e._shadowMapCamera,r=Ee;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);const o=t.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,Ce),r=a.Z.negate(n.directionWC,Te),s=a.Z.dot(o,r);if(e.fadingEnabled){const t=v.Z.clamp(s/.1,0,1);e._darkness=v.Z.lerp(1,e.darkness,t)}else e._darkness=e.darkness;if(s<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)r.center=n.positionWC,r.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(r)===b.Z.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),o.Z.clone(r,e._boundingSphere);else{const i=n.frustum.far/2,s=a.Z.add(n.positionWC,a.Z.multiplyByScalar(n.directionWC,i,Ie),Ie);r.center=s,r.radius=i,e._outOfView=t.cullingVolume.computeVisibility(r)===b.Z.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),o.Z.clone(r,e._boundingSphere)}}(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}X.prototype.update=function(e){if(Pe(this,e),this._needsUpdate)if(te(this,e.context),this._isPointLight&&function(e,t){const i=new C.Z;i.fov=v.Z.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(let n=0;n<6;++n){const o=e._passes[n].camera;o.positionWC=e._shadowMapCamera.positionWC,o.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(o.positionWC,o.positionCartographic),o.directionWC=ve[n],o.upWC=xe[n],o.rightWC=Se[n],x.Z.computeView(o.positionWC,o.directionWC,o.upWC,o.rightWC,o.viewMatrix),x.Z.inverse(o.viewMatrix,o.inverseViewMatrix),o.frustum=i}}(this,e),this._cascadesEnabled&&(function(e,t){const i=e._shadowMapCamera,n=e._sceneCamera,o=x.Z.multiply(n.frustum.projectionMatrix,n.viewMatrix,se),r=x.Z.inverse(o,se),s=i.directionWC;let h=n.directionWC;a.Z.equalsEpsilon(s,h,v.Z.EPSILON10)&&(h=n.upWC);const u=a.Z.cross(s,h,ye);h=a.Z.cross(u,s,we),a.Z.normalize(h,h),a.Z.normalize(u,u);const d=a.Z.fromElements(0,0,0,be);let l=x.Z.computeView(d,s,h,u,Ze);const p=x.Z.multiply(l,r,se),f=a.Z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,_e),m=a.Z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,ge);for(let e=0;e<8;++e){const t=c.Z.clone(re[e],ae[e]);x.Z.multiplyByVector(p,t,t),a.Z.divideByScalar(t,t.w,t),a.Z.minimumByComponent(t,f,f),a.Z.maximumByComponent(t,m,m)}m.z+=1e3,f.z-=10;const _=be;_.x=-.5*(f.x+m.x),_.y=-.5*(f.y+m.y),_.z=-m.z;const g=x.Z.fromTranslation(_,se);l=x.Z.multiply(g,l,l);const Z=.5*(m.x-f.x),y=.5*(m.y-f.y),w=m.z-f.z,b=i.frustum;b.left=-Z,b.right=Z,b.bottom=-y,b.top=y,b.near=.01,b.far=w,x.Z.clone(l,i.viewMatrix),x.Z.inverse(l,i.inverseViewMatrix),x.Z.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),a.Z.clone(s,i.directionWC),a.Z.clone(h,i.upWC),a.Z.clone(u,i.rightWC)}(this,e),this._numberOfCascades>1&&function(e,t){const i=e._shadowMapCamera,n=e._sceneCamera,o=n.frustum.near,r=n.frustum.far,s=e._numberOfCascades;let h;const u=r-o,d=r/o;let l=.9,p=!1;t.shadowState.closestObjectSize<200&&(p=!0,l=.9);const f=me,m=pe;for(m[0]=o,m[s]=r,h=0;h<s;++h){const e=(h+1)/s,t=o*Math.pow(d,e),i=o+u*e,n=v.Z.lerp(i,t,l);m[h+1]=n,f[h]=n-m[h]}if(p){for(h=0;h<s;++h)f[h]=Math.min(f[h],e._maximumCascadeDistances[h]);let t=m[0];for(h=0;h<s-1;++h)t+=f[h],m[h+1]=t}c.Z.unpack(m,0,e._cascadeSplits[0]),c.Z.unpack(m,1,e._cascadeSplits[1]),c.Z.unpack(f,0,e._cascadeDistances);const _=i.frustum,g=_.left,Z=_.right,y=_.bottom,w=_.top,b=_.near,S=_.far,C=i.positionWC,T=i.directionWC,E=i.upWC,I=n.frustum.clone(fe),P=i.getViewProjection();for(h=0;h<s;++h){I.near=m[h],I.far=m[h+1];const t=x.Z.multiply(I.projectionMatrix,n.viewMatrix,se),o=x.Z.inverse(t,se),r=x.Z.multiply(P,o,se),s=a.Z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,_e),u=a.Z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,ge);for(let e=0;e<8;++e){const t=c.Z.clone(re[e],ae[e]);x.Z.multiplyByVector(r,t,t),a.Z.divideByScalar(t,t.w,t),a.Z.minimumByComponent(t,s,s),a.Z.maximumByComponent(t,u,u)}s.x=Math.max(s.x,0),s.y=Math.max(s.y,0),s.z=0,u.x=Math.min(u.x,1),u.y=Math.min(u.y,1),u.z=Math.min(u.z,1);const d=e._passes[h],l=d.camera;l.clone(i);const p=l.frustum;p.left=g+s.x*(Z-g),p.right=g+u.x*(Z-g),p.bottom=y+s.y*(w-y),p.top=y+u.y*(w-y),p.near=b+s.z*(S-b),p.far=b+u.z*(S-b),d.cullingVolume=l.frustum.computeCullingVolume(C,T,E);const f=e._cascadeMatrices[h];x.Z.multiply(l.getViewProjection(),n.inverseViewMatrix,f),x.Z.multiply(d.textureOffsets,f,f)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=f.Z.fromBoundingSphere(this._boundingSphere);else{const e=this._shadowMapCamera,t=e.positionWC,i=e.directionWC,n=e.upWC;this._shadowMapCullingVolume=e.frustum.computeCullingVolume(t,i,n),1===this._passes.length&&this._passes[0].camera.clone(e)}if(1===this._passes.length){const e=this._sceneCamera.inverseViewMatrix;x.Z.multiply(this._shadowMapCamera.getViewProjection(),e,this._shadowMapMatrix)}this.debugShow&&ue(this,e)},X.prototype.updatePass=function(e,t){ie(this,e,t)};const Oe=new s.Z;function Ae(e,t,i){const n=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,o={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){const t=Oe;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,c.Z.fromElements(t.x,t.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return c.Z.fromElements(n.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new c.Z,combinedUniforms2:new c.Z};return(0,p.Z)(t,o,!1)}function Le(e,t,i,n,o,r){let s,a,c;if((0,_.Z)(r)&&(s=r.shaderProgram,a=r.renderState,c=r.uniformMap),(r=N.Z.shallowClone(i,r)).castShadows=!0,r.receiveShadows=!1,!(0,_.Z)(s)||o!==i.shaderProgram.id||t){const t=i.shaderProgram,o=i.pass===M.Z.GLOBE,r=i.pass!==M.Z.TRANSLUCENT,h=e._isPointLight,d=e._usesDepthTexture,l=Y.Z.getShadowCastShaderKeyword(h,o,d,r);if(s=n.shaderCache.getDerivedShaderProgram(t,l),!(0,_.Z)(s)){const e=t.vertexShaderSource,i=t.fragmentShaderSource,a=Y.Z.createShadowCastVertexShader(e,h,o),c=Y.Z.createShadowCastFragmentShader(i,h,d,r);s=n.shaderCache.createDerivedShaderProgram(t,l,{vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:t._attributeLocations})}a=e._primitiveRenderState,h?a=e._pointRenderState:o&&(a=e._terrainRenderState);i.renderState.cull.enabled||(a=(0,u.Z)(a,!1),a.cull=(0,u.Z)(a.cull,!1),a.cull.enabled=!1,a=H.Z.fromCache(a)),c=Ae(e,i.uniformMap,o)}return r.shaderProgram=s,r.renderState=a,r.uniformMap=c,r}X.createReceiveDerivedCommand=function(e,t,i,n,o){(0,_.Z)(o)||(o={});const r=e.length>0,s=t.shaderProgram,a=s.vertexShaderSource,c=s.fragmentShaderSource,h=t.pass===M.Z.GLOBE;let u=!1;if(h&&(u=t.owner.data.renderedMesh.encoding.hasVertexNormals),t.receiveShadows&&r){let r,d;(0,_.Z)(o.receiveCommand)&&(r=o.receiveCommand.shaderProgram,d=o.receiveCommand.uniformMap),o.receiveCommand=N.Z.shallowClone(t,o.receiveCommand),o.castShadows=!1,o.receiveShadows=!0;const l=o.receiveShaderCastShadows!==t.castShadows,p=o.receiveShaderProgramId!==t.shaderProgram.id;if(!(0,_.Z)(r)||p||i||l){const i=Y.Z.getShadowReceiveShaderKeyword(e[0],t.castShadows,h,u);if(r=n.shaderCache.getDerivedShaderProgram(s,i),!(0,_.Z)(r)){const o=Y.Z.createShadowReceiveVertexShader(a,h,u),d=Y.Z.createShadowReceiveFragmentShader(c,e[0],t.castShadows,h,u);r=n.shaderCache.createDerivedShaderProgram(s,i,{vertexShaderSource:o,fragmentShaderSource:d,attributeLocations:s._attributeLocations})}d=Ae(e[0],t.uniformMap,h)}o.receiveCommand.shaderProgram=r,o.receiveCommand.uniformMap=d,o.receiveShaderProgramId=t.shaderProgram.id,o.receiveShaderCastShadows=t.castShadows}return o},X.createCastDerivedCommand=function(e,t,i,n,o){if((0,_.Z)(o)||(o={}),t.castShadows){let r=o.castCommands;(0,_.Z)(r)||(r=o.castCommands=[]);const s=o.castShaderProgramId,a=e.length;r.length=a;for(let o=0;o<a;++o)r[o]=Le(e[o],i,t,n,s,r[o]);o.castShaderProgramId=t.shaderProgram.id}return o},X.prototype.isDestroyed=function(){return!1},X.prototype.destroy=function(){J(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(let e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return(0,g.Z)(this)};const Ne=X},88463:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(54485),o=i(7048);function r(){}r.getShadowCastShaderKeyword=function(e,t,i,n){return`castShadow ${e} ${t} ${i} ${n}`},r.createShadowCastVertexShader=function(e,t,i){const r=e.defines.slice(0),s=e.sources.slice(0);r.push("SHADOW_MAP"),i&&r.push("GENERATE_POSITION");const a=o.Z.findPositionVarying(e),c=(0,n.Z)(a);if(t&&!c){const e=s.length;for(let t=0;t<e;++t)s[t]=o.Z.replaceMain(s[t],"czm_shadow_cast_main");const t="varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}";s.push(t)}return new o.Z({defines:r,sources:s})},r.createShadowCastFragmentShader=function(e,t,i,r){const s=e.defines.slice(0),a=e.sources.slice(0);s.push("SHADOW_MAP");let c=o.Z.findPositionVarying(e);const h=(0,n.Z)(c);h||(c="v_positionEC");const u=a.length;for(let e=0;e<u;++e)a[e]=o.Z.replaceMain(a[e],"czm_shadow_cast_main");let d="";return t&&(h||(d+="varying vec3 v_positionEC; \n"),d+="uniform vec4 shadowMap_lightPositionEC; \n"),d+=r?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",d+=t?`    float distance = length(${c}); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n`:i?"    gl_FragColor = vec4(1.0); \n":"    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",d+="} \n",a.push(d),new o.Z({defines:s,sources:a})},r.getShadowReceiveShaderKeyword=function(e,t,i,n){return`receiveShadow ${e._usesDepthTexture}${e._polygonOffsetSupported}${e._isPointLight}${e._isSpotLight}${e._numberOfCascades>1}${e.debugCascadeColors}${e.softShadows}${t}${i}${n}`},r.createShadowReceiveVertexShader=function(e,t,i){const n=e.defines.slice(0),r=e.sources.slice(0);return n.push("SHADOW_MAP"),t&&(i?n.push("GENERATE_POSITION_AND_NORMAL"):n.push("GENERATE_POSITION")),new o.Z({defines:n,sources:r})},r.createShadowReceiveFragmentShader=function(e,t,i,r,s){const a=o.Z.findNormalVarying(e),c=!r&&(0,n.Z)(a)||r&&s,h=o.Z.findPositionVarying(e),u=(0,n.Z)(h),d=t._usesDepthTexture,l=t._polygonOffsetSupported,p=t._isPointLight,f=t._isSpotLight,m=t._numberOfCascades>1,_=t.debugCascadeColors,g=t.softShadows,Z=p?t._pointBias:r?t._terrainBias:t._primitiveBias,y=e.defines.slice(0),w=e.sources.slice(0),b=w.length;for(let e=0;e<b;++e)w[e]=o.Z.replaceMain(w[e],"czm_shadow_receive_main");p?y.push("USE_CUBE_MAP_SHADOW"):d&&y.push("USE_SHADOW_DEPTH_TEXTURE"),g&&!p&&y.push("USE_SOFT_SHADOWS"),m&&i&&r&&(c?y.push("ENABLE_VERTEX_LIGHTING"):y.push("ENABLE_DAYNIGHT_SHADING")),i&&Z.normalShading&&c&&(y.push("USE_NORMAL_SHADING"),Z.normalShadingSmooth>0&&y.push("USE_NORMAL_SHADING_SMOOTH"));let v,x="";return x+=p?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",v=u?`    return vec4(${h}, 1.0); \n`:"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n",x+=`uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n${v}} \nvec3 getNormalEC() \n{ \n${c?`    return normalize(${a}); \n`:"    return vec3(1.0); \n"}} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n${Z.normalOffset&&c?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":""}} \n`,x+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",x+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",r?x+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":l||(x+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),x+=p?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":f?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":m?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(_?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",x+="    gl_FragColor.rgb *= visibility; \n} \n",w.push(x),new o.Z({defines:y,sources:w})};const s=r},49616:(e,t,i)=>{i.d(t,{Z:()=>o});const n={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4,castShadows:function(e){return e===n.ENABLED||e===n.CAST_ONLY},receiveShadows:function(e){return e===n.ENABLED||e===n.RECEIVE_ONLY},fromCastReceive:function(e,t){return e&&t?n.ENABLED:e?n.CAST_ONLY:t?n.RECEIVE_ONLY:n.DISABLED}},o=Object.freeze(n)},342:(e,t,i)=>{i.d(t,{Z:()=>G});var n=i(59015),o=i(93517),r=i(66866),s=i(17497),a=i(44990),c=i(88779),h=i(54485),u=i(88173),d=i(11188),l=i(22874),p=i(71118),f=i(34152),m=i(7004),_=i(7048),g=i(73020),Z=i(20519);function y(e,t,i){s.Z.typeOf.bool("extentsCulling",e),s.Z.typeOf.bool("planarExtents",t),s.Z.typeOf.object("appearance",i),this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};const n=new S;n.requiresTextureCoordinates=e,n.requiresEC=!i.flat;const o=new S;if(o.requiresTextureCoordinates=e,i instanceof g.Z)n.requiresNormalEC=!i.flat;else{const e=`${i.material.shaderSource}\n${i.fragmentShaderSource}`;n.normalEC=-1!==e.indexOf("materialInput.normalEC")||-1!==e.indexOf("czm_getDefaultMaterial"),n.positionToEyeEC=-1!==e.indexOf("materialInput.positionToEyeEC"),n.tangentToEyeMatrix=-1!==e.indexOf("materialInput.tangentToEyeMatrix"),n.st=-1!==e.indexOf("materialInput.st")}this._colorShaderDependencies=n,this._pickShaderDependencies=o,this._appearance=i,this._extentsCulling=e,this._planarExtents=t}y.prototype.createFragmentShader=function(e){s.Z.typeOf.bool("columbusView2D",e);const t=this._appearance,i=this._colorShaderDependencies,n=[];e||this._planarExtents||n.push("SPHERICAL"),i.requiresEC&&n.push("REQUIRES_EC"),i.requiresWC&&n.push("REQUIRES_WC"),i.requiresTextureCoordinates&&n.push("TEXTURE_COORDINATES"),this._extentsCulling&&n.push("CULL_FRAGMENTS"),i.requiresNormalEC&&n.push("NORMAL_EC"),t instanceof g.Z&&n.push("PER_INSTANCE_COLOR"),i.normalEC&&n.push("USES_NORMAL_EC"),i.positionToEyeEC&&n.push("USES_POSITION_TO_EYE_EC"),i.tangentToEyeMatrix&&n.push("USES_TANGENT_TO_EYE"),i.st&&n.push("USES_ST"),t.flat&&n.push("FLAT");let o="";return t instanceof g.Z||(o=t.material.shaderSource),new _.Z({defines:n,sources:[o,Z.Z]})},y.prototype.createPickFragmentShader=function(e){s.Z.typeOf.bool("columbusView2D",e);const t=this._pickShaderDependencies,i=["PICK"];return e||this._planarExtents||i.push("SPHERICAL"),t.requiresEC&&i.push("REQUIRES_EC"),t.requiresWC&&i.push("REQUIRES_WC"),t.requiresTextureCoordinates&&i.push("TEXTURE_COORDINATES"),this._extentsCulling&&i.push("CULL_FRAGMENTS"),new _.Z({defines:i,sources:[Z.Z],pickColorQualifier:"varying"})},y.prototype.createVertexShader=function(e,t,i,n){return s.Z.defined("defines",e),s.Z.typeOf.string("vertexShaderSource",t),s.Z.typeOf.bool("columbusView2D",i),s.Z.defined("mapProjection",n),x(this._colorShaderDependencies,this._planarExtents,i,e,t,this._appearance,n,this._projectionExtentDefines)},y.prototype.createPickVertexShader=function(e,t,i,n){return s.Z.defined("defines",e),s.Z.typeOf.string("vertexShaderSource",t),s.Z.typeOf.bool("columbusView2D",i),s.Z.defined("mapProjection",n),x(this._pickShaderDependencies,this._planarExtents,i,e,t,void 0,n,this._projectionExtentDefines)};const w=new o.Z,b=new r.Z,v={high:0,low:0};function x(e,t,i,n,o,r,s,a){const c=n.slice();if(""===a.eastMostYhighDefine){const e=b;e.longitude=l.Z.PI,e.latitude=0,e.height=0;const t=s.project(e,w);let i=u.Z.encode(t.x,v);a.eastMostYhighDefine=`EAST_MOST_X_HIGH ${i.high.toFixed(`${i.high}`.length+1)}`,a.eastMostYlowDefine=`EAST_MOST_X_LOW ${i.low.toFixed(`${i.low}`.length+1)}`;const n=b;n.longitude=-l.Z.PI,n.latitude=0,n.height=0;const o=s.project(n,w);i=u.Z.encode(o.x,v),a.westMostYhighDefine=`WEST_MOST_X_HIGH ${i.high.toFixed(`${i.high}`.length+1)}`,a.westMostYlowDefine=`WEST_MOST_X_LOW ${i.low.toFixed(`${i.low}`.length+1)}`}return i&&(c.push(a.eastMostYhighDefine),c.push(a.eastMostYlowDefine),c.push(a.westMostYhighDefine),c.push(a.westMostYlowDefine)),(0,h.Z)(r)&&r instanceof g.Z&&c.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(c.push("TEXTURE_COORDINATES"),t||i||c.push("SPHERICAL"),i&&c.push("COLUMBUS_VIEW_2D")),new _.Z({defines:c,sources:[o]})}function S(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}function C(e,t,i){return Math.abs((t.y-e.y)*i.x-(t.x-e.x)*i.y+t.x*e.y-t.y*e.x)/n.Z.distance(t,e)}Object.defineProperties(S.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});const T=[new n.Z,new n.Z,new n.Z,new n.Z];function E(e,t){const i=T,o=n.Z.unpack(t,0,i[0]),r=n.Z.unpack(t,2,i[1]),s=n.Z.unpack(t,4,i[2]);e.uMaxVmax=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,s.x,s.y]});const c=1/C(o,r,s),h=1/C(o,s,r);e.uvMinAndExtents=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:4,normalize:!1,value:[o.x,o.y,c,h]})}const I=new r.Z,P=new o.Z,O=new o.Z,A=new o.Z,L={high:0,low:0};function N(e,t,i){const n=I;n.height=0,n.longitude=e.west,n.latitude=e.south;const o=t.project(n,P);n.latitude=e.north;const r=t.project(n,O);n.longitude=e.east,n.latitude=e.south;const s=t.project(n,A),c=[0,0,0,0],h=[0,0,0,0];let l=u.Z.encode(o.x,L);c[0]=l.high,h[0]=l.low,l=u.Z.encode(o.y,L),c[1]=l.high,h[1]=l.low,l=u.Z.encode(r.y,L),c[2]=l.high,h[2]=l.low,l=u.Z.encode(s.x,L),c[3]=l.high,h[3]=l.low,i.planes2D_HIGH=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:4,normalize:!1,value:c}),i.planes2D_LOW=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:4,normalize:!1,value:h})}const D=new p.Z,M=new p.Z,R=new o.Z,F=new r.Z,B=[new r.Z,new r.Z,new r.Z,new r.Z,new r.Z,new r.Z,new r.Z,new r.Z];const k=new o.Z,H=new o.Z,W=new u.Z;y.getPlanarTextureCoordinateAttributes=function(e,t,i,n,h){s.Z.typeOf.object("boundingRectangle",e),s.Z.defined("textureCoordinateRotationPoints",t),s.Z.typeOf.object("ellipsoid",i),s.Z.typeOf.object("projection",n);const l=P,_=k,g=H;!function(e,t,i,n,s,a){const c=f.Z.center(e,F);c.height=i;const h=r.Z.toCartesian(c,t,R),u=m.Z.eastNorthUpToFixedFrame(h,t,D),d=p.Z.inverse(u,M),l=e.west,_=e.east,g=e.north,Z=e.south,y=B;y[0].latitude=Z,y[0].longitude=l,y[1].latitude=g,y[1].longitude=l,y[2].latitude=g,y[2].longitude=_,y[3].latitude=Z,y[3].longitude=_;const w=.5*(l+_),b=.5*(g+Z);y[4].latitude=Z,y[4].longitude=w,y[5].latitude=g,y[5].longitude=w,y[6].latitude=b,y[6].longitude=l,y[7].latitude=b,y[7].longitude=_;let v=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY;for(let e=0;e<8;e++){y[e].height=i;const n=r.Z.toCartesian(y[e],t,R);p.Z.multiplyByPoint(d,n,n),n.z=0,v=Math.min(v,n.x),x=Math.max(x,n.x),S=Math.min(S,n.y),C=Math.max(C,n.y)}const T=n;T.x=v,T.y=S,T.z=0,p.Z.multiplyByPoint(u,T,T);const E=s;E.x=x,E.y=S,E.z=0,p.Z.multiplyByPoint(u,E,E),o.Z.subtract(E,T,s);const I=a;I.x=v,I.y=C,I.z=0,p.Z.multiplyByPoint(u,I,I),o.Z.subtract(I,T,a)}(e,i,(0,c.Z)(h,0),l,_,g);const Z={};E(Z,t);const y=u.Z.fromCartesian(l,W);return Z.southWest_HIGH=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:3,normalize:!1,value:o.Z.pack(y.high,[0,0,0])}),Z.southWest_LOW=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:3,normalize:!1,value:o.Z.pack(y.low,[0,0,0])}),Z.eastward=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:3,normalize:!1,value:o.Z.pack(_,[0,0,0])}),Z.northward=new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:3,normalize:!1,value:o.Z.pack(g,[0,0,0])}),N(e,n,Z),Z};const U=new o.Z;function V(e,t,i,n){const o=I;o.latitude=e,o.longitude=t,o.height=0;const s=r.Z.toCartesian(o,i,U),a=Math.sqrt(s.x*s.x+s.y*s.y),c=l.Z.fastApproximateAtan2(a,s.z),h=l.Z.fastApproximateAtan2(s.x,s.y);return n.x=c,n.y=h,n}const z=new n.Z;y.getSphericalExtentGeometryInstanceAttributes=function(e,t,i,n){s.Z.typeOf.object("boundingRectangle",e),s.Z.defined("textureCoordinateRotationPoints",t),s.Z.typeOf.object("ellipsoid",i),s.Z.typeOf.object("projection",n);const o=V(e.south,e.west,i,z);let r=o.x,c=o.y;const h=V(e.north,e.east,i,z);let u=h.x,p=h.y,f=0;c>p&&(f=l.Z.PI-c,c=-l.Z.PI,p+=f),r-=l.Z.EPSILON5,c-=l.Z.EPSILON5,u+=l.Z.EPSILON5,p+=l.Z.EPSILON5;const m=1/(p-c),_=1/(u-r),g={sphericalExtents:new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r,c,_,m]}),longitudeRotation:new d.Z({componentDatatype:a.Z.FLOAT,componentsPerAttribute:1,normalize:!1,value:[f]})};return E(g,t),N(e,n,g),g},y.hasAttributesForTextureCoordinatePlanes=function(e){return(0,h.Z)(e.southWest_HIGH)&&(0,h.Z)(e.southWest_LOW)&&(0,h.Z)(e.northward)&&(0,h.Z)(e.eastward)&&(0,h.Z)(e.planes2D_HIGH)&&(0,h.Z)(e.planes2D_LOW)&&(0,h.Z)(e.uMaxVmax)&&(0,h.Z)(e.uvMinAndExtents)},y.hasAttributesForSphericalExtents=function(e){return(0,h.Z)(e.sphericalExtents)&&(0,h.Z)(e.longitudeRotation)&&(0,h.Z)(e.planes2D_HIGH)&&(0,h.Z)(e.planes2D_LOW)&&(0,h.Z)(e.uMaxVmax)&&(0,h.Z)(e.uvMinAndExtents)},y.shouldUseSphericalCoordinates=function(e){return s.Z.typeOf.object("rectangle",e),function(e){return Math.max(e.width,e.height)>y.MAX_WIDTH_FOR_PLANAR_EXTENTS}(e)},y.MAX_WIDTH_FOR_PLANAR_EXTENTS=l.Z.toRadians(1);const G=y},6956:(e,t,i)=>{i.d(t,{Z:()=>_});var n=i(78505),o=i(88779),r=i(58587),s=i(54485),a=i(20176),c=i(92893),h=i(96507),u=i(34152),d=i(67197),l=i(21514),p=i(85002),f=i(20709);function m(e){if(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),!(0,s.Z)(e.url))throw new a.Z("options.url is required.");this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;const t=d.Z.createIfNeeded(e.url),i=(0,o.Z)(e.rectangle,u.Z.MAX_VALUE),m=new h.Z({rectangle:i,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=m,this._resource=t,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new c.Z,this._ready=!1,this._readyPromise=(0,r.Z)();let _=e.credit;"string"==typeof _&&(_=new n.Z(_)),this._credit=_;const g=this;let Z;function y(e){g._image=e,g._tileWidth=e.width,g._tileHeight=e.height,g._ready=!0,g._readyPromise.resolve(!0),p.Z.handleSuccess(g._errorEvent)}function w(e){const i=`Failed to load image ${t.url}.`;Z=p.Z.handleError(Z,g,g._errorEvent,i,0,0,0,b,e),Z.retry||g._readyPromise.reject(new l.Z(i))}function b(){f.Z.loadImage(null,t).then(y).catch(w)}b()}Object.defineProperties(m.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this._ready)throw new a.Z("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new a.Z("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new a.Z("maximumLevel must not be called before the imagery provider is ready.");return 0}},minimumLevel:{get:function(){if(!this._ready)throw new a.Z("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new a.Z("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new a.Z("tileDiscardPolicy must not be called before the imagery provider is ready.")}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),m.prototype.getTileCredits=function(e,t,i){},m.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new a.Z("requestImage must not be called before the imagery provider is ready.");if((0,s.Z)(this._image))return Promise.resolve(this._image)},m.prototype.pickFeatures=function(e,t,i,n,o){};const _=m},30180:(e,t,i)=>{i.d(t,{Z:()=>P});var n=i(93517),o=i(88779),r=i(54485),s=i(90332),a=i(99996),c=i(31161),h=i(45050),u=i(22874),d=i(71118),l=i(25225),p=i(36627),f=i(71087),m=i(74064),_=i(17426),g=i(7048),Z=i(46801),y=i(70444),w=i(97409),b=i(57847),v=i(97854),x=i(81737),S=i(995),C=i(28075),T=i(18061);function E(e){e=(0,o.Z)(e,a.Z.WGS84),this.show=!0,this.perFragmentAtmosphere=!1,this._ellipsoid=e;const t=n.Z.multiplyByScalar(e.radii,1.025,new n.Z);this._scaleMatrix=d.Z.fromScale(t),this._modelMatrix=new d.Z,this._command=new f.Z({owner:this,modelMatrix:this._modelMatrix}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._flags=void 0,this.atmosphereLightIntensity=50,this.atmosphereRayleighCoefficient=new n.Z(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new n.Z(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new n.Z;const i=new n.Z;i.x=1.025*e.maximumRadius,i.y=e.maximumRadius,i.z=0,this._radiiAndDynamicAtmosphereColor=i;const r=this;this._command.uniformMap={u_radiiAndDynamicAtmosphereColor:function(){return r._radiiAndDynamicAtmosphereColor},u_hsbShift:function(){return r._hueSaturationBrightness.x=r.hueShift,r._hueSaturationBrightness.y=r.saturationShift,r._hueSaturationBrightness.z=r.brightnessShift,r._hueSaturationBrightness},u_atmosphereLightIntensity:function(){return r.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return r.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return r.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return r.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return r.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return r.atmosphereMieAnisotropy}}}Object.defineProperties(E.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),E.prototype.setDynamicAtmosphereColor=function(e,t){const i=e?t?2:1:0;this._radiiAndDynamicAtmosphereColor.z=i};const I=new d.Z;E.prototype.update=function(e,t){if(!this.show)return;const i=e.mode;if(i!==T.Z.SCENE3D&&i!==T.Z.MORPHING)return;if(!e.passes.render)return;const o=d.Z.fromRotationTranslation(e.context.uniformState.inverseViewRotation,n.Z.ZERO,I),s=d.Z.multiplyTransformation(o,x.Z.Y_UP_TO_Z_UP,I),a=d.Z.multiply(this._scaleMatrix,s,I);d.Z.clone(a,this._modelMatrix);const f=e.context,E=(P=this,!(u.Z.equalsEpsilon(P.hueShift,0,u.Z.EPSILON7)&&u.Z.equalsEpsilon(P.saturationShift,0,u.Z.EPSILON7)&&u.Z.equalsEpsilon(P.brightnessShift,0,u.Z.EPSILON7)));var P;const O=e.globeTranslucencyState.translucent,A=this.perFragmentAtmosphere||O||!(0,r.Z)(t)||!t.show,L=this._command;if(!(0,r.Z)(L.vertexArray)){const e=c.Z.createGeometry(new c.Z({radii:new n.Z(1,1,1),slicePartitions:256,stackPartitions:256,vertexFormat:l.Z.POSITION_ONLY}));L.vertexArray=Z.Z.fromGeometry({context:f,geometry:e,attributeLocations:h.Z.createAttributeLocations(e),bufferUsage:p.Z.STATIC_DRAW}),L.renderState=m.Z.fromCache({cull:{enabled:!0,face:C.Z.FRONT},blending:S.Z.ALPHA_BLEND,depthMask:!1})}const N=E|A<<2|O<<3;if(N!==this._flags){this._flags=N;const e=[];E&&e.push("COLOR_CORRECT"),A&&e.push("PER_FRAGMENT_ATMOSPHERE"),O&&e.push("GLOBE_TRANSLUCENT");const t=new g.Z({defines:e,sources:[y.Z,w.Z,v.Z]}),i=new g.Z({defines:e,sources:[y.Z,w.Z,b.Z]});this._spSkyAtmosphere=_.Z.fromCache({context:f,vertexShaderSource:t,fragmentShaderSource:i}),L.shaderProgram=this._spSkyAtmosphere}return L},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyAtmosphere=this._spSkyAtmosphere&&this._spSkyAtmosphere.destroy(),(0,s.Z)(this)};const P=E},89508:(e,t,i)=>{i.d(t,{Z:()=>C});var n=i(33365),o=i(93517),r=i(88779),s=i(54485),a=i(90332),c=i(20176),h=i(45050),u=i(71118),d=i(25225),l=i(36627),p=i(83159),f=i(71087),m=i(3492),_=i(74064),g=i(17426),Z=i(7048),y=i(46801),w=i(46047),b=i(46014),v=i(995),x=i(18061);function S(e){this.sources=e.sources,this._sources=void 0,this.show=(0,r.Z)(e.show,!0),this._command=new f.Z({modelMatrix:u.Z.clone(u.Z.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}S.prototype.update=function(e,t){const i=this;if(!this.show)return;if(e.mode!==x.Z.SCENE3D&&e.mode!==x.Z.MORPHING)return;if(!e.passes.render)return;const r=e.context;if(this._sources!==this.sources){this._sources=this.sources;const e=this.sources;if(!((0,s.Z)(e.positiveX)&&(0,s.Z)(e.negativeX)&&(0,s.Z)(e.positiveY)&&(0,s.Z)(e.negativeY)&&(0,s.Z)(e.positiveZ)&&(0,s.Z)(e.negativeZ)))throw new c.Z("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof e.positiveX!=typeof e.negativeX||typeof e.positiveX!=typeof e.positiveY||typeof e.positiveX!=typeof e.negativeY||typeof e.positiveX!=typeof e.positiveZ||typeof e.positiveX!=typeof e.negativeZ)throw new c.Z("this.sources properties must all be the same type.");"string"==typeof e.positiveX?(0,m.Z)(r,this._sources).then((function(e){i._cubeMap=i._cubeMap&&i._cubeMap.destroy(),i._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new p.Z({context:r,source:e}))}const a=this._command;if(!(0,s.Z)(a.vertexArray)){a.uniformMap={u_cubeMap:function(){return i._cubeMap}};const e=n.Z.createGeometry(n.Z.fromDimensions({dimensions:new o.Z(2,2,2),vertexFormat:d.Z.POSITION_ONLY})),t=this._attributeLocations=h.Z.createAttributeLocations(e);a.vertexArray=y.Z.fromGeometry({context:r,geometry:e,attributeLocations:t,bufferUsage:l.Z.STATIC_DRAW}),a.renderState=_.Z.fromCache({blending:v.Z.ALPHA_BLEND})}if(!(0,s.Z)(a.shaderProgram)||this._useHdr!==t){const e=new Z.Z({defines:[t?"HDR":""],sources:[w.Z]});a.shaderProgram=g.Z.fromCache({context:r,vertexShaderSource:b.Z,fragmentShaderSource:e,attributeLocations:this._attributeLocations}),this._useHdr=t}return(0,s.Z)(this._cubeMap)?a:void 0},S.prototype.isDestroyed=function(){return!1},S.prototype.destroy=function(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),(0,a.Z)(this)};const C=S},53799:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(93517),o=i(17497),r=i(88779),s=i(22874);function a(e){e=(0,r.Z)(e,1),o.Z.typeOf.number.greaterThan("radius",e,0),this._radius=(0,r.Z)(e,1)}Object.defineProperties(a.prototype,{radius:{get:function(){return this._radius},set:function(e){o.Z.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),a.prototype.emit=function(e){const t=s.Z.randomBetween(0,s.Z.TWO_PI),i=s.Z.randomBetween(0,s.Z.PI),o=s.Z.randomBetween(0,this._radius),r=o*Math.cos(t)*Math.sin(i),a=o*Math.sin(t)*Math.sin(i),c=o*Math.cos(i);e.position=n.Z.fromElements(r,a,c,e.position),e.velocity=n.Z.normalize(e.position,e.velocity)};const c=a},77493:(e,t,i)=>{i.d(t,{Z:()=>n});const n=Object.freeze({LEFT:-1,NONE:0,RIGHT:1})},52561:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(7048);const o={modifyFragmentShader:function(e){return e=n.Z.replaceMain(e,"czm_splitter_main"),e+="uniform float czm_splitDirection; \nvoid main() \n{ \n#ifndef SHADOW_MAP\n    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; \n    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; \n#endif\n    czm_splitter_main(); \n} \n"},addUniforms:function(e,t){t.czm_splitDirection=function(){return e.splitDirection}}}},84067:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(88307),o=i(59215);const r={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15,setCesium3DTileBit:function(){return{enabled:!0,frontFunction:n.Z.ALWAYS,frontOperation:{fail:o.Z.KEEP,zFail:o.Z.KEEP,zPass:o.Z.REPLACE},backFunction:n.Z.ALWAYS,backOperation:{fail:o.Z.KEEP,zFail:o.Z.KEEP,zPass:o.Z.REPLACE},reference:r.CESIUM_3D_TILE_MASK,mask:r.CESIUM_3D_TILE_MASK}}},s=Object.freeze(r)},88307:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(95411);const o={NEVER:n.Z.NEVER,LESS:n.Z.LESS,EQUAL:n.Z.EQUAL,LESS_OR_EQUAL:n.Z.LEQUAL,GREATER:n.Z.GREATER,NOT_EQUAL:n.Z.NOTEQUAL,GREATER_OR_EQUAL:n.Z.GEQUAL,ALWAYS:n.Z.ALWAYS},r=Object.freeze(o)},59215:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(95411);const o={ZERO:n.Z.ZERO,KEEP:n.Z.KEEP,REPLACE:n.Z.REPLACE,INCREMENT:n.Z.INCR,DECREMENT:n.Z.DECR,INVERT:n.Z.INVERT,INCREMENT_WRAP:n.Z.INCR_WRAP,DECREMENT_WRAP:n.Z.DECR_WRAP},r=Object.freeze(o)},2087:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(17497),o=i(88779),r=i(54485);function s(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),n.Z.typeOf.object("options.schema",e.schema),this._schema=e.schema;const t=e.propertyTables;this._propertyTableCount=(0,r.Z)(t)?t.length:0,this._propertyTables=t,this._propertyTextures=e.propertyTextures,this._propertyAttributes=e.propertyAttributes,this._statistics=e.statistics,this._extras=e.extras,this._extensions=e.extensions}Object.defineProperties(s.prototype,{schema:{get:function(){return this._schema}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},propertyTableCount:{get:function(){return this._propertyTableCount}},propertyTables:{get:function(){return this._propertyTables}},propertyTextures:{get:function(){return this._propertyTextures}},propertyAttributes:{get:function(){return this._propertyAttributes}}}),s.prototype.getPropertyTable=function(e){return n.Z.typeOf.number("propertyTableId",e),this._propertyTables[e]},s.prototype.getPropertyTexture=function(e){return n.Z.typeOf.number("propertyTextureId",e),this._propertyTextures[e]},s.prototype.getPropertyAttribute=function(e){return n.Z.typeOf.number("propertyAttributeId",e),this._propertyAttributes[e]};const a=s},61042:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(20176);function o(){}o.prototype.evaluate=function(e,t){n.Z.throwInstantiationError()},o.prototype.evaluateColor=function(e,t){n.Z.throwInstantiationError()},o.prototype.getShaderFunction=function(e,t,i,o){n.Z.throwInstantiationError()},o.prototype.getVariables=function(){n.Z.throwInstantiationError()};const r=o},21676:(e,t,i)=>{i.d(t,{Z:()=>M});var n=i(52351),o=i(59015),r=i(93517),s=i(90868),a=i(44990),c=i(54485),h=i(90332),u=i(39172),d=i(22874),l=i(71118),p=i(91166),f=i(84473),m=i(31328),_=i(36627),g=i(2099),Z=i(71087),y=i(27400),w=i(74064),b=i(17426),v=i(47334),x=i(46801),S=i(29799),C=i(5058),T=i(19219),E=i(995),I=i(18061),P=i(53640);function O(){this.show=!0,this._drawCommand=new Z.Z({primitiveType:f.Z.TRIANGLES,boundingVolume:new n.Z,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new n.Z,this._boundingVolume2D=new n.Z,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;const e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object.defineProperties(O.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});const A=new o.Z,L=new o.Z,N=new s.Z,D=new s.Z;O.prototype.update=function(e,t,i){if(!this.show)return;const s=e.mode;if(s===I.Z.SCENE2D||s===I.Z.MORPHING)return;if(!e.passes.render)return;const h=e.context,f=t.viewport.width,Z=t.viewport.height;if(!(0,c.Z)(this._texture)||f!==this._drawingBufferWidth||Z!==this._drawingBufferHeight||this._glowFactorDirty||i!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=f,this._drawingBufferHeight=Z,this._glowFactorDirty=!1,this._useHdr=i;let e=Math.max(f,Z);e=Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))-2),e=Math.max(1,e);const t=i?h.halfFloatingPointTexture?y.Z.HALF_FLOAT:y.Z.FLOAT:y.Z.UNSIGNED_BYTE;this._texture=new v.Z({context:h,width:e,height:e,pixelFormat:p.Z.RGBA,pixelDatatype:t}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;const n=this,o={u_radiusTS:function(){return n._radiusTS}};this._commands.computeCommand=new g.Z({fragmentShaderSource:C.Z,outputTexture:this._texture,uniformMap:o,persists:!1,owner:this,postExecute:function(){n._commands.computeCommand=void 0}})}const O=this._drawCommand;if(!(0,c.Z)(O.vertexArray)){const e={direction:0},t=new Uint8Array(8);t[0]=0,t[1]=0,t[2]=255,t[3]=0,t[4]=255,t[5]=255,t[6]=0,t[7]=255;const i=m.Z.createVertexBuffer({context:h,typedArray:t,usage:_.Z.STATIC_DRAW}),n=[{index:e.direction,vertexBuffer:i,componentsPerAttribute:2,normalize:!0,componentDatatype:a.Z.UNSIGNED_BYTE}],o=m.Z.createIndexBuffer({context:h,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:_.Z.STATIC_DRAW,indexDatatype:u.Z.UNSIGNED_SHORT});O.vertexArray=new x.Z({context:h,attributes:n,indexBuffer:o}),O.shaderProgram=b.Z.fromCache({context:h,vertexShaderSource:T.Z,fragmentShaderSource:S.Z,attributeLocations:e}),O.renderState=w.Z.fromCache({blending:E.Z.ALPHA_BLEND}),O.uniformMap=this._uniformMap}const M=h.uniformState.sunPositionWC,R=h.uniformState.sunPositionColumbusView,F=this._boundingVolume,B=this._boundingVolume2D;r.Z.clone(M,F.center),B.center.x=R.z,B.center.y=R.x,B.center.z=R.y,F.radius=d.Z.SOLAR_RADIUS+d.Z.SOLAR_RADIUS*this._glowLengthTS,B.radius=F.radius,s===I.Z.SCENE3D?n.Z.clone(F,O.boundingVolume):s===I.Z.COLUMBUS_VIEW&&n.Z.clone(B,O.boundingVolume);const k=P.Z.computeActualWgs84Position(e,M,D),H=r.Z.magnitude(r.Z.subtract(k,e.camera.position,D)),W=h.uniformState.projection,U=N;U.x=0,U.y=0,U.z=-H,U.w=1;const V=l.Z.multiplyByVector(W,U,D),z=P.Z.clipToGLWindowCoordinates(t.viewport,V,A);U.x=d.Z.SOLAR_RADIUS;const G=l.Z.multiplyByVector(W,U,D),j=P.Z.clipToGLWindowCoordinates(t.viewport,G,L);return this._size=o.Z.magnitude(o.Z.subtract(j,z,D)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){const e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),(0,h.Z)(this)};const M=O},66406:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(6785),o=i(88779);const r=function(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),this.color=n.Z.clone((0,o.Z)(e.color,n.Z.WHITE)),this.intensity=(0,o.Z)(e.intensity,2)}},48690:(e,t,i)=>{i.d(t,{Z:()=>C});var n=i(23114),o=i(59015),r=i(90868),s=i(54485),a=i(90332),c=i(22874),h=i(71118),u=i(7004),d=i(23832),l=i(1694),p=i(9812),f=i(2312),m=i(84260),_=i(51541),g=i(26330),Z=i(87421),y=i(98196);function w(){this._sceneFramebuffer=new y.Z;const e=.125,t=new Array(6);t[0]=new m.Z({fragmentShader:f.Z,textureScale:e,forcePowerOfTwo:!0,sampleMode:g.Z.LINEAR});const i=t[1]=new m.Z({fragmentShader:l.Z,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:e,forcePowerOfTwo:!0}),n=this;this._delta=1,this._sigma=2,this._blurStep=new o.Z,t[2]=new m.Z({fragmentShader:p.Z,uniforms:{step:function(){return n._blurStep.x=n._blurStep.y=1/i.outputTexture.width,n._blurStep},delta:function(){return n._delta},sigma:function(){return n._sigma},direction:0},textureScale:e,forcePowerOfTwo:!0}),t[3]=new m.Z({fragmentShader:p.Z,uniforms:{step:function(){return n._blurStep.x=n._blurStep.y=1/i.outputTexture.width,n._blurStep},delta:function(){return n._delta},sigma:function(){return n._sigma},direction:1},textureScale:e,forcePowerOfTwo:!0}),t[4]=new m.Z({fragmentShader:f.Z,sampleMode:g.Z.LINEAR}),this._uCenter=new o.Z,this._uRadius=void 0,t[5]=new m.Z({fragmentShader:d.Z,uniforms:{center:function(){return n._uCenter},radius:function(){return n._uRadius},colorTexture2:function(){return n._sceneFramebuffer.framebuffer.getColorTexture(0)}}}),this._stages=new _.Z({stages:t});const r=new Z.Z(this),s=t.length;for(let e=0;e<s;++e)t[e]._textureCache=r;this._textureCache=r,this.length=t.length}w.prototype.get=function(e){return this._stages.get(e)},w.prototype.getStageByName=function(e){const t=this._stages.length;for(let i=0;i<t;++i){const t=this._stages.get(i);if(t.name===e)return t}};const b=new r.Z,v=new o.Z,x=new o.Z,S=new h.Z;w.prototype.clear=function(e,t,i){this._sceneFramebuffer.clear(e,t,i),this._textureCache.clear(e)},w.prototype.update=function(e){const t=e.context,i=e.viewport,r=this._sceneFramebuffer;r.update(t,i);const s=r.framebuffer;return this._textureCache.update(t),this._stages.update(t,!1),function(e,t,i){const r=t.uniformState,s=r.sunPositionWC,a=r.view,d=r.viewProjection,l=r.projection;let p=h.Z.computeViewportTransformation(i,0,1,S);const f=h.Z.multiplyByPoint(a,s,b);let m=u.Z.pointToGLWindowCoordinates(d,p,s,v);f.x+=c.Z.SOLAR_RADIUS;const _=u.Z.pointToGLWindowCoordinates(l,p,f,f),g=30*o.Z.magnitude(o.Z.subtract(_,m,_))*2,Z=x;Z.x=g,Z.y=g,e._uCenter=o.Z.clone(m,e._uCenter),e._uRadius=.15*Math.max(Z.x,Z.y);const y=t.drawingBufferWidth,w=t.drawingBufferHeight,C=e._stages,T=C.get(0),E=T.outputTexture.width,I=T.outputTexture.height,P=new n.Z;P.width=E,P.height=I,p=h.Z.computeViewportTransformation(P,0,1,S),m=u.Z.pointToGLWindowCoordinates(d,p,s,v),Z.x*=E/y,Z.y*=I/w;const O=T.scissorRectangle;O.x=Math.max(m.x-.5*Z.x,0),O.y=Math.max(m.y-.5*Z.y,0),O.width=Math.min(Z.x,y),O.height=Math.min(Z.y,w);for(let e=1;e<4;++e)n.Z.clone(O,C.get(e).scissorRectangle)}(this,t,i),s},w.prototype.execute=function(e){const t=this._sceneFramebuffer.framebuffer.getColorTexture(0),i=this._stages,n=i.length;i.get(0).execute(e,t);for(let t=1;t<n;++t)i.get(t).execute(e,i.get(t-1).outputTexture)},w.prototype.copy=function(e,t){if(!(0,s.Z)(this._copyColorCommand)){const t=this;this._copyColorCommand=e.createViewportQuadCommand(f.Z,{uniformMap:{colorTexture:function(){return t._stages.get(t._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),(0,a.Z)(this)};const C=w},89248:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(88779);function o(e){e=(0,n.Z)(e,n.Z.EMPTY_OBJECT),this.webp=(0,n.Z)(e.webp,!1),this.basis=(0,n.Z)(e.basis,!1)}},8355:(e,t,i)=>{i.d(t,{Z:()=>se});var n=i(69310),o=i(17216),r=i(52351),s=i(59015),a=i(93517),c=i(90868),h=i(66866),u=i(54485),d=i(20176),l=i(30646),p=i(22874),f=i(42428),m=i(47594),_=i(34152),g=i(87569),Z=i(54594),y=i(99381),w=i(65412),b=i(37252),v=i(29159);function x(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new c.Z}x.prototype.update=function(e,t,i){this.changedThisFrame&&(V(e,t,this.tile,i),this.changedThisFrame=!1)},x.prototype.destroy=function(e){this._destroyVertexArray(e),(0,u.Z)(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)},x.prototype._destroyVertexArray=function(e){(0,u.Z)(this.vertexArray)&&((0,u.Z)(e)?e.push(this.vertexArray):b.Z._freeVertexArray(this.vertexArray),this.vertexArray=void 0)};const S=new m.Z;function C(e,t,i,n,o,r,s,a,c){if(void 0===n)return;let h=n;for(;h&&(h._lastSelectionResultFrame!==o||v.Z.wasKicked(h._lastSelectionResult)||v.Z.originalResult(h._lastSelectionResult)===v.Z.CULLED);){if(s)return;const e=h.parent;if(r>=y.Z.NORTHWEST&&void 0!==e)switch(r){case y.Z.NORTHWEST:h=h===e.northwestChild?e:void 0;break;case y.Z.NORTHEAST:h=h===e.northeastChild?e:void 0;break;case y.Z.SOUTHWEST:h=h===e.southwestChild?e:void 0;break;case y.Z.SOUTHEAST:h=h===e.southeastChild?e:void 0}else h=e}if(void 0!==h)if(h._lastSelectionResult!==v.Z.RENDERED){if(v.Z.originalResult(n._lastSelectionResult)!==v.Z.CULLED)switch(r){case y.Z.WEST:C(e,t,i,n.northwestChild,o,r,!0,a,c),C(e,t,i,n.southwestChild,o,r,!0,a,c);break;case y.Z.EAST:C(e,t,i,n.southeastChild,o,r,!0,a,c),C(e,t,i,n.northeastChild,o,r,!0,a,c);break;case y.Z.SOUTH:C(e,t,i,n.southwestChild,o,r,!0,a,c),C(e,t,i,n.southeastChild,o,r,!0,a,c);break;case y.Z.NORTH:C(e,t,i,n.northeastChild,o,r,!0,a,c),C(e,t,i,n.northwestChild,o,r,!0,a,c);break;case y.Z.NORTHWEST:C(e,t,i,n.northwestChild,o,r,!0,a,c);break;case y.Z.NORTHEAST:C(e,t,i,n.northeastChild,o,r,!0,a,c);break;case y.Z.SOUTHWEST:C(e,t,i,n.southwestChild,o,r,!0,a,c);break;case y.Z.SOUTHEAST:C(e,t,i,n.southeastChild,o,r,!0,a,c);break;default:throw new d.Z("Invalid edge")}}else{if((0,u.Z)(h.data.vertexArray))return;!function(e,t,i,n,o,r,s,a){const c=n.data;if(void 0===c.fill)c.fill=new x(n);else if(c.fill.visitedFrame===r)return;c.fill.enqueuedFrame!==r&&(c.fill.enqueuedFrame=r,c.fill.changedThisFrame=!1,s.enqueue(n));!function(e,t,i,n,o,r){const s=n.data.fill;let a;const c=i.data.fill;(0,u.Z)(c)?(c.visitedFrame=t.frameNumber,c.changedThisFrame&&(V(e,t,i,r),c.changedThisFrame=!1),a=i.data.fill.mesh):a=i.data.mesh;let h,d,l,f,m,_;switch(o){case y.Z.WEST:h=s.westMeshes,d=s.westTiles;break;case y.Z.SOUTH:h=s.southMeshes,d=s.southTiles;break;case y.Z.EAST:h=s.eastMeshes,d=s.eastTiles;break;case y.Z.NORTH:h=s.northMeshes,d=s.northTiles;break;case y.Z.NORTHWEST:return s.changedThisFrame=s.changedThisFrame||s.northwestMesh!==a,s.northwestMesh=a,void(s.northwestTile=i);case y.Z.NORTHEAST:return s.changedThisFrame=s.changedThisFrame||s.northeastMesh!==a,s.northeastMesh=a,void(s.northeastTile=i);case y.Z.SOUTHWEST:return s.changedThisFrame=s.changedThisFrame||s.southwestMesh!==a,s.southwestMesh=a,void(s.southwestTile=i);case y.Z.SOUTHEAST:return s.changedThisFrame=s.changedThisFrame||s.southeastMesh!==a,s.southeastMesh=a,void(s.southeastTile=i)}if(i.level<=n.level)return s.changedThisFrame=s.changedThisFrame||h[0]!==a||1!==h.length,h[0]=a,d[0]=i,h.length=1,void(d.length=1);const g=i.rectangle;let Z;const w=n.rectangle;switch(o){case y.Z.WEST:for(Z=(w.north-w.south)*p.Z.EPSILON5,l=0;l<d.length&&(m=d[l],_=m.rectangle,!p.Z.greaterThan(g.north,_.south,Z));++l);for(f=l;f<d.length&&(m=d[f],_=m.rectangle,!p.Z.greaterThanOrEquals(g.south,_.north,Z));++f);break;case y.Z.SOUTH:for(Z=(w.east-w.west)*p.Z.EPSILON5,l=0;l<d.length&&(m=d[l],_=m.rectangle,!p.Z.lessThan(g.west,_.east,Z));++l);for(f=l;f<d.length&&(m=d[f],_=m.rectangle,!p.Z.lessThanOrEquals(g.east,_.west,Z));++f);break;case y.Z.EAST:for(Z=(w.north-w.south)*p.Z.EPSILON5,l=0;l<d.length&&(m=d[l],_=m.rectangle,!p.Z.lessThan(g.south,_.north,Z));++l);for(f=l;f<d.length&&(m=d[f],_=m.rectangle,!p.Z.lessThanOrEquals(g.north,_.south,Z));++f);break;case y.Z.NORTH:for(Z=(w.east-w.west)*p.Z.EPSILON5,l=0;l<d.length&&(m=d[l],_=m.rectangle,!p.Z.greaterThan(g.east,_.west,Z));++l);for(f=l;f<d.length&&(m=d[f],_=m.rectangle,!p.Z.greaterThanOrEquals(g.west,_.east,Z));++f);}f-l==1?(s.changedThisFrame=s.changedThisFrame||h[l]!==a,h[l]=a,d[l]=i):(s.changedThisFrame=!0,h.splice(l,f-l,a),d.splice(l,f-l,i))}(e,t,i,n,o,a)}(e,t,i,h,r,o,a,c)}}x.updateFillTiles=function(e,t,i,n){const o=e._quadtree,r=o._levelZeroTiles,s=o._lastSelectionFrameNumber,a=S;a.clear();for(let e=0;e<t.length;++e){const i=t[e];(0,u.Z)(i.data.vertexArray)&&a.enqueue(t[e])}let c=a.dequeue();for(;void 0!==c;){const t=c.findTileToWest(r),o=c.findTileToSouth(r),h=c.findTileToEast(r),u=c.findTileToNorth(r);C(e,i,c,t,s,y.Z.EAST,!1,a,n),C(e,i,c,o,s,y.Z.NORTH,!1,a,n),C(e,i,c,h,s,y.Z.WEST,!1,a,n),C(e,i,c,u,s,y.Z.SOUTH,!1,a,n);const d=t.findTileToNorth(r),l=t.findTileToSouth(r),p=h.findTileToNorth(r),f=h.findTileToSouth(r);C(e,i,c,d,s,y.Z.SOUTHEAST,!1,a,n),C(e,i,c,p,s,y.Z.SOUTHWEST,!1,a,n),C(e,i,c,l,s,y.Z.NORTHEAST,!1,a,n),C(e,i,c,f,s,y.Z.NORTHWEST,!1,a,n),c=a.dequeue()}};const T=new h.Z,E=new h.Z,I=new a.Z,P=new a.Z,O=new s.Z,A=new s.Z,L=new s.Z;function N(){this.height=0,this.encodedNormal=new s.Z}function D(e,t,i,n,o,r,s,a,c){if((0,u.Z)(o))return o;let h;if((0,u.Z)(r)&&(0,u.Z)(s))h=.5*(r.height+s.height);else if((0,u.Z)(r))h=r.height;else if((0,u.Z)(s))h=s.height;else if((0,u.Z)(a))h=a.height;else{const t=e.tile.data.tileBoundingRegion;let i=0,n=0;(0,u.Z)(t)&&(i=t.minimumHeight,n=t.maximumHeight),h=.5*(i+n)}return K(e,t,i,n,h,c),c}const M={minimumHeight:0,maximumHeight:0},R=new a.Z,F=new N,B=new N,k=new N,H=new N,W="undefined"!=typeof Uint8Array?new Uint8Array(81):void 0,U={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0};function V(e,t,i,o){b.Z.initialize(i,e.terrainProvider,e._imageryLayers);const c=i.data,h=c.fill,d=i.rectangle,p=t.terrainExaggeration,m=t.terrainExaggerationRelativeHeight,v=1!==p,x=i.tilingScheme.ellipsoid;let S=Q(h,x,0,1,h.northwestTile,h.northwestMesh,h.northTiles,h.northMeshes,h.westTiles,h.westMeshes,k),C=Q(h,x,0,0,h.southwestTile,h.southwestMesh,h.westTiles,h.westMeshes,h.southTiles,h.southMeshes,F),I=Q(h,x,1,0,h.southeastTile,h.southeastMesh,h.southTiles,h.southMeshes,h.eastTiles,h.eastMeshes,B),A=Q(h,x,1,1,h.northeastTile,h.northeastMesh,h.eastTiles,h.eastMeshes,h.northTiles,h.northMeshes,H);S=D(h,x,0,1,S,C,A,I,k),C=D(h,x,0,0,C,S,I,A,F),I=D(h,x,1,1,I,C,A,S,B),A=D(h,x,1,1,A,I,S,C,H);const N=C.height,V=I.height,G=S.height,j=A.height;let q=Math.min(N,V,G,j),Y=Math.max(N,V,G,j);const X=.5*(q+Y);let $,K;const J=e.getLevelMaximumGeometricError(i.level),te=x.maximumRadius-J;let ie=4*Math.acos(te/x.maximumRadius);if(ie*=1.5,d.width>ie&&Y-q<=J){const e=new l.Z({width:9,height:9,buffer:W,structure:{heightOffset:Y}}),t=U;t.tilingScheme=i.tilingScheme,t.x=i.x,t.y=i.y,t.level=i.level,t.exaggeration=p,t.exaggerationRelativeHeight=m,h.mesh=e._createMeshSync(t)}else{const t=v,o=_.Z.center(d,E);o.height=X;const c=x.cartographicToCartesian(o,R),u=new g.Z(c,void 0,void 0,void 0,void 0,!0,!0,t,p,m);let l,b=5;for(l=h.westMeshes,$=0,K=l.length;$<K;++$)b+=l[$].eastIndicesNorthToSouth.length;for(l=h.southMeshes,$=0,K=l.length;$<K;++$)b+=l[$].northIndicesWestToEast.length;for(l=h.eastMeshes,$=0,K=l.length;$<K;++$)b+=l[$].westIndicesSouthToNorth.length;for(l=h.northMeshes,$=0,K=l.length;$<K;++$)b+=l[$].southIndicesEastToWest.length;const N=M;N.minimumHeight=q,N.maximumHeight=Y;const D=u.stride;let F=new Float32Array(b*D),B=0;const k=B;B=z(x,d,u,F,B,0,1,S.height,S.encodedNormal,1,N),B=ee(h,x,u,F,B,h.westTiles,h.westMeshes,y.Z.EAST,N);const H=B;B=z(x,d,u,F,B,0,0,C.height,C.encodedNormal,0,N),B=ee(h,x,u,F,B,h.southTiles,h.southMeshes,y.Z.NORTH,N);const W=B;B=z(x,d,u,F,B,1,0,I.height,I.encodedNormal,0,N),B=ee(h,x,u,F,B,h.eastTiles,h.eastMeshes,y.Z.WEST,N);const U=B;B=z(x,d,u,F,B,1,1,A.height,A.encodedNormal,1,N),B=ee(h,x,u,F,B,h.northTiles,h.northMeshes,y.Z.SOUTH,N),q=N.minimumHeight,Y=N.maximumHeight;const V=f.Z.fromRectangle(d,q,Y,i.tilingScheme.ellipsoid),G=w.Z.geodeticLatitudeToMercatorAngle(d.south),j=1/(w.Z.geodeticLatitudeToMercatorAngle(d.north)-G),Q=(w.Z.geodeticLatitudeToMercatorAngle(o.latitude)-G)*j,J=x.geodeticSurfaceNormalCartographic(T,P),te=n.Z.octEncode(J,O),ie=B;u.encode(F,B*D,V.center,s.Z.fromElements(.5,.5,L),X,te,Q,J),++B;const ne=B,oe=3*(ne-1),se=oe*(ne<256?1:2);let ae;if((F.length-ne*D)*Float32Array.BYTES_PER_ELEMENT>=se){const e=ne*D*Float32Array.BYTES_PER_ELEMENT;ae=ne<256?new Uint8Array(F.buffer,e,oe):new Uint16Array(F.buffer,e,oe)}else ae=ne<256?new Uint8Array(oe):new Uint16Array(oe);F=new Float32Array(F.buffer,0,ne*D);let ce=0;for($=0;$<ne-2;++$)ae[ce++]=ie,ae[ce++]=$,ae[ce++]=$+1;ae[ce++]=ie,ae[ce++]=$,ae[ce++]=0;const he=[];for($=H;$>=k;--$)he.push($);const ue=[];for($=W;$>=H;--$)ue.push($);const de=[];for($=U;$>=W;--$)de.push($);const le=[];for(le.push(0),$=ie-1;$>=U;--$)le.push($);h.mesh=new Z.Z(u.center,F,ae,oe,ne,q,Y,r.Z.fromOrientedBoundingBox(V),function(e,t,i,n,o,r){const s=e.quadtree._occluders.ellipsoid,c=s.ellipsoid,h=re;return a.Z.fromRadians(i.west,i.south,o,c,h[0]),a.Z.fromRadians(i.east,i.south,o,c,h[1]),a.Z.fromRadians(i.west,i.north,o,c,h[2]),a.Z.fromRadians(i.east,i.north,o,c,h[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,h,n,r)}(e,V.center,d,q,Y),u.stride,V,u,he,ue,de,le)}const ne=t.context;h._destroyVertexArray(o),h.vertexArray=b.Z._createVertexArrayForMesh(ne,h.mesh),c.processImagery(i,e.terrainProvider,t,!0);const oe=h.waterMaskTexture;if(h.waterMaskTexture=void 0,e.terrainProvider.hasWaterMask){const e=c._findAncestorTileWithTerrainData(i);(0,u.Z)(e)&&(0,u.Z)(e.data.waterMaskTexture)&&(h.waterMaskTexture=e.data.waterMaskTexture,++h.waterMaskTexture.referenceCount,c._computeWaterMaskTranslationAndScale(i,e,h.waterMaskTranslationAndScale))}(0,u.Z)(oe)&&(--oe.referenceCount,0===oe.referenceCount&&oe.destroy())}function z(e,t,i,n,o,r,s,a,c,h,u){const d=T;d.longitude=p.Z.lerp(t.west,t.east,r),d.latitude=p.Z.lerp(t.south,t.north,s),d.height=a;const l=e.cartographicToCartesian(d,I);let f;i.hasGeodeticSurfaceNormals&&(f=e.geodeticSurfaceNormal(l,P));const m=A;return m.x=r,m.y=s,i.encode(n,o*i.stride,l,m,a,c,h,f),u.minimumHeight=Math.min(u.minimumHeight,a),u.maximumHeight=Math.max(u.maximumHeight,a),o+1}const G=new _.Z;function j(e,t,i,n){let o=e.rectangle;const r=t.rectangle;0===t.x&&1===i.x&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?(o=_.Z.clone(e.rectangle,G),o.west-=p.Z.TWO_PI,o.east-=p.Z.TWO_PI):0===e.x&&0===i.x&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&(o=_.Z.clone(e.rectangle,G),o.west+=p.Z.TWO_PI,o.east+=p.Z.TWO_PI);const s=o.east-o.west,a=(r.west-o.west)/s,c=(r.east-o.west)/s,h=o.north-o.south,u=(r.south-o.south)/h,d=(r.north-o.south)/h;let l=(i.x-a)/(c-a),f=(i.y-u)/(d-u);return Math.abs(l)<Math.EPSILON5?l=0:Math.abs(l-1)<Math.EPSILON5&&(l=1),Math.abs(f)<Math.EPSILON5?f=0:Math.abs(f-1)<Math.EPSILON5&&(f=1),n.x=l,n.y=f,n}const q=new s.Z;function Y(e,t,i,n,o){const r=e.encoding,s=e.vertices;if(o.height=r.decodeHeight(s,t),r.hasVertexNormals)r.getOctEncodedNormal(s,t,o.encodedNormal);else{const e=o.encodedNormal;e.x=0,e.y=0}}const X=new s.Z,$=new a.Z;function K(e,t,i,o,r,s){s.height=r;const a=t.geodeticSurfaceNormalCartographic(T,I);n.Z.octEncode(a,s.encodedNormal)}function Q(e,t,i,n,o,r,s,a,c,h,d){if(oe(e,t,a,s,!1,i,n,d)||oe(e,t,h,c,!0,i,n,d))return d;let l,p;return ne(o,r)?(l=0===i?0===n?r.eastIndicesNorthToSouth[0]:r.southIndicesEastToWest[0]:0===n?r.northIndicesWestToEast[0]:r.westIndicesSouthToNorth[0],Y(r,l,0,0,d),d):(p=0===i?0===n?J(e.westMeshes,e.westTiles,y.Z.EAST,e.southMeshes,e.southTiles,y.Z.NORTH,i,n):J(e.northMeshes,e.northTiles,y.Z.SOUTH,e.westMeshes,e.westTiles,y.Z.EAST,i,n):0===n?J(e.southMeshes,e.southTiles,y.Z.NORTH,e.eastMeshes,e.eastTiles,y.Z.WEST,i,n):J(e.eastMeshes,e.eastTiles,y.Z.WEST,e.northMeshes,e.northTiles,y.Z.SOUTH,i,n),(0,u.Z)(p)?(K(0,t,0,0,p,d),d):void 0)}function J(e,t,i,n,o,r,s,a){const c=ie(e,t,!1,i,s,a),h=ie(n,o,!0,r,s,a);return(0,u.Z)(c)&&(0,u.Z)(h)?.5*(c+h):(0,u.Z)(c)?c:h}function ee(e,t,i,n,o,r,s,a,c){for(let h=0;h<r.length;++h)o=te(e,t,i,n,o,r[h],s[h],a,c);return o}function te(e,t,i,n,o,r,s,a,c){let h=r.rectangle;a===y.Z.EAST&&0===e.tile.x?(h=_.Z.clone(r.rectangle,G),h.west-=p.Z.TWO_PI,h.east-=p.Z.TWO_PI):a===y.Z.WEST&&0===r.x&&(h=_.Z.clone(r.rectangle,G),h.west+=p.Z.TWO_PI,h.east+=p.Z.TWO_PI);const u=e.tile.rectangle;let d,l,f,m;switch(o>0&&(i.decodeTextureCoordinates(n,o-1,L),d=L.x,l=L.y),a){case y.Z.WEST:f=s.westIndicesSouthToNorth,m=!1;break;case y.Z.NORTH:f=s.northIndicesWestToEast,m=!0;break;case y.Z.EAST:f=s.eastIndicesNorthToSouth,m=!1;break;case y.Z.SOUTH:f=s.southIndicesEastToWest,m=!0}const g=r,Z=e.tile,b=s.encoding,v=s.vertices,x=i.stride;let S,C;b.hasWebMercatorT&&(S=w.Z.geodeticLatitudeToMercatorAngle(u.south),C=1/(w.Z.geodeticLatitudeToMercatorAngle(u.north)-S));for(let e=0;e<f.length;++e){const r=f[e],s=b.decodeTextureCoordinates(v,r,L);j(g,Z,s,s);const a=s.x,h=s.y,_=m?a:h;if(_<0||_>1)continue;if(Math.abs(a-d)<p.Z.EPSILON5&&Math.abs(h-l)<p.Z.EPSILON5)continue;const y=Math.abs(a)<p.Z.EPSILON5||Math.abs(a-1)<p.Z.EPSILON5,T=Math.abs(h)<p.Z.EPSILON5||Math.abs(h-1)<p.Z.EPSILON5;if(y&&T)continue;const E=b.decodePosition(v,r,I),A=b.decodeHeight(v,r);let N;b.hasVertexNormals?N=b.getOctEncodedNormal(v,r,O):(N=O,N.x=0,N.y=0);let D,M=h;if(b.hasWebMercatorT){const e=p.Z.lerp(u.south,u.north,h);M=(w.Z.geodeticLatitudeToMercatorAngle(e)-S)*C}i.hasGeodeticSurfaceNormals&&(D=t.geodeticSurfaceNormal(E,P)),i.encode(n,o*x,E,s,A,N,M,D),c.minimumHeight=Math.min(c.minimumHeight,A),c.maximumHeight=Math.max(c.maximumHeight,A),++o}return o}function ie(e,t,i,n,o,r){let s,a,c;i?(s=0,a=e.length,c=1):(s=e.length-1,a=-1,c=-1);for(let o=s;o!==a;o+=c){const r=e[o];if(!ne(t[o],r))continue;let s;switch(n){case y.Z.WEST:s=r.westIndicesSouthToNorth;break;case y.Z.SOUTH:s=r.southIndicesEastToWest;break;case y.Z.EAST:s=r.eastIndicesNorthToSouth;break;case y.Z.NORTH:s=r.northIndicesWestToEast}const a=s[i?0:s.length-1];if((0,u.Z)(a))return r.encoding.decodeHeight(r.vertices,a)}}function ne(e,t){return(0,u.Z)(t)&&(!(0,u.Z)(e.data.fill)||!e.data.fill.changedThisFrame)}function oe(e,t,i,r,s,c,h,u){let d,l,f,m,_;const g=r[s?0:i.length-1],Z=i[s?0:i.length-1];if(ne(g,Z)&&(0===c?0===h?(d=s?Z.northIndicesWestToEast:Z.eastIndicesNorthToSouth,l=s,f=s):(d=s?Z.eastIndicesNorthToSouth:Z.southIndicesEastToWest,l=!s,f=!1):0===h?(d=s?Z.westIndicesSouthToNorth:Z.northIndicesWestToEast,l=!s,f=!0):(d=s?Z.southIndicesEastToWest:Z.westIndicesSouthToNorth,l=s,f=!s),d.length>0)){m=s?0:d.length-1,_=d[m],Z.encoding.decodeTextureCoordinates(Z.vertices,_,L);const i=j(g,e.tile,L,L);if(i.x===c&&i.y===h)return Y(Z,_,0,0,u),!0;if(m=(0,o.Z)(d,l?c:h,(function(t,i){Z.encoding.decodeTextureCoordinates(Z.vertices,t,L);const n=j(g,e.tile,L,L);return f?l?n.x-c:n.y-h:l?c-n.x:h-n.y})),!(m<0))return Y(Z,d[m],0,0,u),!0;if(m=~m,m>0&&m<d.length)return function(e,t,i,o,r,s,c,h,u,d){const l=o.encoding,f=o.vertices,m=j(t,i,l.decodeTextureCoordinates(f,r,L),L),_=j(t,i,l.decodeTextureCoordinates(f,s,A),A);let g;g=u?(c-m.x)/(_.x-m.x):(h-m.y)/(_.y-m.y);const Z=l.decodeHeight(f,r),y=l.decodeHeight(f,s),w=i.rectangle;let b;if(T.longitude=p.Z.lerp(w.west,w.east,c),T.latitude=p.Z.lerp(w.south,w.north,h),d.height=T.height=p.Z.lerp(Z,y,g),l.hasVertexNormals){const e=l.getOctEncodedNormal(f,r,q),t=l.getOctEncodedNormal(f,s,X),i=n.Z.octDecode(e.x,e.y,I),o=n.Z.octDecode(t.x,t.y,$);b=a.Z.lerp(i,o,g,I),a.Z.normalize(b,b),n.Z.octEncode(b,d.encodedNormal)}else b=e.geodeticSurfaceNormalCartographic(T,I),n.Z.octEncode(b,d.encodedNormal)}(t,g,e.tile,Z,d[m-1],d[m],c,h,l,u),!0}return!1}const re=[new a.Z,new a.Z,new a.Z,new a.Z];const se=x},40830:(e,t,i)=>{i.d(t,{Z:()=>n});const n=Object.freeze({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6})},79670:(e,t,i)=>{i.d(t,{Z:()=>b});var n=i(23114),o=i(59015),r=i(93737),s=i(88779),a=i(54485),c=i(90332),h=i(20176),u=i(91166),d=i(67197),l=i(21514),p=i(36274),f=i(47334);function m(e,t,i,n,r){this.bottomLeft=(0,s.Z)(e,o.Z.ZERO),this.topRight=(0,s.Z)(t,o.Z.ZERO),this.childNode1=i,this.childNode2=n,this.imageIndex=r}const _=new o.Z(16,16);function g(e){e=(0,s.Z)(e,s.Z.EMPTY_OBJECT);const t=(0,s.Z)(e.borderWidthInPixels,1),i=(0,s.Z)(e.initialSize,_);if(!(0,a.Z)(e.context))throw new h.Z("context is required.");if(t<0)throw new h.Z("borderWidthInPixels must be greater than or equal to zero.");if(i.x<1||i.y<1)throw new h.Z("initialSize must be greater than zero.");this._context=e.context,this._pixelFormat=(0,s.Z)(e.pixelFormat,u.Z.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=(0,r.Z)(),this._idHash={},this._indexHash={},this._initialSize=i,this._root=void 0}function Z(e,t,i){if((0,a.Z)(t)){if(!(0,a.Z)(t.childNode1)&&!(0,a.Z)(t.childNode2)){if((0,a.Z)(t.imageIndex))return;const n=t.topRight.x-t.bottomLeft.x,r=t.topRight.y-t.bottomLeft.y,s=n-i.width,c=r-i.height;if(s<0||c<0)return;if(0===s&&0===c)return t;if(s>c){t.childNode1=new m(new o.Z(t.bottomLeft.x,t.bottomLeft.y),new o.Z(t.bottomLeft.x+i.width,t.topRight.y));const n=t.bottomLeft.x+i.width+e._borderWidthInPixels;n<t.topRight.x&&(t.childNode2=new m(new o.Z(n,t.bottomLeft.y),new o.Z(t.topRight.x,t.topRight.y)))}else{t.childNode1=new m(new o.Z(t.bottomLeft.x,t.bottomLeft.y),new o.Z(t.topRight.x,t.bottomLeft.y+i.height));const n=t.bottomLeft.y+i.height+e._borderWidthInPixels;n<t.topRight.y&&(t.childNode2=new m(new o.Z(t.bottomLeft.x,n),new o.Z(t.topRight.x,t.topRight.y)))}return Z(e,t.childNode1,i)}return Z(e,t.childNode1,i)||Z(e,t.childNode2,i)}}function y(e,t,i){const s=Z(e,e._root,t);if((0,a.Z)(s)){s.imageIndex=i;const o=e._texture.width,r=e._texture.height,a=s.topRight.x-s.bottomLeft.x,c=s.topRight.y-s.bottomLeft.y,h=s.bottomLeft.x/o,u=s.bottomLeft.y/r,d=a/o,l=c/r;e._textureCoordinates[i]=new n.Z(h,u,d,l),e._texture.copyFrom({source:t,xOffset:s.bottomLeft.x,yOffset:s.bottomLeft.y})}else!function(e,t){const i=e._context,n=e.numberOfImages,r=e._borderWidthInPixels;if(n>0){const n=e._texture.width,s=e._texture.height,c=2*(n+t.width+r),h=2*(s+t.height+r),u=n/c,d=s/h,l=new m(new o.Z(n+r,r),new o.Z(c,s)),_=new m(new o.Z,new o.Z(c,s),e._root,l),g=new m(new o.Z(r,s+r),new o.Z(c,h)),Z=new m(new o.Z,new o.Z(c,h),_,g);for(let t=0;t<e._textureCoordinates.length;t++){const i=e._textureCoordinates[t];(0,a.Z)(i)&&(i.x*=u,i.y*=d,i.width*=u,i.height*=d)}const y=new f.Z({context:e._context,width:c,height:h,pixelFormat:e._pixelFormat}),w=new p.Z({context:i,colorTextures:[e._texture],destroyAttachments:!1});w._bind(),y.copyFromFramebuffer(0,0,0,0,c,h),w._unBind(),w.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=y,e._root=Z}else{let i=2*(t.width+2*r),n=2*(t.height+2*r);i<e._initialSize.x&&(i=e._initialSize.x),n<e._initialSize.y&&(n=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new f.Z({context:e._context,width:i,height:n,pixelFormat:e._pixelFormat}),e._root=new m(new o.Z(r,r),new o.Z(i,n))}}(e,t),y(e,t,i);e._guid=(0,r.Z)()}function w(e,t){if(!(0,a.Z)(e)||e.isDestroyed())return-1;const i=e.numberOfImages;return y(e,t,i),i}Object.defineProperties(g.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return(0,a.Z)(this._texture)||(this._texture=new f.Z({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),g.prototype.getImageIndex=function(e){if(!(0,a.Z)(e))throw new h.Z("id is required.");return this._indexHash[e]},g.prototype.addImageSync=function(e,t){if(!(0,a.Z)(e))throw new h.Z("id is required.");if(!(0,a.Z)(t))throw new h.Z("image is required.");let i=this._indexHash[e];return(0,a.Z)(i)||(i=w(this,t),this._idHash[e]=Promise.resolve(i),this._indexHash[e]=i),i},g.prototype.addImage=function(e,t){if(!(0,a.Z)(e))throw new h.Z("id is required.");if(!(0,a.Z)(t))throw new h.Z("image is required.");let i=this._idHash[e];if((0,a.Z)(i))return i;if("function"==typeof t){if(t=t(e),!(0,a.Z)(t))throw new h.Z("image is required.")}else if("string"==typeof t||t instanceof d.Z){t=d.Z.createIfNeeded(t).fetchImage()}const n=this;return i=Promise.resolve(t).then((function(t){const i=w(n,t);return n._indexHash[e]=i,i})),this._idHash[e]=i,i},g.prototype.addSubRegion=function(e,t){if(!(0,a.Z)(e))throw new h.Z("id is required.");if(!(0,a.Z)(t))throw new h.Z("subRegion is required.");const i=this._idHash[e];if(!(0,a.Z)(i))throw new l.Z(`image with id "${e}" not found in the atlas.`);const o=this;return Promise.resolve(i).then((function(e){if(-1===e)return-1;const i=o._texture.width,s=o._texture.height,a=o.numberOfImages,c=o._textureCoordinates[e],h=c.x+t.x/i,u=c.y+t.y/s,d=t.width/i,l=t.height/s;return o._textureCoordinates.push(new n.Z(h,u,d,l)),o._guid=(0,r.Z)(),a}))},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),(0,c.Z)(this)};const b=g},74371:(e,t,i)=>{i.d(t,{Z:()=>B});var n=i(52351),o=i(93517),r=i(66866),s=i(17497),a=i(41631),c=i(88779),h=i(54485),u=i(99996),d=i(78224),l=i(14090),p=i(71118),f=i(42428),m=i(30445),_=i(43262),g=i(34152),Z=i(8972),y=i(73020),w=i(27401),b=i(18061);function v(e){s.Z.typeOf.object("options",e),s.Z.typeOf.object("options.rectangle",e.rectangle),this.rectangle=g.Z.clone(e.rectangle),this.minimumHeight=(0,c.Z)(e.minimumHeight,0),this.maximumHeight=(0,c.Z)(e.maximumHeight,0),this.southwestCornerCartesian=new o.Z,this.northeastCornerCartesian=new o.Z,this.westNormal=new o.Z,this.southNormal=new o.Z,this.eastNormal=new o.Z,this.northNormal=new o.Z;const t=(0,c.Z)(e.ellipsoid,u.Z.WGS84);!function(e,t,i){i.cartographicToCartesian(g.Z.southwest(t),e.southwestCornerCartesian),i.cartographicToCartesian(g.Z.northeast(t),e.northeastCornerCartesian),O.longitude=t.west,O.latitude=.5*(t.south+t.north),O.height=0;const n=i.cartographicToCartesian(O,I),r=o.Z.cross(n,o.Z.UNIT_Z,T);o.Z.normalize(r,e.westNormal),O.longitude=t.east;const s=i.cartographicToCartesian(O,P),a=o.Z.cross(o.Z.UNIT_Z,s,x);o.Z.normalize(a,e.eastNormal);let c=o.Z.subtract(n,s,x);0===o.Z.magnitude(c)&&(c=o.Z.clone(r,c));const h=o.Z.normalize(c,E),u=t.south;let d;if(u>0){O.longitude=.5*(t.west+t.east),O.latitude=u;const n=i.cartographicToCartesian(O,L.origin);o.Z.clone(h,L.direction);const r=m.Z.fromPointNormal(e.southwestCornerCartesian,e.westNormal,A);l.Z.rayPlane(L,r,e.southwestCornerCartesian),d=i.geodeticSurfaceNormal(n,S)}else d=i.geodeticSurfaceNormalCartographic(g.Z.southeast(t),S);const p=o.Z.cross(d,c,C);o.Z.normalize(p,e.southNormal);const f=t.north;let _;if(f<0){O.longitude=.5*(t.west+t.east),O.latitude=f;const n=i.cartographicToCartesian(O,L.origin);o.Z.negate(h,L.direction);const r=m.Z.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,A);l.Z.rayPlane(L,r,e.northeastCornerCartesian),_=i.geodeticSurfaceNormal(n,S)}else _=i.geodeticSurfaceNormalCartographic(g.Z.northwest(t),S);const Z=o.Z.cross(c,_,C);o.Z.normalize(Z,e.northNormal)}(this,e.rectangle,t),this._orientedBoundingBox=void 0,this._boundingSphere=void 0,(0,c.Z)(e.computeBoundingVolumes,!0)&&this.computeBoundingVolumes(t)}Object.defineProperties(v.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),v.prototype.computeBoundingVolumes=function(e){this._orientedBoundingBox=f.Z.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,e),this._boundingSphere=n.Z.fromOrientedBoundingBox(this._orientedBoundingBox)};const x=new o.Z,S=new o.Z,C=new o.Z,T=new o.Z,E=new o.Z,I=new o.Z,P=new o.Z,O=new r.Z,A=new m.Z(o.Z.UNIT_X,0),L=new _.Z;const N=new o.Z,D=new o.Z,M=new o.Z(0,-1,0),R=new o.Z(0,0,-1),F=new o.Z;v.prototype.distanceToCamera=function(e){s.Z.defined("frameState",e);const t=function(e,t){const i=t.camera,n=i.positionWC,r=i.positionCartographic;let s,a,c,h=0;if(!g.Z.contains(e.rectangle,r)){let i=e.southwestCornerCartesian,r=e.northeastCornerCartesian,s=e.westNormal,a=e.southNormal,c=e.eastNormal,u=e.northNormal;t.mode!==b.Z.SCENE3D&&(i=t.mapProjection.project(g.Z.southwest(e.rectangle),N),i.z=i.y,i.y=i.x,i.x=0,r=t.mapProjection.project(g.Z.northeast(e.rectangle),D),r.z=r.y,r.y=r.x,r.x=0,s=M,c=o.Z.UNIT_Y,a=R,u=o.Z.UNIT_Z);const d=o.Z.subtract(n,i,F),l=o.Z.dot(d,s),p=o.Z.dot(d,a),f=o.Z.subtract(n,r,F),m=o.Z.dot(f,c),_=o.Z.dot(f,u);l>0?h+=l*l:m>0&&(h+=m*m),p>0?h+=p*p:_>0&&(h+=_*_)}if(t.mode===b.Z.SCENE3D?(s=r.height,a=e.minimumHeight,c=e.maximumHeight):(s=n.x,a=0,c=0),s>c){const e=s-c;h+=e*e}else if(s<a){const e=a-s;h+=e*e}return Math.sqrt(h)}(this,e);if(e.mode===b.Z.SCENE3D&&(0,h.Z)(this._orientedBoundingBox)){const i=Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC));return Math.max(t,i)}return t},v.prototype.intersectPlane=function(e){return s.Z.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},v.prototype.createDebugVolume=function(e){s.Z.defined("color",e);const t=new p.Z.clone(p.Z.IDENTITY),i=new Z.Z({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),n=new d.Z({geometry:i,id:"outline",modelMatrix:t,attributes:{color:a.Z.fromColor(e)}});return new w.Z({geometryInstances:n,appearance:new y.Z({translucent:!1,flat:!0}),asynchronous:!1})};const B=v},15545:(e,t,i)=>{i.d(t,{Z:()=>ee});var n=i(93517),o=i(54485),r=i(66866),s=i(99996),a=i(3169),c=i(39109),h=i(30445),u=i(8206),d=i(52351),l=i(17497),p=i(41631),f=i(88779),m=i(78224),_=i(71118),g=i(73020),Z=i(27401),y=i(24845);let w=new r.Z;function b(e){l.Z.typeOf.object("options",e),l.Z.typeOf.string("options.token",e.token);const t=y.Z.fromToken(e.token),i=(0,f.Z)(e.minimumHeight,0),o=(0,f.Z)(e.maximumHeight,0),r=(0,f.Z)(e.ellipsoid,s.Z.WGS84);this.s2Cell=t,this.minimumHeight=i,this.maximumHeight=o,this.ellipsoid=r;const a=function(e,t,i,o){const r=new Array(6),s=e.getCenter(),a=o.geodeticSurfaceNormal(s,v),c=o.cartesianToCartographic(s,x);c.height=i;const u=o.cartographicToCartesian(c,S),d=h.Z.fromPointNormal(u,a);r[0]=d;let l,p=0;const f=[];let m,_;for(l=0;l<4;l++){m=e.getVertex(l),f[l]=m,_=o.cartesianToCartographic(m,C),_.height=t;const i=h.Z.getPointDistance(d,o.cartographicToCartesian(_,T));i<p&&(p=i)}const g=h.Z.clone(d);for(g.normal=n.Z.negate(g.normal,g.normal),g.distance=-1*g.distance+p,r[1]=g,l=0;l<4;l++){m=f[l];const e=f[(l+1)%4],t=o.geodeticSurfaceNormal(m,E),i=n.Z.subtract(e,m,P);let s=n.Z.cross(i,t,I);s=n.Z.normalize(s,s),r[2+l]=h.Z.fromPointNormal(m,s)}return r}(t,i,o,r);this._boundingPlanes=a;const c=function(e){const t=new Array(8);for(let i=0;i<4;i++)t[i]=z(e[0],e[2+(i+3)%4],e[2+i%4]),t[i+4]=z(e[1],e[2+(i+3)%4],e[2+i%4]);return t}(a);let u;for(this._vertices=c,this._edgeNormals=new Array(6),this._edgeNormals[0]=q(a[0],c.slice(0,4)),u=0;u<4;u++)this._edgeNormals[0][u]=n.Z.negate(this._edgeNormals[0][u],this._edgeNormals[0][u]);for(this._edgeNormals[1]=q(a[1],c.slice(4,8)),u=0;u<4;u++)this._edgeNormals[2+u]=q(a[2+u],[c[u%4],c[(u+1)%4],c[4+(u+1)%4],c[4+u]]);for(this._planeVertices=[this._vertices.slice(0,4),this._vertices.slice(4,8)],u=0;u<4;u++)this._planeVertices.push([this._vertices[u%4],this._vertices[(u+1)%4],this._vertices[4+(u+1)%4],this._vertices[4+u]]);const p=t.getCenter();w=r.cartesianToCartographic(p,w),w.height=(o+i)/2,this.center=r.cartographicToCartesian(w,p),this._boundingSphere=d.Z.fromPoints(c)}const v=new n.Z,x=new r.Z,S=new n.Z,C=new r.Z,T=new n.Z,E=new n.Z,I=new n.Z,P=new n.Z;let O=new n.Z,A=new n.Z,L=new n.Z,N=new n.Z,D=new n.Z,M=new n.Z;const R=new n.Z,F=new n.Z,B=new n.Z;let k=new n.Z,H=new n.Z,W=new n.Z,U=new n.Z;const V=new c.Z;function z(e,t,i){O=e.normal,A=t.normal,L=i.normal,N=n.Z.multiplyByScalar(e.normal,-e.distance,N),D=n.Z.multiplyByScalar(t.normal,-t.distance,D),M=n.Z.multiplyByScalar(i.normal,-i.distance,M),k=n.Z.multiplyByScalar(n.Z.cross(A,L,R),n.Z.dot(N,O),k),H=n.Z.multiplyByScalar(n.Z.cross(L,O,F),n.Z.dot(D,A),H),W=n.Z.multiplyByScalar(n.Z.cross(O,A,B),n.Z.dot(M,L),W),V[0]=O.x,V[1]=A.x,V[2]=L.x,V[3]=O.y,V[4]=A.y,V[5]=L.y,V[6]=O.z,V[7]=A.z,V[8]=L.z;const o=c.Z.determinant(V);return U=n.Z.add(k,H,U),U=n.Z.add(U,W,U),new n.Z(U.x/o,U.y/o,U.z/o)}let G=new n.Z,j=new n.Z;function q(e,t){const i=[];for(let o=0;o<4;o++)G=n.Z.subtract(t[(o+1)%4],t[o],G),j=n.Z.cross(e.normal,G,j),j=n.Z.normalize(j,j),i[o]=n.Z.clone(j);return i}Object.defineProperties(b.prototype,{boundingVolume:{get:function(){return this}},boundingSphere:{get:function(){return this._boundingSphere}}});const Y=new n.Z;b.prototype.distanceToCamera=function(e){l.Z.defined("frameState",e);const t=e.camera.positionWC,i=[],o=[];let r,s,a,c,u;for(h.Z.getPointDistance(this._boundingPlanes[0],t)>0?(i.push(0),o.push(this._planeVertices[0]),r=this._edgeNormals[0]):h.Z.getPointDistance(this._boundingPlanes[1],t)>0&&(i.push(1),o.push(this._planeVertices[1]),r=this._edgeNormals[1]),s=0;s<4;s++)a=2+s,h.Z.getPointDistance(this._boundingPlanes[a],t)>0&&(i.push(a),o.push(this._planeVertices[a]),r=this._edgeNormals[a]);if(0===i.length)return 0;if(1===i.length)return u=this._boundingPlanes[i[0]],c=J(h.Z.projectPointOntoPlane(u,t,Y),o[0],u,r),n.Z.distance(c,t);if(2===i.length){if(0===i[0]){const e=[this._vertices[4*i[0]+(i[1]-2)],this._vertices[4*i[0]+(i[1]-2+1)%4]];return c=K(t,e[0],e[1]),n.Z.distance(c,t)}let e,r=Number.MAX_VALUE;for(s=0;s<2;s++)u=this._boundingPlanes[i[s]],c=J(h.Z.projectPointOntoPlane(u,t,Y),o[s],u,this._edgeNormals[i[s]]),e=n.Z.distanceSquared(c,t),e<r&&(r=e);return Math.sqrt(r)}if(i.length>3)return c=J(h.Z.projectPointOntoPlane(this._boundingPlanes[1],t,Y),this._planeVertices[1],this._boundingPlanes[1],this._edgeNormals[1]),n.Z.distance(c,t);const d=2===i[1]&&5===i[2]?0:1;return 0===i[0]?n.Z.distance(t,this._vertices[(i[1]-2+d)%4]):n.Z.distance(t,this._vertices[4+(i[1]-2+d)%4])};const X=new n.Z,$=new n.Z;function K(e,t,i){const o=n.Z.subtract(i,t,X),r=n.Z.subtract(e,t,$);let s=n.Z.dot(o,r);if(s<=0)return t;const a=n.Z.dot(o,o);return s>=a?i:(s/=a,new n.Z((1-s)*t.x+s*i.x,(1-s)*t.y+s*i.y,(1-s)*t.z+s*i.z))}const Q=new h.Z(n.Z.UNIT_X,0);function J(e,t,i,r){let s,a,c,u=Number.MAX_VALUE;for(let i=0;i<t.length;i++){const o=h.Z.fromPointNormal(t[i],r[i],Q);h.Z.getPointDistance(o,e)<0||(c=K(e,t[i],t[(i+1)%4]),s=n.Z.distance(e,c),s<u&&(u=s,a=c))}return(0,o.Z)(a)?a:e}b.prototype.intersectPlane=function(e){l.Z.defined("plane",e);let t=0,i=0;for(let o=0;o<this._vertices.length;o++){n.Z.dot(e.normal,this._vertices[o])+e.distance<0?i++:t++}return t===this._vertices.length?a.Z.INSIDE:i===this._vertices.length?a.Z.OUTSIDE:a.Z.INTERSECTING},b.prototype.createDebugVolume=function(e){l.Z.defined("color",e);const t=new _.Z.clone(_.Z.IDENTITY),i=new u.Z({polygonHierarchy:{positions:this._planeVertices[0]}}),n=u.Z.createGeometry(i),o=new m.Z({geometry:n,id:"outline",modelMatrix:t,attributes:{color:p.Z.fromColor(e)}}),r=new u.Z({polygonHierarchy:{positions:this._planeVertices[1]}}),s=u.Z.createGeometry(r),a=new m.Z({geometry:s,id:"outline",modelMatrix:t,attributes:{color:p.Z.fromColor(e)}}),c=[];for(let i=0;i<4;i++){const n=new u.Z({polygonHierarchy:{positions:this._planeVertices[2+i]}}),o=u.Z.createGeometry(n);c[i]=new m.Z({geometry:o,id:"outline",modelMatrix:t,attributes:{color:p.Z.fromColor(e)}})}return new Z.Z({geometryInstances:[c[0],c[1],c[2],c[3],a,o],appearance:new g.Z({translucent:!1,flat:!0}),asynchronous:!1})};const ee=b},26280:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(52351),o=i(93517),r=i(17497),s=i(41631),a=i(78224),c=i(22874),h=i(71118),u=i(44164),d=i(73020),l=i(27401);function p(e,t){0===t&&(t=c.Z.EPSILON7),this._boundingSphere=new n.Z(e,t)}Object.defineProperties(p.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}}),p.prototype.distanceToCamera=function(e){r.Z.defined("frameState",e);const t=this._boundingSphere;return Math.max(0,o.Z.distance(t.center,e.camera.positionWC)-t.radius)},p.prototype.intersectPlane=function(e){return r.Z.defined("plane",e),n.Z.intersectPlane(this._boundingSphere,e)},p.prototype.update=function(e,t){o.Z.clone(e,this._boundingSphere.center),this._boundingSphere.radius=t},p.prototype.createDebugVolume=function(e){r.Z.defined("color",e);const t=new u.Z({radius:this.radius}),i=h.Z.fromTranslation(this.center,new h.Z.clone(h.Z.IDENTITY)),n=new a.Z({geometry:t,id:"outline",modelMatrix:i,attributes:{color:s.Z.fromColor(e)}});return new l.Z({geometryInstances:n,appearance:new d.Z({translucent:!1,flat:!0}),asynchronous:!1})};const f=p},64691:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(20176);function o(){}o.prototype.boundingVolume=void 0,o.prototype.boundingSphere=void 0,o.prototype.distanceToCamera=function(e){n.Z.throwInstantiationError()},o.prototype.intersectPlane=function(e){n.Z.throwInstantiationError()},o.prototype.createDebugVolume=function(e){n.Z.throwInstantiationError()};const r=o},34897:(e,t,i)=>{i.d(t,{Z:()=>h});var n=i(6785),o=i(88779),r=i(54485),s=i(92893),a=i(96507);function c(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),this._tilingScheme=(0,r.Z)(e.tilingScheme)?e.tilingScheme:new a.Z({ellipsoid:e.ellipsoid}),this._color=(0,o.Z)(e.color,n.Z.YELLOW),this._errorEvent=new s.Z,this._tileWidth=(0,o.Z)(e.tileWidth,256),this._tileHeight=(0,o.Z)(e.tileHeight,256),this._readyPromise=Promise.resolve(!0),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0}Object.defineProperties(c.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),c.prototype.getTileCredits=function(e,t,i){},c.prototype.requestImage=function(e,t,i,n){const o=document.createElement("canvas");o.width=256,o.height=256;const r=o.getContext("2d"),s=this._color.toCssColorString();return r.strokeStyle=s,r.lineWidth=2,r.strokeRect(1,1,255,255),r.font="bold 25px Arial",r.textAlign="center",r.fillStyle=s,r.fillText(`L: ${i}`,124,86),r.fillText(`X: ${e}`,124,136),r.fillText(`Y: ${t}`,124,186),Promise.resolve(o)},c.prototype.pickFeatures=function(e,t,i,n,o){};const h=c},52434:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(20176);function o(e){n.Z.throwInstantiationError()}o.prototype.isReady=n.Z.throwInstantiationError,o.prototype.shouldDiscardImage=n.Z.throwInstantiationError;const r=o},41737:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(54485),o=i(68502);function r(e,t,i){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=i}r.prototype.freeResources=function(){(0,n.Z)(this.readyImagery)&&this.readyImagery.releaseReference(),(0,n.Z)(this.loadingImagery)&&this.loadingImagery.releaseReference()},r.prototype.processStateMachine=function(e,t,i){const r=this.loadingImagery,s=r.imageryLayer;if(r.processStateMachine(t,!this.useWebMercatorT,i),r.state===o.Z.READY)return(0,n.Z)(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=s._calculateTextureTranslationAndScale(e,this),!0;let a,c=r.parent;for(;(0,n.Z)(c)&&(c.state!==o.Z.READY||!this.useWebMercatorT&&!(0,n.Z)(c.texture));)c.state!==o.Z.FAILED&&c.state!==o.Z.INVALID&&(a=a||c),c=c.parent;return this.readyImagery!==c&&((0,n.Z)(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=c,(0,n.Z)(c)&&(c.addReference(),this.textureTranslationAndScale=s._calculateTextureTranslationAndScale(e,this))),(r.state===o.Z.FAILED||r.state===o.Z.INVALID)&&(!(0,n.Z)(a)||(a.processStateMachine(t,!this.useWebMercatorT,i),!1))};const s=r},14506:(e,t,i)=>{i.d(t,{Z:()=>w});var n=i(59015),o=i(66866),r=i(88779),s=i(58587),a=i(54485),c=i(20176),h=i(64729),u=i(96507),d=i(34152),l=i(67197),p=i(21514),f=i(85002),m=i(67561),_=i(85933);function g(e){if(e=(0,r.Z)(e,r.Z.EMPTY_OBJECT),!(0,a.Z)(e.url))throw new c.Z("options.url is required.");const t=(0,s.Z)();let i;_.Z.call(this,t.promise),this._tmsResource=void 0,this._xmlResource=void 0,this._options=e,this._deferred=t,this._metadataError=void 0,this._metadataSuccess=this._metadataSuccess.bind(this),this._metadataFailure=this._metadataFailure.bind(this),this._requestMetadata=this._requestMetadata.bind(this);const n=this;Promise.resolve(e.url).then((function(e){i=l.Z.createIfNeeded(e),i.appendForwardSlash(),n._tmsResource=i,n._xmlResource=i.getDerivedResource({url:"tilemapresource.xml"}),n._requestMetadata()})).catch((function(e){t.reject(e)}))}function Z(e,t){return e.west<t.rectangle.west&&(e.west=t.rectangle.west),e.east>t.rectangle.east&&(e.east=t.rectangle.east),e.south<t.rectangle.south&&(e.south=t.rectangle.south),e.north>t.rectangle.north&&(e.north=t.rectangle.north),e}function y(e,t,i){const n=e.positionToTileXY(d.Z.southwest(t),i),o=e.positionToTileXY(d.Z.northeast(t),i);return(Math.abs(o.x-n.x)+1)*(Math.abs(o.y-n.y)+1)>4?0:i}(0,a.Z)(Object.create)&&(g.prototype=Object.create(_.Z.prototype),g.prototype.constructor=g),g.prototype._requestMetadata=function(){this._xmlResource.fetchXML().then(this._metadataSuccess).catch(this._metadataFailure)},g.prototype._metadataSuccess=function(e){const t=/tileformat/i,i=/tileset/i,s=/tilesets/i,c=/boundingbox/i;let l,_,g;const w=[],b=this._xmlResource;let v=this._metadataError;const x=this._deferred,S=this._requestMetadata,C=e.childNodes[0].childNodes;for(let e=0;e<C.length;e++)if(t.test(C.item(e).nodeName))l=C.item(e);else if(s.test(C.item(e).nodeName)){g=C.item(e);const t=C.item(e).childNodes;for(let e=0;e<t.length;e++)i.test(t.item(e).nodeName)&&w.push(t.item(e))}else c.test(C.item(e).nodeName)&&(_=C.item(e));let T;if(!(0,a.Z)(g)||!(0,a.Z)(_))return T=`Unable to find expected tilesets or bbox attributes in ${b.url}.`,v=f.Z.handleError(v,this,this.errorEvent,T,void 0,void 0,void 0,S),v.retry||x.reject(new p.Z(T)),void(this._metadataError=v);const E=this._options,I=(0,r.Z)(E.fileExtension,l.getAttribute("extension")),P=(0,r.Z)(E.tileWidth,parseInt(l.getAttribute("width"),10)),O=(0,r.Z)(E.tileHeight,parseInt(l.getAttribute("height"),10));let A=(0,r.Z)(E.minimumLevel,parseInt(w[0].getAttribute("order"),10));const L=(0,r.Z)(E.maximumLevel,parseInt(w[w.length-1].getAttribute("order"),10)),N=g.getAttribute("profile");let D=E.tilingScheme;if(!(0,a.Z)(D))if("geodetic"===N||"global-geodetic"===N)D=new u.Z({ellipsoid:E.ellipsoid});else{if("mercator"!==N&&"global-mercator"!==N)return T=`${b.url}specifies an unsupported profile attribute, ${N}.`,v=f.Z.handleError(v,this,this.errorEvent,T,void 0,void 0,void 0,S),v.retry||x.reject(new p.Z(T)),void(this._metadataError=v);D=new m.Z({ellipsoid:E.ellipsoid})}let M=d.Z.clone(E.rectangle);if(!(0,a.Z)(M)){let e,t,i,s;(0,r.Z)(E.flipXY,!1)?(i=new n.Z(parseFloat(_.getAttribute("miny")),parseFloat(_.getAttribute("minx"))),s=new n.Z(parseFloat(_.getAttribute("maxy")),parseFloat(_.getAttribute("maxx")))):(i=new n.Z(parseFloat(_.getAttribute("minx")),parseFloat(_.getAttribute("miny"))),s=new n.Z(parseFloat(_.getAttribute("maxx")),parseFloat(_.getAttribute("maxy"))));const a="geodetic"===N||"mercator"===N;if(D.projection instanceof h.Z||a)e=o.Z.fromDegrees(i.x,i.y),t=o.Z.fromDegrees(s.x,s.y);else{const n=D.projection;e=n.unproject(i),t=n.unproject(s)}M=new d.Z(e.longitude,e.latitude,t.longitude,t.latitude)}M=Z(M,D),A=y(D,M,A);const R=this._tmsResource.getDerivedResource({url:`{z}/{x}/{reverseY}.${I}`});x.resolve({url:R,tilingScheme:D,rectangle:M,tileWidth:P,tileHeight:O,minimumLevel:A,maximumLevel:L,tileDiscardPolicy:E.tileDiscardPolicy,credit:E.credit})},g.prototype._metadataFailure=function(e){const t=this._options,i=(0,r.Z)(t.fileExtension,"png"),n=(0,r.Z)(t.tileWidth,256),o=(0,r.Z)(t.tileHeight,256),s=t.maximumLevel,c=(0,a.Z)(t.tilingScheme)?t.tilingScheme:new m.Z({ellipsoid:t.ellipsoid});let h=(0,r.Z)(t.rectangle,c.rectangle);h=Z(h,c);const u=y(c,h,t.minimumLevel),d=this._tmsResource.getDerivedResource({url:`{z}/{x}/{reverseY}.${i}`});this._deferred.resolve({url:d,tilingScheme:c,rectangle:h,tileWidth:n,tileHeight:o,minimumLevel:u,maximumLevel:s,tileDiscardPolicy:t.tileDiscardPolicy,credit:t.credit})};const w=g},73385:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(17497),o=i(88779),r=i(8754);function s(e){const t=(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT)).tile,i=e.class;n.Z.typeOf.object("options.tile",t),n.Z.typeOf.object("options.class",i),this._class=i,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(s.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),s.prototype.hasProperty=function(e){return r.Z.hasProperty(e,this._properties,this._class)},s.prototype.hasPropertyBySemantic=function(e){return r.Z.hasPropertyBySemantic(e,this._properties,this._class)},s.prototype.getPropertyIds=function(e){return r.Z.getPropertyIds(this._properties,this._class,e)},s.prototype.getProperty=function(e){return r.Z.getProperty(e,this._properties,this._class)},s.prototype.setProperty=function(e,t){return r.Z.setProperty(e,t,this._properties,this._class)},s.prototype.getPropertyBySemantic=function(e){return r.Z.getPropertyBySemantic(e,this._properties,this._class)},s.prototype.setPropertyBySemantic=function(e,t){return r.Z.setPropertyBySemantic(e,t,this._properties,this._class)}},61057:(e,t,i)=>{i.d(t,{Z:()=>x});var n=i(52351),o=i(66522),r=i(93517),s=i(17497),a=i(41631),c=i(78224),h=i(39109),u=i(71118),d=i(22874),l=i(42428),p=i(73020),f=i(27401);const m=new r.Z,_=new r.Z,g=new r.Z,Z=new r.Z;function y(e,t,i){i=r.Z.cross(e,t,i);const n=r.Z.magnitude(i);return r.Z.multiplyByScalar(i,d.Z.EPSILON7/n,i)}function w(e,t){const i=r.Z.normalize(e,Z);return y(e,r.Z.equalsEpsilon(i,r.Z.UNIT_X,d.Z.EPSILON6)?r.Z.UNIT_Y:r.Z.UNIT_X,t)}function b(e){let t=h.Z.getColumn(e,0,m),i=h.Z.getColumn(e,1,_),n=h.Z.getColumn(e,2,g);const o=r.Z.equals(t,r.Z.ZERO),s=r.Z.equals(i,r.Z.ZERO),a=r.Z.equals(n,r.Z.ZERO);return o||s||a?o&&s&&a?(e[0]=d.Z.EPSILON7,e[4]=d.Z.EPSILON7,e[8]=d.Z.EPSILON7,e):(!o||s||a?o||!s||a?o||s||!a?o?s?a||(t=w(n,t),i=y(n,t,i)):(t=w(i,t),n=y(i,t,n)):(i=w(t,i),n=y(i,t,n)):n=y(i,t,n):i=y(t,n,i):t=y(i,n,t),h.Z.setColumn(e,0,t,e),h.Z.setColumn(e,1,i,e),h.Z.setColumn(e,2,n,e),e):e}function v(e,t){t=b(t),this._orientedBoundingBox=new l.Z(e,t),this._boundingSphere=n.Z.fromOrientedBoundingBox(this._orientedBoundingBox)}Object.defineProperties(v.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),v.prototype.distanceToCamera=function(e){return s.Z.defined("frameState",e),Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))},v.prototype.intersectPlane=function(e){return s.Z.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},v.prototype.update=function(e,t){r.Z.clone(e,this._orientedBoundingBox.center),t=b(t),h.Z.clone(t,this._orientedBoundingBox.halfAxes),n.Z.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)},v.prototype.createDebugVolume=function(e){s.Z.defined("color",e);const t=new o.Z({minimum:new r.Z(-1,-1,-1),maximum:new r.Z(1,1,1)}),i=u.Z.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),n=new c.Z({geometry:t,id:"outline",modelMatrix:i,attributes:{color:a.Z.fromColor(e)}});return new f.Z({geometryInstances:n,appearance:new p.Z({translucent:!1,flat:!0}),asynchronous:!1})};const x=v},20850:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(54485);function o(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function r(e,t){const i=t.replacementPrevious,n=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=n),t===e.head?e.head=n:i.replacementNext=n,t===e.tail?e.tail=i:n.replacementPrevious=i,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}o.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},o.prototype.trimTiles=function(e){let t=this.tail,i=!0;for(;i&&(0,n.Z)(this._lastBeforeStartOfFrame)&&this.count>e&&(0,n.Z)(t);){i=t!==this._lastBeforeStartOfFrame;const e=t.replacementPrevious;t.eligibleForUnloading&&(t.freeResources(),r(this,t)),t=e}},o.prototype.markTileRendered=function(e){const t=this.head;if(t!==e){if(++this.count,!(0,n.Z)(t))return e.replacementPrevious=void 0,e.replacementNext=void 0,this.head=e,void(this.tail=e);((0,n.Z)(e.replacementPrevious)||(0,n.Z)(e.replacementNext))&&r(this,e),e.replacementPrevious=void 0,e.replacementNext=t,t.replacementPrevious=e,this.head=e}else e===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=e.replacementNext)};const s=o},29159:(e,t,i)=>{i.d(t,{Z:()=>o});const n={NONE:0,CULLED:1,RENDERED:2,REFINED:3,RENDERED_AND_KICKED:6,REFINED_AND_KICKED:7,CULLED_BUT_NEEDED:9,wasKicked:function(e){return e>=n.RENDERED_AND_KICKED},originalResult:function(e){return 3&e},kick:function(e){return 4|e}},o=n},80985:(e,t,i)=>{i.d(t,{Z:()=>n});const n=Object.freeze({START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3})},87329:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(90332);function o(e,t,i,n){this._tileset=e,this._tile=t,this._resource=i,this.featurePropertiesDirty=!1,this._metadata=void 0,this._group=void 0,this._readyPromise=function(e,t){return e._tileset.loadTileset(e._resource,t,e._tile),Promise.resolve(e)}(this,n)}Object.defineProperties(o.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),o.prototype.hasProperty=function(e,t){return!1},o.prototype.getFeature=function(e){},o.prototype.applyDebugSettings=function(e,t){},o.prototype.applyStyle=function(e){},o.prototype.update=function(e,t){},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return(0,n.Z)(this)};const r=o},47347:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(17497),o=i(88779),r=i(54485),s=i(8754);function a(e){const t=(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT)).tileset,i=e.class;n.Z.typeOf.object("options.tileset",t),n.Z.typeOf.object("options.class",i);const s=(0,r.Z)(t.properties)?t.properties:{};this._class=i,this._properties=s,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(a.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.prototype.hasProperty=function(e){return s.Z.hasProperty(e,this._properties,this._class)},a.prototype.hasPropertyBySemantic=function(e){return s.Z.hasPropertyBySemantic(e,this._properties,this._class)},a.prototype.getPropertyIds=function(e){return s.Z.getPropertyIds(this._properties,this._class,e)},a.prototype.getProperty=function(e){return s.Z.getProperty(e,this._properties,this._class)},a.prototype.setProperty=function(e,t){return s.Z.setProperty(e,t,this._properties,this._class)},a.prototype.getPropertyBySemantic=function(e){return s.Z.getPropertyBySemantic(e,this._properties,this._class)},a.prototype.setPropertyBySemantic=function(e,t){return s.Z.setPropertyBySemantic(e,t,this._properties,this._class)};const c=a},35815:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(17497),o=i(88779),r=i(54485),s=i(20176),a=i(97262),c=i(51625),h=i(22041);function u(e){e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),n.Z.typeOf.object("options.clock",e.clock),n.Z.typeOf.object("options.times",e.times),n.Z.typeOf.func("options.requestImageFunction",e.requestImageFunction),n.Z.typeOf.func("options.reloadFunction",e.reloadFunction),this._tileCache={},this._tilesRequestedForInterval=[];const t=this._clock=e.clock;this._times=e.times,this._requestImageFunction=e.requestImageFunction,this._reloadFunction=e.reloadFunction,this._currentIntervalIndex=-1,t.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(t)}function d(e,t,i){return`${e}-${t}-${i}`}function l(e){const t=e._times;if(!(0,r.Z)(t))return;const i=e._clock,n=i.currentTime,o=i.canAnimate&&i.shouldAnimate,s=i.multiplier;if(!o&&0!==s)return;let c,h=t.indexOf(n);if(h<0)return;const u=t.get(h);return s>0?(c=a.Z.secondsDifference(u.stop,n),++h):(c=a.Z.secondsDifference(u.start,n),--h),c/=s,h>=0&&c<=5?t.get(h):void 0}function p(e,t,i){const n=e._times.indexOf(i.start),o=e._tileCache;let s=o[n];(0,r.Z)(s)||(s=o[n]={});const a=t.key;if((0,r.Z)(s[a]))return!0;const u=function(e){const t=e.split("-");if(3===t.length)return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}(a),d=new c.Z({throttle:!1,throttleByServer:!0,type:h.Z.IMAGERY,priorityFunction:t.priorityFunction}),l=e._requestImageFunction(u.x,u.y,u.level,d,i);return!!(0,r.Z)(l)&&(s[a]={promise:l,request:d},!0)}Object.defineProperties(u.prototype,{clock:{get:function(){return this._clock},set:function(e){if(!(0,r.Z)(e))throw new s.Z("value is required.");this._clock!==e&&(this._clock=e,this._clockOnTick(e),this._reloadFunction())}},times:{get:function(){return this._times},set:function(e){if(!(0,r.Z)(e))throw new s.Z("value is required.");this._times!==e&&(this._times=e,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}}),u.prototype.getFromCache=function(e,t,i,n){const o=d(e,t,i);let s;const a=this._tileCache[this._currentIntervalIndex];if((0,r.Z)(a)&&(0,r.Z)(a[o])){const e=a[o];s=e.promise.catch((function(t){throw n.state=e.request.state,t})),delete a[o]}return s},u.prototype.checkApproachingInterval=function(e,t,i,n){const o=d(e,t,i),s=this._tilesRequestedForInterval,a=l(this),c={key:o,priorityFunction:n.priorityFunction};(0,r.Z)(a)&&p(this,c,a)||s.push(c),s.length>=512&&s.splice(0,256)},u.prototype._clockOnTick=function(e){const t=e.currentTime,i=this._times.indexOf(t),n=this._currentIntervalIndex;if(i!==n){const e=this._tileCache[n];for(const t in e)e.hasOwnProperty(t)&&e[t].request.cancel();return delete this._tileCache[n],this._tilesRequestedForInterval=[],this._currentIntervalIndex=i,void this._reloadFunction()}const o=l(this);if((0,r.Z)(o)){const e=this._tilesRequestedForInterval;let t=!0;for(;t&&0!==e.length;){const i=e.pop();t=p(this,i,o),t||e.push(i)}}};const f=u},66539:(e,t,i)=>{i.d(t,{Z:()=>R});var n=i(65730),o=i(17497),r=i(51138),s=i(88779),a=i(54485),c=i(90332),h=i(92893),u=i(41780),d=i(97262),l=i(22874),p=i(71118),f=i(67197),m=i(53425),_=i(9224),g=i(83714),Z=i(85803),y=i(18061),w=i(49616);function b(e){e=(0,s.Z)(e,s.Z.EMPTY_OBJECT),o.Z.typeOf.object("options.clock",e.clock),o.Z.typeOf.object("options.intervals",e.intervals),this.show=(0,s.Z)(e.show,!0),this.modelMatrix=p.Z.clone((0,s.Z)(e.modelMatrix,p.Z.IDENTITY)),this.shadows=(0,s.Z)(e.shadows,w.Z.ENABLED),this.maximumMemoryUsage=(0,s.Z)(e.maximumMemoryUsage,256),this.shading=new Z.Z(e.shading),this.style=e.style,this.frameFailed=new h.Z,this.frameChanged=new h.Z,this._clock=e.clock,this._intervals=e.intervals,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._pointCloudEyeDomeLighting=new g.Z,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._resolveReadyPromise=void 0;const t=this;this._readyPromise=new Promise((function(e){t._resolveReadyPromise=e})),this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=(0,n.Z)(new Array(5),0),this._runningAverage=0}function v(e){return`uniform vec4 czm_pickColor;\n${e}`}function x(){return"czm_pickColor"}Object.defineProperties(b.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){m.Z.setOwner(e,this,"_clippingPlanes")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if((0,a.Z)(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}},readyPromise:{get:function(){return this._readyPromise}}}),b.prototype.makeStyleDirty=function(){this._styleDirty=!0},b.prototype._getAverageLoadTime=function(){return 0===this._runningLength?.05:this._runningAverage};const S=new d.Z;function C(e){const t=e._clock,i=t.canAnimate&&t.shouldAnimate,n=t.multiplier;return i?n:0}function T(e,t){return e._intervals.indexOf(t.start)}function E(e,t,i){const n=T(e,t),o=e._frames;let s=o[n];if(!(0,a.Z)(s)){const c=t.data.transform,h=(0,a.Z)(c)?p.Z.fromArray(c):void 0,d=t.data.uri;s={pointCloud:void 0,transform:h,timestamp:(0,u.Z)(),sequential:!0,ready:!1,touchedFrameNumber:i.frameNumber},o[n]=s,f.Z.fetchArrayBuffer({url:d}).then((function(t){var i;return s.pointCloud=new _.Z({arrayBuffer:t,cull:!0,fragmentShaderLoaded:v,uniformMapLoaded:(i=e,function(e){return(0,r.Z)(e,{czm_pickColor:function(){return i._pickId.color}})}),pickIdLoaded:x}),s.pointCloud.readyPromise})).catch(function(e,t){return function(i){const n=(0,a.Z)(i.message)?i.message:i.toString();e.frameFailed.numberOfListeners>0&&e.frameFailed.raiseEvent({uri:t,message:n})}}(e,d))}return s}function I(e,t,i,n){t.touchedFrameNumber<n.frameNumber-1&&(t.sequential=!1);const o=t.pointCloud;if((0,a.Z)(o)&&!t.ready){const r=n.commandList,s=r.length;if(A(e,t,i,n),o.ready&&(t.ready=!0,e._totalMemoryUsageInBytes+=o.geometryByteLength,r.length=s,t.sequential)){!function(e,t){e._runningSum+=t,e._runningSum-=e._runningSamples[e._runningIndex],e._runningSamples[e._runningIndex]=t,e._runningLength=Math.min(e._runningLength+1,e._runningSamples.length),e._runningIndex=(e._runningIndex+1)%e._runningSamples.length,e._runningAverage=e._runningSum/e._runningLength}(e,((0,u.Z)()-t.timestamp)/1e3)}}t.touchedFrameNumber=n.frameNumber}const P=new p.Z;const O=new Z.Z;function A(e,t,i,n){const o=(0,s.Z)(e.shading,O),r=t.pointCloud,c=(0,s.Z)(t.transform,p.Z.IDENTITY);r.modelMatrix=p.Z.multiplyTransformation(e.modelMatrix,c,P),r.style=e.style,r.time=i.timeSinceLoad,r.shadows=e.shadows,r.clippingPlanes=e._clippingPlanes,r.isClipped=i.isClipped,r.attenuation=o.attenuation,r.backFaceCulling=o.backFaceCulling,r.normalShading=o.normalShading,r.geometricError=function(e,t){const i=e.shading;return(0,a.Z)(i)&&(0,a.Z)(i.baseResolution)?i.baseResolution:(0,a.Z)(t.boundingSphere)?l.Z.cbrt(t.boundingSphere.volume()/t.pointsLength):0}(e,r),r.geometricErrorScale=o.geometricErrorScale,r.maximumAttenuation=function(e){const t=e.shading;return(0,a.Z)(t)&&(0,a.Z)(t.maximumAttenuation)?t.maximumAttenuation:10}(e),r.update(n),t.touchedFrameNumber=n.frameNumber}function L(e,t,i,n){I(e,E(e,t,n),i,n)}function N(e,t){const i=e._frames,n=i.length;for(let o=0;o<n;++o){const n=i[o];if((0,a.Z)(n)&&(!(0,a.Z)(t)||t(n))){const t=n.pointCloud;n.ready&&(e._totalMemoryUsageInBytes-=t.geometryByteLength),(0,a.Z)(t)&&t.destroy(),n===e._lastRenderedFrame&&(e._lastRenderedFrame=void 0),i[o]=void 0}}}function D(e,t,i,n,o){return!!(0,a.Z)(i)&&(!!i.ready||(L(e,t,n,o),i.ready))}const M={timeSinceLoad:0,isClipped:!1,clippingPlanesDirty:!1};b.prototype.update=function(e){if(e.mode===y.Z.MORPHING)return;if(!this.show)return;(0,a.Z)(this._pickId)||(this._pickId=e.context.createPickId({primitive:this})),(0,a.Z)(this._loadTimestamp)||(this._loadTimestamp=d.Z.clone(e.time));const t=Math.max(1e3*d.Z.secondsDifference(e.time,this._loadTimestamp),0),i=this._clippingPlanes;let n=0,o=!1;const r=(0,a.Z)(i)&&i.enabled;r&&(i.update(e),n=i.clippingPlanesState),this._clippingPlanesState!==n&&(this._clippingPlanesState=n,o=!0);const s=this._styleDirty;this._styleDirty=!1,(o||s)&&function(e,t,i){const n=e._frames,o=n.length;for(let e=0;e<o;++e){const o=n[e];(0,a.Z)(o)&&(0,a.Z)(o.pointCloud)&&(o.pointCloud.clippingPlanesDirty=t,o.pointCloud.styleDirty=i)}}(this,o,s),M.timeSinceLoad=t,M.isClipped=r;const c=this.shading,h=this._pointCloudEyeDomeLighting,u=e.commandList,l=u.length;let p=this._previousInterval,f=this._nextInterval;const m=function(e){const t=e._intervals,i=e._clock.currentTime,n=t.indexOf(i);return t.get(n)}(this);if(!(0,a.Z)(m))return;let _=!1;const g=C(this),Z=0===g;g!==this._clockMultiplier&&(_=!0,this._clockMultiplier=g),(0,a.Z)(p)&&!Z||(p=m),(!(0,a.Z)(f)||_||function(e,t,i){const n=C(e),o=T(e,t),r=T(e,i);return n>=0?o>=r:o<=r}(this,m,f))&&(f=function(e,t){const i=e._intervals,n=e._clock,o=C(e);if(0===o)return;const r=e._getAverageLoadTime(),s=d.Z.addSeconds(n.currentTime,r*o,S);let a=i.indexOf(s);return a===T(e,t)&&(o>=0?++a:--a),i.get(a)}(this,m)),p=function(e,t,i,n,o){let r,s,a;const c=e._intervals,h=e._frames,u=T(e,i),d=T(e,t);if(u>=d){for(r=u;r>=d;--r)if(s=c.get(r),a=h[r],D(e,s,a,n,o))return s}else for(r=u;r<=d;++r)if(s=c.get(r),a=h[r],D(e,s,a,n,o))return s;return t}(this,p,m,M,e);let w=function(e,t){const i=T(e,t),n=e._frames[i];if((0,a.Z)(n)&&n.ready)return n}(this,p);(0,a.Z)(w)||(L(this,p,M,e),w=this._lastRenderedFrame),(0,a.Z)(w)&&A(this,w,M,e),(0,a.Z)(f)&&L(this,f,M,e);const b=this;(0,a.Z)(w)&&!(0,a.Z)(this._lastRenderedFrame)&&e.afterRender.push((function(){b._resolveReadyPromise(b)})),(0,a.Z)(w)&&w!==this._lastRenderedFrame&&b.frameChanged.numberOfListeners>0&&e.afterRender.push((function(){b.frameChanged.raiseEvent(b)})),this._previousInterval=p,this._nextInterval=f,this._lastRenderedFrame=w;this._totalMemoryUsageInBytes>1024*this.maximumMemoryUsage*1024&&N(this,function(e){return function(t){return t.touchedFrameNumber<e.frameNumber}}(e));const v=u.length-l;(0,a.Z)(c)&&c.attenuation&&c.eyeDomeLighting&&v>0&&h.update(e,l,c,this.boundingSphere)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return N(this),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),(0,c.Z)(this)};const R=b},83936:(e,t,i)=>{i.d(t,{Z:()=>o});const n={REINHARD:0,MODIFIED_REINHARD:1,FILMIC:2,ACES:3,validate:function(e){return e===n.REINHARD||e===n.MODIFIED_REINHARD||e===n.FILMIC||e===n.ACES}},o=Object.freeze(n)},90852:(e,t,i)=>{i.d(t,{Z:()=>T});var n=i(23114),o=i(6785),r=i(54485),s=i(90332),a=i(91166),c=i(74366),h=i(71087),u=i(37791),d=i(1577),l=i(27400),p=i(74064),f=i(28696),m=i(7048),_=i(47334),g=i(28814),Z=i(73655),y=i(995),w=i(84067),b=i(88307);function v(e){this._drawClassificationFBO=new u.Z({createDepthAttachments:!1}),this._accumulationFBO=new u.Z({createDepthAttachments:!1}),this._packFBO=new u.Z,this._opaqueDepthStencilTexture=void 0,this._textureToComposite=void 0,this._translucentDepthStencilTexture=void 0,this._packDepthCommand=void 0,this._accumulateCommand=void 0,this._compositeCommand=void 0,this._copyCommand=void 0,this._clearColorCommand=new c.Z({color:new o.Z(0,0,0,0),owner:this}),this._clearDepthStencilCommand=new c.Z({depth:1,stencil:0,owner:this}),this._supported=e.depthTexture,this._viewport=new n.Z,this._rsDepth=void 0,this._rsAccumulate=void 0,this._rsComp=void 0,this._useScissorTest=void 0,this._scissorRectangle=void 0,this._hasTranslucentDepth=!1,this._frustumsDrawn=0}function x(e){e._textureToComposite=void 0,e._translucentDepthStencilTexture=e._translucentDepthStencilTexture&&!e._translucentDepthStencilTexture.isDestroyed()&&e._translucentDepthStencilTexture.destroy()}function S(e){e._drawClassificationFBO.destroy(),e._accumulationFBO.destroy(),e._packFBO.destroy()}function C(e,t,i,o){if(!e.isSupported())return;e._opaqueDepthStencilTexture=o;const s=e._opaqueDepthStencilTexture.width,c=e._opaqueDepthStencilTexture.height;let u,d;if(e._drawClassificationFBO.isDirty(s,c)&&(function(e,t,i,n){x(e),e._translucentDepthStencilTexture=new _.Z({context:t,width:i,height:n,pixelFormat:a.Z.DEPTH_STENCIL,pixelDatatype:l.Z.UNSIGNED_INT_24_8,sampler:f.Z.NEAREST})}(e,t,s,c),function(e,t,i,n){S(e),e._drawClassificationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._drawClassificationFBO.update(t,i,n),e._accumulationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._accumulationFBO.update(t,i,n),e._packFBO.update(t,i,n)}(e,t,s,c)),(0,r.Z)(e._packDepthCommand)||(u=new m.Z({sources:[g.Z]}),d={u_opaqueDepthTexture:function(){return e._opaqueDepthStencilTexture},u_translucentDepthTexture:function(){return e._translucentDepthStencilTexture}},e._packDepthCommand=t.createViewportQuadCommand(u,{uniformMap:d,owner:e})),!(0,r.Z)(e._compositeCommand)){u=new m.Z({sources:[Z.Z]}),d={colorTexture:function(){return e._textureToComposite}},e._compositeCommand=t.createViewportQuadCommand(u,{uniformMap:d,owner:e});const i=e._compositeCommand,n=i.shaderProgram,o=t.shaderCache.createDerivedShaderProgram(n,"pick",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:new m.Z({sources:u.sources,defines:["PICK"]}),attributeLocations:n._attributeLocations}),r=h.Z.shallowClone(i);r.shaderProgram=o,i.derivedCommands.pick=r}(0,r.Z)(e._copyCommand)||(u=new m.Z({sources:[Z.Z]}),d={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._copyCommand=t.createViewportQuadCommand(u,{uniformMap:d,owner:e})),(0,r.Z)(e._accumulateCommand)||(u=new m.Z({sources:[Z.Z]}),d={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._accumulateCommand=t.createViewportQuadCommand(u,{uniformMap:d,owner:e})),e._viewport.width=s,e._viewport.height=c;const v=!n.Z.equals(e._viewport,i.viewport);let C=v!==e._useScissorTest;e._useScissorTest=v,n.Z.equals(e._scissorRectangle,i.viewport)||(e._scissorRectangle=n.Z.clone(i.viewport,e._scissorRectangle),C=!0),(0,r.Z)(e._rsDepth)&&n.Z.equals(e._viewport,e._rsDepth.viewport)&&!C||(e._rsDepth=p.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),(0,r.Z)(e._packDepthCommand)&&(e._packDepthCommand.renderState=e._rsDepth),(0,r.Z)(e._rsAccumulate)&&n.Z.equals(e._viewport,e._rsAccumulate.viewport)&&!C||(e._rsAccumulate=p.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:b.Z.EQUAL,reference:w.Z.CESIUM_3D_TILE_MASK}})),(0,r.Z)(e._accumulateCommand)&&(e._accumulateCommand.renderState=e._rsAccumulate),(0,r.Z)(e._rsComp)&&n.Z.equals(e._viewport,e._rsComp.viewport)&&!C||(e._rsComp=p.Z.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:y.Z.ALPHA_BLEND})),(0,r.Z)(e._compositeCommand)&&(e._compositeCommand.renderState=e._rsComp,e._compositeCommand.derivedCommands.pick.renderState=e._rsComp)}Object.defineProperties(v.prototype,{hasTranslucentDepth:{get:function(){return this._hasTranslucentDepth}}}),v.prototype.executeTranslucentCommands=function(e,t,i,n,o){const r=n.length;let s,a;const c=e.frameState.useLogDepth,h=e.context,u=i.framebuffer;for(a=0;a<r;++a)if(s=n[a],s=c?s.derivedCommands.logDepth.command:s,s.depthForTranslucentClassification){this._hasTranslucentDepth=!0;break}if(this._hasTranslucentDepth){for(C(this,h,i,o),i.framebuffer=this._drawClassificationFBO.framebuffer,this._clearDepthStencilCommand.execute(h,i),a=0;a<r;++a){if(s=n[a],s=c?s.derivedCommands.logDepth.command:s,!s.depthForTranslucentClassification)continue;t(s.derivedCommands.depth.depthOnlyCommand,e,h,i)}this._frustumsDrawn+=this._hasTranslucentDepth?1:0,this._hasTranslucentDepth&&(i.framebuffer=this._packFBO.framebuffer,this._packDepthCommand.execute(h,i)),i.framebuffer=u}},v.prototype.executeClassificationCommands=function(e,t,i,n){if(!this._hasTranslucentDepth)return;const o=e.context,r=o.uniformState,s=i.framebuffer;2===this._frustumsDrawn&&(i.framebuffer=this._accumulationFBO.framebuffer,this._copyCommand.execute(o,i)),i.framebuffer=this._drawClassificationFBO.framebuffer,this._frustumsDrawn>1&&this._clearColorCommand.execute(o,i),r.updatePass(d.Z.CESIUM_3D_TILE_CLASSIFICATION);const a=r.globeDepthTexture;r.globeDepthTexture=this._packFBO.getColorTexture();const c=n.commands[d.Z.CESIUM_3D_TILE_CLASSIFICATION],h=n.indices[d.Z.CESIUM_3D_TILE_CLASSIFICATION];for(let n=0;n<h;++n)t(c[n],e,o,i);r.globeDepthTexture=a,i.framebuffer=s,1!==this._frustumsDrawn&&(i.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(o,i),i.framebuffer=s)},v.prototype.execute=function(e,t){if(!this._hasTranslucentDepth)return;1===this._frustumsDrawn?this._textureToComposite=this._drawClassificationFBO.getColorTexture():this._textureToComposite=this._accumulationFBO.getColorTexture();(e.frameState.passes.pick?this._compositeCommand.derivedCommands.pick:this._compositeCommand).execute(e.context,t),function(e,t,i){if(!e._hasTranslucentDepth)return;const n=i.framebuffer;i.framebuffer=e._drawClassificationFBO.framebuffer,e._clearColorCommand.execute(t._context,i),i.framebuffer=n,e._frustumsDrawn>1&&(i.framebuffer=e._accumulationFBO.framebuffer,e._clearColorCommand.execute(t._context,i));e._hasTranslucentDepth=!1,e._frustumsDrawn=0}(this,e,t)},v.prototype.isSupported=function(){return this._supported},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return x(this),S(this),(0,r.Z)(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),(0,r.Z)(this._packDepthCommand)&&(this._packDepthCommand.shaderProgram=this._packDepthCommand.shaderProgram&&this._packDepthCommand.shaderProgram.destroy()),(0,s.Z)(this)};const T=v},92287:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(55077),o=i(88779),r=i(54485),s=i(20176),a=i(45971),c=i(41780),h=i(4230),u=i(41638);function d(e,t,i,o,r,s,a,c,h,u){this._tweens=e,this._tweenjs=t,this._startObject=(0,n.Z)(i),this._stopObject=(0,n.Z)(o),this._duration=r,this._delay=s,this._easingFunction=a,this._update=c,this._complete=h,this.cancel=u,this.needsStart=!0}function l(){this._tweens=[]}Object.defineProperties(d.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),d.prototype.cancelTween=function(){this._tweens.remove(this)},Object.defineProperties(l.prototype,{length:{get:function(){return this._tweens.length}}}),l.prototype.add=function(e){if(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT),!(0,r.Z)(e.startObject)||!(0,r.Z)(e.stopObject))throw new s.Z("options.startObject and options.stopObject are required.");if(!(0,r.Z)(e.duration)||e.duration<0)throw new s.Z("options.duration is required and must be positive.");if(0===e.duration)return(0,r.Z)(e.complete)&&e.complete(),new d(this);const t=e.duration/h.Z.SECONDS_PER_MILLISECOND,i=(0,o.Z)(e.delay,0),c=i/h.Z.SECONDS_PER_MILLISECOND,l=(0,o.Z)(e.easingFunction,a.Z.LINEAR_NONE),p=e.startObject,f=new u.Z.Tween(p);f.to((0,n.Z)(e.stopObject),t),f.delay(c),f.easing(l),(0,r.Z)(e.update)&&f.onUpdate((function(){e.update(p)})),f.onComplete((0,o.Z)(e.complete,null)),f.repeat((0,o.Z)(e._repeat,0));const m=new d(this,f,e.startObject,e.stopObject,e.duration,i,l,e.update,e.complete,e.cancel);return this._tweens.push(m),m},l.prototype.addProperty=function(e){const t=(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT)).object,i=e.property,n=e.startValue,a=e.stopValue;if(!(0,r.Z)(t)||!(0,r.Z)(e.property))throw new s.Z("options.object and options.property are required.");if(!(0,r.Z)(t[i]))throw new s.Z("options.object must have the specified property.");if(!(0,r.Z)(n)||!(0,r.Z)(a))throw new s.Z("options.startValue and options.stopValue are required.");return this.add({startObject:{value:n},stopObject:{value:a},duration:(0,o.Z)(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){t[i]=e.value},complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},l.prototype.addAlpha=function(e){const t=(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT)).material;if(!(0,r.Z)(t))throw new s.Z("options.material is required.");const i=[];for(const e in t.uniforms)t.uniforms.hasOwnProperty(e)&&(0,r.Z)(t.uniforms[e])&&(0,r.Z)(t.uniforms[e].alpha)&&i.push(e);if(0===i.length)throw new s.Z("material has no properties with alpha components.");return this.add({startObject:{alpha:(0,o.Z)(e.startValue,0)},stopObject:{alpha:(0,o.Z)(e.stopValue,1)},duration:(0,o.Z)(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){const n=i.length;for(let o=0;o<n;++o)t.uniforms[i[o]].alpha=e.alpha},complete:e.complete,cancel:e.cancel})},l.prototype.addOffsetIncrement=function(e){const t=(e=(0,o.Z)(e,o.Z.EMPTY_OBJECT)).material;if(!(0,r.Z)(t))throw new s.Z("material is required.");if(!(0,r.Z)(t.uniforms.offset))throw new s.Z("material.uniforms must have an offset property.");const i=t.uniforms;return this.addProperty({object:i,property:"offset",startValue:i.offset,stopValue:i.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},l.prototype.remove=function(e){if(!(0,r.Z)(e))return!1;const t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),(0,r.Z)(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},l.prototype.removeAll=function(){const e=this._tweens;for(let t=0;t<e.length;++t){const i=e[t];i.tweenjs.stop(),(0,r.Z)(i.cancel)&&i.cancel()}e.length=0},l.prototype.contains=function(e){return(0,r.Z)(e)&&-1!==this._tweens.indexOf(e)},l.prototype.get=function(e){if(!(0,r.Z)(e))throw new s.Z("index is required.");return this._tweens[e]},l.prototype.update=function(e){const t=this._tweens;let i=0;for(e=(0,r.Z)(e)?e/h.Z.SECONDS_PER_MILLISECOND:(0,c.Z)();i<t.length;){const n=t[i],o=n.tweenjs;n.needsStart?(n.needsStart=!1,o.start(e)):o.update(e)?i++:(o.stop(),t.splice(i,1))}};const p=l},85933:(e,t,i)=>{i.d(t,{Z:()=>F});var n=i(59015),o=i(93517),r=i(66866),s=i(51138),a=i(78505),c=i(88779),h=i(54485),u=i(20176),d=i(92893),l=i(64729),p=i(22874),f=i(34152),m=i(67197),_=i(67561),g=i(20709);const Z=/{[^}]+}/g,y={x:function(e,t,i,n){return P(e,"{x}",t)},y:function(e,t,i,n){return P(e,"{y}",i)},z:function(e,t,i,n){return P(e,"{z}",n)},s:function(e,t,i,n){const o=(t+i+n)%e._subdomains.length;return e._subdomains[o]},reverseX:function(e,t,i,n){const o=e.tilingScheme.getNumberOfXTilesAtLevel(n)-t-1;return P(e,"{reverseX}",o)},reverseY:function(e,t,i,n){const o=e.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1;return P(e,"{reverseY}",o)},reverseZ:function(e,t,i,n){const o=e.maximumLevel,r=(0,h.Z)(o)&&n<o?o-n-1:n;return P(e,"{reverseZ}",r)},westDegrees:function(e,t,i,n){return O(e,t,i,n),x.west},southDegrees:function(e,t,i,n){return O(e,t,i,n),x.south},eastDegrees:function(e,t,i,n){return O(e,t,i,n),x.east},northDegrees:function(e,t,i,n){return O(e,t,i,n),x.north},westProjected:function(e,t,i,n){return A(e,t,i,n),C.west},southProjected:function(e,t,i,n){return A(e,t,i,n),C.south},eastProjected:function(e,t,i,n){return A(e,t,i,n),C.east},northProjected:function(e,t,i,n){return A(e,t,i,n),C.north},width:function(e,t,i,n){return e.tileWidth},height:function(e,t,i,n){return e.tileHeight}},w=(0,s.Z)(y,{i:function(e,t,i,n,o,r,s){return D(e,t,i,n,o,r),E.x},j:function(e,t,i,n,o,r,s){return D(e,t,i,n,o,r),E.y},reverseI:function(e,t,i,n,o,r,s){return D(e,t,i,n,o,r),e.tileWidth-E.x-1},reverseJ:function(e,t,i,n,o,r,s){return D(e,t,i,n,o,r),e.tileHeight-E.y-1},longitudeDegrees:function(e,t,i,n,o,r,s){return p.Z.toDegrees(o)},latitudeDegrees:function(e,t,i,n,o,r,s){return p.Z.toDegrees(r)},longitudeProjected:function(e,t,i,n,o,r,s){return R(e,t,i,n,o,r),N.x},latitudeProjected:function(e,t,i,n,o,r,s){return R(e,t,i,n,o,r),N.y},format:function(e,t,i,n,o,r,s){return s}});function b(e){if(!(0,h.Z)(e))throw new u.Z("options is required.");if(!(0,h.Z)(e.then)&&!(0,h.Z)(e.url))throw new u.Z("options is required.");this._errorEvent=new d.Z,this._resource=void 0,this._urlSchemeZeroPadding=void 0,this._pickFeaturesResource=void 0,this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._minimumLevel=void 0,this._tilingScheme=void 0,this._rectangle=void 0,this._tileDiscardPolicy=void 0,this._credit=void 0,this._hasAlphaChannel=void 0,this._readyPromise=void 0,this._tags=void 0,this._pickFeaturesTags=void 0,this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this.enablePickFeatures=!0,this.reinitialize(e)}Object.defineProperties(b.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this.ready)throw new u.Z("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this.ready)throw new u.Z("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this.ready)throw new u.Z("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this.ready)throw new u.Z("minimumLevel must not be called before the imagery provider is ready.");return this._minimumLevel}},tilingScheme:{get:function(){if(!this.ready)throw new u.Z("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this.ready)throw new u.Z("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this.ready)throw new u.Z("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return(0,h.Z)(this._resource)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){if(!this.ready)throw new u.Z("credit must not be called before the imagery provider is ready.");return this._credit}},hasAlphaChannel:{get:function(){if(!this.ready)throw new u.Z("hasAlphaChannel must not be called before the imagery provider is ready.");return this._hasAlphaChannel}}}),b.prototype.reinitialize=function(e){const t=this;t._readyPromise=Promise.resolve(e).then((function(e){if(!(0,h.Z)(e))throw new u.Z("options is required.");if(!(0,h.Z)(e.url))throw new u.Z("options.url is required.");const i=e.customTags,n=(0,s.Z)(y,i),o=(0,s.Z)(w,i),r=m.Z.createIfNeeded(e.url),d=m.Z.createIfNeeded(e.pickFeaturesUrl);t.enablePickFeatures=(0,c.Z)(e.enablePickFeatures,t.enablePickFeatures),t._urlSchemeZeroPadding=(0,c.Z)(e.urlSchemeZeroPadding,t.urlSchemeZeroPadding),t._tileDiscardPolicy=e.tileDiscardPolicy,t._getFeatureInfoFormats=e.getFeatureInfoFormats,t._subdomains=e.subdomains,Array.isArray(t._subdomains)?t._subdomains=t._subdomains.slice():(0,h.Z)(t._subdomains)&&t._subdomains.length>0?t._subdomains=t._subdomains.split(""):t._subdomains=["a","b","c"],t._tileWidth=(0,c.Z)(e.tileWidth,256),t._tileHeight=(0,c.Z)(e.tileHeight,256),t._minimumLevel=(0,c.Z)(e.minimumLevel,0),t._maximumLevel=e.maximumLevel,t._tilingScheme=(0,c.Z)(e.tilingScheme,new _.Z({ellipsoid:e.ellipsoid})),t._rectangle=(0,c.Z)(e.rectangle,t._tilingScheme.rectangle),t._rectangle=f.Z.intersection(t._rectangle,t._tilingScheme.rectangle),t._hasAlphaChannel=(0,c.Z)(e.hasAlphaChannel,!0);let l=e.credit;return"string"==typeof l&&(l=new a.Z(l)),t._credit=l,t._resource=r,t._tags=n,t._pickFeaturesResource=d,t._pickFeaturesTags=o,!0}))},b.prototype.getTileCredits=function(e,t,i){if(!this.ready)throw new u.Z("getTileCredits must not be called before the imagery provider is ready.")},b.prototype.requestImage=function(e,t,i,n){if(!this.ready)throw new u.Z("requestImage must not be called before the imagery provider is ready.");return g.Z.loadImage(this,function(e,t,i,n,o){v=!1,S=!1;const r=e._resource,s=r.getUrlComponent(!0),a=e._tags,c={},u=s.match(Z);(0,h.Z)(u)&&u.forEach((function(o){const r=o.substring(1,o.length-1);(0,h.Z)(a[r])&&(c[r]=a[r](e,t,i,n))}));return r.getDerivedResource({request:o,templateValues:c})}(this,e,t,i,n))},b.prototype.pickFeatures=function(e,t,i,n,o){if(!this.ready)throw new u.Z("pickFeatures must not be called before the imagery provider is ready.");if(!this.enablePickFeatures||!(0,h.Z)(this._pickFeaturesResource)||0===this._getFeatureInfoFormats.length)return;let r=0;const s=this;function a(e,t){return e.callback(t)}return function c(){if(r>=s._getFeatureInfoFormats.length)return Promise.resolve([]);const u=s._getFeatureInfoFormats[r],d=function(e,t,i,n,o,r,s){v=!1,S=!1,T=!1,I=!1;const a=e._pickFeaturesResource,c=a.getUrlComponent(!0),u=e._pickFeaturesTags,d={},l=c.match(Z);(0,h.Z)(l)&&l.forEach((function(a){const c=a.substring(1,a.length-1);(0,h.Z)(u[c])&&(d[c]=u[c](e,t,i,n,o,r,s))}));return a.getDerivedResource({templateValues:d})}(s,e,t,i,n,o,u.format);return++r,"json"===u.type?d.fetchJson().then(u.callback).catch(c):"xml"===u.type?d.fetchXML().then(u.callback).catch(c):"text"===u.type||"html"===u.type?d.fetchText().then(u.callback).catch(c):d.fetch({responseType:u.format}).then(a.bind(void 0,u)).catch(c)}()};let v=!1;const x=new f.Z;let S=!1;const C=new f.Z;let T=!1;const E=new n.Z;let I=!1;function P(e,t,i){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){const n=e.urlSchemeZeroPadding[t];if("string"==typeof n){const e=n.length;e>1&&(i=i.length>=e?i:new Array(e-i.toString().length+1).join("0")+i)}}return i}function O(e,t,i,n){v||(e.tilingScheme.tileXYToRectangle(t,i,n,x),x.west=p.Z.toDegrees(x.west),x.south=p.Z.toDegrees(x.south),x.east=p.Z.toDegrees(x.east),x.north=p.Z.toDegrees(x.north),v=!0)}function A(e,t,i,n){S||(e.tilingScheme.tileXYToNativeRectangle(t,i,n,C),S=!0)}const L=new f.Z,N=new o.Z;function D(e,t,i,n,o,r,s){if(T)return;R(e,t,i,n,o,r);const a=N,c=e.tilingScheme.tileXYToNativeRectangle(t,i,n,L);E.x=e.tileWidth*(a.x-c.west)/c.width|0,E.y=e.tileHeight*(c.north-a.y)/c.height|0,T=!0}const M=new r.Z;function R(e,t,i,n,o,r,s){if(!I){if(e.tilingScheme.projection instanceof l.Z)N.x=p.Z.toDegrees(o),N.y=p.Z.toDegrees(r);else{const t=M;t.longitude=o,t.latitude=r,e.tilingScheme.projection.project(t,N)}I=!0}}const F=b},66563:(e,t,i)=>{i.d(t,{Z:()=>n});const n=function(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}},99149:(e,t,i)=>{i.d(t,{Z:()=>j});var n=i(93237),o=i(35742),r=i(59015),s=i(93517),a=i(6785),c=i(44990),h=i(88779),u=i(54485),d=i(90332),l=i(99996),p=i(74834),f=i(39172),m=i(42428),_=i(71118),g=i(34152),Z=i(7612),y=i(31328),w=i(36627),b=i(71087),v=i(1577),x=i(74064),S=i(17426),C=i(7048),T=i(46801),E=i(85975),I=i(21761),P=i(4491),O=i(995),A=i(96059),L=i(98179),N=i(28075),D=i(84067),M=i(88307),R=i(59215),F=i(54806);function B(e){var t;this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=(0,h.Z)(e.ellipsoid,l.Z.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._minimumMaximumVectorHeights=new r.Z(n.Z._defaultMinTerrainHeight,n.Z._defaultMaxTerrainHeight),this._boundingVolume=m.Z.fromRectangle(e.rectangle,n.Z._defaultMinTerrainHeight,n.Z._defaultMaxTerrainHeight,this._ellipsoid),this._classificationType=e.classificationType,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._startEllipsoidNormals=void 0,this._endEllipsoidNormals=void 0,this._startPositionAndHeights=void 0,this._startFaceNormalAndVertexCornerIds=void 0,this._endPositionAndHeights=void 0,this._endFaceNormalAndHalfWidths=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=a.Z.clone(a.Z.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._update=function(e,t){},this._readyPromise=(t=this,n.Z.initialize().then((function(){return function(e,t,i){const o=n.Z.getMinimumMaximumHeights(t,i),r=o.minimumTerrainHeight,s=o.maximumTerrainHeight,a=e._minimumMaximumVectorHeights;a.x=r,a.y=s;const c=e._boundingVolume,h=e._rectangle;m.Z.fromRectangle(h,r,s,i,c)}(t,t._rectangle,t._ellipsoid),new Promise((function(e,i){t._update=function(t,n){const r=n.context,a=function(e,t){if(!(0,u.Z)(e._va)&&!(0,u.Z)(e._verticesPromise)){let t=e._positions,i=e._widths,n=e._counts,r=e._transferrableBatchIds,a=e._packedBuffer;(0,u.Z)(a)||(t=e._positions=(0,o.Z)(t),i=e._widths=(0,o.Z)(i),n=e._counts=(0,o.Z)(n),r=e._transferrableBatchIds=(0,o.Z)(e._batchIds),a=e._packedBuffer=function(e){const t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,o=e._ellipsoid,r=e._center,a=2+g.Z.packedLength+l.Z.packedLength+s.Z.packedLength,c=new Float64Array(a);let h=0;return c[h++]=i,c[h++]=n,g.Z.pack(t,c,h),h+=g.Z.packedLength,l.Z.pack(o,c,h),h+=l.Z.packedLength,s.Z.pack(r,c,h),c}(e));const c=[t.buffer,i.buffer,n.buffer,r.buffer,a.buffer],h={positions:t.buffer,widths:i.buffer,counts:n.buffer,batchIds:r.buffer,packedBuffer:a.buffer,keepDecodedPositions:e._keepDecodedPositions},d=e._verticesPromise=k.scheduleTask(h,c);if(!(0,u.Z)(d))return;return d.then((function(t){e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(t.decodedPositions),e._decodedPositionOffsets=new Uint32Array(t.decodedPositionOffsets)),e._startEllipsoidNormals=new Float32Array(t.startEllipsoidNormals),e._endEllipsoidNormals=new Float32Array(t.endEllipsoidNormals),e._startPositionAndHeights=new Float32Array(t.startPositionAndHeights),e._startFaceNormalAndVertexCornerIds=new Float32Array(t.startFaceNormalAndVertexCornerIds),e._endPositionAndHeights=new Float32Array(t.endPositionAndHeights),e._endFaceNormalAndHalfWidths=new Float32Array(t.endFaceNormalAndHalfWidths),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds);const i=t.indexDatatype;e._indices=i===f.Z.UNSIGNED_SHORT?new Uint16Array(t.indices):new Uint32Array(t.indices),e._ready=!0}))}}(t);if(function(e,t){(0,u.Z)(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){const i=t.uniformState.view;return _.Z.clone(i,W),_.Z.multiplyByPoint(W,e._center,U),_.Z.setTranslation(W,U,W),W},u_highlightColor:function(){return e._highlightColor},u_minimumMaximumVectorHeights:function(){return e._minimumMaximumVectorHeights}})}(t,r),function(e,t){if((0,u.Z)(e._sp))return;const i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(I.Z),o=i.getFragmentShaderCallback(!1,void 0,!0)(P.Z),r=new C.Z({defines:["VECTOR_TILE",p.Z.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[E.Z,n]}),s=new C.Z({defines:["VECTOR_TILE"],sources:[o]});e._sp=S.Z.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:H})}(t,r),h=t,(0,u.Z)(h._rs)||(h._rs=V(!1),h._rs3DTiles=V(!0)),t._ready){const e=n.passes;(e.render||e.pick)&&function(e,t){let i=e._command;if(!(0,u.Z)(e._command)){const t=e._batchTable.getUniformMapCallback()(e._uniformMap);i=e._command=new b.Z({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:v.Z.TERRAIN_CLASSIFICATION,pickId:e._batchTable.getPickId()});const n=b.Z.shallowClone(i,i.derivedCommands.tileset);n.renderState=e._rs3DTiles,n.pass=v.Z.CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=n}const n=e._classificationType;n!==L.Z.TERRAIN&&n!==L.Z.BOTH||t.commandList.push(i),n!==L.Z.CESIUM_3D_TILE&&n!==L.Z.BOTH||t.commandList.push(i.derivedCommands.tileset)}(t,n)}var h;(0,u.Z)(a)&&a.then((function(){!function(e,t){if(e._ready&&!(0,u.Z)(e._va)){const i=e._startEllipsoidNormals,n=e._endEllipsoidNormals,o=e._startPositionAndHeights,r=e._endPositionAndHeights,s=e._startFaceNormalAndVertexCornerIds,a=e._endFaceNormalAndHalfWidths,h=e._vertexBatchIds,u=e._indices;let d=i.byteLength+n.byteLength;d+=o.byteLength+r.byteLength,d+=s.byteLength+a.byteLength,d+=h.byteLength+u.byteLength,e._trianglesLength=u.length/3,e._geometryByteLength=d;const l=y.Z.createVertexBuffer({context:t,typedArray:i,usage:w.Z.STATIC_DRAW}),p=y.Z.createVertexBuffer({context:t,typedArray:n,usage:w.Z.STATIC_DRAW}),m=y.Z.createVertexBuffer({context:t,typedArray:o,usage:w.Z.STATIC_DRAW}),_=y.Z.createVertexBuffer({context:t,typedArray:r,usage:w.Z.STATIC_DRAW}),g=y.Z.createVertexBuffer({context:t,typedArray:s,usage:w.Z.STATIC_DRAW}),Z=y.Z.createVertexBuffer({context:t,typedArray:a,usage:w.Z.STATIC_DRAW}),b=y.Z.createVertexBuffer({context:t,typedArray:h,usage:w.Z.STATIC_DRAW}),v=y.Z.createIndexBuffer({context:t,typedArray:u,usage:w.Z.STATIC_DRAW,indexDatatype:2===u.BYTES_PER_ELEMENT?f.Z.UNSIGNED_SHORT:f.Z.UNSIGNED_INT}),x=[{index:H.startEllipsoidNormal,vertexBuffer:l,componentDatatype:c.Z.FLOAT,componentsPerAttribute:3},{index:H.endEllipsoidNormal,vertexBuffer:p,componentDatatype:c.Z.FLOAT,componentsPerAttribute:3},{index:H.startPositionAndHeight,vertexBuffer:m,componentDatatype:c.Z.FLOAT,componentsPerAttribute:4},{index:H.endPositionAndHeight,vertexBuffer:_,componentDatatype:c.Z.FLOAT,componentsPerAttribute:4},{index:H.startFaceNormalAndVertexCorner,vertexBuffer:g,componentDatatype:c.Z.FLOAT,componentsPerAttribute:4},{index:H.endFaceNormalAndHalfWidth,vertexBuffer:Z,componentDatatype:c.Z.FLOAT,componentsPerAttribute:4},{index:H.a_batchId,vertexBuffer:b,componentDatatype:c.Z.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new T.Z({context:t,attributes:x,indexBuffer:v}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._startEllipsoidNormals=void 0,e._endEllipsoidNormals=void 0,e._startPositionAndHeights=void 0,e._startFaceNormalAndVertexCornerIds=void 0,e._endPositionAndHeights=void 0,e._endFaceNormalAndHalfWidths=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}(t,r),e(t)})).catch((function(e){i(e)}))}}))}))),this._verticesPromise=void 0}Object.defineProperties(B.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise}}});const k=new Z.Z("createVectorTileClampedPolylines"),H={startEllipsoidNormal:0,endEllipsoidNormal:1,startPositionAndHeight:2,endPositionAndHeight:3,startFaceNormalAndVertexCorner:4,endFaceNormalAndHalfWidth:5,a_batchId:6};const W=new _.Z,U=new s.Z;function V(e){return x.Z.fromCache({cull:{enabled:!0,face:N.Z.FRONT},blending:O.Z.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:M.Z.EQUAL,frontOperation:{fail:R.Z.KEEP,zFail:R.Z.KEEP,zPass:R.Z.KEEP},backFunction:M.Z.EQUAL,backOperation:{fail:R.Z.KEEP,zFail:R.Z.KEEP,zPass:R.Z.KEEP},reference:D.Z.CESIUM_3D_TILE_MASK,mask:D.Z.CESIUM_3D_TILE_MASK}})}B.prototype.getPositions=function(e){return F.Z.getPolylinePositions(this,e)},B.prototype.createFeatures=function(e,t){const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o];t[n]=new A.Z(e,n)}},B.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const z=new a.Z,G=a.Z.WHITE;B.prototype.applyStyle=function(e,t){if(!(0,u.Z)(e))return void function(e,t){const i=e._batchIds,n=i.length;for(let e=0;e<n;++e){const n=t[i[e]];n.show=!0,n.color=a.Z.WHITE}}(this,t);const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=t[i[o]];n.color=(0,u.Z)(e.color)?e.color.evaluateColor(n,z):G,n.show=!(0,u.Z)(e.show)||e.show.evaluate(n)}},B.prototype.update=function(e){this._update(this,e)},B.prototype.isDestroyed=function(){return!1},B.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),(0,d.Z)(this)};const j=B},31937:(e,t,i)=>{i.d(t,{Z:()=>E});var n=i(93517),o=i(88779),r=i(54485),s=i(90332),a=i(20176),c=i(99996),h=i(7219),u=i(44990),d=i(22874),l=i(71118),p=i(34152),f=i(21514),m=i(18272),_=i(73673),g=i(1526),Z=i(83530),y=i(54806),w=i(99149),b=i(35443);function v(e,t,i,s,a){this._tileset=e,this._tile=t,this._resource=i,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,function(e,t,i){i=(0,o.Z)(i,0);const s=new Uint8Array(t),a=new DataView(t);i+=x;const y=a.getUint32(i,!0);if(1!==y)throw new f.Z(`Only Vector tile version 1 is supported.  Version ${y} is not.`);i+=x;const w=a.getUint32(i,!0);if(i+=x,0===w)return Promise.resolve(e);const v=a.getUint32(i,!0);if(i+=x,0===v)throw new f.Z("Feature table must have a byte length greater than zero");const T=a.getUint32(i,!0);i+=x;const E=a.getUint32(i,!0);i+=x;const I=a.getUint32(i,!0);i+=x;const P=a.getUint32(i,!0);i+=x;const O=a.getUint32(i,!0);i+=x;const A=a.getUint32(i,!0);i+=x;const L=a.getUint32(i,!0);i+=x;const N=(0,h.Z)(s,i,v);i+=v;const D=new Uint8Array(t,i,T);let M,R;i+=T,E>0&&(M=(0,h.Z)(s,i,E),i+=E,I>0&&(R=new Uint8Array(t,i,I),R=new Uint8Array(R),i+=I));const F=(0,o.Z)(N.POLYGONS_LENGTH,0),B=(0,o.Z)(N.POLYLINES_LENGTH,0),k=(0,o.Z)(N.POINTS_LENGTH,0),H=F+B+k,W=new m.Z(e,H,M,R,function(e){return function(t,i){(0,r.Z)(e._polygons)&&e._polygons.updateCommands(t,i)}}(e));if(e._batchTable=W,0===H)return;const U=new _.Z(N,D),V=U.getGlobalProperty("REGION");if(!(0,r.Z)(V))throw new f.Z("Feature table global property: REGION must be defined");const z=p.Z.unpack(V),G=V[4],j=V[5],q=e._tile.computedTransform;let Y=U.getGlobalProperty("RTC_CENTER",u.Z.FLOAT,3);(0,r.Z)(Y)?(Y=n.Z.unpack(Y),l.Z.multiplyByPoint(q,Y,Y)):(Y=p.Z.center(z),Y.height=d.Z.lerp(G,j,.5),Y=c.Z.WGS84.cartographicToCartesian(Y));const X=function(e,t){let i,n,s,a;const c=(0,o.Z)(e.POLYGONS_LENGTH,0),h=(0,o.Z)(e.POLYLINES_LENGTH,0),u=(0,o.Z)(e.POINTS_LENGTH,0);if(c>0&&(0,r.Z)(e.POLYGON_BATCH_IDS)){const n=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,n,c)}if(h>0&&(0,r.Z)(e.POLYLINE_BATCH_IDS)){const i=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,i,h)}if(u>0&&(0,r.Z)(e.POINT_BATCH_IDS)){const i=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;s=new Uint16Array(t.buffer,i,u)}const d=(0,r.Z)(i)||(0,r.Z)(n)||(0,r.Z)(s),l=c>0&&!(0,r.Z)(i)||h>0&&!(0,r.Z)(n)||u>0&&!(0,r.Z)(s);if(d&&l)throw new f.Z("If one group of batch ids is defined, then all batch ids must be defined.");if(!(0,r.Z)(i)&&!(0,r.Z)(n)&&!(0,r.Z)(s)){let e=0;if(!(0,r.Z)(i)&&c>0)for(i=new Uint16Array(c),a=0;a<c;++a)i[a]=e++;if(!(0,r.Z)(n)&&h>0)for(n=new Uint16Array(h),a=0;a<h;++a)n[a]=e++;if(!(0,r.Z)(s)&&u>0)for(s=new Uint16Array(u),a=0;a<u;++a)s[a]=e++}return{polygons:i,polylines:n,points:s}}(N,D);if(i+=(4-i%4)%4,F>0){U.featuresLength=F;const n=(0,o.Z)(U.getPropertyArray("POLYGON_COUNTS",u.Z.UNSIGNED_INT,1),U.getPropertyArray("POLYGON_COUNT",u.Z.UNSIGNED_INT,1));if(!(0,r.Z)(n))throw new f.Z("Feature table property: POLYGON_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");const s=(0,o.Z)(U.getPropertyArray("POLYGON_INDEX_COUNTS",u.Z.UNSIGNED_INT,1),U.getPropertyArray("POLYGON_INDEX_COUNT",u.Z.UNSIGNED_INT,1));if(!(0,r.Z)(s))throw new f.Z("Feature table property: POLYGON_INDEX_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");const a=n.reduce((function(e,t){return e+2*t}),0),c=s.reduce((function(e,t){return e+t}),0),h=new Uint32Array(t,i,c);i+=P;const d=new Uint16Array(t,i,a);let l,p;i+=O,(0,r.Z)(N.POLYGON_MINIMUM_HEIGHTS)&&(0,r.Z)(N.POLYGON_MAXIMUM_HEIGHTS)&&(l=U.getPropertyArray("POLYGON_MINIMUM_HEIGHTS",u.Z.FLOAT,1),p=U.getPropertyArray("POLYGON_MAXIMUM_HEIGHTS",u.Z.FLOAT,1)),e._polygons=new Z.Z({positions:d,counts:n,indexCounts:s,indices:h,minimumHeight:G,maximumHeight:j,polygonMinimumHeights:l,polygonMaximumHeights:p,center:Y,rectangle:z,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:W,batchIds:X.polygons,modelMatrix:q})}if(B>0){U.featuresLength=B;const n=(0,o.Z)(U.getPropertyArray("POLYLINE_COUNTS",u.Z.UNSIGNED_INT,1),U.getPropertyArray("POLYLINE_COUNT",u.Z.UNSIGNED_INT,1));if(!(0,r.Z)(n))throw new f.Z("Feature table property: POLYLINE_COUNTS must be defined when POLYLINES_LENGTH is greater than 0");let s=U.getPropertyArray("POLYLINE_WIDTHS",u.Z.UNSIGNED_SHORT,1);if(!(0,r.Z)(s)){s=new Uint16Array(B);for(let e=0;e<B;++e)s[e]=2}const a=n.reduce((function(e,t){return e+3*t}),0),h=new Uint16Array(t,i,a);i+=A;const d=e._tileset,l=d.examineVectorLinesFunction;if((0,r.Z)(l)){!function(e,t,i,n,o,r){const s=t.length;let a=0;for(let c=0;c<s;c++){const s=3*t[c],h=e.slice(a,a+s);a+=s,r(h,i[c],o,n)}}((0,b.Z)(new Uint16Array(h),z,G,j,c.Z.WGS84),n,X.polylines,W,e.url,l)}let p=S;(0,r.Z)(d.classificationType)&&(p=C),e._polylines=p({positions:h,widths:s,counts:n,batchIds:X.polylines,minimumHeight:G,maximumHeight:j,center:Y,rectangle:z,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:W,classificationType:d.classificationType,keepDecodedPositions:d.vectorKeepDecodedPositions})}if(k>0){const n=new Uint16Array(t,i,3*k);i+=L,e._points=new g.Z({positions:n,batchIds:X.points,minimumHeight:G,maximumHeight:j,rectangle:z,batchTable:W})}Promise.resolve(e)}(this,s,a)}Object.defineProperties(v.prototype,{featuresLength:{get:function(){return(0,r.Z)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return(0,r.Z)(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){let e=0;return(0,r.Z)(this._polygons)&&(e+=this._polygons.trianglesLength),(0,r.Z)(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){let e=0;return(0,r.Z)(this._polygons)&&(e+=this._polygons.geometryByteLength),(0,r.Z)(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return(0,r.Z)(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return(0,r.Z)(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){const e=(0,r.Z)(this._points)?this._points.readyPromise:void 0,t=(0,r.Z)(this._polygons)?this._polygons.readyPromise:void 0,i=(0,r.Z)(this._polylines)?this._polylines.readyPromise:void 0,n=this;return Promise.all([e,t,i]).then((function(){return n}))}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});const x=Uint32Array.BYTES_PER_ELEMENT;function S(e){return new y.Z(e)}function C(e){return new w.Z(e)}function T(e){const t=e.featuresLength;if(!(0,r.Z)(e._features)&&t>0){const i=new Array(t);(0,r.Z)(e._polygons)&&e._polygons.createFeatures(e,i),(0,r.Z)(e._polylines)&&e._polylines.createFeatures(e,i),(0,r.Z)(e._points)&&e._points.createFeatures(e,i),e._features=i}}v.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},v.prototype.getFeature=function(e){const t=this.featuresLength;if(!(0,r.Z)(e)||e<0||e>=t)throw new a.Z(`batchId is required and between zero and featuresLength - 1 (${t-1}).`);return T(this),this._features[e]},v.prototype.applyDebugSettings=function(e,t){(0,r.Z)(this._polygons)&&this._polygons.applyDebugSettings(e,t),(0,r.Z)(this._polylines)&&this._polylines.applyDebugSettings(e,t),(0,r.Z)(this._points)&&this._points.applyDebugSettings(e,t)},v.prototype.applyStyle=function(e){T(this),(0,r.Z)(this._polygons)&&this._polygons.applyStyle(e,this._features),(0,r.Z)(this._polylines)&&this._polylines.applyStyle(e,this._features),(0,r.Z)(this._points)&&this._points.applyStyle(e,this._features)},v.prototype.update=function(e,t){let i=!0;(0,r.Z)(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(t),i=i&&this._polygons._ready),(0,r.Z)(this._polylines)&&(this._polylines.update(t),i=i&&this._polylines._ready),(0,r.Z)(this._points)&&(this._points.update(t),i=i&&this._points._ready),(0,r.Z)(this._batchTable)&&i&&this._batchTable.update(e,t)},v.prototype.getPolylinePositions=function(e){const t=this._polylines;if((0,r.Z)(t))return t.getPositions(e)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),(0,s.Z)(this)};const E=v},60197:(e,t,i)=>{i.d(t,{Z:()=>Z});var n=i(35742),o=i(52351),r=i(93517),s=i(6785),a=i(88779),c=i(54485),h=i(90332),u=i(71118),d=i(7612),l=i(98179),p=i(66563),f=i(55634);function m(e){var t;this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,(0,c.Z)(this._center)||((0,c.Z)(this._boundingVolume)?this._center=r.Z.clone(this._boundingVolume.center):this._center=r.Z.clone(r.Z.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._update=function(e,t){},this._readyPromise=(t=this,new Promise((function(e,i){t._update=function(t,h){const d=function(e){if(!(0,c.Z)(e._primitive)&&!(0,c.Z)(e._verticesPromise)){let t=e._boxes,i=e._boxBatchIds,a=e._cylinders,h=e._cylinderBatchIds,d=e._ellipsoids,l=e._ellipsoidBatchIds,f=e._spheres,m=e._sphereBatchIds,Z=e._batchTableColors,y=e._packedBuffer;if(!(0,c.Z)(Z)){let o=0;(0,c.Z)(e._boxes)&&(t=e._boxes=(0,n.Z)(t),i=e._boxBatchIds=(0,n.Z)(i),o+=i.length),(0,c.Z)(e._cylinders)&&(a=e._cylinders=(0,n.Z)(a),h=e._cylinderBatchIds=(0,n.Z)(h),o+=h.length),(0,c.Z)(e._ellipsoids)&&(d=e._ellipsoids=(0,n.Z)(d),l=e._ellipsoidBatchIds=(0,n.Z)(l),o+=l.length),(0,c.Z)(e._spheres)&&(f=e._sphere=(0,n.Z)(f),m=e._sphereBatchIds=(0,n.Z)(m),o+=m.length),Z=e._batchTableColors=new Uint32Array(o);const s=e._batchTable;for(let e=0;e<o;++e){const t=s.getColor(e,g);Z[e]=t.toRgba()}y=e._packedBuffer=function(e){const t=new Float64Array(u.Z.packedLength+r.Z.packedLength);let i=0;return r.Z.pack(e._center,t,i),i+=r.Z.packedLength,u.Z.pack(e._modelMatrix,t,i),t}(e)}const w=[];(0,c.Z)(t)&&w.push(t.buffer,i.buffer),(0,c.Z)(a)&&w.push(a.buffer,h.buffer),(0,c.Z)(d)&&w.push(d.buffer,l.buffer),(0,c.Z)(f)&&w.push(f.buffer,m.buffer),w.push(Z.buffer,y.buffer);const b={boxes:(0,c.Z)(t)?t.buffer:void 0,boxBatchIds:(0,c.Z)(t)?i.buffer:void 0,cylinders:(0,c.Z)(a)?a.buffer:void 0,cylinderBatchIds:(0,c.Z)(a)?h.buffer:void 0,ellipsoids:(0,c.Z)(d)?d.buffer:void 0,ellipsoidBatchIds:(0,c.Z)(d)?l.buffer:void 0,spheres:(0,c.Z)(f)?f.buffer:void 0,sphereBatchIds:(0,c.Z)(f)?m.buffer:void 0,batchTableColors:Z.buffer,packedBuffer:y.buffer},v=e._verticesPromise=_.scheduleTask(b,w);if(!(0,c.Z)(v))return;return v.then((function(t){const i=new Float64Array(t.packedBuffer),n=function(e,t){let i=0;const n=t[i++],r=t[i++],a=e._boundingVolumes=new Array(r);for(let e=0;e<r;++e)a[e]=o.Z.unpack(t,i),i+=o.Z.packedLength;const c=t[i++],h=e._batchedIndices=new Array(c);for(let e=0;e<c;++e){const n=s.Z.unpack(t,i);i+=s.Z.packedLength;const o=t[i++],r=t[i++],a=t[i++],c=new Array(a);for(let e=0;e<a;++e)c[e]=t[i++];h[e]=new p.Z({color:n,offset:o,count:r,batchIds:c})}return n}(e,i);e._indices=2===n?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._positions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds),e._batchIds=new Uint16Array(t.batchIds),e._ready=!0}))}}(t);t._ready&&(t._primitive.debugWireframe=t.debugWireframe,t._primitive.forceRebatch=t.forceRebatch,t._primitive.classificationType=t.classificationType,t._primitive.update(h)),(0,c.Z)(d)&&d.then((function(){!function(e){e._ready&&!(0,c.Z)(e._primitive)&&(e._primitive=new f.Z({batchTable:e._batchTable,positions:e._positions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center,pickObject:(0,a.Z)(e._pickObject,e)}),e._boxes=void 0,e._boxBatchIds=void 0,e._cylinders=void 0,e._cylinderBatchIds=void 0,e._ellipsoids=void 0,e._ellipsoidBatchIds=void 0,e._spheres=void 0,e._sphereBatchIds=void 0,e._center=void 0,e._modelMatrix=void 0,e._batchTable=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._indices=void 0,e._indexOffsets=void 0,e._indexCounts=void 0,e._positions=void 0,e._vertexBatchIds=void 0,e._batchIds=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._verticesPromise=void 0)}(t),e(t)})).catch((function(e){i(e)}))}}))),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=l.Z.BOTH}Object.defineProperties(m.prototype,{trianglesLength:{get:function(){return(0,c.Z)(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return(0,c.Z)(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise}}}),m.packedBoxLength=u.Z.packedLength+r.Z.packedLength,m.packedCylinderLength=u.Z.packedLength+2,m.packedEllipsoidLength=u.Z.packedLength+r.Z.packedLength,m.packedSphereLength=r.Z.packedLength+1;const _=new d.Z("createVectorTileGeometries",5),g=new s.Z;m.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},m.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},m.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},m.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},m.prototype.update=function(e){this._update(this,e)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),(0,h.Z)(this)};const Z=m},1526:(e,t,i)=>{i.d(t,{Z:()=>N});var n=i(35742),o=i(59015),r=i(93517),s=i(6785),a=i(54485),c=i(90332),h=i(51178),u=i(99996),d=i(14633),l=i(34152),p=i(7612),f=i(64764),m=i(95855),_=i(72293),g=i(77819),Z=i(36164),y=i(13830),w=i(49824);function b(e){var t;this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=new f.Z({batchTable:e.batchTable}),this._labelCollection=new g.Z({batchTable:e.batchTable}),this._polylineCollection=new y.Z,this._polylineCollection._useHighlightColor=!0,this._verticesPromise=void 0,this._packedBuffer=void 0,this._ready=!1,this._update=function(e,t){},this._readyPromise=(t=this,new Promise((function(e,i){t._update=function(t,o){const s=function(e,t){let i;if(!(0,a.Z)(e._verticesPromise)){i=e._positions;let o=e._packedBuffer;(0,a.Z)(o)||(i=e._positions=(0,n.Z)(i),e._batchIds=(0,n.Z)(e._batchIds),o=e._packedBuffer=function(e,t){const i=e._rectangle,n=e._minHeight,o=e._maxHeight,r=2+l.Z.packedLength+u.Z.packedLength,s=new Float64Array(r);let a=0;return s[a++]=n,s[a++]=o,l.Z.pack(i,s,a),a+=l.Z.packedLength,u.Z.pack(t,s,a),s}(e,t));const s=[i.buffer,o.buffer],c={positions:i.buffer,packedBuffer:o.buffer},h=e._verticesPromise=v.scheduleTask(c,s);if(!(0,a.Z)(h))return;return h.then((function(t){e._positions=new Float64Array(t.positions);const n=e._billboardCollection,o=e._labelCollection,s=e._polylineCollection;i=e._positions;const a=e._batchIds,c=i.length/3;for(let e=0;e<c;++e){const t=a[e],c=r.Z.unpack(i,3*e,x),h=n.add();h.position=c,h._batchIndex=t;const u=o.add();u.text=" ",u.position=c,u._batchIndex=t,s.add().positions=[r.Z.clone(c),r.Z.clone(c)]}e._positions=void 0,e._packedBuffer=void 0,e._ready=!0}))}}(t,o.mapProjection.ellipsoid);t._ready&&(t._polylineCollection.update(o),t._billboardCollection.update(o),t._labelCollection.update(o)),(0,a.Z)(s)&&s.then((function(){e()})).catch((function(e){i(e)}))}})))}Object.defineProperties(b.prototype,{pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){return this._billboardCollection.textureAtlas.texture.sizeInBytes+this._labelCollection._textureAtlas.texture.sizeInBytes}},readyPromise:{get:function(){return this._readyPromise}}});const v=new p.Z("createVectorTilePoints",5),x=new r.Z;b.prototype.createFeatures=function(e,t){const i=this._billboardCollection,n=this._labelCollection,o=this._polylineCollection,r=this._batchIds,s=r.length;for(let a=0;a<s;++a){const s=r[a],c=i.get(a),h=n.get(a),u=o.get(a);t[s]=new m.Z(e,s,c,h,u)}},b.prototype.applyDebugSettings=function(e,t){e?(s.Z.clone(t,this._billboardCollection._highlightColor),s.Z.clone(t,this._labelCollection._highlightColor),s.Z.clone(t,this._polylineCollection._highlightColor)):(s.Z.clone(s.Z.WHITE,this._billboardCollection._highlightColor),s.Z.clone(s.Z.WHITE,this._labelCollection._highlightColor),s.Z.clone(s.Z.WHITE,this._polylineCollection._highlightColor))};const S=new s.Z,C=new s.Z,T=new s.Z,E=new s.Z,I=new s.Z,P=new s.Z,O=new d.Z,A=new d.Z,L=new h.Z;b.prototype.applyStyle=function(e,t){if(!(0,a.Z)(e))return void function(e,t){const i=e._batchIds,n=i.length;for(let e=0;e<n;++e){const n=t[i[e]];n.show=!0,n.pointSize=m.Z.defaultPointSize,n.color=m.Z.defaultColor,n.pointOutlineColor=m.Z.defaultPointOutlineColor,n.pointOutlineWidth=m.Z.defaultPointOutlineWidth,n.labelColor=s.Z.WHITE,n.labelOutlineColor=s.Z.WHITE,n.labelOutlineWidth=1,n.font="30px sans-serif",n.labelStyle=Z.Z.FILL,n.labelText=void 0,n.backgroundColor=new s.Z(.165,.165,.165,.8),n.backgroundPadding=new o.Z(7,5),n.backgroundEnabled=!1,n.scaleByDistance=void 0,n.translucencyByDistance=void 0,n.distanceDisplayCondition=void 0,n.heightOffset=0,n.anchorLineEnabled=!1,n.anchorLineColor=s.Z.WHITE,n.image=void 0,n.disableDepthTestDistance=0,n.horizontalOrigin=_.Z.CENTER,n.verticalOrigin=w.Z.CENTER,n.labelHorizontalOrigin=_.Z.RIGHT,n.labelVerticalOrigin=w.Z.BASELINE}}(this,t);const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=t[i[o]];if((0,a.Z)(e.show)&&(n.show=e.show.evaluate(n)),(0,a.Z)(e.pointSize)&&(n.pointSize=e.pointSize.evaluate(n)),(0,a.Z)(e.color)&&(n.color=e.color.evaluateColor(n,S)),(0,a.Z)(e.pointOutlineColor)&&(n.pointOutlineColor=e.pointOutlineColor.evaluateColor(n,C)),(0,a.Z)(e.pointOutlineWidth)&&(n.pointOutlineWidth=e.pointOutlineWidth.evaluate(n)),(0,a.Z)(e.labelColor)&&(n.labelColor=e.labelColor.evaluateColor(n,T)),(0,a.Z)(e.labelOutlineColor)&&(n.labelOutlineColor=e.labelOutlineColor.evaluateColor(n,E)),(0,a.Z)(e.labelOutlineWidth)&&(n.labelOutlineWidth=e.labelOutlineWidth.evaluate(n)),(0,a.Z)(e.font)&&(n.font=e.font.evaluate(n)),(0,a.Z)(e.labelStyle)&&(n.labelStyle=e.labelStyle.evaluate(n)),(0,a.Z)(e.labelText)?n.labelText=e.labelText.evaluate(n):n.labelText=void 0,(0,a.Z)(e.backgroundColor)&&(n.backgroundColor=e.backgroundColor.evaluateColor(n,I)),(0,a.Z)(e.backgroundPadding)&&(n.backgroundPadding=e.backgroundPadding.evaluate(n)),(0,a.Z)(e.backgroundEnabled)&&(n.backgroundEnabled=e.backgroundEnabled.evaluate(n)),(0,a.Z)(e.scaleByDistance)){const t=e.scaleByDistance.evaluate(n);O.near=t.x,O.nearValue=t.y,O.far=t.z,O.farValue=t.w,n.scaleByDistance=O}else n.scaleByDistance=void 0;if((0,a.Z)(e.translucencyByDistance)){const t=e.translucencyByDistance.evaluate(n);A.near=t.x,A.nearValue=t.y,A.far=t.z,A.farValue=t.w,n.translucencyByDistance=A}else n.translucencyByDistance=void 0;if((0,a.Z)(e.distanceDisplayCondition)){const t=e.distanceDisplayCondition.evaluate(n);L.near=t.x,L.far=t.y,n.distanceDisplayCondition=L}else n.distanceDisplayCondition=void 0;(0,a.Z)(e.heightOffset)&&(n.heightOffset=e.heightOffset.evaluate(n)),(0,a.Z)(e.anchorLineEnabled)&&(n.anchorLineEnabled=e.anchorLineEnabled.evaluate(n)),(0,a.Z)(e.anchorLineColor)&&(n.anchorLineColor=e.anchorLineColor.evaluateColor(n,P)),(0,a.Z)(e.image)?n.image=e.image.evaluate(n):n.image=void 0,(0,a.Z)(e.disableDepthTestDistance)&&(n.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(n)),(0,a.Z)(e.horizontalOrigin)&&(n.horizontalOrigin=e.horizontalOrigin.evaluate(n)),(0,a.Z)(e.verticalOrigin)&&(n.verticalOrigin=e.verticalOrigin.evaluate(n)),(0,a.Z)(e.labelHorizontalOrigin)&&(n.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(n)),(0,a.Z)(e.labelVerticalOrigin)&&(n.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(n))}},b.prototype.update=function(e){this._update(this,e)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),(0,c.Z)(this)};const N=b},83530:(e,t,i)=>{i.d(t,{Z:()=>w});var n=i(35742),o=i(93517),r=i(6785),s=i(88779),a=i(54485),c=i(90332),h=i(99996),u=i(39172),d=i(42428),l=i(34152),p=i(7612),f=i(98179),m=i(66563),_=i(55634);function g(e){var t;this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=(0,s.Z)(e.ellipsoid,h.Z.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=(0,s.Z)(e.center,o.Z.ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._update=function(e,t){},this._readyPromise=(t=this,new Promise((function(e,i){t._update=function(t,s){const c=function(e){if(!(0,a.Z)(e._primitive)&&!(0,a.Z)(e._verticesPromise)){let t=e._positions,i=e._counts,s=e._indexCounts,c=e._indices,p=e._transferrableBatchIds,f=e._batchTableColors,_=e._packedBuffer;if(!(0,a.Z)(f)){t=e._positions=(0,n.Z)(e._positions),i=e._counts=(0,n.Z)(e._counts),s=e._indexCounts=(0,n.Z)(e._indexCounts),c=e._indices=(0,n.Z)(e._indices),e._center=e._ellipsoid.cartographicToCartesian(l.Z.center(e._rectangle)),p=e._transferrableBatchIds=new Uint32Array(e._batchIds),f=e._batchTableColors=new Uint32Array(p.length);const r=e._batchTable,a=f.length;for(let e=0;e<a;++e){const t=r.getColor(e,y);f[e]=t.toRgba()}_=e._packedBuffer=function(e){const t=new Float64Array(3+o.Z.packedLength+h.Z.packedLength+l.Z.packedLength);let i=0;return t[i++]=e._indices.BYTES_PER_ELEMENT,t[i++]=e._minimumHeight,t[i++]=e._maximumHeight,o.Z.pack(e._center,t,i),i+=o.Z.packedLength,h.Z.pack(e._ellipsoid,t,i),i+=h.Z.packedLength,l.Z.pack(e._rectangle,t,i),t}(e)}const g=[t.buffer,i.buffer,s.buffer,c.buffer,p.buffer,f.buffer,_.buffer],w={packedBuffer:_.buffer,positions:t.buffer,counts:i.buffer,indexCounts:s.buffer,indices:c.buffer,batchIds:p.buffer,batchTableColors:f.buffer};let b=e._polygonMinimumHeights,v=e._polygonMaximumHeights;(0,a.Z)(b)&&(0,a.Z)(v)&&(b=(0,n.Z)(b),v=(0,n.Z)(v),g.push(b.buffer,v.buffer),w.minimumHeights=b,w.maximumHeights=v);const x=e._verticesPromise=Z.scheduleTask(w,g);if(!(0,a.Z)(x))return;return x.then((function(t){e._positions=void 0,e._counts=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0;const i=new Float64Array(t.packedBuffer),n=i[0];!function(e,t){let i=1;const n=t[i++],o=e._boundingVolumes=new Array(n);for(let e=0;e<n;++e)o[e]=d.Z.unpack(t,i),i+=d.Z.packedLength;const s=t[i++],a=e._batchedIndices=new Array(s);for(let e=0;e<s;++e){const n=r.Z.unpack(t,i);i+=r.Z.packedLength;const o=t[i++],s=t[i++],c=t[i++],h=new Array(c);for(let e=0;e<c;++e)h[e]=t[i++];a[e]=new m.Z({color:n,offset:o,count:s,batchIds:h})}}(e,i),e._indices=2===u.Z.getSizeInBytes(n)?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._batchedPositions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.batchIds),e._ready=!0}))}}(t);t._ready&&(t._primitive.debugWireframe=t.debugWireframe,t._primitive.forceRebatch=t.forceRebatch,t._primitive.classificationType=t.classificationType,t._primitive.update(s)),(0,a.Z)(c)&&c.then((function(){!function(e){e._ready&&!(0,a.Z)(e._primitive)&&(e._primitive=new _.Z({batchTable:e._batchTable,positions:e._batchedPositions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center}),e._batchTable=void 0,e._batchIds=void 0,e._positions=void 0,e._counts=void 0,e._indices=void 0,e._indexCounts=void 0,e._indexOffsets=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0,e._center=void 0,e._rectangle=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._verticesPromise=void 0)}(t),e(t)})).catch((function(e){i(e)}))}}))),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=f.Z.BOTH}Object.defineProperties(g.prototype,{trianglesLength:{get:function(){return(0,a.Z)(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return(0,a.Z)(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise}}});const Z=new p.Z("createVectorTilePolygons",5),y=new r.Z;g.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},g.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},g.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},g.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},g.prototype.update=function(e){this._update(this,e)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),(0,c.Z)(this)};const w=g},54806:(e,t,i)=>{i.d(t,{Z:()=>R});var n=i(35742),o=i(93517),r=i(6785),s=i(44990),a=i(88779),c=i(54485),h=i(90332),u=i(99996),d=i(74834),l=i(39172),p=i(71118),f=i(34152),m=i(7612),_=i(31328),g=i(36627),Z=i(71087),y=i(1577),w=i(74064),b=i(17426),v=i(7048),x=i(46801),S=i(85975),C=i(39755),T=i(995),E=i(96059);function I(e){var t;this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=(0,a.Z)(e.ellipsoid,u.Z.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=r.Z.clone(r.Z.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._update=function(e,t){},this._readyPromise=(t=this,new Promise((function(e,i){t._update=function(t,r){const a=r.context,h=function(e,t){if(!(0,c.Z)(e._va)&&!(0,c.Z)(e._verticesPromise)){let t=e._positions,i=e._widths,r=e._counts,s=e._transferrableBatchIds,a=e._packedBuffer;(0,c.Z)(a)||(t=e._positions=(0,n.Z)(t),i=e._widths=(0,n.Z)(i),r=e._counts=(0,n.Z)(r),s=e._transferrableBatchIds=(0,n.Z)(e._batchIds),a=e._packedBuffer=function(e){const t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,r=e._ellipsoid,s=e._center,a=2+f.Z.packedLength+u.Z.packedLength+o.Z.packedLength,c=new Float64Array(a);let h=0;return c[h++]=i,c[h++]=n,f.Z.pack(t,c,h),h+=f.Z.packedLength,u.Z.pack(r,c,h),h+=u.Z.packedLength,o.Z.pack(s,c,h),c}(e));const h=[t.buffer,i.buffer,r.buffer,s.buffer,a.buffer],d={positions:t.buffer,widths:i.buffer,counts:r.buffer,batchIds:s.buffer,packedBuffer:a.buffer,keepDecodedPositions:e._keepDecodedPositions},p=e._verticesPromise=P.scheduleTask(d,h);if(!(0,c.Z)(p))return;return p.then((function(t){e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(t.decodedPositions),e._decodedPositionOffsets=new Uint32Array(t.decodedPositionOffsets)),e._currentPositions=new Float32Array(t.currentPositions),e._previousPositions=new Float32Array(t.previousPositions),e._nextPositions=new Float32Array(t.nextPositions),e._expandAndWidth=new Float32Array(t.expandAndWidth),e._vertexBatchIds=new Uint16Array(t.batchIds);const i=t.indexDatatype;e._indices=i===l.Z.UNSIGNED_SHORT?new Uint16Array(t.indices):new Uint32Array(t.indices),e._ready=!0}))}}(t);if(function(e,t){(0,c.Z)(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){const i=t.uniformState.view;return p.Z.clone(i,A),p.Z.multiplyByPoint(A,e._center,L),p.Z.setTranslation(A,L,A),A},u_highlightColor:function(){return e._highlightColor}})}(t,a),function(e,t){if((0,c.Z)(e._sp))return;const i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(C.Z),o=i.getFragmentShaderCallback(!1,void 0,!1)(N),r=new v.Z({defines:["VECTOR_TILE",d.Z.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[S.Z,n]}),s=new v.Z({defines:["VECTOR_TILE"],sources:[o]});e._sp=b.Z.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:O})}(t,a),function(e){if((0,c.Z)(e._rs))return;const t={enabled:!0,factor:-5,units:-5};e._rs=w.Z.fromCache({blending:T.Z.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:t})}(t),t._ready){const e=r.passes;(e.render||e.pick)&&function(e,t){if(!(0,c.Z)(e._command)){const t=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new Z.Z({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:y.Z.TRANSLUCENT,pickId:e._batchTable.getPickId()})}t.commandList.push(e._command)}(t,r)}(0,c.Z)(h)&&h.then((function(){!function(e,t){if(e._ready&&!(0,c.Z)(e._va)){const i=e._currentPositions,n=e._previousPositions,o=e._nextPositions,r=e._expandAndWidth,a=e._vertexBatchIds,c=e._indices;let h=n.byteLength+i.byteLength+o.byteLength;h+=r.byteLength+a.byteLength+c.byteLength,e._trianglesLength=c.length/3,e._geometryByteLength=h;const u=_.Z.createVertexBuffer({context:t,typedArray:n,usage:g.Z.STATIC_DRAW}),d=_.Z.createVertexBuffer({context:t,typedArray:i,usage:g.Z.STATIC_DRAW}),p=_.Z.createVertexBuffer({context:t,typedArray:o,usage:g.Z.STATIC_DRAW}),f=_.Z.createVertexBuffer({context:t,typedArray:r,usage:g.Z.STATIC_DRAW}),m=_.Z.createVertexBuffer({context:t,typedArray:a,usage:g.Z.STATIC_DRAW}),Z=_.Z.createIndexBuffer({context:t,typedArray:c,usage:g.Z.STATIC_DRAW,indexDatatype:2===c.BYTES_PER_ELEMENT?l.Z.UNSIGNED_SHORT:l.Z.UNSIGNED_INT}),y=[{index:O.previousPosition,vertexBuffer:u,componentDatatype:s.Z.FLOAT,componentsPerAttribute:3},{index:O.currentPosition,vertexBuffer:d,componentDatatype:s.Z.FLOAT,componentsPerAttribute:3},{index:O.nextPosition,vertexBuffer:p,componentDatatype:s.Z.FLOAT,componentsPerAttribute:3},{index:O.expandAndWidth,vertexBuffer:f,componentDatatype:s.Z.FLOAT,componentsPerAttribute:2},{index:O.a_batchId,vertexBuffer:m,componentDatatype:s.Z.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new x.Z({context:t,attributes:y,indexBuffer:Z}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._currentPositions=void 0,e._previousPositions=void 0,e._nextPositions=void 0,e._expandAndWidth=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}(t,a),e()})).catch((function(e){i(e)}))}}))),this._verticesPromise=void 0}Object.defineProperties(I.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise}}});const P=new m.Z("createVectorTilePolylines",5),O={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};const A=new p.Z,L=new o.Z;const N="uniform vec4 u_highlightColor; \nvoid main()\n{\n    gl_FragColor = u_highlightColor;\n}\n";I.getPolylinePositions=function(e,t){const i=e._batchIds,n=e._decodedPositions,o=e._decodedPositionOffsets;if(!(0,c.Z)(i)||!(0,c.Z)(n))return;let r,s;const a=i.length;let h=0,u=0;for(r=0;r<a;++r)i[r]===t&&(h+=o[r+1]-o[r]);if(0===h)return;const d=new Float64Array(3*h);for(r=0;r<a;++r)if(i[r]===t){const e=o[r],t=o[r+1]-e;for(s=0;s<t;++s){const t=3*(e+s);d[u++]=n[t],d[u++]=n[t+1],d[u++]=n[t+2]}}return d},I.prototype.getPositions=function(e){return I.getPolylinePositions(this,e)},I.prototype.createFeatures=function(e,t){const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o];t[n]=new E.Z(e,n)}},I.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const D=new r.Z,M=r.Z.WHITE;I.prototype.applyStyle=function(e,t){if(!(0,c.Z)(e))return void function(e,t){const i=e._batchIds,n=i.length;for(let e=0;e<n;++e){const n=t[i[e]];n.show=!0,n.color=r.Z.WHITE}}(this,t);const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=t[i[o]];n.color=(0,c.Z)(e.color)?e.color.evaluateColor(n,D):M,n.show=!(0,c.Z)(e.show)||e.show.evaluate(n)}},I.prototype.update=function(e){this._update(this,e)},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),(0,h.Z)(this)};const R=I},55634:(e,t,i)=>{i.d(t,{Z:()=>j});var n=i(93517),o=i(6785),r=i(44990),s=i(88779),a=i(54485),c=i(90332),h=i(39172),u=i(71118),d=i(84473),l=i(31328),p=i(36627),f=i(71087),m=i(1577),_=i(74064),g=i(17426),Z=i(7048),y=i(46801),w=i(67277),b=i(21875),v=i(995),x=i(96059),S=i(98179),C=i(86672),T=i(65155),E=i(84067),I=i(88307),P=i(59215),O=i(66563);function A(e){e=(0,s.Z)(e,s.Z.EMPTY_OBJECT),this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=(0,s.Z)(e.center,n.Z.ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=o.Z.clone(o.Z.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=(0,s.Z)(e.classificationType,S.Z.BOTH),this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._uniformMap=e._uniformMap,this._pickId=e._pickId,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};const t=this._batchIds.length;for(let e=0;e<t;++e){const t=this._batchIds[e];this._batchIdLookUp[t]=e}}Object.defineProperties(A.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});const L={position:0,a_batchId:1};function N(e){const t=e?I.Z.EQUAL:I.Z.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:P.Z.KEEP,zFail:P.Z.DECREMENT_WRAP,zPass:P.Z.KEEP},backFunction:t,backOperation:{fail:P.Z.KEEP,zFail:P.Z.INCREMENT_WRAP,zPass:P.Z.KEEP},reference:E.Z.CESIUM_3D_TILE_MASK,mask:E.Z.CESIUM_3D_TILE_MASK},stencilMask:E.Z.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:C.Z.LESS_OR_EQUAL},depthMask:!1}}const D={stencilTest:{enabled:!0,frontFunction:I.Z.NOT_EQUAL,frontOperation:{fail:P.Z.ZERO,zFail:P.Z.ZERO,zPass:P.Z.ZERO},backFunction:I.Z.NOT_EQUAL,backOperation:{fail:P.Z.ZERO,zFail:P.Z.ZERO,zPass:P.Z.ZERO},reference:0,mask:E.Z.CLASSIFICATION_MASK},stencilMask:E.Z.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:v.Z.PRE_MULTIPLIED_ALPHA_BLEND},M={stencilTest:{enabled:!0,frontFunction:I.Z.NOT_EQUAL,frontOperation:{fail:P.Z.ZERO,zFail:P.Z.ZERO,zPass:P.Z.ZERO},backFunction:I.Z.NOT_EQUAL,backOperation:{fail:P.Z.ZERO,zFail:P.Z.ZERO,zPass:P.Z.ZERO},reference:0,mask:E.Z.CLASSIFICATION_MASK},stencilMask:E.Z.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};const R=new u.Z,F=new n.Z;function B(e,t,i,n,o,r,s){const a=e.constructor.BYTES_PER_ELEMENT,c=r.length;for(let h=0;h<c;++h){const c=s[r[h]],u=n[c],d=o[c],l=new e.constructor(e.buffer,a*u,d);t.set(l,i),n[c]=i,i+=d}return i}function k(e,t,i,n,o,r,s){const a=e.bytesPerIndex,c=r.length;for(let h=0;h<c;++h){const c=s[r[h]],u=n[c],d=o[c];t.copyFromBuffer(e,u*a,i*a,d*a),n[c]=i,i+=d}return i}function H(e,t){return t.color.toRgba()-e.color.toRgba()}function W(e,t){if(!e._batchDirty)return!1;const i=e._batchedIndices,n=i.length;let r=!1;const s={};for(let e=0;e<n;++e){const t=i[e].color.toRgba();if((0,a.Z)(s[t])){r=!0;break}s[t]=!0}return r?r&&!e.forceRebatch&&e._framesSinceLastRebatch<120?void++e._framesSinceLastRebatch:(i.sort(H),t.webgl2?function(e,t){const i=e._indexOffsets,n=e._indexCounts,r=e._batchIdLookUp;let s=t.pop();const a=[s],c=e._va.indexBuffer,h=e._vaSwap.indexBuffer;let u=k(c,h,0,i,n,s.batchIds,r);for(s.offset=0,s.count=u;t.length>0;){const e=t.pop();if(o.Z.equals(e.color,s.color))u=k(c,h,u,i,n,e.batchIds,r),s.batchIds=s.batchIds.concat(e.batchIds),s.count=u-s.offset;else{const t=u;u=k(c,h,u,i,n,e.batchIds,r),e.offset=t,e.count=u-t,a.push(e),s=e}}const d=e._va;e._va=e._vaSwap,e._vaSwap=d,e._batchedIndices=a}(e,i):function(e,t){const i=e._indices,n=e._indexOffsets,r=e._indexCounts,s=e._batchIdLookUp,a=new i.constructor(i.length);let c=t.pop();const h=[c];let u=B(i,a,0,n,r,c.batchIds,s);for(c.offset=0,c.count=u;t.length>0;){const e=t.pop();if(o.Z.equals(e.color,c.color))u=B(i,a,u,n,r,e.batchIds,s),c.batchIds=c.batchIds.concat(e.batchIds),c.count=u-c.offset;else{const t=u;u=B(i,a,u,n,r,e.batchIds,s),e.offset=t,e.count=u-t,h.push(e),c=e}}e._va.indexBuffer.copyFromArrayView(a),e._indices=a,e._batchedIndices=h}(e,i),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0,!0):(e._batchDirty=!1,!1)}A.prototype.createFeatures=function(e,t){const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o];t[n]=new x.Z(e,n)}},A.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const U=new o.Z,V=o.Z.WHITE,z=/\$/;function G(e,t,i,n){const o=e.classificationType,r=o!==S.Z.CESIUM_3D_TILE,s=o!==S.Z.TERRAIN,c=t.commandList;let h,u,d=i.length;for(u=0;u<d;++u)r&&(h=i[u],h.pass=m.Z.TERRAIN_CLASSIFICATION,c.push(h)),s&&(h=i[u].derivedCommands.tileset,h.pass=m.Z.CESIUM_3D_TILE_CLASSIFICATION,c.push(h));if(t.invertClassification&&(0,a.Z)(n))for(d=n.length,u=0;u<d;++u)c.push(n[u])}A.prototype.applyStyle=function(e,t){if(!(0,a.Z)(e))return void function(e,t){e._updatingAllCommands=!0;const i=e._batchIds;let n,r=i.length;for(n=0;n<r;++n){const e=t[i[n]];e.show=!0,e.color=o.Z.WHITE}const s=e._batchedIndices;for(r=s.length,n=0;n<r;++n)s[n].color=o.Z.clone(o.Z.WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}(this,t);const i=e.color,n=i instanceof T.Z&&!z.test(i.expression);this._updatingAllCommands=n;const r=this._batchIds;let s,c=r.length;for(s=0;s<c;++s){const i=t[r[s]];i.color=(0,a.Z)(e.color)?e.color.evaluateColor(i,U):V,i.show=!(0,a.Z)(e.show)||e.show.evaluate(i)}if(n){const e=this._batchedIndices;for(c=e.length,s=0;s<c;++s)e[s].color=o.Z.clone(o.Z.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}},A.prototype.updateCommands=function(e,t){if(this._updatingAllCommands)return;const i=this._batchIdLookUp,n=i[e];if(!(0,a.Z)(n))return;const r=this._indexOffsets,s=this._indexCounts,c=r[n],h=s[n],u=this._batchedIndices,d=u.length;let l;for(l=0;l<d;++l){const e=u[l].offset,t=u[l].count;if(c>=e&&c<e+t)break}u.push(new O.Z({color:o.Z.clone(t),offset:c,count:h,batchIds:[e]}));const p=[],f=[],m=u[l].batchIds,_=m.length;for(let t=0;t<_;++t){const n=m[t];if(n===e)continue;r[i[n]]<c?p.push(n):f.push(n)}0!==f.length&&u.push(new O.Z({color:o.Z.clone(u[l].color),offset:c+h,count:u[l].offset+u[l].count-(c+h),batchIds:f})),0!==p.length?(u[l].count=c-u[l].offset,u[l].batchIds=p):u.splice(l,1),this._batchDirty=!0},A.prototype.update=function(e){const t=e.context;var i;!function(e,t){if((0,a.Z)(e._va))return;const i=l.Z.createVertexBuffer({context:t,typedArray:e._positions,usage:p.Z.STATIC_DRAW}),n=l.Z.createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:p.Z.STATIC_DRAW}),o=l.Z.createIndexBuffer({context:t,typedArray:e._indices,usage:p.Z.DYNAMIC_DRAW,indexDatatype:2===e._indices.BYTES_PER_ELEMENT?h.Z.UNSIGNED_SHORT:h.Z.UNSIGNED_INT}),s=[{index:0,vertexBuffer:i,componentDatatype:r.Z.fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:n,componentDatatype:r.Z.fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new y.Z({context:t,attributes:s,indexBuffer:o}),t.webgl2&&(e._vaSwap=new y.Z({context:t,attributes:s,indexBuffer:l.Z.createIndexBuffer({context:t,sizeInBytes:o.sizeInBytes,usage:p.Z.DYNAMIC_DRAW,indexDatatype:o.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._verticesPromise=void 0}(this,t),function(e,t){if((0,a.Z)(e._sp))return;const i=e._batchTable,n=(0,s.Z)(e._attributeLocations,L);let o=e._pickId;const r=e._vertexShaderSource;let c=e._fragmentShaderSource;if((0,a.Z)(r))return e._sp=g.Z.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:c,attributeLocations:n}),e._spStencil=e._sp,c=Z.Z.replaceMain(c,"czm_non_pick_main"),c=`${c}void main() \n{ \n    czm_non_pick_main(); \n    gl_FragColor = ${o}; \n} \n`,void(e._spPick=g.Z.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:c,attributeLocations:n}));const h=i.getVertexShaderCallback(!1,"a_batchId",void 0)(b.Z);let u=i.getFragmentShaderCallback(!1,void 0,!0)(w.Z);o=i.getPickId();let d=new Z.Z({sources:[h]}),l=new Z.Z({defines:["VECTOR_TILE"],sources:[u]});e._sp=g.Z.fromCache({context:t,vertexShaderSource:d,fragmentShaderSource:l,attributeLocations:n}),d=new Z.Z({sources:[b.Z]}),l=new Z.Z({defines:["VECTOR_TILE"],sources:[w.Z]}),e._spStencil=g.Z.fromCache({context:t,vertexShaderSource:d,fragmentShaderSource:l,attributeLocations:n}),u=Z.Z.replaceMain(u,"czm_non_pick_main"),u=`${u}\nvoid main() \n{ \n    czm_non_pick_main(); \n    gl_FragColor = ${o}; \n} \n`;const p=new Z.Z({sources:[h]}),f=new Z.Z({defines:["VECTOR_TILE"],sources:[u]});e._spPick=g.Z.fromCache({context:t,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:n})}(this,t),i=this,(0,a.Z)(i._rsStencilDepthPass)||(i._rsStencilDepthPass=_.Z.fromCache(N(!1)),i._rsStencilDepthPass3DTiles=_.Z.fromCache(N(!0)),i._rsColorPass=_.Z.fromCache(D),i._rsPickPass=_.Z.fromCache(M)),function(e,t){if((0,a.Z)(e._uniformMap))return;const i={u_modifiedModelViewProjection:function(){const i=t.uniformState.view,n=t.uniformState.projection;return u.Z.clone(i,R),u.Z.multiplyByPoint(R,e._center,F),u.Z.setTranslation(R,F,R),u.Z.multiply(n,R,R),R},u_highlightColor:function(){return e._highlightColor}};e._uniformMap=e._batchTable.getUniformMapCallback()(i)}(this,t);const n=e.passes;n.render&&(function(e,t){const i=W(e,t),n=e._commands,o=e._batchedIndices,r=o.length,c=2*r;if((0,a.Z)(n)&&!i&&n.length===c)return;n.length=c;const h=e._va,d=e._sp,l=(0,s.Z)(e._modelMatrix,u.Z.IDENTITY),p=e._uniformMap,_=e._boundingVolume;for(let t=0;t<r;++t){const i=o[t].offset,r=o[t].count;let s=n[2*t];(0,a.Z)(s)||(s=n[2*t]=new f.Z({owner:e})),s.vertexArray=h,s.modelMatrix=l,s.offset=i,s.count=r,s.renderState=e._rsStencilDepthPass,s.shaderProgram=d,s.uniformMap=p,s.boundingVolume=_,s.cull=!1,s.pass=m.Z.TERRAIN_CLASSIFICATION;const c=f.Z.shallowClone(s,s.derivedCommands.tileset);c.renderState=e._rsStencilDepthPass3DTiles,c.pass=m.Z.CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=c;let u=n[2*t+1];(0,a.Z)(u)||(u=n[2*t+1]=new f.Z({owner:e})),u.vertexArray=h,u.modelMatrix=l,u.offset=i,u.count=r,u.renderState=e._rsColorPass,u.shaderProgram=d,u.uniformMap=p,u.boundingVolume=_,u.cull=!1,u.pass=m.Z.TERRAIN_CLASSIFICATION;const g=f.Z.shallowClone(u,u.derivedCommands.tileset);g.pass=m.Z.CESIUM_3D_TILE_CLASSIFICATION,u.derivedCommands.tileset=g}e._commandsDirty=!0}(this,t),function(e,t){if(e.classificationType===S.Z.TERRAIN||!t.invertClassification||(0,a.Z)(e._commandsIgnoreShow)&&!e._commandsDirty)return;const i=e._commands,n=e._commandsIgnoreShow,o=e._spStencil,r=i.length,s=n.length=r/2;let c=0;for(let e=0;e<s;++e){const t=n[e]=f.Z.shallowClone(i[c],n[e]);t.shaderProgram=o,t.pass=m.Z.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,c+=2}e._commandsDirty=!1}(this,e),function(e){let t,i,n=e.debugWireframe===e._debugWireframe;if(n=n&&!(e.debugWireframe&&e._wireframeDirty),n)return;(0,a.Z)(e._rsWireframe)||(e._rsWireframe=_.Z.fromCache({})),e.debugWireframe?(t=e._rsWireframe,i=d.Z.LINES):(t=e._rsColorPass,i=d.Z.TRIANGLES);const o=e._commands,r=o.length;for(let e=0;e<r;e+=2){const n=o[e+1];n.renderState=t,n.primitiveType=i}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}(this),this._debugWireframe?function(e,t){const i=e.commandList,n=t.length;for(let e=0;e<n;e+=2){const n=t[e+1];n.pass=m.Z.OPAQUE,i.push(n)}}(e,this._commands):G(this,e,this._commands,this._commandsIgnoreShow)),n.pick&&(!function(e){if(!e._pickCommandsDirty)return;const t=e._indexOffsets.length,i=e._pickCommands;i.length=2*t;const n=e._va,o=e._spStencil,r=e._spPick,c=(0,s.Z)(e._modelMatrix,u.Z.IDENTITY),h=e._uniformMap;for(let s=0;s<t;++s){const t=e._indexOffsets[s],u=e._indexCounts[s],d=(0,a.Z)(e._boundingVolumes)?e._boundingVolumes[s]:e.boundingVolume;let l=i[2*s];(0,a.Z)(l)||(l=i[2*s]=new f.Z({owner:e,pickOnly:!0})),l.vertexArray=n,l.modelMatrix=c,l.offset=t,l.count=u,l.renderState=e._rsStencilDepthPass,l.shaderProgram=o,l.uniformMap=h,l.boundingVolume=d,l.pass=m.Z.TERRAIN_CLASSIFICATION;const p=f.Z.shallowClone(l,l.derivedCommands.tileset);p.renderState=e._rsStencilDepthPass3DTiles,p.pass=m.Z.CESIUM_3D_TILE_CLASSIFICATION,l.derivedCommands.tileset=p;let _=i[2*s+1];(0,a.Z)(_)||(_=i[2*s+1]=new f.Z({owner:e,pickOnly:!0})),_.vertexArray=n,_.modelMatrix=c,_.offset=t,_.count=u,_.renderState=e._rsPickPass,_.shaderProgram=r,_.uniformMap=h,_.boundingVolume=d,_.pass=m.Z.TERRAIN_CLASSIFICATION;const g=f.Z.shallowClone(_,_.derivedCommands.tileset);g.pass=m.Z.CESIUM_3D_TILE_CLASSIFICATION,_.derivedCommands.tileset=g}e._pickCommandsDirty=!1}(this),G(this,e,this._pickCommands))},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),(0,c.Z)(this)};const j=A},34240:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(17497),o=i(54485),r=i(20176);const s={POSITION:"POSITION",NORMAL:"NORMAL",TANGENT:"TANGENT",TEXCOORD:"TEXCOORD",COLOR:"COLOR",JOINTS:"JOINTS",WEIGHTS:"WEIGHTS",FEATURE_ID:"_FEATURE_ID"};s.hasSetIndex=function(e){switch(n.Z.typeOf.string("semantic",e),e){case s.POSITION:case s.NORMAL:case s.TANGENT:return!1;case s.TEXCOORD:case s.COLOR:case s.JOINTS:case s.WEIGHTS:case s.FEATURE_ID:return!0;default:throw new r.Z("semantic is not a valid value.")}},s.fromGltfSemantic=function(e){n.Z.typeOf.string("gltfSemantic",e);let t=e;const i=/^(\w+)_\d+$/.exec(e);switch(null!==i&&(t=i[1]),t){case"POSITION":return s.POSITION;case"NORMAL":return s.NORMAL;case"TANGENT":return s.TANGENT;case"TEXCOORD":return s.TEXCOORD;case"COLOR":return s.COLOR;case"JOINTS":return s.JOINTS;case"WEIGHTS":return s.WEIGHTS;case"_FEATURE_ID":return s.FEATURE_ID}},s.fromPntsSemantic=function(e){switch(n.Z.typeOf.string("pntsSemantic",e),e){case"POSITION":case"POSITION_QUANTIZED":return s.POSITION;case"RGBA":case"RGB":case"RGB565":return s.COLOR;case"NORMAL":case"NORMAL_OCT16P":return s.NORMAL;case"BATCH_ID":return s.FEATURE_ID;default:throw new r.Z("pntsSemantic is not a valid value.")}},s.getGlslType=function(e){switch(n.Z.typeOf.string("semantic",e),e){case s.POSITION:case s.NORMAL:case s.TANGENT:return"vec3";case s.TEXCOORD:return"vec2";case s.COLOR:return"vec4";case s.JOINTS:return"ivec4";case s.WEIGHTS:return"vec4";case s.FEATURE_ID:return"int";default:throw new r.Z("semantic is not a valid value.")}},s.getVariableName=function(e,t){n.Z.typeOf.string("semantic",e);let i=function(e){switch(e){case s.POSITION:return"positionMC";case s.NORMAL:return"normalMC";case s.TANGENT:return"tangentMC";case s.TEXCOORD:return"texCoord";case s.COLOR:return"color";case s.JOINTS:return"joints";case s.WEIGHTS:return"weights";case s.FEATURE_ID:return"featureId";default:throw new r.Z("semantic is not a valid value.")}}(e);return(0,o.Z)(t)&&(i+=`_${t}`),i};const a=Object.freeze(s)},49824:(e,t,i)=>{i.d(t,{Z:()=>n});const n=Object.freeze({CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1})}}]);