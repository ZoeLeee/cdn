(()=>{"use strict";var e,t,a,r={65492:(e,t,a)=>{a.d(t,{KT:()=>_,P2:()=>L,YZ:()=>S,aP:()=>E,yD:()=>k,yk:()=>x});var r=a(20246),n=a.n(r),o=a(39831),i=a.n(o),l=a(61799),c=a.n(l),s=a(26117),d=a.n(s),u=a(5996),p=a.n(u),f=a(20658),y=a.n(f),h=a(3434),v=a.n(h),g=a(97828),b=a.n(g),m=a(93213),w=a(6475),O=a(29115);function j(e,t){var a=n()(e);if(i()){var r=i()(e);t&&(r=c()(r).call(r,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,r)}return a}async function k({name:e,pic_key:t,jsonData:a,resources:r,projectId:n}){return await(0,O.qu)(w.yy.upload,{name:e,pic_key:t,json_data:a,resources:r,status:1,project_id:n,project_type:"3d"})}async function x(e,t){const a=await(0,O.ZL)(w.yy.list,{params:{projectId:e,name:t}});return a.code===O.Mx.Ok?a.data:null}async function _(e){const t=await(0,O.pz)(w.yy.update,function(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?p()(a=j(Object(n),!0)).call(a,(function(t){(0,m.Z)(e,t,n[t])})):y()?v()(e,y()(n)):p()(r=j(Object(n))).call(r,(function(t){b()(e,t,d()(n,t))}))}return e}({},e));return t}async function E(e,t){const a=await t();return(await(0,O.qu)(w.yy.pic,{id:e,data:a})).code!==O.Mx.Ok}async function S(e){const t=await(0,O.ZL)(w.yy.detail+"/"+e);return t.code===O.Mx.Ok?t.data?.info:null}async function L(e){return(await(0,O.QO)(w.yy.delete,{data:{id:e}})).code===O.Mx.Ok}},6475:(e,t,a)=>{let r;a.d(t,{U:()=>i,au:()=>n,fL:()=>r,yy:()=>o}),function(e){e.Model="models",e.Component="components",e.Files="files",e.GlobalVariables="globalVariables",e.Particles="particles"}(r||(r={}));const n={create:"/editor/file/upload",list:"/editor/file/private/list",update:"/editor/file/edit",delete:"/editor/file/delete",pic:"/editor/file/upload/pic",detail:"/editor/file/detail",detail2:"/editor/file/detail/id/",publicList:"/editor/file/public/list"},o={upload:"/editor/app/upload",list:"/editor/app/list",prefix:"/editor/file/prefix",update:"/editor/app/edit",pic:"/editor/app/upload/pic",detail:"/editor/app/detail",detail2:"/editor/app/detail/uuid/",delete:"/editor/app/delete",preview:"/editor/app/set/preview",cancelPreview:"/editor/app/cancel/preview",copy:"/editor/app/copy",share:"/editor/app/share",checkShare:"/editor/app/share/check"},i={list:"/editor/project/list",detail:"/editor/project/detail/",edit:"/editor/project/edit"}},54056:(e,t,a)=>{a.d(t,{gV:()=>l});var r=a(57055),n=a(31025),o=a(6475),i=a(29115);const l=(0,n.LO)({intance:null,prefix:""});(0,n.aD)((e=>{l.intance=e})),(0,n.aD)((async()=>{if(l.prefix)return;const e=await(0,i.ZL)(o.yy.prefix);e.code===i.Mx.Ok&&(l.prefix=e.data.prefix,r.AppConfig.assetURL=e.data.prefix)}))},17277:(e,t,a)=>{var r=a(20246),n=a.n(r),o=a(39831),i=a.n(o),l=a(61799),c=a.n(l),s=a(26117),d=a.n(s),u=a(5996),p=a.n(u),f=a(20658),y=a.n(f),h=a(3434),v=a.n(h),g=a(97828),b=a.n(g),m=a(93213),w=a(6488),O=a.n(w),j=(a(69326),a(29556),a(49142),a(57055)),k=a(32735),x=a(44645),_=a(43653),E=a.n(_),S=a(6475),L=a(12117),C=a(94063),R=a(97198),M=a(83228);function P(e,t){var a=n()(e);if(i()){var r=i()(e);t&&(r=c()(r).call(r,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,r)}return a}function Z(e){for(var t=1;t<arguments.length;t++){var a,r,n=null!=arguments[t]?arguments[t]:{};t%2?p()(a=P(Object(n),!0)).call(a,(function(t){(0,m.Z)(e,t,n[t])})):y()?v()(e,y()(n)):p()(r=P(Object(n))).call(r,(function(t){b()(e,t,d()(n,t))}))}return e}(0,a(3864).Z)(),j.AppConfig.assetURL="https://objectmem.histron.cn/",j.AppConfig.Texture_URL="https://am-img.gkiiot.com/editor/",j.AppConfig.SkyBox_URL="https://am-img.gkiiot.com/editor/";const I=E().create({baseURL:"https://hc3d-core.histron.cn"});let A,T;const N=()=>{const e=(0,k.useRef)(null),[t,a]=(0,k.useState)(!0),[r,n]=(0,k.useState)(""),[o,i]=(0,k.useState)(""),[l,c]=(0,k.useState)({start:!1,value:0,label:""}),s=async(e=!1)=>{const t=await I.post(S.yy.checkShare,{key:A,secret:o});let r=t.data.data.data;const i=t.data.variables;if(i&&(j.AppStore.GlobalVariables=JSON.parse(i)),j.AppConfig.assetURL=t.data.data.prefix,r){a(!0);const e=JSON.parse(r),t=e.components??[];for(const e of t){const t=await I.get(S.au.detail2+e);if(200===t.status&&0===t.data.code){const a=t.data.data.json_data,r=JSON.parse(a);(0,L.RM)(Z(Z({},r.data),{},{id:e}))}}T.loadFile(e.data);const o=e.scripts??[];for(const e of o){(0,L.uf)(e.code)()(T,j)}n(e.url2d)}else a(!1),e&&alert("\u5bc6\u7801\u9519\u8bef")};return(0,k.useEffect)((()=>{const e=new(O())(location.search);A=e.get("k"),s()}),[]),(0,k.useEffect)((()=>{(async()=>{if(e.current){const t=e.current;window.app=T=new j.Application({canvas:t,editor:!1,cameraRadius:100}),T.on("loadingBackground",(e=>{c((e=>{let t=e.value+5;return t>90&&(t=e.value),Z(Z({},e),{},{value:t,label:"\u6b63\u5728\u52a0\u8f7d\u5929\u7a7a\u56fe:"})}))})),T.on("loadBackground",(e=>{c((e=>({start:!1,value:0,label:"\u5929\u7a7a\u56fe\u52a0\u8f7d\u5b8c\u6210"})))})),T.on("loading",(async e=>{await(0,M._v)(100),c((t=>({start:!0,value:e.percentage,label:100===e.percentage?"\u6574\u7406\u8d44\u6e90":`\u6b63\u5728\u52a0\u8f7d${e.target?.Name}`})))})),T.on("load",(async e=>{await(0,M._v)(100),c((t=>({start:!1,value:100,label:`\u52a0\u8f7d${e.target?.Name}\u5b8c\u6210`})))}))}})()}),[]),k.createElement(k.Fragment,null,!t&&k.createElement("div",{style:{position:"fixed",left:0,right:0,top:0,bottom:0,margin:"auto",width:"350px",height:"30px",border:"1px solid #ccc",display:"flex",padding:20,alignItems:"center"}},k.createElement("label",null,"\u8bf7\u8f93\u5165\u5bc6\u7801:"),k.createElement("input",{value:o,type:"password",style:{margin:"0 20px",height:30},onChange:e=>i(e.target.value)}),k.createElement("button",{onClick:()=>{s(!0)},style:{padding:5}},"\u786e\u8ba4")),k.createElement(C.Z,{style:{width:"100%",height:"100%",position:"relative"}},k.createElement("canvas",{style:{width:"100%",height:"100%"},ref:e},"\u5206\u4eab\u9875\u9762"),l.start&&k.createElement(C.Z,{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.7)",color:"#FCFCFC"}},k.createElement(C.Z,{style:{position:"absolute",top:"50%",left:"50%",width:"50%",transform:"translate(-50%, -50%)"}},k.createElement(R.A5,{sx:{height:15,borderRadius:5},value:l.value,label:l.label})))))};(0,x.s)(document.getElementById("app")).render(k.createElement(N,null))},29115:(e,t,a)=>{a.d(t,{GH:()=>M,Mx:()=>R,QO:()=>N,ZL:()=>I,pz:()=>T,qu:()=>A});var r=a(93213),n=a(71722),o=a.n(n),i=a(29405),l=a.n(i),c=a(20246),s=a.n(c),d=a(39831),u=a.n(d),p=a(61799),f=a.n(p),y=a(26117),h=a.n(y),v=a(5996),g=a.n(v),b=a(20658),m=a.n(b),w=a(3434),O=a.n(w),j=a(97828),k=a.n(j),x=a(73554),_=a(43653),E=a.n(_),S=a(92604);function L(e,t){var a=s()(e);if(u()){var r=u()(e);t&&(r=f()(r).call(r,(function(t){return h()(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a,n,o=null!=arguments[t]?arguments[t]:{};t%2?g()(a=L(Object(o),!0)).call(a,(function(t){(0,r.Z)(e,t,o[t])})):m()?O()(e,m()(o)):g()(n=L(Object(o))).call(n,(function(t){k()(e,t,h()(o,t))}))}return e}let R;!function(e){e[e.Ok=0]="Ok",e[e.InvalidToken=61]="InvalidToken",e[e.Error=50]="Error"}(R||(R={}));const M=E().create({baseURL:"https://hc3d-core.histron.cn"});M.interceptors.request.use((e=>{let t=(0,S.LP)();return t&&(e.headers.Authorization="Bearer "+t),e}),(e=>o().reject(e)));const P={code:-1,data:null};M.interceptors.response.use((function(e){return e.data.code===R.InvalidToken&&(x.y.error("\u767b\u5f55\u5df2\u8fc7\u671f",{preventDuplicate:!0}),window.IGNORE_INVAILID_TOKEN||l()((()=>{(0,S.gy)(),window.location.reload()}),1e3)),e.data.code===R.Error&&e.data.error&&x.y.error(e.data.error?.[0]),o().resolve(e.data)}),(function(e){return o().reject(P)}));const Z=async e=>(x.y.error("\u8bf7\u6c42\u53d1\u751f\u9519\u8bef"),C(C({},P),{},{msg:e?.message??"\u8bf7\u6c42\u53d1\u751f\u9519\u8bef"}));async function I(e,t){return M.get(e,t).catch(Z)}async function A(e,t,a){return M.post(e,t,a).catch(Z)}async function T(e,t,a){return M.put(e,t,a).catch(Z)}async function N(e,t){return M.delete(e,t).catch(Z)}},73554:(e,t,a)=>{a.d(t,{y:()=>n});var r=a(39282);new(a.n(r)());class n{}n.info=(e,t={})=>{},n.warn=(e,t={})=>{},n.success=(e,t={})=>{},n.error=(e,t={})=>{},n.close=e=>{}},19853:(e,t,a)=>{a.d(t,{HY:()=>s,qm:()=>c});var r=a(97539),n=a.n(r),o=a(13567),i=a.n(o);a(96867);function l(e,t,a){if(void 0===a)return e;const r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),o=-1!==n()(e).call(e,"?")?"&":"?";return e.match(r)?e.replace(r,"$1"+t+"="+a+"$2"):e+o+t+"="+a}function c(e,t=!1,a=!0){let r=t?e.pic_key:e.file_key;return e.uuid&&(r=e.uuid+"/"+r),t&&a&&(r=l(r,"t",i()().toString())),r}function s(e,t){const a=l(location.href,e,t);history.replaceState({path:a},"",a)}}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=r,e=[],o.O=(t,a,r,n)=>{if(!a){var i=1/0;for(d=0;d<e.length;d++){for(var[a,r,n]=e[d],l=!0,c=0;c<a.length;c++)(!1&n||i>=n)&&Object.keys(o.O).every((e=>o.O[e](a[c])))?a.splice(c--,1):(l=!1,n<i&&(i=n));if(l){e.splice(d--,1);var s=r();void 0!==s&&(t=s)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,r,n]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var n=Object.create(null);o.r(n);var i={};t=t||[null,a({}),a([]),a(a)];for(var l=2&r&&e;"object"==typeof l&&!~t.indexOf(l);l=a(l))Object.getOwnPropertyNames(l).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,o.d(n,i),n},o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=3557,(()=>{var e={3557:0};o.O.j=t=>0===e[t];var t=(t,a)=>{var r,n,[i,l,c]=a,s=0;if(i.some((t=>0!==e[t]))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(c)var d=c(o)}for(t&&t(a);s<i.length;s++)n=i[s],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(d)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var i=o.O(void 0,[8739,4326,8274,6471,8737,3336,4480,1461,6499,729,2338,4906,9669,3919,5877,2658,6133,9478,2617,8166,7911,1801,4637,7621,6023,3018,2386,5933,3714,8692,6405,7011,4848,3577,9560,6170,2429,7695,5623,7798,9057,103,6769,4868,3991,5557,3898],(()=>o(17277)));i=o.O(i)})();